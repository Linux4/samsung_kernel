/*
 * sm5504.h
 *
 * Copyright (c) 2014 Samsung Electronics Co., Ltd
 *
 * based on sm5502 extcon driver
 * Copyright (c) 2014 Samsung Electronics Co., Ltd
 * Author: Chanwoo Choi <cw00.choi@samsung.com>
 *
 * This program is free software; you can redistribute  it and/or modify it
 * under  the terms of  the GNU General  Public License as published by the
 * Free Software Foundation;  either version 2 of the  License, or (at your
 * option) any later version.
 */

#ifndef __LINUX_EXTCON_SM5504_H
#define __LINUX_EXTCON_SM5504_H

enum sm5504_types {
	TYPE_SM5504,
};

/* SM5504 registers */
enum sm5504_reg {
	SM5504_REG_DEVICE_ID = 0x01,
	SM5504_REG_CONTROL,
	SM5504_REG_INT1,
	SM5504_REG_INT2,
	SM5504_REG_INTMASK1,
	SM5504_REG_INTMASK2,
	SM5504_REG_ADC,
	SM5504_REG_RSVD1,
	SM5504_REG_RSVD2,
	SM5504_REG_DEV_TYPE1,
	SM5504_REG_DEV_TYPE2,
	SM5504_REG_RSVD4,
	SM5504_REG_RSVD5,
	SM5504_REG_RSVD6,
	SM5504_REG_RSVD7,
	SM5504_REG_RSVD8,
	SM5504_REG_RSVD9,
	SM5504_REG_RSVD10,
	SM5504_REG_MANUAL_SW1,
	SM5504_REG_MANUAL_SW2,
	SM5504_REG_RSVD11,
	SM5504_REG_RSVD12,
	SM5504_REG_RSVD13,
	SM5504_REG_RSVD14,
	SM5504_REG_RSVD15,
	SM5504_REG_RSVD16,
	SM5504_REG_RESET,
	SM5504_REG_RSVD17,
	SM5504_REG_RSVD18,
	SM5504_REG_RSVD19,
	SM5504_REG_RSVD20,
	SM5504_REG_RSVD21,
 	SM5504_REG_RSVD22,
 	SM5504_REG_RSVD23,
	SM5504_REG_RSVD24,
 	SM5504_REG_CHG_TYPE,
 	SM5504_REG_CHG_PUMP = 0x3A,

 	SM5504_REG_END,
};

/* Define SM5504 MASK/SHIFT constant */
#define SM5504_REG_DEVICE_ID_VENDOR_SHIFT	0
#define SM5504_REG_DEVICE_ID_VERSION_SHIFT	3
#define SM5504_REG_DEVICE_ID_VENDOR_MASK	(0x3 << SM5504_REG_DEVICE_ID_VENDOR_SHIFT)
#define SM5504_REG_DEVICE_ID_VERSION_MASK	(0x1f << SM5504_REG_DEVICE_ID_VERSION_SHIFT)

#define SM5504_REG_CONTROL_MASK_INT_MASK	(0x1 << 0)
#define SM5504_REG_CONTROL_MANUAL_SW_MASK	(0x1 << 2)
#define SM5504_REG_CONTROL_SW_OPEN_MASK		(0x1 << 4)
#define SM5504_REG_CONTROL_CHGTYP_MASK		(0x1 << 5)
#define SM5504_REG_CONTROL_USBCHDEN_MASK	(0x1 << 6)
#define SM5504_REG_CONTROL_ADC_EN_MASK		(0x1 << 7)

#define SM5504_REG_INTM1_ATTACH_MASK		(0x1 << 0)
#define SM5504_REG_INTM1_DETACH_MASK		(0x1 << 1)
#define SM5504_REG_INTM1_CHGDET_MASK		(0x1 << 2)
#define SM5504_REG_INTM1_DCD_OUT_MASK		(0x1 << 3)
#define SM5504_REG_INTM1_OVP_MASK		(0x1 << 4)
#define SM5504_REG_INTM1_CONNECT_EVENT_MASK	(0x1 << 5)
#define SM5504_REG_INTM1_ADC_CHG_EVENT_MASK	(0x1 << 6)

#define SM5504_REG_INTM2_RID_CHARGER_MASK	(0x1 << 0)
#define SM5504_REG_INTM2_UVLO_MASK		(0x1 << 1)
#define SM5504_REG_INTM2_POR_MASK		(0x1 << 2)
#define SM5504_REG_INTM2_OVP_FET_MASK		(0x1 << 4)
#define SM5504_REG_INTM2_OCP_LATCH_MASK		(0x1 << 5)
#define SM5504_REG_INTM2_OCP_MASK		(0x1 << 6)
#define SM5504_REG_INTM2_OVP_OCP_MASK		(0X1 << 7)

#define SM5504_REG_ADC_MASK			(0x1f << 0)

#define SM5504_REG_DEV_TYPE1_USB_OTG_MASK		(0x1 << 0)
#define SM5504_REG_DEV_TYPE1_USB_SDP_MASK		(0x1 << 2)
#define SM5504_REG_DEV_TYPE1_UART_MASK			(0x1 << 3)
#define SM5504_REG_DEV_TYPE1_CAR_KIT_CHARGER_MASK	(0x1 << 4)
#define SM5504_REG_DEV_TYPE1_USB_CDP_MASK		(0x1 << 5)
#define SM5504_REG_DEV_TYPE1_USB_DCP_MASK		(0x1 << 6)

#define SM5504_REG_DEV_TYPE2_JIG_USB_ON_MASK		(0x1 << 0)
#define SM5504_REG_DEV_TYPE2_JIG_USB_OFF_MASK		(0x1 << 1)
#define SM5504_REG_DEV_TYPE2_JIG_UART_ON_MASK		(0x1 << 2)
#define SM5504_REG_DEV_TYPE2_JIG_UART_OFF_MASK		(0x1 << 3)
#define SM5504_REG_DEV_TYPE2_UNKNOWN_ACC_MASK		(0x1 << 7)

#define SM5504_REG_RSVD_ID1_DCDTIMER_MASK		(0x1 << 1)
#define SM5504_REG_RSVD_ID1_ENABLE_DCDTIMEOUT_MASK	(0x1 << 2)
#define SM5504_REG_RSVD_ID1_VBUS_DELAY_ENABLE_MASK	(0x1 << 3)
#define SM5504_REG_RSVD_ID1_ADC_DET_T50			(0x0 << 4)
#define SM5504_REG_RSVD_ID1_ADC_DET_T150		(0x1 << 4)
#define SM5504_REG_RSVD_ID1_ADC_DET_T300		(0x2 << 4)
#define SM5504_REG_RSVD_ID1_ADC_DET_T500		(0x3 << 4)
#define SM5504_REG_RSVD_ID1_DEV_TYPE_MODE		(0x1 << 6)
#define SM5504_REG_RSVD_ID1_JIG_PERIODIC		(0x1 << 7)

#define SM5504_REG_MANUAL_SW1_DP_SHIFT		2
#define SM5504_REG_MANUAL_SW1_DM_SHIFT		5
#define SM5504_REG_MANUAL_SW1_DP_MASK		(0x7 << SM5504_REG_MANUAL_SW1_DP_SHIFT)
#define SM5504_REG_MANUAL_SW1_DM_MASK		(0x7 << SM5504_REG_MANUAL_SW1_DM_SHIFT)
#define SM5504_REG_MANUAL_SW1_MASK 		(SM5504_REG_MANUAL_SW1_DP_MASK \
						| SM5504_REG_MANUAL_SW1_DM_MASK)
#define DM_DP_CON_SWITCH_OPEN			0x0
#define DM_DP_CON_SWITCH_USB			0x1
#define DM_DP_CON_SWITCH_UART			0x3
#define DM_DP_SWITCH_OPEN			((DM_DP_CON_SWITCH_OPEN <<SM5504_REG_MANUAL_SW1_DP_SHIFT) \
						| (DM_DP_CON_SWITCH_OPEN <<SM5504_REG_MANUAL_SW1_DM_SHIFT))
#define DM_DP_SWITCH_USB			((DM_DP_CON_SWITCH_USB <<SM5504_REG_MANUAL_SW1_DP_SHIFT) \
						| (DM_DP_CON_SWITCH_USB <<SM5504_REG_MANUAL_SW1_DM_SHIFT))
#define DM_DP_SWITCH_UART			((DM_DP_CON_SWITCH_UART <<SM5504_REG_MANUAL_SW1_DP_SHIFT) \
						| (DM_DP_CON_SWITCH_UART <<SM5504_REG_MANUAL_SW1_DM_SHIFT))

#define SM5504_REG_MANUAL_SW2_VBUSFET		(0x1 << 0)
#define SM5504_REG_MANUAL_SW2_JIG_ON		(0x1 << 2)
#define SM5504_REG_MANUAL_SW2_BOOT_SW		(0x1 << 3)

/* Charger Type Register */
#define SM5504_REG_CHG_SDP_TIMEOUT_MASK			(1 << 3)
#define SM5504_REG_CHG_TYPE_SDP_MASK			(1 << 2)
#define SM5504_REG_CHG_TYPE_CDP_MASK			(1 << 1)
#define SM5504_REG_CHG_TYPE_DCP_MASK			(1 << 0)

#define SM5504_219K_ADC		(0x17)
#define SM5504_365K_ADC		(0x1A)

/* SM5504 Interrupts */
enum sm5504_irq {
	/* INT1 */
	SM5504_IRQ_INT1_ATTACH,
	SM5504_IRQ_INT1_DETACH,
	SM5504_IRQ_INT1_CHGDET,
	SM5504_IRQ_INT1_DCD_OUT,
	SM5504_IRQ_INT1_OVP,
	SM5504_IRQ_INT1_CONNECT,
	SM5504_IRQ_INT1_ADC_CHG,

	/* INT2 */
	SM5504_IRQ_INT2_RID_CHARGER,
	SM5504_IRQ_INT2_UVLO,
	SM5504_IRQ_INT2_POR,
	SM5504_IRQ_INT2_OVP_FET,
	SM5504_IRQ_INT2_OCP_LATCH,
	SM5504_IRQ_INT2_OCP,
	SM5504_IRQ_INT2_OVP_OCP,

	SM5504_IRQ_NUM,
};

#define SM5504_IRQ_INT1_ATTACH_MASK		BIT(0)
#define SM5504_IRQ_INT1_DETACH_MASK		BIT(1)
#define SM5504_IRQ_INT1_CHGDET_MASK		BIT(2)
#define SM5504_IRQ_INT1_DCD_OUT_MASK		BIT(3)
#define SM5504_IRQ_INT1_OVP_MASK		BIT(4)
#define SM5504_IRQ_INT1_CONNECT_MASK		BIT(5)
#define SM5504_IRQ_INT1_ADC_CHG_MASK		BIT(6)
#define SM5504_IRQ_INT1_RSV_MASK		BIT(7)
#define SM5504_IRQ_INT2_RID_CHARGER_MASK	BIT(0)
#define SM5504_IRQ_INT2_UVLO_MASK		BIT(1)
#define SM5504_IRQ_INT2_POR_MASK		BIT(2)
#define SM5504_IRQ_INT2_RSV_MASK		BIT(3)
#define SM5504_IRQ_INT2_OVP_FET_MASK		BIT(4)
#define SM5504_IRQ_INT2_OCP_LATCH_MASK		BIT(5)
#define SM5504_IRQ_INT2_OCP_MASK		BIT(6)
#define SM5504_IRQ_INT2_OVP_OCP_MASK		BIT(7)

/* List of detectable cables */
enum sm5504_cable_type {
	SM5504_CABLE_OTG = 0,
	SM5504_CABLE_USB,
	SM5504_CABLE_UART,
	SM5504_CABLE_CARKIT_T1,
	SM5504_CABLE_CDP,
	SM5504_CABLE_DCP,
	SM5504_CABLE_DESKTOP_DOCK,
	SM5504_CABLE_OTHER_CHARGER,
	SM5504_CABLE_JIG_UART_OFF,
	SM5504_CABLE_JIG_UART_ON,
	SM5504_CABLE_JIG_USB_OFF,
	SM5504_CABLE_JIG_USB_ON,
	SM5504_CABLE_UNKNOWN,
	SM5504_CABLE_UNKNOWN_VB,

	SM5504_CABLE_NONE,
};

extern const char *sm5504_extcon_cable[CABLE_NAME_MAX + 1];
extern int sm5504_set_path(const char *path);
extern void sm5504_dump_fn(void);
extern struct blocking_notifier_head sec_vbus_notifier;
#endif /*  __LINUX_EXTCON_SM5504_H */
