cscope 15 $HOME/sushant_data/common_codebase/NACHO_T_LAUNCHING_KERNEL_5.10_MASTER/product/kernel/drivers/net/wireless/scsc               0002858880
	@acm_api.c

7 
	~<lšux/Ãtdeviû.h
>

8 
	~"mlme.h
"

9 
	~"mib.h
"

10 
	~"debug.h
"

12 
	#TSF_RESP_SIZE
 (14)

	)

14 
	$SDA_g‘Tsf
(cÚ¡ 
if_id
)

16 
Ãt_deviû
 *
dev
 = 
NULL
;

17 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

18 
¦si_dev
 *
sdev
 = 
NULL
;

19 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

20 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

22 
u8
 
»s_·ylßd
[
TSF_RESP_SIZE
] = { 0 };

23 
r
 = 0;

24 
rx_Ëngth
 = 0;

25 
»t
 = 0;

27 
	`»ad_lock
(&
dev_ba£_lock
);

28 
dev
 = 
	`fœ¡_Ãt_deviû
(&
š™_Ãt
);

29 
dev
) {

30 ià(
if_id
 =ğ0 && 
	`memcmp
(
dev
->
Çme
, "wlan0", 5) == 0)

32 ià(
if_id
 =ğ1 && 
	`memcmp
(
dev
->
Çme
, "p2p0", 4) == 0)

34 
dev
 = 
	`Ãxt_Ãt_deviû
(dev);

36 
	`»ad_uÆock
(&
dev_ba£_lock
);

38 ià(!
dev
) {

39 
	`SLSI_ERR
(
sdev
, "dev is‚ull\n");

42 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

43 ià(!
ndev_vif
) {

44 
	`SLSI_ERR
(
sdev
, "ndev_vif is‚ull\n");

47 
sdev
 = 
ndev_vif
->sdev;

48 ià(!
sdev
) {

49 
	`SLSI_ERR
(
sdev
, "sdev is‚ull\n");

53 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "\n");

54 
	`¦si_mib_’code_g‘
(&
mib»q
, 
SLSI_PSID_UNIFI_CURRENT_TSF_TIME
, 0);

55 
mibr¥
.
d©aL’gth
 = (
»s_·ylßd
);

56 
mibr¥
.
d©a
 = 
»s_·ylßd
;

58 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
dev
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
.d©a, mibr¥.d©aL’gth, &
rx_Ëngth
);

60 
	`kä“
(
mib»q
.
d©a
);

62 ià(
r
 == 0) {

63 
mibr¥
.
d©aL’gth
 = 
rx_Ëngth
;

64 ià(
rx_Ëngth
 == 0) {

65 
	`SLSI_ERR
(
sdev
, "Mib decodeƒrror\n");

68 
	`¦si_mib_decodeIÁ64
(&
mibr¥
.
d©a
[4], &
»t
);

70 
	`SLSI_ERR
(
sdev
, "Mib„—d faed (”rÜ: %d)\n", 
r
);

73  
»t
;

74 
	}
}

	@ba.c

7 
	~"debug.h
"

8 
	~"dev.h
"

9 
	~"ba.h
"

10 
	~"mgt.h
"

11 
	~"§p.h
"

19 
ušt
 
	gba_mpdu_»Üd”_age_timeout
 = 100;

20 
moduË_·¿m
(
ba_mpdu_»Üd”_age_timeout
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

21 
MODULE_PARM_DESC
(
ba_mpdu_»Üd”_age_timeout
, "Timeout (in ms) before‡ BA frame in Reorder buffer is…assedo upper†ayers");

23 
boŞ
 
	gba_out_of_¿nge_d–ba_’abË
 = 1;

24 
moduË_·¿m
(
ba_out_of_¿nge_d–ba_’abË
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

25 
MODULE_PARM_DESC
(
ba_out_of_¿nge_d–ba_’abË
, "Optionorigger DELBA on out of„ange frame (1:ƒnable (default), 0: disable)");

27 
	#BA_WINDOW_BOUNDARY
 2048

	)

29 
	#SN_TO_INDEX
(
__ba_£ssiÚ_rx
, 
__¢
è(((__¢ - __ba_£ssiÚ_rx->
¡¬t_¢
è& 0xFFFè% __ba_£ssiÚ_rx->
bufãr_size
)

	)

31 
	#ADVANCE_EXPECTED_SN
(
__ba_£ssiÚ_rx
) \

33 
__ba_£ssiÚ_rx
->
ex³ùed_¢
++; \

34 
__ba_£ssiÚ_rx
->
ex³ùed_¢
 &= 0xFFF; \

35 }

	)

37 
	#FREE_BUFFER_SLOT
(
__ba_£ssiÚ_rx
, 
__šdex
) \

39 
__ba_£ssiÚ_rx
->
occup›d_¦Ùs
--; \

40 
__ba_£ssiÚ_rx
->
bufãr
[
__šdex
].
aùive
 = 
çl£
; \

41 }

	)

43 
	#IS_SN_LESS
(
¢1
, 
¢2
è((((¢1è- (¢2)è& 0xFFFè> 
BA_WINDOW_BOUNDARY
)

	)

45 
	$¦si_rx_ba_š™
(
¦si_dev
 *
sdev
)

47 
	`¦si_¥šlock_ü—‹
(&
sdev
->
rx_ba_bufãr_poŞ_lock
);

48 
	}
}

50 
¦si_ba_£ssiÚ_rx
 *
	$¦si_rx_ba_®loc_bufãr
(
Ãt_deviû
 *
dev
)

52 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

53 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

54 
¦si_ba_£ssiÚ_rx
 *
bufãr
 = 
NULL
;

55 
i
;

57 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "RX BA buffer…ool status: %d,%d,%d,%d,%d,%d,%d,%d\n",

58 
sdev
->
rx_ba_bufãr_poŞ
[0].
u£d
, sdev->rx_ba_buffer_pool[1].used, sdev->rx_ba_buffer_pool[2].used,

59 
sdev
->
rx_ba_bufãr_poŞ
[3].
u£d
, sdev->rx_ba_buffer_pool[4].used, sdev->rx_ba_buffer_pool[5].used,

60 
sdev
->
rx_ba_bufãr_poŞ
[6].
u£d
, sdev->rx_ba_buffer_pool[7].used);

62 
	`¦si_¥šlock_lock
(&
sdev
->
rx_ba_bufãr_poŞ_lock
);

63 
i
 = 0; i < 
SLSI_MAX_RX_BA_SESSIONS
; i++) {

64 ià(!
sdev
->
rx_ba_bufãr_poŞ
[
i
].
u£d
) {

65 
sdev
->
rx_ba_bufãr_poŞ
[
i
].
u£d
 = 
Œue
;

66 
bufãr
 = &
sdev
->
rx_ba_bufãr_poŞ
[
i
];

70 
	`¦si_¥šlock_uÆock
(&
sdev
->
rx_ba_bufãr_poŞ_lock
);

72 ià(!
bufãr
)

73 
	`SLSI_NET_ERR
(
dev
, "No free RX BA buffer\n");

75  
bufãr
;

76 
	}
}

78 
	$¦si_rx_ba_ä“_bufãr
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
, 
tid
)

80 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

81 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

83 
	`¦si_¥šlock_lock
(&
sdev
->
rx_ba_bufãr_poŞ_lock
);

84 ià(
³”
 &&…“r->
ba_£ssiÚ_rx
[
tid
]) {

85 
³”
->
ba_£ssiÚ_rx
[
tid
]->
u£d
 = 
çl£
;

86 
³”
->
ba_£ssiÚ_rx
[
tid
] = 
NULL
;

88 
	`¦si_¥šlock_uÆock
(&
sdev
->
rx_ba_bufãr_poŞ_lock
);

90 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "RX BA buffer…ool status: %d,%d,%d,%d,%d,%d,%d,%d\n",

91 
sdev
->
rx_ba_bufãr_poŞ
[0].
u£d
, sdev->rx_ba_buffer_pool[1].used, sdev->rx_ba_buffer_pool[2].used,

92 
sdev
->
rx_ba_bufãr_poŞ
[3].
u£d
, sdev->rx_ba_buffer_pool[4].used, sdev->rx_ba_buffer_pool[5].used,

93 
sdev
->
rx_ba_bufãr_poŞ
[6].
u£d
, sdev->rx_ba_buffer_pool[7].used);

94 
	}
}

99 
	$¦si_ba_´oûss_com¶‘e
(
Ãt_deviû
 *
dev
, 
boŞ
 
ùx_Çpi
)

101 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

102 
sk_buff
 *
skb
;

104 (
skb
 = 
	`skb_dequeue
(&
ndev_vif
->
ba_com¶‘e
)è!ğ
NULL
) {

105 
	`loÿl_bh_di§bË
();

106 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

107 
	`¦si_rx_d©a_d–iv”_skb
(
ndev_vif
->
sdev
, 
dev
, 
skb
, 
ùx_Çpi
);

108 
	`¦si_¥šlock_lock
(&
ndev_vif
->
ba_lock
);

109 
	`loÿl_bh_’abË
();

111 
	}
}

113 
	$¦si_ba_sigÇl_´oûss_com¶‘e
(
Ãt_deviû
 *
dev
)

115 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

117 
	`©omic_£t
(&
ndev_vif
->
ba_æush
, 1);

118 #iâdeà
CONFIG_SCSC_WLAN_RX_NAPI


119 
	`¦si_skb_scheduË_wÜk
(&
ndev_vif
->
rx_d©a
);

121 
	}
}

123 
	$ba_add_äame_to_ba_com¶‘e
(
Ãt_deviû
 *
dev
, 
¦si_ba_äame_desc
 *
äame_desc
)

125 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

127 
	`skb_queue_
(&
ndev_vif
->
ba_com¶‘e
, 
äame_desc
->
sigÇl
);

128 
	}
}

130 
	$ba_upd©e_ex³ùed_¢
(
Ãt_deviû
 *
dev
,

131 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
, 
u16
 
¢
)

133 
u32
 
i
, 
j
;

134 
u16
 
g­
;

136 
g­
 = (
¢
 - 
ba_£ssiÚ_rx
->
ex³ùed_¢
) & 0xFFF;

137 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Procûs thäame u°tØÃwƒx³ùed_¢ = %d g­ = %d\n", 
¢
, 
g­
);

139 
j
 = 0; j < 
g­
 && j < 
ba_£ssiÚ_rx
->
bufãr_size
; j++) {

140 
i
 = 
	`SN_TO_INDEX
(
ba_£ssiÚ_rx
, ba_£ssiÚ_rx->
ex³ùed_¢
);

141 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Procûs th¦Ù index = %d\n", 
i
);

142 ià(
ba_£ssiÚ_rx
->
bufãr
[
i
].
aùive
) {

143 
	`ba_add_äame_to_ba_com¶‘e
(
dev
, &
ba_£ssiÚ_rx
->
bufãr
[
i
]);

144 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Procûs thäam© index = %dƒx³ùed_¢ = %d\n", 
i
, 
ba_£ssiÚ_rx
->
ex³ùed_¢
);

145 
	`FREE_BUFFER_SLOT
(
ba_£ssiÚ_rx
, 
i
);

147 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Em±y slÙ‡ˆšdex = %d\n", 
i
);

149 
	`ADVANCE_EXPECTED_SN
(
ba_£ssiÚ_rx
);

151 
ba_£ssiÚ_rx
->
ex³ùed_¢
 = 
¢
;

152 
	}
}

154 
	$ba_com¶‘e_»ady_£qu’û
(
Ãt_deviû
 *
dev
,

155 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
)

157 
i
;

159 
i
 = 
	`SN_TO_INDEX
(
ba_£ssiÚ_rx
, ba_£ssiÚ_rx->
ex³ùed_¢
);

160 
ba_£ssiÚ_rx
->
bufãr
[
i
].
aùive
) {

161 
	`ba_add_äame_to_ba_com¶‘e
(
dev
, &
ba_£ssiÚ_rx
->
bufãr
[
i
]);

162 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX_BA
, "Completed stored frame (expected_sn=%d)‡t i = %d\n",

163 
ba_£ssiÚ_rx
->
ex³ùed_¢
, 
i
);

164 
	`FREE_BUFFER_SLOT
(
ba_£ssiÚ_rx
, 
i
);

165 
	`ADVANCE_EXPECTED_SN
(
ba_£ssiÚ_rx
);

166 
i
 = 
	`SN_TO_INDEX
(
ba_£ssiÚ_rx
, ba_£ssiÚ_rx->
ex³ùed_¢
);

168 
	}
}

170 
	$ba_süŞl_wšdow
(
Ãt_deviû
 *
dev
,

171 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
, 
u16
 
¢
)

173 ià(((
¢
 - 
ba_£ssiÚ_rx
->
ex³ùed_¢
è& 0xFFFè<ğ
BA_WINDOW_BOUNDARY
) {

174 
	`ba_upd©e_ex³ùed_¢
(
dev
, 
ba_£ssiÚ_rx
, 
¢
);

175 
	`ba_com¶‘e_»ady_£qu’û
(
dev
, 
ba_£ssiÚ_rx
);

177 
	}
}

179 
	$ba_d–‘e_ba_Ú_Şd_äame
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
,

180 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
, 
u16
 
¢
)

182 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

183 
§p_drv_ma_to_mlme_d–ba_»q
 *
d–ba_»q
;

184 
sk_buff
 *
skb
 = 
NULL
;

186 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX_BA
, "¢=%d\n", 
¢
);

188 
skb
 = 
	`®loc_skb
((
§p_drv_ma_to_mlme_d–ba_»q
), 
GFP_ATOMIC
);

190 ià(
	`WARN_ON
(!
skb
))

193 
ba_£ssiÚ_rx
->
şosšg
 = 
Œue
;

194 
	`¦si_skb_cb_š™
(
skb
)->
sig_Ëngth
 = (
§p_drv_ma_to_mlme_d–ba_»q
);

195 
	`¦si_skb_cb_g‘
(
skb
)->
d©a_Ëngth
 = (
§p_drv_ma_to_mlme_d–ba_»q
);

197 
d–ba_»q
 = (
§p_drv_ma_to_mlme_d–ba_»q
 *)
	`skb_put
(
skb
, (sap_drv_ma_to_mlme_delba_req));

198 
d–ba_»q
->
h—d”
.
id
 = 
	`ıu_to_Ë16
(
SAP_DRV_MA_TO_MLME_DELBA_REQ
);

199 
d–ba_»q
->
h—d”
.
»ûiv”_pid
 = 0;

200 
d–ba_»q
->
h—d”
.
£nd”_pid
 = 0;

201 
d–ba_»q
->
h—d”
.
fw_»ã»nû
 = 0;

202 
d–ba_»q
->
vif
 = 
ndev_vif
->
iâum
;

204 
	`memıy
(
d–ba_»q
->
³”_q¡a_add»ss
, 
³”
->
add»ss
, 
ETH_ALEN
);

205 
d–ba_»q
->
£qu’û_numb”
 = 
¢
;

206 
d–ba_»q
->
u£r_´iÜ™y
 = 
ba_£ssiÚ_rx
->
tid
;

207 
d–ba_»q
->
»asÚ
 = 
FAPI_REASONCODE_OUT_OF_RANGE_SEQUENCE_NUMBER
;

208 
d–ba_»q
->
dœeùiÚ
 = 
FAPI_DIRECTION_RECEIVE
;

211 
	`¦si_rx_’queue_Ãtdev_mlme
(
ndev_vif
->
sdev
, 
skb
, 
	`çpi_g‘_vif
(skb));

212 
	}
}

214 
	$ba_cÚsume_äame_Ü_g‘_bufãr_šdex
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
,

215 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
, 
u16
 
¢
, 
¦si_ba_äame_desc
 *
äame_desc
, 
boŞ
 *
¡İ_tim”
)

217 
i
;

218 
u16
 
¢_‹mp
;

219 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


220 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

223 *
¡İ_tim”
 = 
çl£
;

225 ià(((
¢
 - 
ba_£ssiÚ_rx
->
ex³ùed_¢
è& 0xFFFè<ğ
BA_WINDOW_BOUNDARY
) {

227 ià(!
ba_£ssiÚ_rx
->
Œigg”_ba_aá”_s¢
)

228 
ba_£ssiÚ_rx
->
Œigg”_ba_aá”_s¢
 = 
Œue
;

230 
¢_‹mp
 = 
ba_£ssiÚ_rx
->
ex³ùed_¢
 + ba_£ssiÚ_rx->
bufãr_size
;

231 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX_BA
, "New f¿me: sn=%d\n", 
¢
);

233 ià(!(((
¢
 - 
¢_‹mp
è& 0xFFFè> 
BA_WINDOW_BOUNDARY
)) {

234 
u16
 
Ãw_ex³ùed_¢
;

236 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_RX_BA
, "Frame is out of window\n");

237 
¢_‹mp
 = (
¢
 - 
ba_£ssiÚ_rx
->
bufãr_size
) & 0xFFF;

238 ià(
ba_£ssiÚ_rx
->
tim”_Ú
)

239 *
¡İ_tim”
 = 
Œue
;

240 
Ãw_ex³ùed_¢
 = (
¢_‹mp
 + 1) & 0xFFF;

241 
	`ba_upd©e_ex³ùed_¢
(
dev
, 
ba_£ssiÚ_rx
, 
Ãw_ex³ùed_¢
);

244 
i
 = -1;

245 ià(
¢
 =ğ
ba_£ssiÚ_rx
->
ex³ùed_¢
) {

246 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX_BA
, "¢ = ba_£ssiÚ_rx->ex³ùed_¢ = %d\n", 
¢
);

247 ià(
ba_£ssiÚ_rx
->
tim”_Ú
)

248 *
¡İ_tim”
 = 
Œue
;

249 
	`ADVANCE_EXPECTED_SN
(
ba_£ssiÚ_rx
);

250 
	`ba_add_äame_to_ba_com¶‘e
(
dev
, 
äame_desc
);

252 
i
 = 
	`SN_TO_INDEX
(
ba_£ssiÚ_rx
, 
¢
);

253 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX_BA
, "¢ (%dè!ğba_£ssiÚ_rx->ex³ùed_¢(%d), i = %d\n", 
¢
, 
ba_£ssiÚ_rx
->
ex³ùed_¢
, 
i
);

254 ià(
ba_£ssiÚ_rx
->
bufãr
[
i
].
aùive
) {

255 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "ä“ f¿m© i = %d\n", 
i
);

256 
i
 = -1;

257 #ifdeà
CONFIG_SCSC_SMAPPER


258 
	`h4_sm­³r_ä“_m­³d_skb
(
äame_desc
->
sigÇl
);

260 
	`kä“_skb
(
äame_desc
->
sigÇl
);

263 ià(!
	`IS_SN_LESS
(
¢
, 
ba_£ssiÚ_rx
->
highe¡_»ûived_¢
))

264 
ba_£ssiÚ_rx
->
highe¡_»ûived_¢
 = 
¢
;

266 
i
 = -1;

267 ià(!
ba_£ssiÚ_rx
->
Œigg”_ba_aá”_s¢
) {

268 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "äambefÜs¢,…as ™ up: sn=%d\n", 
¢
);

269 
	`ba_add_äame_to_ba_com¶‘e
(
dev
, 
äame_desc
);

271 ià(
	`¦si_is_tdls_³”
(
dev
, 
³”
)) {

278 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_RX_BA
, "tdls: fÜw¬d old f¿me: sn=%d,ƒx³ùed_¢=%d\n", 
¢
, 
ba_£ssiÚ_rx
->
ex³ùed_¢
);

279 
	`ba_add_äame_to_ba_com¶‘e
(
dev
, 
äame_desc
);

287 ià(
	`IS_SN_LESS
(
ba_£ssiÚ_rx
->
highe¡_»ûived_¢
, ((
¢
 + ba_£ssiÚ_rx->
bufãr_size
) & 0xFFF))) {

288 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Şd f¿me, buˆ¡Èš wšdow: sn=%d, highe¡_»ûived_¢=%d\n", 
¢
, 
ba_£ssiÚ_rx
->
highe¡_»ûived_¢
);

289 
	`ba_add_äame_to_ba_com¶‘e
(
dev
, 
äame_desc
);

291 ià(!
ba_out_of_¿nge_d–ba_’abË
) {

292 
	`SLSI_NET_WARN
(
dev
, "Şd f¿me, drİ: sn=%d,ƒx³ùed_¢=%d\n", 
¢
, 
ba_£ssiÚ_rx
->
ex³ùed_¢
);

293 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


294 ià(
ndev_vif
->
’hªûd_¬p_d‘eù_’abËd
)

295 
	`¦si_fl_’hªûd_¬p_out_of_Üd”_drİ_couÁ”
(
ndev_vif
, 
äame_desc
->
sigÇl
);

297 #ifdeà
CONFIG_SCSC_SMAPPER


298 
	`h4_sm­³r_ä“_m­³d_skb
(
äame_desc
->
sigÇl
);

300 
	`kä“_skb
(
äame_desc
->
sigÇl
);

302 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Şd f¿me,‡cû± buˆa couÁ”m—su» in™Ÿ‹ d–‘BA: sn=%d,ƒx³ùed_¢=%d\n", 
¢
, 
ba_£ssiÚ_rx
->
ex³ùed_¢
);

303 
	`ba_add_äame_to_ba_com¶‘e
(
dev
, 
äame_desc
);

305 ià(!
ba_£ssiÚ_rx
->
şosšg
)

306 
	`ba_d–‘e_ba_Ú_Şd_äame
(
dev
, 
³”
, 
ba_£ssiÚ_rx
, 
¢
);

312  
i
;

313 
	}
}

315 #ià
KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


316 
	$¦si_ba_agšg_timeout_hªdËr
(
tim”_li¡
 *
t
)

318 
	$¦si_ba_agšg_timeout_hªdËr
(
d©a
)

321 #ià
	`KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


322 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
 = 
	`äom_tim”
(ba_£ssiÚ_rx, 
t
, 
ba_age_tim”
);

324 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
 = (¦si_ba_£ssiÚ_rx *)
d©a
;

326 
u8
 
i
, 
j
;

327 
u8
 
g­
 = 1;

328 
u16
 
‹mp_¢
;

329 
Ãt_deviû
 *
dev
 = 
ba_£ssiÚ_rx
->dev;

330 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

332 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "\n");

334 
	`¦si_¥šlock_lock
(&
ndev_vif
->
ba_lock
);

336 
ba_£ssiÚ_rx
->
tim”_Ú
 = 
çl£
;

338 ià(
ba_£ssiÚ_rx
->
aùive
 && ba_£ssiÚ_rx->
occup›d_¦Ùs
) {

343 
‹mp_¢
 = (
ba_£ssiÚ_rx
->
ex³ùed_¢
 + 1) & 0xFFF;

345 
j
 = 0; j < 
ba_£ssiÚ_rx
->
bufãr_size
; j++) {

346 
i
 = 
	`SN_TO_INDEX
(
ba_£ssiÚ_rx
, 
‹mp_¢
);

348 ià(
ba_£ssiÚ_rx
->
bufãr
[
i
].
aùive
) {

349 
g­
--)

350 
	`ADVANCE_EXPECTED_SN
(
ba_£ssiÚ_rx
);

352 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Com¶‘ed stÜed f¿mÓx³ùed_¢=%dè© i = %d\n", 
ba_£ssiÚ_rx
->
ex³ùed_¢
, 
i
);

353 
	`ba_add_äame_to_ba_com¶‘e
(
dev
, &
ba_£ssiÚ_rx
->
bufãr
[
i
]);

354 
	`FREE_BUFFER_SLOT
(
ba_£ssiÚ_rx
, 
i
);

355 
	`ADVANCE_EXPECTED_SN
(
ba_£ssiÚ_rx
);

356 
	`ba_com¶‘e_»ady_£qu’û
(
dev
, 
ba_£ssiÚ_rx
);

360 
‹mp_¢
 = (temp_sn + 1) & 0xFFF;

361 
g­
++;

366 ià(
ba_£ssiÚ_rx
->
aùive
 && ba_£ssiÚ_rx->
occup›d_¦Ùs
) {

367 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Timer start\n");

368 
	`mod_tim”
(&
ba_£ssiÚ_rx
->
ba_age_tim”
, 
jiff›s
 + 
	`m£cs_to_jiff›s
(
ba_mpdu_»Üd”_age_timeout
));

369 
ba_£ssiÚ_rx
->
tim”_Ú
 = 
Œue
;

372 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


373 
	`¦si_ba_´oûss_com¶‘e
(
dev
, 
çl£
);

375 
	`¦si_ba_sigÇl_´oûss_com¶‘e
(
dev
);

378 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

379 
	}
}

381 
	$¦si_ba_´oûss_äame
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
,

382 
sk_buff
 *
skb
, 
u16
 
£qu’û_numb”
, u16 
tid
)

384 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

385 
i
;

386 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
 = 
³”
->ba_£ssiÚ_rx[
tid
];

387 
¦si_ba_äame_desc
 
äame_desc
;

388 
boŞ
 
¡İ_tim”
 = 
çl£
;

390 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX_BA
, "GÙ f¿me(¢=%d)\n", 
£qu’û_numb”
);

392 ià(
	`WARN_ON
(
tid
 > 
FAPI_PRIORITY_QOS_UP7
)) {

393 
	`SLSI_NET_ERR
(
dev
, "tid=%d\n", 
tid
);

394  -
EINVAL
;

397 ià(!
ba_£ssiÚ_rx
)

398  -
EINVAL
;

400 
	`¦si_¥šlock_lock
(&
ndev_vif
->
ba_lock
);

402 ià(!
ba_£ssiÚ_rx
->
aùive
) {

403 
	`SLSI_NET_ERR
(
dev
, "No BA sessionƒxists\n");

404 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

405  -
EINVAL
;

408 
äame_desc
.
sigÇl
 = 
skb
;

409 
äame_desc
.
¢
 = 
£qu’û_numb”
;

410 
äame_desc
.
aùive
 = 
Œue
;

412 
i
 = 
	`ba_cÚsume_äame_Ü_g‘_bufãr_šdex
(
dev
, 
³”
, 
ba_£ssiÚ_rx
, 
£qu’û_numb”
, &
äame_desc
, &
¡İ_tim”
);

413 ià(
i
 >= 0) {

414 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX_BA
, "StÜäame(¢=%dè© i = %d\n", 
£qu’û_numb”
, 
i
);

415 
ba_£ssiÚ_rx
->
bufãr
[
i
] = 
äame_desc
;

416 
ba_£ssiÚ_rx
->
occup›d_¦Ùs
++;

418 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX_BA
, "F¿mcÚsumed - sÀğ%d\n", 
£qu’û_numb”
);

421 
	`ba_com¶‘e_»ady_£qu’û
(
dev
, 
ba_£ssiÚ_rx
);

437 ià(!
ba_£ssiÚ_rx
->
tim”_Ú
) {

438 ià(
ba_£ssiÚ_rx
->
occup›d_¦Ùs
) {

439 
¡İ_tim”
 = 
çl£
;

440 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Timer start\n");

441 
	`mod_tim”
(&
ba_£ssiÚ_rx
->
ba_age_tim”
, 
jiff›s
 + 
	`m£cs_to_jiff›s
(
ba_mpdu_»Üd”_age_timeout
));

442 
ba_£ssiÚ_rx
->
tim”_Ú
 = 
Œue
;

444 } ià(!
ba_£ssiÚ_rx
->
occup›d_¦Ùs
) {

445 
¡İ_tim”
 = 
Œue
;

446 } ià(
¡İ_tim”
) {

447 
¡İ_tim”
 = 
çl£
;

448 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Timer„estart\n");

449 
	`mod_tim”
(&
ba_£ssiÚ_rx
->
ba_age_tim”
, 
jiff›s
 + 
	`m£cs_to_jiff›s
(
ba_mpdu_»Üd”_age_timeout
));

450 
ba_£ssiÚ_rx
->
tim”_Ú
 = 
Œue
;

453 ià(
¡İ_tim”
) {

454 
ba_£ssiÚ_rx
->
tim”_Ú
 = 
çl£
;

455 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

456 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Timer stop\n");

457 
	`d–_tim”_sync
(&
ba_£ssiÚ_rx
->
ba_age_tim”
);

459 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

461 
	`¦si_ba_sigÇl_´oûss_com¶‘e
(
dev
);

463 
	}
}

465 
boŞ
 
	$¦si_ba_check
(
¦si_³”
 *
³”
, 
u16
 
tid
)

467 ià(
tid
 > 
FAPI_PRIORITY_QOS_UP7
)

468  
çl£
;

469 ià(!
³”
->
ba_£ssiÚ_rx
[
tid
])

470  
çl£
;

472  
³”
->
ba_£ssiÚ_rx
[
tid
]->
aùive
;

473 
	}
}

475 
	$__¦si_rx_ba_¡İ
(
Ãt_deviû
 *
dev
, 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
)

477 
u8
 
i
, 
j
;

479 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_RX_BA
, "Stİpšg BA sessiÚ:id = %d\n", 
ba_£ssiÚ_rx
->
tid
);

481 ià(
	`WARN_ON
(!
ba_£ssiÚ_rx
->
aùive
)) {

482 
	`SLSI_NET_ERR
(
dev
, "No BA sessionƒxists\n");

486 
i
 = 
	`SN_TO_INDEX
(
ba_£ssiÚ_rx
, ba_£ssiÚ_rx->
ex³ùed_¢
), 
j
 = 0;

487 
j
 < 
ba_£ssiÚ_rx
->
bufãr_size
; 
i
++, j++) {

488 
i
 %ğ
ba_£ssiÚ_rx
->
bufãr_size
;

489 ià(
ba_£ssiÚ_rx
->
bufãr
[
i
].
aùive
) {

490 
	`ba_add_äame_to_ba_com¶‘e
(
dev
, &
ba_£ssiÚ_rx
->
bufãr
[
i
]);

491 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX_BA
, "Com¶‘ed stÜed f¿m© i = %d\n", 
i
);

492 
	`FREE_BUFFER_SLOT
(
ba_£ssiÚ_rx
, 
i
);

496 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


497 
	`¦si_ba_´oûss_com¶‘e
(
dev
, 
çl£
);

499 
	`¦si_ba_sigÇl_´oûss_com¶‘e
(
dev
);

502 
ba_£ssiÚ_rx
->
aùive
 = 
çl£
;

503 
	}
}

505 
	$¦si_rx_ba_¡İ_lock_h–d
(
Ãt_deviû
 *
dev
, 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
)

507 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

509 
	`__¦si_rx_ba_¡İ
(
dev
, 
ba_£ssiÚ_rx
);

510 
ba_£ssiÚ_rx
->
tim”_Ú
 = 
çl£
;

511 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

512 
	`d–_tim”_sync
(&
ba_£ssiÚ_rx
->
ba_age_tim”
);

513 
	`¦si_¥šlock_lock
(&
ndev_vif
->
ba_lock
);

514 
	}
}

516 
	$¦si_rx_ba_¡İ_lock_unh–d
(
Ãt_deviû
 *
dev
, 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
)

518 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

520 
	`¦si_¥šlock_lock
(&
ndev_vif
->
ba_lock
);

521 
	`__¦si_rx_ba_¡İ
(
dev
, 
ba_£ssiÚ_rx
);

522 
ba_£ssiÚ_rx
->
tim”_Ú
 = 
çl£
;

523 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

524 
	`d–_tim”_sync
(&
ba_£ssiÚ_rx
->
ba_age_tim”
);

525 
	}
}

527 
	$¦si_rx_ba_¡İ_®l
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
)

529 
i
;

531 
i
 = 0; i < 
NUM_BA_SESSIONS_PER_PEER
; i++)

532 ià(
³”
->
ba_£ssiÚ_rx
[
i
] &&…“r->ba_£ssiÚ_rx[i]->
aùive
) {

533 
	`¦si_rx_ba_¡İ_lock_unh–d
(
dev
, 
³”
->
ba_£ssiÚ_rx
[
i
]);

534 
	`¦si_rx_ba_ä“_bufãr
(
dev
, 
³”
, 
i
);

536 
	}
}

538 
	$¦si_rx_ba_¡¬t
(
Ãt_deviû
 *
dev
,

539 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
,

540 
u16
 
tid
, u16 
bufãr_size
, u16 
¡¬t_¢
)

542 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

544 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_RX_BA
, "Requesto start‡‚ew BA sessionid=%d buffer_size=%d start_sn=%d\n",

545 
tid
, 
bufãr_size
, 
¡¬t_¢
);

547 ià(
	`WARN_ON
((!
bufãr_size
è|| (bufãr_siz> 
SLSI_BA_BUFFER_SIZE_MAX
))) {

548 
	`SLSI_NET_ERR
(
dev
, "Inv®id wšdow size: bufãr_size=%d\n", 
bufãr_size
);

549  -
EINVAL
;

552 
	`¦si_¥šlock_lock
(&
ndev_vif
->
ba_lock
);

554 ià(
ba_£ssiÚ_rx
->
aùive
) {

555 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_RX_BA
, "BA session‡lreadyƒxists\n");

557 ià((
ba_£ssiÚ_rx
->
bufãr_size
 == buffer_size) &&

558 (
ba_£ssiÚ_rx
->
ex³ùed_¢
 =ğ
¡¬t_¢
)) {

559 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_RX_BA
,

561 
tid
);

562 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

565 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_RX_BA
, "P¬am‘” dÚ'ˆm©ch sØ¡İhexi¡šg BA sessiÚ:id=%d\n", 
tid
);

566 
	`¦si_rx_ba_¡İ_lock_h–d
(
dev
, 
ba_£ssiÚ_rx
);

569 
ba_£ssiÚ_rx
->
dev
 = dev;

570 
ba_£ssiÚ_rx
->
bufãr_size
 = buffer_size;

571 
ba_£ssiÚ_rx
->
¡¬t_¢
 = start_sn;

572 
ba_£ssiÚ_rx
->
ex³ùed_¢
 = 
¡¬t_¢
;

573 
ba_£ssiÚ_rx
->
highe¡_»ûived_¢
 = 0;

574 
ba_£ssiÚ_rx
->
şosšg
 = 
çl£
;

575 
ba_£ssiÚ_rx
->
Œigg”_ba_aá”_s¢
 = 
çl£
;

576 
ba_£ssiÚ_rx
->
tid
 =id;

577 
ba_£ssiÚ_rx
->
tim”_Ú
 = 
çl£
;

578 #ià
	`KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


579 
	`tim”_£tup
(&
ba_£ssiÚ_rx
->
ba_age_tim”
, 
¦si_ba_agšg_timeout_hªdËr
, 0);

581 
ba_£ssiÚ_rx
->
ba_age_tim”
.
funùiÚ
 = 
¦si_ba_agšg_timeout_hªdËr
;

582 
ba_£ssiÚ_rx
->
ba_age_tim”
.
d©a
 = ()ba_session_rx;

583 
	`š™_tim”
(&
ba_£ssiÚ_rx
->
ba_age_tim”
);

586 
ba_£ssiÚ_rx
->
aùive
 = 
Œue
;

587 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_RX_BA
, "Started‡‚ew BA sessionid=%d buffer_size=%d start_sn=%d\n",

588 
tid
, 
bufãr_size
, 
¡¬t_¢
);

590 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

591 
	`¦si_ba_sigÇl_´oûss_com¶‘e
(
dev
);

594 
	}
}

596 
	$¦si_ba_upd©e_wšdow
(
Ãt_deviû
 *
dev
,

597 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
, 
u16
 
£qu’û_numb”
)

599 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

601 
	`¦si_¥šlock_lock
(&
ndev_vif
->
ba_lock
);

603 ià(
	`WARN_ON
(!
ba_£ssiÚ_rx
->
aùive
)) {

604 
	`SLSI_NET_ERR
(
dev
, "No BA sessionƒxists\n");

605 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

609 
	`ba_süŞl_wšdow
(
dev
, 
ba_£ssiÚ_rx
, 
£qu’û_numb”
);

610 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


611 
	`¦si_ba_´oûss_com¶‘e
(
dev
, 
çl£
);

613 
	`¦si_ba_sigÇl_´oûss_com¶‘e
(
dev
);

615 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

616 
	}
}

618 
	$¦si_hªdË_blockack
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
,

619 
u16
 
vif
, 
u8
 *
³”_q¡a_add»ss
, u16 
·¿m‘”_£t
, u16 
£qu’û_numb”
,

620 
u16
 
»asÚ_code
, u16 
dœeùiÚ
)

622 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
;

623 
u16
 
u£r_´iÜ™y
 = (
·¿m‘”_£t
 >> 2) & 0x000F;

624 
u16
 
bufãr_size
 = (
·¿m‘”_£t
 >> 6) & 0x03FF;

626 
	`SLSI_UNUSED_PARAMETER
(
vif
);

627 
	`SLSI_UNUSED_PARAMETER
(
³”_q¡a_add»ss
);

629 ià(
	`WARN_ON
(
u£r_´iÜ™y
 > 
FAPI_PRIORITY_QOS_UP7
)) {

630 
	`SLSI_NET_ERR
(
dev
, "Inv®id u£r_´iÜ™y=%d\n", 
u£r_´iÜ™y
);

634 
dœeùiÚ
) {

635 
FAPI_DIRECTION_TRANSMIT
:

637 
FAPI_DIRECTION_RECEIVE
:

638 
ba_£ssiÚ_rx
 = 
³”
->ba_£ssiÚ_rx[
u£r_´iÜ™y
];

640 
»asÚ_code
) {

641 
FAPI_REASONCODE_START
:

642 ià(!
³”
->
ba_£ssiÚ_rx
[
u£r_´iÜ™y
])

643 
³”
->
ba_£ssiÚ_rx
[
u£r_´iÜ™y
] = 
	`¦si_rx_ba_®loc_bufãr
(
dev
);

645 ià(
³”
->
ba_£ssiÚ_rx
[
u£r_´iÜ™y
])

646 ià(
	`¦si_rx_ba_¡¬t
(
dev
, 
³”
->
ba_£ssiÚ_rx
[
u£r_´iÜ™y
], u£r_´iÜ™y, 
bufãr_size
, 
£qu’û_numb”
) != 0)

647 
	`¦si_rx_ba_ä“_bufãr
(
dev
, 
³”
, 
u£r_´iÜ™y
);

649 
FAPI_REASONCODE_END
:

650 ià(
ba_£ssiÚ_rx
) {

651 
	`¦si_rx_ba_¡İ_lock_unh–d
(
dev
, 
ba_£ssiÚ_rx
);

652 
	`¦si_rx_ba_ä“_bufãr
(
dev
, 
³”
, 
u£r_´iÜ™y
);

655 
FAPI_REASONCODE_UNSPECIFIED_REASON
:

656 ià(
ba_£ssiÚ_rx
)

657 
	`¦si_ba_upd©e_wšdow
(
dev
, 
ba_£ssiÚ_rx
, 
£qu’û_numb”
);

660 
	`SLSI_NET_ERR
(
dev
, "Inv®id v®ue:„—sÚ_code=%d\n", 
»asÚ_code
);

665 
	`SLSI_NET_ERR
(
dev
, "Inv®id v®ue: dœeùiÚ=%d\n", 
dœeùiÚ
);

668 
	}
}

	@ba.h

7 #iâdeà
__SLSI_BA_H__


8 
	#__SLSI_BA_H__


	)

10 
	~"dev.h
"

12 
¦si_hªdË_blockack
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
,

13 
u16
 
vif
, 
u8
 *
³”_q¡a_add»ss
, u16 
·¿m‘”_£t
, u16 
£qu’û_numb”
,

14 
u16
 
»asÚ_code
, u16 
dœeùiÚ
);

16 
¦si_ba_´oûss_äame
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
,

17 
sk_buff
 *
skb
, 
u16
 
£qu’û_numb”
, u16 
tid
);

19 
¦si_ba_upd©e_wšdow
(
Ãt_deviû
 *
dev
,

20 
¦si_ba_£ssiÚ_rx
 *
ba_£ssiÚ_rx
, 
u16
 
£qu’û_numb”
);

22 
¦si_ba_´oûss_com¶‘e
(
Ãt_deviû
 *
dev
, 
boŞ
 
ùx_Çpi
);

24 
boŞ
 
¦si_ba_check
(
¦si_³”
 *
³”
, 
u16
 
tid
);

26 
¦si_rx_ba_¡İ_®l
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
);

28 
¦si_rx_ba_š™
(
¦si_dev
 *
sdev
);

	@cac.c

7 
	~"ÿc.h
"

9 
ÿc_t¥ec
 *
	gt¥ec_li¡
;

10 
	gt¥ec_li¡_Ãxt_id
;

11 
u8
 
	gdŸlog_tok’_Ãxt
;

14 
t¥ec_f›ld
 
	gt¥ec_f›lds
[] = {

24 { "nomš®_msdu_size", 0, 0, 2, 
OFFSETOF
(
nomš®_msdu_size
) },

25 { "max_msdu_size", 0, 0, 2, 
OFFSETOF
(
maximum_msdu_size
) },

26 { "mš_£rviû_š‹rv®", 0, 0, 4, 
OFFSETOF
(
mšimum_£rviû_š‹rv®
) },

27 { "max_£rviû_š‹rv®", 0, 0, 4, 
OFFSETOF
(
maximum_£rviû_š‹rv®
) },

28 { "šaùiv™y_š‹rv®", 0, 0, 4, 
OFFSETOF
(
šaùiv™y_š‹rv®
) },

29 { "su¥’siÚ_š‹rv®", 0, 0, 4, 
OFFSETOF
(
su¥’siÚ_š‹rv®
) },

30 { "£rviû_¡¬t_time", 0, 0, 4, 
OFFSETOF
(
£rviû_¡¬t_time
) },

31 { "mš_d©a_¿‹", 0, 0, 4, 
OFFSETOF
(
mšimum_d©a_¿‹
) },

32 { "m—n_d©a_¿‹", 0, 0, 4, 
OFFSETOF
(
m—n_d©a_¿‹
) },

33 { "³ak_d©a_¿‹", 0, 0, 4, 
OFFSETOF
(
³ak_d©a_¿‹
) },

34 { "max_bur¡_size", 0, 0, 4, 
OFFSETOF
(
maximum_bur¡_size
) },

35 { "d–ay_bound", 0, 0, 4, 
OFFSETOF
(
d–ay_bound
) },

36 { "mš_phy_¿‹", 0, 0, 4, 
OFFSETOF
(
mšimum_phy_¿‹
) },

38 
OFFSETOF
(
su½lus_bªdwidth_®lowªû
) },

39 { "medium_time", 0, 0, 2, 
OFFSETOF
(
medium_time
) },

43 cÚ¡ 
u8
 
	gTSRS_OUI_TYPE
[] = { 0x00, 0x40, 0x96, 0x08 };

44 cÚ¡ 
u8
 
	gEBW_OUI_TYPE
[] = { 0x00, 0x40, 0x96, 0x0F };

46 cÚ¡ 
	gNUM_TSPEC_FIELDS
 = (
t¥ec_f›lds
è/ (
t¥ec_f›ld
);

47 
u32
 
	g´evious_msdu_liãtime
 = 
MAX_TRANSMIT_MSDU_LIFETIME_NOT_VALID
;

48 
u8
 
	gccx_¡©us
 = 
BSS_CCX_DISABLED
;

50 
ÿc_£t_ric_›
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
Ãtdev
);

51 
ÿc_g‘_rde_t¥ec_›
(
¦si_dev
 *
sdev
, 
u8
 *
assoc_r¥_›
, 
assoc_r¥_›_Ën
, cÚ¡ u8 **
t¥ec_›_¬r
);

60 
ÿc_t¥ec
 *
	$fšd_t¥ec_’Œy
(
id
, 
acû±ed
)

62 
ÿc_t¥ec
 *
™r
;

64 
™r
 = 
t¥ec_li¡
;

65 
™r
 !ğ
NULL
) {

66 ià((
™r
->
id
 =ğidè&& (™r->
acû±ed
 ==‡ccepted))

68 
™r
 = iŒ->
Ãxt
;

70  
™r
;

71 
	}
}

81 
	$ÿc_qu”y_t¥ec_f›ld
(
¦si_dev
 *
sdev
, 
ÿc_t¥ec
 *
’Œy
, cÚ¡ *
f›ld
, 
u32
 *
v®ue
)

83 
i
;

84 
u32
 
tsšfo
;

85 
u8
 
mask
;

86 
u8
 *
pos
;

88 ià((
’Œy
 =ğ
NULL
è|| (
f›ld
 =ğNULLè|| (
v®ue
 == NULL))

91 
i
 = 0; i < 
NUM_TSPEC_FIELDS
; i++)

92 ià(
	`¡rÿ£cmp
(
f›ld
, 
t¥ec_f›lds
[
i
].
Çme
) == 0)

94 ià(
i
 >ğ
NUM_TSPEC_FIELDS
) {

95 
	`SLSI_ERR
(
sdev
, "CAC: Invalid TSPEC config field\n");

98 ià(
t¥ec_f›lds
[
i
].
is_tsšfo_f›ld
) {

99 
mask
 = 
t¥ec_f›lds
[
i
].
size
;

100 
tsšfo
 = 
	`CAC_GET_LE24
(&
’Œy
->
t¥ec
.
ts_šfo
[0]è& 
TSINFO_MASK
;

101 *
v®ue
 = (
tsšfo
 >> 
t¥ec_f›lds
[
i
].
off£t
è& 
mask
;

103 
pos
 = (
u8
 *)(&
’Œy
->
t¥ec
è+ 
t¥ec_f›lds
[
i
].
off£t
;

104 ià(
t¥ec_f›lds
[
i
].
size
 == 1)

105 *
v®ue
 = (*
pos
 & 0xFF);

106 ià(
t¥ec_f›lds
[
i
].
size
 == 2)

107 *
v®ue
 = 
	`CAC_GET_LE16
(
pos
);

109 *
v®ue
 = 
	`CAC_GET_LE32
(
pos
);

113 
	}
}

120 
Ãt_deviû
 *
	$g‘_Ãtdev_fÜ_¡©iÚ
(
¦si_dev
 *
sdev
)

122 
Ãt_deviû
 *
dev
;

123 
Ãtdev_vif
 *
ndev_vif
;

124 
s32
 
vif
;

126 
vif
 = 1; vià<ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; vif++) {

127 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
vif
);

128 ià(!
dev
)

130 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

131 ià(!
ndev_vif
)

133 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

134 
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
)

135  
dev
;

137  
NULL
;

138 
	}
}

147 
	$add_ebw_›
(
u8
 *
buf
, 
size_t
 
buf_Ën
, u8 
tsid
)

149 
u8
 *
pos
;

151 ià((
buf
 =ğ
NULL
è|| (
buf_Ën
 < 8))

154 
pos
 = 
buf
;

155 *
pos
++ = 
WLAN_EID_VENDOR_SPECIFIC
;

156 *
pos
++ = 6;

157 
	`memıy
(
pos
, 
EBW_OUI_TYPE
, (EBW_OUI_TYPE));

158 
pos
 +ğ(
EBW_OUI_TYPE
);

159 *
pos
++ = 
tsid
;

160 *
pos
++ = 0;

162  
pos
 - 
buf
;

163 
	}
}

174 
	$add_t¤s_›
(
u8
 *
buf
, 
size_t
 
buf_Ën
, u8 
tsid
,

175 
u8
 
¿‹s
[
CCX_MAX_NUM_RATES
], 
size_t
 
num_¿‹s
)

177 
u8
 *
pos
;

178 
size_t
 
›_Ën
 = 7 + 
num_¿‹s
;

179 
i
;

181 ià((
buf
 =ğ
NULL
è|| (
buf_Ën
 < 
›_Ën
è|| (
¿‹s
 == NULL) ||

182 (
num_¿‹s
 > 
CCX_MAX_NUM_RATES
))

185 
pos
 = 
buf
;

186 
	`mem£t
(
pos
, 0, 
›_Ën
);

187 *
pos
++ = 
WLAN_EID_VENDOR_SPECIFIC
;

188 *
pos
++ = 
›_Ën
 - 2;

189 
	`memıy
(
pos
, 
TSRS_OUI_TYPE
, (TSRS_OUI_TYPE));

190 
pos
 +ğ(
TSRS_OUI_TYPE
);

191 *
pos
++ = 
tsid
;

192 
i
 = 0; i < 
num_¿‹s
; i++)

193 *
pos
++ = 
¿‹s
[
i
];

195  
pos
 - 
buf
;

196 
	}
}

204 cÚ¡ 
u8
 *
	$bss_g‘_›
(
cfg80211_bss
 *
bss
, 
u8
 
›
)

206 cÚ¡ 
u8
 *
pos
;

207 
u8
 
›s_Ën
, 
›s_cur_Ën
;

209 
pos
 = (cÚ¡ 
u8
 *)(
bss
->
›s
);

210 
›s_Ën
 = (
u8
)
bss
->
›s
->
Ën
;

211 
›s_cur_Ën
 = 1;

213 
›s_cur_Ën
 <ğ
›s_Ën
) {

214 ià(
pos
[0] =ğ
›
)

215  
pos
;

217 
pos
 += 2 +…os[1];

218 
›s_cur_Ën
++;

221  
NULL
;

222 
	}
}

230 
	$bss_g‘_b™_¿‹s
(
cfg80211_bss
 *
bss
, 
u8
 **
¿‹s
)

232 cÚ¡ 
u8
 *
›
, *
›2
;

233 
i
, 
j
;

234 
Ën
;

235 
u8
 *
r
;

237 
›
 = 
	`bss_g‘_›
(
bss
, 
WLAN_EID_SUPP_RATES
);

238 
›2
 = 
	`bss_g‘_›
(
bss
, 
WLAN_EID_EXT_SUPP_RATES
);

240 
Ën
 = (
›
 ? ie[1] : 0è+ (
›2
 ? ie2[1] : 0);

242 ià(!
Ën
)

245 
r
 = 
	`km®loc
(
Ën
, 
GFP_KERNEL
);

246 ià(!
r
)

249 
i
 = 0; 
›
 && i < ie[1]; i++)

250 
r
[
i
] = 
›
[i + 2] & 0x7f;

252 
j
 = 0; 
›2
 && j < ie2[1]; j++)

253 
r
[
i
 + 
j
] = 
›2
[j + 2] & 0x7f;

255 *
¿‹s
 = 
r
;

256  
Ën
;

257 
	}
}

266 
	$ÿc_£nd_addts
(
¦si_dev
 *
sdev
, 
id
, 
ebw
)

268 
aùiÚ_addts_»q
 *
»q
;

269 
size_t
 
exŒa_›_Ën
 = 50;

270 
›_Ën
 = 0;

271 
size_t
 
»q_Ën
;

272 
ÿc_t¥ec
 *
’Œy
;

273 
u8
 
tsid
, 
i
;

274 
u8
 *
¿‹s
;

275 
u8
 
¿‹
 = 0;

276 
u8
 *
pos
;

277 
num_¿‹s
;

278 
Ãtdev_vif
 *
ndev_vif
;

279 
Ãt_deviû
 *
Ãtdev
;

280 
u16
 
ho¡_g
 = 
	`¦si_tx_mgmt_ho¡_g
(
sdev
);

281 
›“80211_hdr
 *
hdr
;

282 
u8
 *
buf
 = 
NULL
;

283 
u8
 *
bssid
;

284 
u8
 
r
 = 0;

286 
’Œy
 = 
	`fšd_t¥ec_’Œy
(
id
, 0);

287 ià(
’Œy
 =ğ
NULL
) {

288 
	`SLSI_ERR
(
sdev
, "CAC-ADDTS: Invalid TSPEC ID\n");

292 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

293 
Ãtdev
 = 
	`g‘_Ãtdev_fÜ_¡©iÚ
(
sdev
);

294 ià(
Ãtdev
 =ğ
NULL
) {

295 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

298 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãtdev
);

299 ià((
ndev_vif
 =ğ
NULL
è|| (ndev_vif->
¡a
.
¡a_bss
 == NULL)) {

300 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

303 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

305 ià((!
ndev_vif
->
aùiv©ed
è|| (ndev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) ||

306 (
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
)) {

307 
	`SLSI_ERR
(
sdev
, "CAC-ADDTS: Not connected, can't send ADDTS\n");

308 
r
 = -1;

309 
ex™
;

311 
bssid
 = 
ndev_vif
->
¡a
.
¡a_bss
->bssid;

312 ià(
’Œy
->
acû±ed
) {

313 
	`SLSI_ERR
(
sdev
, "CAC-ADDTS: TSPEC‡lready‡ccepted\n");

314 
r
 = -1;

315 
ex™
;

318 
buf
 = 
	`km®loc
(
IEEE80211_HEADER_SIZE
 + (*
»q
è+ 
exŒa_›_Ën
, 
GFP_KERNEL
);

319 ià(
buf
 =ğ
NULL
) {

320 
	`SLSI_ERR
(
sdev
, "CAC-ADDTS: Failedo‡llocate ADDTS„equest\n");

321 
r
 = -1;

322 
ex™
;

325 
hdr
 = (
›“80211_hdr
 *)
buf
;

326 
hdr
->
äame_cÚŒŞ
 = 
	`IEEE80211_FC
(
IEEE80211_FTYPE_MGMT
, 
IEEE80211_STYPE_ACTION
);

327 
	`SLSI_ETHER_COPY
(
hdr
->
addr1
, 
bssid
);

328 
	`SLSI_ETHER_COPY
(
hdr
->
addr2
, 
Ãtdev
->
dev_addr
);

329 
	`SLSI_ETHER_COPY
(
hdr
->
addr3
, 
bssid
);

331 
»q
 = (
aùiÚ_addts_»q
 *)(
buf
 + 
IEEE80211_HEADER_SIZE
);

332 
»q
->
hdr
.
ÿ‹gÜy
 = 
WLAN_CATEGORY_WMM
;

333 
»q
->
hdr
.
aùiÚ
 = 
WMM_ACTION_CODE_ADDTS_REQ
;

334 ià(
dŸlog_tok’_Ãxt
 == 0)

335 
dŸlog_tok’_Ãxt
++;

336 
»q
->
hdr
.
dŸlog_tok’
 = 
dŸlog_tok’_Ãxt
++;

337 
»q
->
hdr
.
¡©us_code
 = 0;

338 
tsid
 = (
	`CAC_GET_LE24
(
»q
->
t¥ec
.
ts_šfo
) >> 1) & 0xF;

343 ià(
’Œy
->
psb_¥ecif›d
 == 0) {

344 
¦si_³”
 *
³”
;

345 
u32
 
´iÜ™y
;

347 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
Ãtdev
, 
SLSI_STA_PEER_QUEUESET
);

348 ià(!
³”
) {

349 
	`SLSI_ERR
(
sdev
, "CAC-ADDTS:‚o Peer found\n");

350 
r
 = -1;

351 
ex™_ä“_buf
;

354 
	`ÿc_qu”y_t¥ec_f›ld
(
sdev
, 
’Œy
, "u£r_´iÜ™y", &
´iÜ™y
);

355 ià(
³”
->
u­sd
 & 
	`BIT
(
	`¦si_äame_´iÜ™y_to_ac_queue
(
´iÜ™y
)))

356 
’Œy
->
t¥ec
.
ts_šfo
[1] |= 0x04;

358 
	`memıy
(&
»q
->
t¥ec
, &
’Œy
->tspec, (entry->tspec));

359 
»q_Ën
 = (*
»q
);

360 
pos
 = (
u8
 *)(
»q
 + 1);

361 
’Œy
->
ebw
 =ƒbw ? 1 : 0;

363 ià(
ebw
) {

364 
›_Ën
 +ğ
	`add_ebw_›
(
pos
, 
exŒa_›_Ën
, 
tsid
);

365 ià(
›_Ën
 <= 0)

366 
	`SLSI_ERR
(
sdev
, "CAC-ADDTS: Failedo‡dd EBW IE\n");

370 ià(
ccx_¡©us
 =ğ
BSS_CCX_ENABLED
) {

371 
num_¿‹s
 = 
	`bss_g‘_b™_¿‹s
(
ndev_vif
->
¡a
.
¡a_bss
, &
¿‹s
);

372 ià(
num_¿‹s
 <= 0)

373 
¿‹
 = 12;

375 
i
 = 0; i < 
num_¿‹s
; i++)

376 ià((
¿‹s
[
i
] > 
¿‹
) && (rates[i] <= 48))

377 
¿‹
 = 
¿‹s
[
i
];

378 
	`kä“
(
¿‹s
);

385 ià((
¿‹
 * 
TSRS_RATE_PER_UNIT
è=ğ
»q
->
t¥ec
.
mšimum_phy_¿‹
)

388 ià((
¿‹
 * 
TSRS_RATE_PER_UNIT
è> 
»q
->
t¥ec
.
mšimum_phy_¿‹
) {

389 
›_Ën
 +ğ
	`add_t¤s_›
(
pos
 + ie_Ën, 
exŒa_›_Ën
 - ie_len,

390 
tsid
, &
¿‹
, 1);

391 ià(
›_Ën
 <= 0) {

392 
	`SLSI_ERR
(
sdev
, "CAC-ADDTS: Failedo‡dd TSRS IE\n");

393 
r
 = -1;

394 
ex™_ä“_buf
;

397 
	`SLSI_ERR
(
sdev
, "CAC-ADDTS: BSS„ateoo†ow\n");

398 
r
 = -1;

399 
ex™_ä“_buf
;

404 ià(
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
Ãtdev
, 
buf
, (
IEEE80211_HEADER_SIZE
 + 
»q_Ën
 + 
›_Ën
),

405 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
, 
FAPI_MESSAGETYPE_IEEE80211_ACTION
,

406 
ho¡_g
, 0, 
sdev
->
fw_dw–l_time
, 0) != 0) {

407 
	`SLSI_ERR
(
sdev
, "CAC-ADDTS: Failedo send ADDTS„equest\n");

408 
r
 = -1;

409 
ex™_ä“_buf
;

411 
’Œy
->
dŸlog_tok’
 = 
»q
->
hdr
.dialog_token;

413 
ex™_ä“_buf
:

414 
	`kä“
(
buf
);

415 
ex™
:

416 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

417 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

418  
r
;

419 
	}
}

427 
	$ÿc_£nd_d–ts
(
¦si_dev
 *
sdev
, 
id
)

429 
aùiÚ_d–ts_»q
 *
»q
;

430 
ÿc_t¥ec
 *
’Œy
;

431 
size_t
 
»q_Ën
;

432 
u32
 
´iÜ™y
;

433 
rc
;

434 
Ãtdev_vif
 *
ndev_vif
;

435 
Ãt_deviû
 *
Ãtdev
;

436 
u16
 
ho¡_g
 = 
	`¦si_tx_mgmt_ho¡_g
(
sdev
);

437 
›“80211_hdr
 *
hdr
;

438 
u8
 *
buf
 = 
NULL
;

439 
u8
 *
bssid
;

440 
u8
 
r
 = 0;

441 
¦si_³”
 *
¡­“r
;

443 
’Œy
 = 
	`fšd_t¥ec_’Œy
(
id
 , 1);

444 ià(
’Œy
 =ğ
NULL
) {

445 
	`SLSI_ERR
(
sdev
, "CAC-DELTS:‚ØTSPEC ha b“Àe¡ablished fÜsid=%d\n", 
id
);

449 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

450 
Ãtdev
 = 
	`g‘_Ãtdev_fÜ_¡©iÚ
(
sdev
);

451 ià(
Ãtdev
 =ğ
NULL
) {

452 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

455 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãtdev
);

456 ià((
ndev_vif
 =ğ
NULL
è|| (ndev_vif->
¡a
.
¡a_bss
 == NULL)) {

457 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

460 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

462 ià((!
ndev_vif
->
aùiv©ed
è|| (ndev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) ||

463 (
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
)) {

464 
	`SLSI_ERR
(
sdev
, "CAC-DELTS: Not connected, can't send DELTS\n");

465 
r
 = -1;

466 
ex™
;

469 
¡­“r
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
Ãtdev
, 
SLSI_STA_PEER_QUEUESET
);

470 ià(
	`WARN_ON
(!
¡­“r
)) {

471 
r
 = -1;

472 
ex™
;

475 
bssid
 = 
ndev_vif
->
¡a
.
¡a_bss
->bssid;

476 
buf
 = 
	`km®loc
(24 + (*
»q
), 
GFP_KERNEL
);

477 ià(
buf
 =ğ
NULL
) {

478 
	`SLSI_ERR
(
sdev
, "CAC-DELTS: Failedo‡llocate DELTS„equest\n");

479 
r
 = -1;

480 
ex™
;

482 
hdr
 = (
›“80211_hdr
 *)
buf
;

483 
hdr
->
äame_cÚŒŞ
 = 
	`IEEE80211_FC
(
IEEE80211_FTYPE_MGMT
, 
IEEE80211_STYPE_ACTION
);

484 
	`SLSI_ETHER_COPY
(
hdr
->
addr1
, 
bssid
);

485 
	`SLSI_ETHER_COPY
(
hdr
->
addr2
, 
Ãtdev
->
dev_addr
);

486 
	`SLSI_ETHER_COPY
(
hdr
->
addr3
, 
bssid
);

487 
»q
 = (
aùiÚ_d–ts_»q
 *)(
buf
 + 24);

488 
»q_Ën
 = (*
»q
);

489 
»q
->
hdr
.
ÿ‹gÜy
 = 
WLAN_CATEGORY_WMM
;

490 
»q
->
hdr
.
aùiÚ
 = 
WMM_ACTION_CODE_DELTS
;

491 
»q
->
hdr
.
dŸlog_tok’
 = 0;

492 
»q
->
hdr
.
¡©us_code
 = 0;

493 
	`memıy
(&
»q
->
t¥ec
, &
’Œy
->tspec, (entry->tspec));

498 ià(
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
Ãtdev
, 
buf
, (
IEEE80211_HEADER_SIZE
 + 
»q_Ën
), 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
, 
FAPI_MESSAGETYPE_IEEE80211_ACTION
, 
ho¡_g
, 0, 0, 0) != 0) {

499 
	`SLSI_ERR
(
sdev
, "CAC-DELTS: Failedo send DELTS„equest\n");

500 
r
 = -1;

501 
ex™_ä“_buf
;

503 
rc
 = 
	`ÿc_qu”y_t¥ec_f›ld
(
sdev
, 
’Œy
, "u£r_´iÜ™y", &
´iÜ™y
);

504 ià(
rc
 != 0) {

505 
	`SLSI_ERR
(
sdev
, "CAC-DELTS: Error in„eading…riority fromspec!\n");

506 
r
 = -1;

507 
ex™_ä“_buf
;

510 ià(
	`¦si_mlme_d–_Œaffic_·¿m‘”s
(
sdev
, 
Ãtdev
, 
´iÜ™y
) != 0) {

511 
	`SLSI_ERR
(
sdev
, "CAC-DELTS: Failedo send DELTS„equest\n");

512 
r
 = -1;

513 
ex™_ä“_buf
;

525 
’Œy
->
acû±ed
 = 0;

526 
sdev
->
t¥ec_”rÜ_code
 = 0;

527 
¡­“r
->
t¥ec_e¡ablished
 &ğ~
	`BIT
(
´iÜ™y
);

529 
	`ÿc_£t_ric_›
(
sdev
, 
Ãtdev
);

531 ià(
ccx_¡©us
 =ğ
BSS_CCX_ENABLED
 && 
´evious_msdu_liãtime
 !ğ
MAX_TRANSMIT_MSDU_LIFETIME_NOT_VALID
)

532 ià(
	`¦si_£nd_max_Œªsm™_msdu_liãtime
(
sdev
, 
Ãtdev
, 
´evious_msdu_liãtime
) != 0) {

533 
	`SLSI_ERR
(
sdev
, "CAC-DELTS: slsi_send_max_msdu_lifetime failed");

534 
ex™_ä“_buf
;

536 
ex™_ä“_buf
:

537 
	`kä“
(
buf
);

538 
ex™
:

539 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

540 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

541  
r
;

542 
	}
}

550 
	$ÿc_ü—‹_t¥ec
(
¦si_dev
 *
sdev
, *
¬gs
)

552 
ÿc_t¥ec
 *
’Œy
;

553 
id
;

554 
u8
 
tid_auto_dÚe
 = 0;

555 
Ãtdev_vif
 *
ndev_vif
;

556 
Ãt_deviû
 *
Ãtdev
;

558 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

559 
Ãtdev
 = 
	`g‘_Ãtdev_fÜ_¡©iÚ
(
sdev
);

560 ià(
Ãtdev
 =ğ
NULL
) {

561 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

564 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãtdev
);

565 ià(
ndev_vif
 =ğ
NULL
) {

566 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

569 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

571 ià((!
ndev_vif
->
aùiv©ed
è|| (ndev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) ||

572 (
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
)) {

573 
	`SLSI_ERR
(
sdev
, "CAC-ADDTS: Not connected, can't create TSPEC\n");

574 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

575 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

578 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

579 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

581 ià(
¬gs
 =ğ
NULL
) {

583 ià(
t¥ec_li¡_Ãxt_id
 <= 7) {

584 
id
 = 
t¥ec_li¡_Ãxt_id
++;

586 
id
 = 0;

587 
t¥ec_li¡_Ãxt_id
 = 0;

588 
t¥ec_li¡_Ãxt_id
++;

590 
tid_auto_dÚe
 = 1;

593 ià((!
tid_auto_dÚe
è&& (
	`¡¹ošt
(
¬gs
, &
id
) < 0)) {

595 ià(
t¥ec_li¡_Ãxt_id
 <= 7) {

596 
id
 = 
t¥ec_li¡_Ãxt_id
++;

598 
id
 = 0;

599 
t¥ec_li¡_Ãxt_id
 = 0;

600 
t¥ec_li¡_Ãxt_id
++;

604 ià(
id
 < 
TSID_MIN
 || id > 
TSID_MAX
) {

605 
	`SLSI_ERR
(
sdev
, "CAC: Inv®id TSID =%d, mu¡ bš„ªg0-7\n", 
id
);

609 
’Œy
 = 
	`kz®loc
((*’Œy), 
GFP_KERNEL
);

610 ià(
’Œy
 =ğ
NULL
) {

611 
	`SLSI_ERR
(
sdev
, "CAC: Failedo‡llocate TSPEC\n");

615 
’Œy
->
id
 = id;

616 
’Œy
->
t¥ec
.
eid
 = 
WLAN_EID_VENDOR_SPECIFIC
;

617 
’Œy
->
t¥ec
.
Ëngth
 = ÓÁry->t¥ecè- ÓÁry->t¥ec.
eid
) - (entry->tspec.length);

618 
	`CAC_PUT_BE24
(
’Œy
->
t¥ec
.
oui
, 
WLAN_OUI_MICROSOFT
);

619 
’Œy
->
t¥ec
.
oui_ty³
 = 
WLAN_OUI_TYPE_MICROSOFT_WMM
;

620 
’Œy
->
t¥ec
.
oui_subty³
 = 
WMM_OUI_SUBTYPE_TSPEC_ELEMENT
;

621 
’Œy
->
t¥ec
.
v”siÚ
 = 
WMM_VERSION
;

622 
’Œy
->
acû±ed
 = 0;

623 
’Œy
->
psb_¥ecif›d
 = 0;

625 
’Œy
->
t¥ec
.
ts_šfo
[0] = 0x80;

627 
’Œy
->
Ãxt
 = 
t¥ec_li¡
;

628 
t¥ec_li¡
 = 
’Œy
;

629 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "CAC: C»©ed TSPECƒÁry fÜ id =%d\n", 
id
);

631  
’Œy
->
id
;

632 
	}
}

640 
	$ÿc_d–‘e_t¥ec
(
¦si_dev
 *
sdev
, 
id
)

642 
ÿc_t¥ec
 *
™r
;

643 
ÿc_t¥ec
 *
´ev
;

645 
™r
 = 
t¥ec_li¡
;

646 
´ev
 = 
NULL
;

647 
™r
 !ğ
NULL
) {

648 ià(
™r
->
id
 == id) {

649 ià(
´ev
)

650 
´ev
->
Ãxt
 = 
™r
->next;

652 
t¥ec_li¡
 = 
™r
->
Ãxt
;

654 ià(
™r
->
acû±ed
)

655 
	`ÿc_£nd_d–ts
(
sdev
, 
™r
->
id
);

657 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "CAC: TSPECƒÁry d–‘ed fÜ id =%d\n", 
id
);

658 
	`kä“
(
™r
);

662 
´ev
 = 
™r
;

663 
™r
 = iŒ->
Ãxt
;

665 
	`SLSI_ERR
(
sdev
, "CAC: Couldn'ˆfšd TSPEC w™h id %d fÜ d–‘iÚ", 
id
);

668 
	}
}

677 
	$ÿc_d–‘e_t¥ec_by_¡©e
(
¦si_dev
 *
sdev
, 
id
, 
acû±ed
)

679 
ÿc_t¥ec
 *
™r
;

680 
ÿc_t¥ec
 *
´ev
;

682 
™r
 = 
t¥ec_li¡
;

683 
´ev
 = 
NULL
;

684 
™r
 !ğ
NULL
) {

685 ià((
™r
->
id
 =ğidè&& (™r->
acû±ed
 ==‡ccepted)) {

686 ià(
´ev
)

687 
´ev
->
Ãxt
 = 
™r
->next;

689 
t¥ec_li¡
 = 
™r
->
Ãxt
;

691 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "CAC: D–‘šg TSPEC 0x%°w™h ID %d (acû±ed =%d)\n", 
™r
, 
id
, 
acû±ed
);

692 
	`kä“
(
™r
);

695 
´ev
 = 
™r
;

696 
™r
 = iŒ->
Ãxt
;

698 
	`SLSI_ERR
(
sdev
, "CAC: Couldn'ˆfšd TSPEC w™h ID %d (acû±ed =%d)\n", 
id
, 
acû±ed
);

701 
	}
}

711 
	$ÿc_cÚfig_t¥ec
(
¦si_dev
 *
sdev
, 
id
, cÚ¡ *
f›ld
, 
u32
 
v®ue
)

713 
ÿc_t¥ec
 *
’Œy
;

714 
i
;

715 
u32
 
max
 = 0xFFFFFFFF;

716 
u32
 
tsšfo
;

717 
u8
 
mask
;

718 
u8
 *
pos
;

720 ià(
f›ld
 =ğ
NULL
)

723 
’Œy
 = 
	`fšd_t¥ec_’Œy
(
id
, 0);

724 ià(
’Œy
 =ğ
NULL
) {

725 
	`SLSI_ERR
(
sdev
, "CAC: Invalid TSPEC ID\n");

729 
i
 = 0; i < 
NUM_TSPEC_FIELDS
; i++)

730 ià(
	`¡rÿ£cmp
(
f›ld
, 
t¥ec_f›lds
[
i
].
Çme
) == 0)

732 ià(
i
 >ğ
NUM_TSPEC_FIELDS
) {

733 
	`SLSI_ERR
(
sdev
, "CAC: Invalid TSPEC config field\n");

736 ià(
t¥ec_f›lds
[
i
].
»ad_Úly
) {

737 
	`SLSI_ERR
(
sdev
, "CAC: TSPEC field is„ead-only\n");

740 ià(
t¥ec_f›lds
[
i
].
is_tsšfo_f›ld
) {

741 
mask
 = 
t¥ec_f›lds
[
i
].
size
;

742 ià(
	`¡rÿ£cmp
(
f›ld
, "psb") == 0) {

743 ià(
v®ue
 <ğ
mask
)

744 
’Œy
->
psb_¥ecif›d
 = 1;

748 ià(
v®ue
 > 
mask
) {

749 
	`SLSI_ERR
(
sdev
, "CAC: TSPEC cÚfig v®uexûeded maximum fÜ %s\n", 
t¥ec_f›lds
[
i
].
Çme
);

753 
tsšfo
 = 
	`CAC_GET_LE24
(&
’Œy
->
t¥ec
.
ts_šfo
[0]);

754 
tsšfo
 &ğ~(
u32
)(
mask
 << 
t¥ec_f›lds
[
i
].
off£t
);

755 
tsšfo
 |ğ(
u32
)((
v®ue
 & 
mask
è<< 
t¥ec_f›lds
[
i
].
off£t
);

756 
	`CAC_PUT_LE24
(
’Œy
->
t¥ec
.
ts_šfo
, 
tsšfo
);

758 ià(
t¥ec_f›lds
[
i
].
size
 < 4)

759 
max
 = ((1 << (
t¥ec_f›lds
[
i
].
size
 * 8)) - 1);

761 ià(
v®ue
 > 
max
) {

762 
	`SLSI_ERR
(
sdev
, "CAC: TSPEC cÚfig v®uexûeded maximumfÜ %s\n", 
t¥ec_f›lds
[
i
].
Çme
);

766 
pos
 = (
u8
 *)(&
’Œy
->
t¥ec
è+ 
t¥ec_f›lds
[
i
].
off£t
;

767 ià(
t¥ec_f›lds
[
i
].
size
 == 1)

768 *
pos
 = (
v®ue
 & 0xFF);

769 ià(
t¥ec_f›lds
[
i
].
size
 == 2)

770 
	`CAC_PUT_LE16
(
pos
, 
v®ue
);

772 
	`CAC_PUT_LE32
(
pos
, 
v®ue
);

776 
	}
}

783 
	$ÿc_ù¾_ü—‹_t¥ec
(
¦si_dev
 *
sdev
, *
¬gs
)

785 
id
;

787 
id
 = 
	`ÿc_ü—‹_t¥ec
(
sdev
, 
¬gs
);

788 ià(
id
 < 0)

791  
id
;

792 
	}
}

800 
	$ÿc_ù¾_d–‘e_t¥ec
(
¦si_dev
 *
sdev
, *
¬gs
)

802 
id
;

804 ià(
	`¡¹ošt
(
¬gs
, &
id
) < 0) {

805 
	`SLSI_ERR
(
sdev
, "CAC-DELETE-TSPEC: Invalid TSPEC ID\n");

809 ià(
	`ÿc_d–‘e_t¥ec
(
sdev
, 
id
) < 0)

813 
	}
}

821 
	$ÿc_ù¾_cÚfig_t¥ec
(
¦si_dev
 *
sdev
, *
¬gs
)

823 *
id
;

824 *
f›ld
;

825 *
v®ue
;

826 
t¥ec_id
;

827 
u32
 
v®
;

829 
id
 = 
¬gs
;

830 
f›ld
 = 
	`¡rchr
(
id
, ' ');

831 ià(
f›ld
 =ğ
NULL
) {

832 
	`SLSI_ERR
(
sdev
, "CAC: field string is NULL\n");

835 *
f›ld
++ = '\0';

836 
v®ue
 = 
	`¡rchr
(
f›ld
, ' ');

837 ià(
v®ue
 =ğ
NULL
) {

838 
	`SLSI_ERR
(
sdev
, "CAC: field value is NULL\n");

841 *
v®ue
++ = '\0';

843 ià(
	`¡¹ošt
(
id
, &
t¥ec_id
) < 0) {

844 
	`SLSI_ERR
(
sdev
, "CAC: Conversionƒrror forspecid\n");

848 ià(
	`¡¹ošt
(
v®ue
, &
v®
) < 0) {

849 
	`SLSI_ERR
(
sdev
, "CAC: Conversionƒrror forspecid value\n");

853 ià(
	`ÿc_cÚfig_t¥ec
(
sdev
, 
t¥ec_id
, 
f›ld
, 
v®
) < 0)

857 
	}
}

865 
	$ÿc_ù¾_£nd_addts
(
¦si_dev
 *
sdev
, *
¬gs
)

867 *
id_¡r
;

868 *
ebw_¡r
;

869 
id
;

870 
ebw
 = 0;

872 ià(
¬gs
 =ğ
NULL
)

875 
id_¡r
 = 
¬gs
;

876 
ebw_¡r
 = 
	`¡rchr
(
id_¡r
, ' ');

877 ià(
ebw_¡r
 !ğ
NULL
) {

878 *
ebw_¡r
++ = '\0';

879 ià(!
	`¡ºcmp
(
ebw_¡r
, "ebw", 3))

880 
ebw
 = 1;

882 ià(
	`¡¹ošt
(
id_¡r
, &
id
) < 0) {

883 
	`SLSI_ERR
(
sdev
, "CAC: Conversionƒrror forspecid value\n");

886 ià(
	`ÿc_£nd_addts
(
sdev
, 
id
, 
ebw
) < 0)

890 
	}
}

898 
	$ÿc_ù¾_£nd_d–ts
(
¦si_dev
 *
sdev
, *
¬gs
)

900 
id
;

902 ià(
¬gs
 =ğ
NULL
)

905 ià(
	`¡¹ošt
(
¬gs
, &
id
) < 0) {

906 
	`SLSI_ERR
(
sdev
, "CAC: Invalid TSPEC ID\n");

909 ià(
	`ÿc_£nd_d–ts
(
sdev
, 
id
) < 0)

913 
	}
}

921 
	$ÿc_´oûss_d–ts_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
Ãtdev
, 
aùiÚ_d–ts_»q
 *
»q
)

923 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãtdev
);

924 
ÿc_t¥ec
 *
™r
;

925 
u32
 
´iÜ™y
;

926 
rc
;

927 
¦si_³”
 *
¡­“r
;

928 
u8
 
tid
;

930 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

932 ià((!
ndev_vif
->
aùiv©ed
è|| (ndev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) ||

933 (
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
è|| (ndev_vif->¡a.
¡a_bss
 =ğ
NULL
)) {

934 
	`SLSI_ERR
(
sdev
, "CAC: Not connected, Unexpected DELTS„equest\n");

938 
¡­“r
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
Ãtdev
, 
SLSI_STA_PEER_QUEUESET
);

939 ià(
	`WARN_ON
(!
¡­“r
))

942 
tid
 = (
	`CAC_GET_LE24
(
»q
->
t¥ec
.
ts_šfo
) >> 1) & 0xF;

943 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "CAC: TID iÀd–t »que¡ =%d\n", 
tid
);

945 
™r
 = 
	`fšd_t¥ec_’Œy
(
tid
, 1);

946 ià(
™r
 =ğ
NULL
) {

947 
	`SLSI_ERR
(
sdev
, "CAC: No matching TSPEC found\n");

951 
rc
 = 
	`ÿc_qu”y_t¥ec_f›ld
(
sdev
, 
™r
, "u£r_´iÜ™y", &
´iÜ™y
);

952 ià(
rc
 != 0) {

953 
	`SLSI_ERR
(
sdev
, "CAC: Missing…riority from TSPEC!\n");

957 ià(
	`¦si_mlme_d–_Œaffic_·¿m‘”s
(
sdev
, 
Ãtdev
, 
´iÜ™y
) != 0) {

958 
	`SLSI_ERR
(
sdev
, "CAC: Failedo send DEL-TRAFFIC_PARAMETERS„equest\n");

971 
™r
->
acû±ed
 = 0;

972 
¡­“r
->
t¥ec_e¡ablished
 &ğ~
	`BIT
(
´iÜ™y
);

973 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "t¥ec_e¡ablished =%x\n", 
¡­“r
->
t¥ec_e¡ablished
);

975 
	`ÿc_£t_ric_›
(
sdev
, 
Ãtdev
);

977 ià(
ccx_¡©us
 =ğ
BSS_CCX_ENABLED
 && 
´evious_msdu_liãtime
 !ğ
MAX_TRANSMIT_MSDU_LIFETIME_NOT_VALID
)

978 ià(
	`¦si_£nd_max_Œªsm™_msdu_liãtime
(
sdev
, 
Ãtdev
, 
´evious_msdu_liãtime
) != 0) {

979 
	`SLSI_ERR
(
sdev
, "CAC: slsi_send_max_msdu_lifetime failed");

982 
	}
}

992 
	$ÿc_fšd_edÿ_›
(cÚ¡ 
u8
 *
›
, 
size_t
 
›_Ën
, u8 *
tsid
, 
u16
 *
liãtime
)

994 cÚ¡ 
u8
 *
pos
 = 
›
;

996 ià((
›
 =ğ
NULL
è|| (
›_Ën
 < 9) ||

997 (
tsid
 =ğ
NULL
è|| (
liãtime
 == NULL))

1000 
pos
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_CISCO
, 
WLAN_OUI_TYPE_CISCO_EDCA
, 
›
, 
›_Ën
);

1001 ià(
pos
 && (po + 9 <ğ
›
 + 
›_Ën
)) {

1002 *
tsid
 = 
pos
[6];

1003 *
liãtime
 = 
	`CAC_GET_LE16
(&
pos
[7]);

1008 
	}
}

1017 
	$ÿc_´oûss_addts_r¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
Ãtdev
, 
aùiÚ_addts_r¥
 *
r¥
, cÚ¡ 
u8
 *
›
, 
size_t
 
›_Ën
)

1019 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãtdev
);

1020 
ÿc_t¥ec
 *
™r
, *
’Œy
;

1021 
wmm_t¥ec_–em’t
 *
t¥ec
;

1022 
u32
 
´iÜ™y
, 
´ev_´iÜ™y
;

1023 
rc
;

1024 
u8
 
tsid
;

1025 
u16
 
msdu_liãtime
;

1026 
¦si_³”
 *
³”
;

1027 
u16
 
medium_time
;

1029 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

1031 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "\n");

1033 ià((!
ndev_vif
->
aùiv©ed
è|| (ndev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) ||

1034 (
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
è|| (ndev_vif->¡a.
¡a_bss
 =ğ
NULL
)) {

1035 
	`SLSI_ERR
(
sdev
, "CAC: Not connected, INVALID state for ADDTS„esponse\n");

1039 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
Ãtdev
, 
SLSI_STA_PEER_QUEUESET
);

1040 ià(
	`WARN_ON
(!
³”
))

1043 
™r
 = 
t¥ec_li¡
;

1044 
™r
 !ğ
NULL
) {

1045 ià(
™r
->
dŸlog_tok’
 =ğ
r¥
->
hdr
.dialog_token) {

1046 
™r
->
dŸlog_tok’
 = 0;

1049 
™r
 = iŒ->
Ãxt
;

1051 ià(
™r
 =ğ
NULL
) {

1052 
	`SLSI_ERR
(
sdev
, "CAC: No matching TSPEC found for ADDTS„esponse\n");

1056 ià(
r¥
->
hdr
.
¡©us_code
 !ğ
ADDTS_STATUS_ACCEPTED
) {

1057 
	`SLSI_ERR
(
sdev
, "CAC: TSPEC„ejeùed (¡©us=0x%02X)", 
r¥
->
hdr
.
¡©us_code
);

1058 
	`ÿc_d–‘e_t¥ec_by_¡©e
(
sdev
, 
™r
->
id
, 0);

1062 ià((
ccx_¡©us
 =ğ
BSS_CCX_ENABLED
è&& 
	`ÿc_fšd_edÿ_›
(
›
, 
›_Ën
, &
tsid
, &
msdu_liãtime
) != 0)

1063 
msdu_liãtime
 = 
MSDU_LIFETIME_DEFAULT
;

1065 
t¥ec
 = (
wmm_t¥ec_–em’t
 *)(
r¥
 + 1);

1066 
medium_time
 = 
t¥ec
->medium_time;

1068 
rc
 = 
	`ÿc_qu”y_t¥ec_f›ld
(
sdev
, 
™r
, "u£r_´iÜ™y", &
´iÜ™y
);

1069 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "CAC: PriÜ™y fÜ cu¼’ˆt¥eøid %d=%d\n", 
™r
->
id
, 
´iÜ™y
);

1071 ià(
³”
->
t¥ec_e¡ablished
 == 0)

1072 
£t_·¿ms
;

1074 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "TSPEC‡lreadyƒstablished\n");

1080 
´iÜ™y
) {

1082 
FAPI_PRIORITY_QOS_UP1
:

1083 
FAPI_PRIORITY_QOS_UP2
:

1084 ià(
³”
->
t¥ec_e¡ablished
 & 
	`BIT
(
FAPI_PRIORITY_QOS_UP1
))

1085 
´ev_´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP1
;

1086 ià(
³”
->
t¥ec_e¡ablished
 & 
	`BIT
(
FAPI_PRIORITY_QOS_UP2
))

1087 
´ev_´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP2
;

1089 
£t_·¿ms
;

1093 
FAPI_PRIORITY_QOS_UP0
:

1094 
FAPI_PRIORITY_QOS_UP3
:

1095 ià(
³”
->
t¥ec_e¡ablished
 & 
	`BIT
(
FAPI_PRIORITY_QOS_UP0
))

1096 
´ev_´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP0
;

1097 ià(
³”
->
t¥ec_e¡ablished
 & 
	`BIT
(
FAPI_PRIORITY_QOS_UP3
))

1098 
´ev_´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP3
;

1100 
£t_·¿ms
;

1104 
FAPI_PRIORITY_QOS_UP4
:

1105 
FAPI_PRIORITY_QOS_UP5
:

1106 ià(
³”
->
t¥ec_e¡ablished
 & 
	`BIT
(
FAPI_PRIORITY_QOS_UP4
))

1107 
´ev_´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP4
;

1108 ià(
³”
->
t¥ec_e¡ablished
 & 
	`BIT
(
FAPI_PRIORITY_QOS_UP5
))

1109 
´ev_´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP5
;

1111 
£t_·¿ms
;

1115 
FAPI_PRIORITY_QOS_UP6
:

1116 
FAPI_PRIORITY_QOS_UP7
:

1117 ià(
³”
->
t¥ec_e¡ablished
 & 
	`BIT
(
FAPI_PRIORITY_QOS_UP6
))

1118 
´ev_´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP6
;

1119 ià(
³”
->
t¥ec_e¡ablished
 & 
	`BIT
(
FAPI_PRIORITY_QOS_UP7
))

1120 
´ev_´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP7
;

1122 
£t_·¿ms
;

1126 
	`SLSI_ERR
(
sdev
, "CAC: Invalid UP inhe„equest\n");

1131 
’Œy
 = 
	`fšd_t¥ec_’Œy
(
™r
->
id
, 1);

1132 ià(
’Œy
) {

1133 
	`ÿc_qu”y_t¥ec_f›ld
(
sdev
, 
’Œy
, "u£r_´iÜ™y", &
´ev_´iÜ™y
);

1134 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "CAC: Modify TSPEC (´ev_´iÜ™y =%d)\n", 
´ev_´iÜ™y
);

1140 
	`ÿc_d–‘e_t¥ec_by_¡©e
(
sdev
, 
’Œy
->
id
, 1);

1141 ià(
´iÜ™y
 !ğ
´ev_´iÜ™y
) {

1142 
™r
->
t¥ec
.
ts_šfo
[1] &= ~(7 << 3) ;

1143 
™r
->
t¥ec
.
ts_šfo
[1] |ğ
´ev_´iÜ™y
 << 3 ;

1144 
´iÜ™y
 = 
´ev_´iÜ™y
;

1152 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "CAC: Modify TSPEC for different TID\n");

1153 
’Œy
 = 
t¥ec_li¡
;

1154 
’Œy
 !ğ
NULL
) {

1155 ià((
’Œy
->
acû±ed
è&& (ÓÁry->
t¥ec
.
ts_šfo
[1] >> 3 & 0x07è=ğ
´ev_´iÜ™y
)) {

1156 
medium_time
 +ğ
’Œy
->
t¥ec
.medium_time;

1157 
´iÜ™y
 = 
´ev_´iÜ™y
;

1160 
’Œy
 =ƒÁry->
Ãxt
;

1162 ià(
’Œy
 =ğ
NULL
) {

1163 
	`SLSI_ERR
(
sdev
, "CAC: Failedo findƒntry for…revƒstablished TSPEC!!\n");

1168 
£t_·¿ms
:

1169 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "£ndšg¿ffiø·¿m tid [%d]", 
™r
->
id
);

1170 ià(
	`¦si_mlme_£t_Œaffic_·¿m‘”s
(
sdev
, 
Ãtdev
, 
´iÜ™y
, 
medium_time
, 
t¥ec
->
mšimum_d©a_¿‹
, 
ndev_vif
->
¡a
.
¡a_bss
->
bssid
) != 0) {

1171 
	`SLSI_ERR
(
sdev
, "CAC: Failedo send SET_TRAFFIC_PARAMETERS„equest\n");

1176 
™r
->
t¥ec
.
medium_time
 = medium_time;

1195 ià(
ccx_¡©us
 =ğ
BSS_CCX_ENABLED
) {

1196 ià((
	`¦si_»ad_max_Œªsm™_msdu_liãtime
(
sdev
, 
Ãtdev
, &
´evious_msdu_liãtime
)) != 0) {

1197 
´evious_msdu_liãtime
 = 
MAX_TRANSMIT_MSDU_LIFETIME_NOT_VALID
;

1198 
	`SLSI_ERR
(
sdev
, "CAC: slsi_read_max_msdu_lifetime failed");

1202 ià(
	`¦si_£nd_max_Œªsm™_msdu_liãtime
(
sdev
, 
Ãtdev
, 
msdu_liãtime
) != 0) {

1203 
	`SLSI_ERR
(
sdev
, "CAC: slsi_send_max_msdu_lifetime failed");

1208 
™r
->
acû±ed
 = 1;

1209 
sdev
->
t¥ec_”rÜ_code
 = 0;

1210 
³”
->
t¥ec_e¡ablished
 |ğ
	`BIT
(
´iÜ™y
);

1212 
	`ÿc_£t_ric_›
(
sdev
, 
Ãtdev
);

1213 
	}
}

1221 
	$ÿc_rx_wmm_aùiÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
Ãtdev
, 
›“80211_mgmt
 *
d©a
, 
size_t
 
Ën
)

1223 
›“80211_mgmt
 *
mgmt
 = 
d©a
;

1224 
aùiÚ_addts_r¥
 *
addts
;

1226 ià((
sdev
 =ğ
NULL
è|| (
d©a
 =ğNULLè|| (
Ãtdev
 =ğNULLè|| (
Ën
 == 0))

1229 ià(
mgmt
->
u
.
aùiÚ
.u.
wme_aùiÚ
.
aùiÚ_code
 =ğ
WMM_ACTION_CODE_ADDTS_RESP
) {

1230 
addts
 = (
aùiÚ_addts_r¥
 *)&
mgmt
->
u
.
aùiÚ
;

1231 
	`ÿc_´oûss_addts_r¥
(
sdev
, 
Ãtdev
, 
addts
, 
mgmt
->
u
.
aùiÚ
.u.
wme_aùiÚ
.
v¬ŸbË
, 
Ën
 - (*addts) + 1);

1232 } ià(
mgmt
->
u
.
aùiÚ
.u.
wme_aùiÚ
.
aùiÚ_code
 =ğ
WMM_ACTION_CODE_DELTS
) {

1233 
	`ÿc_´oûss_d–ts_»q
(
sdev
, 
Ãtdev
, (
aùiÚ_d–ts_»q
 *)&
mgmt
->
u
.
aùiÚ
);

1235 
	}
}

1242 
	$ÿc_g‘_aùive_t¥ecs
(
ÿc_aùiv©ed_t¥ec
 **
t¥ecs
)

1244 
ÿc_t¥ec
 *
™r
 = 
t¥ec_li¡
;

1245 
couÁ
 = 0;

1246 
i
 = 0;

1248 ià(
t¥ecs
 =ğ
NULL
)

1251 
™r
 !ğ
NULL
) {

1252 ià(
™r
->
acû±ed
)

1253 
couÁ
++;

1254 
™r
 = iŒ->
Ãxt
;

1256 *
t¥ecs
 = 
	`km®loc_¬¿y
((
size_t
)
couÁ
, (
ÿc_aùiv©ed_t¥ec
), 
GFP_KERNEL
);

1257 
™r
 = 
t¥ec_li¡
;

1258 
™r
 !ğ
NULL
) {

1259 ià(
™r
->
acû±ed
) {

1260 
t¥ecs
[
i
]->
ebw
 = 
™r
->ebw;

1261 
	`memıy
(&
t¥ecs
[
i
]->
t¥ec
, &
™r
->tspec, (itr->tspec));

1262 
i
++;

1264 
™r
 = iŒ->
Ãxt
;

1267  
couÁ
;

1268 
	}
}

1279 
	$ÿc_d–‘e_t¥ec_li¡
(
¦si_dev
 *
sdev
)

1281 
ÿc_t¥ec
 *
™r
 = 
t¥ec_li¡
;

1282 
ÿc_t¥ec
 *
‹mp
 = 
NULL
;

1284 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

1286 
™r
 !ğ
NULL
) {

1287 
™r
->
acû±ed
 = 0;

1288 
™r
->
dŸlog_tok’
 = 0;

1289 
‹mp
 = 
™r
;

1290 
™r
 = iŒ->
Ãxt
;

1291 
	`kä“
(
‹mp
);

1293 
t¥ec_li¡
 = 
NULL
;

1294 
	}
}

1296 
	$ÿc_d—ùiv©e_t¥ecs
(
¦si_dev
 *
sdev
)

1298 
ÿc_t¥ec
 *
™r
 = 
t¥ec_li¡
;

1300 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

1302 
™r
) {

1303 
™r
->
acû±ed
 = 0;

1304 
™r
->
dŸlog_tok’
 = 0;

1305 
™r
 = iŒ->
Ãxt
;

1307 
	}
}

1309 
	$ÿc_£t_ric_›
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
Ãtdev
)

1311 
ÿc_t¥ec
 *
™r
 = 
t¥ec_li¡
;

1312 
t¥ec_couÁ
 = 0;

1313 
buf_Ën
 = 0;

1314 
u8
 *
buff
, *
add_šfo_›s
;

1315 
wmm_t¥ec_–em’t
 *
t¥ec_›
;

1316 
i
 = 0;

1317 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãtdev
);

1319 
™r
) {

1320 ià(
™r
->
acû±ed
)

1321 
t¥ec_couÁ
++;

1322 
™r
 = iŒ->
Ãxt
;

1325 ià(
t¥ec_couÁ
 == 0) {

1326 
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
Ãtdev
, 
FAPI_PURPOSE_ASSOCIATION_REQUEST
,

1327 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
,

1328 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
);

1333 
buf_Ën
 = 6 + ((
wmm_t¥ec_–em’t
è* 
t¥ec_couÁ
);

1334 
buf_Ën
 +ğ
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
;

1335 
add_šfo_›s
 = 
	`km®loc
(
buf_Ën
, 
GFP_KERNEL
);

1336 ià(!
add_šfo_›s
) {

1337 
	`SLSI_ERR
(
sdev
, "m®loøç. size:%d\n", 
buf_Ën
);

1340 
	`memıy
(
add_šfo_›s
, 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
,‚dev_vif->¡a.
assoc_»q_add_šfo_–em_Ën
);

1342 
buff
 = 
add_šfo_›s
 + 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
;

1343 
buff
[0] = 
WLAN_EID_RIC_DATA
;

1344 
buff
[1] = 4;

1345 
buff
[2] = 0;

1347 
buff
[4] = 0;

1348 
buff
[5] = 0;

1350 
™r
 = 
t¥ec_li¡
;

1351 
i
 = 0;

1352 
™r
) {

1353 ià(
™r
->
acû±ed
) {

1354 
t¥ec_›
 = (
wmm_t¥ec_–em’t
 *)&
buff
[6 + 
i
 * (wmm_tspec_element)];

1355 
	`memıy
(
t¥ec_›
, &
™r
->
t¥ec
, (
wmm_t¥ec_–em’t
));

1356 ((
wmm_t¥ec_–em’t
 *)
t¥ec_›
)->
medium_time
 = 0;

1357 
i
++;

1359 
™r
 = iŒ->
Ãxt
;

1361 
buff
[3] = 
i
;

1362 
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
Ãtdev
, 
FAPI_PURPOSE_ASSOCIATION_REQUEST
, 
add_šfo_›s
, 
buf_Ën
);

1363 
	`kä“
(
add_šfo_›s
);

1364 
	}
}

1366 
	$ÿc_g‘_rde_t¥ec_›
(
¦si_dev
 *
sdev
, 
u8
 *
assoc_r¥_›
, 
assoc_r¥_›_Ën
, cÚ¡ u8 **
t¥ec_›_¬r
)

1368 cÚ¡ 
u8
 *
›
;

1369 
u16
 
¡©us
;

1370 
t¥ec_couÁ
 = 0, 
i
 = 0;

1372 
›
 = 
assoc_r¥_›
;

1375 
›
 && (
assoc_r¥_›_Ën
 > i- 
assoc_r¥_›
)) {

1376 
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_RIC_DATA
, ie, 
assoc_r¥_›_Ën
 - (› - 
assoc_r¥_›
));

1377 ià(!
›
)

1379 
¡©us
 = 
	`CAC_GET_LE16
(&
›
[4]);

1380 ià(
¡©us
 != 0)

1383 
t¥ec_couÁ
 +ğ
›
[3];

1384 
›
 = ie + ie[1];

1388 ià(
t¥ec_couÁ
 > 
TSID_MAX
) {

1389 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "»ûived %d TSPEC buˆÿÀaccommod©Úly %d\n", 
t¥ec_couÁ
, 
TSID_MAX
);

1390 
t¥ec_couÁ
 = 
TSID_MAX
;

1394 
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_RIC_DATA
, 
assoc_r¥_›
, 
assoc_r¥_›_Ën
);

1395 
i
 < 
t¥ec_couÁ
 && 
›
) {

1396 
›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WMM
, ie,

1397 
assoc_r¥_›_Ën
 - (
›
 - 
assoc_r¥_›
));

1398 ià(!
›
)

1403 ià(
›
[1] > 6 && ie[6] =ğ
WMM_OUI_SUBTYPE_TSPEC_ELEMENT
) {

1404 
t¥ec_›_¬r
[
i
] = 
›
;

1405 
i
++;

1407 
›
 += ie[1];

1410  
i
;

1411 
	}
}

1413 
	$ÿc_upd©e_rßm_Œaffic_·¿ms
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

1415 cÚ¡ 
u8
 *
t¥ec_›_¬r
[
TSID_MAX
];

1416 
assoc_r¥_t¥ec_couÁ
, 
i
;

1417 
u32
 
´iÜ™y
;

1418 
ÿc_t¥ec
 *
™r
;

1419 
wmm_t¥ec_–em’t
 *
assoc_r¥_t¥ec
;

1420 
¦si_³”
 *
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

1421 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1423 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "\n");

1428 
	`ÿc_d—ùiv©e_t¥ecs
(
sdev
);

1430 ià(!
³”
) {

1431 
	`SLSI_ERR
(
sdev
, "AP…eerƒntry‚ot found\n");

1436 
assoc_r¥_t¥ec_couÁ
 = 
	`ÿc_g‘_rde_t¥ec_›
(
sdev
, 
³”
->
assoc_»¥_›
->
d©a
,

1437 
³”
->
assoc_»¥_›
->
Ën
, 
t¥ec_›_¬r
);

1439 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "assoc_r¥_t¥ec_couÁ:%d\n", 
assoc_r¥_t¥ec_couÁ
);

1441 ià(!
assoc_r¥_t¥ec_couÁ
)

1445 
i
 = 0; i < 
assoc_r¥_t¥ec_couÁ
; i++) {

1446 
assoc_r¥_t¥ec
 = (
wmm_t¥ec_–em’t
 *)
t¥ec_›_¬r
[
i
];

1447 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "r¥_t¥ec:[%d]s: [%x|%x|%x] mediumime[%x]\n", 
i
,

1448 
assoc_r¥_t¥ec
->
ts_šfo
[0],‡ssoc_rsp_tspec->ts_info[1],‡ssoc_rsp_tspec->ts_info[2],

1449 
assoc_r¥_t¥ec
->
medium_time
);

1451 
™r
 = 
	`fšd_t¥ec_’Œy
((
assoc_r¥_t¥ec
->
ts_šfo
[0] & 0x1E) >> 1, 0);

1452 ià(!
™r
) {

1453 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "tspecƒntry‚ot found\n");

1457 
™r
->
t¥ec
.
medium_time
 = 
assoc_r¥_t¥ec
->medium_time;

1458 
™r
->
t¥ec
.
mšimum_d©a_¿‹
 = 
assoc_r¥_t¥ec
->minimum_data_rate;

1459 
™r
->
acû±ed
 = 1;

1460 
	`ÿc_qu”y_t¥ec_f›ld
(
sdev
, 
™r
, "u£r_´iÜ™y", &
´iÜ™y
);

1461 
³”
->
t¥ec_e¡ablished
 |ğ
	`BIT
(
´iÜ™y
);

1462 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "t¥eøadm™‹d id[%d]\n", 
™r
->
id
);

1463 
	`¦si_mlme_£t_Œaffic_·¿m‘”s
(
sdev
, 
dev
, 
´iÜ™y
, 
assoc_r¥_t¥ec
->
medium_time
,

1464 
assoc_r¥_t¥ec
->
mšimum_d©a_¿‹
, 
ndev_vif
->
¡a
.
¡a_bss
->
bssid
);

1466 
	}
}

	@cac.h

7 #iâdeà
CAC_H


8 
	#CAC_H


	)

10 
	~<lšux/k”Ãl.h
>

11 
	~"dev.h
"

12 
	~"debug.h
"

13 
	~"mlme.h
"

14 
	~"mgt.h
"

17 
	#WLAN_OUI_CISCO
 0x004096

	)

18 
	#WLAN_OUI_TYPE_CISCO_EDCA
 0x09

	)

20 
	#WMM_OUI_SUBTYPE_INFORMATION_ELEMENT
 0

	)

21 
	#WMM_OUI_SUBTYPE_PARAMETER_ELEMENT
 1

	)

22 
	#WMM_OUI_SUBTYPE_TSPEC_ELEMENT
 2

	)

23 
	#WMM_VERSION
 1

	)

24 
	#WMM_ACTION_CODE_ADDTS_REQ
 0

	)

25 
	#WMM_ACTION_CODE_ADDTS_RESP
 1

	)

26 
	#WMM_ACTION_CODE_DELTS
 2

	)

27 
	#WMM_ADDTS_STATUS_ADMISSION_ACCEPTED
 0

	)

28 
	#WMM_ADDTS_STATUS_INVALID_PARAMETERS
 1

	)

30 
	#WMM_ADDTS_STATUS_REFUSED
 3

	)

34 
	#WMM_TSPEC_DIRECTION_UPLINK
 0

	)

35 
	#WMM_TSPEC_DIRECTION_DOWNLINK
 1

	)

37 
	#WMM_TSPEC_DIRECTION_BI_DIRECTIONAL
 3

	)

40 
	#WMM_TSPEC_PSB_UNSPECIFIED
 2

	)

42 
	#ADDTS_STATUS_ACCEPTED
 0x00

	)

43 
	#ADDTS_STATUS_INVALID_PARAM
 0x01

	)

44 
	#ADDTS_STATUS_REFUSED
 0x03

	)

45 
	#ADDTS_STATUS_DELAY
 0x2F

	)

46 
	#ADDTS_STATUS_UNSPECIFIED
 0xC8

	)

47 
	#ADDTS_STATUS_POLICY_CONFIG
 0xC9

	)

48 
	#ADDTS_STATUS_ASSOC_DENIED
 0xCA

	)

49 
	#ADDTS_STATUS_INVALID_PARAM2
 0xCB

	)

51 
	#TSINFO_MASK
 0x00FFFFFF

	)

53 
	#CCX_MAX_NUM_RATES
 8

	)

55 
	#TSID_MIN
 0

	)

56 
	#TSID_MAX
 7

	)

58 
	#TSRS_RATE_PER_UNIT
 500000

	)

59 
	#IEEE80211_HEADER_SIZE
 24

	)

61 
	#MAX_TRANSMIT_MSDU_LIFETIME_NOT_VALID
 -1

	)

62 
	#BSS_CCX_DISABLED
 0

	)

63 
	#BSS_CCX_ENABLED
 1

	)

66 
	#CAC_GET_LE16
(
a
è((
u16
)((×)[1] << 8è| (a)[0]))

	)

67 
	#CAC_PUT_LE16
(
a
, 
v®
) \

69 (
a
)[1] = ((
u16
)(
v®
)) >> 8; \

70 (
a
)[0] = ((
u16
)(
v®
)) & 0xff; \

71 } 0)

	)

72 
	#CAC_PUT_BE24
(
a
, 
v®
) \

74 (
a
)[0] = (
u8
)((((
u32
)(
v®
)) >> 16) & 0xff); \

75 (
a
)[1] = (
u8
)((((
u32
)(
v®
)) >> 8) & 0xff); \

76 (
a
)[2] = (
u8
)(((
u32
)(
v®
)) & 0xff); \

77 } 0)

	)

78 
	#CAC_GET_LE24
(
a
è((((
u32
)×)[2]è<< 16è| (((u32)×)[1]è<< 8è| ((u32)×)[0]))

	)

79 
	#CAC_PUT_LE24
(
a
, 
v®
) \

81 (
a
)[2] = (
u8
)((((
u32
)(
v®
)) >> 16) & 0xff); \

82 (
a
)[1] = (
u8
)((((
u32
)(
v®
)) >> 8) & 0xff); \

83 (
a
)[0] = (
u8
)(((
u32
)(
v®
)) & 0xff); \

84 } 0)

	)

85 
	#CAC_GET_LE32
(
a
è((((
u32
)(a)[3]) << 24) | (((u32)(a)[2]) << 16) | \

86 (((
u32
)(
a
)[1]è<< 8è| ((u32)×)[0]))

	)

87 
	#CAC_PUT_LE32
(
a
, 
v®
) \

89 (
a
)[3] = (
u8
)((((
u32
)(
v®
)) >> 24) & 0xff); \

90 (
a
)[2] = (
u8
)((((
u32
)(
v®
)) >> 16) & 0xff); \

91 (
a
)[1] = (
u8
)((((
u32
)(
v®
)) >> 8) & 0xff); \

92 (
a
)[0] = (
u8
)(((
u32
)(
v®
)) & 0xff); \

93 } 0)

	)

95 
	#IEEE80211_FC
(
ty³
, 
¡y³
è(
u16
)Ñy³ | sty³)

	)

98 
	swmm_t¥ec_–em’t
 {

99 
	meid
;

100 
u8
 
	mËngth
;

101 
u8
 
	moui
[3];

102 
u8
 
	moui_ty³
;

103 
u8
 
	moui_subty³
;

104 
u8
 
	mv”siÚ
;

106 
u8
 
	mts_šfo
[3];

107 
u16
 
	mnomš®_msdu_size
;

108 
u16
 
	mmaximum_msdu_size
;

109 
u32
 
	mmšimum_£rviû_š‹rv®
;

110 
u32
 
	mmaximum_£rviû_š‹rv®
;

111 
u32
 
	mšaùiv™y_š‹rv®
;

112 
u32
 
	msu¥’siÚ_š‹rv®
;

113 
u32
 
	m£rviû_¡¬t_time
;

114 
u32
 
	mmšimum_d©a_¿‹
;

115 
u32
 
	mm—n_d©a_¿‹
;

116 
u32
 
	m³ak_d©a_¿‹
;

117 
u32
 
	mmaximum_bur¡_size
;

118 
u32
 
	md–ay_bound
;

119 
u32
 
	mmšimum_phy_¿‹
;

120 
u16
 
	msu½lus_bªdwidth_®lowªû
;

121 
u16
 
	mmedium_time
;

122 } 
	g__·cked
;

124 
	#MSDU_LIFETIME_DEFAULT
 512

	)

126 
	sÿc_aùiv©ed_t¥ec
 {

127 
wmm_t¥ec_–em’t
 
	mt¥ec
;

128 
	mebw
;

131 
	st¥ec_f›ld
 {

132 cÚ¡ *
	mÇme
;

133 
	m»ad_Úly
;

134 
	mis_tsšfo_f›ld
;

135 
u8
 
	msize
;

136 
u32
 
	moff£t
;

139 
	sÿc_t¥ec
 {

140 
ÿc_t¥ec
 *
	mÃxt
;

141 
	mid
;

142 
wmm_t¥ec_–em’t
 
	mt¥ec
;

143 
u8
 
	mpsb_¥ecif›d
;

144 
	mebw
;

145 
	macû±ed
;

146 
u8
 
	mdŸlog_tok’
;

149 
	#OFFSETOF
(
m
è((
size_t
)&((
wmm_t¥ec_–em’t
 *)0)->m)

	)

151 
	swmm_aùiÚ_hdr
 {

152 
u8
 
	mÿ‹gÜy
;

153 
u8
 
	maùiÚ
;

154 
u8
 
	mdŸlog_tok’
;

155 
u8
 
	m¡©us_code
;

156 } 
	g__·cked
;

158 
	saùiÚ_addts_»q
 {

159 
wmm_aùiÚ_hdr
 
	mhdr
;

160 
wmm_t¥ec_–em’t
 
	mt¥ec
;

161 } 
	g__·cked
;

163 
	saùiÚ_addts_r¥
 {

164 
wmm_aùiÚ_hdr
 
	mhdr
;

165 } 
	g__·cked
;

167 
	saùiÚ_d–ts_»q
 {

168 
wmm_aùiÚ_hdr
 
	mhdr
;

169 
wmm_t¥ec_–em’t
 
	mt¥ec
;

170 } 
	g__·cked
;

172 
ÿc_ù¾_ü—‹_t¥ec
(
¦si_dev
 *
sdev
, *
¬gs
);

173 
ÿc_ù¾_cÚfig_t¥ec
(
¦si_dev
 *
sdev
, *
¬gs
);

174 
ÿc_ù¾_£nd_addts
(
¦si_dev
 *
sdev
, *
¬gs
);

175 
ÿc_ù¾_£nd_d–ts
(
¦si_dev
 *
sdev
, *
¬gs
);

176 
ÿc_upd©e_loÿl_t¥ec
(
¦si_dev
 *
sdev
, 
u16
 
msdu_liãtime
, 
wmm_t¥ec_–em’t
 *
t¥ec
);

177 
ÿc_g‘_aùive_t¥ecs
(
ÿc_aùiv©ed_t¥ec
 **
t¥ecs
);

178 
ÿc_d–‘e_t¥ec_li¡
(
¦si_dev
 *
sdev
);

179 
ÿc_ù¾_d–‘e_t¥ec
(
¦si_dev
 *
sdev
, *
¬gs
);

180 
ÿc_rx_wmm_aùiÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
Ãtdev
, 
›“80211_mgmt
 *
d©a
, 
size_t
 
Ën
);

181 
ÿc_upd©e_rßm_Œaffic_·¿ms
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

	@cfg80211_ops.c

7 
	~<lšux/v”siÚ.h
>

8 
	~<Ãt/cfg80211.h
>

9 
	~<lšux/‘h”deviû.h
>

10 
	~"dev.h
"

11 
	~"cfg80211_İs.h
"

12 
	~"debug.h
"

13 
	~"mgt.h
"

14 
	~"mlme.h
"

15 
	~"Ãtif.h
"

16 
	~"unifiio.h
"

17 
	~"mib.h
"

19 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


20 
	~"scsc_wifogg”_ršgs.h
"

22 
	~"Æ80211_v’dÜ.h
"

24 
	#SLSI_MAX_CHAN_2G_BAND
 14

	)

31 cÚ¡ 
u8
 
	g¦si_ex‹nded_ÿp
[] = {

35 cÚ¡ 
u8
 
	g¦si_ex‹nded_ÿp_mask
[] = {

39 
ušt
 
	gk“p_®ive_³riod
 = 
SLSI_P2PGO_KEEP_ALIVE_PERIOD_SEC
;

40 
moduË_·¿m
(
k“p_®ive_³riod
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

41 
MODULE_PARM_DESC
(
k“p_®ive_³riod
, "default is 10 seconds");

43 
boŞ
 
	$¦si_is_mhs_aùive
(
¦si_dev
 *
sdev
)

45 
Ãt_deviû
 *
mhs_dev
 = 
sdev
->
Ãtdev_­
;

46 
Ãtdev_vif
 *
ndev_vif
;

47 
boŞ
 
»t
;

49 ià(
mhs_dev
) {

50 
ndev_vif
 = 
	`Ãtdev_´iv
(
mhs_dev
);

51 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

52 
»t
 = 
ndev_vif
->
aùiv©ed
;

53 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

54  
»t
;

58 
	}
}

60 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(4, 12, 0))

61 
wœ–ess_dev
 *
	$¦si_add_vœtu®_štf
(
why
 *wiphy,

62 cÚ¡ *
Çme
,

63 
Çme_assign_ty³
,

64 
Æ80211_iáy³
 
ty³
,

65 
vif_·¿ms
 *
·¿ms
)

67 #–ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

68 
wœ–ess_dev
 *
	$¦si_add_vœtu®_štf
(
why
 *wiphy,

69 cÚ¡ *
Çme
,

70 
Çme_assign_ty³
,

71 
Æ80211_iáy³
 
ty³
,

72 
u32
 *
æags
,

73 
vif_·¿ms
 *
·¿ms
)

76 
wœ–ess_dev
 *
	$¦si_add_vœtu®_štf
(
why
 *wiphy,

77 cÚ¡ *
Çme
,

78 
Æ80211_iáy³
 
ty³
,

79 
u32
 *
æags
,

80 
vif_·¿ms
 *
·¿ms
)

84 
Ãt_deviû
 *
dev
 = 
NULL
;

85 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

86 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

88 #ià(
LINUX_VERSION_CODE
 <ğ
	`KERNEL_VERSION
(4, 11, 0))

89 
	`SLSI_UNUSED_PARAMETER
(
æags
);

91 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "IÁàÇme:%s,y³:%d, maÿddr:%pM\n", 
Çme
, 
ty³
, 
·¿ms
->
maÿddr
);

92 ià(
	`¦si_is_mhs_aùive
(
sdev
)) {

93 
	`SLSI_ERR
(
sdev
, "MHS is‡ctive. cannot‡dd‚ew interface\n");

94  
	`ERR_PTR
(-
EOPNOTSUPP
);

96 
dev
 = 
	`¦si_dyÇmic_š‹rçû_ü—‹
(
why
, 
Çme
, 
ty³
, 
·¿ms
);

97 ià(!
dev
)

98 
ex™_w™h_”rÜ
;

99 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

101  &
ndev_vif
->
wdev
;

102 
ex™_w™h_”rÜ
:

103  
	`ERR_PTR
(-
ENODEV
);

104 
	}
}

106 
	$¦si_d–_vœtu®_štf
(
why
 *why, 
wœ–ess_dev
 *
wdev
)

108 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

109 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

111 ià(
	`WARN_ON
(!
dev
))

112  -
EINVAL
;

114 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "Dev‚ame:%s\n", dev->
Çme
);

116 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

117 
	`¦si_¡İ_Ãt_dev
(
sdev
, 
dev
);

118 
	`¦si_Ãtif_»move_locked
(
sdev
, 
dev
);

119 ià(
dev
 =ğ
sdev
->
Ãtdev_­
)

120 
	`rcu_assign_poš‹r
(
sdev
->
Ãtdev_­
, 
NULL
);

121 ià(!
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
])

122 
	`rcu_assign_poš‹r
(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
], sdev->
Ãtdev_­
);

123 ià(
dev
 =ğ
sdev
->
Ãtdev_p2p
)

124 
	`rcu_assign_poš‹r
(
sdev
->
Ãtdev_p2p
, 
NULL
);

125 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

128 
	}
}

130 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(4, 12, 0))

131 
	$¦si_chªge_vœtu®_štf
(
why
 *wiphy,

132 
Ãt_deviû
 *
dev
,

133 
Æ80211_iáy³
 
ty³
,

134 
vif_·¿ms
 *
·¿ms
)

137 
	$¦si_chªge_vœtu®_štf
(
why
 *wiphy,

138 
Ãt_deviû
 *
dev
,

139 
Æ80211_iáy³
 
ty³
,

140 
u32
 *
æags
,

141 
vif_·¿ms
 *
·¿ms
)

145 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

146 
r
 = 0;

148 #ià(
LINUX_VERSION_CODE
 <ğ
	`KERNEL_VERSION
(4, 11, 0))

149 
	`SLSI_UNUSED_PARAMETER
(
æags
);

152 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

154 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "ty³:%u, iáy³:%d\n", 
ty³
, 
ndev_vif
->
iáy³
);

156 ià(
	`WARN_ON
(
ndev_vif
->
aùiv©ed
)) {

157 
r
 = -
EINVAL
;

158 
ex™
;

161 
ty³
) {

162 
NL80211_IFTYPE_UNSPECIFIED
:

163 
NL80211_IFTYPE_ADHOC
:

164 
NL80211_IFTYPE_STATION
:

165 
NL80211_IFTYPE_AP
:

166 
NL80211_IFTYPE_P2P_CLIENT
:

167 
NL80211_IFTYPE_P2P_GO
:

168 
NL80211_IFTYPE_MONITOR
:

169 
ndev_vif
->
iáy³
 = 
ty³
;

170 
dev
->
›“80211_±r
->
iáy³
 = 
ty³
;

171 ià(
·¿ms
)

172 
dev
->
›“80211_±r
->
u£_4addr
 = 
·¿ms
->use_4addr;

175 
r
 = -
EINVAL
;

179 
ex™
:

180 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

181  
r
;

182 
	}
}

184 
	$¦si_add_key
(
why
 *why, 
Ãt_deviû
 *
dev
,

185 
u8
 
key_šdex
, 
boŞ
 
·œwi£
, cÚ¡ u8 *
mac_addr
,

186 
key_·¿ms
 *
·¿ms
)

188 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

189 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

190 
¦si_³”
 *
³”
 = 
NULL
;

191 
r
 = 0;

192 
u16
 
key_ty³
 = 
FAPI_KEYTYPE_GROUP
;

194 ià(
	`WARN_ON
(
·œwi£
 && !
mac_addr
))

195  -
EINVAL
;

197 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

199 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "(key_index:%d,…airwise:%d,‡ddress:%pM, cipher:0x%.8X, key_len:%d,"

200 "vif_ty³:%d)\n", 
key_šdex
, 
·œwi£
, 
mac_addr
, 
·¿ms
->
ch”
,…¬ams->
key_Ën
,

201 
ndev_vif
->
vif_ty³
);

203 ià(!
ndev_vif
->
aùiv©ed
) {

204 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "vif‚ot‡ctive\n");

205 
ex™
;

208 ià(
·¿ms
->
ch”
 =ğ
WLAN_CIPHER_SUITE_PMK
) {

209 
r
 = 
	`¦si_mlme_£t_pmk
(
sdev
, 
dev
, 
·¿ms
->
key
,…¬ams->
key_Ën
);

210 
ex™
;

213 ià(
mac_addr
 && 
·œwi£
) {

215 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
mac_addr
);

216 ià(
³”
)

217 
mac_addr
 = 
³”
->
add»ss
;

218 } ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

220 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

221 ià(
³”
)

222 
mac_addr
 = 
³”
->
add»ss
;

223 } ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && !
·œwi£
)

225 
mac_addr
 = 
dev
->
dev_addr
;

227 
r
 = -
EINVAL
;

228 
ex™
;

232 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

233 (
·¿ms
->
ch”
 =ğ
WLAN_CIPHER_SUITE_WEP40
 ||

234 
·¿ms
->
ch”
 =ğ
WLAN_CIPHER_SUITE_WEP104
è&& 
³”
) {

235 
u8
 
bc_mac_addr
[
ETH_ALEN
] = { 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF };

237 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "WEP Key: store key\n");

238 
r
 = 
	`¦si_mlme_£t_key
(
sdev
, 
dev
, 
key_šdex
, 
FAPI_KEYTYPE_WEP
, 
bc_mac_addr
, 
·¿ms
);

239 ià(
r
 =ğ
FAPI_RESULTCODE_SUCCESS
) {

240 
ndev_vif
->
¡a
.
w•_key_£t
 = 
Œue
;

242 ià(
ndev_vif
->
add»ss
)

243 
	`¦si_mlme_pow”mgt
(
sdev
, 
dev
, 
ndev_vif
->
£t_pow”_mode
);

245 
	`SLSI_NET_ERR
(
dev
, "Error‡dding WEP key\n");

247 
ex™
;

250 ià(
·œwi£
) {

251 
key_ty³
 = 
FAPI_KEYTYPE_PAIRWISE
;

252 ià(
	`WARN_ON
(!
³”
)) {

253 
r
 = -
EINVAL
;

254 
ex™
;

256 } ià(
·¿ms
->
ch”
 =ğ
WLAN_CIPHER_SUITE_AES_CMAC
 ||…¬ams->ch” =ğ
WLAN_CIPHER_SUITE_BIP_GMAC_128
 ||

257 
·¿ms
->
ch”
 =ğ
WLAN_CIPHER_SUITE_BIP_GMAC_256
) {

258 
key_ty³
 = 
FAPI_KEYTYPE_IGTK
;

261 ià(
	`WARN
(!
mac_addr
, "mac_addr‚ot defined\n")) {

262 
r
 = -
EINVAL
;

263 
ex™
;

265 ià(!(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && 
key_šdex
 == 4)) {

266 
r
 = 
	`¦si_mlme_£t_key
(
sdev
, 
dev
, 
key_šdex
, 
key_ty³
, 
mac_addr
, 
·¿ms
);

267 ià(
r
) {

268 
	`SLSI_NET_ERR
(
dev
, "”rÜ iÀaddšg key (key_ty³: %d)\n", 
key_ty³
);

269 
ex™
;

273 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

274 
ndev_vif
->
¡a
.
—p_ho¡g
 = 0xFFFF;

276 ià(
ndev_vif
->
add»ss
)

277 
	`¦si_mlme_pow”mgt
(
sdev
, 
dev
, 
ndev_vif
->
£t_pow”_mode
);

280 ià(
key_ty³
 =ğ
FAPI_KEYTYPE_GROUP
) {

281 
ndev_vif
->
¡a
.
group_key_£t
 = 
Œue
;

282 
ndev_vif
->
­
.
ch”
 = 
·¿ms
->cipher;

283 } ià(
key_ty³
 =ğ
FAPI_KEYTYPE_PAIRWISE
) {

284 ià(
³”
)

285 
³”
->
·œwi£_key_£t
 = 
Œue
;

288 ià(
³”
) {

289 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

290 ià(
·œwi£
 && 
·¿ms
->
ch”
 =ğ
WLAN_CIPHER_SUITE_SMS4
) {

291 
	`¦si_mlme_cÚÃù_»¥
(
sdev
, 
dev
);

292 ià(
ndev_vif
->
add»ss
)

293 
	`¦si__add»ss_chªged
(
sdev
, 
dev
, 
ndev_vif
->
add»ss
);

295 
	`¦si_£t_aş
(
sdev
, 
dev
);

296 
	`¦si_£t_·ck‘_f‹rs
(
sdev
, 
dev
);

297 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

300 ià(
ndev_vif
->
¡a
.
g¿tu™ous_¬p_Ãeded
) {

301 
ndev_vif
->
¡a
.
g¿tu™ous_¬p_Ãeded
 = 
çl£
;

302 
	`¦si_£nd_g¿tu™ous_¬p
(
sdev
, 
dev
);

304 } ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && 
·œwi£
) {

305 
	`¦si_mlme_cÚÃùed_»¥
(
sdev
, 
dev
, 
³”
->
aid
);

306 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

307 
³”
->
cÚÃùed_¡©e
 = 
SLSI_STA_CONN_STATE_CONNECTED
;

308 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_GO
)

309 
ndev_vif
->
­
.
p2p_gc_keys_£t
 = 
Œue
;

313 
ex™
:

314 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

315  
r
;

316 
	}
}

318 
	$¦si_d–_key
(
why
 *why, 
Ãt_deviû
 *
dev
,

319 
u8
 
key_šdex
, 
boŞ
 
·œwi£
, cÚ¡ u8 *
mac_addr
)

321 
	`SLSI_UNUSED_PARAMETER
(
why
);

322 
	`SLSI_UNUSED_PARAMETER
(
key_šdex
);

323 
	`SLSI_UNUSED_PARAMETER
(
·œwi£
);

324 
	`SLSI_UNUSED_PARAMETER
(
mac_addr
);

326 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

327 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_DELETEKEYS.request\n");

328  -
EOPNOTSUPP
;

332 
	}
}

334 
	$¦si_chªÃl_sw™ch
(
why
 *why, 
Ãt_deviû
 *
dev
, 
cfg80211_c§_£‰šgs
 *
·¿ms
)

336 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

337 
Ãtdev_vif
 *
­_dev_vif
;

338 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

339 
Ãt_deviû
 *
wÏn_dev
;

340 
Ãtdev_vif
 *
ndev_¡a_vif
;

341 
»suÉ
 = 0;

342 
u16
 
ûÁ”_äeq
 = 0;

343 
u16
 
chª_šfo
 = 0;

344 
u16
 
cu¼’t_chª_šfo
 = 0;

345 
cfg80211_chª_def
 
chªdef
 = 
·¿ms
->chandef;

346 
cfg80211_chª_def
 
cu¼’t_chªdef
 = 
ndev_vif
->
chªdef_§ved
;

347 
Ãt_deviû
 *
­_dev
 = 
NULL
;

348 
›“80211_chªÃl
 *
chª
 = 
chªdef
.chan;

349 
width
 = 
chªdef
.width;

351 
wÏn_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

352 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

353 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_AP
) {

354 
	`SLSI_NET_ERR
(
dev
, "AP Mode is‚ot‡ctive\n");

355 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

356  -
EPERM
;

358 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

359 
ndev_¡a_vif
 = 
	`Ãtdev_´iv
(
wÏn_dev
);

360 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


361 ià(
	`SLSI_IS_VIF_INDEX_MHS
(
sdev
, 
ndev_vif
)) {

362 ià(
ndev_¡a_vif
) {

363 
	`SLSI_MUTEX_LOCK
(
ndev_¡a_vif
->
vif_mu‹x
);

364 ià(
ndev_¡a_vif
->
aùiv©ed
 &&‚dev_¡a_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

365 (
ndev_¡a_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTING
 ||

366 
ndev_¡a_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
)) {

367 
	`SLSI_NET_ERR
(
dev
, "Sta is in connected state (Chan Switch‚ot‡llowed in WiFi Sharing mode)\n");

368 
	`SLSI_MUTEX_UNLOCK
(
ndev_¡a_vif
->
vif_mu‹x
);

369  -
EPERM
;

371 
	`SLSI_MUTEX_UNLOCK
(
ndev_¡a_vif
->
vif_mu‹x
);

376 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

377 ià(
cu¼’t_chªdef
.
chª
->
ûÁ”_äeq
 == chan->center_freq) {

378 
cu¼’t_chª_šfo
 = 
	`¦si_g‘_chªn_šfo
(
sdev
, &
cu¼’t_chªdef
);

379 ià(
cu¼’t_chª_šfo
 =ğ
	`¦si_g‘_chªn_šfo
(
sdev
, &
chªdef
)) {

380 
	`SLSI_NET_ERR
(
dev
, "ChªÃÈSw™ch„eque¡ed oÀcu¼’ˆchªÃÈäeq-> %u‡nd Chª infØ%d\n", 
cu¼’t_chªdef
.
chª
->
ûÁ”_äeq
, 
cu¼’t_chª_šfo
);

381 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

382  -
EPERM
;

385 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

387 
­_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2PX_SWLAN
);

388 
chª_šfo
 = 
	`¦si_g‘_chªn_šfo
(
sdev
, &
chªdef
);

389 
ûÁ”_äeq
 = 
chª
->center_freq;

390 ià(
width
 !ğ
NL80211_CHAN_WIDTH_20_NOHT
 && width !ğ
NL80211_CHAN_WIDTH_20
)

391 
ûÁ”_äeq
 = 
	`¦si_g‘_ûÁ”_äeq1
(
sdev
, 
chª_šfo
, center_freq);

392 
­_dev_vif
 = 
	`Ãtdev_´iv
(
­_dev
);

393 
	`SLSI_MUTEX_LOCK
(
­_dev_vif
->
vif_mu‹x
);

394 
»suÉ
 = 
	`¦si_mlme_chªÃl_sw™ch
(
sdev
, 
­_dev
, 
ûÁ”_äeq
, 
chª_šfo
);

395 
	`SLSI_MUTEX_UNLOCK
(
­_dev_vif
->
vif_mu‹x
);

396  
»suÉ
;

397 
	}
}

399 
	$¦si_g‘_key
(
why
 *why, 
Ãt_deviû
 *
dev
,

400 
u8
 
key_šdex
, 
boŞ
 
·œwi£
, cÚ¡ u8 *
mac_addr
,

401 *
cook›
,

402 (*
ÿÎback
)(*
cook›
, 
key_·¿ms
 *))

404 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

405 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

406 
key_·¿ms
 
·¿ms
;

408 
	#SLSI_MAX_KEY_SIZE
 8

	)

409 
u8
 
key_£q
[
SLSI_MAX_KEY_SIZE
] = { 0 };

410 
r
 = 0;

412 
	`SLSI_UNUSED_PARAMETER
(
mac_addr
);

414 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

415 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_GET_KEY_SEQUENCE.request\n");

416  -
EOPNOTSUPP
;

419 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

421 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "(key_šdex:%d,…aœwi£:%d, mac_addr:%pM, vif_ty³:%d)\n", 
key_šdex
,

422 
·œwi£
, 
mac_addr
, 
ndev_vif
->
vif_ty³
);

424 ià(!
ndev_vif
->
aùiv©ed
) {

425 
	`SLSI_NET_ERR
(
dev
, "vif‚ot‡ctive\n");

426 
r
 = -
EINVAL
;

427 
ex™
;

431 ià(
FAPI_VIFTYPE_AP
 !ğ
ndev_vif
->
vif_ty³
) {

432 
	`SLSI_NET_ERR
(
dev
, "Inv®id viàty³: %d\n", 
ndev_vif
->
vif_ty³
);

433 
r
 = -
EINVAL
;

434 
ex™
;

436 ià(
·œwi£
) {

437 
	`SLSI_NET_ERR
(
dev
, "Invalid keyype\n");

438 
r
 = -
EINVAL
;

439 
ex™
;

442 
	`mem£t
(&
·¿ms
, 0, (params));

444 
·¿ms
.
key
 = 
NULL
;

445 
·¿ms
.
key_Ën
 = 0;

446 
·¿ms
.
ch”
 = 
ndev_vif
->
­
.cipher;

447 ià(!(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && 
key_šdex
 == 4)) {

448 
r
 = 
	`¦si_mlme_g‘_key
(
sdev
, 
dev
, 
key_šdex
, 
FAPI_KEYTYPE_GROUP
, 
key_£q
, &
·¿ms
.
£q_Ën
);

450 ià(!
r
) {

451 
·¿ms
.
£q
 = 
key_£q
;

452 
	`ÿÎback
(
cook›
, &
·¿ms
);

455 #undeà
SLSI_MAX_KEY_SIZE


456 
ex™
:

457 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

458  
r
;

459 
	}
}

461 
size_t
 
	$¦si_¡r_wsc_p2p_›
(cÚ¡ 
u8
 *
¤c_›
, 
size_t
 
¤c_›_Ën
, u8 *
de¡_›
, 
boŞ
 
¡r_wsc
, boŞ 
¡r_p2p
)

463 cÚ¡ 
u8
 *
›
;

464 cÚ¡ 
u8
 *
Ãxt_›
;

465 
size_t
 
de¡_›_Ën
 = 0;

467 ià(!
de¡_›
 || !(
¡r_p2p
 || 
¡r_wsc
))

468  
de¡_›_Ën
;

470 
›
 = 
¤c_›
; (› - src_›è< 
¤c_›_Ën
; iğ
Ãxt_›
) {

471 
Ãxt_›
 = 
›
 + ie[1] + 2;

473 ià(
›
[0] =ğ
WLAN_EID_VENDOR_SPECIFIC
 && ie[1] > 4) {

474 
i
;

475 
oui
 = 0;

477 
i
 = 0; i < 4; i++)

478 
oui
 = (ou˜<< 8è| 
›
[5 - 
i
];

480 ià(
¡r_wsc
 && 
oui
 =ğ
SLSI_WPS_OUI_PATTERN
)

482 ià(
¡r_p2p
 && 
oui
 =ğ
SLSI_P2P_OUI_PATTERN
)

486 ià(
Ãxt_›
 - 
¤c_›
 <ğ
¤c_›_Ën
) {

487 
	`memıy
(
de¡_›
 + 
de¡_›_Ën
, 
›
, ie[1] + 2);

488 
de¡_›_Ën
 +ğ
›
[1] + 2;

492  
de¡_›_Ën
;

493 
	}
}

495 
	$¦si_sÿn
(
why
 *wiphy,

496 
cfg80211_sÿn_»que¡
 *
»que¡
)

498 
Ãt_deviû
 *
dev
 = 
»que¡
->
wdev
->
Ãtdev
;

499 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

500 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

501 
u16
 
sÿn_ty³
 = 
FAPI_SCANTYPE_FULL_SCAN
;

502 
r
 = 0;

503 
u8
 *
sÿn_›
;

504 
size_t
 
sÿn_›_Ën
;

505 
boŞ
 
¡r_wsc
 = 
çl£
;

506 
boŞ
 
¡r_p2p
 = 
çl£
;

507 
›“80211_chªÃl
 *
chªÃls
[64];

508 
i
, 
chª_couÁ
 = 0;

509 
boŞ
 
wps_¡a
 = 
çl£
;

510 cÚ¡ 
u8
 *
›
;

512 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


513 
u8
 
mac_addr_mask
[
ETH_ALEN
] = {0xFF};

516 ià(
	`WARN_ON
(!
»que¡
->
wdev
))

517  -
EINVAL
;

518 ià(
	`WARN_ON
(!
dev
))

519  -
EINVAL
;

521 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

522 
	`SLSI_NET_WARN
(
dev
, "not supported in WlanLite mode\n");

523  -
EOPNOTSUPP
;

527 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_ACTION_FRAME_TX_RX
) {

528 
	`SLSI_NET_INFO
(
dev
, "Scan„eceived in P2P Action Frame Tx/Rx state - Reject (exp_frame=%s)\n",

529 
	`¦si_·_subty³_‹xt
(()
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
));

530  -
EBUSY
;

533 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

535 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
) {

536 
	`SLSI_NET_INFO
(
dev
, "Rejecting scan„equest‡s†ast scan is still„unning\n");

537 
r
 = -
EBUSY
;

538 
ex™
;

540 #ià
	`defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

541 ià(
ndev_vif
->
is_ws_ruÂšg
 && (ndev_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) &&

542 (
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
)) {

543 
»t
 = 0;

545 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "Scan invokes DRIVER_BCN_ABORT\n");

546 
»t
 = 
	`¦si_mlme_£t_fÜw¬d_b—cÚ
(
sdev
, 
dev
, 
FAPI_ACTION_STOP
);

548 ià(!
»t
) {

549 
»t
 = 
	`¦si_£nd_fÜw¬d_b—cÚ_abÜt_v’dÜ_ev’t
(
sdev
, 
dev
,

550 
SLSI_FORWARD_BEACON_ABORT_REASON_SCANNING
);

554 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "chªÃls:%d, ssids:%d, ie_Ën:%d, vif_šdex:%d\n", 
»que¡
->
n_chªÃls
,

555 
»que¡
->
n_ssids
, (ìeque¡->
›_Ën
, 
ndev_vif
->
iâum
);

557 
i
 = 0; i < 
»que¡
->
n_chªÃls
; i++)

558 
chªÃls
[
i
] = 
»que¡
->channels[i];

559 
chª_couÁ
 = 
»que¡
->
n_chªÃls
;

561 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

562 ià(
chª_couÁ
 == 1)

563 
sÿn_ty³
 = 
FAPI_SCANTYPE_SINGLE_CHANNEL_SCAN
;

564 ià(
sdev
->
š™Ÿl_sÿn
) {

565 
sdev
->
š™Ÿl_sÿn
 = 
çl£
;

566 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTING
 &&

567 
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
)

568 
sÿn_ty³
 = 
FAPI_SCANTYPE_INITIAL_SCAN
;

570 
ndev_vif
->
unsync
.
¦si_p2p_cÚtšuous_fuÎsÿn
 = 
çl£
;

574 ià(
»que¡
->
›
 &&

575 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_WFA
, 
WLAN_OUI_TYPE_WFA_P2P
, 
»que¡
->
›
,„eque¡->
›_Ën
) &&

576 
»que¡
->
ssids
 && 
	`SLSI_IS_P2P_SSID
Ôeque¡->ssids[0].
ssid
,„eque¡->ssids[0].
ssid_Ën
)) {

581 ià(!
ndev_vif
->
drv_š_p2p_´oûdu»
) {

582 ià(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
)) {

583 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
);

584 
	`¦si_mlme_un£t_chªÃl_»q
(
sdev
, 
dev
);

585 
ndev_vif
->
driv”_chªÃl
 = 0;

591 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_GROUP_FORMED_GO
)

592 
ndev_vif
->
unsync
.
¦si_p2p_cÚtšuous_fuÎsÿn
 = 
çl£
;

594 ià(
»que¡
->
n_chªÃls
 =ğ
SLSI_P2P_SOCIAL_CHAN_COUNT
 ||„equest->n_channels == 1) {

595 
sÿn_ty³
 = 
FAPI_SCANTYPE_P2P_SCAN_SOCIAL
;

596 
ndev_vif
->
unsync
.
¦si_p2p_cÚtšuous_fuÎsÿn
 = 
çl£
;

597 } ià(
»que¡
->
n_chªÃls
 > 
SLSI_P2P_SOCIAL_CHAN_COUNT
) {

598 ià(!
ndev_vif
->
unsync
.
¦si_p2p_cÚtšuous_fuÎsÿn
) {

599 
sÿn_ty³
 = 
FAPI_SCANTYPE_P2P_SCAN_FULL
;

600 
ndev_vif
->
unsync
.
¦si_p2p_cÚtšuous_fuÎsÿn
 = 
Œue
;

602 
couÁ
 = 0, 
chªn
 = 0;

604 
sÿn_ty³
 = 
FAPI_SCANTYPE_P2P_SCAN_SOCIAL
;

605 
ndev_vif
->
unsync
.
¦si_p2p_cÚtšuous_fuÎsÿn
 = 
çl£
;

606 
i
 = 0; i < 
»que¡
->
n_chªÃls
; i++) {

607 
chªn
 = 
chªÃls
[
i
]->
hw_v®ue
 & 0xFF;

608 ià(
chªn
 == 1 || chann == 6 || chann == 11) {

609 
chªÃls
[
couÁ
] = 
»que¡
->chªÃls[
i
];

610 
couÁ
++;

613 
chª_couÁ
 = 
couÁ
;

617 
›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPS
, 
»que¡
->›,„eque¡->
›_Ën
);

618 ià(
›
 && ie[1] > 
SLSI_WPS_REQUEST_TYPE_POS
) {

619 ià(
›
[
SLSI_WPS_REQUEST_TYPE_POS
] !ğ
SLSI_WPS_REQUEST_TYPE_ENROLEE_INFO_ONLY
)

620 
wps_¡a
 = 
Œue
;

623 #ifdeà
CONFIG_SCSC_WLAN_DUAL_STATION


624 ià((
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
è||‚dev_vif->
iâum
 =ğ
SLSI_NET_INDEX_P2PX_SWLAN
è&& 
»que¡
->
›
 &&

625 !(
sÿn_ty³
 =ğ
FAPI_SCANTYPE_P2P_SCAN_SOCIAL
 || sÿn_ty³ =ğ
FAPI_SCANTYPE_P2P_SCAN_FULL
)) {

627 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
è&& 
»que¡
->
›
) {

635 ià(!
wps_¡a
)

636 
¡r_wsc
 = 
Œue
;

638 
›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_WFA
, 
WLAN_OUI_TYPE_WFA_P2P
, 
»que¡
->›,„eque¡->
›_Ën
);

639 ià(
›
)

640 
¡r_p2p
 = 
Œue
;

643 ià(
¡r_wsc
 || 
¡r_p2p
) {

644 
sÿn_›
 = 
	`km®loc
(
»que¡
->
›_Ën
, 
GFP_KERNEL
);

645 ià(!
sÿn_›
) {

646 
	`SLSI_NET_INFO
(
dev
, "Out of memory for scan IEs\n");

647 
r
 = -
ENOMEM
;

648 
ex™
;

650 
sÿn_›_Ën
 = 
	`¦si_¡r_wsc_p2p_›
(
»que¡
->
›
,„eque¡->
›_Ën
, 
sÿn_›
, 
¡r_wsc
, 
¡r_p2p
);

652 
sÿn_›
 = (
u8
 *)
»que¡
->
›
;

653 
sÿn_›_Ën
 = 
»que¡
->
›_Ën
;

657 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
sÿn_timeout_wÜk
);

659 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
 = 
çl£
;

660 
	`¦si_purge_sÿn_»suÉs
(
ndev_vif
, 
SLSI_SCAN_HW_ID
);

662 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


669 ià(
»que¡
->
æags
 & 
NL80211_SCAN_FLAG_RANDOM_ADDR
 && !
wps_¡a
) {

670 ià(
sdev
->
fw_mac_¿ndomiz©iÚ_’abËd
) {

671 
	`memıy
(
sdev
->
sÿn_mac_addr
, 
»que¡
->
mac_addr
, 
ETH_ALEN
);

672 
r
 = 
	`¦si_£t_mac_¿ndomi§tiÚ_mask
(
sdev
, 
»que¡
->
mac_addr_mask
);

673 ià(!
r
)

674 
sdev
->
sÿn_addr_£t
 = 1;

676 
	`SLSI_NET_INFO
(
dev
, "Mac Randomization is‚otƒnabled in Firmware\n");

677 
sdev
->
sÿn_addr_£t
 = 0;

679 } ià(
sdev
->
sÿn_addr_£t
) {

680 
	`mem£t
(
mac_addr_mask
, 0xFF, 
ETH_ALEN
);

681 
r
 = 
	`¦si_£t_mac_¿ndomi§tiÚ_mask
(
sdev
, 
mac_addr_mask
);

682 
sdev
->
sÿn_addr_£t
 = 0;

686 
r
 = 
	`¦si_mlme_add_sÿn
(
sdev
,

687 
dev
,

688 
sÿn_ty³
,

689 
FAPI_REPORTMODE_REAL_TIME
,

690 
»que¡
->
n_ssids
,

691 
»que¡
->
ssids
,

692 
chª_couÁ
,

693 
chªÃls
,

694 
NULL
,

695 
sÿn_›
,

696 
sÿn_›_Ën
,

697 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
);

699 ià(
r
 != 0) {

700 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "add_sÿÀ”rÜ: %d\n", 
r
);

701 
r
 = -
EIO
;

703 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
 = 
»que¡
;

708 ià(
	`queue_d–ayed_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
sÿn_timeout_wÜk
,

709 
	`m£cs_to_jiff›s
(
SLSI_FW_SCAN_DONE_TIMEOUT_MSEC
)))

710 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
»queue_timeout_wÜk
 = 
çl£
;

712 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
»queue_timeout_wÜk
 = 
Œue
;

715 ià(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
è&& (!
	`SLSI_IS_P2P_GROUP_STATE
(
sdev
))) {

716 ià(
sÿn_ty³
 =ğ
FAPI_SCANTYPE_P2P_SCAN_SOCIAL
)

717 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_SCANNING
);

718 } ià(!
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
è&& 
sÿn_›_Ën
) {

719 
	`kä“
(
ndev_vif
->
´obe_»q_›s
);

720 
ndev_vif
->
´obe_»q_›s
 = 
	`km®loc
(
»que¡
->
›_Ën
, 
GFP_KERNEL
);

721 ià(!
ndev_vif
->
´obe_»q_›s
)

722 
ndev_vif
->
´obe_»q_›_Ën
 = 0;

724 
ndev_vif
->
´obe_»q_›_Ën
 = 
sÿn_›_Ën
;

725 
	`memıy
(
ndev_vif
->
´obe_»q_›s
, 
sÿn_›
, 
sÿn_›_Ën
);

729 ià(
¡r_p2p
 || 
¡r_wsc
)

730 
	`kä“
(
sÿn_›
);

732 
ex™
:

733 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

734  
r
;

735 
	}
}

737 
	$¦si_sched_sÿn_¡¬t
(
why
 *wiphy,

738 
Ãt_deviû
 *
dev
,

739 
cfg80211_sched_sÿn_»que¡
 *
»que¡
)

741 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

742 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

743 
r
;

744 
u8
 *
sÿn_›
;

745 
size_t
 
sÿn_›_Ën
;

746 
boŞ
 
¡r_wsc
 = 
çl£
;

747 
boŞ
 
¡r_p2p
 = 
çl£
;

749 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

750 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_ADD_SCAN.request\n");

751  -
EOPNOTSUPP
;

757 ià(!
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

758 
	`SLSI_NET_INFO
(
dev
, "ScheduËd sÿÀ»q„eûived oÀvià%d - Rejeù\n", 
ndev_vif
->
iâum
);

759  -
EINVAL
;

765 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_ACTION_FRAME_TX_RX
) {

766 
	`SLSI_NET_INFO
(
dev
, "Scheduled scan„eq„eceived in P2P Action Frame Tx/Rx state - Reject\n");

767  -
EBUSY
;

770 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

772 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "chªÃls:%d, ssids:%d, ie_Ën:%d, vif_šdex:%d\n", 
»que¡
->
n_chªÃls
,

773 
»que¡
->
n_ssids
, (ìeque¡->
›_Ën
, 
ndev_vif
->
iâum
);

775 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sched_»q
) {

776 
r
 = -
EBUSY
;

777 
ex™
;

780 ià(
»que¡
->
›
) {

781 cÚ¡ 
u8
 *
›
;

787 
›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPS
, 
»que¡
->›,„eque¡->
›_Ën
);

788 ià(
›
)

789 
¡r_wsc
 = 
Œue
;

791 
›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_WFA
, 
WLAN_OUI_TYPE_WFA_P2P
, 
»que¡
->›,„eque¡->
›_Ën
);

792 ià(
›
)

793 
¡r_p2p
 = 
Œue
;

796 ià((
¡r_wsc
 || 
¡r_p2p
è&& 
»que¡
->
›
) {

797 
sÿn_›
 = 
	`km®loc
(
»que¡
->
›_Ën
, 
GFP_KERNEL
);

798 ià(!
sÿn_›
) {

799 
	`SLSI_NET_INFO
(
dev
, "Out of memory for scan IEs\n");

800 
r
 = -
ENOMEM
;

801 
ex™
;

803 
sÿn_›_Ën
 = 
	`¦si_¡r_wsc_p2p_›
(
»que¡
->
›
,„eque¡->
›_Ën
, 
sÿn_›
, 
¡r_wsc
, 
¡r_p2p
);

805 
sÿn_›
 = (
u8
 *)
»que¡
->
›
;

806 
sÿn_›_Ën
 = 
»que¡
->
›_Ën
;

809 
	`¦si_purge_sÿn_»suÉs
(
ndev_vif
, 
SLSI_SCAN_SCHED_ID
);

810 
r
 = 
	`¦si_mlme_add_sched_sÿn
(
sdev
, 
dev
, 
»que¡
, 
sÿn_›
, 
sÿn_›_Ën
);

812 
ndev_vif
->
sÿn
[
SLSI_SCAN_SCHED_ID
].
sched_»q
 = 
»que¡
;

813 ià(
¡r_p2p
 || 
¡r_wsc
)

814 
	`kä“
(
sÿn_›
);

816 ià(
r
 != 0) {

817 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "add_sÿÀ”rÜ: %d\n", 
r
);

818 
ndev_vif
->
sÿn
[
SLSI_SCAN_SCHED_ID
].
sched_»q
 = 
NULL
;

819 
r
 = -
EIO
;

822 
ex™
:

823 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

824  
r
;

825 
	}
}

827 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(4, 12, 0))

828 
	$¦si_sched_sÿn_¡İ
(
why
 *why, 
Ãt_deviû
 *
dev
, 
u64
 
»qid
)

831 
	$¦si_sched_sÿn_¡İ
(
why
 *why, 
Ãt_deviû
 *
dev
)

834 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

835 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

836 
r
 = 0;

838 
	`SLSI_UNUSED_PARAMETER
(
»qid
);

839 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

840 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "vif_šdex:%d", 
ndev_vif
->
iâum
);

841 ià(!
ndev_vif
->
sÿn
[
SLSI_SCAN_SCHED_ID
].
sched_»q
) {

842 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "No sched scan„eq\n");

843 
ex™
;

846 
r
 = 
	`¦si_mlme_d–_sÿn
(
sdev
, 
dev
, (
ndev_vif
->
iâum
 << 8 | 
SLSI_SCAN_SCHED_ID
), 
çl£
);

848 
ndev_vif
->
sÿn
[
SLSI_SCAN_SCHED_ID
].
sched_»q
 = 
NULL
;

850 
ex™
:

851 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

852  
r
;

853 
	}
}

855 
	$¦si_abÜt_hw_sÿn
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

857 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

859 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

861 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "Abort on-going scan, vif_index:%d,"

862 "ndev_vif->sÿn[SLSI_SCAN_HW_ID].sÿn_»q:%p\n", 
ndev_vif
->
iâum
,

863 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
);

865 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
) {

866 ()
	`¦si_mlme_d–_sÿn
(
sdev
, 
dev
, 
ndev_vif
->
iâum
 << 8 | 
SLSI_SCAN_HW_ID
, 
çl£
);

867 
	`¦si_sÿn_com¶‘e
(
sdev
, 
dev
, 
SLSI_SCAN_HW_ID
, 
çl£
, false);

869 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

870 
	}
}

872 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

873 
	$¦si_§ve_cÚÃùiÚ_·¿ms
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

874 
cfg80211_cÚÃù_·¿ms
 *
sme
,

875 
›“80211_chªÃl
 *
chªÃl
, cÚ¡ 
u8
 *
bssid
,

876 
u32
 
aùiÚ_äame_bm­
, u32 
aùiÚ_äame_su¥’d_bm­
)

878 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

880 
	`mem£t
(&
ndev_vif
->
¡a
.
sme
, 0, (
cfg80211_cÚÃù_·¿ms
));

881 
ndev_vif
->
¡a
.
sme
 = *sme;

883 ià(
sme
->
›
 && sme->
›_Ën
)

884 
ndev_vif
->
¡a
.
sme
.
›
 = 
	`¦si_mem_dup
((
u8
 *)sme->›, sme->
›_Ën
);

886 
ndev_vif
->
¡a
.
sme
.
›
 = 
NULL
;

888 ià(
sme
->
ssid
 && sme->
ssid_Ën
)

889 
ndev_vif
->
¡a
.
sme
.
ssid
 = 
	`¦si_mem_dup
((
u8
 *)sme->ssid, sme->
ssid_Ën
);

891 
ndev_vif
->
¡a
.
sme
.
ssid
 = 
NULL
;

893 ià(
sme
->
key
 && sme->
key_Ën
)

894 
ndev_vif
->
¡a
.
sme
.
key
 = 
	`¦si_mem_dup
((
u8
 *)sme->key, sme->
key_Ën
);

896 
ndev_vif
->
¡a
.
sme
.
key
 = 
NULL
;

898 
ndev_vif
->
¡a
.
aùiÚ_äame_bm­
 =‡ction_frame_bmap;

899 
ndev_vif
->
¡a
.
aùiÚ_äame_su¥’d_bm­
 =‡ction_frame_suspend_bmap;

900 
ndev_vif
->
¡a
.
cÚÃùed_bssid
 = 
	`¦si_mem_dup
((
u8
 *)
bssid
, 
ETH_ALEN
);

901 
ndev_vif
->
¡a
.
cÚÃùed_ssid_Ën
 = ()
sme
->
ssid_Ën
;

902 
ndev_vif
->
¡a
.
cÚÃùed_ssid
 = 
	`¦si_mem_dup
((
u8
 *)
sme
->
ssid
,‚dev_vif->¡a.
cÚÃùed_ssid_Ën
);

903 
	}
}

906 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

907 
	$¦si_£t_·¿ms_Ú_bss
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
cfg80211_cÚÃù_·¿ms
 *
sme
,

908 
›“80211_chªÃl
 **
chªÃl
, cÚ¡ 
u8
 **
bssid
)

910 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

912 
ndev_vif
->
¡a
.
akm_ty³
 = 
	`¦si_bss_cÚÃù_ty³_g‘
(
sdev
, 
sme
->
›
, sme->
›_Ën
);

913 
ndev_vif
->
¡a
.
ssid_Ën
 = 
sme
->ssid_len;

914 
	`memıy
(
ndev_vif
->
¡a
.
ssid
, 
sme
->ssid, sme->
ssid_Ën
);

918 ià(!
sme
->
bssid
) {

919 
ndev_vif
->
¡a
.
drv_bss_£ËùiÚ
 = 
Œue
;

920 ià(
sme
->
bssid_hšt
) {

921 *
bssid
 = 
sme
->
bssid_hšt
;

922 *
chªÃl
 = 
sme
->
chªÃl_hšt
;

925 
ndev_vif
->
¡a
.
drv_bss_£ËùiÚ
 = 
çl£
;

927 
	}
}

930 
	$¦si_check_wificÚÃù_to_cÚÃùedGo
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
bssid
)

932 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

933 
Ãt_deviû
 *
p2p_dev
;

934 
Ãtdev_vif
 *
ndev_p2p_vif
;

936 ià(
bssid
) {

937 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
è&& 
sdev
->
p2p_¡©e
 =ğ
P2P_GROUP_FORMED_CLI
) {

938 
p2p_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2PX_SWLAN
);

939 ià(
p2p_dev
) {

940 
ndev_p2p_vif
 = 
	`Ãtdev_´iv
(
p2p_dev
);

941 ià(
ndev_p2p_vif
->
¡a
.
¡a_bss
) {

942 ià(
	`SLSI_ETHER_EQUAL
(
ndev_p2p_vif
->
¡a
.
¡a_bss
->
bssid
, bssid))

943  -
EINVAL
;

949 
	}
}

951 
	$¦si_£t_rßm_»assoc
(
Ãt_deviû
 *
dev
, 
¦si_dev
 *
sdev
, 
cfg80211_cÚÃù_·¿ms
 *
sme
)

953 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

954 
¦si_³”
 *
³”
;

955 cÚ¡ 
u8
 *
cÚÃùed_ssid
 = 
NULL
;

956 
r
 = 0;

959 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

960 ià(
	`WARN_ON
(!
³”
))

961  -
EINVAL
;

963 ià(!
sme
->
bssid
 && !sme->
bssid_hšt
) {

964 
	`SLSI_NET_ERR
(
dev
, "Require bssid in„eassoc but„eceived‚ull\n");

965  -
EINVAL
;

967 ià((
sme
->
bssid
 && !
	`memcmp
(
³”
->
add»ss
, sme->bssid, 
ETH_ALEN
)) ||

968 (
sme
->
bssid_hšt
 && !
	`memcmp
(
³”
->
add»ss
, sme->bssid_hšt, 
ETH_ALEN
))) {

969 
r
 = 
	`¦si_mlme_»assocŸ‹
(
sdev
, 
dev
);

970 ià(
r
) {

971 
	`SLSI_NET_ERR
(
dev
, "FaedØ»assocŸ‹ : %d\n", 
r
);

973 
ndev_vif
->
¡a
.
vif_¡©us
 = 
SLSI_VIF_STATUS_CONNECTING
;

974 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DISCONNECTED
);

977 ià(!
ndev_vif
->
¡a
.
¡a_bss
) {

978 
	`SLSI_NET_ERR
(
dev
, "Bss is‚ot stored in‚dev_vif sta\n");

979  -
EINVAL
;

981 
cÚÃùed_ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,‚dev_vif->¡a.¡a_bss->›s->
Ën
);

983 ià(!
cÚÃùed_ssid
) {

984 
	`SLSI_NET_ERR
(
dev
, "Require ssid in„oam but„eceived‚ull\n");

985  -
EINVAL
;

988 ià(!
	`memcmp
(&
cÚÃùed_ssid
[2], 
sme
->
ssid
, connected_ssid[1])) {

989 ià(!
sme
->
chªÃl
) {

990 
	`SLSI_NET_ERR
(
dev
, "Roaming has been„ejected,‡s sme->channel is‚ull\n");

991  -
EINVAL
;

993 ià(
sme
->
bssid
) {

994 
r
 = 
	`¦si_mlme_rßm
(
sdev
, 
dev
, 
sme
->
bssid
, sme->
chªÃl
->
ûÁ”_äeq
);

995 } ià(
sme
->
bssid_hšt
) {

996 
r
 = 
	`¦si_mlme_rßm
(
sdev
, 
dev
, 
sme
->
bssid_hšt
, sme->
chªÃl
->
ûÁ”_äeq
);

998 
	`SLSI_NET_ERR
(
dev
, "Roaming has been„ejected,‡s bssid‡nd bssid_hint‡re‚ull\n");

999  -
EINVAL
;

1001 ià(
r
) {

1002 
	`SLSI_NET_ERR
(
dev
, "FaedØrßm : %d\n", 
r
);

1003  -
EINVAL
;

1006 
	`SLSI_NET_ERR
(
dev
, "Connected but„eceived connecto‚ew ESS, without disconnect");

1007  -
EINVAL
;

1010  
r
;

1011 
	}
}

1013 
	$¦si_check_v®id_Ãtdev_vif_¡©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

1015 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1018 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


1019 ià(
	`SLSI_IS_VIF_INDEX_MHS
(
sdev
, 
ndev_vif
è&&‚dev_vif->
iáy³
 =ğ
NL80211_IFTYPE_P2P_CLIENT
) {

1020 
	`SLSI_NET_ERR
(
dev
, "Iáy³: %d\n", 
ndev_vif
->
iáy³
);

1021  -
EINVAL
;

1025 ià(
	`WARN_ON
(
ndev_vif
->
aùiv©ed
)) {

1026 
	`SLSI_NET_ERR
(
dev
, "Viài ®»ady‡ùiv©ed: %d\n", 
ndev_vif
->
aùiv©ed
);

1027  -
EINVAL
;

1029 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

1030 
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_UNSPECIFIED
) {

1031 
	`SLSI_NET_ERR
(
dev
, "VIF stus: %d\n", 
ndev_vif
->
¡a
.
vif_¡©us
);

1032  -
EINVAL
;

1035 
	}
}

1037 
	$¦si_£t_bm­
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 *
aùiÚ_äame_bm­
, u32 *
aùiÚ_äame_su¥’d_bm­
, 
u8
 *
deviû_add»ss
)

1039 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1040 
Ãt_deviû
 *
p2p_dev
;

1042 
ndev_vif
->
iáy³
) {

1043 
NL80211_IFTYPE_UNSPECIFIED
:

1044 
NL80211_IFTYPE_STATION
:

1045 
ndev_vif
->
iáy³
 = 
NL80211_IFTYPE_STATION
;

1046 
dev
->
›“80211_±r
->
iáy³
 = 
NL80211_IFTYPE_STATION
;

1047 *
aùiÚ_äame_bm­
 = 
SLSI_STA_ACTION_FRAME_BITMAP
;

1048 *
aùiÚ_äame_su¥’d_bm­
 = 
SLSI_STA_ACTION_FRAME_SUSPEND_BITMAP
;

1049 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1050 ià(
sdev
->
deviû_cÚfig
.
wes_mode
) {

1051 *
aùiÚ_äame_bm­
 |ğ
SLSI_ACTION_FRAME_VENDOR_SPEC
;

1052 *
aùiÚ_äame_su¥’d_bm­
 |ğ
SLSI_ACTION_FRAME_VENDOR_SPEC
;

1056 
NL80211_IFTYPE_P2P_CLIENT
:

1057 
	`¦si_p2p_group_¡¬t_»move_unsync_vif
(
sdev
);

1058 
p2p_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2P
);

1059 ià(
p2p_dev
)

1060 
	`SLSI_ETHER_COPY
(
deviû_add»ss
, 
p2p_dev
->
dev_addr
);

1061 *
aùiÚ_äame_bm­
 = 
SLSI_ACTION_FRAME_PUBLIC
;

1062 *
aùiÚ_äame_su¥’d_bm­
 = 
SLSI_ACTION_FRAME_PUBLIC
;

1065 
	`SLSI_NET_ERR
(
dev
, "Inv®id Deviû Ty³: %d\n", 
ndev_vif
->
iáy³
);

1066  -
EINVAL
;

1069 
	}
}

1071 
	$¦si_£t_¡a_bss_šfo
(
why
 *why, 
Ãt_deviû
 *
dev
, 
¦si_dev
 *
sdev
,

1072 
cfg80211_cÚÃù_·¿ms
 *
sme
, 
›“80211_chªÃl
 **
chªÃl
,

1073 cÚ¡ 
u8
 **
bssid
, 
u16
 
´ev_vif_ty³
)

1075 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1076 
u16
 
ÿ·b™y
 = 
WLAN_CAPABILITY_ESS
;

1077 
r
 = 0;

1079 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

1080 
ÿ·b™y
 = 
sme
->
´ivacy
 ? 
IEEE80211_PRIVACY_ON
 : 
IEEE80211_PRIVACY_OFF
;

1082 ià(
sme
->
´ivacy
)

1083 
ÿ·b™y
 |ğ
WLAN_CAPABILITY_PRIVACY
;

1086 
ndev_vif
->
¡a
.
¡a_bss
 = 
	`cfg80211_g‘_bss
(
why
,

1087 *
chªÃl
,

1088 *
bssid
,

1089 
sme
->
ssid
,

1090 
sme
->
ssid_Ën
,

1091 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

1092 
IEEE80211_BSS_TYPE_ANY
,

1094 
ÿ·b™y
,

1096 
ÿ·b™y
);

1098 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1099 ià(!
sme
->
bssid
 && !sme->
bssid_hšt
 && !
ndev_vif
->
¡a
.
¡a_bss
) {

1100 
li¡_h—d
 *
pos
;

1102 
	`li¡_fÜ_—ch
(
pos
, &
ndev_vif
->
¡a
.
ssid_šfo
) {

1103 
¦si_ssid_šfo
 *
ssid_šfo
 = 
	`li¡_’Œy
(
pos
, ¦si_ssid_šfo, 
li¡
);

1104 
li¡_h—d
 *
pos_bssid
;

1106 ià(
ssid_šfo
->
ssid
.
ssid_Ën
 !ğ
ndev_vif
->
¡a
.ssid_len ||

1107 
	`memcmp
(
ssid_šfo
->
ssid
.ssid, &
ndev_vif
->
¡a
.ssid,‚dev_vif->¡a.
ssid_Ën
) != 0 ||

1108 !(
ssid_šfo
->
akm_ty³
 & 
ndev_vif
->
¡a
.akm_type))

1110 
	`li¡_fÜ_—ch
(
pos_bssid
, &
ssid_šfo
->
bssid_li¡
) {

1111 
¦si_bssid_šfo
 *
bssid_šfo
 = 
	`li¡_’Œy
(
pos_bssid
, ¦si_bssid_šfo, 
li¡
);

1113 ià(*
bssid
 && !
	`memcmp
(
bssid_šfo
->bssid, *bssid, 
ETH_ALEN
))

1115 
ndev_vif
->
¡a
.
¡a_bss
 = 
	`cfg80211_g‘_bss
(
why
,

1116 
	`›“80211_g‘_chªÃl
(
sdev
->
why
,

1117 (
bssid_šfo
->
äeq
 / 2)),

1118 
bssid_šfo
->
bssid
,

1119 
sme
->
ssid
,

1120 
sme
->
ssid_Ën
,

1121 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

1122 
IEEE80211_BSS_TYPE_ANY
,

1124 
ÿ·b™y
,

1126 
ÿ·b™y
);

1127 ià(
ndev_vif
->
¡a
.
¡a_bss
) {

1128 *
bssid
 = 
bssid_šfo
->bssid;

1129 *
chªÃl
 = 
	`›“80211_g‘_chªÃl
(
sdev
->
why
, (
bssid_šfo
->
äeq
 / 2));

1136 ià(!
ndev_vif
->
¡a
.
¡a_bss
) {

1137 
cfg80211_ssid
 
ssid
;

1139 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "BSS info is‚ot‡vailable - Perform scan\n");

1140 
ssid
.
ssid_Ën
 = 
sme
->ssid_len;

1141 
	`memıy
(
ssid
.ssid, 
sme
->ssid, ssid.
ssid_Ën
);

1142 ià(!(
ssid
.
ssid_Ën
 > 0 && *
chªÃl
)) {

1143 
r
 = 
	`¦si_mlme_cÚÃù_sÿn
(
sdev
, 
dev
, 1, &
ssid
, *
chªÃl
);

1144 ià(
r
) {

1145 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_connect_scan failed\n");

1146  
r
;

1148 
ndev_vif
->
¡a
.
¡a_bss
 = 
	`cfg80211_g‘_bss
(
why
,

1149 *
chªÃl
,

1150 *
bssid
,

1151 
sme
->
ssid
,

1152 
sme
->
ssid_Ën
,

1153 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

1154 
IEEE80211_BSS_TYPE_ANY
,

1156 
ÿ·b™y
,

1158 
ÿ·b™y
);

1159 ià(!
ndev_vif
->
¡a
.
¡a_bss
) {

1160 ià(*
bssid
)

1161 
	`SLSI_NET_ERR
(
dev
, "cfg80211_g‘_bss(%.*s, " 
MACSTR
 ") Not found\n",

1162 ()
sme
->
ssid_Ën
, sme->
ssid
, 
	`MAC2STR
(*
bssid
));

1164 
	`SLSI_NET_ERR
(
dev
, "cfg80211_get_bss(%.*s) Not found\n",

1165 ()
sme
->
ssid_Ën
, sme->
ssid
);

1167 
ndev_vif
->
vif_ty³
 = 
´ev_vif_ty³
;

1168  -
ENOENT
;

1170 *
chªÃl
 = 
ndev_vif
->
¡a
.
¡a_bss
->channel;

1171 *
bssid
 = 
ndev_vif
->
¡a
.
¡a_bss
->bssid;

1174 #ifdeà
CONFIG_SEC_FACTORY


1175 ià(
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
 !ğ
SLSI_FREQ_BAND_AUTO
) {

1176 
suµÜ‹d_bªd
 = 
sdev
->
deviû_cÚfig
.supported_band;

1177 
bss_bªd
 = 
ndev_vif
->
¡a
.
¡a_bss
->
chªÃl
->
bªd
;

1179 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "sup_bªd %d, bss_bªd %d\n", 
suµÜ‹d_bªd
, 
bss_bªd
);

1180 ià(
suµÜ‹d_bªd
 =ğ
SLSI_FREQ_BAND_2GHZ
 && 
bss_bªd
 !ğ
NL80211_BAND_2GHZ
)

1181  -
EPERM
;

1182 ià(
suµÜ‹d_bªd
 =ğ
SLSI_FREQ_BAND_5GHZ
 && 
bss_bªd
 !ğ
NL80211_BAND_5GHZ
)

1183  -
EPERM
;

1187 *
chªÃl
 = 
ndev_vif
->
¡a
.
¡a_bss
->channel;

1188 *
bssid
 = 
ndev_vif
->
¡a
.
¡a_bss
->bssid;

1191 
	}
}

1193 
	$¦si_cÚfig_r¢_›
(
Ãt_deviû
 *
dev
, 
cfg80211_cÚÃù_·¿ms
 *
sme
)

1195 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1197 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

1198 cÚ¡ 
u8
 *
r¢
;

1200 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "N AKM Su™es: : %1d\n", 
sme
->
üy±o
.
n_akm_su™es
);

1201 
r¢
 = 
	`cfg80211_fšd_›
(
WLAN_EID_RSN
, 
sme
->
›
, sme->
›_Ën
);

1203 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


1204 ià(
r¢
) {

1205 
pos
;

1212 
pos
 = 7 + 2 + (
r¢
[8] * 4) + 2;

1213 
ndev_vif
->
¡a
.
üy±o
.
akm_su™es
[0] = ((
r¢
[
pos
 + 4] << 24) | (rsn[pos + 3] << 16) | (rsn[pos + 2] << 8) | (rsn[pos + 1]));

1214 ià((
r¢
[
pos
 + 1] == 0x00 &&„sn[pos + 2] == 0x0f &&„sn[pos + 3] == 0xac) && (rsn[pos + 4] == 0x08 ||„sn[pos + 4] == 0x09)) {

1215 
ndev_vif
->
¡a
.
üy±o
.
w·_v”siÚs
 = 3;

1216 
ndev_vif
->
¡a
.
u£_£t_pmk§
 = 1;

1217 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1218 
ndev_vif
->
¡a
.
w·3_auth_¡©e
 = 
SLSI_WPA3_PREAUTH
;

1220 } ià((
r¢
[
pos
 + 1] == 0x00 &&„sn[pos + 2] == 0x0f &&„sn[pos + 3] == 0xac) && (rsn[pos + 4] == 18)) {

1221 
ndev_vif
->
¡a
.
u£_£t_pmk§
 = 1;

1223 
ndev_vif
->
¡a
.
üy±o
.
w·_v”siÚs
 = 0;

1224 
ndev_vif
->
¡a
.
u£_£t_pmk§
 = 0;

1227 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "RSN IE: : %1d\n", 
ndev_vif
->
¡a
.
üy±o
.
akm_su™es
[0]);

1229 ià(
r¢
) {

1230 
ndev_vif
->
¡a
.
r¢_›_Ën
 = 
r¢
[1];

1231 
	`kä“
(
ndev_vif
->
¡a
.
r¢_›
);

1232 
ndev_vif
->
¡a
.
r¢_›
 = 
NULL
;

1234 
ndev_vif
->
¡a
.
r¢_›
 = 
	`km®loc
Òdev_vif->¡a.
r¢_›_Ën
 + 2, 
GFP_KERNEL
);

1237 ià(
ndev_vif
->
¡a
.
r¢_›
)

1238 
	`memıy
(
ndev_vif
->
¡a
.
r¢_›
, 
r¢
,‚dev_vif->¡a.
r¢_›_Ën
 + 2);

1241 
	}
}

1243 
	$¦si_cÚÃù
(
why
 *why, 
Ãt_deviû
 *
dev
,

1244 
cfg80211_cÚÃù_·¿ms
 *
sme
)

1246 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1247 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1248 
u8
 
deviû_add»ss
[
ETH_ALEN
] = { 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF };

1249 
r
 = 0;

1250 
¦si_³”
 *
³”
;

1251 
u16
 
´ev_vif_ty³
;

1252 
u32
 
aùiÚ_äame_bm­
;

1253 
u32
 
aùiÚ_äame_su¥’d_bm­
;

1254 cÚ¡ 
u8
 *
bssid
;

1255 
›“80211_chªÃl
 *
chªÃl
;

1256 
u8
 
³”_add»ss
[
ETH_ALEN
] = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };

1257 
u16
 
ûÁ”_äeq
 = 0;

1259 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

1260 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_CONNECT.request\n");

1261  -
EOPNOTSUPP
;

1264 
	`SLSI_MUTEX_LOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

1265 ià(
sdev
->
deviû_¡©e
 !ğ
SLSI_DEVICE_STATE_STARTED
) {

1266 
	`SLSI_WARN
(
sdev
, "deviû‚Ù s¹ed y‘ (deviû_¡©e:%d)\n", sdev->
deviû_¡©e
);

1267 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

1268  -
EINVAL
;

1271 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1272 
chªÃl
 = 
sme
->channel;

1273 
bssid
 = 
sme
->bssid;

1274 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1275 
	`¦si_£t_·¿ms_Ú_bss
(
sdev
, 
dev
, 
sme
, &
chªÃl
, &
bssid
);

1280 
r
 = 
	`¦si_is_bssid_š_bÏckli¡
(
sdev
, 
dev
, (
u8
 *)
bssid
);

1281 ià(
r
) {

1282 
	`SLSI_NET_ERR
(
dev
, "Blacklist bssid‚ot‡llowed\n");

1283 
ex™_w™h_”rÜ
;

1286 ià(
ndev_vif
->
¡a
.
¡a_bss
)

1287 
	`SLSI_ETHER_COPY
(
³”_add»ss
, 
ndev_vif
->
¡a
.
¡a_bss
->
bssid
);

1289 
ûÁ”_äeq
 = 
chªÃl
 ? channel->center_freq : 0;

1291 ià(
	`WARN_ON
(!
sme
->
ssid
è|| WARN_ON(sme->
ssid_Ën
 > 
IEEE80211_MAX_SSID_LEN
))

1292 
ex™_w™h_”rÜ
;

1294 ià(
bssid
)

1295 
	`SLSI_NET_INFO
(
dev
, "%.* F»q=%d vifStus=%d Cu¼Bssid:" 
MACSTR
 " NewBssid:" MACSTR "‡uth_type: %d Qinfo:%d ieLen:%d\n",

1296 ()
sme
->
ssid_Ën
, sme->
ssid
, 
ûÁ”_äeq
, 
ndev_vif
->
¡a
.
vif_¡©us
,

1297 
	`MAC2STR
(
³”_add»ss
), MAC2STR(
bssid
), ()
sme
->
auth_ty³
, 
sdev
->
deviû_cÚfig
.
qos_šfo
, ()sme->
›_Ën
);

1299 
	`SLSI_NET_INFO
(
dev
, "%.* F»q=%d vifStus=%d Cu¼Bssid:" 
MACSTR
 "‡uth_type: %d Qinfo:%d ieLen:%d\n",

1300 ()
sme
->
ssid_Ën
, sme->
ssid
, 
ûÁ”_äeq
, 
ndev_vif
->
¡a
.
vif_¡©us
,

1301 
	`MAC2STR
(
³”_add»ss
), ()
sme
->
auth_ty³
, 
sdev
->
deviû_cÚfig
.
qos_šfo
, ()sme->
›_Ën
);

1303 #ià
	`IS_ENABLED
(
CONFIG_SCSC_WIFILOGGER
)

1304 
	`SCSC_WLOG_PKTFATE_NEW_ASSOC
();

1305 ià(
bssid
) {

1306 
	`SCSC_WLOG_DRIVER_EVENT
(
WLOG_NORMAL
, 
WIFI_EVENT_ASSOCIATION_REQUESTED
, 3,

1307 
WIFI_TAG_BSSID
, 
ETH_ALEN
, 
bssid
,

1308 
WIFI_TAG_SSID
, 
sme
->
ssid_Ën
, sme->
ssid
,

1309 
WIFI_TAG_CHANNEL
, (
u16
), &
ûÁ”_äeq
);

1313 ià(
	`SLSI_IS_HS2_UNSYNC_VIF
(
ndev_vif
)) {

1314 
	`¦si_wÏn_unsync_vif_d—ùiv©e
(
sdev
, 
dev
, 
Œue
);

1315 } ià(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
)) {

1316 
	`SLSI_NET_ERR
(
dev
, "Connect„equested on incorrect vif\n");

1317 
ex™_w™h_”rÜ
;

1320 
r
 = 
	`¦si_check_wificÚÃù_to_cÚÃùedGo
(
sdev
, 
dev
, 
bssid
);

1321 ià(
r
 != 0) {

1322 
	`SLSI_NET_ERR
(
dev
, "Connect Request Rejected\n");

1323 
ex™_w™h_”rÜ
;

1327 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&‚dev_vif->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
) {

1328 
r
 = 
	`¦si_£t_rßm_»assoc
(
dev
, 
sdev
, 
sme
);

1329 ià(
r
 == 0)

1330 
ex™
;

1332 
ex™_w™h_”rÜ
;

1335 
r
 = 
	`¦si_check_v®id_Ãtdev_vif_¡©e
(
sdev
, 
dev
);

1336 ià(
r
 != 0) {

1337 
	`SLSI_NET_ERR
(
dev
, "Invalid‚etdev vif state\n");

1338 
ex™_w™h_”rÜ
;

1341 
´ev_vif_ty³
 = 
ndev_vif
->
vif_ty³
;

1343 
r
 = 
	`¦si_£t_bm­
(
sdev
, 
dev
, &
aùiÚ_äame_bm­
, &
aùiÚ_äame_su¥’d_bm­
, 
deviû_add»ss
);

1344 ià(
r
 != 0)

1345 
ex™_w™h_”rÜ
;

1348 
ndev_vif
->
vif_ty³
 = 
FAPI_VIFTYPE_STATION
;

1350 #ià(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1351 
chªÃl
 = 
sme
->channel;

1352 
bssid
 = 
sme
->bssid;

1354 
r
 = 
	`¦si_£t_¡a_bss_šfo
(
why
, 
dev
, 
sdev
, 
sme
, &
chªÃl
, &
bssid
, 
´ev_vif_ty³
);

1355 ià(
r
 != 0)

1356 
ex™
;

1358 
ndev_vif
->
chª
 = 
chªÃl
;

1359 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1360 
ndev_vif
->
¡a
.
ssid_Ën
 = 
sme
->ssid_len;

1361 
	`memıy
(
ndev_vif
->
¡a
.
ssid
, 
sme
->ssid, sme->
ssid_Ën
);

1366 ià(
bssid
)

1367 
	`SLSI_ETHER_COPY
(
ndev_vif
->
¡a
.
bssid
, bssid);

1369 ià(
	`¦si_mlme_add_vif
(
sdev
, 
dev
, dev->
dev_addr
, 
deviû_add»ss
) != 0) {

1370 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_add_vif failed\n");

1371 
ex™_w™h_bss
;

1373 ià(
	`¦si_vif_aùiv©ed
(
sdev
, 
dev
) != 0) {

1374 
	`SLSI_NET_ERR
(
dev
, "slsi_vif_activated failed\n");

1375 
ex™_w™h_vif
;

1377 ià(
	`¦si_mlme_»gi¡”_aùiÚ_äame
(
sdev
, 
dev
, 
aùiÚ_äame_bm­
, 
aùiÚ_äame_su¥’d_bm­
) != 0) {

1378 
	`SLSI_NET_ERR
(
dev
, "AùiÚ f¿m»gi¡¿tiÚ faed fÜ b™m­ v®u0x%x 0x%x\n", 
aùiÚ_äame_bm­
, 
aùiÚ_äame_su¥’d_bm­
);

1379 
ex™_w™h_vif
;

1382 
r
 = 
	`¦si_£t_boo¡
(
sdev
, 
dev
);

1383 ià(
r
 != 0)

1384 
	`SLSI_NET_ERR
(
dev
, "Rss˜Boo¡ s‘ faed: %d\n", 
r
);

1389 ià(
ndev_vif
->
´obe_»q_›s
) {

1390 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_CLIENT
) {

1391 ià(
sme
->
üy±o
.
w·_v”siÚs
 == 2)

1392 
ndev_vif
->
d–‘e_´obe_»q_›s
 = 
Œue
;

1397 
ndev_vif
->
d–‘e_´obe_»q_›s
 = 
çl£
;

1399 
ndev_vif
->
d–‘e_´obe_»q_›s
 = 
Œue
;

1402 
r
 = 
	`¦si_add_´obe_›s_»que¡
(
sdev
, 
dev
);

1409 
	`Ãtif_ÿ¼›r_Ú
(
dev
);

1410 
ndev_vif
->
¡a
.
vif_¡©us
 = 
SLSI_VIF_STATUS_CONNECTING
;

1411 
ndev_vif
->
¡a
.
rßm_Ú_discÚÃù
 = 
çl£
;

1412 
r
 = 
	`¦si_£t_ext_ÿp
(
sdev
, 
dev
, 
sme
->
›
, sme->
›_Ën
, 
¦si_ex‹nded_ÿp_mask
);

1413 ià(
r
 != 0)

1414 
	`SLSI_NET_ERR
(
dev
, "FaedØ£ˆex‹nded c­ab™y MIB: %d\n", 
r
);

1416 
	`¦si_cÚfig_r¢_›
(
dev
, 
sme
);

1418 
r
 = 
	`¦si_mlme_cÚÃù
(
sdev
, 
dev
, 
sme
, 
chªÃl
, 
bssid
);

1419 ià(
r
 != 0) {

1420 
ndev_vif
->
¡a
.
is_wps
 = 
çl£
;

1421 
	`SLSI_NET_ERR
(
dev
, "cÚÃù faed: %d\n", 
r
);

1422 
	`Ãtif_ÿ¼›r_off
(
dev
);

1423 
ex™_w™h_vif
;

1425 
³”
 = 
	`¦si_³”_add
(
sdev
, 
dev
, (
u8
 *)
bssid
, 
SLSI_STA_PEER_QUEUESET
 + 1);

1426 
ndev_vif
->
¡a
.
»¥_id
 = 0;

1427 ià(!
³”
)

1428 
ex™_w™h_”rÜ
;

1430 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1431 ià(
ndev_vif
->
¡a
.
drv_bss_£ËùiÚ
) {

1432 
	`¦si_§ve_cÚÃùiÚ_·¿ms
(
sdev
, 
dev
, 
sme
, 
chªÃl
, 
bssid
,

1433 
aùiÚ_äame_bm­
, 
aùiÚ_äame_su¥’d_bm­
);

1434 
	`¦si_£t_»£t_cÚÃù_©‹m±ed_æag
(
sdev
, 
dev
, 
bssid
);

1437 
ex™
;

1439 
ex™_w™h_vif
:

1440 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

1441 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

1442 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

1443 
ex™_w™h_bss
:

1444 ià(
ndev_vif
->
¡a
.
¡a_bss
) {

1445 
	`¦si_cfg80211_put_bss
(
why
, 
ndev_vif
->
¡a
.
¡a_bss
);

1446 
ndev_vif
->
¡a
.
¡a_bss
 = 
NULL
;

1448 
ex™_w™h_”rÜ
:

1449 
r
 = -
EINVAL
;

1450 
ex™
:

1451 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1452 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

1453  
r
;

1454 
	}
}

1456 
	$¦si_discÚÃù
(
why
 *why, 
Ãt_deviû
 *
dev
,

1457 
u16
 
»asÚ_code
)

1459 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1460 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1461 
¦si_³”
 *
³”
;

1462 
r
 = 0;

1464 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
£t_muÉiÿ¡_f‹r_wÜk
);

1465 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
upd©e_pkt_f‹r_wÜk
);

1466 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1468 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "»asÚ: %d, vif_šdex = %d, vif_ty³ = %d\n", 
»asÚ_code
,

1469 
ndev_vif
->
iâum
,‚dev_vif->
vif_ty³
);

1475 ià(!
ndev_vif
->
aùiv©ed
) {

1476 
r
 = 0;

1477 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 2, 0))

1478 
	`cfg80211_discÚÃùed
(
dev
, 
»asÚ_code
, 
NULL
, 0, 
çl£
, 
GFP_KERNEL
);

1480 
	`cfg80211_discÚÃùed
(
dev
, 
»asÚ_code
, 
NULL
, 0, 
GFP_KERNEL
);

1482 
	`SLSI_NET_INFO
(
dev
, "Vif is‡lready Deactivated\n");

1483 
ex™
;

1486 
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
];

1488 #ià
	`IS_ENABLED
(
CONFIG_SCSC_WIFILOGGER
)

1489 
	`SCSC_WLOG_DRIVER_EVENT
(
WLOG_NORMAL
, 
WIFI_EVENT_DISASSOCIATION_REQUESTED
, 2,

1490 
WIFI_TAG_BSSID
, 
ETH_ALEN
, 
³”
->
add»ss
,

1491 
WIFI_TAG_REASON_CODE
, (
u16
), &
»asÚ_code
);

1494 
ndev_vif
->
vif_ty³
) {

1495 
FAPI_VIFTYPE_STATION
:

1497 
	`¦si_»£t_throughput_¡©s
(
dev
);

1502 
ndev_vif
->
¡a
.
vif_¡©us
 = 
SLSI_VIF_STATUS_DISCONNECTING
;

1504 
	`Ãtif_ÿ¼›r_off
(
dev
);

1505 ià(
³”
->
v®id
)

1506 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DISCONNECTED
);

1515 
r
 = 
	`¦si_mlme_discÚÃù
(
sdev
, 
dev
, 
³”
->
add»ss
, 
»asÚ_code
, 
Œue
);

1516 ià(
r
 != 0)

1517 
	`SLSI_NET_ERR
(
dev
, "Disconnection„eturned with failure\n");

1519 
r
 = 
	`¦si_hªdË_discÚÃù
(
sdev
, 
dev
, 
³”
->
add»ss
, 0, 
NULL
, 0);

1524 
	`SLSI_NET_WARN
(
dev
, "Inv®id - viàty³:%d, deviûy³:%d)\n", 
ndev_vif
->
vif_ty³
,‚dev_vif->
iáy³
);

1525 
r
 = -
EINVAL
;

1529 
ex™
:

1530 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1531  
r
;

1532 
	}
}

1534 
	$¦si_£t_deçuÉ_key
(
why
 *why, 
Ãt_deviû
 *
dev
,

1535 
u8
 
key_šdex
, 
boŞ
 
uniÿ¡
, boŞ 
muÉiÿ¡
)

1537 
	`SLSI_UNUSED_PARAMETER
(
why
);

1538 
	`SLSI_UNUSED_PARAMETER
(
dev
);

1539 
	`SLSI_UNUSED_PARAMETER
(
key_šdex
);

1540 
	`SLSI_UNUSED_PARAMETER
(
uniÿ¡
);

1541 
	`SLSI_UNUSED_PARAMETER
(
muÉiÿ¡
);

1544 
	}
}

1546 
	$¦si_cÚfig_deçuÉ_mgmt_key
(
why
 *wiphy,

1547 
Ãt_deviû
 *
dev
,

1548 
u8
 
key_šdex
)

1550 
	`SLSI_UNUSED_PARAMETER
(
why
);

1551 
	`SLSI_UNUSED_PARAMETER
(
key_šdex
);

1552 
	`SLSI_UNUSED_PARAMETER
(
dev
);

1555 
	}
}

1557 
	$¦si_£t_why_·¿ms
(
why
 *why, 
u32
 
chªged
)

1559 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1560 
r
 = 0;

1562 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "slsi_set_wiphy_parms Frag Threshold = %d, RTS Threshold = %d",

1563 
why
->
äag_th»shŞd
, why->
¹s_th»shŞd
);

1565 ià((
chªged
 & 
WIPHY_PARAM_FRAG_THRESHOLD
è&& (
why
->
äag_th»shŞd
 != -1)) {

1566 
r
 = 
	`¦si_£t_ušt_mib
(
sdev
, 
NULL
, 
SLSI_PSID_DOT11_FRAGMENTATION_THRESHOLD
, 
why
->
äag_th»shŞd
);

1567 ià(
r
 != 0) {

1568 
	`SLSI_ERR
(
sdev
, "Setting FRAG_THRESHOLD failed\n");

1569  
r
;

1573 ià((
chªged
 & 
WIPHY_PARAM_RTS_THRESHOLD
è&& (
why
->
¹s_th»shŞd
 != -1)) {

1574 
r
 = 
	`¦si_£t_ušt_mib
(
sdev
, 
NULL
, 
SLSI_PSID_DOT11_RTS_THRESHOLD
, 
why
->
¹s_th»shŞd
);

1575 ià(
r
 != 0) {

1576 
	`SLSI_ERR
(
sdev
, "Setting RTS_THRESHOLD failed\n");

1577  
r
;

1581  
r
;

1582 
	}
}

1584 
	$¦si_£t_tx_pow”
(
why
 *why, 
wœ–ess_dev
 *
wdev
,

1585 
Æ80211_tx_pow”_£‰šg
 
ty³
, 
mbm
)

1587 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1588 
r
 = 0;

1590 
	`SLSI_UNUSED_PARAMETER
(
wdev
);

1591 
	`SLSI_UNUSED_PARAMETER
(
ty³
);

1592 
	`SLSI_UNUSED_PARAMETER
(
mbm
);

1593 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

1595 
r
 = -
EOPNOTSUPP
;

1597  
r
;

1598 
	}
}

1600 
	$¦si_g‘_tx_pow”
(
why
 *why, 
wœ–ess_dev
 *
wdev
, *
dbm
)

1602 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1603 
r
 = 0;

1605 
	`SLSI_UNUSED_PARAMETER
(
wdev
);

1606 
	`SLSI_UNUSED_PARAMETER
(
dbm
);

1607 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

1609 
r
 = -
EOPNOTSUPP
;

1611  
r
;

1612 
	}
}

1614 
	$¦si_d–_¡©iÚ
(
why
 *why, 
Ãt_deviû
 *
dev
,

1615 
¡©iÚ_d–_·¿m‘”s
 *
d–_·¿ms
)

1617 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1618 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1619 
¦si_³”
 *
³”
;

1620 
r
 = 0;

1621 
u16
 
»asÚ_code
 = 
WLAN_REASON_DEAUTH_LEAVING
;

1622 cÚ¡ 
u8
 *
mac
 = 
d–_·¿ms
->mac;

1623 
»asÚ_code
 = 
d–_·¿ms
->reason_code;

1625 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1627 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "%pM, vifType:%d, vifIndex:%d vifActivated:%d‡p.p2p_gc_keys_set = %d\n",

1628 
mac
, 
ndev_vif
->
vif_ty³
,‚dev_vif->
iâum
,‚dev_vif->
aùiv©ed
,‚dev_vif->
­
.
p2p_gc_keys_£t
);

1631 ià(!
ndev_vif
->
aùiv©ed
)

1632 
ex™
;

1634 ià(
FAPI_VIFTYPE_AP
 !ğ
ndev_vif
->
vif_ty³
) {

1635 
r
 = -
EINVAL
;

1636 
ex™
;

1639 ià(!
mac
)

1640 
ex™
;

1641 ià(
	`is_brßdÿ¡_‘h”_addr
(
mac
è&& 
»asÚ_code
 =ğ
WLAN_REASON_DEAUTH_LEAVING
) {

1642 
i
 = 0;

1644 
i
 < 
SLSI_PEER_INDEX_MAX
) {

1645 
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
i
];

1646 ià(
³”
 &&…“r->
v®id
) {

1647 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DISCONNECTED
);

1649 ++
i
;

1658 
	`¦si_ş—r_ÿched_›s
(&
ndev_vif
->
­
.
ÿche_w·_›
, &ndev_vif->­.
w·_›_Ën
);

1659 
	`¦si_ş—r_ÿched_›s
(&
ndev_vif
->
­
.
ÿche_wmm_›
, &ndev_vif->­.
wmm_›_Ën
);

1661 
	`Ãtif_ÿ¼›r_off
(
dev
);

1664 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

1665 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

1666 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

1667 
ndev_vif
->
add»ss
 = 
	`ıu_to_be32
(0);

1669 ià(
ndev_vif
->
­
.
p2p_gc_keys_£t
) {

1670 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

1671 
ndev_vif
->
­
.
p2p_gc_keys_£t
 = 
çl£
;

1674 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
mac
);

1675 ià(
³”
) {

1676 ià(
³”
->
cÚÃùed_¡©e
 =ğ
SLSI_STA_CONN_STATE_CONNECTING
) {

1677 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "SLSI_STA_CONN_STATE_CONNECTING : mlme-disconnect-req dropped‡t driver\n");

1678 
ex™
;

1680 ià(
³”
->
is_wps
) {

1682 
	`SLSI_NET_INFO
(
dev
, "DISCONNECT‡fter WPS : mlme-disconnect-req dropped‡t driver\n");

1683 
ex™
;

1685 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DISCONNECTED
);

1686 
r
 = 
	`¦si_mlme_discÚÃù
(
sdev
, 
dev
, 
³”
->
add»ss
, 
»asÚ_code
, 
Œue
);

1687 ià(
r
 != 0)

1688 
	`SLSI_NET_ERR
(
dev
, "Disconnection„eturned with failure\n");

1690 
r
 = 
	`¦si_hªdË_discÚÃù
(
sdev
, 
dev
, 
³”
->
add»ss
, 
»asÚ_code
, 
NULL
, 0);

1694 
ex™
:

1695 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1696  
r
;

1697 
	}
}

1699 
	$¦si_g‘_¡©iÚ
(
why
 *why, 
Ãt_deviû
 *
dev
,

1700 cÚ¡ 
u8
 *
mac
, 
¡©iÚ_šfo
 *
sšfo
)

1702 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1703 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1704 
¦si_³”
 *
³”
;

1705 
r
 = 0;

1707 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1709 ià(!
ndev_vif
->
aùiv©ed
) {

1710 
r
 = -
EINVAL
;

1711 
ex™
;

1714 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
mac
);

1715 ià(!
³”
) {

1716 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "%pM : NÙ Found\n", 
mac
);

1717 
r
 = -
EINVAL
;

1718 
ex™
;

1721 ià(((
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
 && !Òdev_vif->
¡a
.
rßm_š_´og»ss
)) ||

1722 
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_CLIENT
)) {

1724 
r
 = 
	`¦si_mlme_g‘_sšfo_mib
(
sdev
, 
dev
, 
³”
);

1725 ià(
r
) {

1726 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "çedØ»ad StiÚ InfØE¼Ü:%d\n", 
r
);

1727 
ex™
;

1731 *
sšfo
 = 
³”
->sinfo;

1732 
sšfo
->
g’”©iÚ
 = 
ndev_vif
->
cfg80211_sšfo_g’”©iÚ
;

1734 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 2, 0))

1735 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
,

1738 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "%pM,x:%d,xbytes:%llu,„x:%d,„xbytes:%llux_fail:%dx_retry:%d\n",

1740 
mac
,

1741 
³”
->
sšfo
.
tx_·ck‘s
,

1742 
³”
->
sšfo
.
tx_by‹s
,

1743 
³”
->
sšfo
.
rx_·ck‘s
,

1744 
³”
->
sšfo
.
rx_by‹s
,

1745 
³”
->
sšfo
.
tx_çed
,

1746 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 2, 0))

1747 
³”
->
sšfo
.
tx_»Œ›s
,

1748 
³”
->
sšfo
.
aœtime_lšk_m‘ric
);

1750 
³”
->
sšfo
.
tx_»Œ›s
);

1753 
ex™
:

1754 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1755  
r
;

1756 
	}
}

1758 
	$¦si_£t_pow”_mgmt
(
why
 *why, 
Ãt_deviû
 *
dev
,

1759 
boŞ
 
’abËd
, 
timeout
)

1761 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1762 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1763 
r
 = -
EINVAL
;

1764 
u16
 
pwr_mode
 = 
’abËd
 ? 
FAPI_POWERMANAGEMENTMODE_POWER_SAVE
 : 
FAPI_POWERMANAGEMENTMODE_ACTIVE_MODE
;

1766 
	`SLSI_UNUSED_PARAMETER
(
timeout
);

1767 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

1768 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_POWERMGT.request\n");

1769  -
EOPNOTSUPP
;

1772 ià(
	`¦si_is_rf_‹¡_mode_’abËd
()) {

1773 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, RFest does‚ot support.\n");

1774  -
EOPNOTSUPP
;

1777 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1779 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "’abËd:%d, vif_ty³:%d, vif_šdex:%d\n", 
’abËd
, 
ndev_vif
->
vif_ty³
,

1780 
ndev_vif
->
iâum
);

1782 ià(
ndev_vif
->
aùiv©ed
 &&‚dev_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

1783 
ndev_vif
->
£t_pow”_mode
 = 
pwr_mode
;

1784 
r
 = 
	`¦si_mlme_pow”mgt
(
sdev
, 
dev
, 
pwr_mode
);

1786 
r
 = 0;

1789 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1790  
r
;

1791 
	}
}

1793 
	$¦si_tdls_İ”
(
why
 *why, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
³”
, 
Æ80211_tdls_İ”©iÚ
 
İ”
)

1795 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1796 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1797 
r
 = 0;

1799 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "İ”:%d, vif_ty³:%d, vif_šdex:%d\n", 
İ”
, 
ndev_vif
->
vif_ty³
,

1800 
ndev_vif
->
iâum
);

1802 ià(!(
why
->
æags
 & 
WIPHY_FLAG_SUPPORTS_TDLS
))

1803  -
ENOTSUPP
;

1805 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1807 ià(!
ndev_vif
->
aùiv©ed
 || 
	`SLSI_IS_VIF_INDEX_P2P_GROUP
(
sdev
,‚dev_vif) ||

1808 
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

1809 
r
 = -
ENOTSUPP
;

1810 
ex™
;

1813 
İ”
) {

1814 
NL80211_TDLS_DISCOVERY_REQ
:

1815 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "NL80211_TDLS_DISCOVERY_REQ\n");

1816 
r
 = 
	`¦si_mlme_tdls_aùiÚ
(
sdev
, 
dev
, 
³”
, 
FAPI_TDLSACTION_DISCOVERY
, 0, 0);

1818 
NL80211_TDLS_SETUP
:

1819 
r
 = 
	`¦si_mlme_tdls_aùiÚ
(
sdev
, 
dev
, 
³”
, 
FAPI_TDLSACTION_SETUP
, 0, 0);

1821 
NL80211_TDLS_TEARDOWN
:

1822 
r
 = 
	`¦si_mlme_tdls_aùiÚ
(
sdev
, 
dev
, 
³”
, 
FAPI_TDLSACTION_TEARDOWN
, 0, 0);

1825 
r
 = -
EOPNOTSUPP
;

1826 
ex™
;

1828 
ex™
:

1829 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1830  
r
;

1831 
	}
}

1833 
	$¦si_£t_qos_m­
(
why
 *why, 
Ãt_deviû
 *
dev
, 
cfg80211_qos_m­
 *
qos_m­
)

1835 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1836 
¦si_³”
 *
³”
;

1837 
r
 = 0;

1840 ià(!
qos_m­
)

1841  
r
;

1843 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1845 ià(!
ndev_vif
->
aùiv©ed
) {

1846 
r
 = -
EINVAL
;

1847 
ex™
;

1850 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) {

1851 
r
 = -
EINVAL
;

1852 
ex™
;

1855 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "Set QoS Map\n");

1856 
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
];

1857 ià(!
³”
 || !³”->
v®id
) {

1858 
r
 = -
EINVAL
;

1859 
ex™
;

1862 
	`memıy
(&
³”
->
qos_m­
, qos_m­, (
cfg80211_qos_m­
));

1863 
³”
->
qos_m­_£t
 = 
Œue
;

1865 
ex™
:

1866 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1867  
r
;

1868 
	}
}

1870 
	$¦si_£t_mÚ™Ü_chªÃl
(
why
 *why, 
cfg80211_chª_def
 *
chªdef
)

1872 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1873 
Ãt_deviû
 *
dev
;

1874 
Ãtdev_vif
 *
ndev_vif
;

1876 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "chªÃÈ(äeq:%u)\n", 
chªdef
->
chª
->
ûÁ”_äeq
);

1878 
	`rcu_»ad_lock
();

1879 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

1880 ià(!
dev
) {

1881 
	`SLSI_ERR
(
sdev
, "netdev No†ongerƒxists\n");

1882 
	`rcu_»ad_uÆock
();

1883  -
EINVAL
;

1885 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1886 
	`rcu_»ad_uÆock
();

1888 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1890 ià(
	`¦si_‹¡_§p_cÚfigu»_mÚ™Ü_mode
(
sdev
, 
dev
, 
chªdef
) != 0) {

1891 
	`SLSI_ERR
(
sdev
, "set Monitor channel failed\n");

1892 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1893  -
EINVAL
;

1895 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1897 
	}
}

1899 
	$¦si_su¥’d
(
why
 *why, 
cfg80211_wowÏn
 *
wow
)

1901 
	`SLSI_UNUSED_PARAMETER
(
wow
);

1904 
	}
}

1906 
	$¦si_»sume
(
why
 *wiphy)

1908 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1912 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

1915 
	}
}

1917 
	$¦si_£t_pmk§
(
why
 *why, 
Ãt_deviû
 *
dev
,

1918 
cfg80211_pmk§
 *
pmk§
)

1920 
i
 = 0;

1921 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1922 
u8
 *
r¢›
;

1923 
u8
 *
buf
;

1924 
u16
 
r¢›_Ën
;

1925 
Ëá
 = 0;

1926 
u16
 
couÁ
 = 0;

1927 
»t
 = 0;

1928 
pos
 = 0;

1929 
buf_Ën
 = 0;

1930 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1932 ià(
ndev_vif
->
¡a
.
u£_£t_pmk§
) {

1933 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "\n");

1934 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1935 ià(
ndev_vif
->
¡a
.
r¢_›
) {

1936 
r¢›_Ën
 = 
ndev_vif
->
¡a
.
r¢_›_Ën
;

1937 
r¢›
 = 
	`km®loc
(
r¢›_Ën
 + 2 + 
PMKID_LEN
, 
GFP_KERNEL
);

1938 ià(
r¢›
) {

1939 
	`mem£t
(
r¢›
, 0, 
r¢›_Ën
 + 2 + 
PMKID_LEN
);

1941 
Ëá
 = 
r¢›_Ën
 + 2;

1943 
pos
 = 4;

1944 
Ëá
 -= 4;

1945 ià(
Ëá
 < 4) {

1946 
	`kä“
(
r¢›
);

1947 
	`kä“
(
ndev_vif
->
¡a
.
r¢_›
);

1948 
ndev_vif
->
¡a
.
r¢_›
 = 
NULL
;

1949 
»t
 = -
EINVAL
;

1950 
ex™
;

1952 
pos
 +ğ
RSN_SELECTOR_LEN
;

1953 
Ëá
 -ğ
RSN_SELECTOR_LEN
;

1956 
i
 = 0;

1957 
i
 < 2) {

1958 
pos
 += 2;

1959 
Ëá
 -= 2;

1960 
couÁ
 = 
	`Ë16_to_ıu
(*(
u16
 *)(&
ndev_vif
->
¡a
.
r¢_›
[
pos
 - 2]));

1961 
pos
 +ğ
couÁ
 * 
RSN_SELECTOR_LEN
;

1962 
Ëá
 -ğ
couÁ
 * 
RSN_SELECTOR_LEN
;

1963 
i
++;

1965 
pos
 += 2;

1966 
Ëá
 -= 2;

1967 
couÁ
 = 
	`Ë16_to_ıu
(*(
u16
 *)(&
ndev_vif
->
¡a
.
r¢_›
[
pos
]));

1968 
pos
 += 2;

1969 
Ëá
 -= 2;

1970 
	`memıy
(
r¢›
, 
ndev_vif
->
¡a
.
r¢_›
, 
pos
);

1971 
r¢›
[
pos
 - 2] = 1;

1972 
r¢›
[
pos
 - 1] = 0;

1973 
	`memıy
(&
r¢›
[
pos
], 
pmk§
->
pmkid
, 
PMKID_LEN
);

1974 
pos
 +ğ
PMKID_LEN
;

1975 ià(
couÁ
) {

1976 
Ëá
 -ğ
PMKID_LEN
;

1977 
	`memıy
(&
r¢›
[
pos
], &
ndev_vif
->
¡a
.
r¢_›
[pos], 
Ëá
);

1979 
	`memıy
(&
r¢›
[
pos
], &
ndev_vif
->
¡a
.
r¢_›
[po - 
PMKID_LEN
], 
Ëá
);

1981 
pos
 +ğ
Ëá
;

1982 
r¢›_Ën
 = 
pos
;

1983 
r¢›
[1] = 
r¢›_Ën
 - 2;

1984 
buf_Ën
 = 
r¢›_Ën
 + 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
;

1985 
buf
 = 
	`km®loc
(
buf_Ën
, 
GFP_KERNEL
);

1986 ià(!
buf
) {

1987 
	`SLSI_NET_ERR
(
dev
, "Out of memory for buffer\n");

1988 
»t
 = -
ENOMEM
;

1989 
	`kä“
(
r¢›
);

1990 
ex™
;

1992 
	`memıy
(
buf
, 
r¢›
, 
r¢›_Ën
);

1993 ià(
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
)

1994 
	`memıy
(
buf
 + 
r¢›_Ën
, 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
,‚dev_vif->¡a.
assoc_»q_add_šfo_–em_Ën
);

1995 
»t
 = 
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_ASSOCIATION_REQUEST
, 
buf
, 
buf_Ën
);

1996 ià(
»t
 != 0) {

1997 
	`SLSI_NET_ERR
(
dev
, "RSN IE with PMKID setting failed\n");

1998 
	`kä“
(
r¢›
);

1999 
	`kä“
(
buf
);

2000 
ex™
;

2002 
	`kä“
(
buf
);

2003 
	`kä“
(
r¢›
);

2005 
	`SLSI_NET_ERR
(
dev
, "Out of memory for RSN IE\n");

2006 
»t
 = -
ENOMEM
;

2007 
ex™
;

2010 
	`SLSI_NET_ERR
(
dev
, "RSN IE is‚ot…resent in Station VIF\n");

2011 
»t
 = -
EINVAL
;

2012 
ex™
;

2014 
ex™
:

2015 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2017  
»t
;

2018 
	}
}

2020 
	$¦si_d–_pmk§
(
why
 *why, 
Ãt_deviû
 *
dev
,

2021 
cfg80211_pmk§
 *
pmk§
)

2023 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2024 ià(
ndev_vif
->
¡a
.
u£_£t_pmk§
) {

2025 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "\n");

2026 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2027 ià(!
ndev_vif
->
aùiv©ed
)

2028 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "VIF‚ot‡ctivated\n");

2033 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2036 
	}
}

2038 
	$¦si_æush_pmk§
(
why
 *why, 
Ãt_deviû
 *
dev
)

2040 
	`SLSI_UNUSED_PARAMETER
(
why
);

2041 
	`SLSI_UNUSED_PARAMETER
(
dev
);

2043 
	}
}

2045 
	$¦si_»maš_Ú_chªÃl
(
why
 *wiphy,

2046 
wœ–ess_dev
 *
wdev
,

2047 
›“80211_chªÃl
 *
chª
,

2048 
du¿tiÚ
,

2049 
u64
 *
cook›
)

2051 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

2052 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2053 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2054 
r
 = 0;

2056 
	`SLSI_MUTEX_LOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

2057 ià(
sdev
->
deviû_¡©e
 !ğ
SLSI_DEVICE_STATE_STARTED
) {

2058 
	`SLSI_WARN
(
sdev
, "deviû‚Ù s¹ed y‘ (deviû_¡©e:%d)\n", sdev->
deviû_¡©e
);

2059 
ex™_w™h_”rÜ
;

2062 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2064 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "channel freq = %d, duration = %d, vif_type = %d, vif_index = %d,"

2065 "sdev->p2p_¡©ğ%s\n", 
chª
->
ûÁ”_äeq
, 
du¿tiÚ
, 
ndev_vif
->
vif_ty³
,‚dev_vif->
iâum
,

2066 
	`¦si_p2p_¡©e_‹xt
(
sdev
->
p2p_¡©e
));

2067 ià(!
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
)) {

2068 
	`SLSI_NET_ERR
(
dev
, "Invalid vifype\n");

2069 
ex™_w™h_”rÜ
;

2072 ià(
	`SLSI_IS_P2P_GROUP_STATE
(
sdev
)) {

2073 
	`¦si_assign_cook›_id
(
cook›
, &
ndev_vif
->
unsync
.
roc_cook›
);

2075 
	`cfg80211_»ady_Ú_chªÃl
(
wdev
, *
cook›
, 
chª
, 
du¿tiÚ
, 
GFP_KERNEL
);

2076 
	`cfg80211_»maš_Ú_chªÃl_expœed
(
wdev
, *
cook›
, 
chª
, 
GFP_KERNEL
);

2077 
ex™
;

2081 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
d–_vif_wÜk
);

2082 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_ACTION_FRAME_TX_RX
)

2083 
	`queue_d–ayed_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
unsync
.
d–_vif_wÜk
,

2084 
	`m£cs_to_jiff›s
(
du¿tiÚ
 + 
SLSI_P2P_UNSYNC_VIF_EXTRA_MSEC
));

2090 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
);

2092 ià(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
))

2093 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
);

2098 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_ACTION_FRAME_TX_RX
 || sdev->p2p_¡©=ğ
P2P_LISTENING
) {

2099 
ex™_w™h_roc
;

2103 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_IDLE_NO_VIF
) {

2104 ià(
	`¦si_p2p_vif_aùiv©e
(
sdev
, 
dev
, 
chª
, 
du¿tiÚ
, 
Œue
) != 0)

2105 
ex™_w™h_”rÜ
;

2106 } ià(
sdev
->
p2p_¡©e
 =ğ
P2P_IDLE_VIF_ACTIVE
) {

2108 ià(
ndev_vif
->
unsync
.
›s_chªged
) {

2109 
u16
 
pu½o£
 = 
FAPI_PURPOSE_PROBE_RESPONSE
;

2111 ià(
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
pu½o£
, 
ndev_vif
->
unsync
.
´obe_r¥_›s
,‚dev_vif->unsync.
´obe_r¥_›s_Ën
) != 0) {

2112 
	`SLSI_NET_ERR
(
dev
, "Probe Rsp IEs setting failed\n");

2113 
ex™_w™h_vif
;

2115 
ndev_vif
->
unsync
.
›s_chªged
 = 
çl£
;

2118 ià(
ndev_vif
->
driv”_chªÃl
 !ğ
chª
->
hw_v®ue
) {

2119 ià(
	`¦si_mlme_£t_chªÃl
(
sdev
, 
dev
, 
chª
, 
SLSI_FW_CHANNEL_DURATION_UNSPECIFIED
, 0, 0) != 0) {

2120 
	`SLSI_NET_ERR
(
dev
, "Channel setting failed\n");

2121 
ex™_w™h_vif
;

2123 
ndev_vif
->
chª
 = chan;

2124 
ndev_vif
->
driv”_chªÃl
 = 
chª
->
hw_v®ue
;

2128 
	`SLSI_NET_ERR
(
dev
, "Driv” iÀšcÜ»ù P2P s‹ (%s)", 
	`¦si_p2p_¡©e_‹xt
(
sdev
->
p2p_¡©e
));

2129 
ex™_w™h_”rÜ
;

2132 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_LISTENING
);

2134 
ex™_w™h_roc
:

2140 
	`queue_d–ayed_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
unsync
.
roc_expœy_wÜk
,

2141 
	`m£cs_to_jiff›s
(
du¿tiÚ
 - 
SLSI_P2P_ROC_EXTRA_MSEC
));

2143 
	`¦si_assign_cook›_id
(
cook›
, &
ndev_vif
->
unsync
.
roc_cook›
);

2144 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "Cook› = 0x%Îx\n", *
cook›
);

2146 
	`cfg80211_»ady_Ú_chªÃl
(
wdev
, *
cook›
, 
chª
, 
du¿tiÚ
, 
GFP_KERNEL
);

2147 
ex™
;

2149 
ex™_w™h_vif
:

2150 
	`¦si_p2p_vif_d—ùiv©e
(
sdev
, 
dev
, 
Œue
);

2151 
ex™_w™h_”rÜ
:

2152 
r
 = -
EINVAL
;

2153 
ex™
:

2154 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2155 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

2156  
r
;

2157 
	}
}

2159 
	$¦si_ÿnûl_»maš_Ú_chªÃl
(
why
 *wiphy,

2160 
wœ–ess_dev
 *
wdev
,

2161 
u64
 
cook›
)

2163 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

2164 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2165 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2166 
r
 = 0;

2168 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2170 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "Cookie = 0x%llx, vif_type = %d, vif_index = %d, sdev->p2p_state = %s,"

2171 "ndev_vif->­.p2p_gc_keys_£ˆğ%d,‚dev_vif->unsync.roc_cook› = 0x%Îx\n", 
cook›
,

2172 
ndev_vif
->
vif_ty³
,‚dev_vif->
iâum
, 
	`¦si_p2p_¡©e_‹xt
(
sdev
->
p2p_¡©e
),

2173 
ndev_vif
->
­
.
p2p_gc_keys_£t
,‚dev_vif->
unsync
.
roc_cook›
);

2175 ià(!
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
)) {

2176 
	`SLSI_NET_ERR
(
dev
, "Invalid vifype\n");

2177 
r
 = -
EINVAL
;

2178 
ex™
;

2181 ià(!((
sdev
->
p2p_¡©e
 =ğ
P2P_LISTENING
è|| (sdev->p2p_¡©=ğ
P2P_ACTION_FRAME_TX_RX
))) {

2182 
ex™
;

2185 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_ACTION_FRAME_TX_RX
 && 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 !ğ
SLSI_PA_INVALID
) {

2187 
	`SLSI_INFO
(
sdev
, "AùiÚ f¿m(%sèwa nÙ„eûived\n", 
	`¦si_·_subty³_‹xt
(
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
));

2188 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

2191 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
);

2192 
	`cfg80211_»maš_Ú_chªÃl_expœed
(&
ndev_vif
->
wdev
,‚dev_vif->
unsync
.
roc_cook›
,‚dev_vif->
chª
, 
GFP_KERNEL
);

2194 ià(!
ndev_vif
->
drv_š_p2p_´oûdu»
) {

2195 ià(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
))

2196 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
);

2197 
	`queue_d–ayed_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
,

2198 
	`m£cs_to_jiff›s
(
SLSI_P2P_UNSET_CHANNEL_EXTRA_MSEC
));

2201 
	`¦si_p2p_queue_unsync_vif_d–_wÜk
(
ndev_vif
, 
SLSI_P2P_UNSYNC_VIF_EXTRA_MSEC
);

2202 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_VIF_ACTIVE
);

2204 
ex™
:

2205 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2206  
r
;

2207 
	}
}

2209 
	$¦si_chªge_bss
(
why
 *why, 
Ãt_deviû
 *
dev
,

2210 
bss_·¿m‘”s
 *
·¿ms
)

2212 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2213 
r
 = 0;

2215 
	`SLSI_UNUSED_PARAMETER
(
·¿ms
);

2216 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

2218  
r
;

2219 
	}
}

2221 
	$¦si_­_¡¬t_obss_sÿn
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
Ãtdev_vif
 *
ndev_vif
)

2223 
cfg80211_ssid
 
ssids
;

2224 
›“80211_chªÃl
 *
chªÃl
;

2225 
n_ssids
 = 1, 
n_chªÃls
 = 1, 
i
;

2227 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "chªÃÈ%u\n", 
ndev_vif
->
chª
->
hw_v®ue
);

2229 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

2231 
ssids
.
ssid_Ën
 = 0;

2232 
i
 = 0; i < 
IEEE80211_MAX_SSID_LEN
; i++)

2233 
ssids
.
ssid
[
i
] = 0x00;

2235 
chªÃl
 = 
	`›“80211_g‘_chªÃl
(
sdev
->
why
, 
ndev_vif
->
chª
->
ûÁ”_äeq
);

2237 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
 = 
Œue
;

2238 ()
	`¦si_mlme_add_sÿn
(
sdev
,

2239 
dev
,

2240 
FAPI_SCANTYPE_OBSS_SCAN
,

2241 
FAPI_REPORTMODE_REAL_TIME
,

2242 
n_ssids
,

2243 &
ssids
,

2244 
n_chªÃls
,

2245 &
chªÃl
,

2246 
NULL
,

2247 
NULL
,

2249 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
 );

2251 
	`¦si_­_obss_sÿn_dÚe_šd
(
dev
, 
ndev_vif
);

2252 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
 = 
çl£
;

2253 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

2254 
	}
}

2256 
	$¦si_­_¡¬t_v®id©e
(
Ãt_deviû
 *
dev
, 
¦si_dev
 *
sdev
, 
cfg80211_­_£‰šgs
 *
£‰šgs
)

2258 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2260 ià(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
)) {

2261 
	`SLSI_NET_ERR
(
dev
, "AP start„equested on incorrect vif\n");

2262 
ex™_w™h_”rÜ
;

2265 ià(!
£‰šgs
->
ssid_Ën
 || !£‰šgs->
ssid
) {

2266 
	`SLSI_NET_ERR
(
dev
, "SSID‚ot…rovided\n");

2267 
ex™_w™h_”rÜ
;

2270 ià(!
£‰šgs
->
b—cÚ
.
h—d_Ën
 || !£‰šgs->b—cÚ.
h—d
) {

2271 
	`SLSI_NET_ERR
(
dev
, "Beacon‚ot…rovided\n");

2272 
ex™_w™h_”rÜ
;

2275 ià(!
£‰šgs
->
b—cÚ_š‹rv®
) {

2276 
	`SLSI_NET_ERR
(
dev
, "Beacon Interval‚ot…rovided\n");

2277 
ex™_w™h_”rÜ
;

2280 
ndev_vif
->
chªdef
 = &
£‰šgs
->chandef;

2281 
ndev_vif
->
chª
 =‚dev_vif->
chªdef
->chan;

2282 
ndev_vif
->
chªdef_§ved
 = 
£‰šgs
->
chªdef
;

2284 ià(
	`WARN_ON
(!
ndev_vif
->
chª
))

2285 
ex™_w™h_”rÜ
;

2287 ià(
	`WARN_ON
(
ndev_vif
->
aùiv©ed
))

2288 
ex™_w™h_”rÜ
;

2290 ià(
	`WARN_ON
((
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_AP
è&& (ndev_vif->iáy³ !ğ
NL80211_IFTYPE_P2P_GO
)))

2291 
ex™_w™h_”rÜ
;

2293 ià((
ndev_vif
->
chª
->
hw_v®ue
 <ğ14è&& (!
sdev
->
fw_SoáAp_2g_40mhz_’abËd
) &&

2294 (
ndev_vif
->
chªdef
->
width
 =ğ
NL80211_CHAN_WIDTH_40
)) {

2295 
	`SLSI_NET_ERR
(
dev
, "CÚfigu¿tiÚƒ¼Ü: 40 MHz oÀ2.4 GHz i nÙ suµÜ‹d. ChªÃl_no: %d ChªÃl_width: %d\n", 
ndev_vif
->
chª
->
hw_v®ue
, 
	`¦si_g‘_chªn_šfo
(
sdev
,‚dev_vif->
chªdef
));

2296 
ex™_w™h_”rÜ
;

2301 
ex™_w™h_”rÜ
:

2302  -
EINVAL
;

2303 
	}
}

2305 
	$¦si_g‘_max_bw_mhz
(
¦si_dev
 *
sdev
, 
u16
 
´im_chª_cf
)

2307 
i
;

2308 
›“80211_»gdomaš
 *
»gd
 = 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
;

2310 ià(!
»gd
) {

2311 
	`SLSI_WARN
(
sdev
, "NO„egdomain info\n");

2315 
i
 = 0; i < 
»gd
->
n_»g_ruËs
; i++) {

2316 ià((
»gd
->
»g_ruËs
[
i
].
äeq_¿nge
.
¡¬t_äeq_khz
 / 1000 <ğ
´im_chª_cf
 - 10) &&

2317 (
»gd
->
»g_ruËs
[
i
].
äeq_¿nge
.
’d_äeq_khz
 / 1000 >ğ
´im_chª_cf
 + 10))

2318  
»gd
->
»g_ruËs
[
i
].
äeq_¿nge
.
max_bªdwidth_khz
 / 1000;

2321 
	`SLSI_WARN
(
sdev
, "F»q(%dènÙ found iÀ»gdomaš\n", 
´im_chª_cf
);

2323 
	}
}

2325 
	$¦si_cÚfigu»_couÁry_code
(
¦si_dev
 *
sdev
, 
cfg80211_­_£‰šgs
 *
£‰šgs
)

2327 cÚ¡ 
u8
 *
couÁry_›
 = 
NULL
;

2328 
®pha2
[
SLSI_COUNTRY_CODE_LEN
];

2331 
couÁry_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_COUNTRY
, 
£‰šgs
->
b—cÚ
.

, s‘tšgs->b—cÚ.
_Ën
);

2332 ià(
couÁry_›
) {

2333 
couÁry_›
 += 2;

2334 
	`memıy
(
®pha2
, 
couÁry_›
, 
SLSI_COUNTRY_CODE_LEN
);

2335 ià(
	`memcmp
(
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->
®pha2
,‡Íha2, 
SLSI_COUNTRY_CODE_LEN
 - 1) != 0) {

2336 ià(
	`¦si_£t_couÁry_upd©e_»gd
(
sdev
, 
®pha2
, 
SLSI_COUNTRY_CODE_LEN
) != 0)

2337  -
EINVAL
;

2341 
	}
}

2343 
	$¦si_­_¡¬t_g‘_šdoÜ_chª_5g
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
cfg80211_­_£‰šgs
 *
£‰šgs
, 
sk_šdoÜ_check_fÜ_wifi_sh¬šg
, *
šdoÜ_chªÃl
)

2345 
why
 *why = 
sdev
->wiphy;

2346 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2347 
›“80211_chªÃl
 *
chªÃl
 = 
NULL
;

2348 
u32
 
chª_æags
;

2349 
u16
 
ûÁ”_äeq
;

2351 ià(!
sk_šdoÜ_check_fÜ_wifi_sh¬šg
 && 
sdev
->
bªd_5g_suµÜ‹d
 &&

2352 ((
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
 / 1000) == 5)) {

2353 
chªÃl
 = 
	`›“80211_g‘_chªÃl
(
sdev
->
why
, 
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
);

2354 ià(!
chªÃl
) {

2355 
	`SLSI_ERR
(
sdev
, "Invalid frequency %d usedo start AP. Channel‚ot found\n",

2356 
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
);

2357  -
EINVAL
;

2359 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_P2P_GO
 && (
chªÃl
->
æags
 & 
IEEE80211_CHAN_INDOOR_ONLY
)) {

2360 
i
;

2362 
chª_æags
 = (
IEEE80211_CHAN_INDOOR_ONLY
 | 
IEEE80211_CHAN_RADAR
 |

2363 
IEEE80211_CHAN_DISABLED
 | 
IEEE80211_CHAN_NO_IR
);

2365 
i
 = 0; i < 
why
->
bªds
[
NL80211_BAND_5GHZ
]->
n_chªÃls
; i++) {

2366 ià(!(
why
->
bªds
[
NL80211_BAND_5GHZ
]->
chªÃls
[
i
].
æags
 & 
chª_æags
)) {

2367 
ûÁ”_äeq
 = 
why
->
bªds
[
NL80211_BAND_5GHZ
]->
chªÃls
[
i
].center_freq;

2368 
£‰šgs
->
chªdef
.
chª
 = 
	`›“80211_g‘_chªÃl
(
why
, 
ûÁ”_äeq
);

2369 ià(!
£‰šgs
->
chªdef
.
chª
) {

2370 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "Inv®id chª fÜ f»qu’cy %d\n", 
ûÁ”_äeq
);

2373 
£‰šgs
->
chªdef
.
ûÁ”_äeq1
 = 
ûÁ”_äeq
;

2374 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "ap valid frequency:%d,chan_flags:%x\n",

2375 
ûÁ”_äeq
,

2376 
why
->
bªds
[
NL80211_BAND_5GHZ
]->
chªÃls
[
i
].
æags
);

2377 *
šdoÜ_chªÃl
 = 1;

2381 ià(*
šdoÜ_chªÃl
 == 0) {

2382 
	`SLSI_ERR
(
sdev
, "No valid channel foundo starthe AP");

2383  -
EINVAL
;

2388 
	}
}

2390 
	$¦si_modify_ht_ÿ·_›s
(
Ãt_deviû
 *
dev
, 
¦si_dev
 *
sdev
, 
cfg80211_­_£‰šgs
 *
£‰šgs
)

2392 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2394 ià(
ndev_vif
->
chªdef
->
width
 <ğ
NL80211_CHAN_WIDTH_20
) {

2396 ià(
	`cfg80211_fšd_›
(
WLAN_EID_HT_CAPABILITY
, 
£‰šgs
->
b—cÚ
.

, s‘tšgs->b—cÚ.
_Ën
)) {

2397 
u8
 
’fÜû_ht_ÿp1
 = 
sdev
->
fw_ht_ÿp
[0] & (
IEEE80211_HT_CAP_LDPC_CODING
 |

2398 
IEEE80211_HT_CAP_SGI_20
);

2399 
u8
 
’fÜû_ht_ÿp2
 = 
sdev
->
fw_ht_ÿp
[1] & (
IEEE80211_HT_CAP_RX_STBC
 >> 8);

2401 
	`¦si_modify_›s
(
dev
, 
WLAN_EID_HT_CAPABILITY
, (
u8
 *)
£‰šgs
->
b—cÚ
.

,

2402 
£‰šgs
->
b—cÚ
.
_Ën
, 2, 
’fÜû_ht_ÿp1
);

2403 
	`¦si_modify_›s
(
dev
, 
WLAN_EID_HT_CAPABILITY
, (
u8
 *)
£‰šgs
->
b—cÚ
.

,

2404 
£‰šgs
->
b—cÚ
.
_Ën
, 3, 
’fÜû_ht_ÿp2
);

2406 } ià(
	`cfg80211_chªdef_v®id
(
ndev_vif
->
chªdef
)) {

2407 
u8
 *
ht_İ”©iÚ_›
;

2408 
u8
 
£c_chª_off£t
 = 0;

2409 
u8
 
ch
;

2410 
u8
 
bw_40_mšus_chªÃls
[] = { 40, 48, 153, 161, 5, 6, 7, 8, 9, 10, 11 };

2412 
ht_İ”©iÚ_›
 = (
u8
 *)
	`cfg80211_fšd_›
(
WLAN_EID_HT_OPERATION
, 
£‰šgs
->
b—cÚ
.

,

2413 
£‰šgs
->
b—cÚ
.
_Ën
);

2414 ià(!
ht_İ”©iÚ_›
) {

2415 
	`SLSI_NET_ERR
(
dev
, "HT Operation IE is‚ot…assed by wpa_supplicant");

2416  -
EINVAL
;

2419 
£c_chª_off£t
 = 
IEEE80211_HT_PARAM_CHA_SEC_ABOVE
;

2420 
ch
 = 0; ch < 
	`ARRAY_SIZE
(
bw_40_mšus_chªÃls
); ch++)

2421 ià(
bw_40_mšus_chªÃls
[
ch
] =ğ
ndev_vif
->
chªdef
->
chª
->
hw_v®ue
) {

2422 
£c_chª_off£t
 = 
IEEE80211_HT_PARAM_CHA_SEC_BELOW
;

2427 
ht_İ”©iÚ_›
 += 3;

2428 *(
ht_İ”©iÚ_›
è|ğ
£c_chª_off£t
;

2429 *(
ht_İ”©iÚ_›
è|ğ
IEEE80211_HT_PARAM_CHAN_WIDTH_ANY
;

2434 ià(
	`cfg80211_fšd_›
(
WLAN_EID_HT_CAPABILITY
, 
£‰šgs
->
b—cÚ
.

,

2435 
£‰šgs
->
b—cÚ
.
_Ën
)) {

2436 
u8
 
’fÜû_ht_ÿp1
 = 
sdev
->
fw_ht_ÿp
[0] & (
IEEE80211_HT_CAP_SUP_WIDTH_20_40
 |

2437 
IEEE80211_HT_CAP_SGI_20
 |

2438 
IEEE80211_HT_CAP_SGI_40
 |

2439 
IEEE80211_HT_CAP_LDPC_CODING
);

2440 
u8
 
’fÜû_ht_ÿp2
 = 
sdev
->
fw_ht_ÿp
[1] & (
IEEE80211_HT_CAP_RX_STBC
 >> 8);

2442 
	`¦si_modify_›s
(
dev
, 
WLAN_EID_HT_CAPABILITY
, (
u8
 *)
£‰šgs
->
b—cÚ
.

,

2443 
£‰šgs
->
b—cÚ
.
_Ën
, 2, 
’fÜû_ht_ÿp1
);

2444 
	`¦si_modify_›s
(
dev
, 
WLAN_EID_HT_CAPABILITY
, (
u8
 *)
£‰šgs
->
b—cÚ
.

,

2445 
£‰šgs
->
b—cÚ
.
_Ën
, 3, 
’fÜû_ht_ÿp2
);

2449 
	}
}

2451 
	$¦si_£t_­_mode
(
Ãtdev_vif
 *
ndev_vif
, 
cfg80211_­_£‰šgs
 *
£‰šgs
, 
boŞ
 
­³nd_vht_›s
)

2453 ià(
­³nd_vht_›s
) {

2454 
ndev_vif
->
­
.
mode
 = 
SLSI_80211_MODE_11AC
;

2455 } ià(
	`cfg80211_fšd_›
(
WLAN_EID_HT_CAPABILITY
, 
£‰šgs
->
b—cÚ
.

, s‘tšgs->b—cÚ.
_Ën
) &&

2456 
	`cfg80211_fšd_›
(
WLAN_EID_HT_OPERATION
, 
£‰šgs
->
b—cÚ
.

, s‘tšgs->b—cÚ.
_Ën
)) {

2457 
ndev_vif
->
­
.
mode
 = 
SLSI_80211_MODE_11N
;

2459 cÚ¡ 
u8
 *
›
;

2461 
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SUPP_RATES
, 
£‰šgs
->
b—cÚ
.

, s‘tšgs->b—cÚ.
_Ën
);

2462 ià(
›
)

2463 
ndev_vif
->
­
.
mode
 = 
	`¦si_g‘_suµÜ‹d_mode
(
›
);

2465 
	}
}

2467 
	$¦si_¡Üe_£‰šgs_fÜ_»cov”y
(
cfg80211_­_£‰šgs
 *
£‰šgs
, 
Ãtdev_vif
 *
ndev_vif
)

2469 
ndev_vif
->
backup_£‰šgs
 = *
£‰šgs
;

2470 ià(&
ndev_vif
->
backup_£‰šgs
 =ğ
£‰šgs
)

2472 
ndev_vif
->
backup_£‰šgs
.
chªdef
.
chª
 =

2473 (
›“80211_chªÃl
 *)
	`¦si_mem_dup
((
u8
 *)
£‰šgs
->
chªdef
.
chª
, (ieee80211_channel));

2474 
ndev_vif
->
backup_£‰šgs
.
b—cÚ
.
h—d
 = 
	`¦si_mem_dup
((
u8
 *)
£‰šgs
->b—cÚ.h—d, s‘tšgs->b—cÚ.
h—d_Ën
);

2475 
ndev_vif
->
backup_£‰šgs
.
b—cÚ
.

 = 
	`¦si_mem_dup
((
u8
 *)
£‰šgs
->b—cÚ., s‘tšgs->b—cÚ.
_Ën
);

2476 
ndev_vif
->
backup_£‰šgs
.
b—cÚ
.
b—cÚ_›s
 = 
	`¦si_mem_dup
((
u8
 *)
£‰šgs
->beacon.beacon_ies,

2477 
£‰šgs
->
b—cÚ
.
b—cÚ_›s_Ën
);

2478 
ndev_vif
->
backup_£‰šgs
.
b—cÚ
.
´ob”e¥_›s
 = 
	`¦si_mem_dup
((
u8
 *)
£‰šgs
->beacon.proberesp_ies,

2479 
£‰šgs
->
b—cÚ
.
´ob”e¥_›s_Ën
);

2480 
ndev_vif
->
backup_£‰šgs
.
b—cÚ
.
assoüe¥_›s
 = 
	`¦si_mem_dup
((
u8
 *)
£‰šgs
->beacon.assocresp_ies,

2481 
£‰šgs
->
b—cÚ
.
assoüe¥_›s_Ën
);

2482 
ndev_vif
->
backup_£‰šgs
.
b—cÚ
.
´obe_»¥
 = 
	`¦si_mem_dup
((
u8
 *)
£‰šgs
->beacon.probe_resp,

2483 
£‰šgs
->
b—cÚ
.
´obe_»¥_Ën
);

2484 
ndev_vif
->
backup_£‰šgs
.
ssid
 = 
	`¦si_mem_dup
((
u8
 *)
£‰šgs
->ssid, s‘tšgs->
ssid_Ën
);

2485 ià(
£‰šgs
->
ht_ÿp
) {

2486 
ndev_vif
->
backup_£‰šgs
.
ht_ÿp
 =

2487 (
›“80211_ht_ÿp
 *)
	`¦si_mem_dup
((
u8
 *)
£‰šgs
->
ht_ÿp
, (ieee80211_ht_cap));

2489 ià(
£‰šgs
->
vht_ÿp
) {

2490 
ndev_vif
->
backup_£‰šgs
.
vht_ÿp
 =

2491 (
›“80211_vht_ÿp
 *)
	`¦si_mem_dup
((
u8
 *)
£‰šgs
->
vht_ÿp
, (ieee80211_vht_cap));

2493 
	}
}

2495 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


2496 
boŞ
 
	$¦si_­_chªdef_vht_ht
(
Ãt_deviû
 *
dev
, 
¦si_dev
 *
sdev
, 
wifi_sh¬šg_chªÃl_sw™ched
)

2498 
boŞ
 
	$¦si_­_chªdef_vht_ht
(
Ãt_deviû
 *
dev
, 
¦si_dev
 *
sdev
)

2501 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2502 
boŞ
 
­³nd_vht_›s
 = 
çl£
;

2504 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "ChªÃl: %d, Maximum bªdwidth: %d\n", 
ndev_vif
->
chªdef
->
chª
->
hw_v®ue
,

2505 
	`¦si_g‘_max_bw_mhz
(
sdev
, 
ndev_vif
->
chªdef
->
chª
->
ûÁ”_äeq
));

2507 ià(
ndev_vif
->
chªdef
->
chª
->
hw_v®ue
 >= 36 &&‚dev_vif->chandef->chan->hw_value < 165 &&

2508 
sdev
->
fw_vht_’abËd
 && sdev->
®low_sw™ch_80_mhz
 &&

2509 (
	`¦si_g‘_max_bw_mhz
(
sdev
, 
ndev_vif
->
chªdef
->
chª
->
ûÁ”_äeq
) >= 80)) {

2510 
u16
 
İ”_chª
 = 
ndev_vif
->
chªdef
->
chª
->
hw_v®ue
;

2512 
­³nd_vht_›s
 = 
Œue
;

2513 
ndev_vif
->
chªdef
->
width
 = 
NL80211_CHAN_WIDTH_80
;

2515 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "5 GHz- Include VHT\n");

2516 ià(
İ”_chª
 >= 36 && oper_chan <= 48)

2517 
ndev_vif
->
chªdef
->
ûÁ”_äeq1
 = 
	`›“80211_chªÃl_to_äequ’cy
(42, 
NL80211_BAND_5GHZ
);

2518 ià(
İ”_chª
 >= 149 && oper_chan <= 161)

2519 
ndev_vif
->
chªdef
->
ûÁ”_äeq1
 = 
	`›“80211_chªÃl_to_äequ’cy
(155, 
NL80211_BAND_5GHZ
);

2520 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


2522 ià(
wifi_sh¬šg_chªÃl_sw™ched
 == 1) {

2523 ià(
İ”_chª
 >= 52 && oper_chan <= 64)

2524 
ndev_vif
->
chªdef
->
ûÁ”_äeq1
 = 
	`›“80211_chªÃl_to_äequ’cy
(58,

2525 
NL80211_BAND_5GHZ
);

2526 ià(
İ”_chª
 >= 100 && oper_chan <= 112)

2527 
ndev_vif
->
chªdef
->
ûÁ”_äeq1
 = 
	`›“80211_chªÃl_to_äequ’cy
(106,

2528 
NL80211_BAND_5GHZ
);

2529 ià(
İ”_chª
 >= 116 && oper_chan <= 128)

2530 
ndev_vif
->
chªdef
->
ûÁ”_äeq1
 = 
	`›“80211_chªÃl_to_äequ’cy
(122,

2531 
NL80211_BAND_5GHZ
);

2532 ià(
İ”_chª
 >= 132 && oper_chan <= 144)

2533 
ndev_vif
->
chªdef
->
ûÁ”_äeq1
 = 
	`›“80211_chªÃl_to_äequ’cy
(138,

2534 
NL80211_BAND_5GHZ
);

2537 } ià(
sdev
->
fw_ht_’abËd
 && sdev->
®low_sw™ch_40_mhz
 &&

2538 
	`¦si_g‘_max_bw_mhz
(
sdev
, 
ndev_vif
->
chªdef
->
chª
->
ûÁ”_äeq
) >= 40 &&

2539 ((
ndev_vif
->
chªdef
->
chª
->
hw_v®ue
 < 165 &&‚dev_vif->chandef->chan->hw_value >= 36))) {

2541 
u16
 
İ”_chª
 = 
ndev_vif
->
chªdef
->
chª
->
hw_v®ue
;

2542 
u8
 
bw_40_mšus_chªÃls
[] = { 40, 48, 153, 161, 5, 6, 7, 8, 9, 10, 11 };

2543 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


2544 
u8
 
bw_40_mšus_dfs_chªÃls
[] = { 144, 136, 128, 120, 112, 104, 64, 56 };

2546 
u8
 
ch
;

2548 
ndev_vif
->
chªdef
->
width
 = 
NL80211_CHAN_WIDTH_40
;

2549 
ndev_vif
->
chªdef
->
ûÁ”_äeq1
 =‚dev_vif->chªdef->
chª
->
ûÁ”_äeq
 + 10;

2550 
ch
 = 0; ch < 
	`ARRAY_SIZE
(
bw_40_mšus_chªÃls
); ch++)

2551 ià(
İ”_chª
 =ğ
bw_40_mšus_chªÃls
[
ch
]) {

2552 
ndev_vif
->
chªdef
->
ûÁ”_äeq1
 =‚dev_vif->chªdef->
chª
->
ûÁ”_äeq
 - 10;

2556 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


2557 ià(
wifi_sh¬šg_chªÃl_sw™ched
 == 1) {

2558 
ch
 = 0; ch < 
	`ARRAY_SIZE
(
bw_40_mšus_dfs_chªÃls
); ch++)

2559 ià(
İ”_chª
 =ğ
bw_40_mšus_dfs_chªÃls
[
ch
]) {

2560 
ndev_vif
->
chªdef
->
ûÁ”_äeq1
 =‚dev_vif->chªdef->
chª
->
ûÁ”_äeq
 - 10;

2566  
­³nd_vht_›s
;

2567 
	}
}

2569 
	$¦si_¡İ_p2p_group_içû_Ú_­_¡¬t
(
¦si_dev
 *
sdev
)

2571 
Ãt_deviû
 *
p2p_dev
 = 
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
];

2572 
Ãtdev_vif
 *
ndev_p2p_vif
;

2574 
	`SLSI_NET_INFO
(
p2p_dev
, "P2P group interface is‚ot„emoved before starting AP\n");

2575 ià(!
p2p_dev
)

2577 
ndev_p2p_vif
 = 
	`Ãtdev_´iv
(
p2p_dev
);

2578 
	`SLSI_MUTEX_LOCK
(
ndev_p2p_vif
->
vif_mu‹x
);

2579 
	`¦si_vif_ş—nup
(
sdev
, 
p2p_dev
, 
Œue
, 0);

2580 
	`SLSI_MUTEX_UNLOCK
(
ndev_p2p_vif
->
vif_mu‹x
);

2581 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2582 
	`rcu_assign_poš‹r
(
sdev
->
Ãtdev_p2p
, sdev->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
]);

2583 
	`rcu_assign_poš‹r
(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
], sdev->
Ãtdev_­
);

2584 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2585 
	}
}

2587 
	$¦si_¡¬t_­
(
why
 *why, 
Ãt_deviû
 *
dev
,

2588 
cfg80211_­_£‰šgs
 *
£‰šgs
)

2590 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2591 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2592 
Ãt_deviû
 *
wÏn_dev
;

2593 
u8
 
deviû_add»ss
[
ETH_ALEN
] = { 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF };

2594 
r
 = 0;

2595 cÚ¡ 
u8
 *
w·_›_pos
 = 
NULL
;

2596 
w·_›_Ën
 = 0;

2597 cÚ¡ 
u8
 *
wmm_›_pos
 = 
NULL
;

2598 
wmm_›_Ën
 = 0;

2599 
boŞ
 
­³nd_vht_›s
 = 
çl£
;

2600 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


2601 
wifi_sh¬šg_chªÃl_sw™ched
 = 0;

2602 
Ãtdev_vif
 *
ndev_¡a_vif
;

2603 
šv®id_chªÃl
 = 0;

2605 
sk_šdoÜ_check_fÜ_wifi_sh¬šg
 = 0;

2606 
u8
 *
ds_·¿ms_›
 = 
NULL
;

2607 
›“80211_mgmt
 *
mgmt
;

2608 
u16
 
b—cÚ_›_h—d_Ën
;

2609 
u8
 *
ht_İ”©iÚ_›
 = 
NULL
;

2610 
šdoÜ_chªÃl
 = 0;

2612 
	`SLSI_MUTEX_LOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

2613 ià(
sdev
->
deviû_¡©e
 !ğ
SLSI_DEVICE_STATE_STARTED
) {

2614 
	`SLSI_WARN
(
sdev
, "deviû‚Ù s¹ed y‘ (deviû_¡©e:%d)\n", sdev->
deviû_¡©e
);

2615 
r
 = -
EINVAL
;

2616 
ex™_w™h_¡¬t_¡İ_mu‹x
;

2619 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_AP
 && 
sdev
->
Ãtdev_­
 !ğsdev->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
])

2620 
	`¦si_¡İ_p2p_group_içû_Ú_­_¡¬t
(
sdev
);

2622 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2624 
wÏn_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

2625 ià(
wÏn_dev
)

2626 
	`¦si_abÜt_hw_sÿn
(
sdev
, 
wÏn_dev
);

2628 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "AP f»qu’cy„eûived: %d\n", 
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
);

2629 
mgmt
 = (
›“80211_mgmt
 *)
£‰šgs
->
b—cÚ
.
h—d
;

2630 
b—cÚ_›_h—d_Ën
 = 
£‰šgs
->
b—cÚ
.
h—d_Ën
 - ((
u8
 *)
mgmt
->
u
.b—cÚ.
v¬ŸbË
 - (u8 *)mgmt);

2631 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


2632 
ndev_¡a_vif
 = 
	`Ãtdev_´iv
(
wÏn_dev
);

2633 ià(
	`SLSI_IS_VIF_INDEX_MHS
(
sdev
, 
ndev_vif
)) {

2634 ià(
ndev_¡a_vif
) {

2635 
	`SLSI_MUTEX_LOCK
(
ndev_¡a_vif
->
vif_mu‹x
);

2636 ià((
ndev_¡a_vif
->
aùiv©ed
è&& (ndev_¡a_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) &&

2637 (
ndev_¡a_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTING
 ||

2638 
ndev_¡a_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
)) {

2639 #ifdeà
CONFIG_SCSC_WLAN_SINGLE_ANTENNA


2640 
šv®id_chªÃl
 = 
	`¦si_g‘_mhs_ws_chª_vsdb
(
why
, 
dev
, 
£‰šgs
, 
sdev
,

2641 &
wifi_sh¬šg_chªÃl_sw™ched
);

2643 
šv®id_chªÃl
 = 
	`¦si_g‘_mhs_ws_chª_rsdb
(
why
, 
dev
, 
£‰šgs
, 
sdev
,

2644 &
wifi_sh¬šg_chªÃl_sw™ched
);

2646 
sk_šdoÜ_check_fÜ_wifi_sh¬šg
 = 1;

2647 ià(
šv®id_chªÃl
) {

2648 
	`SLSI_NET_ERR
(
dev
, "Rejecting AP start„eq‡t host (invalid channel)\n");

2649 
	`SLSI_MUTEX_UNLOCK
(
ndev_¡a_vif
->
vif_mu‹x
);

2650 
r
 = -
EINVAL
;

2651 
ex™_w™h_vif_mu‹x
;

2654 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Station frequency: %d, SoftAP frequency: %d\n",

2655 
ndev_¡a_vif
->
chª
->
ûÁ”_äeq
, 
£‰šgs
->
chªdef
.chan->center_freq);

2657 
	`SLSI_MUTEX_UNLOCK
(
ndev_¡a_vif
->
vif_mu‹x
);

2662 
	`mem£t
(&
ndev_vif
->
­
, 0, (ndev_vif->ap));

2665 
r
 = 
	`¦si_cÚfigu»_couÁry_code
(
sdev
, 
£‰šgs
);

2666 ià(
r
 != 0)

2667 
ex™_w™h_vif_mu‹x
;

2669 
r
 = 
	`¦si_­_¡¬t_g‘_šdoÜ_chª_5g
(
sdev
, 
dev
, 
£‰šgs
, 
sk_šdoÜ_check_fÜ_wifi_sh¬šg
, &
šdoÜ_chªÃl
);

2670 ià(
r
 != 0)

2671 
ex™_w™h_vif_mu‹x
;

2673 
r
 = 
	`¦si_­_¡¬t_v®id©e
(
dev
, 
sdev
, 
£‰šgs
);

2674 ià(
r
 != 0)

2675 
ex™_w™h_vif_mu‹x
;

2677 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_GO
) {

2678 
Ãt_deviû
 *
p2p_dev
;

2680 
	`¦si_p2p_group_¡¬t_»move_unsync_vif
(
sdev
);

2681 
p2p_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2P
);

2682 
	`SLSI_ETHER_COPY
(
deviû_add»ss
, 
p2p_dev
->
dev_addr
);

2683 ià(
k“p_®ive_³riod
 !ğ
SLSI_P2PGO_KEEP_ALIVE_PERIOD_SEC
)

2684 ià(
	`¦si_£t_ušt_mib
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_MLMEGO_KEEP_ALIVE_TIMEOUT
,

2685 
k“p_®ive_³riod
) != 0) {

2686 
	`SLSI_NET_ERR
(
dev
, "P2PGO Keep Alive MIB set failed");

2687 
r
 = -
EINVAL
;

2688 
ex™_w™h_vif_mu‹x
;

2692 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


2693 
­³nd_vht_›s
 = 
	`¦si_­_chªdef_vht_ht
(
dev
, 
sdev
, 
wifi_sh¬šg_chªÃl_sw™ched
);

2694 ià(
	`¦si_check_chªÃliz©iÚ
(
sdev
, 
ndev_vif
->
chªdef
, 
wifi_sh¬šg_chªÃl_sw™ched
) != 0) {

2696 
­³nd_vht_›s
 = 
	`¦si_­_chªdef_vht_ht
(
dev
, 
sdev
);

2697 ià(
	`¦si_check_chªÃliz©iÚ
(
sdev
, 
ndev_vif
->
chªdef
, 0) != 0) {

2699 
r
 = -
EINVAL
;

2700 
ex™_w™h_vif_mu‹x
;

2703 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_AP
) {

2705 ià(
ndev_vif
->
chªdef
->
width
 =ğ
NL80211_CHAN_WIDTH_20
)

2706 
	`¦si_­_¡¬t_obss_sÿn
(
sdev
, 
dev
, 
ndev_vif
);

2709 
r
 = 
	`¦si_modify_ht_ÿ·_›s
(
dev
, 
sdev
, 
£‰šgs
);

2710 ià(
r
 != 0)

2711 
ex™_w™h_vif_mu‹x
;

2713 ià(
šdoÜ_chªÃl
 == 1

2714 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


2715 || (
wifi_sh¬šg_chªÃl_sw™ched
 == 1)

2718 
	`¦si_modify_›s_Ú_chªÃl_sw™ch
(
dev
, 
£‰šgs
, 
ds_·¿ms_›
, 
ht_İ”©iÚ_›
, 
mgmt
, 
b—cÚ_›_h—d_Ën
);

2720 
ndev_vif
->
vif_ty³
 = 
FAPI_VIFTYPE_AP
;

2722 ià(
	`¦si_mlme_add_vif
(
sdev
, 
dev
, dev->
dev_addr
, 
deviû_add»ss
) != 0) {

2723 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_add_vif failed\n");

2724 
r
 = -
EINVAL
;

2725 
ex™_w™h_vif_mu‹x
;

2728 ià(
	`¦si_vif_aùiv©ed
(
sdev
, 
dev
) != 0) {

2729 
	`SLSI_NET_ERR
(
dev
, "slsi_vif_activated failed\n");

2730 
ex™_w™h_vif
;

2736 
w·_›_pos
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPA
, 
£‰šgs
->
b—cÚ
.

, s‘tšgs->b—cÚ.
_Ën
);

2737 ià(
w·_›_pos
) {

2738 
w·_›_Ën
 = *(
w·_›_pos
 + 1) + 2;

2739 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "WPA IE found: L’gth = %zu\n", 
w·_›_Ën
);

2740 
	`SLSI_EC_GOTO
(
	`¦si_ÿche_›s
(
w·_›_pos
, 
w·_›_Ën
, &
ndev_vif
->
­
.
ÿche_w·_›
, &ndev_vif->­.w·_›_Ën), 
r
, 
ex™_w™h_vif
);

2743 
wmm_›_pos
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WMM
, 
£‰šgs
->
b—cÚ
.

, s‘tšgs->b—cÚ.
_Ën
);

2744 ià(
wmm_›_pos
) {

2745 
wmm_›_Ën
 = *(
wmm_›_pos
 + 1) + 2;

2746 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "WMM IE found: L’gth = %zu\n", 
wmm_›_Ën
);

2747 
	`SLSI_EC_GOTO
(
	`¦si_ÿche_›s
(
wmm_›_pos
, 
wmm_›_Ën
, &
ndev_vif
->
­
.
ÿche_wmm_›
, &ndev_vif->­.wmm_›_Ën), 
r
, 
ex™_w™h_vif
);

2750 
	`¦si_ş—r_ÿched_›s
(&
ndev_vif
->
­
.
add_šfo_›s
, &ndev_vif->­.
add_šfo_›s_Ën
);

2757 ià((
wmm_›_pos
è|| (
w·_›_pos
è|| (
£‰šgs
->
b—cÚ
.
b—cÚ_›s_Ën
 > 0 && s‘tšgs->b—cÚ.
b—cÚ_›s
)) {

2758 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "Add infoƒlements for beacon\n");

2759 
	`SLSI_EC_GOTO
(
	`¦si_­_´•¬e_add_šfo_›s
(
ndev_vif
, 
£‰šgs
->
b—cÚ
.
b—cÚ_›s
, s‘tšgs->b—cÚ.
b—cÚ_›s_Ën
), 
r
, 
ex™_w™h_vif
);

2760 
	`SLSI_EC_GOTO
(
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_BEACON
, 
ndev_vif
->
­
.
add_šfo_›s
,‚dev_vif->­.
add_šfo_›s_Ën
), 
r
, 
ex™_w™h_vif
);

2761 
	`¦si_ş—r_ÿched_›s
(&
ndev_vif
->
­
.
add_šfo_›s
, &ndev_vif->­.
add_šfo_›s_Ën
);

2764 ià((
wmm_›_pos
è|| (
w·_›_pos
è|| (
£‰šgs
->
b—cÚ
.
´ob”e¥_›s_Ën
 > 0 && s‘tšgs->b—cÚ.
´ob”e¥_›s
)) {

2765 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "Add infoƒlements for…robe„esponse\n");

2766 
	`SLSI_EC_GOTO
(
	`¦si_­_´•¬e_add_šfo_›s
(
ndev_vif
, 
£‰šgs
->
b—cÚ
.
´ob”e¥_›s
, s‘tšgs->b—cÚ.
´ob”e¥_›s_Ën
), 
r
, 
ex™_w™h_vif
);

2767 
	`SLSI_EC_GOTO
(
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_PROBE_RESPONSE
, 
ndev_vif
->
­
.
add_šfo_›s
,‚dev_vif->­.
add_šfo_›s_Ën
), 
r
, 
ex™_w™h_vif
);

2768 
	`¦si_ş—r_ÿched_›s
(&
ndev_vif
->
­
.
add_šfo_›s
, &ndev_vif->­.
add_šfo_›s_Ën
);

2771 ià((
wmm_›_pos
è|| (
w·_›_pos
è|| (
£‰šgs
->
b—cÚ
.
assoüe¥_›s_Ën
 > 0 && s‘tšgs->b—cÚ.
assoüe¥_›s
)) {

2772 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "Add infoƒlements for‡ssoc„esponse\n");

2773 
	`SLSI_EC_GOTO
(
	`¦si_­_´•¬e_add_šfo_›s
(
ndev_vif
, 
£‰šgs
->
b—cÚ
.
assoüe¥_›s
, s‘tšgs->b—cÚ.
assoüe¥_›s_Ën
), 
r
, 
ex™_w™h_vif
);

2774 
	`SLSI_EC_GOTO
(
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_ASSOCIATION_RESPONSE
, 
ndev_vif
->
­
.
add_šfo_›s
,‚dev_vif->­.
add_šfo_›s_Ën
), 
r
, 
ex™_w™h_vif
);

2775 
	`¦si_ş—r_ÿched_›s
(&
ndev_vif
->
­
.
add_šfo_›s
, &ndev_vif->­.
add_šfo_›s_Ën
);

2778 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_GO
) {

2779 
u32
 
af_bm­_aùive
 = 
SLSI_ACTION_FRAME_PUBLIC
;

2780 
u32
 
af_bm­_su¥’ded
 = 
SLSI_ACTION_FRAME_PUBLIC
;

2782 
r
 = 
	`¦si_mlme_»gi¡”_aùiÚ_äame
(
sdev
, 
dev
, 
af_bm­_aùive
, 
af_bm­_su¥’ded
);

2783 ià(
r
 != 0) {

2784 
	`SLSI_NET_ERR
(
dev
, "¦si_mlme_»gi¡”_aùiÚ_äamçed:„esuÉcodğ%d\n", 
r
);

2785 
ex™_w™h_vif
;

2789 
	`¦si_£t_­_mode
(
ndev_vif
, 
£‰šgs
, 
­³nd_vht_›s
);

2791 
r
 = 
	`¦si_mlme_¡¬t
(
sdev
, 
dev
, dev->
dev_addr
, 
£‰šgs
, 
w·_›_pos
, 
wmm_›_pos
, 
­³nd_vht_›s
);

2793 
	`cfg80211_ch_sw™ch_nÙify
(
dev
, &
£‰šgs
->
chªdef
);

2795 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


2796 ià(
r
 == 0)

2797 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "Soft Ap started on frequency: %d\n",

2798 
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
);

2799 ià(
	`SLSI_IS_VIF_INDEX_MHS
(
sdev
, 
ndev_vif
))

2800 
ndev_vif
->
chª
 = 
£‰šgs
->
chªdef
.chan;

2802 ià(
r
 != 0) {

2803 
	`SLSI_NET_ERR
(
dev
, "S¹‡°çed:„esuÉcodğ%d f»qu’cy = %d\n", 
r
,

2804 
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
);

2805 
ex™_w™h_vif
;

2806 } ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_GO
) {

2807 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_GROUP_FORMED_GO
);

2809 
ndev_vif
->
­
.
b—cÚ_š‹rv®
 = 
£‰šgs
->beacon_interval;

2810 
ndev_vif
->
­
.
ssid_Ën
 = 
£‰šgs
->ssid_len;

2811 
	`memıy
(
ndev_vif
->
­
.
ssid
, 
£‰šgs
->ssid, s‘tšgs->
ssid_Ën
);

2813 
	`Ãtif_ÿ¼›r_Ú
(
dev
);

2815 ià(
ndev_vif
->
add»ss
)

2817 
	`¦si__add»ss_chªged
(
sdev
, 
dev
, 
ndev_vif
->
add»ss
);

2819 
r
 = 
	`¦si_»ad_discÚÃù_šd_timeout
(
sdev
, 
SLSI_PSID_UNIFI_DISCONNECT_TIMEOUT
);

2820 ià(
r
 != 0)

2821 
sdev
->
deviû_cÚfig
.
­_discÚÃù_šd_timeout
 = *sdev->
sig_wa™_cfm_timeout
;

2823 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "¦si_»ad_discÚÃù_šd_timeout:imeouˆğ%d", 
sdev
->
deviû_cÚfig
.
­_discÚÃù_šd_timeout
);

2824 
ex™_w™h_vif_mu‹x
;

2825 
ex™_w™h_vif
:

2826 
	`¦si_ş—r_ÿched_›s
(&
ndev_vif
->
­
.
add_šfo_›s
, &ndev_vif->­.
add_šfo_›s_Ën
);

2827 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

2828 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

2829 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

2830 
r
 = -
EINVAL
;

2831 
ex™_w™h_vif_mu‹x
:

2832 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2833 
ex™_w™h_¡¬t_¡İ_mu‹x
:

2834 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

2835 
	`¦si_¡Üe_£‰šgs_fÜ_»cov”y
(
£‰šgs
, 
ndev_vif
);

2836  
r
;

2837 
	}
}

2839 
	$¦si_chªge_b—cÚ
(
why
 *why, 
Ãt_deviû
 *
dev
,

2840 
cfg80211_b—cÚ_d©a
 *
šfo
)

2842 
	`SLSI_UNUSED_PARAMETER
(
šfo
);

2844  -
EOPNOTSUPP
;

2845 
	}
}

2847 
	$¦si_¡İ_­
(
why
 *why, 
Ãt_deviû
 *
dev
)

2849 
	`¦si_»£t_throughput_¡©s
(
dev
);

2852 
	}
}

2854 
	$¦si_p2p_group_mgmt_tx
(cÚ¡ 
›“80211_mgmt
 *
mgmt
, 
why
 *wiphy,

2855 
Ãt_deviû
 *
dev
, 
›“80211_chªÃl
 *
chª
,

2856 
wa™
, cÚ¡ 
u8
 *
buf
, 
size_t
 
Ën
,

2857 
boŞ
 
dÚt_wa™_fÜ_ack
, 
u64
 *
cook›
)

2859 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2860 
Ãtdev_vif
 *
ndev_vif
;

2861 
Ãt_deviû
 *
Ãtdev
;

2862 
subty³
 = 
	`¦si_g‘_public_aùiÚ_subty³
(
mgmt
);

2863 
r
 = 0;

2864 
u32
 
ho¡_g
 = 
	`¦si_tx_mgmt_ho¡_g
(
sdev
);

2865 
u16
 
äeq
 = 0;

2866 
u32
 
dw–l_time
 = 
SLSI_FORCE_SCHD_ACT_FRAME_MSEC
;

2867 
u16
 
d©a_un™_desc
 = 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
;

2869 ià(
sdev
->
p2p_group_exp_äame
 !ğ
SLSI_PA_INVALID
) {

2870 
	`SLSI_NET_ERR
(
dev
, "sdev->p2p_group_exp_äam: %d\n", 
sdev
->
p2p_group_exp_äame
);

2871  -
EINVAL
;

2873 
Ãtdev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2PX_SWLAN
);

2874 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãtdev
);

2875 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2876 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "Sending Action frame (%s) on…2p group vif (%d), vif_index = %d,"

2878 "sdev->p2p_group_exp_äamğ%d\n", 
	`¦si_·_subty³_‹xt
(
subty³
), 
ndev_vif
->
aùiv©ed
,

2879 
ndev_vif
->
iâum
,‚dev_vif->
vif_ty³
, 
chª
->
hw_v®ue
,‚dev_vif->chª->hw_v®ue, 
wa™
,

2880 
ndev_vif
->
chª
->
hw_v®ue
);

2882 ià(!((
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_GO
è|| (ndev_vif->iáy³ =ğ
NL80211_IFTYPE_P2P_CLIENT
)))

2883 
ex™_w™h_”rÜ
;

2885 ià(
chª
->
hw_v®ue
 !ğ
ndev_vif
->chan->hw_value) {

2886 
äeq
 = 
	`SLSI_FREQ_HOST_TO_FW
(
chª
->
ûÁ”_äeq
);

2887 
dw–l_time
 = 
wa™
;

2891 ià(
subty³
 !ğ
SLSI_P2P_PA_GO_NEG_RSP
)

2892 
sdev
->
p2p_group_exp_äame
 = 
	`¦si_g‘_exp_³”_äame_subty³
(
subty³
);

2894 
r
 = 
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
Ãtdev
, 
buf
, 
Ën
, 
d©a_un™_desc
, 
FAPI_MESSAGETYPE_IEEE80211_ACTION
, 
ho¡_g
, 
äeq
, 
dw–l_time
 * 1000, 0);

2895 ià(
r
)

2896 
ex™_w™h_lock
;

2897 
	`¦si_assign_cook›_id
(
cook›
, &
ndev_vif
->
mgmt_tx_cook›
);

2898 
r
 = 
	`¦si_£t_mgmt_tx_d©a
(
ndev_vif
, *
cook›
, 
ho¡_g
, 
buf
, 
Ën
);

2899 
ex™_w™h_lock
;

2901 
ex™_w™h_”rÜ
:

2902 
r
 = -
EINVAL
;

2903 
ex™_w™h_lock
:

2904 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2905  
r
;

2906 
	}
}

2909 
	$¦si_p2p_mgmt_tx
(cÚ¡ 
›“80211_mgmt
 *
mgmt
, 
why
 *wiphy,

2910 
Ãt_deviû
 *
dev
, 
Ãtdev_vif
 *
ndev_vif
,

2911 
›“80211_chªÃl
 *
chª
, 
wa™
,

2912 cÚ¡ 
u8
 *
buf
, 
size_t
 
Ën
, 
boŞ
 
dÚt_wa™_fÜ_ack
, 
u64
 *
cook›
)

2914 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2915 
»t
 = 0;

2917 ià(
	`›“80211_is_aùiÚ
(
mgmt
->
äame_cÚŒŞ
)) {

2918 
u16
 
ho¡_g
 = 
	`¦si_tx_mgmt_ho¡_g
(
sdev
);

2919 
subty³
 = 
	`¦si_g‘_public_aùiÚ_subty³
(
mgmt
);

2920 
u8
 
exp_³”_äame
;

2921 
u32
 
dw–l_time
 = 0;

2923 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "AùiÚ f¿m(%s), unsync_vif_aùiv(%d)\n", 
	`¦si_·_subty³_‹xt
(
subty³
), 
ndev_vif
->
aùiv©ed
);

2925 ià(
subty³
 =ğ
SLSI_PA_INVALID
) {

2926 
	`SLSI_NET_ERR
(
dev
, "Invalid Action frame subtype\n");

2927 
ex™_w™h_”rÜ
;

2931 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_IDLE_NO_VIF
)

2932 ià(
	`¦si_p2p_vif_aùiv©e
(
sdev
, 
dev
, 
chª
, 
wa™
, 
çl£
) != 0)

2933 
ex™_w™h_”rÜ
;

2936 ià(
ndev_vif
->
driv”_chªÃl
 !ğ
chª
->
hw_v®ue
) {

2937 ià(
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_PROBE_RESPONSE
, 
NULL
, 0) != 0)

2938 
	`SLSI_NET_ERR
(
dev
, "Clearing Probe Response IEs failed for unsync vif\n");

2939 
	`¦si_unsync_vif_£t_´obe_r¥_›
(
ndev_vif
, 
NULL
, 0);

2941 ià(
	`¦si_mlme_£t_chªÃl
(
sdev
, 
dev
, 
chª
, 
SLSI_FW_CHANNEL_DURATION_UNSPECIFIED
, 0, 0) != 0)

2942 
ex™_w™h_vif
;

2944 
ndev_vif
->
chª
 = chan;

2945 
ndev_vif
->
driv”_chªÃl
 = 
chª
->
hw_v®ue
;

2950 
exp_³”_äame
 = 
	`¦si_g‘_exp_³”_äame_subty³
(
subty³
);

2952 ià(
exp_³”_äame
 !ğ
SLSI_PA_INVALID
) {

2953 ià((
subty³
 =ğ
SLSI_P2P_PA_GO_NEG_RSP
è&& (
	`¦si_p2p_g‘_go_Ãg_r¥_¡©us
(
dev
, 
mgmt
è!ğ
SLSI_P2P_STATUS_CODE_SUCCESS
)) {

2954 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "GO_NEG_RSP Tx,…eer„esponse‚otƒxpected\n");

2955 
exp_³”_äame
 = 
SLSI_PA_INVALID
;

2957 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "Peer„esponseƒxpected with‡ction frame (%s)\n",

2958 
	`¦si_·_subty³_‹xt
(
exp_³”_äame
));

2960 ià(
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 !ğ
SLSI_PA_INVALID
)

2961 ()
	`¦si_£t_mgmt_tx_d©a
(
ndev_vif
, 0, 0, 
NULL
, 0);

2963 ià(
subty³
 =ğ
SLSI_P2P_PA_GO_NEG_RSP
)

2964 
ndev_vif
->
drv_š_p2p_´oûdu»
 = 
Œue
;

2967 ià(
wa™
)

2968 
dw–l_time
 = 
wa™
;

2970 
dw–l_time
 = 
SLSI_FORCE_SCHD_ACT_FRAME_MSEC
;

2974 
	`¦si_assign_cook›_id
(
cook›
, &
ndev_vif
->
mgmt_tx_cook›
);

2977 ià(
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
dev
, 
buf
, 
Ën
, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
, 
FAPI_MESSAGETYPE_IEEE80211_ACTION
, 
ho¡_g
, 0, 
dw–l_time
 * 1000, 0) != 0)

2978 
ex™_w™h_vif
;

2979 ià(
subty³
 =ğ
SLSI_P2P_PA_GO_NEG_CFM
)

2980 
ndev_vif
->
drv_š_p2p_´oûdu»
 = 
çl£
;

2981 ià((
subty³
 =ğ
SLSI_P2P_PA_GO_NEG_REQ
è|| (subty³ =ğ
SLSI_P2P_PA_PROV_DISC_REQ
))

2982 
ndev_vif
->
drv_š_p2p_´oûdu»
 = 
Œue
;

2984 ià(
ndev_vif
->
mgmt_tx_d©a
.
ho¡_g
 == 0) {

2985 
n_wa™
 = 0;

2987 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "StÜmgmˆäamtx d©¨fÜ cook› = 0x%Îx\n", *
cook›
);

2989 
»t
 = 
	`¦si_£t_mgmt_tx_d©a
(
ndev_vif
, *
cook›
, 
ho¡_g
, 
buf
, 
Ën
);

2990 ià(
»t
 != 0)

2991 
ex™_w™h_vif
;

2992 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
exp_³”_äame
;

2994 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_ACTION_FRAME_TX_RX
);

2995 ià((
exp_³”_äame
 =ğ
SLSI_P2P_PA_GO_NEG_RSP
è|| (exp_³”_äam=ğ
SLSI_P2P_PA_GO_NEG_CFM
))

3000 
n_wa™
 = 
SLSI_P2P_NEG_PROC_UNSYNC_VIF_RETAIN_DURATION
;

3001 ià(
exp_³”_äame
 !ğ
SLSI_PA_INVALID
)

3003 
n_wa™
 = 
wa™
 + 
SLSI_P2P_MGMT_TX_EXTRA_MSEC
;

3004 ià(
n_wa™
) {

3005 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "»š unsynøviàfÜ du¿tiÚ (%dèm£c\n", 
n_wa™
);

3006 
	`¦si_p2p_queue_unsync_vif_d–_wÜk
(
ndev_vif
, 
n_wa™
);

3012 
	`WARN_ON
(
sdev
->
p2p_¡©e
 !ğ
P2P_ACTION_FRAME_TX_RX
);

3014 ià(!
dÚt_wa™_fÜ_ack
) {

3015 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "S’d immedŸ‹x_¡©u (cook› = 0x%Îx)\n", *
cook›
);

3016 
	`cfg80211_mgmt_tx_¡©us
(&
ndev_vif
->
wdev
, *
cook›
, 
buf
, 
Ën
, 
Œue
, 
GFP_KERNEL
);

3019 
ex™
;

3023 
	`SLSI_NET_ERR
(
dev
, "Drop Tx frame: Unexpected Management frame\n");

3024 
ex™_w™h_”rÜ
;

3026 
ex™_w™h_vif
:

3027 ià(
sdev
->
p2p_¡©e
 !ğ
P2P_LISTENING
)

3028 
	`¦si_p2p_vif_d—ùiv©e
(
sdev
, 
dev
, 
Œue
);

3029 
ex™_w™h_”rÜ
:

3030 
»t
 = -
EINVAL
;

3031 
ex™
:

3032  
»t
;

3033 
	}
}

3035 
	$¦si_mgmt_tx_ÿnûl_wa™
(
why
 *wiphy,

3036 
wœ–ess_dev
 *
wdev
,

3037 
u64
 
cook›
)

3039 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

3040 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3041 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3043 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3045 
	`SLSI_NET_INFO
(
dev
, "iface_num = %d, cookie = 0x%llx, vif_index = %d, vif_type = %d,"

3047 "sdev->wÏn_unsync_vif_¡©ğ%d\n", ()
ndev_vif
->
iâum
, 
cook›
,()ndev_vif->ifnum,

3048 ()
ndev_vif
->
vif_ty³
, 
sdev
->
p2p_¡©e
,‚dev_vif->
mgmt_tx_d©a
.
cook›
,

3049 ()
sdev
->
p2p_group_exp_äame
, sdev->
wÏn_unsync_vif_¡©e
);

3052 ià(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
è&& (
sdev
->
p2p_¡©e
 =ğ
P2P_ACTION_FRAME_TX_RX
è&& (ndev_vif->
mgmt_tx_d©a
.
cook›
 == cookie)) {

3053 ià(
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 !ğ
SLSI_PA_INVALID
)

3054 ()
	`¦si_mlme_»£t_dw–l_time
(
sdev
, 
dev
);

3056 ()
	`¦si_£t_mgmt_tx_d©a
(
ndev_vif
, 0, 0, 
NULL
, 0);

3057 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

3059 ià(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
)) {

3060 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_LISTENING
);

3062 
	`¦si_p2p_queue_unsync_vif_d–_wÜk
(
ndev_vif
, 
SLSI_P2P_UNSYNC_VIF_EXTRA_MSEC
);

3063 
	`SLSI_P2P_STATE_CHANGE
(
ndev_vif
->
sdev
, 
P2P_IDLE_VIF_ACTIVE
);

3065 } ià((
	`SLSI_IS_P2P_GROUP_STATE
(
sdev
)è&& (sdev->
p2p_group_exp_äame
 !ğ
SLSI_PA_INVALID
)) {

3067 
	`¦si_ş—r_offchªÃl_d©a
(
sdev
, (!
	`SLSI_IS_VIF_INDEX_P2P_GROUP
(sdev, 
ndev_vif
)è? 
Œue
 : 
çl£
);

3068 } ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
è&& (
sdev
->
wÏn_unsync_vif_¡©e
 =ğ
WLAN_UNSYNC_VIF_TX
è&& (ndev_vif->
mgmt_tx_d©a
.
cook›
 == cookie)) {

3069 
sdev
->
wÏn_unsync_vif_¡©e
 = 
WLAN_UNSYNC_VIF_ACTIVE
;

3070 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
hs2_d–_vif_wÜk
);

3071 
	`queue_d–ayed_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
unsync
.
hs2_d–_vif_wÜk
, 
	`m£cs_to_jiff›s
(
SLSI_HS2_UNSYNC_VIF_EXTRA_MSEC
));

3072 ià(
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 !ğ
SLSI_PA_INVALID
) {

3073 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

3074 ()
	`¦si_mlme_»£t_dw–l_time
(
sdev
, 
dev
);

3076 } ià(
ndev_vif
->
aùiv©ed
 &&‚dev_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION


3077 && 
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
) {

3078 ià(
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 !ğ
SLSI_PA_INVALID
) {

3079 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

3080 ()
	`¦si_mlme_»£t_dw–l_time
(
sdev
, 
dev
);

3084 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3086 
	}
}

3088 
	$¦si_mgmt_äame_»gi¡”
(
why
 *wiphy,

3089 
wœ–ess_dev
 *
wdev
,

3090 
u16
 
äame_ty³
, 
boŞ
 
»g
)

3092 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

3093 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3095 
	`SLSI_UNUSED_PARAMETER
(
äame_ty³
);

3096 
	`SLSI_UNUSED_PARAMETER
(
»g
);

3098 ià(
	`WARN_ON
(!
dev
))

3101 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

3102 
	}
}

3104 
	$¦si_wÏn_mgmt_tx
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

3105 
›“80211_chªÃl
 *
chª
, 
wa™
,

3106 cÚ¡ 
u8
 *
buf
, 
size_t
 
Ën
, 
boŞ
 
dÚt_wa™_fÜ_ack
, 
u64
 *
cook›
)

3108 
u32
 
ho¡_g
 = 
	`¦si_tx_mgmt_ho¡_g
(
sdev
);

3109 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3110 
r
 = 0;

3111 
›“80211_mgmt
 *
mgmt
 = (›“80211_mgmˆ*)
buf
;

3112 
u8
 
exp_³”_äame
 = 
SLSI_PA_INVALID
;

3113 
subty³
 = 
SLSI_PA_INVALID
;

3115 ià(!
	`›“80211_is_auth
(
mgmt
->
äame_cÚŒŞ
))

3116 
	`¦si_wÏn_dump_public_aùiÚ_subty³
(
sdev
, 
mgmt
, 
Œue
);

3118 ià(
	`›“80211_is_aùiÚ
(
mgmt
->
äame_cÚŒŞ
)) {

3119 
subty³
 = 
	`¦si_g‘_public_aùiÚ_subty³
(
mgmt
);

3121 ià(
subty³
 !ğ
SLSI_PA_INVALID
)

3122 
exp_³”_äame
 = 
	`¦si_g‘_exp_³”_äame_subty³
(
subty³
);

3125 ià(!
ndev_vif
->
aùiv©ed
) {

3126 ià(
subty³
 >ğ
SLSI_PA_GAS_INITIAL_REQ_SUBTYPE
 && subty³ <ğ
SLSI_PA_GAS_COMEBACK_RSP_SUBTYPE
) {

3127 
ndev_vif
->
mgmt_tx_gas_äame
 = 
Œue
;

3128 
	`SLSI_ETHER_COPY
(
ndev_vif
->
gas_äame_mac_addr
, 
mgmt
->
§
);

3130 
ndev_vif
->
mgmt_tx_gas_äame
 = 
çl£
;

3132 
r
 = 
	`¦si_wÏn_unsync_vif_aùiv©e
(
sdev
, 
dev
, 
chª
, 
wa™
);

3133 ià(
r
)

3134  
r
;

3136 
r
 = 
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
dev
, 
buf
, 
Ën
, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
, 
FAPI_MESSAGETYPE_IEEE80211_ACTION
, 
ho¡_g
, 0, 
wa™
 * 1000, 0);

3137 ià(
r
)

3138 
ex™_w™h_vif
;

3139 
sdev
->
wÏn_unsync_vif_¡©e
 = 
WLAN_UNSYNC_VIF_TX
;

3140 
	`queue_d–ayed_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
unsync
.
hs2_d–_vif_wÜk
, 
	`m£cs_to_jiff›s
(
wa™
));

3143 ià(
	`›“80211_is_auth
(
mgmt
->
äame_cÚŒŞ
)) {

3144 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "Transmit onhe current frequency\n");

3145 
r
 = 
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
dev
, 
buf
, 
Ën
, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
,

3146 
FAPI_MESSAGETYPE_IEEE80211_MGMT
, 
ho¡_g
, 0, 
wa™
 * 1000, 0);

3147 ià(
r
)

3148  
r
;

3149 } ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_UNSYNCHRONISED
) {

3150 ià(
subty³
 >ğ
SLSI_PA_GAS_INITIAL_REQ_SUBTYPE
 && subty³ <ğ
SLSI_PA_GAS_COMEBACK_RSP_SUBTYPE
) {

3151 
	`¦si_wÏn_unsync_vif_d—ùiv©e
(
sdev
, 
dev
, 
Œue
);

3152 
ndev_vif
->
mgmt_tx_gas_äame
 = 
Œue
;

3153 
	`SLSI_ETHER_COPY
(
ndev_vif
->
gas_äame_mac_addr
, 
mgmt
->
§
);

3154 
r
 = 
	`¦si_wÏn_unsync_vif_aùiv©e
(
sdev
, 
dev
, 
chª
, 
wa™
);

3155 ià(
r
)

3156  
r
;

3158 ià(
ndev_vif
->
mgmt_tx_gas_äame
) {

3159 
	`¦si_wÏn_unsync_vif_d—ùiv©e
(
sdev
, 
dev
, 
Œue
);

3160 
ndev_vif
->
mgmt_tx_gas_äame
 = 
çl£
;

3161 
r
 = 
	`¦si_wÏn_unsync_vif_aùiv©e
(
sdev
, 
dev
, 
chª
, 
wa™
);

3162 ià(
r
)

3163  
r
;

3167 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
hs2_d–_vif_wÜk
);

3169 ià(
ndev_vif
->
driv”_chªÃl
 !ğ
chª
->
hw_v®ue
) {

3170 
r
 = 
	`¦si_mlme_£t_chªÃl
(
sdev
, 
dev
, 
chª
, 
SLSI_FW_CHANNEL_DURATION_UNSPECIFIED
, 0, 0);

3171 ià(
r
)

3172 
ex™_w™h_vif
;

3174 
ndev_vif
->
driv”_chªÃl
 = 
chª
->
hw_v®ue
;

3176 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "wÏÀunsynøviài aùive, s’d f¿mÚ chªÃÈäeq = %d\n", 
chª
->
ûÁ”_äeq
);

3177 
r
 = 
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
dev
, 
buf
, 
Ën
, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
, 
FAPI_MESSAGETYPE_IEEE80211_ACTION
, 
ho¡_g
, 0, 
wa™
 * 1000, 0);

3178 ià(
r
)

3179 
ex™_w™h_vif
;

3180 
sdev
->
wÏn_unsync_vif_¡©e
 = 
WLAN_UNSYNC_VIF_TX
;

3181 
	`queue_d–ayed_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
unsync
.
hs2_d–_vif_wÜk
, 
	`m£cs_to_jiff›s
(
wa™
));

3182 } ià(
ndev_vif
->
chª
->
hw_v®ue
 == chan->hw_value) {

3184 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "STA VIF i aùivÚ samchªÃl, s’d f¿mÚ chªÃÈäeq %d\n", 
chª
->
ûÁ”_äeq
);

3185 
r
 = 
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
dev
, 
buf
, 
Ën
, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
, 
FAPI_MESSAGETYPE_IEEE80211_ACTION
, 
ho¡_g
, 0, 0, 0);

3186 ià(
r
)

3187  
r
;

3189 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "STA VIF i aùivÚ‡ difã»Á chªÃl, s’d f¿mÚ chªÃÈäeq %d\n", 
chª
->
ûÁ”_äeq
);

3191 ià((
subty³
 =ğ
SLSI_PA_GAS_INITIAL_REQ_SUBTYPE
 || subty³ =ğ
SLSI_PA_GAS_COMEBACK_REQ_SUBTYPE
è&& 
wa™
 > 
SLSI_FW_MAX_OFFCHANNEL_DWELL_TIME
)

3192 
wa™
 = 
SLSI_FW_MAX_OFFCHANNEL_DWELL_TIME
;

3193 
r
 = 
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
dev
, 
buf
, 
Ën
, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
, 
FAPI_MESSAGETYPE_IEEE80211_ACTION
, 
ho¡_g
, 
	`SLSI_FREQ_HOST_TO_FW
(
chª
->
ûÁ”_äeq
), 
wa™
 * 1000, 0);

3194 ià(
r
)

3195  
r
;

3199 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
exp_³”_äame
;

3200 
	`¦si_assign_cook›_id
(
cook›
, &
ndev_vif
->
mgmt_tx_cook›
);

3201 
	`¦si_£t_mgmt_tx_d©a
(
ndev_vif
, *
cook›
, 
ho¡_g
, 
buf
, 
Ën
);

3202  
r
;

3204 
ex™_w™h_vif
:

3205 
	`¦si_wÏn_unsync_vif_d—ùiv©e
(
sdev
, 
dev
, 
Œue
);

3206  
r
;

3207 
	}
}

3209 
	$¦si_mgmt_tx
(
why
 *why, 
wœ–ess_dev
 *
wdev
,

3210 
cfg80211_mgmt_tx_·¿ms
 *
·¿ms
,

3211 
u64
 *
cook›
)

3220 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

3221 
›“80211_chªÃl
 *
chª
 = 
·¿ms
->chan;

3222 
boŞ
 
offchª
 = 
·¿ms
->offchan;

3223 
wa™
 = 
·¿ms
->wait;

3224 cÚ¡ 
u8
 *
buf
 = 
·¿ms
->buf;

3225 
size_t
 
Ën
 = 
·¿ms
->len;

3226 
boŞ
 
no_cck
 = 
·¿ms
->no_cck;

3227 
boŞ
 
dÚt_wa™_fÜ_ack
 = 
·¿ms
->dont_wait_for_ack;

3228 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3229 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3230 cÚ¡ 
›“80211_mgmt
 *
mgmt
 = (cÚ¡ ›“80211_mgmˆ*)
buf
;

3231 
r
 = 0;

3233 
	`SLSI_UNUSED_PARAMETER
(
offchª
);

3234 
	`SLSI_UNUSED_PARAMETER
(
no_cck
);

3235 
	`SLSI_MUTEX_LOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

3236 ià(
sdev
->
deviû_¡©e
 !ğ
SLSI_DEVICE_STATE_STARTED
) {

3237 
	`SLSI_WARN
(
sdev
, "deviû‚Ù s¹ed y‘ (deviû_¡©e:%d)\n", sdev->
deviû_¡©e
);

3238 
r
 = -
EINVAL
;

3239 
ex™
;

3242 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3244 ià(!(
	`›“80211_is_auth
(
mgmt
->
äame_cÚŒŞ
))) {

3245 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "Mgmt Frame Tx: iface_num = %d, channel = %d, wait = %d,‚oAck = %d,"

3246 "offchªÃÈğ%d, mgmt->äame_cÚŒŞ = %d, vif_ty³ = %d\n", 
ndev_vif
->
iâum
, 
chª
->
hw_v®ue
,

3247 
wa™
, 
dÚt_wa™_fÜ_ack
, 
offchª
, 
mgmt
->
äame_cÚŒŞ
, 
ndev_vif
->
vif_ty³
);

3249 ià(!
ndev_vif
->
aùiv©ed
) {

3250 
	`SLSI_NET_ERR
(
dev
, "Drop Auth Frame: VIF‚ot‡ctivated\n");

3251 
r
 = -
EINVAL
;

3252 
ex™
;

3254 
	`SLSI_INFO
(
sdev
, "Send Auth Frame\n");

3257 ià(!(
	`›“80211_is_mgmt
(
mgmt
->
äame_cÚŒŞ
))) {

3258 
	`SLSI_NET_ERR
(
dev
, "Drop Tx frame: Not‡ Management frame\n");

3259 
r
 = -
EINVAL
;

3260 
ex™
;

3262 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
è|| (ndev_vif->
iáy³
 =ğ
NL80211_IFTYPE_AP
 && (
	`›“80211_is_auth
(
mgmt
->
äame_cÚŒŞ
)))) {

3263 
r
 = 
	`¦si_wÏn_mgmt_tx
(
	`SDEV_FROM_WIPHY
(
why
), 
dev
, 
chª
, 
wa™
, 
buf
, 
Ën
, 
dÚt_wa™_fÜ_ack
, 
cook›
);

3264 
ex™
;

3270 ià(
	`›“80211_is_´obe_»¥
(
mgmt
->
äame_cÚŒŞ
)) {

3272 ià(!
dÚt_wa™_fÜ_ack
) {

3273 
	`¦si_assign_cook›_id
(
cook›
, &
ndev_vif
->
mgmt_tx_cook›
);

3274 
	`cfg80211_mgmt_tx_¡©us
(
wdev
, *
cook›
, 
buf
, 
Ën
, 
Œue
, 
GFP_KERNEL
);

3276 
ex™
;

3279 ià(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
)) {

3280 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3282 
	`¦si_abÜt_¡a_sÿn
(
sdev
);

3283 ià(
	`SLSI_IS_P2P_GROUP_STATE
(
sdev
))

3284 
r
 = 
	`¦si_p2p_group_mgmt_tx
(
mgmt
, 
why
, 
dev
, 
chª
, 
wa™
, 
buf
, 
Ën
, 
dÚt_wa™_fÜ_ack
, 
cook›
);

3286 
r
 = 
	`¦si_p2p_mgmt_tx
(
mgmt
, 
why
, 
dev
, 
ndev_vif
, 
chª
, 
wa™
, 
buf
, 
Ën
, 
dÚt_wa™_fÜ_ack
, 
cook›
);

3287 } ià(
	`SLSI_IS_VIF_INDEX_P2P_GROUP
(
sdev
, 
ndev_vif
))

3288 ià(
chª
->
hw_v®ue
 =ğ
ndev_vif
->chan->hw_value) {

3289 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3290 
u16
 
ho¡_g
 = 
	`¦si_tx_mgmt_ho¡_g
(
sdev
);

3292 
r
 = 
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
dev
, 
buf
, 
Ën
, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
, 
FAPI_MESSAGETYPE_IEEE80211_ACTION
, 
ho¡_g
, 0, 0, 0);

3293 ià(
r
) {

3294 
	`SLSI_NET_ERR
(
dev
, "FaedØ£nd‡ùiÚ f¿me,„ = %d\n", 
r
);

3295 
ex™
;

3297 
	`¦si_assign_cook›_id
(
cook›
, &
ndev_vif
->
mgmt_tx_cook›
);

3298 
r
 = 
	`¦si_£t_mgmt_tx_d©a
(
ndev_vif
, *
cook›
, 
ho¡_g
, 
buf
, 
Ën
);

3300 
ex™
:

3301 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3302 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

3303  
r
;

3304 
	}
}

3307 
u8
 
	$¦si_g‘_ecw
(
cw
)

3309 
ecw
 = 0;

3311 
cw
 = cw + 1;

3313 
cw
 = cw >> 1;

3314 
ecw
++;

3315 } 
cw
);

3316  
ecw
 - 1;

3317 
	}
}

3319 
	$¦si_£t_txq_·¿ms
(
why
 *why, 
Ãt_deviû
 *
ndev
,

3320 
›“80211_txq_·¿ms
 *
·¿ms
)

3322 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3323 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
ndev
);

3324 
¦si_wmm_·¿m‘”_–em’t
 *
wmm_›
 = &
ndev_vif
->
­
.wmm_ie;

3325 
r
 = 0;

3326 
ac
 = 
·¿ms
->ac;

3333 
u8
 
ac_šdex_m­
[4] = { 
AC_VO
, 
AC_VI
, 
AC_BE
, 
AC_BK
 };

3334 
ac_»m­³d
 = 
ac_šdex_m­
[
ac
];

3336 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3337 
	`SLSI_NET_DBG2
(
ndev
, 
SLSI_CFG80211
, "‡c= %x,‡c_remapped = %d‡ifs = %d, cmin=%x cmax = %x,xop = %x,"

3338 "vif_šdex = %d vif_ty³ = %d", 
ac
, 
ac_»m­³d
, 
·¿ms
->
aifs
,…¬ams->
cwmš
,…¬ams->
cwmax
,

3339 
·¿ms
->
txİ
, 
ndev_vif
->
iâum
,‚dev_vif->
vif_ty³
);

3341 ià(
ndev_vif
->
aùiv©ed
) {

3342 
wmm_›
->
ac
[
ac_»m­³d
].
aci_aif¢
 = (ac_»m­³d << 5è| (
·¿ms
->
aifs
 & 0x0f);

3343 
wmm_›
->
ac
[
ac_»m­³d
].
ecw
 = ((
	`¦si_g‘_ecw
(
·¿ms
->
cwmax
)è<< 4è| ((¦si_g‘_ecwÕ¬ams->
cwmš
)) & 0x0f);

3344 
wmm_›
->
ac
[
ac_»m­³d
].
txİ_lim™
 = 
	`ıu_to_Ë16
(
·¿ms
->
txİ
);

3345 ià(
ac
 == 3) {

3346 
wmm_›
->
eid
 = 
SLSI_WLAN_EID_VENDOR_SPECIFIC
;

3347 
wmm_›
->
Ën
 = 24;

3348 
wmm_›
->
oui
[0] = 0x00;

3349 
wmm_›
->
oui
[1] = 0x50;

3350 
wmm_›
->
oui
[2] = 0xf2;

3351 
wmm_›
->
oui_ty³
 = 
WLAN_OUI_TYPE_MICROSOFT_WMM
;

3352 
wmm_›
->
oui_subty³
 = 1;

3353 
wmm_›
->
v”siÚ
 = 1;

3354 
wmm_›
->
qos_šfo
 = 0;

3355 
wmm_›
->
»£rved
 = 0;

3356 
r
 = 
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
ndev
, 
FAPI_PURPOSE_LOCAL
, (cÚ¡ 
u8
 *)
wmm_›
, (
¦si_wmm_·¿m‘”_–em’t
));

3357 ià(
r
)

3358 
	`SLSI_NET_ERR
(
ndev
, "E¼Ü s’dšg TX QueuP¬am‘” fÜ APƒ¼Ü = %d", 
r
);

3361 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3362  
r
;

3363 
	}
}

3365 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


3366 
	$¦si_synchrÚi£d_»¥Ú£
(
why
 *why, 
Ãt_deviû
 *
dev
,

3367 
cfg80211_ex‹º®_auth_·¿ms
 *
·¿ms
)

3369 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3370 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3371 
r
;

3373 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3374 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

3375 ià(
ndev_vif
->
¡a
.
w·3_§e_»cÚÃùiÚ
 && 
	`SLSI_ETHER_EQUAL
(
·¿ms
->
bssid
,‚dev_vif->sta.bssid)) {

3376 
	`SLSI_NET_ERR
(
dev
, "Drİšg synchrÚi£d_»¥ fÜ bssid:%pM\n", 
·¿ms
->
bssid
);

3377 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3378 
ndev_vif
->
¡a
.
w·3_§e_»cÚÃùiÚ
 = 
çl£
;

3382 
r
 = 
	`¦si_mlme_synchrÚi£d_»¥Ú£
(
sdev
, 
dev
, 
·¿ms
);

3383 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3384  
r
;

3385 
	}
}

3388 
	$¦si_upd©e_á_›s
(
why
 *why, 
Ãt_deviû
 *
dev
, 
cfg80211_upd©e_á_›s_·¿ms
 *
á›
)

3390 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3391 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3392 
r
 = 0;

3394 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3396 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

3397 cÚ¡ 
u8
 *
keo_›_pos
 = 
NULL
;

3398 
u8
 *
›_buf
 = 
NULL
;

3399 
›_Ën
 = 0;

3400 
›_buf_Ën
 = 0;

3402 
keo_›_pos
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_SAMSUNG
, 
WLAN_OUI_TYPE_SAMSUNG_KEO
,

3403 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
,

3404 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
);

3405 ià(
keo_›_pos
) {

3406 
›_buf_Ën
 = 
á›
->
›_Ën
 +

3407 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
 -

3408 (
keo_›_pos
 - 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
);

3409 
›_buf
 = 
	`km®loc
(
›_buf_Ën
, 
GFP_KERNEL
);

3410 ià(!
›_buf
) {

3411 
	`SLSI_NET_ERR
(
dev
, "kmalloc failed\n");

3412 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3413  -
ENOMEM
;

3415 
›_Ën
 = 
á›
->ie_len;

3416 ià(
›_buf_Ën
 < 
›_Ën
) {

3417 
	`SLSI_NET_ERR
(
dev
, "ft_ie buffer overflow!!\n");

3418 
	`kä“
(
›_buf
);

3419 
›_buf
 = 
NULL
;

3420 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3421  -
EINVAL
;

3423 
	`memıy
(
›_buf
, 
á›
->
›
, 
›_Ën
);

3424 ià((
›_buf_Ën
 - 
›_Ën
è>ğ(()
keo_›_pos
[1] + 2)) {

3425 
	`memıy
(&
›_buf
[
›_Ën
], 
keo_›_pos
, (()keo_ie_pos[1] + 2));

3426 
›_Ën
 +ğ(
keo_›_pos
[1] + 2);

3427 
keo_›_pos
 += (keo_ie_pos[1] + 2);

3429 
	`SLSI_NET_ERR
(
dev
, "ie_buf buffer overflow!!\n");

3430 
	`kä“
(
›_buf
);

3431 
›_buf
 = 
NULL
;

3432 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3433  -
EINVAL
;

3435 (
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
 -

3436 (
keo_›_pos
 - 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
)) > 2) {

3437 
keo_›_pos
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_SAMSUNG
, 
WLAN_OUI_TYPE_SAMSUNG_KEO
,

3438 
keo_›_pos
,

3439 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
 -

3440 (
keo_›_pos
 - 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
));

3441 ià(!
keo_›_pos
)

3443 ià((
›_buf_Ën
 - 
›_Ën
è>ğ(()
keo_›_pos
[1] + 2)) {

3444 
	`memıy
(&
›_buf
[
›_Ën
], 
keo_›_pos
, (keo_ie_pos[1] + 2));

3445 
›_Ën
 +ğ(
keo_›_pos
[1] + 2);

3446 
keo_›_pos
 += (keo_ie_pos[1] + 2);

3448 
	`SLSI_NET_ERR
(
dev
, "ie_buf buffer overflow!\n");

3449 
	`kä“
(
›_buf
);

3450 
›_buf
 = 
NULL
;

3451 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3452  -
EINVAL
;

3455 
r
 = 
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_ASSOCIATION_REQUEST
, 
›_buf
, 
›_Ën
);

3457 
r
 = 
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_ASSOCIATION_REQUEST
, 
á›
->
›
, ft›->
›_Ën
);

3459 
	`kä“
(
›_buf
);

3460 
›_buf
 = 
NULL
;

3463 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3464  
r
;

3465 
	}
}

3467 #ifdeà
CONFIG_SCSC_WLAN_MAC_ACL_PER_MAC


3468 
	$¦si_£t_mac_aş_³r_mac
(
why
 *why, 
Ãt_deviû
 *
dev
,

3469 cÚ¡ 
cfg80211_aş_d©a
 *
·¿ms
)

3471 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3472 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3473 
r
 = 0;

3474 
i
 = 0;

3475 
m®loc_Ën
 = 0;

3476 
cfg80211_aş_d©a
 *
§ved_aş_d©a
 = 
NULL
;

3477 
Ï¡_šdex
 = 0;

3478 
mac_add»ss
 
z”o_addr
 = {0};

3479 
boŞ
 
found_æag
 = 
çl£
;

3481 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

3482 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_SET_ACL.request\n");

3483  -
EOPNOTSUPP
;

3485 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3486 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_AP
) {

3487 
	`SLSI_NET_ERR
(
dev
, "Inv®id viàty³: %d\n", 
ndev_vif
->
vif_ty³
);

3488 
r
 = -
EINVAL
;

3489 
ex™
;

3491 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "ACL:: PŞicy: %d Numb” oà¡©iÚs: %d\n", 
·¿ms
->
aş_pŞicy
,…¬ams->
n_aş_’Œ›s
);

3493 ià(
·¿ms
->
n_aş_’Œ›s
 != 1) {

3494 
	`SLSI_NET_ERR
(
dev
, "n_acl_entries != 1, No‡ctionaken\n");

3495 
ex™
;

3498 
§ved_aş_d©a
 = 
ndev_vif
->
­
.
aş_d©a_bÏckli¡
;

3499 ià(!
§ved_aş_d©a
) {

3500 ià(
·¿ms
->
aş_pŞicy
 =ğ
NL80211_ACL_POLICY_DENY_UNLESS_LISTED
) {

3501 
	`SLSI_NET_ERR
(
dev
, "Deletion„equested onƒmpty†ist\n");

3502 
r
 = -
EINVAL
;

3503 
ex™
;

3505 
m®loc_Ën
 = (
cfg80211_aş_d©a
è+ (
mac_add»ss
è* 
SLSI_ACL_MAX_BSSID_COUNT
;

3506 
§ved_aş_d©a
 = 
	`km®loc
(
m®loc_Ën
, 
GFP_KERNEL
);

3507 ià(!
§ved_aş_d©a
) {

3508 
	`SLSI_ERR
(
sdev
, "Memory Allocation failure for ACL List");

3509 
r
 = -
ENOMEM
;

3510 
ex™
;

3512 
	`mem£t
(
§ved_aş_d©a
, 0, 
m®loc_Ën
);

3513 
ndev_vif
->
­
.
aş_d©a_bÏckli¡
 = 
§ved_aş_d©a
;

3516 
Ï¡_šdex
 = 
§ved_aş_d©a
->
n_aş_’Œ›s
;

3517 ià(
·¿ms
->
aş_pŞicy
 =ğ
NL80211_ACL_POLICY_ACCEPT_UNLESS_LISTED
) {

3518 ià(
	`SLSI_ETHER_EQUAL
(
·¿ms
->
mac_addrs
[0].
addr
, 
z”o_addr
.addr)) {

3519 
	`SLSI_NET_ERR
(
dev
, "Addition of‡ddr 00:00:00:00:00:00 in blacklist\n");

3520 
r
 = -
EINVAL
;

3521 
ex™
;

3523 
i
 = 0 ; i < 
Ï¡_šdex
; i++) {

3524 ià(
	`SLSI_ETHER_EQUAL
(
§ved_aş_d©a
->
mac_addrs
[
i
].
addr
, 
·¿ms
->mac_addrs[0].addr)) {

3525 
	`SLSI_NET_INFO
(
dev
, "Mac‡ddr‡lready…resent in blacklist\n");

3526 
r
 = 0;

3527 
ex™
;

3530 
i
 = 0 ; i < 
Ï¡_šdex
 + 1 && i < 
SLSI_ACL_MAX_BSSID_COUNT
; i++) {

3531 ià(
	`SLSI_ETHER_EQUAL
(
§ved_aş_d©a
->
mac_addrs
[
i
].
addr
, 
z”o_addr
.addr)) {

3532 
	`SLSI_ETHER_COPY
(
§ved_aş_d©a
->
mac_addrs
[
i
].
addr
, 
·¿ms
->mac_addrs[0].addr);

3533 ià(
i
 =ğ
Ï¡_šdex
)

3534 
Ï¡_šdex
 = 
i
 + 1;

3538 ià(
i
 =ğ
SLSI_ACL_MAX_BSSID_COUNT
) {

3539 
	`SLSI_NET_ERR
(
dev
, "Blacklist is full\n");

3540 
r
 = -
EINVAL
;

3541 
ex™
;

3543 } ià(
·¿ms
->
aş_pŞicy
 =ğ
NL80211_ACL_POLICY_DENY_UNLESS_LISTED
) {

3544 
found_æag
 = 
çl£
;

3545 
i
 = 0 ; i < 
Ï¡_šdex
; i++) {

3546 ià(
	`SLSI_ETHER_EQUAL
(
§ved_aş_d©a
->
mac_addrs
[
i
].
addr
, 
·¿ms
->mac_addrs[0].addr)) {

3547 
	`SLSI_ETHER_COPY
(
§ved_aş_d©a
->
mac_addrs
[
i
].
addr
, 
z”o_addr
.addr);

3548 
found_æag
 = 
Œue
;

3549 ià(
i
 =ğ
Ï¡_šdex
 - 1) {

3550 
i
 >ğ0 && 
	`SLSI_ETHER_EQUAL
(
§ved_aş_d©a
->
mac_addrs
[i].
addr
, 
z”o_addr
.addr))

3551 
i
--;

3552 
Ï¡_šdex
 = 
i
 + 1;

3557 ià(!
found_æag
) {

3558 
r
 = -
EINVAL
;

3559 
	`SLSI_NET_ERR
(
dev
, "Deletion„equested for‡ddr‚ot…resent in blacklist");

3560 
ex™
;

3563 
§ved_aş_d©a
->
n_aş_’Œ›s
 = 
Ï¡_šdex
;

3564 
r
 = 
	`¦si_mlme_£t_aş
(
sdev
, 
dev
, 
ndev_vif
->
iâum
, 
§ved_aş_d©a
->
aş_pŞicy
, saved_aş_d©a->
n_aş_’Œ›s
, saved_aş_d©a->
mac_addrs
);

3565 
ex™
:

3566 ià(!
Ï¡_šdex
) {

3567 
ndev_vif
->
­
.
aş_d©a_bÏckli¡
 = 
NULL
;

3568 
	`kä“
(
§ved_aş_d©a
);

3570 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3571  
r
;

3572 
	}
}

3575 
	$¦si_£t_mac_aş
(
why
 *why, 
Ãt_deviû
 *
dev
,

3576 cÚ¡ 
cfg80211_aş_d©a
 *
·¿ms
)

3578 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3579 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3580 
r
 = 0;

3582 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

3583 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_SET_ACL.request\n");

3584  -
EOPNOTSUPP
;

3586 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3587 ià(
FAPI_VIFTYPE_AP
 !ğ
ndev_vif
->
vif_ty³
) {

3588 
	`SLSI_NET_ERR
(
dev
, "Inv®id viàty³: %d\n", 
ndev_vif
->
vif_ty³
);

3589 
r
 = -
EINVAL
;

3590 
ex™
;

3592 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "ACL:: PŞicy: %d Numb” oà¡©iÚs: %d\n", 
·¿ms
->
aş_pŞicy
,…¬ams->
n_aş_’Œ›s
);

3593 
r
 = 
	`¦si_mlme_£t_aş
(
sdev
, 
dev
, 
ndev_vif
->
iâum
, 
·¿ms
->
aş_pŞicy
,…¬ams->
n_aş_’Œ›s
, (
mac_add»ss
 *í¬ams->
mac_addrs
);

3594 ià(
r
 != 0)

3595 
	`SLSI_NET_ERR
(
dev
, "mlme_set_acl_req„eturned with CFM failure\n");

3596 
ex™
:

3597 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3598  
r
;

3599 
	}
}

3601 
cfg80211_İs
 
	g¦si_İs
 = {

3602 .
add_vœtu®_štf
 = 
¦si_add_vœtu®_štf
,

3603 .
	gd–_vœtu®_štf
 = 
¦si_d–_vœtu®_štf
,

3604 .
	gchªge_vœtu®_štf
 = 
¦si_chªge_vœtu®_štf
,

3606 .
	gsÿn
 = 
¦si_sÿn
,

3607 .
	gcÚÃù
 = 
¦si_cÚÃù
,

3608 .
	gdiscÚÃù
 = 
¦si_discÚÃù
,

3610 .
	gadd_key
 = 
¦si_add_key
,

3611 .
	gd–_key
 = 
¦si_d–_key
,

3612 .
	gg‘_key
 = 
¦si_g‘_key
,

3613 .
	g£t_deçuÉ_key
 = 
¦si_£t_deçuÉ_key
,

3614 .
	g£t_deçuÉ_mgmt_key
 = 
¦si_cÚfig_deçuÉ_mgmt_key
,

3616 .
	g£t_why_·¿ms
 = 
¦si_£t_why_·¿ms
,

3618 .
	gd–_¡©iÚ
 = 
¦si_d–_¡©iÚ
,

3619 .
	gg‘_¡©iÚ
 = 
¦si_g‘_¡©iÚ
,

3620 .
	g£t_tx_pow”
 = 
¦si_£t_tx_pow”
,

3621 .
	gg‘_tx_pow”
 = 
¦si_g‘_tx_pow”
,

3622 .
	g£t_pow”_mgmt
 = 
¦si_£t_pow”_mgmt
,

3624 .
	gsu¥’d
 = 
¦si_su¥’d
,

3625 .
	g»sume
 = 
¦si_»sume
,

3627 .
	g£t_pmk§
 = 
¦si_£t_pmk§
,

3628 .
	gd–_pmk§
 = 
¦si_d–_pmk§
,

3629 .
	gæush_pmk§
 = 
¦si_æush_pmk§
,

3631 .
	g»maš_Ú_chªÃl
 = 
¦si_»maš_Ú_chªÃl
,

3632 .
	gÿnûl_»maš_Ú_chªÃl
 = 
¦si_ÿnûl_»maš_Ú_chªÃl
,

3634 .
	gchªge_bss
 = 
¦si_chªge_bss
,

3636 .
	g¡¬t_­
 = 
¦si_¡¬t_­
,

3637 .
	gchªge_b—cÚ
 = 
¦si_chªge_b—cÚ
,

3638 .
	g¡İ_­
 = 
¦si_¡İ_­
,

3640 .
	gsched_sÿn_¡¬t
 = 
¦si_sched_sÿn_¡¬t
,

3641 .
	gsched_sÿn_¡İ
 = 
¦si_sched_sÿn_¡İ
,

3643 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 7, 0))

3644 .
	gmgmt_äame_»gi¡”
 = 
¦si_mgmt_äame_»gi¡”
,

3646 .
	gmgmt_tx
 = 
¦si_mgmt_tx
,

3647 .
	gmgmt_tx_ÿnûl_wa™
 = 
¦si_mgmt_tx_ÿnûl_wa™
,

3648 .
	g£t_txq_·¿ms
 = 
¦si_£t_txq_·¿ms
,

3649 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


3650 .
	gex‹º®_auth
 = 
¦si_synchrÚi£d_»¥Ú£
,

3652 #ifdeà
CONFIG_SCSC_WLAN_MAC_ACL_PER_MAC


3653 .
	g£t_mac_aş
 = 
¦si_£t_mac_aş_³r_mac
,

3655 .
	g£t_mac_aş
 = 
¦si_£t_mac_aş
,

3657 .
	gupd©e_á_›s
 = 
¦si_upd©e_á_›s
,

3658 .
	gtdls_İ”
 = 
¦si_tdls_İ”
,

3659 .
	g£t_mÚ™Ü_chªÃl
 = 
¦si_£t_mÚ™Ü_chªÃl
,

3660 .
	g£t_qos_m­
 = 
¦si_£t_qos_m­
,

3661 .
	gchªÃl_sw™ch
 = 
¦si_chªÃl_sw™ch


3664 
	#RATE_LEGACY
(
_¿‹
, 
_hw_v®ue
, 
_æags
) { \

3665 .
b™¿‹
 = (
_¿‹
), \

3666 .
hw_v®ue
 = (
_hw_v®ue
), \

3667 .
æags
 = (
_æags
), \

3668 }

	)

3670 
	#CHAN2G
(
_äeq
, 
_idx
) { \

3671 .
bªd
 = 
NL80211_BAND_2GHZ
, \

3672 .
ûÁ”_äeq
 = (
_äeq
), \

3673 .
hw_v®ue
 = (
_idx
), \

3674 .
max_pow”
 = 17, \

3675 }

	)

3677 
	#CHAN5G
(
_äeq
, 
_idx
) { \

3678 .
bªd
 = 
NL80211_BAND_5GHZ
, \

3679 .
ûÁ”_äeq
 = (
_äeq
), \

3680 .
hw_v®ue
 = (
_idx
), \

3681 .
max_pow”
 = 17, \

3682 }

	)

3684 
›“80211_chªÃl
 
	g¦si_2ghz_chªÃls
[] = {

3685 
CHAN2G
(2412, 1),

3686 
CHAN2G
(2417, 2),

3687 
CHAN2G
(2422, 3),

3688 
CHAN2G
(2427, 4),

3689 
CHAN2G
(2432, 5),

3690 
CHAN2G
(2437, 6),

3691 
CHAN2G
(2442, 7),

3692 
CHAN2G
(2447, 8),

3693 
CHAN2G
(2452, 9),

3694 
CHAN2G
(2457, 10),

3695 
CHAN2G
(2462, 11),

3696 
CHAN2G
(2467, 12),

3697 
CHAN2G
(2472, 13),

3698 
CHAN2G
(2484, 14),

3701 
›“80211_¿‹
 
	g¦si_11g_¿‹s
[] = {

3702 
RATE_LEGACY
(10, 1, 0),

3703 
RATE_LEGACY
(20, 2, 
IEEE80211_RATE_SHORT_PREAMBLE
),

3704 
RATE_LEGACY
(55, 3, 
IEEE80211_RATE_SHORT_PREAMBLE
),

3705 
RATE_LEGACY
(110, 6, 
IEEE80211_RATE_SHORT_PREAMBLE
),

3706 
RATE_LEGACY
(60, 4, 0),

3707 
RATE_LEGACY
(90, 5, 0),

3708 
RATE_LEGACY
(120, 7, 0),

3709 
RATE_LEGACY
(180, 8, 0),

3710 
RATE_LEGACY
(240, 9, 0),

3711 
RATE_LEGACY
(360, 10, 0),

3712 
RATE_LEGACY
(480, 11, 0),

3713 
RATE_LEGACY
(540, 12, 0),

3716 
›“80211_chªÃl
 
	g¦si_5ghz_chªÃls
[] = {

3718 
CHAN5G
(5180, 36),

3719 
CHAN5G
(5200, 40),

3720 
CHAN5G
(5220, 44),

3721 
CHAN5G
(5240, 48),

3723 
CHAN5G
(5260, 52),

3724 
CHAN5G
(5280, 56),

3725 
CHAN5G
(5300, 60),

3726 
CHAN5G
(5320, 64),

3728 
CHAN5G
(5500, 100),

3729 
CHAN5G
(5520, 104),

3730 
CHAN5G
(5540, 108),

3731 
CHAN5G
(5560, 112),

3732 
CHAN5G
(5580, 116),

3733 
CHAN5G
(5600, 120),

3734 
CHAN5G
(5620, 124),

3735 
CHAN5G
(5640, 128),

3736 
CHAN5G
(5660, 132),

3737 
CHAN5G
(5680, 136),

3738 
CHAN5G
(5700, 140),

3739 
CHAN5G
(5720, 144),

3741 
CHAN5G
(5745, 149),

3742 
CHAN5G
(5765, 153),

3743 
CHAN5G
(5785, 157),

3744 
CHAN5G
(5805, 161),

3745 
CHAN5G
(5825, 165),

3750 
›“80211_¿‹
 
	gwifi_11a_¿‹s
[] = {

3751 
RATE_LEGACY
(60, 4, 0),

3752 
RATE_LEGACY
(90, 5, 0),

3753 
RATE_LEGACY
(120, 7, 0),

3754 
RATE_LEGACY
(180, 8, 0),

3755 
RATE_LEGACY
(240, 9, 0),

3756 
RATE_LEGACY
(360, 10, 0),

3757 
RATE_LEGACY
(480, 11, 0),

3758 
RATE_LEGACY
(540, 12, 0),

3761 
›“80211_¡a_ht_ÿp
 
	g¦si_ht_ÿp
 = {

3762 .
ht_suµÜ‹d
 = 
Œue
,

3763 .
	gÿp
 = 
IEEE80211_HT_CAP_SUP_WIDTH_20_40
 |

3764 
IEEE80211_HT_CAP_LDPC_CODING
 |

3765 
IEEE80211_HT_CAP_RX_STBC
 |

3766 
IEEE80211_HT_CAP_GRN_FLD
 |

3767 
IEEE80211_HT_CAP_SGI_20
 |

3768 
IEEE80211_HT_CAP_SGI_40
,

3769 .
	gampdu_çùÜ
 = 
IEEE80211_HT_MAX_AMPDU_64K
,

3770 .
	gampdu_d’s™y
 = 
IEEE80211_HT_MPDU_DENSITY_4
,

3771 .
	gmcs
 = {

3772 .
rx_mask
 = { 0xff, 0, },

3773 .
	grx_highe¡
 = 
ıu_to_Ë16
(0),

3774 .
	gtx_·¿ms
 = 0,

3778 
›“80211_¡a_vht_ÿp
 
	g¦si_vht_ÿp
 = {

3779 .
vht_suµÜ‹d
 = 
Œue
,

3780 .
	gÿp
 = 
IEEE80211_VHT_CAP_MAX_MPDU_LENGTH_7991
 |

3781 
IEEE80211_VHT_CAP_SHORT_GI_80
 |

3782 
IEEE80211_VHT_CAP_RXSTBC_1
 |

3783 
IEEE80211_VHT_CAP_SU_BEAMFORMEE_CAPABLE
 |

3784 (5 << 
IEEE80211_VHT_CAP_MAX_A_MPDU_LENGTH_EXPONENT_SHIFT
),

3785 .
	gvht_mcs
 = {

3786 .
rx_mcs_m­
 = 
ıu_to_Ë16
(0xfffe),

3787 .
	grx_highe¡
 = 
ıu_to_Ë16
(0),

3788 .
	gtx_mcs_m­
 = 
ıu_to_Ë16
(0xfffe),

3789 .
	gtx_highe¡
 = 
ıu_to_Ë16
(0),

3793 
›“80211_suµÜ‹d_bªd
 
	g¦si_bªd_2ghz
 = {

3794 .
chªÃls
 = 
¦si_2ghz_chªÃls
,

3795 .
	gbªd
 = 
NL80211_BAND_2GHZ
,

3796 .
	gn_chªÃls
 = 
ARRAY_SIZE
(
¦si_2ghz_chªÃls
),

3797 .
	gb™¿‹s
 = 
¦si_11g_¿‹s
,

3798 .
	gn_b™¿‹s
 = 
ARRAY_SIZE
(
¦si_11g_¿‹s
),

3801 
›“80211_suµÜ‹d_bªd
 
	g¦si_bªd_5ghz
 = {

3802 .
chªÃls
 = 
¦si_5ghz_chªÃls
,

3803 .
	gbªd
 = 
NL80211_BAND_5GHZ
,

3804 .
	gn_chªÃls
 = 
ARRAY_SIZE
(
¦si_5ghz_chªÃls
),

3805 .
	gb™¿‹s
 = 
wifi_11a_¿‹s
,

3806 .
	gn_b™¿‹s
 = 
ARRAY_SIZE
(
wifi_11a_¿‹s
),

3809 cÚ¡ 
u32
 
	g¦si_ch”_su™es
[] = {

3810 
WLAN_CIPHER_SUITE_WEP40
,

3811 
WLAN_CIPHER_SUITE_WEP104
,

3812 
WLAN_CIPHER_SUITE_TKIP
,

3813 
WLAN_CIPHER_SUITE_CCMP
,

3814 
WLAN_CIPHER_SUITE_AES_CMAC
,

3815 
WLAN_CIPHER_SUITE_SMS4
,

3816 
WLAN_CIPHER_SUITE_PMK
,

3817 
WLAN_CIPHER_SUITE_GCMP
,

3818 
WLAN_CIPHER_SUITE_GCMP_256
,

3819 
WLAN_CIPHER_SUITE_CCMP_256
,

3820 
WLAN_CIPHER_SUITE_BIP_GMAC_128
,

3821 
WLAN_CIPHER_SUITE_BIP_GMAC_256


3824 cÚ¡ 
›“80211_txrx_¡y³s


3825 
	g›“80211_deçuÉ_mgmt_¡y³s
[
NUM_NL80211_IFTYPES
] = {

3826 [
NL80211_IFTYPE_AP
] = {

3827 .
tx
 = 0xffff,

3828 .
	grx
 = 
BIT
(
IEEE80211_STYPE_ACTION
 >> 4) |

3829 
BIT
(
IEEE80211_STYPE_AUTH
 >> 4)

3831 [
NL80211_IFTYPE_STATION
] = {

3832 .
tx
 = 0xffff,

3833 .
	grx
 = 
BIT
(
IEEE80211_STYPE_ACTION
 >> 4) |

3834 
BIT
(
IEEE80211_STYPE_PROBE_REQ
 >> 4) |

3835 
BIT
(
IEEE80211_STYPE_AUTH
 >> 4)

3837 [
NL80211_IFTYPE_P2P_GO
] = {

3838 .
tx
 = 0xffff,

3839 .
	grx
 = 
BIT
(
IEEE80211_STYPE_ACTION
 >> 4) |

3840 
BIT
(
IEEE80211_STYPE_PROBE_REQ
 >> 4)

3842 [
NL80211_IFTYPE_P2P_CLIENT
] = {

3843 .
tx
 = 0xffff,

3844 .
	grx
 = 
BIT
(
IEEE80211_STYPE_ACTION
 >> 4)

3849 
›“80211_içû_lim™
 
	giçû_lim™s
[] = {

3850 #ifdeà
CONFIG_SCSC_WLAN_STA_ONLY


3853 .
max
 = 
CONFIG_SCSC_WLAN_MAX_INTERFACES
,

3854 .
	gty³s
 = 
BIT
(
NL80211_IFTYPE_STATION
),

3859 .
	gmax
 = 1,

3860 .
	gty³s
 = 
BIT
(
NL80211_IFTYPE_AP
),

3867 .
	gmax
 = 
CONFIG_SCSC_WLAN_MAX_INTERFACES
,

3868 .
	gty³s
 = 
BIT
(
NL80211_IFTYPE_STATION
),

3871 .
	gmax
 = 1,

3872 .
	gty³s
 = 
BIT
(
NL80211_IFTYPE_P2P_CLIENT
è| BIT(
NL80211_IFTYPE_P2P_GO
),

3876 .
	gmax
 = 1,

3877 .
	gty³s
 = 
BIT
(
NL80211_IFTYPE_ADHOC
),

3882 
›“80211_»gdomaš
 
	g¦si_»gdomaš
 = {

3883 .
»g_ruËs
 = {

3884 
REG_RULE
(0, 0, 0, 0, 0, 0),

3885 
REG_RULE
(0, 0, 0, 0, 0, 0),

3886 
REG_RULE
(0, 0, 0, 0, 0, 0),

3887 
REG_RULE
(0, 0, 0, 0, 0, 0),

3888 
REG_RULE
(0, 0, 0, 0, 0, 0),

3889 
REG_RULE
(0, 0, 0, 0, 0, 0),

3890 
REG_RULE
(0, 0, 0, 0, 0, 0),

3891 
REG_RULE
(0, 0, 0, 0, 0, 0),

3892 
REG_RULE
(0, 0, 0, 0, 0, 0),

3893 
REG_RULE
(0, 0, 0, 0, 0, 0),

3894 
REG_RULE
(0, 0, 0, 0, 0, 0),

3895 
REG_RULE
(0, 0, 0, 0, 0, 0),

3896 
REG_RULE
(0, 0, 0, 0, 0, 0),

3897 
REG_RULE
(0, 0, 0, 0, 0, 0),

3898 
REG_RULE
(0, 0, 0, 0, 0, 0),

3899 
REG_RULE
(0, 0, 0, 0, 0, 0),

3900 
REG_RULE
(0, 0, 0, 0, 0, 0),

3901 
REG_RULE
(0, 0, 0, 0, 0, 0),

3902 
REG_RULE
(0, 0, 0, 0, 0, 0),

3903 
REG_RULE
(0, 0, 0, 0, 0, 0),

3907 
›“80211_içû_combš©iÚ
 
	giçû_comb
[] = {

3909 .
lim™s
 = 
içû_lim™s
,

3910 .
	gn_lim™s
 = 
ARRAY_SIZE
(
içû_lim™s
),

3911 .
	gnum_difã»Á_chªÃls
 = 2,

3912 .
	gmax_š‹rçûs
 = 
CONFIG_SCSC_WLAN_MAX_INTERFACES
,

3916 #ifdeà
CONFIG_PM


3917 
cfg80211_wowÏn
 
	g¦si_wowÏn_cÚfig
 = {

3918 .
ªy
 = 
Œue
,

3922 
¦si_dev
 *
	$¦si_cfg80211_Ãw
(
deviû
 *
dev
)

3924 
why
 *wiphy;

3925 
¦si_dev
 *
sdev
 = 
NULL
;

3927 
	`SLSI_DBG1_NODEV
(
SLSI_CFG80211
, "wiphy_new()\n");

3928 
why
 = 
	`why_Ãw
(&
¦si_İs
, (
¦si_dev
));

3929 ià(!
why
) {

3930 
	`SLSI_ERR_NODEV
("wiphy_new() failed");

3931  
NULL
;

3934 
sdev
 = (
¦si_dev
 *)
why
->
´iv
;

3936 
sdev
->
why
 = wiphy;

3938 
	`£t_why_dev
(
why
, 
dev
);

3941 
why
->
æags
 |ğ
WIPHY_FLAG_NETNS_OK
;

3942 
why
->
æags
 |ğ
WIPHY_FLAG_PS_ON_BY_DEFAULT
;

3943 
why
->
æags
 |ğ
WIPHY_FLAG_CONTROL_PORT_PROTOCOL
;

3944 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

3945 
why
->
æags
 |ğ
WIPHY_FLAG_SUPPORTS_FW_ROAM
;

3947 
why
->
æags
 |ğ
WIPHY_FLAG_HAS_CHANNEL_SWITCH
;

3948 
why
->
max_num_c§_couÁ”s
 = 0;

3950 
why
->
æags
 |ğ
WIPHY_FLAG_HAVE_AP_SME
 |

3951 
WIPHY_FLAG_AP_PROBE_RESP_OFFLOAD
 |

3952 
WIPHY_FLAG_AP_UAPSD
;

3954 
why
->
max_aş_mac_addrs
 = 
SLSI_AP_PEER_CONNECTIONS_MAX
;

3956 
why
->
´ivid
 = 
sdev
;

3958 
why
->
š‹rçû_modes
 =

3959 #ifdeà
CONFIG_SCSC_WLAN_STA_ONLY


3960 
	`BIT
(
NL80211_IFTYPE_STATION
);

3962 
	`BIT
(
NL80211_IFTYPE_P2P_GO
) |

3963 
	`BIT
(
NL80211_IFTYPE_P2P_CLIENT
) |

3964 
	`BIT
(
NL80211_IFTYPE_STATION
) |

3965 
	`BIT
(
NL80211_IFTYPE_AP
) |

3966 
	`BIT
(
NL80211_IFTYPE_MONITOR
) |

3967 
	`BIT
(
NL80211_IFTYPE_ADHOC
);

3969 
¦si_bªd_2ghz
.
ht_ÿp
 = 
¦si_ht_ÿp
;

3970 
¦si_bªd_5ghz
.
ht_ÿp
 = 
¦si_ht_ÿp
;

3971 
¦si_bªd_5ghz
.
vht_ÿp
 = 
¦si_vht_ÿp
;

3973 
why
->
sigÇl_ty³
 = 
CFG80211_SIGNAL_TYPE_MBM
;

3975 
why
->
bªds
[
NL80211_BAND_2GHZ
] = &
¦si_bªd_2ghz
;

3976 
why
->
bªds
[
NL80211_BAND_5GHZ
] = &
¦si_bªd_5ghz
;

3978 
	`mem£t
(&
sdev
->
deviû_cÚfig
, 0, (
¦si_dev_cÚfig
));

3979 
sdev
->
deviû_cÚfig
.
bªd_5G
 = &
¦si_bªd_5ghz
;

3980 
sdev
->
deviû_cÚfig
.
bªd_2G
 = &
¦si_bªd_2ghz
;

3981 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
 = &
¦si_»gdomaš
;

3983 
why
->
æags
 |ğ
WIPHY_FLAG_HAS_REMAIN_ON_CHANNEL
;

3984 
why
->
max_»maš_Ú_chªÃl_du¿tiÚ
 = 5000;

3986 
why
->
ch”_su™es
 = 
¦si_ch”_su™es
;

3987 
why
->
n_ch”_su™es
 = 
	`ARRAY_SIZE
(
¦si_ch”_su™es
);

3989 
why
->
ex‹nded_ÿ·b™›s
 = 
¦si_ex‹nded_ÿp
;

3990 
why
->
ex‹nded_ÿ·b™›s_mask
 = 
¦si_ex‹nded_ÿp_mask
;

3991 
why
->
ex‹nded_ÿ·b™›s_Ën
 = 
	`ARRAY_SIZE
(
¦si_ex‹nded_ÿp
);

3993 
why
->
mgmt_¡y³s
 = 
›“80211_deçuÉ_mgmt_¡y³s
;

3996 
why
->
n_içû_combš©iÚs
 = 
	`ARRAY_SIZE
(
içû_comb
);

3997 
why
->
içû_combš©iÚs
 = 
içû_comb
;

4000 
why
->
max_sÿn_ssids
 = 10;

4001 
why
->
max_sÿn_›_Ën
 = 2048;

4003 #ià(
LINUX_VERSION_CODE
 <ğ
	`KERNEL_VERSION
(4, 11, 0))

4005 
why
->
æags
 |ğ
WIPHY_FLAG_SUPPORTS_SCHED_SCAN
;

4008 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 11, 0))

4010 
why
->
max_sched_sÿn_»qs
 = 1;

4011 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 4, 0))

4012 #ifdeà
CONFIG_SCSC_WLAN_EXPONENTIAL_SCHED_SCAN


4013 
why
->
max_sched_sÿn_¶ªs
 = 2;

4014 
why
->
max_sched_sÿn_¶ª_š‹rv®
 = 60;

4015 
why
->
max_sched_sÿn_¶ª_™”©iÚs
 = 3;

4018 
	`why_ext_ã©u»_£t
(
why
, 
NL80211_EXT_FEATURE_SCHED_SCAN_RELATIVE_RSSI
);

4021 
	`why_ext_ã©u»_£t
(
why
, 
NL80211_EXT_FEATURE_MGMT_TX_RANDOM_TA
);

4025 
why
->
max_sched_sÿn_ssids
 = 16;

4028 
why
->
max_m©ch_£ts
 = 16;

4030 
why
->
max_sched_sÿn_›_Ën
 = 2048;

4032 #ifdeà
CONFIG_PM


4033 
why
->
wowÏn
 = 
NULL
;

4034 
why
->
wowÏn_cÚfig
 = &
¦si_wowÏn_cÚfig
;

4037 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 19, 0))

4038 
why
->
»guÏtÜy_æags
 |ğ(
REGULATORY_STRICT_REG
 |

4039 
REGULATORY_CUSTOM_REG
 |

4040 
REGULATORY_DISABLE_BEACON_HINTS
 |

4041 
REGULATORY_COUNTRY_IE_IGNORE
);

4043 
why
->
»guÏtÜy_æags
 |ğ(
REGULATORY_STRICT_REG
 |

4044 
REGULATORY_CUSTOM_REG
 |

4045 
REGULATORY_DISABLE_BEACON_HINTS
);

4047 #iâdeà
CONFIG_SCSC_WLAN_STA_ONLY


4049 
why
->
æags
 |ğ
WIPHY_FLAG_OFFCHAN_TX
;

4052 
why
->
´obe_»¥_ofæßd
 |=

4053 
NL80211_PROBE_RESP_OFFLOAD_SUPPORT_WPS
 |

4054 
NL80211_PROBE_RESP_OFFLOAD_SUPPORT_WPS2
 |

4055 
NL80211_PROBE_RESP_OFFLOAD_SUPPORT_P2P
;

4058 
why
->
æags
 |ğ
WIPHY_FLAG_SUPPORTS_TDLS
;

4061 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


4062 
why
->
ã©u»s
 |ğ
NL80211_FEATURE_SCAN_RANDOM_MAC_ADDR
;

4063 
why
->
ã©u»s
 |ğ
NL80211_FEATURE_SCHED_SCAN_RANDOM_MAC_ADDR
;

4065 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


4066 
why
->
ã©u»s
 |ğ
NL80211_FEATURE_SAE
;

4068 #ifdeà
CONFIG_SCSC_WLAN_HE


4070 
why
->
suµÜt_mbssid
 = 1;

4071 
why
->
suµÜt_Úly_he_mbssid
 = 1;

4073  
sdev
;

4074 
	}
}

4076 
	$¦si_cfg80211_»gi¡”
(
¦si_dev
 *
sdev
)

4078 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "wiphy_register()\n");

4079  
	`why_»gi¡”
(
sdev
->
why
);

4080 
	}
}

4082 
	$¦si_cfg80211_uÄegi¡”
(
¦si_dev
 *
sdev
)

4084 #ifdeà
CONFIG_PM


4085 
sdev
->
why
->
wowÏn
 = 
NULL
;

4086 
sdev
->
why
->
wowÏn_cÚfig
 = 
NULL
;

4088 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "wiphy_unregister()\n");

4089 
	`why_uÄegi¡”
(
sdev
->
why
);

4090 
	}
}

4092 
	$¦si_cfg80211_ä“
(
¦si_dev
 *
sdev
)

4094 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "wiphy_free()\n");

4095 
	`why_ä“
(
sdev
->
why
);

4096 
	}
}

4098 
	$¦si_cfg80211_upd©e_why
(
¦si_dev
 *
sdev
)

4102 
sdev
->
why
->
bªds
[
NL80211_BAND_2GHZ
] = &
¦si_bªd_2ghz
;

4103 
sdev
->
deviû_cÚfig
.
bªd_2G
 = &
¦si_bªd_2ghz
;

4106 ià(
sdev
->
bªd_5g_suµÜ‹d
) {

4107 
sdev
->
why
->
bªds
[
NL80211_BAND_5GHZ
] = &
¦si_bªd_5ghz
;

4108 
sdev
->
deviû_cÚfig
.
bªd_5G
 = &
¦si_bªd_5ghz
;

4109 
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
 = 
SLSI_FREQ_BAND_AUTO
;

4111 
sdev
->
why
->
bªds
[
NL80211_BAND_5GHZ
] = 
NULL
;

4112 
sdev
->
deviû_cÚfig
.
bªd_5G
 = 
NULL
;

4113 
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
 = 
SLSI_FREQ_BAND_2GHZ
;

4117 ià(
sdev
->
fw_ht_’abËd
) {

4118 
¦si_ht_ÿp
.
ht_suµÜ‹d
 = 
Œue
;

4119 
¦si_ht_ÿp
.
ÿp
 = 
	`Ë16_to_ıu
(*(
u16
 *)
sdev
->
fw_ht_ÿp
);

4120 
¦si_ht_ÿp
.
ampdu_d’s™y
 = (
sdev
->
fw_ht_ÿp
[2] & 
IEEE80211_HT_AMPDU_PARM_DENSITY
è>> 
IEEE80211_HT_AMPDU_PARM_DENSITY_SHIFT
;

4121 
¦si_ht_ÿp
.
ampdu_çùÜ
 = 
sdev
->
fw_ht_ÿp
[2] & 
IEEE80211_HT_AMPDU_PARM_FACTOR
;

4123 
¦si_ht_ÿp
.
ht_suµÜ‹d
 = 
çl£
;

4125 
¦si_bªd_2ghz
.
ht_ÿp
 = 
¦si_ht_ÿp
;

4126 
¦si_bªd_5ghz
.
ht_ÿp
 = 
¦si_ht_ÿp
;

4129 ià(
sdev
->
fw_vht_’abËd
) {

4130 
¦si_vht_ÿp
.
vht_suµÜ‹d
 = 
Œue
;

4131 
¦si_vht_ÿp
.
ÿp
 = 
	`Ë32_to_ıu
(*(
u32
 *)
sdev
->
fw_vht_ÿp
);

4133 
¦si_vht_ÿp
.
vht_suµÜ‹d
 = 
çl£
;

4135 
¦si_bªd_5ghz
.
vht_ÿp
 = 
¦si_vht_ÿp
;

4137 
	`SLSI_INFO
(
sdev
, "BANDS SUPPORTED -> 2.4:'%c' 5:'%c'\n", sdev->
why
->
bªds
[
NL80211_BAND_2GHZ
] ? 'Y' : 'N',

4138 
sdev
->
why
->
bªds
[
NL80211_BAND_5GHZ
] ? 'Y' : 'N');

4139 
	`SLSI_INFO
(
sdev
, "HT/VHT SUPPORTED -> HT:'%c' VHT:'%c'\n", sdev->
fw_ht_’abËd
 ? 'Y' : 'N',

4140 
sdev
->
fw_vht_’abËd
 ? 'Y' : 'N');

4141 
	`SLSI_INFO
(
sdev
, "HT -> c­:0x%04x‡mpdu_d’s™y:%d‡mpdu_çùÜ:%d\n", 
¦si_ht_ÿp
.
ÿp
, slsi_ht_ÿp.
ampdu_d’s™y
, slsi_ht_ÿp.
ampdu_çùÜ
);

4142 
	`SLSI_INFO
(
sdev
, "VHT -> c­:0x%08x\n", 
¦si_vht_ÿp
.
ÿp
);

4143 
	}
}

	@cfg80211_ops.h

7 #iâdeà
__SLSI_CFG80211_OPS_H__


8 
	#__SLSI_CFG80211_OPS_H__


	)

10 
	~<Ãt/cfg80211.h
>

12 
	g¦si_dev
;

14 
	#SDEV_FROM_WIPHY
(
why
è((
¦si_dev
 *)(why)->
´iv
)

	)

15 
	#WLAN_CIPHER_SUITE_PMK
 0x00904C00

	)

17 
	#SLSI_WPS_REQUEST_TYPE_POS
 15

	)

18 
	#SLSI_WPS_REQUEST_TYPE_ENROLEE_INFO_ONLY
 0x00

	)

19 
	#SLSI_WPS_OUI_PATTERN
 0x04F25000

	)

20 
	#SLSI_P2P_OUI_PATTERN
 0x099a6f50

	)

21 
	#SLSI_VENDOR_OUI_AND_TYPE_LEN
 4

	)

22 
	#PMKID_LEN
 16

	)

23 
	#RSN_SELECTOR_LEN
 4

	)

24 #ifdeà
CONFIG_SCSC_WLAN_MAC_ACL_PER_MAC


25 
	#SLSI_ACL_MAX_BSSID_COUNT
 255

	)

28 
¦si_dev
 *
¦si_cfg80211_Ãw
(
deviû
 *
dev
);

29 
¦si_cfg80211_»gi¡”
(
¦si_dev
 *
sdev
);

30 
¦si_cfg80211_uÄegi¡”
(
¦si_dev
 *
sdev
);

31 
¦si_cfg80211_ä“
(
¦si_dev
 *
sdev
);

32 
¦si_cfg80211_upd©e_why
(
¦si_dev
 *
sdev
);

33 
¦si_wÏn_mgmt_tx
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

34 
›“80211_chªÃl
 *
chª
, 
wa™
,

35 cÚ¡ 
u8
 *
buf
, 
size_t
 
Ën
, 
boŞ
 
dÚt_wa™_fÜ_ack
, 
u64
 *
cook›
);

	@cm_if.c

9 
	~"mgt.h
"

10 
	~"dev.h
"

11 
	~"debug.h
"

12 
	~"scsc_wifi_cm_if.h
"

13 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


14 
	~"h4_§m¶”.h
"

16 
	~<lšux/fs.h
>

18 
	~<scsc/scsc_mx.h
>

19 #ià
IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

20 
	~<scsc/scsc_log_cŞËùÜ.h
>

23 #ià
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 4, 0)

24 
MODULE_IMPORT_NS
(
VFS_š‹º®_I_am_»®ly_a_fesy¡em_ªd_am_NOT_a_driv”
);

27 
boŞ
 
	gEÇbËTe¡Mode
;

28 
moduË_·¿m
(
EÇbËTe¡Mode
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

29 
MODULE_PARM_DESC
(
EÇbËTe¡Mode
, "Enable WlanLiteest mode driver.");

31 
BLOCKING_NOTIFIER_HEAD
(
¦si_wÏn_nÙif›r
);

33 
mu‹x
 
	g¦si_¡¬t_mu‹x
;

34 
	g»cov”y_š_´og»ss
;

35 
u16
 
	gÏ‹¡_scsc_·nic_code
;

37 
	#SLSI_RETRY_STOP_COUNT_ERROR
 1

	)

40 
	s¦si_cm_ùx
 {

41 
¦si_dev
 *
	msdev
;

45 
¦si_cm_ùx
 
	gcm_ùx
;

47 
¦si_h_block_bh
(
¦si_dev
 *
sdev
);

49 #ifdeà
CONFIG_SEC_FACTORY


51 
	gçùÜy_wifi_di§bË
;

52 
	$¦si_şo£_wifi_£t
(cÚ¡ *
v®
, cÚ¡ 
k”Ãl_·¿m
 *
kp
)

54 
Ãt_deviû
 *
dev
 = 
cm_ùx
.
sdev
->
Ãtdev
[
SLSI_NET_INDEX_WLAN
];

55 
Ãtdev_vif
 *
ndev_vif
;

57 ià(!
dev
) {

58 
	`SLSI_ERR_NODEV
("factoryest wlan set failed\n");

62 
çùÜy_wifi_di§bË
 = 
v®
[0];

63 ià(!(
çùÜy_wifi_di§bË
 == '1' || factory_wifi_disable == 'Y' || factory_wifi_disable == 'y'))

66 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

67 ià(!
ndev_vif
->
is_avaabË
) {

68 
	`SLSI_INFO_NODEV
("factoryest wlan is disabled‡lready\n");

72 
	`¹Æ_lock
();

73 
	`dev_şo£
(
cm_ùx
.
sdev
->
Ãtdev
[
SLSI_NET_INDEX_WLAN
]);

74 
	`¹Æ_uÆock
();

77 
	}
}

79 cÚ¡ 
k”Ãl_·¿m_İs
 
	g¦si_çùÜy_‹¡_İs
 = {

80 .
£t
 = &
¦si_şo£_wifi_£t
,

82 
moduË_·¿m_cb
(
çùÜy_wifi_di§bË
, &
¦si_çùÜy_‹¡_İs
, &çùÜy_wifi_di§bË, 
S_IRUGO
 | 
S_IWUSR
);

83 
MODULE_PARM_DESC
(
çùÜy_wifi_di§bË
, "factoryest wifiƒnable/disable ops");

86 
	$¦si_wÏn_£rviû_nÙif›r_»gi¡”
(
nÙif›r_block
 *
nb
)

88  
	`blockšg_nÙif›r_chaš_»gi¡”
(&
¦si_wÏn_nÙif›r
, 
nb
);

89 
	}
}

91 
	$¦si_wÏn_£rviû_nÙif›r_uÄegi¡”
(
nÙif›r_block
 *
nb
)

93  
	`blockšg_nÙif›r_chaš_uÄegi¡”
(&
¦si_wÏn_nÙif›r
, 
nb
);

94 
	}
}

96 
	$wÏn_su¥’d
(
scsc_£rviû_ş›Á
 *
ş›Á
)

98 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
ş›Á
, ¦si_dev, 
mx_wÏn_ş›Á
);

100 
	`SLSI_INFO_NODEV
("Nofity„egistered functions\n");

101 
	`blockšg_nÙif›r_ÿÎ_chaš
(&
¦si_wÏn_nÙif›r
, 
SCSC_WIFI_SUSPEND
, 
sdev
);

104 
	}
}

106 
	$wÏn_»sume
(
scsc_£rviû_ş›Á
 *
ş›Á
)

108 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
ş›Á
, ¦si_dev, 
mx_wÏn_ş›Á
);

110 
	`SLSI_INFO_NODEV
("Nofity„egistered functions\n");

111 
	`blockšg_nÙif›r_ÿÎ_chaš
(&
¦si_wÏn_nÙif›r
, 
SCSC_WIFI_RESUME
, 
sdev
);

114 
	}
}

116 
	$¦si_­³nd_log_to_sy¡em_bufãr
(
¦si_dev
 *
sdev
)

118 
pos
 = 0;

119 
buf_size
 = 128;

120 
i
 = 0;

121 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

122 
Ãtdev_vif
 *
ndev_vif
;

124 
pos
 = 
	`sú´štf
(
log_to_sys_”rÜ_bufãr
, 
buf_size
, "Ãtdev_up_couÁ=%d ", 
sdev
->
Ãtdev_up_couÁ
);

126 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

127 ià(
sdev
->
Ãtdev
[
i
]) {

128 
ndev_vif
 = 
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
i
]);

129 ià(
ndev_vif
->
is_avaabË
)

130 
pos
 +ğ
	`sú´štf
(
log_to_sys_”rÜ_bufãr
 +…os, 
buf_size
 -…os, "[%d: vif_ty³ = %d] ", 
i
, 
ndev_vif
->
vif_ty³
);

133 
pos
 +ğ
	`sú´štf
(
log_to_sys_”rÜ_bufãr
 +…os, 
buf_size
 -…os, "\n");

134 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

135 
	}
}

137 
u8
 
	$wÏn_çu»_nÙifiÿtiÚ
(
scsc_£rviû_ş›Á
 *
ş›Á
, 
mx_sy£¼_decode
 *
”r
)

139 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
ş›Á
, ¦si_dev, 
mx_wÏn_ş›Á
);

140 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

142 
	`©omic_£t
(&
sdev
->
cm_if
.
»£t_Ëv–
, 
”r
->
Ëv–
);

143 
	`SLSI_INFO_NODEV
("SubSy¡em:%d,Lev–:%d,Ty³:%d,Sub_code:%d\n", 
”r
->
subsys
,ƒ¼->
Ëv–
,ƒ¼->
ty³
,ƒ¼->
subcode
);

145 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s: SubSystem:%d,Level:%d,Type:%d,Sub_code:%d\n",

146 
__func__
, 
”r
->
subsys
,ƒ¼->
Ëv–
,ƒ¼->
ty³
,ƒ¼->
subcode
);

147 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

149  
”r
->
Ëv–
;

150 
	}
}

152 
	$wÏn_çu»_»£t_v2
(
scsc_£rviû_ş›Á
 *
ş›Á
, 
u8
 
Ëv–
, 
u16
 
scsc_sy£¼_code
)

154 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
ş›Á
, ¦si_dev, 
mx_wÏn_ş›Á
);

155 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

157 
	`SLSI_INFO_NODEV
("Lev–:%d scsc_sy£¼_code:%d\n", 
Ëv–
, 
scsc_sy£¼_code
);

159 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s: Lev–:%d scsc_sy£¼_code:%d\n", 
__func__
, 
Ëv–
, 
scsc_sy£¼_code
);

160 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

162 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

163 
	`©omic_£t
(&
sdev
->
cm_if
.
»£t_Ëv–
, 
Ëv–
);

164 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

165 ià(
Ëv–
 < 5) {

166 
	`SLSI_WARN_NODEV
("Low†ev–ƒ¼Ü†ev–:%d\n", 
Ëv–
);

167 } ià(
Ëv–
 == 5 ||†evel == 6) {

168 
	`blockšg_nÙif›r_ÿÎ_chaš
(&
¦si_wÏn_nÙif›r
, 
SCSC_WIFI_SUBSYSTEM_RESET
, 
sdev
);

169 } ià(
Ëv–
 =ğ
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
) {

170 #iâdeà
SCSC_SEP_VERSION


171 ià(
sdev
->
fÜûd_£_7
) {

172 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

173 
	`©omic_£t
(&
sdev
->
cm_if
.
»£t_Ëv–
, 7);

174 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

176 
sdev
->
fÜûd_£_7
 = 
çl£
;

178 
Ï‹¡_scsc_·nic_code
 = 
scsc_sy£¼_code
;

180 
	}
}

182 
boŞ
 
	$wÏn_¡İ_Ú_çu»_v2
(
scsc_£rviû_ş›Á
 *
ş›Á
, 
mx_sy£¼_decode
 *
”r
)

184 
¡©e
;

185 
u8
 
sy¡em_”rÜ_Ëv–
;

186 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
ş›Á
, ¦si_dev, 
mx_wÏn_ş›Á
);

187 #iâdeà
SCSC_SEP_VERSION


188 
Ãtdev_vif
 *
wÏn_dev_vif
;

190 #ifdeà
CONFIG_SCSC_WLAN_AP_AUTO_RECOVERY


191 
Ãtdev_vif
 *
ndev_vif
;

192 
i
;

195 
	`SLSI_INFO_NODEV
("¡©e:%d,ƒ¼_Ëv–:%d\n", 
sdev
->
cm_if
.
cm_if_¡©e
, 
”r
->
Ëv–
);

196 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

197 
»cov”y_š_´og»ss
 = 1;

198 
sdev
->
»cov”y_¡©us
 = 1;

199 #iâdeà
SCSC_SEP_VERSION


200 
sdev
->
fÜûd_£_7
 = 
çl£
;

203 
	`¦si_­³nd_log_to_sy¡em_bufãr
(
sdev
);

205 
	`»š™_com¶‘iÚ
(&
sdev
->
»cov”y_com¶‘ed
);

207 
¡©e
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
cm_if_¡©e
);

208 
	`©omic_£t
(&
sdev
->
cm_if
.
»£t_Ëv–
, 
”r
->
Ëv–
);

212 
sy¡em_”rÜ_Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

213 ià(!
sy¡em_”rÜ_Ëv–
 || sy¡em_”rÜ_Ëv– =ğ
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
) {

214 
	`©omic_£t
(&
sdev
->
cm_if
.
»£t_Ëv–
, 
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
);

215 #iâdeà
SCSC_SEP_VERSION


220 ià(
sdev
->
Ãtdev_up_couÁ
 =ğ1 && sdev->
Ãtdev
[
SLSI_NET_INDEX_WLAN
]) {

221 
wÏn_dev_vif
 = 
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_WLAN
]);

222 ià(
wÏn_dev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_AP
 && wÏn_dev_vif->
is_avaabË
) {

223 
	`©omic_£t
(&
sdev
->
cm_if
.
»£t_Ëv–
, 7);

224 
sdev
->
fÜûd_£_7
 = 
Œue
;

225 
	`SLSI_INFO_NODEV
("Reducing„eset†evel: L8->L7\n");

230 ià(
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STOPPED
) {

231 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_BLOCKED
);

232 
sdev
->
ç_»pÜ‹d
 = 
Œue
;

238 ià(
sdev
->
»cov”y_Ãxt_¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STOPPING
) {

239 
	`¦si_h_block_bh
(
sdev
);

242 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

243 
	`SLSI_INFO_NODEV
("Nofity„egistered functions\n");

244 
	`blockšg_nÙif›r_ÿÎ_chaš
(&
¦si_wÏn_nÙif›r
, 
SCSC_WIFI_STOP
, 
sdev
);

245 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

246 #ifdeà
CONFIG_SCSC_WLAN_AP_AUTO_RECOVERY


247 
sy¡em_”rÜ_Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

248 ià(
sy¡em_”rÜ_Ëv–
 =ğ
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
)

249 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++)

250 ià(
sdev
->
Ãtdev
[
i
]) {

251 
ndev_vif
 = 
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
i
]);

252 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_AP
) {

253 ià(
	`¦si_£nd_hªged_v’dÜ_ev’t
(
sdev
,

254 
Ï‹¡_scsc_·nic_code
) < 0)

255 
	`SLSI_ERR
(
sdev
, "Failedo send hangƒvent\n");

262 
	`SLSI_INFO_NODEV
("Wi-Fi service driver‚ot started\n");

265 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

266 
	`SLSI_INFO_NODEV
("Done!\n");

267  
Œue
;

268 
	}
}

273 
	$¦si_wÏn_£rviû_´obe
(
scsc_mx_moduË_ş›Á
 *
moduË_ş›Á
, 
scsc_mx
 *
mx
, 
scsc_moduË_ş›Á_»asÚ
 
»asÚ
)

275 
¦si_dev
 *
sdev
;

276 
deviû
 *
dev
;

277 
scsc_£rviû_ş›Á
 
mx_wÏn_ş›Á
;

278 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

279 
buf
[
SCSC_LOG_FAPI_VERSION_SIZE
];

281 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

283 
	`SLSI_UNUSED_PARAMETER
(
moduË_ş›Á
);

285 
	`SLSI_INFO_NODEV
("WLAN service…robe\n");

287 
	`mem£t
((*è&
mx_wÏn_ş›Á
, 0, (
size_t
) (mx_wlan_client));

288 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

290 ià(
»asÚ
 =ğ
SCSC_MODULE_CLIENT_REASON_RECOVERY
 && !
»cov”y_š_´og»ss
)

291 
dÚe
;

293 ià(
»asÚ
 =ğ
SCSC_MODULE_CLIENT_REASON_RECOVERY
) {

294 
	`SLSI_INFO_NODEV
("Probe„ecovery\n");

295 
sdev
 = 
cm_ùx
.sdev;

296 
»cov”y_š_´og»ss
 = 0;

297 
sdev
->
ç_»pÜ‹d
 = 
çl£
;

298 
sdev
->
»cov”y_¡©us
 = 0;

299 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

300 
	`blockšg_nÙif›r_ÿÎ_chaš
(&
¦si_wÏn_nÙif›r
, 
SCSC_WIFI_CHIP_READY
, 
sdev
);

301 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

302 
	`com¶‘e_®l
(&
sdev
->
»cov”y_com¶‘ed
);

303 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s:„ecov”y_com¶‘ed\n", 
__func__
);

304 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

307 
mx_wÏn_ş›Á
.
çu»_nÙifiÿtiÚ
 = 
wÏn_çu»_nÙifiÿtiÚ
;

308 
mx_wÏn_ş›Á
.
¡İ_Ú_çu»_v2
 = 
wÏn_¡İ_Ú_çu»_v2
;

309 
mx_wÏn_ş›Á
.
çu»_»£t_v2
 = 
wÏn_çu»_»£t_v2
;

310 
mx_wÏn_ş›Á
.
su¥’d
 = 
wÏn_su¥’d
;

311 
mx_wÏn_ş›Á
.
»sume
 = 
wÏn_»sume
;

313 
dev
 = 
	`scsc_£rviû_g‘_deviû_by_mx
(
mx
);

320 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

321 
sdev
 = 
	`¦si_dev_©ch
(
dev
, 
mx
, &
mx_wÏn_ş›Á
);

322 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

323 ià(!
sdev
) {

324 
	`SLSI_ERR_NODEV
("WLAN‡ttach failed - slsi_dev_attach\n");

325 
dÚe
;

328 
cm_ùx
.
sdev
 = sdev;

330 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_PROBING
);

331 
	`g‘_deviû
(
dev
);

333 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


334 
	`h4_§m¶”_ü—‹
(
sdev
, 
mx
);

336 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

337 
	`mem£t
(
buf
, 0, 
SCSC_LOG_FAPI_VERSION_SIZE
);

342 
	`¢´štf
(
buf
, 
SCSC_LOG_FAPI_VERSION_SIZE
, "ma:%u.%u, mlme:%u.%u, debug:%u.%u,est:%u.%u",

343 
	`FAPI_MAJOR_VERSION
(
FAPI_DATA_SAP_VERSION
), 
	`FAPI_MINOR_VERSION
(FAPI_DATA_SAP_VERSION),

344 
	`FAPI_MAJOR_VERSION
(
FAPI_CONTROL_SAP_VERSION
), 
	`FAPI_MINOR_VERSION
(FAPI_CONTROL_SAP_VERSION),

345 
	`FAPI_MAJOR_VERSION
(
FAPI_DEBUG_SAP_VERSION
), 
	`FAPI_MINOR_VERSION
(FAPI_DEBUG_SAP_VERSION),

346 
	`FAPI_MAJOR_VERSION
(
FAPI_TEST_SAP_VERSION
), 
	`FAPI_MINOR_VERSION
(FAPI_TEST_SAP_VERSION));

348 
	`scsc_log_cŞËùÜ_wr™e_çpi
(
buf
, 
SCSC_LOG_FAPI_VERSION_SIZE
);

352 ià(
»asÚ
 !ğ
SCSC_MODULE_CLIENT_REASON_RECOVERY
)

353 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_PROBED
);

354 
	`©omic_£t
(&
sdev
->
cm_if
.
»£t_Ëv–
, 0);

355 
dÚe
:

356 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

357 
	}
}

362 
	$£rviû_ş—n_up_locked
(
¦si_dev
 *
sdev
)

364 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_REMOVING
);

365 
	`put_deviû
(
sdev
->
dev
);

367 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_REMOVED
);

369 
sdev
->
maxw–l_cÜe
 = 
NULL
;

376 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

377 
	`¦si_dev_d‘ach
(
sdev
);

378 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

379 
	}
}

381 
	$¦si_wÏn_£rviû_»move
(
scsc_mx_moduË_ş›Á
 *
moduË_ş›Á
, 
scsc_mx
 *
mx
, 
scsc_moduË_ş›Á_»asÚ
 
»asÚ
)

383 
¦si_dev
 *
sdev
;

384 
¡©e
;

385 
Ëv–
 = 0;

386 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

388 
	`SLSI_UNUSED_PARAMETER
(
mx
);

389 
	`SLSI_UNUSED_PARAMETER
(
moduË_ş›Á
);

391 
sdev
 = 
cm_ùx
.sdev;

392 ià(!
sdev
) {

393 
	`SLSI_INFO_NODEV
("no sdev\n");

397 ià(
»asÚ
 =ğ
SCSC_MODULE_CLIENT_REASON_RECOVERY
 && !
»cov”y_š_´og»ss
) {

398 
	`SLSI_INFO_NODEV
("WLAN service„emove -„ecovery. Service‚ot‡ctive.\n");

399 } ià(
»asÚ
 =ğ
SCSC_MODULE_CLIENT_REASON_RECOVERY
 && 
»cov”y_š_´og»ss
) {

400 
r
;

402 
Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

404 
	`SLSI_INFO_NODEV
("WLAN s”viû„emov-„ecov”y, E¼Ü Lev–:%d\n", 
Ëv–
);

406 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s:„ecov”y, E¼Ü Lev–:%d\n", 
__func__
, 
Ëv–
);

407 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

413 ià(
sdev
->
»cov”y_Ãxt_¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STOPPING
) {

414 
	`SLSI_INFO_NODEV
("Nofity„egistered functions\n");

415 
	`blockšg_nÙif›r_ÿÎ_chaš
(&
¦si_wÏn_nÙif›r
, 
SCSC_WIFI_FAILURE_RESET
, 
sdev
);

417 ià(
Ëv–
 =ğ
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
) {

418 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

424 
	`com¶‘e_®l
(&
sdev
->
»cov”y_»move_com¶‘iÚ
);

425 ià(
sdev
->
»cov”y_Ãxt_¡©e
 =ğ
SCSC_WIFI_CM_IF_STATE_STOPPING
) {

426 
	`SLSI_INFO_NODEV
("Recovery -‚ext state stopping\n");

428 
	`SLSI_INFO_NODEV
("Calling slsi_send_hanged_vendor_event with†atest_scsc_panic_code=0x%x\n",

429 
Ï‹¡_scsc_·nic_code
);

430 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "Calling slsi_send_hanged_vendor_event,…anic_code=0x%x\n",

431 
Ï‹¡_scsc_·nic_code
);

432 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

434 ià(
	`¦si_£nd_hªged_v’dÜ_ev’t
(
sdev
, 
Ï‹¡_scsc_·nic_code
) < 0) {

435 
	`SLSI_ERR
(
sdev
, "Failedo send hangƒvent\n");

436 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "Failedo send vendor hangƒvent\n");

437 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

443 
	`com¶‘e_®l
(&
sdev
->
sig_wa™
.
com¶‘iÚ
);

446 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

448 
r
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sdev
->
»cov”y_¡İ_com¶‘iÚ
,

449 
	`m£cs_to_jiff›s
(
sdev
->
»cov”y_timeout
));

450 ià(
r
 == 0) {

451 
	`SLSI_INFO
(
sdev
, "»cov”y_¡İ_com¶‘iÚimedout,‚‘dev_up_couÁ = %d\n", sdev->
Ãtdev_up_couÁ
);

452 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "recovery_stop_completionimedout[%d]\n",

453 
sdev
->
»cov”y_timeout
);

454 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

455 ià(
sdev
->
Ãtdev_up_couÁ
) {

456 
sdev
->
»cov”y_ç_§ã
 = 
Œue
;

457 
	`SLSI_MUTEX_LOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

458 
	`¦si_¡İ_ch
(
sdev
);

459 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

460 
	`queue_wÜk
(
sdev
->
deviû_wq
, &sdev->
sy¡em_”rÜ_u£r_ç_wÜk
);

464 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

465 
	`»š™_com¶‘iÚ
(&
sdev
->
»cov”y_¡İ_com¶‘iÚ
);

466 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

469 
	`SLSI_INFO_NODEV
("WLAN service„emove\n");

471 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


472 
	`h4_§m¶”_de¡roy
(
sdev
, 
mx
);

475 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

476 
¡©e
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
cm_if_¡©e
);

477 ià(
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STARTED
 &&

478 
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_PROBED
 &&

479 
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STOPPED
 &&

480 
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_BLOCKED
) {

481 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

482 
	`SLSI_INFO_NODEV
("¡©e-ev’ˆ”rÜ %d\n", 
¡©e
);

486 
	`£rviû_ş—n_up_locked
(
sdev
);

487 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

489 
	`SLSI_INFO_NODEV
("Done!\n");

490 
	}
}

493 
	$¦si_h_block_bh
(
¦si_dev
 *
sdev
)

495 
	`SLSI_WARN
(
sdev
, "HIP state seto #SLSI_HIP_STATE_BLOCKED#\n");

496 
	`©omic_£t
(&
sdev
->
h
.
h_¡©e
, 
SLSI_HIP_STATE_BLOCKED
);

497 
	}
}

499 
scsc_mx_moduË_ş›Á
 
	gwÏn_driv”
 = {

500 .
Çme
 = "WLAN driver",

501 .
	g´obe
 = 
¦si_wÏn_£rviû_´obe
,

502 .
	g»move
 = 
¦si_wÏn_£rviû_»move
,

505 
	$¦si_sm_£rviû_driv”_»gi¡”
()

507 
¦si_cm_ùx
 *
ùx
 = &
cm_ùx
;

509 
	`mem£t
(
ùx
, 0, (*ctx));

510 
	`mu‹x_š™
(&
¦si_¡¬t_mu‹x
);

511 
	`scsc_mx_moduË_»gi¡”_ş›Á_moduË
(&
wÏn_driv”
);

514 
	}
}

516 
	$¦si_sm_£rviû_driv”_uÄegi¡”
()

518 
	`scsc_mx_moduË_uÄegi¡”_ş›Á_moduË
(&
wÏn_driv”
);

519 
	}
}

524 
	$¦si_sm_£rviû_çed
(
¦si_dev
 *
sdev
, cÚ¡ *
»asÚ
, 
boŞ
 
is_wÜk
)

526 
¡©e
;

528 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

530 ià(
is_wÜk
)

531 
	`com¶‘e_®l
(&
sdev
->
£rviû_ç_¡¬‹d_šdiÿtiÚ
);

533 
¡©e
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
cm_if_¡©e
);

534 ià(
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STARTED
 &&

535 
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STOPPING
) {

536 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

537 
	`SLSI_INFO
(
sdev
, "S‹ %d - ignÜšgƒv’t\n", 
¡©e
);

542 ià(!
sdev
->
ç_»pÜ‹d
) {

544 
	`SLSI_ERR
(
sdev
, "scsc_wifibt: FATAL ERROR: %s\n", 
»asÚ
);

546 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_BLOCKED
);

547 
	`¦si_h_block_bh
(
sdev
);

548 
	`scsc_mx_£rviû_£rviû_çed
(
sdev
->
£rviû
, 
»asÚ
);

549 
	`scsc_mx_£rviû_mif_dump_»gi¡”s
(
sdev
->
£rviû
);

550 
sdev
->
ç_»pÜ‹d
 = 
Œue
;

553 ià(
is_wÜk
)

554 
	`»š™_com¶‘iÚ
(&
sdev
->
£rviû_ç_¡¬‹d_šdiÿtiÚ
);

556 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

557 
	}
}

560 
boŞ
 
	$¦si_is_‹¡_mode_’abËd
()

562  
EÇbËTe¡Mode
;

563 
	}
}

565 
	#SLSI_SM_WLAN_SERVICE_RECOVERY_COMPLETED_TIMEOUT
 20000

	)

566 
	#SLSI_SM_WLAN_SERVICE_RECOVERY_DISABLED_TIMEOUT
 2000

	)

568 
	$¦si_sm_»cov”y_£rviû_¡İ
(
¦si_dev
 *
sdev
)

570 
”r
 = 0;

571 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

573 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

574 
	`SLSI_INFO_NODEV
("Stopping WLAN service\n");

575 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "Stopping WLAN service\n");

576 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

578 
sdev
->
wÏn_£rviû_Ú
 = 0;

579 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPING
);

581 ià(!
sdev
->
£rviû
) {

582 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

583 
	`SLSI_WARN
(
sdev
, "Service is NULL\n");

584 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "S”viû i NULLƒ¼=%d\n", 
”r
);

585 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

586 
”r
 = -
EINVAL
;

587 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

588  
”r
;

591 
”r
 = 
	`scsc_mx_£rviû_¡İ
(
sdev
->
£rviû
);

592 ià(
”r
 =ğ-
EILSEQ
 ||ƒ¼ =ğ-
EIO
)

593 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_¡İ faedƒ¼: %d\n", 
”r
);

595 
”r
 = 0;

596 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

597 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

598  
”r
;

599 
	}
}

601 
	$¦si_sm_»cov”y_£rviû_şo£
(
¦si_dev
 *
sdev
)

603 
”r
 = 0;

604 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

606 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

607 ià(!
sdev
->
£rviû
) {

608 
	`SLSI_WARN
(
sdev
, "sdev->service is NULL\n");

609 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

610  -
EINVAL
;

613 
	`SLSI_INFO_NODEV
("Closing WLAN service\n");

614 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "Closing WLAN service\n");

615 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

617 
”r
 = 
	`scsc_mx_£rviû_şo£
(
sdev
->
£rviû
);

618 ià(
”r
 =ğ-
EILSEQ
 ||ƒ¼ =ğ-
EIO
)

619 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_şo£ faedƒ¼: %d\n", 
”r
);

621 
”r
 = 0;

622 ià(!
”r
)

623 
sdev
->
£rviû
 = 
NULL
;

624 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

625  
”r
;

626 
	}
}

628 
	$¦si_sm_»cov”y_£rviû_İ’
(
¦si_dev
 *
sdev
)

630 
”r
 = 0;

631 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

633 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

634 
	`SLSI_INFO_NODEV
("Open WLAN service\n");

635 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "Open WLAN service\n");

636 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

638 
sdev
->
£rviû
 = 
	`scsc_mx_£rviû_İ’
(sdev->
maxw–l_cÜe
, 
SCSC_SERVICE_ID_WLAN
, &sdev->
mx_wÏn_ş›Á
, &
”r
);

639 ià(
”r
 =ğ-
EILSEQ
 ||ƒ¼ =ğ-
EIO
)

640 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_İ’ faedƒ¼: %d\n", 
”r
);

642 
”r
 = 0;

643 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

644  
”r
;

645 
	}
}

647 
	$¦si_sm_»cov”y_£rviû_¡¬t
(
¦si_dev
 *
sdev
)

649 
”r
 = 0, 
”r2
 = 0;

650 
¦si_h4
 *
h
 = &
sdev
->
h4_š¡
;

651 
scsc_miäam_»f
 
»f
;

652 
¡©e
;

653 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

655 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

656 
¡©e
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
cm_if_¡©e
);

657 
	`SLSI_INFO
(
sdev
,

659 
sdev
->
»cov”y_¡©us
, 
»cov”y_š_´og»ss
, 
¡©e
);

660 ià(
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_PROBED
 &&

661 
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STOPPED
) {

662 
	`SLSI_INFO
(
sdev
, "S‹-ev’ˆ”rÜ %d\n", 
¡©e
);

663 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

664  -
EINVAL
;

667 ià(!
sdev
->
£rviû
) {

668 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

669 
	`SLSI_WARN
(
sdev
, "Service is NULL\n");

670 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "S”viû i NULLƒ¼=%d\n", 
”r
);

671 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

672 
”r
 = -
EINVAL
;

673 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

674  
”r
;

677 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STARTING
);

678 #ifdeà
CONFIG_SCSC_PCIE


679 
”r
 = 
	`scsc_mx_£rviû_miäam_®loc
(
sdev
->
£rviû
, 1.5 * 1024 * 1024, &sdev->
h4_š¡
.
h_»f
, 4096);

681 
”r
 = 
	`scsc_mx_£rviû_miäam_®loc
(
sdev
->
£rviû
, 2.5 * 1024 * 1024, &sdev->
h4_š¡
.
h_»f
, 4096);

683 ià(
”r
) {

684 
	`SLSI_WARN
(
sdev
, "scsc_mx_£rviû_miäam_®loøçedƒ¼: %d\n", 
”r
);

685 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "scsc_mx_£rviû_miäam_®loøçedƒ¼: %d\n", 
”r
);

686 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

687 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

688 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

689  
”r
;

692 
”r
 = 
	`¦si_h_¡¬t
(
sdev
);

693 ià(
”r
) {

694 
	`SLSI_WARN
(
sdev
, "¦si_h_¡¬ˆçedƒ¼: %d\n", 
”r
);

695 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "¦si_h_¡¬ˆçedƒ¼: %d\n", 
”r
);

696 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

697 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

698 
	`¦si_h_¡İ
(
sdev
);

699 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

700  
”r
;

703 
”r
 = 
	`scsc_mx_£rviû_mif_±r_to_addr
(
sdev
->
£rviû
, 
h
->
h_cÚŒŞ
, &
»f
);

704 ià(
”r
) {

705 
	`SLSI_WARN
(
sdev
, "scsc_mx_£rviû_mif_±r_to_add¸çedƒ¼: %d\n", 
”r
);

706 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "scsc_mx_£rviû_mif_±r_to_add¸çedƒ¼: %d\n", 
”r
);

707 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

708 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

709 
	`¦si_h_¡İ
(
sdev
);

710 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

711  
”r
;

714 
”r
 = 
	`scsc_mx_£rviû_¡¬t
(
sdev
->
£rviû
, 
»f
);

715 ià(
”r
) {

716 
	`SLSI_WARN
(
sdev
, "scsc_mx_£rviû_¡¬ˆçedƒ¼: %d\n", 
”r
);

717 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "scsc_mx_£rviû_¡¬ˆçedƒ¼: %d\n", 
”r
);

718 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

719 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

720 
	`¦si_h_¡İ
(
sdev
);

721 ià(
”r
 =ğ-
EILSEQ
) {

722 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STOPPED
;

723 
sdev
->
»quœe_£rviû_şo£
 = 
Œue
;

725 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

726  
”r
;

728 
”r
 = 
	`¦si_h_£tup
(
sdev
);

729 ià(
”r
) {

730 
	`SLSI_WARN
(
sdev
, "¦si_h_£tu°çedƒ¼: %d\n", 
”r
);

731 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "¦si_h_£tu°çedƒ¼: %d\n", 
”r
);

732 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

733 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

734 
”r2
 = 
	`scsc_mx_£rviû_¡İ
(
sdev
->
£rviû
);

735 ià(
”r2
)

736 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_¡İ faedƒ¼2: %d\n", 
”r2
);

737 ià(
”r2
 =ğ-
EILSEQ
) {

738 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STOPPED
;

739 
sdev
->
»quœe_£rviû_şo£
 = 
Œue
;

741 
	`¦si_h_¡İ
(
sdev
);

742 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

743  
”r
;

746 
”r
 = 
	`¦si_h_§p_£tup
(
sdev
);

747 ià(
”r
) {

748 
	`SLSI_WARN
(
sdev
, "¦si_h_§p_£tu°çedƒ¼: %d\n", 
”r
);

749 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "¦si_h_§p_£tu°çedƒ¼: %d\n", 
”r
);

750 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

751 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

752 
”r2
 = 
	`scsc_mx_£rviû_¡İ
(
sdev
->
£rviû
);

753 ià(
”r2
)

754 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_¡İ faedƒ¼2: %d\n", 
”r2
);

755 ià(
”r2
 =ğ-
EILSEQ
) {

756 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STOPPED
;

757 
sdev
->
»quœe_£rviû_şo£
 = 
Œue
;

759 
	`¦si_h_¡İ
(
sdev
);

760 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

761  
”r
;

763 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STARTED
);

764 
sdev
->
wÏn_£rviû_Ú
 = 1;

765 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s: wÏn_£rviû_Ú[1]\n", 
__func__
);

766 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

767 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

768  
”r
;

769 
	}
}

771 
	$¦si_sm_wÏn_£rviû_İ’
(
¦si_dev
 *
sdev
)

773 
”r
 = 0;

774 
¡©e
;

775 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

777 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

778 
¡©e
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
cm_if_¡©e
);

779 ià(
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_PROBED
 &&

780 
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STOPPED
) {

781 
	`SLSI_INFO
(
sdev
, "S‹-ev’ˆ”rÜ %d\n", 
¡©e
);

782 
”r
 = -
EINVAL
;

783 
ex™
;

786 
sdev
->
»cov”y_timeout
 = 
	`mxmª_»cov”y_di§bËd
(è? 
SLSI_SM_WLAN_SERVICE_RECOVERY_DISABLED_TIMEOUT
 : 
SLSI_SM_WLAN_SERVICE_RECOVERY_COMPLETED_TIMEOUT
;

789 
	`SLSI_INFO
(
sdev
, "Open WLAN service\n");

790 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "O³ÀWLAN s”viû,„ecov”yimeouˆğ%d\n", 
sdev
->
»cov”y_timeout
);

791 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

793 
sdev
->
£rviû
 = 
	`scsc_mx_£rviû_İ’
(sdev->
maxw–l_cÜe
, 
SCSC_SERVICE_ID_WLAN
, &sdev->
mx_wÏn_ş›Á
, &
”r
);

794 ià(!
sdev
->
£rviû
) {

795 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_PROBED
);

796 
	`SLSI_WARN
(
sdev
, "Service open failed\n");

797 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "S”viû o³Àçed,ƒ¼=%d\n", 
”r
);

798 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

799 
”r
 = -
EINVAL
;

800 
ex™
;

803 
ex™
:

804 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

805  
”r
;

806 
	}
}

808 #ià
defšed
(
CONFIG_SLUB_DEBUG_ON
è|| defšed(
CONFIG_DEBUG_PREEMPT
è|| defšed(
CONFIG_DEBUG_RT_MUTEXES
) || \

809 
defšed
(
CONFIG_DEBUG_SPINLOCK
è&& defšed(
CONFIG_DEBUG_MUTEXES
è&& defšed(
CONFIG_DEBUG_LOCK_ALLOC
) || \

810 
defšed
(
CONFIG_DEBUG_LOCK_ALLOC
è&& defšed(
CONFIG_DEBUG_ATOMIC_SLEEP
è&& 
	$defšed
(
CONFIG_DEBUG_LIST
)

811 
	#KERNEL_DEBUG_OPTIONS_ENABLED


	)

814 
	$¦si_sm_wÏn_£rviû_¡¬t
(
¦si_dev
 *
sdev
)

816 
¦si_h4
 *
h
 = &
sdev
->
h4_š¡
;

817 
scsc_miäam_»f
 
»f
;

818 
”r
 = 0;

819 
”r2
 = 0;

820 
¡©e
;

821 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

823 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

824 
¡©e
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
cm_if_¡©e
);

825 
	`SLSI_INFO
(
sdev
,

827 
sdev
->
»cov”y_¡©us
, 
»cov”y_š_´og»ss
, 
¡©e
);

829 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s:„ecovery_status = %d,„ecovery_in_progress = %d\n",

830 
__func__
, 
sdev
->
»cov”y_¡©us
, 
»cov”y_š_´og»ss
);

831 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

833 ià(
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_PROBED
 &&

834 
¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STOPPED
) {

835 
	`SLSI_INFO
(
sdev
, "S‹-ev’ˆ”rÜ %d\n", 
¡©e
);

836 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

837  -
EINVAL
;

840 ià(!
sdev
->
£rviû
) {

841 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

842 
	`SLSI_WARN
(
sdev
, "Service is NULL\n");

843 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "S”viû i NULLƒ¼=%d\n", 
”r
);

844 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

845 
”r
 = -
EINVAL
;

846 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

847  
”r
;

850 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STARTING
);

852 #ifdeà
KERNEL_DEBUG_OPTIONS_ENABLED


853 
	`SLSI_WARN
(
sdev
, "Kernel config debug options‡reƒnabled. This might impacthehroughput…erformance.\n");

857 
	`SLSI_INFO
(
sdev
, "Allocate mifram\n");

859 #ifdeà
CONFIG_SCSC_PCIE


860 
”r
 = 
	`scsc_mx_£rviû_miäam_®loc
(
sdev
->
£rviû
, 1.5 * 1024 * 1024, &sdev->
h4_š¡
.
h_»f
, 4096);

862 
”r
 = 
	`scsc_mx_£rviû_miäam_®loc
(
sdev
->
£rviû
, 2.5 * 1024 * 1024, &sdev->
h4_š¡
.
h_»f
, 4096);

864 ià(
”r
) {

865 
	`SLSI_WARN
(
sdev
, "scsc_mx_£rviû_miäam_®loøçedƒ¼: %d\n", 
”r
);

866 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

867 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

868  
”r
;

871 
	`SLSI_INFO
(
sdev
, "Start HIP\n");

872 
”r
 = 
	`¦si_h_¡¬t
(
sdev
);

873 ià(
”r
) {

874 
	`SLSI_WARN
(
sdev
, "¦si_h_¡¬ˆçedƒ¼: %d\n", 
”r
);

875 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

876 
	`¦si_h_¡İ
(
sdev
);

877 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

878  
”r
;

881 
”r
 = 
	`scsc_mx_£rviû_mif_±r_to_addr
(
sdev
->
£rviû
, 
h
->
h_cÚŒŞ
, &
»f
);

882 ià(
”r
) {

883 
	`SLSI_WARN
(
sdev
, "scsc_mx_£rviû_mif_±r_to_add¸çedƒ¼: %d\n", 
”r
);

884 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

885 
	`¦si_h_¡İ
(
sdev
);

886 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

887  
”r
;

890 
	`SLSI_INFO
(
sdev
, "Starting WLAN service\n");

891 
”r
 = 
	`scsc_mx_£rviû_¡¬t
(
sdev
->
£rviû
, 
»f
);

892 ià(
”r
) {

893 
	`SLSI_WARN
(
sdev
, "scsc_mx_£rviû_¡¬ˆçedƒ¼: %d\n", 
”r
);

894 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

895 ià(
”r
 =ğ-
EILSEQ
) {

896 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STOPPED
;

897 
sdev
->
»quœe_£rviû_şo£
 = 
Œue
;

899 
	`¦si_h_¡İ
(
sdev
);

900 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

901  
”r
;

903 
”r
 = 
	`¦si_h_£tup
(
sdev
);

904 ià(
”r
) {

905 
	`SLSI_WARN
(
sdev
, "¦si_h_£tu°çedƒ¼: %d\n", 
”r
);

906 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

907 
	`SLSI_INFO_NODEV
("Stopping WLAN service\n");

908 
”r2
 = 
	`scsc_mx_£rviû_¡İ
(
sdev
->
£rviû
);

909 ià(
”r2
)

910 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_¡İ faedƒ¼2: %d\n", 
”r2
);

911 
”r2
 = 
	`scsc_mx_£rviû_¡İ
(
sdev
->
£rviû
);

912 ià(
”r2
)

913 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_¡İ faedƒ¼2: %d\n", 
”r2
);

914 ià(
”r2
 =ğ-
EILSEQ
) {

915 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STOPPED
;

916 
sdev
->
»quœe_£rviû_şo£
 = 
Œue
;

918 
	`¦si_h_¡İ
(
sdev
);

919 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

920  
”r2
;

923 
”r
 = 
	`¦si_h_§p_£tup
(
sdev
);

924 ià(
”r
) {

925 
	`SLSI_WARN
(
sdev
, "¦si_h_§p_£tu°çedƒ¼: %d\n", 
”r
);

926 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

927 
	`SLSI_INFO_NODEV
("Stopping WLAN service\n");

928 
”r2
 = 
	`scsc_mx_£rviû_¡İ
(
sdev
->
£rviû
);

929 ià(
”r2
)

930 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_¡İ faedƒ¼2: %d\n", 
”r2
);

931 ià(
”r2
 =ğ-
EILSEQ
) {

932 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STOPPED
;

933 
sdev
->
»quœe_£rviû_şo£
 = 
Œue
;

935 
	`¦si_h_¡İ
(
sdev
);

936 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

937  
”r2
;

939 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STARTED
);

940 
sdev
->
wÏn_£rviû_Ú
 = 1;

941 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

943 
	}
}

945 
	$__¦si_sm_wÏn_£rviû_¡İ_wa™_locked
(
¦si_dev
 *
sdev
)

947 
r
;

948 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

950 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

951 
r
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sdev
->
»cov”y_»move_com¶‘iÚ
,

952 
	`m£cs_to_jiff›s
(
sdev
->
»cov”y_timeout
));

953 ià(
r
 == 0) {

954 
	`SLSI_INFO
(
sdev
, "recovery_remove_completionimeout\n");

956 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s:„ecov”y_»move_com¶‘iÚimeout\n", 
__func__
);

957 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

960 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

961 
sdev
->
»cov”y_Ãxt_¡©e
 = 
SCSC_WIFI_CM_IF_STATE_STOPPED
;

963 
	`»š™_com¶‘iÚ
(&
sdev
->
»cov”y_»move_com¶‘iÚ
);

964 
	}
}

966 
	$¦si_sm_wÏn_£rviû_¡İ
(
¦si_dev
 *
sdev
)

968 
cm_if_¡©e
;

969 
”r
 = 0;

971 
u8
 
»Œy_couÁ
 = 
SLSI_RETRY_STOP_COUNT_ERROR
;

972 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

974 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

975 
cm_if_¡©e
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.cm_if_state);

976 
	`SLSI_INFO
(
sdev
,

978 
sdev
->
»cov”y_¡©us
, 
»cov”y_š_´og»ss
, 
cm_if_¡©e
);

980 ià(!
sdev
->
£rviû
) {

981 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

982 
	`SLSI_WARN
(
sdev
, "Service is NULL\n");

983 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "S”viû i NULLƒ¼=%d\n", 
”r
);

984 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

985 
”r
 = -
EINVAL
;

986 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

987  
”r
;

990 ià(
cm_if_¡©e
 =ğ
SCSC_WIFI_CM_IF_STATE_BLOCKED
) {

991 
	`__¦si_sm_wÏn_£rviû_¡İ_wa™_locked
(
sdev
);

993 ià(
	`©omic_»ad
(&
sdev
->
cm_if
.
cm_if_¡©e
è=ğ
SCSC_WIFI_CM_IF_STATE_STOPPED
) {

994 
	`SLSI_INFO
(
sdev
, "sk mx_£rviû_şo£ cm_if_¡©e=%d\n", 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

995 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

996  -
EUSERS
;

1005 
sk_¡©e_check
;

1008 ià(
cm_if_¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STARTED
 &&

1009 
cm_if_¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_REMOVED
 &&

1010 
cm_if_¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_PROBED
) {

1011 
	`SLSI_INFO
(
sdev
, "Service‚ot started or incorrect state %d\n",

1012 
cm_if_¡©e
);

1013 
ex™
;

1023 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPING
);

1024 
sk_¡©e_check
:

1025 
	`SLSI_INFO_NODEV
("Stopping WLAN service\n");

1026 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s: Stİpšg WLAN s”viû\n", 
__func__
);

1028 
”r
 = 
	`scsc_mx_£rviû_¡İ
(
sdev
->
£rviû
);

1029 ià(
”r
 =ğ-
EILSEQ
) {

1033 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_¡İ faedƒ¼: %d‡‰em± Ëá: %d\n", 
”r
, 
»Œy_couÁ
);

1034 
	`__¦si_sm_wÏn_£rviû_¡İ_wa™_locked
(
sdev
);

1037 ià(!
»Œy_couÁ
)

1038 
sdev
->
»quœe_£rviû_şo£
 = 
Œue
;

1039 ià(
»Œy_couÁ
--)

1040 
sk_¡©e_check
;

1041 } ià(
”r
 =ğ-
EIO
) {

1042 
»asÚ
[80];

1044 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_¡İ faedƒ¼: %d\n", 
”r
);

1050 
sdev
->
»cov”y_Ãxt_¡©e
 = 
SCSC_WIFI_CM_IF_STATE_STOPPING
;

1051 
	`¢´štf
(
»asÚ
, (reason), "WLAN scsc_mx_service_stop failed");

1053 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

1054 
	`¦si_sm_£rviû_çed
(
sdev
, 
»asÚ
, 
çl£
);

1055 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

1057 
	`__¦si_sm_wÏn_£rviû_¡İ_wa™_locked
(
sdev
);

1058 } ià(
”r
 =ğ-
EPERM
) {

1062 
	`SLSI_INFO
(
sdev
, "»fu£d dutØ´eviou çu»,„ecov”y i di§bËd: %d\n", 
”r
);

1063 } ià(
”r
 != 0) {

1064 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_¡İ faed, unknowÀ”r: %d\n", 
”r
);

1067 
	`©omic_£t
(&
sdev
->
cm_if
.
cm_if_¡©e
, 
SCSC_WIFI_CM_IF_STATE_STOPPED
);

1068 
ex™
:

1069 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

1071 
	}
}

1073 
	#SLSI_SM_WLAN_SERVICE_CLOSE_RETRY
 60

	)

1074 
	$¦si_sm_wÏn_£rviû_şo£
(
¦si_dev
 *
sdev
)

1076 
cm_if_¡©e
, 
r
 = 0;

1077 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

1079 
	`mu‹x_lock
(&
¦si_¡¬t_mu‹x
);

1080 
sdev
->
wÏn_£rviû_Ú
 = 0;

1081 
cm_if_¡©e
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.cm_if_state);

1082 ià(
cm_if_¡©e
 !ğ
SCSC_WIFI_CM_IF_STATE_STOPPED
) {

1083 
	`SLSI_INFO
(
sdev
, "S”viû‚Ù stİ³d. cm_if_¡©ğ%d s”viû i ğ%d\n", 
cm_if_¡©e
, sdev->
£rviû
);

1089 ià(
cm_if_¡©e
 =ğ
SCSC_WIFI_CM_IF_STATE_PROBED
) {

1090 
	`SLSI_INFO_NODEV
("Closing WLAN service onƒrror\n");

1091 ià(
sdev
->
£rviû
)

1092 
r
 = 
	`scsc_mx_£rviû_şo£
(
sdev
->
£rviû
);

1094 
ex™
;

1097 
	`SLSI_INFO_NODEV
("Closšg WLAN s”viû. S”viû i %d\n",
sdev
->
£rviû
);

1099 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s: Closšg WLAN s”viû. S”viû i %d\n", 
__func__
, 
sdev
->
£rviû
);

1100 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

1102 ià(
sdev
->
£rviû
){

1103 
	`scsc_mx_£rviû_miäam_ä“
(
sdev
->
£rviû
, sdev->
h4_š¡
.
h_»f
);

1104 
r
 = 
	`scsc_mx_£rviû_şo£
(
sdev
->
£rviû
);

1105 ià(
r
 =ğ-
EIO
) {

1109 
sdev
->
»quœe_£rviû_şo£
 = 
Œue
;

1110 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STOPPED
;

1111 
	`SLSI_INFO
(
sdev
, "scsc_mx_£rviû_şo£ faed w™hƒ¼Ü:%d\n", 
r
);

1112 } ià(
r
 =ğ-
EPERM
) {

1113 
	`SLSI_ERR
(
sdev
, "scsc_mx_£rviû_şo£ -„ecov”y i di§bËd (%d)\n", 
r
);

1117 ià(
»cov”y_š_´og»ss
)

1118 
	`com¶‘e_®l
(&
sdev
->
»cov”y_¡İ_com¶‘iÚ
);

1119 
ex™
:

1120 ià(!
r
)

1121 
sdev
->
£rviû
 = 
NULL
;

1122 
	`mu‹x_uÆock
(&
¦si_¡¬t_mu‹x
);

1123 
	}
}

1125 
¦si_dev
 *
	$¦si_g‘_sdev
()

1127  
cm_ùx
.
sdev
;

1128 
	}
}

	@const.h

7 #iâdeà
_SLSI_CONST_H__


8 
	#_SLSI_CONST_H__


	)

10 
	~<lšux/v”siÚ.h
>

11 
	~<lšux/ty³s.h
>

12 
	~<lšux/›“80211.h
>

14 #ifdeà
__ılu¥lus


19 
	#SLSI_TDLS_PEER_CONNECTIONS_MAX
 4

	)

20 
	#SLSI_AP_PEER_CONNECTIONS_MAX
 10

	)

26 
	#SLSI_ADHOC_PEER_CONNECTIONS_MAX
 16

	)

29 
	#SLSI_TDLS_PEER_INDEX_MIN
 2

	)

30 
	#SLSI_TDLS_PEER_INDEX_MAX
 15

	)

31 
	#SLSI_PEER_INDEX_MIN
 1

	)

32 
	#SLSI_PEER_INDEX_MAX
 16

	)

34 
	#SLSI_STA_PEER_QUEUESET
 0

	)

36 
	#SLSI_BA_TRAFFIC_STREAM_MAX
 8

	)

37 
	#SLSI_BA_BUFFER_SIZE_MAX
 64

	)

40 #ifdeà
__ılu¥lus


	@debug.c

7 
	~<lšux/sysfs.h
>

8 
	~<lšux/pŞl.h
>

9 
	~<lšux/cdev.h
>

11 
	~"debug.h
"

12 
	~"´ocfs.h
"

13 
	~"uts.h
"

15 #iâdeà
CONFIG_SCSC_DEBUG_COMPATIBILITY


16 cÚ¡ 
	gSLSI_INIT_DEINIT
;

17 cÚ¡ 
	gSLSI_NETDEV
 = 1;

18 cÚ¡ 
	gSLSI_CFG80211
 = 2;

19 cÚ¡ 
	gSLSI_MLME
 = 3;

20 cÚ¡ 
	gSLSI_SUMMARY_FRAMES
 = 4;

21 cÚ¡ 
	gSLSI_HYDRA
 = 5;

22 cÚ¡ 
	gSLSI_TX
 = 6;

23 cÚ¡ 
	gSLSI_RX
 = 7;

24 cÚ¡ 
	gSLSI_UDI
 = 8;

26 cÚ¡ 
	gSLSI_WIFI_FCQ
 = 9;

28 cÚ¡ 
	gSLSI_HIP
 = 10;

29 cÚ¡ 
	gSLSI_HIP_INIT_DEINIT
 = 11;

30 cÚ¡ 
	gSLSI_HIP_FW_DL
 = 12;

31 cÚ¡ 
	gSLSI_HIP_SDIO_OP
 = 13;

32 cÚ¡ 
	gSLSI_HIP_PS
 = 14;

33 cÚ¡ 
	gSLSI_HIP_TH
 = 15;

34 cÚ¡ 
	gSLSI_HIP_FH
 = 16;

35 cÚ¡ 
	gSLSI_HIP_SIG
 = 17;

37 cÚ¡ 
	gSLSI_FUNC_TRACE
 = 18;

38 cÚ¡ 
	gSLSI_TEST
 = 19;

39 cÚ¡ 
	gSLSI_SRC_SINK
 = 20;

40 cÚ¡ 
	gSLSI_FW_TEST
 = 21;

41 cÚ¡ 
	gSLSI_RX_BA
 = 22;

43 cÚ¡ 
	gSLSI_TDLS
 = 23;

44 cÚ¡ 
	gSLSI_GSCAN
 = 24;

45 cÚ¡ 
	gSLSI_MBULK
 = 25;

46 cÚ¡ 
	gSLSI_FLOWC
 = 26;

47 cÚ¡ 
	gSLSI_SMAPPER
 = 27;

50 
¦si_dbg_£t_·¿m_cb
(cÚ¡ *
v®
, cÚ¡ 
k”Ãl_·¿m
 *
kp
);

51 
¦si_dbg_g‘_·¿m_cb
(*
bufãr
, cÚ¡ 
k”Ãl_·¿m
 *
kp
);

53 
k”Ãl_·¿m_İs
 
	g·¿m_İs_log
 = {

54 .
£t
 = 
¦si_dbg_£t_·¿m_cb
,

55 .
	gg‘
 = 
¦si_dbg_g‘_·¿m_cb
,

58 
	#ADD_DEBUG_MODULE_PARAM
(
Çme
, 
deçuÉ_Ëv–
, 
f‹r
) \

59 
¦si_dbg_lvl_
 ## 
Çme
 = 
deçuÉ_Ëv–
; \

60 
	`moduË_·¿m_cb
(
¦si_dbg_lvl_
 ## 
Çme
, &
·¿m_İs_log
, (*)&
f‹r
, 
S_IRUGO
 | 
S_IWUSR
); \

61 
	`MODULE_PARM_DESC
(
¦si_dbg_lvl_
 ## 
Çme
, " Debug†ev– (0~4èfÜh" #Çm" moduË (0 = offèdeçuÉ=" #deçuÉ_Ëv–)

	)

63 #iâdeà
CONFIG_SCSC_DEBUG_COMPATIBILITY


65 
ADD_DEBUG_MODULE_PARAM
(
š™_deš™
, 3, 
SLSI_INIT_DEINIT
);

66 
ADD_DEBUG_MODULE_PARAM
(
Ãtdev
, 2, 
SLSI_NETDEV
);

67 
ADD_DEBUG_MODULE_PARAM
(
cfg80211
, 1, 
SLSI_CFG80211
);

68 
ADD_DEBUG_MODULE_PARAM
(
mlme
, 2, 
SLSI_MLME
);

69 
ADD_DEBUG_MODULE_PARAM
(
summ¬y_äames
, 0, 
SLSI_SUMMARY_FRAMES
);

70 
ADD_DEBUG_MODULE_PARAM
(
hyd¿
, 0, 
SLSI_HYDRA
);

71 
ADD_DEBUG_MODULE_PARAM
(
tx
, 0, 
SLSI_TX
);

72 
ADD_DEBUG_MODULE_PARAM
(
rx
, 0, 
SLSI_RX
);

73 
ADD_DEBUG_MODULE_PARAM
(
udi
, 2, 
SLSI_UDI
);

75 
ADD_DEBUG_MODULE_PARAM
(
wifi_fcq
, 0, 
SLSI_WIFI_FCQ
);

77 
ADD_DEBUG_MODULE_PARAM
(
h
, 0, 
SLSI_HIP
);

78 
ADD_DEBUG_MODULE_PARAM
(
h_š™_deš™
, 0, 
SLSI_HIP_INIT_DEINIT
);

79 
ADD_DEBUG_MODULE_PARAM
(
h_fw_dl
, 0, 
SLSI_HIP_FW_DL
);

80 
ADD_DEBUG_MODULE_PARAM
(
h_sdio_İ
, 0, 
SLSI_HIP_SDIO_OP
);

81 
ADD_DEBUG_MODULE_PARAM
(
h_ps
, 0, 
SLSI_HIP_PS
);

82 
ADD_DEBUG_MODULE_PARAM
(
h_th
, 0, 
SLSI_HIP_TH
);

83 
ADD_DEBUG_MODULE_PARAM
(
h_fh
, 0, 
SLSI_HIP_FH
);

84 
ADD_DEBUG_MODULE_PARAM
(
h_sig
, 0, 
SLSI_HIP_SIG
);

86 
ADD_DEBUG_MODULE_PARAM
(
func_Œaû
, 0, 
SLSI_FUNC_TRACE
);

87 
ADD_DEBUG_MODULE_PARAM
(
‹¡
, 0, 
SLSI_TEST
);

88 
ADD_DEBUG_MODULE_PARAM
(
¤c_sšk
, 0, 
SLSI_SRC_SINK
);

89 
ADD_DEBUG_MODULE_PARAM
(
fw_‹¡
, 0, 
SLSI_FW_TEST
);

90 
ADD_DEBUG_MODULE_PARAM
(
rx_ba
, 0, 
SLSI_RX_BA
);

92 
ADD_DEBUG_MODULE_PARAM
(
tdls
, 2, 
SLSI_TDLS
);

93 
ADD_DEBUG_MODULE_PARAM
(
gsÿn
, 3, 
SLSI_GSCAN
);

94 
ADD_DEBUG_MODULE_PARAM
(
mbulk
, 0, 
SLSI_MBULK
);

95 
ADD_DEBUG_MODULE_PARAM
(
æowc
, 0, 
SLSI_FLOWC
);

96 
ADD_DEBUG_MODULE_PARAM
(
sm­³r
, 0, 
SLSI_SMAPPER
);

98 
	g¦si_dbg_lvl_®l
;

100 *
	g¦si_dbg_f‹rs
[] = {

101 &
¦si_dbg_lvl_š™_deš™
,

102 &
¦si_dbg_lvl_Ãtdev
,

103 &
¦si_dbg_lvl_cfg80211
,

104 &
¦si_dbg_lvl_mlme
,

105 &
¦si_dbg_lvl_summ¬y_äames
,

106 &
¦si_dbg_lvl_hyd¿
,

107 &
¦si_dbg_lvl_tx
,

108 &
¦si_dbg_lvl_rx
,

109 &
¦si_dbg_lvl_udi
,

111 &
¦si_dbg_lvl_wifi_fcq
,

113 &
¦si_dbg_lvl_h
,

114 &
¦si_dbg_lvl_h_š™_deš™
,

115 &
¦si_dbg_lvl_h_fw_dl
,

116 &
¦si_dbg_lvl_h_sdio_İ
,

117 &
¦si_dbg_lvl_h_ps
,

118 &
¦si_dbg_lvl_h_th
,

119 &
¦si_dbg_lvl_h_fh
,

120 &
¦si_dbg_lvl_h_sig
,

122 &
¦si_dbg_lvl_func_Œaû
,

123 &
¦si_dbg_lvl_‹¡
,

124 &
¦si_dbg_lvl_¤c_sšk
,

125 &
¦si_dbg_lvl_fw_‹¡
,

126 &
¦si_dbg_lvl_rx_ba
,

128 &
¦si_dbg_lvl_tdls
,

129 &
¦si_dbg_lvl_gsÿn
,

130 &
¦si_dbg_lvl_mbulk
,

131 &
¦si_dbg_lvl_æowc
,

132 &
¦si_dbg_lvl_sm­³r
,

135 
	g¦si_dbg_lvl_com·t_®l
;

136 
moduË_·¿m
(
¦si_dbg_lvl_com·t_®l
, , 
S_IRUGO
 | 
S_IWUSR
);

138 *
	g¦si_dbg_f‹rs
[] = {

139 &
¦si_dbg_lvl_com·t_®l
,

140 &
¦si_dbg_lvl_com·t_®l
,

141 &
¦si_dbg_lvl_com·t_®l
,

142 &
¦si_dbg_lvl_com·t_®l
,

143 &
¦si_dbg_lvl_com·t_®l
,

144 &
¦si_dbg_lvl_com·t_®l
,

145 &
¦si_dbg_lvl_com·t_®l
,

146 &
¦si_dbg_lvl_com·t_®l
,

147 &
¦si_dbg_lvl_com·t_®l
,

148 &
¦si_dbg_lvl_com·t_®l
,

149 &
¦si_dbg_lvl_com·t_®l
,

150 &
¦si_dbg_lvl_com·t_®l
,

151 &
¦si_dbg_lvl_com·t_®l
,

152 &
¦si_dbg_lvl_com·t_®l
,

153 &
¦si_dbg_lvl_com·t_®l
,

154 &
¦si_dbg_lvl_com·t_®l
,

155 &
¦si_dbg_lvl_com·t_®l
,

156 &
¦si_dbg_lvl_com·t_®l
,

157 &
¦si_dbg_lvl_com·t_®l
,

158 &
¦si_dbg_lvl_com·t_®l
,

159 &
¦si_dbg_lvl_com·t_®l
,

160 &
¦si_dbg_lvl_com·t_®l
,

161 &
¦si_dbg_lvl_com·t_®l
,

162 &
¦si_dbg_lvl_com·t_®l
,

163 &
¦si_dbg_lvl_com·t_®l
,

164 &
¦si_dbg_lvl_com·t_®l
,

165 &
¦si_dbg_lvl_com·t_®l
,

166 &
¦si_dbg_lvl_com·t_®l
,

167 &
¦si_dbg_lvl_com·t_®l
,

168 &
¦si_dbg_lvl_com·t_®l
,

169 &
¦si_dbg_lvl_com·t_®l
,

170 &
¦si_dbg_lvl_com·t_®l
,

171 &
¦si_dbg_lvl_com·t_®l
,

172 &
¦si_dbg_lvl_com·t_®l
,

173 &
¦si_dbg_lvl_com·t_®l
,

174 &
¦si_dbg_lvl_com·t_®l
,

175 &
¦si_dbg_lvl_com·t_®l
,

176 &
¦si_dbg_lvl_com·t_®l
,

177 &
¦si_dbg_lvl_com·t_®l
,

178 &
¦si_dbg_lvl_com·t_®l
,

179 &
¦si_dbg_lvl_com·t_®l
,

180 &
¦si_dbg_lvl_com·t_®l
,

181 &
¦si_dbg_lvl_com·t_®l
,

182 &
¦si_dbg_lvl_com·t_®l
,

183 &
¦si_dbg_lvl_com·t_®l
,

184 &
¦si_dbg_lvl_com·t_®l
,

185 &
¦si_dbg_lvl_com·t_®l
,

186 &
¦si_dbg_lvl_com·t_®l
,

187 &
¦si_dbg_lvl_com·t_®l
,

188 &
¦si_dbg_lvl_com·t_®l
,

189 &
¦si_dbg_lvl_com·t_®l
,

190 &
¦si_dbg_lvl_com·t_®l
,

191 &
¦si_dbg_lvl_com·t_®l
,

192 &
¦si_dbg_lvl_com·t_®l
,

193 &
¦si_dbg_lvl_com·t_®l
,

194 &
¦si_dbg_lvl_com·t_®l
,

195 &
¦si_dbg_lvl_com·t_®l
,

196 &
¦si_dbg_lvl_com·t_®l
,

197 &
¦si_dbg_lvl_com·t_®l
,

198 &
¦si_dbg_lvl_com·t_®l
,

199 &
¦si_dbg_lvl_com·t_®l
,

200 &
¦si_dbg_lvl_com·t_®l
,

201 &
¦si_dbg_lvl_com·t_®l
,

202 &
¦si_dbg_lvl_com·t_®l
,

203 &
¦si_dbg_lvl_com·t_®l
,

204 &
¦si_dbg_lvl_com·t_®l
,

205 &
¦si_dbg_lvl_com·t_®l
,

206 &
¦si_dbg_lvl_com·t_®l
,

207 &
¦si_dbg_lvl_com·t_®l
,

208 &
¦si_dbg_lvl_com·t_®l
,

209 &
¦si_dbg_lvl_com·t_®l
,

210 &
¦si_dbg_lvl_com·t_®l
,

211 &
¦si_dbg_lvl_com·t_®l
,

212 &
¦si_dbg_lvl_com·t_®l
,

213 &
¦si_dbg_lvl_com·t_®l
,

216 
	g¦si_dbg_lvl_®l
;

219 cÚ¡ 
	gSLSI_DF_MAX
 = ((
¦si_dbg_f‹rs
) / (slsi_dbg_filters[0]));

221 cÚ¡ 
	gSLSI_OVERRIDE_ALL_FILTER
 = -1;

224 
	$¦si_dec¡r_to_št
(cÚ¡ *
dec_¡r
, *
»s
)

226 
tmp_»s
 = 0;

227 
sign
 = 0;

228 cÚ¡ *
tmp_ch¬
 = 
dec_¡r
;

230 
sign
 = (*
tmp_ch¬
 == '-') ? -1 : ((*tmp_char == '+') ? 1 : 0);

231 ià(
sign
 != 0)

232 
tmp_ch¬
++;

234 *
tmp_ch¬
) {

235 ià(*
tmp_ch¬
 == '\n')

237 ià((*
tmp_ch¬
 < '0') || (*tmp_char > '9'))

239 
tmp_»s
 =mp_» * 10 + (*
tmp_ch¬
 - '0');

240 
tmp_ch¬
++;

243 *
»s
 = (
sign
 < 0è? (-
tmp_»s
) :mp_res;

245 
	}
}

247 
	$¦si_dbg_£t_·¿m_cb
(cÚ¡ *
v®
, cÚ¡ 
k”Ãl_·¿m
 *
kp
)

249 
Ãw_v®
;

250 
f‹r
;

252 ià(
	`¦si_dec¡r_to_št
(
v®
, &
Ãw_v®
) < 0) {

253 
	`´_šfo
("%s: faedØcÚv”ˆ% tØšt\n", 
__func__
, 
v®
);

256 
f‹r
 = *((*)(
kp
->
¬g
));

258 ià(
f‹r
 < -1 || f‹¸>ğ
SLSI_DF_MAX
) {

259 
	`´_šfo
("%s: f‹¸%d ouˆoà¿nge\n", 
__func__
, 
f‹r
);

263 ià(
f‹r
 =ğ
SLSI_OVERRIDE_ALL_FILTER
) {

264 ià(
Ãw_v®
 == -1) {

265 
	`´_šfo
("Ov”riddÛ nÙakefãù beÿu£ slsi_dbg_lvl_®l=%d\n", 
Ãw_v®
);

267 
i
;

269 
	`´_šfo
("S‘tšg‡Î debug moduË tØËv– %d\n", 
Ãw_v®
);

270 
i
 = 0; i < 
SLSI_DF_MAX
; i++)

271 *
¦si_dbg_f‹rs
[
i
] = 
Ãw_v®
;

273 
¦si_dbg_lvl_®l
 = 
Ãw_v®
;

276 
	`´_šfo
("S‘tšg debug moduË %dØËv– %d\n", 
f‹r
, 
Ãw_v®
);

277 *
¦si_dbg_f‹rs
[
f‹r
] = 
Ãw_v®
;

281 
	}
}

283 
	$¦si_dbg_g‘_·¿m_cb
(*
bufãr
, cÚ¡ 
k”Ãl_·¿m
 *
kp
)

285 
	#KERN_PARAM_OPS_MAX_BUF_SIZE
 (4 * 1024)

	)

286 
f‹r
;

287 
v®
 = 0;

289 
f‹r
 = *((*)(
kp
->
¬g
));

291 ià(
f‹r
 =ğ
SLSI_OVERRIDE_ALL_FILTER
)

292 
v®
 = 
¦si_dbg_lvl_®l
;

293 ià(
f‹r
 < 0 || f‹¸>ğ
SLSI_DF_MAX
)

294 
	`´_šfo
("%s: f‹¸%d ouˆoà¿nge\n", 
__func__
, 
f‹r
);

296 
v®
 = *
¦si_dbg_f‹rs
[
f‹r
];

298  
	`¢´štf
(
bufãr
, 
KERN_PARAM_OPS_MAX_BUF_SIZE
, "%i", 
v®
);

299 
	}
}

301 
moduË_·¿m_cb
(
¦si_dbg_lvl_®l
, &
·¿m_İs_log
, (*)&
SLSI_OVERRIDE_ALL_FILTER
, 
S_IRUGO
 | 
S_IWUSR
);

302 
MODULE_PARM_DESC
(
¦si_dbg_lvl_®l
, "Override debug†evel (0~4) for‡llhe†og modules (-1 = do‚ot override) default=0");

	@debug.h

7 #iâdeà
__DEBUG_H__


8 
	#__DEBUG_H__


	)

10 
	~<lšux/k”Ãl.h
>

11 
	~"dev.h
"

12 
	~<scsc/scsc_logršg.h
>

17 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


18 #iâdeà
MAC2STR


19 
	#MAC2STR
(
a
è×)[0], (a)[1], (a)[2], (a)[3], (a)[4], (a)[5]

	)

20 
	#MACSTR
 "%02x:%02x:%02x:%02x:%02x:%02x"

	)

23 #iâdeà
MAC2STR


24 
	#MAC2STR
(
a
è×)[0], (a)[4], (a)[5]

	)

25 
	#MACSTR
 "%02x:**:**:**:%02x:%02x"

	)

29 #iâdeà
CONFIG_SCSC_DEBUG_COMPATIBILITY


30 cÚ¡ 
SLSI_INIT_DEINIT
;

31 cÚ¡ 
SLSI_NETDEV
;

32 cÚ¡ 
SLSI_CFG80211
;

33 cÚ¡ 
SLSI_MLME
;

34 cÚ¡ 
SLSI_SUMMARY_FRAMES
;

35 cÚ¡ 
SLSI_HYDRA
;

36 cÚ¡ 
SLSI_TX
;

37 cÚ¡ 
SLSI_RX
;

38 cÚ¡ 
SLSI_UDI
;

40 cÚ¡ 
SLSI_WIFI_FCQ
;

42 cÚ¡ 
SLSI_HIP
;

43 cÚ¡ 
SLSI_HIP_INIT_DEINIT
;

44 cÚ¡ 
SLSI_HIP_FW_DL
;

45 cÚ¡ 
SLSI_HIP_SDIO_OP
;

46 cÚ¡ 
SLSI_HIP_PS
;

47 cÚ¡ 
SLSI_HIP_TH
;

48 cÚ¡ 
SLSI_HIP_FH
;

49 cÚ¡ 
SLSI_HIP_SIG
;

51 cÚ¡ 
SLSI_FUNC_TRACE
;

52 cÚ¡ 
SLSI_TEST
;

53 cÚ¡ 
SLSI_SRC_SINK
;

54 cÚ¡ 
SLSI_FW_TEST
;

55 cÚ¡ 
SLSI_RX_BA
;

57 cÚ¡ 
SLSI_TDLS
;

58 cÚ¡ 
SLSI_GSCAN
;

59 cÚ¡ 
SLSI_MBULK
;

60 cÚ¡ 
SLSI_FLOWC
;

61 cÚ¡ 
SLSI_SMAPPER
;

64 *
¦si_dbg_f‹rs
[];

66 #iâdeà
´_w¬n


67 
	#´_w¬n
 
´_w¬nšg


	)

77 
	#SLSI_EWI_NODEV_LABEL
 "›“80211…hy.: "

	)

78 
	#SLSI_EWI_DEV
(
sdev
è(
	`lik–y
((sdevè&& ((sdev)->
why
)è? &((sdev)->why->
dev
è: 
NULL
)

	)

79 
	#SLSI_EWI_NET_DEV
(
ndev
è(
	`lik–y
Òdevè? 
	`SLSI_EWI_DEV
(((
Ãtdev_vif
 *)
	`Ãtdev_´iv
Òdev))->
sdev
è: 
NULL
)

	)

80 
	#SLSI_EWI_NET_NAME
(
ndev
è(
	`lik–y
Òdevè? 
	`Ãtdev_Çme
Òdevè: 
NULL
)

	)

82 
	#SLSI_EWI
(
ouut
, 
sdev
, 
Ïb–
, 
fmt
, 
¬g
 ...è
	`ouut
(
	`SLSI_EWI_DEV
(sdev), 
SCSC_PREFIX
†ab– ": %s: " fmt, 
__func__
, ##‡rg)

	)

83 
	#SLSI_EWI_NET
(
ouut
, 
ndev
, 
Ïb–
, 
fmt
, 
¬g
 ...è
	`ouut
(
	`SLSI_EWI_NET_DEV
Òdev), 
SCSC_PREFIX
 "%s: "†ab– ": %s: " fmt, 
	`SLSI_EWI_NET_NAME
Òdev), 
__func__
, ##‡rg)

	)

84 
	#SLSI_EWI_NODEV
(
ouut
, 
Ïb–
, 
fmt
, 
¬g
 ...è
	`ouut
(
SLSI_EWI_NODEV_LABEL
 
SCSC_PREFIX
†ab– ": %s: " fmt, 
__func__
, ##‡rg)

	)

86 
	#SLSI_EWI_HEX
(
ouut
, 
kËv–
, 
sdev
, 
Ïb–
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...) \

88 
	`SLSI_EWI
(
ouut
, 
sdev
, 
Ïb–
, 
fmt
, ## 
¬g
); \

89 
	`´št_hex_dump
(
kËv–
, 
SCSC_PREFIX
, 
DUMP_PREFIX_OFFSET
, 16, 1, 
p
, 
Ën
, 0); \

90 } 0)

	)

92 
	#SLSI_EWI_HEX_NET
(
ouut
, 
kËv–
, 
dev
, 
Ïb–
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...) \

94 
	`SLSI_EWI_NET
(
ouut
, 
dev
, 
Ïb–
, 
fmt
, ## 
¬g
); \

95 
	`´št_hex_dump
(
kËv–
, 
SCSC_PREFIX
, 
DUMP_PREFIX_OFFSET
, 16, 1, 
p
, 
Ën
, 0); \

96 } 0)

	)

98 
	#SLSI_EWI_HEX_NODEV
(
ouut
, 
kËv–
, 
Ïb–
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...) \

100 
	`SLSI_EWI_NODEV
(
ouut
, 
Ïb–
, 
fmt
, ## 
¬g
); \

101 
	`´št_hex_dump
(
kËv–
, 
SCSC_PREFIX
, 
DUMP_PREFIX_OFFSET
, 16, 1, 
p
, 
Ën
, 0); \

102 } 0)

	)

104 
	#SLSI_ERR
(
sdev
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI
(
dev_”r
, sdev, "E", fmt, ##‡rg)

	)

105 
	#SLSI_WARN
(
sdev
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI
(
dev_w¬n
, sdev, "W", fmt, ##‡rg)

	)

106 
	#SLSI_INFO
(
sdev
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI
(
dev_šfo
, sdev, "I", fmt, ##‡rg)

	)

108 
	#SLSI_NET_ERR
(
ndev
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI_NET
(
dev_”r
,‚dev, "E", fmt, ##‡rg)

	)

109 
	#SLSI_NET_WARN
(
ndev
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI_NET
(
dev_w¬n
,‚dev, "W", fmt, ##‡rg)

	)

110 
	#SLSI_NET_INFO
(
ndev
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI_NET
(
dev_šfo
,‚dev, "I", fmt, ##‡rg)

	)

112 
	#SLSI_ERR_NODEV
(
fmt
, 
¬g
 ...è
	`SLSI_EWI_NODEV
(
´_”r
, "E", fmt, ##‡rg)

	)

113 
	#SLSI_WARN_NODEV
(
fmt
, 
¬g
 ...è
	`SLSI_EWI_NODEV
(
´_w¬n
, "W", fmt, ##‡rg)

	)

114 
	#SLSI_INFO_NODEV
(
fmt
, 
¬g
 ...è
	`SLSI_EWI_NODEV
(
´_šfo
, "I", fmt, ##‡rg)

	)

116 
	#SLSI_ERR_HEX
(
sdev
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI_HEX
(
dev_”r
, 
KERN_ERR
, sdev, "E",…,†’, fmt, ##‡rg)

	)

117 
	#SLSI_WARN_HEX
(
sdev
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI_HEX
(
dev_w¬n
, 
KERN_WARN
, sdev, "W",…,†’, fmt, ##‡rg)

	)

118 
	#SLSI_INFO_HEX
(
sdev
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI_HEX
(
dev_šfo
, 
KERN_INFO
, sdev, "I",…,†’, fmt, ##‡rg)

	)

120 
	#SLSI_ERR_HEX_NODEV
(
p
, 
Ën
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI_HEX_NODEV
(
´_”r
, 
KERN_ERR
, "E",…,†’, fmt, ##‡rg)

	)

121 
	#SLSI_WARN_HEX_NODEV
(
p
, 
Ën
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI_HEX_NODEV
(
´_w¬n
, 
KERN_WARN
, "W",…,†’, fmt, ##‡rg)

	)

122 
	#SLSI_INFO_HEX_NODEV
(
p
, 
Ën
, 
fmt
, 
¬g
 ...è
	`SLSI_EWI_HEX_NODEV
(
´_šfo
, 
KERN_INFO
, "I",…,†’, fmt, ##‡rg)

	)

124 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


126 
	#SLSI_DBG
(
sdev
, 
f‹r
, 
dbg_lvl
, 
fmt
, 
¬g
 ...) \

128 ià(
	`uÆik–y
((
dbg_lvl
è<ğ*
¦si_dbg_f‹rs
[
f‹r
])) { \

129 
	`SLSI_EWI
(
dev_šfo
, 
sdev
, #dbg_lvl, 
fmt
, ## 
¬g
); \

131 } 0)

	)

133 
	#SLSI_DBG_NET
(
ndev
, 
f‹r
, 
dbg_lvl
, 
fmt
, 
¬g
 ...) \

135 ià(
	`uÆik–y
((
dbg_lvl
è<ğ*
¦si_dbg_f‹rs
[
f‹r
])) { \

136 
	`SLSI_EWI_NET
(
dev_šfo
, 
ndev
, #dbg_lvl, 
fmt
, ## 
¬g
); \

138 } 0)

	)

140 
	#SLSI_DBG_NODEV
(
f‹r
, 
dbg_lvl
, 
fmt
, 
¬g
 ...) \

142 ià(
	`uÆik–y
((
dbg_lvl
è<ğ*
¦si_dbg_f‹rs
[
f‹r
])) { \

143 
	`SLSI_EWI_NODEV
(
´_šfo
, #dbg_lvl, 
fmt
, ## 
¬g
); \

145 } 0)

	)

147 
	#SLSI_DBG1
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG
(sdev, f‹r, 1, fmt, ##‡rg)

	)

148 
	#SLSI_DBG2
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG
(sdev, f‹r, 2, fmt, ##‡rg)

	)

149 
	#SLSI_DBG3
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG
(sdev, f‹r, 3, fmt, ##‡rg)

	)

150 
	#SLSI_DBG4
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG
(sdev, f‹r, 4, fmt, ##‡rg)

	)

152 
	#SLSI_NET_DBG1
(
ndev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG_NET
Òdev, f‹r, 1, fmt, ##‡rg)

	)

153 
	#SLSI_NET_DBG2
(
ndev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG_NET
Òdev, f‹r, 2, fmt, ##‡rg)

	)

154 
	#SLSI_NET_DBG3
(
ndev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG_NET
Òdev, f‹r, 3, fmt, ##‡rg)

	)

155 
	#SLSI_NET_DBG4
(
ndev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG_NET
Òdev, f‹r, 4, fmt, ##‡rg)

	)

157 
	#SLSI_DBG1_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG_NODEV
(f‹r, 1, fmt, ##‡rg)

	)

158 
	#SLSI_DBG2_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG_NODEV
(f‹r, 2, fmt, ##‡rg)

	)

159 
	#SLSI_DBG3_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG_NODEV
(f‹r, 3, fmt, ##‡rg)

	)

160 
	#SLSI_DBG4_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG_NODEV
(f‹r, 4, fmt, ##‡rg)

	)

163 
	#LOG_CONDITIONALLY
(
cÚd™iÚ
, 
LOG_ENTRY
) \

165 ià(
	`uÆik–y
(
cÚd™iÚ
)) \

166 
LOG_ENTRY
; \

167 } 0)

	)

170 
	#LOG_BOOL_FLAG
(
æag
) \

171 (
æag
è? "TRUE" : "FALSE"

	)

173 
	#SLSI_DBG_HEX_OUT
(
sdev
, 
f‹r
, 
dbg_lvl
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...) \

175 ià(
	`uÆik–y
((
dbg_lvl
è<ğ*
¦si_dbg_f‹rs
[
f‹r
])) { \

176 
	`SLSI_EWI_HEX
(
dev_šfo
, 
KERN_INFO
, 
sdev
, #dbg_lvl, 
p
, 
Ën
, 
fmt
, ## 
¬g
); \

178 } 0)

	)

180 
	#SLSI_DBG_HEX_OUT_NET
(
sdev
, 
f‹r
, 
dbg_lvl
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...) \

182 ià(
	`uÆik–y
((
dbg_lvl
è<ğ*
¦si_dbg_f‹rs
[
f‹r
])) { \

183 
	`SLSI_EWI_HEX_NET
(
dev_šfo
, 
KERN_INFO
, 
dev
, #dbg_lvl, 
p
, 
Ën
, 
fmt
, ## 
¬g
); \

185 } 0)

	)

187 
	#SLSI_DBG_HEX_OUT_NODEV
(
f‹r
, 
dbg_lvl
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...) \

189 ià(
	`uÆik–y
((
dbg_lvl
è<ğ*
¦si_dbg_f‹rs
[
f‹r
])) { \

190 
	`SLSI_EWI_HEX_NODEV
(
´_šfo
, 
KERN_INFO
, #dbg_lvl, 
p
, 
Ën
, 
fmt
, ## 
¬g
); \

192 } 0)

	)

194 
	#SLSI_DBG_HEX
(
sdev
, 
f‹r
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG_HEX_OUT
(sdev, f‹r, 4,…,†’, fmt, ##‡rg)

	)

195 
	#SLSI_NET_DBG_HEX
(
dev
, 
f‹r
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG_HEX_OUT_NET
(dev, f‹r, 4,…,†’, fmt, ##‡rg)

	)

196 
	#SLSI_DBG_HEX_NODEV
(
f‹r
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...è
	`SLSI_DBG_HEX_OUT_NODEV
(f‹r, 4,…,†’, fmt, ##‡rg)

	)

198 
	#FUNC_ENTER
(
sdev
è
	`SLSI_DBG4
(sdev, 
SLSI_FUNC_TRACE
, "--->\n")

	)

199 
	#FUNC_EXIT
(
sdev
è
	`SLSI_DBG4
(sdev, 
SLSI_FUNC_TRACE
, "<---\n")

	)

201 
	#FUNC_ENTER_NODEV
(è
	`SLSI_DBG4_NODEV
(
SLSI_FUNC_TRACE
, "--->\n")

	)

202 
	#FUNC_EXIT_NODEV
(è
	`SLSI_DBG4_NODEV
(
SLSI_FUNC_TRACE
, "<---\n")

	)

204 
¦si_debug_äame
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, cÚ¡ *
´efix
);

207 
	#SLSI_DBG1
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

208 
	#SLSI_DBG2
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

209 
	#SLSI_DBG3
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

210 
	#SLSI_DBG4
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

211 
	#SLSI_NET_DBG1
(
dev
, 
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

212 
	#SLSI_NET_DBG2
(
dev
, 
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

213 
	#SLSI_NET_DBG3
(
dev
, 
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

214 
	#SLSI_NET_DBG4
(
dev
, 
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

215 
	#SLSI_DBG1_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

216 
	#SLSI_DBG2_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

217 
	#SLSI_DBG3_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

218 
	#SLSI_DBG4_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

220 
	#LOG_CONDITIONALLY
(
cÚd™iÚ
, 
LOG_ENTRY
èdØ{} 0)

	)

221 
	#LOG_BOOL_FLAG
(
æag
èdØ{} 0)

	)

223 
	#SLSI_DBG_HEX
(
sdev
, 
f‹r
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

224 
	#SLSI_NET_DBG_HEX
(
dev
, 
f‹r
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

225 
	#SLSI_DBG_HEX_NODEV
(
f‹r
, 
p
, 
Ën
, 
fmt
, 
¬g
 ...èdØ{} 0)

	)

227 
	#FUNC_ENTER
(
sdev
)

	)

228 
	#FUNC_EXIT
(
sdev
)

	)

230 
	#FUNC_ENTER_NODEV
()

	)

231 
	#FUNC_EXIT_NODEV
()

	)

233 
šlše
 
	$¦si_debug_äame
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, cÚ¡ *
´efix
)

235 ()
sdev
;

236 ()
dev
;

237 ()
skb
;

238 ()
´efix
;

239 
	}
}

243 #ifdeà
CONFIG_SCSC_DEBUG_COMPATIBILITY


245 #undeà
SLSI_ERR


246 #undeà
SLSI_WARN


247 #undeà
SLSI_INFO


248 
	#SLSI_ERR
(
sdev
, 
fmt
, 
¬g
 ...è
	`SCSC_ERR_SDEV
(sdev, fmt, ##‡rg)

	)

249 
	#SLSI_WARN
(
sdev
, 
fmt
, 
¬g
 ...è
	`SCSC_WARNING_SDEV
(sdev, fmt, ##‡rg)

	)

250 
	#SLSI_INFO
(
sdev
, 
fmt
, 
¬g
 ...è
	`SCSC_INFO_SDEV
(sdev, fmt, ##‡rg)

	)

252 #undeà
SLSI_NET_ERR


253 #undeà
SLSI_NET_WARN


254 #undeà
SLSI_NET_INFO


255 
	#SLSI_NET_ERR
(
ndev
, 
fmt
, 
¬g
 ...è
	`SCSC_ERR_NDEV
Òdev, fmt, ##‡rg)

	)

256 
	#SLSI_NET_WARN
(
ndev
, 
fmt
, 
¬g
 ...è
	`SCSC_WARNING_NDEV
Òdev, fmt, ##‡rg)

	)

257 
	#SLSI_NET_INFO
(
ndev
, 
fmt
, 
¬g
 ...è
	`SCSC_INFO_NDEV
Òdev, fmt, ##‡rg)

	)

259 #undeà
SLSI_ERR_NODEV


260 #undeà
SLSI_WARN_NODEV


261 #undeà
SLSI_INFO_NODEV


262 
	#SLSI_ERR_NODEV
(
fmt
, 
¬g
 ...è
	`SCSC_ERR
(fmt, ##‡rg)

	)

263 
	#SLSI_WARN_NODEV
(
fmt
, 
¬g
 ...è
	`SCSC_WARNING
(fmt, ##‡rg)

	)

264 
	#SLSI_INFO_NODEV
(
fmt
, 
¬g
 ...è
	`SCSC_INFO
(fmt, ##‡rg)

	)

266 #undeà
SLSI_DBG1


267 #undeà
SLSI_DBG2


268 #undeà
SLSI_DBG3


269 #undeà
SLSI_DBG4


270 
	#SLSI_DBG1
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG1_SDEV
(sdev, f‹r, fmt, ##‡rg)

	)

271 
	#SLSI_DBG2
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG2_SDEV
(sdev, f‹r, fmt, ##‡rg)

	)

272 
	#SLSI_DBG3
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG3_SDEV
(sdev, f‹r, fmt, ##‡rg)

	)

273 
	#SLSI_DBG4
(
sdev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG4_SDEV
(sdev, f‹r, fmt, ##‡rg)

	)

275 #undeà
SLSI_NET_DBG1


276 #undeà
SLSI_NET_DBG2


277 #undeà
SLSI_NET_DBG3


278 #undeà
SLSI_NET_DBG4


279 
	#SLSI_NET_DBG1
(
ndev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG1_NDEV
Òdev, f‹r, fmt, ##‡rg)

	)

280 
	#SLSI_NET_DBG2
(
ndev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG2_NDEV
Òdev, f‹r, fmt, ##‡rg)

	)

281 
	#SLSI_NET_DBG3
(
ndev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG3_NDEV
Òdev, f‹r, fmt, ##‡rg)

	)

282 
	#SLSI_NET_DBG4
(
ndev
, 
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG4_NDEV
Òdev, f‹r, fmt, ##‡rg)

	)

284 #undeà
SLSI_DBG1_NODEV


285 #undeà
SLSI_DBG2_NODEV


286 #undeà
SLSI_DBG3_NODEV


287 #undeà
SLSI_DBG4_NODEV


288 
	#SLSI_DBG1_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG1
(f‹r, fmt, ##‡rg)

	)

289 
	#SLSI_DBG2_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG2
(f‹r, fmt, ##‡rg)

	)

290 
	#SLSI_DBG3_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG3
(f‹r, fmt, ##‡rg)

	)

291 
	#SLSI_DBG4_NODEV
(
f‹r
, 
fmt
, 
¬g
 ...è
	`SCSC_TAG_DBG4
(f‹r, fmt, ##‡rg)

	)

	@debug_frame.c

7 
	~<lšux/›“80211.h
>

8 
	~<lšux/¿‹lim™.h
>

10 
	~"debug.h
"

11 
	~"çpi.h
"

12 
	~"cÚ¡.h
"

13 
	~"mgt.h
"

15 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


18 
	g¦si_debug_summ¬y_äame
 = 3;

19 
moduË_·¿m
(
¦si_debug_summ¬y_äame
, , 
S_IRUGO
 | 
S_IWUSR
);

20 
MODULE_PARM_DESC
(
¦si_debug_summ¬y_äame
, "Debug†evel (0: disable, 1: mgmt only (no scan), 2: mgmt‡nd imp frames, 3:‡ll");

22 
	s¦si_decode_’Œy
 {

23 cÚ¡ *
	mÇme
;

24 (*
	mdecode_â
)(
u8
 *
	mäame
, 
u16
 
	mäame_Ëngth
, *
	m»suÉ
, 
size_t
 
	m»suÉ_Ëngth
);

27 
	s¦si_decode_¢­
 {

28 cÚ¡ 
u8
 
	m¢­
[8];

29 cÚ¡ *
	mÇme
;

30 
size_t
 (*
decode_â
)(
u8
 *
	mäame
, 
u16
 
	mäame_Ëngth
, *
	m»suÉ
, size_ˆ
	m»suÉ_Ëngth
);

33 
	s¦si_v®ue_Çme_decode
 {

34 cÚ¡ 
u16
 
	mv®ue
;

35 cÚ¡ *
	mÇme
;

36 
size_t
 (*
decode_â
)(
u8
 *
	mäame
, 
u16
 
	mäame_Ëngth
, *
	m»suÉ
, size_ˆ
	m»suÉ_Ëngth
);

39 
size_t
 
	$¦si_decode_basic_›_šfo
(
u8
 *
›s
, 
u16
 
›s_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

41 
size_t
 
size_wr™‹n
 = 0;

42 cÚ¡ 
u8
 *
ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
›s
, 
›s_Ëngth
);

43 cÚ¡ 
u8
 *
r¢
 = 
	`cfg80211_fšd_›
(
WLAN_EID_RSN
, 
›s
, 
›s_Ëngth
);

44 cÚ¡ 
u8
 *
w·
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPA
, 
›s
, 
›s_Ëngth
);

45 cÚ¡ 
u8
 *
wps
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPS
, 
›s
, 
›s_Ëngth
);

46 cÚ¡ 
u8
 *
htİ
 = 
	`cfg80211_fšd_›
(
WLAN_EID_HT_OPERATION
, 
›s
, 
›s_Ëngth
);

47 cÚ¡ 
u8
 *
couÁry
 = 
	`cfg80211_fšd_›
(
WLAN_EID_COUNTRY
, 
›s
, 
›s_Ëngth
);

49 ià(
htİ
 && htop[1]) {

50 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_wr™‹n, " chªÃl:%d", 
htİ
[2]);

52 cÚ¡ 
u8
 *
ds
 = 
	`cfg80211_fšd_›
(
WLAN_EID_DS_PARAMS
, 
›s
, 
›s_Ëngth
);

54 ià(
ds
)

55 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_wr™‹n, " chªÃl:%d", 
ds
[2]);

58 ià(
ssid
) {

59 ià(
ssid
[1])

60 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_wr™‹n, " %.*s", 
ssid
[1], (*)&ssid[2]);

62 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written, " <HIDDEN>");

65 ià(
couÁry
)

66 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_wr™‹n, " couÁry:%c%c%c", 
couÁry
[2], country[3], country[4]);

67 ià(
w·
)

68 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written, " wpa");

69 ià(
r¢
)

70 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written, " wpa2");

71 ià(
wps
)

72 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written, " wps");

73  
size_wr™‹n
;

74 
	}
}

76 
	$¦si_decode_äame_›s_Úly
(
u8
 
off£t
, u8 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

78 
size_t
 
¡r_Ën
;

80 
»suÉ
[0] = '(';

81 
¡r_Ën
 = 
	`¦si_decode_basic_›_šfo
(
äame
 + 
off£t
,

82 
äame_Ëngth
 - 
off£t
,

83 
»suÉ
 + 1,

84 
»suÉ_Ëngth
 - 1);

85 
»suÉ
[1 + 
¡r_Ën
] = ')';

86 
»suÉ
[2 + 
¡r_Ën
] = '\0';

87 
	}
}

89 
size_t
 
	$¦si_decode_äame_Ëu16
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
, cÚ¡ *
Çme
)

91 
u16
 
v®ue
 = 
äame
[0] | frame[1] << 8;

93 
	`SLSI_UNUSED_PARAMETER
(
äame_Ëngth
);

95  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "%s:%u", 
Çme
, 
v®ue
);

96 
	}
}

98 
	#SLSI_ASSOC_REQ_IE_OFFSET
 4

	)

99 
	$¦si_decode_assoc_»q
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

101 
	`¦si_decode_äame_›s_Úly
(
SLSI_ASSOC_REQ_IE_OFFSET
, 
äame
, 
äame_Ëngth
, 
»suÉ
, 
»suÉ_Ëngth
);

102 
	}
}

104 
	#SLSI_ASSOC_RSP_STATUS_OFFSET
 2

	)

105 
	#SLSI_ASSOC_RSP_IE_OFFSET
 6

	)

106 
	$¦si_decode_assoc_r¥
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

108 
size_t
 
¡r_Ën
 = 0;

110 
»suÉ
[
¡r_Ën
++] = '(';

111 
¡r_Ën
 +ğ
	`¦si_decode_äame_Ëu16
(
äame
 + 
SLSI_ASSOC_RSP_STATUS_OFFSET
,

112 
äame_Ëngth
 - 
SLSI_ASSOC_RSP_STATUS_OFFSET
,

113 
»suÉ
 + 
¡r_Ën
,

114 
»suÉ_Ëngth
 - 
¡r_Ën
,

116 
¡r_Ën
 +ğ
	`¦si_decode_basic_›_šfo
(
äame
 + 
SLSI_ASSOC_RSP_IE_OFFSET
,

117 
äame_Ëngth
 - 
SLSI_ASSOC_RSP_IE_OFFSET
,

118 
»suÉ
 + 
¡r_Ën
,

119 
»suÉ_Ëngth
 - 
¡r_Ën
);

120 
»suÉ
[
¡r_Ën
++] = ')';

121 
»suÉ
[
¡r_Ën
] = '\0';

122 
	}
}

124 
	#SLSI_DEAUTH_REASON_OFFSET
 0

	)

125 
	$¦si_decode_d—uth
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

127 
size_t
 
¡r_Ën
 = 0;

129 
»suÉ
[
¡r_Ën
++] = '(';

130 
¡r_Ën
 +ğ
	`¦si_decode_äame_Ëu16
(
äame
 + 
SLSI_DEAUTH_REASON_OFFSET
,

131 
äame_Ëngth
 - 
SLSI_DEAUTH_REASON_OFFSET
,

132 
»suÉ
 + 
¡r_Ën
,

133 
»suÉ_Ëngth
 - 
¡r_Ën
,

135 
»suÉ
[
¡r_Ën
++] = ')';

136 
»suÉ
[
¡r_Ën
] = '\0';

137 
	}
}

139 
	#SLSI_AUTH_ALGO_OFFSET
 0

	)

140 
	#SLSI_AUTH_SEQ_OFFSET
 2

	)

141 
	#SLSI_AUTH_STATUS_OFFSET
 4

	)

142 
	$¦si_decode_auth
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

144 
size_t
 
¡r_Ën
 = 0;

146 
»suÉ
[
¡r_Ën
++] = '(';

147 
¡r_Ën
 +ğ
	`¦si_decode_äame_Ëu16
(
äame
 + 
SLSI_AUTH_ALGO_OFFSET
,

148 
äame_Ëngth
 - 
SLSI_AUTH_ALGO_OFFSET
,

149 
»suÉ
 + 
¡r_Ën
,

150 
»suÉ_Ëngth
 - 
¡r_Ën
,

152 
»suÉ
[
¡r_Ën
++] = ' ';

153 
¡r_Ën
 +ğ
	`¦si_decode_äame_Ëu16
(
äame
 + 
SLSI_AUTH_SEQ_OFFSET
,

154 
äame_Ëngth
 - 
SLSI_AUTH_SEQ_OFFSET
,

155 
»suÉ
 + 
¡r_Ën
,

156 
»suÉ_Ëngth
 - 
¡r_Ën
,

158 
»suÉ
[
¡r_Ën
++] = ' ';

159 
¡r_Ën
 +ğ
	`¦si_decode_äame_Ëu16
(
äame
 + 
SLSI_AUTH_STATUS_OFFSET
,

160 
äame_Ëngth
 - 
SLSI_AUTH_STATUS_OFFSET
,

161 
»suÉ
 + 
¡r_Ën
,

162 
»suÉ_Ëngth
 - 
¡r_Ën
,

164 
»suÉ
[
¡r_Ën
++] = ' ';

165 
»suÉ
[
¡r_Ën
++] = ')';

166 
»suÉ
[
¡r_Ën
] = '\0';

167 
	}
}

169 
	#SLSI_REASSOC_IE_OFFSET
 10

	)

170 
	$¦si_decode_»assoc_»q
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

172 
	`¦si_decode_äame_›s_Úly
(
SLSI_REASSOC_IE_OFFSET
, 
äame
, 
äame_Ëngth
, 
»suÉ
, 
»suÉ_Ëngth
);

173 
	}
}

175 
	#SLSI_BEACON_IE_OFFSET
 12

	)

176 
	$¦si_decode_b—cÚ
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

178 
	`¦si_decode_äame_›s_Úly
(
SLSI_BEACON_IE_OFFSET
, 
äame
, 
äame_Ëngth
, 
»suÉ
, 
»suÉ_Ëngth
);

179 
	}
}

181 
	#SLSI_PROBEREQ_IE_OFFSET
 0

	)

182 
	$¦si_decode_´obe_»q
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

184 
	`¦si_decode_äame_›s_Úly
(
SLSI_PROBEREQ_IE_OFFSET
, 
äame
, 
äame_Ëngth
, 
»suÉ
, 
»suÉ_Ëngth
);

185 
	}
}

187 
	#SLSI_ACTION_BLOCK_ACK_ADDBA_REQ
 0

	)

188 
	#SLSI_ACTION_BLOCK_ACK_ADDBA_RSP
 1

	)

189 
	#SLSI_ACTION_BLOCK_ACK_DELBA
 2

	)

190 
size_t
 
	$¦si_decode_aùiÚ_blockack
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

192 
u8
 
aùiÚ
 = 
äame
[1];

194 
	`SLSI_UNUSED_PARAMETER
(
äame_Ëngth
);

196 
aùiÚ
) {

197 
SLSI_ACTION_BLOCK_ACK_ADDBA_REQ
:

199 
u8
 
tok’
 = 
äame
[2];

201  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->ADDBAReqÑok’:%u)", 
tok’
);

203 
SLSI_ACTION_BLOCK_ACK_ADDBA_RSP
:

205 
u8
 
tok’
 = 
äame
[2];

206 
u16
 
¡©us
 = 
äame
[3] | frame[4] << 8;

208  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->ADDBAR¥Ñok’:%u, stus:%u)", 
tok’
, 
¡©us
);

210 
SLSI_ACTION_BLOCK_ACK_DELBA
:

212 
u16
 
»asÚ_code
 = 
äame
[4] | frame[5] << 8;

214  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->DELBAÔ—sÚ_code:%u)", 
»asÚ_code
);

217  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->AùiÚ(%u)", 
aùiÚ
);

219 
	}
}

221 
	#SLSI_ACTION_PUBLIC_DISCOVERY_RSP
 14

	)

223 
size_t
 
	$¦si_decode_aùiÚ_public
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

225 
u8
 
aùiÚ
 = 
äame
[1];

227 
	`SLSI_UNUSED_PARAMETER
(
äame_Ëngth
);

229 
aùiÚ
) {

230 
SLSI_ACTION_PUBLIC_DISCOVERY_RSP
:

232 
u8
 
tok’
 = 
äame
[2];

234  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->Discov”yR¥Ñok’:%u)", 
tok’
);

237  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->AùiÚ(%u)", 
aùiÚ
);

239 
	}
}

241 
	#SLSI_ACTION_TDLS_SETUP_REQ
 0

	)

242 
	#SLSI_ACTION_TDLS_SETUP_RSP
 1

	)

243 
	#SLSI_ACTION_TDLS_SETUP_CFM
 2

	)

244 
	#SLSI_ACTION_TDLS_TEARDOWN
 3

	)

245 
	#SLSI_ACTION_TDLS_PEER_TRAFFIC_IND
 4

	)

246 
	#SLSI_ACTION_TDLS_CHANNEL_SWITCH_REQ
 5

	)

247 
	#SLSI_ACTION_TDLS_CHANNEL_SWITCH_RSP
 6

	)

248 
	#SLSI_ACTION_TDLS_PEER_PSM_REQ
 7

	)

249 
	#SLSI_ACTION_TDLS_PEER_PSM_RSP
 8

	)

250 
	#SLSI_ACTION_TDLS_PEER_TRAFFIC_RSP
 9

	)

251 
	#SLSI_ACTION_TDLS_DISCOVERY_REQ
 10

	)

253 
size_t
 
	$¦si_decode_aùiÚ_tdls
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

255 
u8
 
aùiÚ
 = 
äame
[1];

257 
	`SLSI_UNUSED_PARAMETER
(
äame_Ëngth
);

259 
aùiÚ
) {

260 
SLSI_ACTION_TDLS_SETUP_REQ
:

262 
u8
 
tok’
 = 
äame
[2];

264  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->S‘upReqÑok’:%u)", 
tok’
);

266 
SLSI_ACTION_TDLS_SETUP_RSP
:

268 
u16
 
¡©us
 = 
äame
[2] | frame[3] << 8;

269 
u8
 
tok’
 = 
äame
[4];

271  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->S‘upR¥Ñok’:%u, stus:%u)", 
tok’
, 
¡©us
);

273 
SLSI_ACTION_TDLS_SETUP_CFM
:

275 
u16
 
¡©us
 = 
äame
[2] | frame[3] << 8;

276 
u8
 
tok’
 = 
äame
[4];

278  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->S‘upCfmÑok’:%u, stus:%u)", 
tok’
, 
¡©us
);

280 
SLSI_ACTION_TDLS_TEARDOWN
:

282 
u16
 
»asÚ
 = 
äame
[2] | frame[3] << 8;

284  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->S‘upCfmÔ—sÚ:%u)", 
»asÚ
);

286 
SLSI_ACTION_TDLS_PEER_TRAFFIC_IND
:

288 
u8
 
tok’
 = 
äame
[2];

290  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->P“rT¿fficIndÑok’:%u)", 
tok’
);

292 
SLSI_ACTION_TDLS_CHANNEL_SWITCH_REQ
:

294 
u8
 
chªÃl
 = 
äame
[2];

296  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->ChªÃlSw™chReq(chªÃl:%u)", 
chªÃl
);

298 
SLSI_ACTION_TDLS_CHANNEL_SWITCH_RSP
:

300 
u16
 
¡©us
 = 
äame
[2] | frame[3] << 8;

302  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->ChªÃlSw™chR¥(¡©us:%u)", 
¡©us
);

304 
SLSI_ACTION_TDLS_PEER_PSM_REQ
:

306 
u8
 
tok’
 = 
äame
[2];

308  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->P“rPSMReqÑok’:%u)", 
tok’
);

310 
SLSI_ACTION_TDLS_PEER_PSM_RSP
:

312 
u8
 
tok’
 = 
äame
[2];

313 
u16
 
¡©us
 = 
äame
[3] | frame[4] << 8;

315  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->P“rPSMR¥Ñok’:%u, stus:%u)", 
tok’
, 
¡©us
);

317 
SLSI_ACTION_TDLS_PEER_TRAFFIC_RSP
:

319 
u8
 
tok’
 = 
äame
[2];

321  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->P“rT¿fficR¥Ñok’:%u)", 
tok’
);

323 
SLSI_ACTION_TDLS_DISCOVERY_REQ
:

325 
u8
 
tok’
 = 
äame
[2];

327  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->Discov”yReqÑok’:%u)", 
tok’
);

330  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->AùiÚ(%u)", 
aùiÚ
);

332 
	}
}

334 cÚ¡ 
¦si_v®ue_Çme_decode
 
	gaùiÚ_ÿ‹gÜ›s
[] = {

335 { 3, "BlockAck", 
¦si_decode_aùiÚ_blockack
 },

336 { 0, "S³ùrumMªagem’t", 
NULL
 },

337 { 1, "QoS", 
NULL
 },

338 { 2, "DLS", 
NULL
 },

339 { 4, "Public", 
¦si_decode_aùiÚ_public
 },

340 { 5, "RadioM—su»m’t", 
NULL
 },

341 { 6, "Fa¡BSST¿ns™iÚ", 
NULL
 },

342 { 7, "HT", 
NULL
 },

343 { 8, "SAQu”y", 
NULL
 },

344 { 9, "PrÙeùedDu®OfPublicAùiÚ", 
NULL
 },

345 { 12, "TDLS", 
¦si_decode_aùiÚ_tdls
 },

346 { 17, "Re£rvedWFA", 
NULL
 },

347 { 126, "V’dÜS³cificPrÙeùed", 
NULL
 },

348 { 127, "V’dÜS³cific", 
NULL
 },

349 { 132, "PublicÓ¼Ü)", 
¦si_decode_aùiÚ_public
 },

352 
	#SLSI_ACTION_CAT_BLOCK_ACK
 3

	)

353 
	$¦si_decode_aùiÚ
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

355 
u8
 
ÿ‹gÜy
 = 
äame
[0];

356 
u32
 
i
;

358 
i
 = 0; i < 
	`ARRAY_SIZE
(
aùiÚ_ÿ‹gÜ›s
); i++)

359 ià(
aùiÚ_ÿ‹gÜ›s
[
i
].
v®ue
 =ğ
ÿ‹gÜy
) {

360 
size_wr™‹n
 = 
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->%s", 
aùiÚ_ÿ‹gÜ›s
[
i
].
Çme
);

362 ià(
aùiÚ_ÿ‹gÜ›s
[
i
].
decode_â
)

363 
aùiÚ_ÿ‹gÜ›s
[
i
].
	`decode_â
(
äame
, 
äame_Ëngth
, 
»suÉ
 + 
size_wr™‹n
, 
»suÉ_Ëngth
 - size_written);

366 
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->ÿ‹gÜy:%u", 
ÿ‹gÜy
);

367 
	}
}

369 cÚ¡ *
	g¦si_¬p_İcodes
[] = {

398 
size_t
 
	$¦si_decode_¬p
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

405 
u16
 
İcode
 = 
äame
[6] << 8 | frame[7];

406 
u8
 *
sha
 = &
äame
[8];

407 
u8
 *
¥a
 = &
äame
[14];

408 
u8
 *
tha
 = &
äame
[18];

409 
u8
 *
a
 = &
äame
[24];

411 
	`SLSI_UNUSED_PARAMETER
(
äame_Ëngth
);

413 ià(
İcode
 < 
	`ARRAY_SIZE
(
¦si_¬p_İcodes
))

414  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->%s(sha:%.2X:%.2X:%.2X:%.2X:%.2X:%.2X, spa:%u.%u.%u.%u,ha:%.2X:%.2X:%.2X:%.2X:%.2X:%.2X,pa:%u.%u.%u.%u)",

415 
¦si_¬p_İcodes
[
İcode
],

416 
sha
[0], sha[1], sha[2], sha[3], sha[4], sha[5],

417 
¥a
[0], spa[1], spa[2], spa[3],

418 
tha
[0],ha[1],ha[2],ha[3],ha[4],ha[5],

419 
a
[0],pa[1],pa[2],pa[3]);

421  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->(İcode:%u)", 
İcode
);

422 
	}
}

424 cÚ¡ 
¦si_v®ue_Çme_decode
 
	g¦si_decode_—pŞ_·ck‘_ty³s
[] = {

425 { 1, "Id’t™y", 
NULL
 },

426 { 2, "NÙifiÿtiÚ", 
NULL
 },

427 { 3, "Nak", 
NULL
 },

428 { 4, "MD5Ch®Ënge", 
NULL
 },

429 { 5, "OÃTimePasswÜd", 
NULL
 },

430 { 6, "G’”icTok’C¬d", 
NULL
 },

431 { 9, "RSA PubliøKey Auth’tiÿtiÚ", 
NULL
 },

432 { 10, "DSS Un©”®", 
NULL
 },

433 { 11, "KEA", 
NULL
 },

434 { 12, "KEA-VALIDATE", 
NULL
 },

435 { 13, "EAP-TLS", 
NULL
 },

436 { 14, "Deãnd” Tok’ (AXENT)", 
NULL
 },

437 { 15, "RSA Secur™y SecurID EAP", 
NULL
 },

438 { 16, "ArcÙ Sy¡em EAP", 
NULL
 },

439 { 17, "EAP-CiscØWœ–ess", 
NULL
 },

440 { 18, "EAP-SIM", 
NULL
 },

441 { 19, "SRP-SHA1 P¬ˆ1", 
NULL
 },

442 { 21, "EAP-TTLS", 
NULL
 },

443 { 22, "RemÙAcûs S”viû", 
NULL
 },

444 { 23, "EAP-AKA", 
NULL
 },

445 { 24, "EAP-3Com Wœ–ess", 
NULL
 },

446 { 25, "PEAP", 
NULL
 },

447 { 26, "MS-EAP-Auth’tiÿtiÚ", 
NULL
 },

448 { 27, "MAKE", 
NULL
 },

449 { 28, "CRYPTOC¬d", 
NULL
 },

450 { 29, "EAP-MSCHAP-V2", 
NULL
 },

451 { 30, "DyÇmID", 
NULL
 },

452 { 31, "Rob EAP", 
NULL
 },

453 { 32, "EAP-POTP", 
NULL
 },

454 { 33, "MS-Auth’tiÿtiÚ-TLV", 
NULL
 },

455 { 34, "S’ŒiNET", 
NULL
 },

456 { 35, "EAP-AùiÚ‹øWœ–ess", 
NULL
 },

457 { 36, "Cog’ˆSy¡em Biom‘ric Auth’tiÿtiÚ EAP", 
NULL
 },

458 { 37, "AœFÜŒes EAP", 
NULL
 },

459 { 38, "EAP-HTTP Dige¡", 
NULL
 },

460 { 39, "Secu»Su™EAP", 
NULL
 },

461 { 40, "DeviûCÚÃù EAP", 
NULL
 },

462 { 41, "EAP-SPEKE", 
NULL
 },

463 { 42, "EAP-MOBAC", 
NULL
 },

464 { 43, "EAP-FAST", 
NULL
 },

465 { 44, "ZLXEAP", 
NULL
 },

466 { 45, "EAP-Lšk", 
NULL
 },

467 { 46, "EAP-PAX", 
NULL
 },

468 { 47, "EAP-PSK", 
NULL
 },

469 { 48, "EAP-SAKE", 
NULL
 },

470 { 49, "EAP-IKEv2", 
NULL
 },

471 { 50, "EAP-AKA", 
NULL
 },

472 { 51, "EAP-GPSK", 
NULL
 },

473 { 52, "EAP-pwd", 
NULL
 },

474 { 53, "EAP-EKE V1", 
NULL
 },

475 { 254, "WPS", 
NULL
 }

478 
size_t
 
	$¦si_decode_—pŞ_·ck‘
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

480 cÚ¡ *cÚ¡ 
¦si_decode_—pŞ_·ck‘_codes
[] = {

488 
size_t
 
size_wr™‹n
 = 0;

489 
u32
 
i
;

490 
u8
 
code
 = 
äame
[0];

491 
u8
 
id
 = 
äame
[1];

492 
u16
 
Ëngth
 = 
äame
[2] << 8 | frame[3];

493 cÚ¡ *
code_¡r
 = "";

495 
	`SLSI_UNUSED_PARAMETER
(
äame_Ëngth
);

497 ià(
code
 >= 1 && code <= 4)

498 
code_¡r
 = 
¦si_decode_—pŞ_·ck‘_codes
[
code
];

500 ià(
Ëngth
 > 4 && (
code
 == 1 || code == 2)) {

501 
u8
 
ty³
 = 
äame
[4];

503 
i
 = 0; i < 
	`ARRAY_SIZE
(
¦si_decode_—pŞ_·ck‘_ty³s
); i++)

504 ià(
¦si_decode_—pŞ_·ck‘_ty³s
[
i
].
v®ue
 =ğ
ty³
) {

505 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, ":%s:% id:%u", 
¦si_decode_—pŞ_·ck‘_ty³s
[
i
].
Çme
, 
code_¡r
, 
id
);

506  
size_wr™‹n
;

508 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, ":ty³:%u: % id:%u", 
ty³
, 
code_¡r
, 
id
);

510 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, ":% id:%u†’gth:%u", 
code_¡r
, 
id
, 
Ëngth
);

512  
size_wr™‹n
;

513 
	}
}

515 cÚ¡ 
¦si_v®ue_Çme_decode
 
	g¦si_—pŞ_·ck‘_ty³
[] = {

516 { 0, "E­Pack‘", 
¦si_decode_—pŞ_·ck‘
 },

517 { 1, "E­ŞS¹", 
NULL
 },

518 { 2, "E­ŞLogoff", 
NULL
 },

519 { 3, "E­ŞKey", 
NULL
 }

522 
size_t
 
	$¦si_decode_—pŞ
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

524 
size_t
 
size_wr™‹n
 = 0;

525 
u8
 
·ck‘_ty³
 = 
äame
[1];

526 
u16
 
Ëngth
 = 
äame
[2] << 8 | frame[3];

528 
	`SLSI_UNUSED_PARAMETER
(
äame_Ëngth
);

530 ià(
·ck‘_ty³
 < 
	`ARRAY_SIZE
(
¦si_—pŞ_·ck‘_ty³
)) {

531 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->%s", 
¦si_—pŞ_·ck‘_ty³
[
·ck‘_ty³
].
Çme
);

532 ià(
¦si_—pŞ_·ck‘_ty³
[
·ck‘_ty³
].
decode_â
)

533 
size_wr™‹n
 +ğ
¦si_—pŞ_·ck‘_ty³
[
·ck‘_ty³
].
	`decode_â
(
äame
 + 4, 
Ëngth
, 
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written);

534  
size_wr™‹n
;

536  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->·ck‘_ty³:%u", 
·ck‘_ty³
);

538 
	}
}

540 
size_t
 
	$¦si_decode_tdls
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

542 
u8
 
·ylßd_ty³
 = 
äame
[0];

544 ià(
·ylßd_ty³
 == 2) {

545 
	`¦si_decode_aùiÚ
(
äame
 + 1, 
äame_Ëngth
 - 1, 
»suÉ
, 
»suÉ_Ëngth
);

548  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->UnknownÕaylßd:%u", 
·ylßd_ty³
);

550 
	}
}

552 
size_t
 
	$¦si_decode_v4_icmp_echo
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

554 
u16
 
id
 = 
äame
[0] << 8 | frame[1];

555 
u16
 
£q
 = 
äame
[2] << 8 | frame[3];

557 
	`SLSI_UNUSED_PARAMETER
(
äame_Ëngth
);

559  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, " id:%u seq:%u", 
id
, 
£q
);

560 
	}
}

562 cÚ¡ 
¦si_v®ue_Çme_decode
 
	g¦si_v4_icmp_ty³s
[] = {

563 { 0, "EchoR•ly", 
¦si_decode_v4_icmp_echo
 },

564 { 8, "EchØ ", 
¦si_decode_v4_icmp_echo
 },

565 { 3, "De¡š©iÚ UÄ—chabË Ack", 
NULL
 },

566 { 4, "Sourû Qu’ch", 
NULL
 },

567 { 5, "Redœeù", 
NULL
 },

568 { 6, "AÉ”Ç‹ Ho¡ Add»ss", 
NULL
 },

569 { 9, "Rou‹¸Adv”ti£m’t", 
NULL
 },

570 { 10, "Rou‹¸S–eùiÚ", 
NULL
 },

571 { 11, "TimExûeded", 
NULL
 },

572 { 12, "P¬am‘” ProbËm", 
NULL
 },

573 { 13, "Time¡amp", 
NULL
 },

574 { 14, "Time¡am°R•ly", 
NULL
 },

575 { 15, "InfÜm©iÚ Reque¡", 
NULL
 },

576 { 16, "InfÜm©iÚ R•ly", 
NULL
 },

577 { 17, "Add»s Mask Reque¡", 
NULL
 },

578 { 18, "Add»s Mask R•ly", 
NULL
 },

579 { 19, "Re£rved (fÜ Secur™y)", 
NULL
 },

580 { 30, "T¿ûrou‹", 
NULL
 },

581 { 31, "D©ag¿m CÚv”siÚ E¼Ü", 
NULL
 },

582 { 32, "MobHo¡ Redœeù", 
NULL
 },

583 { 33, "IPv6 Wh”e-A»-You", 
NULL
 },

584 { 34, "IPv6 I-Am-H”e", 
NULL
 },

585 { 35, "MobRegi¡¿tiÚ Reque¡", 
NULL
 },

586 { 36, "MobRegi¡¿tiÚ R•ly", 
NULL
 },

587 { 39, "SKIP", 
NULL
 },

588 { 40, "PhÙuris", 
NULL
 },

589 { 253, "RFC3692-¡yË Ex³rim’ˆ1", 
NULL
 },

590 { 254, "RFC3692-¡yË Ex³rim’ˆ2", 
NULL
 }

593 
size_t
 
	$¦si_decode_v4_icmp
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

595 
size_t
 
size_wr™‹n
 = 0;

596 
u32
 
i
;

597 
u8
 
ty³
 = 
äame
[0];

598 
u8
 
code
 = 
äame
[1];

600 
i
 = 0; i < 
	`ARRAY_SIZE
(
¦si_v4_icmp_ty³s
); i++)

601 ià(
¦si_v4_icmp_ty³s
[
i
].
v®ue
 =ğ
ty³
) {

602 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->%s(code:%u)", 
¦si_v4_icmp_ty³s
[
i
].
Çme
, 
code
);

603 ià(
¦si_v4_icmp_ty³s
[
i
].
decode_â
)

604 
size_wr™‹n
 +ğ
¦si_v4_icmp_ty³s
[
i
].
	`decode_â
(
äame
 + 4, 
äame_Ëngth
 - 4, 
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written);

605  
size_wr™‹n
;

607  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->ty³(%u)", 
ty³
);

608 
	}
}

610 cÚ¡ 
¦si_v®ue_Çme_decode
 
	g¦si_v4_udp_boÙp_dhı_İtiÚ53
[] = {

611 { 1, "DHCP_DISCOVER", 
NULL
 },

612 { 2, "DHCP_OFFER", 
NULL
 },

613 { 3, "DHCP_REQUEST", 
NULL
 },

614 { 4, "DHCP_DECLINE", 
NULL
 },

615 { 5, "DHCP_ACK", 
NULL
 },

616 { 6, "DHCP_NAK", 
NULL
 },

617 { 7, "DHCP_RELEASE", 
NULL
 },

618 { 8, "DHCP_INFORM", 
NULL
 },

621 
	#SLSI_IPV4_UDP_BOOTP_CIADDR_OFFSET
 16

	)

622 
	#SLSI_IPV4_UDP_BOOTP_YIADDR_OFFSET
 20

	)

623 
	#SLSI_IPV4_UDP_BOOTP_GIADDR_OFFSET
 24

	)

624 
	#SLSI_IPV4_UDP_BOOTP_MAGIC_OFFSET
 236

	)

625 
size_t
 
	$¦si_decode_v4_udp_boÙp
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

627 
u32
 
i
;

628 
u8
 *
cŸddr
 = &
äame
[
SLSI_IPV4_UDP_BOOTP_CIADDR_OFFSET
];

629 
u8
 *
yŸddr
 = &
äame
[
SLSI_IPV4_UDP_BOOTP_YIADDR_OFFSET
];

630 
u8
 *
gŸddr
 = &
äame
[
SLSI_IPV4_UDP_BOOTP_GIADDR_OFFSET
];

631 
u8
 *
magic
 = &
äame
[
SLSI_IPV4_UDP_BOOTP_MAGIC_OFFSET
];

633 ià(
magic
[0] == 0x63 && magic[1] == 0x82 && magic[2] == 0x53 && magic[3] == 0x63) {

634 
u8
 *
p
 = &
äame
[
SLSI_IPV4_UDP_BOOTP_MAGIC_OFFSET
 + 4];

636 
p
 <… + 
äame_Ëngth
) {

637 
u8
 
İtiÚ
 = 
p
[0];

638 
u8
 
İtiÚ_Ëngth
 = 
p
[1];

640 ià(
İtiÚ
 =ğ53 && 
İtiÚ_Ëngth
 == 1) {

641 
i
 = 0; i < 
	`ARRAY_SIZE
(
¦si_v4_udp_boÙp_dhı_İtiÚ53
); i++)

642 ià(
¦si_v4_udp_boÙp_dhı_İtiÚ53
[
i
].
v®ue
 =ğ
p
[2])

643  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->%s(ci:%u.%u.%u.%u yi:%u.%u.%u.%u gi:%u.%u.%u.%u)",

644 
¦si_v4_udp_boÙp_dhı_İtiÚ53
[
i
].
Çme
,

645 
cŸddr
[0], ciaddr[1], ciaddr[2], ciaddr[3],

646 
yŸddr
[0], yiaddr[1], yiaddr[2], yiaddr[3],

647 
gŸddr
[0], giaddr[1], giaddr[2], giaddr[3]);

648  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->option53(%u ci:%u.%u.%u.%u yi:%u.%u.%u.%u gi:%u.%u.%u.%u)",

649 
p
[2],

650 
cŸddr
[0], ciaddr[1], ciaddr[2], ciaddr[3],

651 
yŸddr
[0], yiaddr[1], yiaddr[2], yiaddr[3],

652 
gŸddr
[0], giaddr[1], giaddr[2], giaddr[3]);

654 ià(
İtiÚ
 == 0)

656 
p
 =… + 2 + 
İtiÚ_Ëngth
;

660 
	}
}

662 cÚ¡ 
¦si_v®ue_Çme_decode
 
	g¦si_v4_udp_pÜts
[] = {

663 { 53, "DNS", 
NULL
 },

664 { 67, "BoÙp", 
¦si_decode_v4_udp_boÙp
 },

665 { 68, "BoÙp", 
¦si_decode_v4_udp_boÙp
 },

668 
size_t
 
	$¦si_decode_v4_udp
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

682 
size_t
 
size_wr™‹n
 = 0;

683 
u32
 
i
;

684 
u16
 
¥Üt
 = 
äame
[0] << 8 | frame[1];

685 
u16
 
dpÜt
 = 
äame
[2] << 8 | frame[3];

686 
u16
 
Ëngth
 = 
äame
[4] << 8 | frame[5];

690 
i
 = 0; i < 
	`ARRAY_SIZE
(
¦si_v4_udp_pÜts
); i++)

691 ià(
¦si_v4_udp_pÜts
[
i
].
v®ue
 =ğ
dpÜt
 || slsi_v4_udp_pÜts[i].v®u=ğ
¥Üt
) {

692 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->%s", 
¦si_v4_udp_pÜts
[
i
].
Çme
);

693 ià(
¦si_v4_udp_pÜts
[
i
].
decode_â
)

694 
size_wr™‹n
 +ğ
¦si_v4_udp_pÜts
[
i
].
	`decode_â
(
äame
 + 8, 
Ëngth
, 
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written);

696 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_wr™‹n, "(dpÜt:%u, size:%u)", 
dpÜt
, 
äame_Ëngth
 - 8);

697  
size_wr™‹n
;

699  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "(dpÜt:%u, size:%u)", 
dpÜt
, 
äame_Ëngth
 - 8);

700 
	}
}

702 
size_t
 
	$¦si_decode_v4_tı
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

725 
u16
 
dpÜt
 = 
äame
[2] << 8 | frame[3];

726 
u8
 
æags
 = 
äame
[13];

727 
boŞ
 
fš
 = 
æags
 & 0x01;

728 
boŞ
 
syn
 = 
æags
 & 0x02;

729 
boŞ
 
r¡
 = 
æags
 & 0x04;

730 
boŞ
 
psh
 = 
æags
 & 0x08;

731 
boŞ
 
ack
 = 
æags
 & 0x10;

732 
boŞ
 
urg
 = 
æags
 & 0x20;

734  
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "(dport:%u%s%s%s%s%s%s size:%u)",

735 
dpÜt
,

736 
fš
 ? " FIN" : "",

737 
syn
 ? " SYN" : "",

738 
r¡
 ? " RST" : "",

739 
psh
 ? " PSH" : "",

740 
ack
 ? " ACK" : "",

741 
urg
 ? " URG" : "",

742 
äame_Ëngth
 - 24);

743 
	}
}

745 
	#SLSI_IPV4_PROTO_ICMP
 1

	)

746 
	#SLSI_IPV4_PROTO_IGMP
 2

	)

747 
	#SLSI_IPV4_PROTO_TCP
 6

	)

748 
	#SLSI_IPV4_PROTO_UDP
 17

	)

749 
size_t
 
	$¦si_decode_v4
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

751 
size_t
 
size_wr™‹n
 = 0;

752 
u16
 
_d©a_off£t
 = 20;

754 
u8
 
hËn
 = 
äame
[0] & 0x0F;

760 
u8
 
´Ùo
 = 
äame
[9];

762 
u8
 *
¤c_
 = &
äame
[12];

763 
u8
 *
de¡_
 = &
äame
[16];

765 ià(
hËn
 > 5)

766 
_d©a_off£t
 +ğ(
hËn
 - 5) * 4;

768 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written, "(s:%u.%u.%u.%u d:%u.%u.%u.%u)",

769 
¤c_
[0], src_ip[1], src_ip[2], src_ip[3],

770 
de¡_
[0], dest_ip[1], dest_ip[2], dest_ip[3]);

772 
´Ùo
) {

773 
SLSI_IPV4_PROTO_TCP
:

774 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written, "->TCP");

775 
size_wr™‹n
 +ğ
	`¦si_decode_v4_tı
(
äame
 + 
_d©a_off£t
,

776 
äame_Ëngth
 - 
_d©a_off£t
,

777 
»suÉ
 + 
size_wr™‹n
,

778 
»suÉ_Ëngth
 - 
size_wr™‹n
);

780 
SLSI_IPV4_PROTO_UDP
:

781 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written, "->UDP");

782 
size_wr™‹n
 +ğ
	`¦si_decode_v4_udp
(
äame
 + 
_d©a_off£t
,

783 
äame_Ëngth
 - 
_d©a_off£t
,

784 
»suÉ
 + 
size_wr™‹n
,

785 
»suÉ_Ëngth
 - 
size_wr™‹n
);

787 
SLSI_IPV4_PROTO_ICMP
:

788 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written, "->ICMP");

789 
size_wr™‹n
 +ğ
	`¦si_decode_v4_icmp
(
äame
 + 
_d©a_off£t
,

790 
äame_Ëngth
 - 
_d©a_off£t
,

791 
»suÉ
 + 
size_wr™‹n
,

792 
»suÉ_Ëngth
 - 
size_wr™‹n
);

794 
SLSI_IPV4_PROTO_IGMP
:

795 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_written, "->IGMP");

798 
size_wr™‹n
 +ğ
	`¢´štf
(
»suÉ
 + size_wr™‹n, 
»suÉ_Ëngth
 - size_wr™‹n, "->´Ùo:%u", 
´Ùo
);

801  
size_wr™‹n
;

802 
	}
}

804 cÚ¡ 
¦si_decode_¢­
 
	g¢­_ty³s
[] = {

805 { { 0x08, 0x00 }, "IpV4", 
¦si_decode_v4
 },

806 { { 0x08, 0x06 }, "A½", 
¦si_decode_¬p
 },

807 { { 0x88, 0x8}, "E­Ş", 
¦si_decode_—pŞ
 },

808 { { 0x89, 0x0d }, 
NULL
, 
¦si_decode_tdls
 },

809 { { 0x86, 0xdd }, "IpV6", 
NULL
 },

810 { { 0x88, 0xb4 }, "W­i", 
NULL
 },

813 
	$¦si_decode_´Ùo_d©a
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

815 
u32
 
i
;

817 
i
 = 0; i < 
	`ARRAY_SIZE
(
¢­_ty³s
); i++)

818 ià(
	`memcmp
(
¢­_ty³s
[
i
].
¢­
, 
äame
, 2) == 0) {

819 
¦’
 = 0;

821 ià(
¢­_ty³s
[
i
].
Çme
)

822 
¦’
 = 
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "->%s", 
¢­_ty³s
[
i
].
Çme
);

823 ià(
¢­_ty³s
[
i
].
decode_â
)

824 
¦’
 +ğ
¢­_ty³s
[
i
].
	`decode_â
(
äame
 + 2, 
äame_Ëngth
 - 2, 
»suÉ
 + sËn, 
»suÉ_Ëngth
 - slen);

828 
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "ÕrÙo:0x%.2X%.2X)", 
äame
[0], frame[1]);

829 
	}
}

831 
	$¦si_decode_80211_d©a
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

833  
	`¦si_decode_´Ùo_d©a
(
äame
 + 6, 
äame_Ëngth
 - 6, 
»suÉ
, 
»suÉ_Ëngth
);

834 
	}
}

836 cÚ¡ 
¦si_decode_’Œy
 
	gäame_ty³s
[4][16] = {

838 { "AssocReq", 
¦si_decode_assoc_»q
 },

839 { "AssocR¥", 
¦si_decode_assoc_r¥
 },

840 { "R—ssocReq", 
¦si_decode_»assoc_»q
 },

841 { "R—ssocR¥", 
¦si_decode_assoc_r¥
 },

842 { "ProbeReq", 
¦si_decode_´obe_»q
 },

843 { "ProbeR¥", 
¦si_decode_b—cÚ
 },

844 { "TimšgAdv", 
NULL
 },

845 { "Re£rved", 
NULL
 },

846 { "B—cÚ ", 
¦si_decode_b—cÚ
 },

847 { "Atim", 
NULL
 },

848 { "Di§ssoc", 
¦si_decode_d—uth
 },

849 { "Auth", 
¦si_decode_auth
 },

850 { "D—uth", 
¦si_decode_d—uth
 },

851 { "AùiÚ", 
¦si_decode_aùiÚ
 },

852 { "AùiÚNoAck", 
¦si_decode_aùiÚ
 },

853 { "Re£rved", 
NULL
 }

856 { "Re£rved", 
NULL
 },

857 { "Re£rved", 
NULL
 },

858 { "Re£rved", 
NULL
 },

859 { "Re£rved", 
NULL
 },

860 { "Re£rved", 
NULL
 },

861 { "Re£rved", 
NULL
 },

862 { "Re£rved", 
NULL
 },

863 { "Re£rved", 
NULL
 },

864 { "BlockAckReq", 
NULL
 },

865 { "BlockAck", 
NULL
 },

866 { "PsPŞl", 
NULL
 },

867 { "RTS", 
NULL
 },

868 { "CTS", 
NULL
 },

869 { "Ack", 
NULL
 },

870 { "CF-End", 
NULL
 },

871 { "CF-End+Ack", 
NULL
 }

874 { "D©a", 
¦si_decode_80211_d©a
 },

875 { "D©a+CF-Ack", 
¦si_decode_80211_d©a
 },

876 { "D©a+CF-PŞl", 
¦si_decode_80211_d©a
 },

877 { "D©a+CF-Ack+PŞl", 
¦si_decode_80211_d©a
 },

878 { "NuÎ", 
NULL
 },

879 { "CF-Ack", 
NULL
 },

880 { "CF-PŞl", 
NULL
 },

881 { "CF-Ack+PŞl", 
NULL
 },

882 { "QosD©a", 
¦si_decode_80211_d©a
 },

883 { "QosD©a+CF-Ack", 
¦si_decode_80211_d©a
 },

884 { "QosD©a+CF-PŞl", 
¦si_decode_80211_d©a
 },

885 { "QosD©a+CF-Ack+PŞl", 
¦si_decode_80211_d©a
 },

886 { "QosNuÎ", 
NULL
 },

887 { "Re£rved", 
NULL
 },

888 { "QosCF-PŞl", 
NULL
 },

889 { "QosCF-Ack+PŞl", 
NULL
 }

892 { "Re£rved", 
NULL
 },

893 { "Re£rved", 
NULL
 },

894 { "Re£rved", 
NULL
 },

895 { "Re£rved", 
NULL
 },

896 { "Re£rved", 
NULL
 },

897 { "Re£rved", 
NULL
 },

898 { "Re£rved", 
NULL
 },

899 { "Re£rved", 
NULL
 },

900 { "Re£rved", 
NULL
 },

901 { "Re£rved", 
NULL
 },

902 { "Re£rved", 
NULL
 },

903 { "Re£rved", 
NULL
 },

904 { "Re£rved", 
NULL
 },

905 { "Re£rved", 
NULL
 },

906 { "Re£rved", 
NULL
 },

907 { "Re£rved", 
NULL
 },

911 
boŞ
 
	$¦si_decode_80211_äame
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

913 
›“80211_hdr
 *
hdr
 = (›“80211_hd¸*)
äame
;

914 
u16
 
fc_ıu
 = 
	`ıu_to_Ë16
(
hdr
->
äame_cÚŒŞ
);

915 
áy³_idx
 = (
fc_ıu
 & 0xf) >> 2;

916 cÚ¡ 
¦si_decode_’Œy
 *
’Œy
;

917 
hd¾’
;

918 
¦’
;

921 ià(
¦si_debug_summ¬y_äame
 =ğ1 && 
áy³_idx
 != 0)

922  
çl£
;

925 ià(
¦si_debug_summ¬y_äame
 < 3 &&

926 (
	`›“80211_is_´obe_»q
(
fc_ıu
è|| 
	`›“80211_is_´obe_»¥
(fc_ıuè|| 
	`›“80211_is_b—cÚ
(fc_cpu)))

927  
çl£
;

929 
’Œy
 = &
äame_ty³s
[
áy³_idx
][(
fc_ıu
 >> 4) & 0xf];

930 
hd¾’
 = 
	`›“80211_hd¾’
(
hdr
->
äame_cÚŒŞ
);

931 
¦’
 = 
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, 
’Œy
->
Çme
);

933 ià(
’Œy
->
decode_â
)

934 
’Œy
->
	`decode_â
(
äame
 + 
hd¾’
, 
äame_Ëngth
 - hd¾’, 
»suÉ
 + 
¦’
, 
»suÉ_Ëngth
 - slen);

935  
Œue
;

936 
	}
}

938 
boŞ
 
	$¦si_decode_l3_äame
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

940 
¦’
;

943 ià(
¦si_debug_summ¬y_äame
 == 1)

944  
çl£
;

947 ià(
¦si_debug_summ¬y_äame
 == 2) {

948 
‘hhdr
 *
ehdr
 = (‘hhd¸*)
äame
;

949 
u16
 
‘h_ty³
 = 
	`be16_to_ıu
(
ehdr
->
h_´Ùo
);

951 
‘h_ty³
) {

952 
ETH_P_IP
:

953 ià(
	`¦si_is_dhı_·ck‘
(
äame
è=ğ
SLSI_TX_IS_NOT_DHCP
)

954  
çl£
;

957 
ETH_P_PAE
:

958 
ETH_P_WAI
:

959 
ETH_P_ARP
:

963  
çl£
;

966 
¦’
 = 
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "eth");

967 
	`¦si_decode_´Ùo_d©a
(
äame
 + 12, 
äame_Ëngth
 - 12, 
»suÉ
 + 
¦’
, 
»suÉ_Ëngth
 - slen);

968  
Œue
;

969 
	}
}

971 
boŞ
 
	$¦si_decode_amsdu_subäame
(
u8
 *
äame
, 
u16
 
äame_Ëngth
, *
»suÉ
, 
size_t
 
»suÉ_Ëngth
)

973 
¦’
;

976 ià(
¦si_debug_summ¬y_äame
 == 1)

977  
çl£
;

980 ià(
¦si_debug_summ¬y_äame
 == 2) {

981 
msduhdr
 *
msdu_hdr
 = (msduhd¸*)
äame
;

982 
u16
 
‘h_ty³
 = 
	`be16_to_ıu
(
msdu_hdr
->
ty³
);

984 
‘h_ty³
) {

985 
ETH_P_IP
:

990 ià(
	`¦si_is_dhı_·ck‘
(
äame
 + 8è=ğ
SLSI_TX_IS_NOT_DHCP
)

991  
çl£
;

994 
ETH_P_PAE
:

995 
ETH_P_WAI
:

996 
ETH_P_ARP
:

1000  
çl£
;

1003 
¦’
 = 
	`¢´štf
(
»suÉ
, 
»suÉ_Ëngth
, "eth");

1004 
	`¦si_decode_´Ùo_d©a
(
äame
 + 20, 
äame_Ëngth
 - 20, 
»suÉ
 + 
¦’
, 
»suÉ_Ëngth
 - slen);

1005  
Œue
;

1006 
	}
}

1008 
šlše
 
boŞ
 
	$¦si_debug_äame_¿‹lim™ed
()

1010 
	`DEFINE_RATELIMIT_STATE
(
_rs
, (5 * 
HZ
), 200);

1012 ià(
	`__¿‹lim™
(&
_rs
))

1013  
Œue
;

1014  
çl£
;

1015 
	}
}

1018 
	$¦si_debug_äame
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, cÚ¡ *
´efix
)

1020 
äame_šfo
[384];

1021 
u8
 *
äame
 = 
	`çpi_g‘_d©a
(
skb
);

1022 
u16
 
Ën
 = 
	`çpi_g‘_d©®’
(
skb
);

1023 
u8
 *
d¡
 = 
NULL
;

1024 
u8
 *
¤c
 = 
NULL
;

1025 
u16
 
äam‘y³
 = 0xFFFF;

1026 
boŞ
 
´št
 = 
çl£
;

1027 
u16
 
id
 = 
	`çpi_g‘_sigid
(
skb
);

1028 
u16
 
vif
 = 
	`çpi_g‘_vif
(
skb
);

1029 
s16
 
rssi
 = 0;

1031 ià(!
¦si_debug_summ¬y_äame
)

1034 ià(!
Ën
)

1037 
id
) {

1038 
MA_UNITDATA_REQ
:

1039 
MA_UNITDATA_IND
:

1040 ià(!
	`¦si_debug_äame_¿‹lim™ed
())

1047 
äame_šfo
[0] = '\0';

1048 
id
) {

1049 
MA_UNITDATA_REQ
:

1050 
äam‘y³
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
d©a_un™_desütÜ
);

1052 
MA_UNITDATA_IND
:

1053 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
bulk_d©a_desütÜ
è=ğ
FAPI_BULKDATADESCRIPTOR_INLINE
)

1054 
äam‘y³
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
d©a_un™_desütÜ
);

1056 
MLME_SEND_FRAME_REQ
:

1057 
äam‘y³
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_£nd_äame_»q
.
d©a_un™_desütÜ
);

1059 
MLME_RECEIVED_FRAME_IND
:

1060 
äam‘y³
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_»ûived_äame_šd
.
d©a_un™_desütÜ
);

1062 
MLME_SCAN_IND
:

1063 
äam‘y³
 = 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
;

1064 
rssi
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_sÿn_šd
.rssi);

1065 
vif
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_sÿn_šd
.
sÿn_id
) >> 8;

1067 
MLME_CONNECT_CFM
:

1068 
MLME_CONNECT_IND
:

1069 
MLME_PROCEDURE_STARTED_IND
:

1070 
MLME_CONNECTED_IND
:

1071 
MLME_REASSOCIATE_IND
:

1072 
MLME_ROAMED_IND
:

1073 
äam‘y³
 = 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
;

1079 
äam‘y³
) {

1080 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
:

1082 
›“80211_hdr
 *
hdr
 = (›“80211_hd¸*)
äame
;

1084 
d¡
 = 
hdr
->
addr1
;

1085 
¤c
 = 
hdr
->
addr2
;

1086 
´št
 = 
	`¦si_decode_80211_äame
(
äame
, 
Ën
, 
äame_šfo
, (frame_info));

1089 
FAPI_DATAUNITDESCRIPTOR_IEEE802_3_FRAME
:

1091 
‘hhdr
 *
ehdr
 = (‘hhd¸*)
äame
;

1093 
d¡
 = 
ehdr
->
h_de¡
;

1094 
¤c
 = 
ehdr
->
h_sourû
;

1095 
´št
 = 
	`¦si_decode_l3_äame
(
äame
, 
Ën
, 
äame_šfo
, (frame_info));

1098 
FAPI_DATAUNITDESCRIPTOR_AMSDU_SUBFRAME
:

1100 
‘hhdr
 *
ehdr
 = (‘hhd¸*)
äame
;

1102 
d¡
 = 
ehdr
->
h_de¡
;

1103 
¤c
 = 
ehdr
->
h_sourû
;

1104 
´št
 = 
	`¦si_decode_amsdu_subäame
(
äame
, 
Ën
, 
äame_šfo
, (frame_info));

1110 ià(
´št
) {

1111 
	`SLSI_DBG4
(
sdev
, 
SLSI_SUMMARY_FRAMES
, "%-5s: %s(vif:%u„ssi:%-3d, s:%pM d:%pM)->%s\n",

1112 
dev
 ? 
	`Ãtdev_Çme
(devè: "", 
´efix
, 
vif
, 
rssi
, 
¤c
, 
d¡
, 
äame_šfo
);

1114 
	}
}

	@dev.c

7 
	~"dev.h
"

8 
	~"h.h
"

9 
	~"mgt.h
"

10 
	~"debug.h
"

11 
	~"udi.h
"

12 
	~"h_bh.h
"

13 
	~"cfg80211_İs.h
"

14 
	~"Ãtif.h
"

15 
	~"´ocfs.h
"

16 
	~"ba.h
"

17 
	~"Æ80211_v’dÜ.h
"

19 
	~"§p_mlme.h
"

20 
	~"§p_ma.h
"

21 
	~"§p_dbg.h
"

22 
	~"§p_‹¡.h
"

23 
	~"scsc_wÏn_mm­.h
"

25 #ifdeà
CONFIG_SCSC_WLAN_KIC_OPS


26 
	~"kic.h
"

29 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


30 #ià
CONFIG_SCSC_WLAN_MAX_INTERFACES
 < 4

35 *
	g¦si_mib_fe
 = "wlan.hcf";

36 
moduË_·¿m_Çmed
(
mib_fe
, 
¦si_mib_fe
, 
ch¬p
, 
S_IRUGO
 | 
S_IWUSR
);

37 
MODULE_PARM_DESC
(
mib_fe
, "mib data filename");

39 *
	g¦si_mib_fe2
 = "wlan_sw.hcf";

40 
moduË_·¿m_Çmed
(
mib_fe2
, 
¦si_mib_fe2
, 
ch¬p
, 
S_IRUGO
 | 
S_IWUSR
);

41 
MODULE_PARM_DESC
(
mib_fe2
, "sw mib data filename");

43 *
	gloÿl_mib_fe
 = "localmib.hcf";

44 
moduË_·¿m
(
loÿl_mib_fe
, 
ch¬p
, 
S_IRUGO
 | 
S_IWUSR
);

45 
MODULE_PARM_DESC
(
loÿl_mib_fe
, "local mib data filename (Optionalƒxtra mib values)");

47 *
	gmaddr_fe
 = "mac.txt";

48 
moduË_·¿m
(
maddr_fe
, 
ch¬p
, 
S_IRUGO
 | 
S_IWUSR
);

49 
MODULE_PARM_DESC
(
maddr_fe
, "mac‡ddress filename");

51 
boŞ
 
	g‹rm_udi_u£rs
 = 
Œue
;

52 
moduË_·¿m
(
‹rm_udi_u£rs
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

53 
MODULE_PARM_DESC
(
‹rm_udi_u£rs
, "Tryoerminate UDI user space users (applications) connected onhe cdev (0, 1)");

55 
	gsig_wa™_cfm_timeout
 = 6000;

56 
moduË_·¿m
(
sig_wa™_cfm_timeout
, , 
S_IRUGO
 | 
S_IWUSR
);

57 
MODULE_PARM_DESC
(
sig_wa™_cfm_timeout
, "Signal waitimeout in milliseconds (default: 3000)");

59 
boŞ
 
	gÎs_di§bËd
;

60 
moduË_·¿m
(
Îs_di§bËd
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

61 
MODULE_PARM_DESC
(
Îs_di§bËd
, "Disable LLS:o disable LLS set 1");

63 #ifdeà
SCSC_SEP_VERSION


64 
boŞ
 
	ggsÿn_di§bËd
 = 1;

66 
boŞ
 
	ggsÿn_di§bËd
;

68 
moduË_·¿m
(
gsÿn_di§bËd
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

69 
MODULE_PARM_DESC
(
gsÿn_di§bËd
, "Disable gscan:o disable gscan set 1");

71 
boŞ
 
	gÎ¦ogs_di§bËd
;

72 
moduË_·¿m
(
Î¦ogs_di§bËd
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

73 
MODULE_PARM_DESC
(
Î¦ogs_di§bËd
, "Disable†lslogs:o disable†lslogs set 1");

75 
boŞ
 
	g•no_di§bËd
;

76 
moduË_·¿m
(
•no_di§bËd
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

77 
MODULE_PARM_DESC
(
•no_di§bËd
, "DisableƒPNO:o disableƒPNO set 1.\nNote: forƒPNOo work gscan should beƒnabled");

79 
boŞ
 
	gvo_vi_block_ack_di§bËd
;

80 
moduË_·¿m
(
vo_vi_block_ack_di§bËd
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

81 
MODULE_PARM_DESC
(
vo_vi_block_ack_di§bËd
, "Disable VO VI Block Ack†ogic‡dded for WMM AC Cert : 5.1.4");

83 
	gmax_sÿn_»suÉ_couÁ
 = 200;

84 
moduË_·¿m
(
max_sÿn_»suÉ_couÁ
, , 
S_IRUGO
 | 
S_IWUSR
);

85 
MODULE_PARM_DESC
(
max_sÿn_»suÉ_couÁ
, "Max scan„esultso be„eported");

87 #ifdeà
CONFIG_SCSC_WLAN_RTT


88 
boŞ
 
	g¹t_di§bËd
;

90 
boŞ
 
	g¹t_di§bËd
 = 1;

92 
moduË_·¿m
(
¹t_di§bËd
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

93 
MODULE_PARM_DESC
(
¹t_di§bËd
, "Disable„tt:o disable„tt set 1");

95 
boŞ
 
	gÇn_di§bËd
;

96 
moduË_·¿m
(
Çn_di§bËd
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

97 
MODULE_PARM_DESC
(
Çn_di§bËd
, "Disable NAN:o disable NAN set 1.");

99 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


100 
boŞ
 
	gÇn_šşude_v6_v
 = 
Œue
;

101 
moduË_·¿m
(
Çn_šşude_v6_v
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

102 
MODULE_PARM_DESC
(
Çn_šşude_v6_v
, "include ipv6‡ddresslv:o disable NAN set 0. Enabled by default");

104 
	gÇn_max_ndp_š¡ªûs
 = 1;

105 
moduË_·¿m
(
Çn_max_ndp_š¡ªûs
, , 
S_IRUGO
 | 
S_IWUSR
);

106 
MODULE_PARM_DESC
(
Çn_max_ndp_š¡ªûs
, "max‚dp sessions");

108 
	gÇn_max_ndi_içûs
 = 1;

109 
moduË_·¿m
(
Çn_max_ndi_içûs
, , 
S_IRUGO
 | 
S_IWUSR
);

110 
MODULE_PARM_DESC
(
Çn_max_ndi_içûs
, "max‚di interface");

112 
boŞ
 
	gdi§bË_Çn_mac_¿ndom
;

113 
moduË_·¿m
(
di§bË_Çn_mac_¿ndom
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

114 
MODULE_PARM_DESC
(
di§bË_Çn_mac_¿ndom
, "Disable NAN mac_randomization: set 1.");

117 #ifdeà
SCSC_SEP_VERSION


118 
	gÇn_ndp_d–ay_ms
 = 550;

119 
	gÇn_ndp_max_d–ay_ms
 = 600;

121 
	gÇn_ndp_d–ay_ms
 = 750;

122 
	gÇn_ndp_max_d–ay_ms
 = 800;

125 
moduË_·¿m
(
Çn_ndp_d–ay_ms
, , 
S_IRUGO
 | 
S_IWUSR
);

126 
MODULE_PARM_DESC
(
Çn_ndp_d–ay_ms
, "ndp delayime");

127 
moduË_·¿m
(
Çn_ndp_max_d–ay_ms
, , 
S_IRUGO
 | 
S_IWUSR
);

128 
MODULE_PARM_DESC
(
Çn_ndp_max_d–ay_ms
, "max‚dp delayime");

131 
boŞ
 
	gËgacy_§r_backoff
 = 
Œue
;

132 
moduË_·¿m
(
Ëgacy_§r_backoff
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

133 
MODULE_PARM_DESC
(
Ëgacy_§r_backoff
, "Switch between†egacy‡nd 3.6 sar_backoff");

135 
boŞ
 
	$¦si_dev_gsÿn_suµÜ‹d
()

137  !
gsÿn_di§bËd
;

138 
	}
}

140 
boŞ
 
	$¦si_dev_¹t_suµÜ‹d
()

142  !
¹t_di§bËd
;

143 
	}
}

145 
boŞ
 
	$¦si_dev_Î¦ogs_suµÜ‹d
()

147  !
Î¦ogs_di§bËd
;

148 
	}
}

150 
boŞ
 
	$¦si_dev_Îs_suµÜ‹d
()

152  !
Îs_di§bËd
;

153 
	}
}

155 
boŞ
 
	$¦si_dev_•no_suµÜ‹d
()

157  !
•no_di§bËd
;

158 
	}
}

160 
boŞ
 
	$¦si_dev_vo_vi_block_ack
()

162  
vo_vi_block_ack_di§bËd
;

163 
	}
}

165 
	$¦si_dev_g‘_sÿn_»suÉ_couÁ
()

167  
max_sÿn_»suÉ_couÁ
;

168 
	}
}

170 
	$¦si_dev_Çn_suµÜ‹d
(
¦si_dev
 *
sdev
)

172 #ià
CONFIG_SCSC_WLAN_MAX_INTERFACES
 >= 4

173 ià(
sdev
)

174  
sdev
->
Çn_’abËd
 && !
Çn_di§bËd
;

175  
çl£
;

177  
çl£
;

179 
	}
}

181 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


182 
boŞ
 
	$¦si_dev_Çn_is_v6_lšk_v_šşude
()

184  
Çn_šşude_v6_v
;

185 
	}
}

187 
	$¦si_g‘_Çn_max_ndp_š¡ªûs
()

189  
Çn_max_ndp_š¡ªûs
;

190 
	}
}

192 
	$¦si_g‘_Çn_max_ndi_içûs
()

194  
Çn_max_ndi_içûs
;

195 
	}
}

197 
	$¦si_g‘_Çn_ndp_d–ay
()

199  
Çn_ndp_d–ay_ms
;

200 
	}
}

202 
	$¦si_g‘_Çn_ndp_max_time
()

204 ià(
Çn_ndp_d–ay_ms
 >ğ
Çn_ndp_max_d–ay_ms
)

205 
Çn_ndp_max_d–ay_ms
 = 
Çn_ndp_d–ay_ms
 + 50;

207  
Çn_ndp_max_d–ay_ms
;

208 
	}
}

210 
boŞ
 
	$¦si_g‘_Çn_mac_¿ndom
()

212  !
di§bË_Çn_mac_¿ndom
;

213 
	}
}

217 
boŞ
 
	$¦si_g‘_Ëgacy_§r_backoff
()

219  
Ëgacy_§r_backoff
;

220 
	}
}

222 
	$¦si_dev_š‘addr_chªged
(
nÙif›r_block
 *
nb
, 
d©a
, *
¬g
)

224 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
nb
, ¦si_dev, 
š‘addr_nÙif›r
);

225 
š_içddr
 *
iç
 = 
¬g
;

226 
Ãt_deviû
 *
dev
 = 
iç
->
iç_dev
->dev;

227 
wœ–ess_dev
 *
wdev
 = 
dev
->
›“80211_±r
;

228 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

230 ià(!
wdev
)

231  
NOTIFY_DONE
;

233 ià(
wdev
->
why
 !ğ
sdev
->wiphy)

234  
NOTIFY_DONE
;

236 ià(
d©a
 =ğ
NETDEV_DOWN
) {

237 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_NETDEV
, "Returning 0 for NETDEV_DOWNƒvent\n");

241 
	`SLSI_NET_INFO
(
dev
, "IP: %pI4\n", &
iç
->
iç_add»ss
);

242 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

243 #iâdeà
SLSI_TEST_DEV


244 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
è&& 
	`¦si_wake_lock_aùive
(&
sdev
->
wÏn_wl_rßm
)) {

245 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_NETDEV
, "Releasinghe„oaming wakelock\n");

246 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl_rßm
);

250 ià(
ndev_vif
->
¡a
.
is_wps
) {

251 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
,

253 
ndev_vif
->
¡a
.
is_wps
 = 
çl£
;

257 
	`¦si__add»ss_chªged
(
sdev
, 
dev
, 
iç
->
iç_add»ss
);

258 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

260 
	}
}

262 #ià
IS_ENABLED
(
CONFIG_IPV6
)

263 
	$¦si_dev_š‘6addr_chªged
(
nÙif›r_block
 *
nb
, 
d©a
, *
¬g
)

265 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
nb
, ¦si_dev, 
š‘6addr_nÙif›r
);

266 
š‘6_içddr
 *
iç
 = 
¬g
;

267 
Ãt_deviû
 *
dev
 = 
iç
->
idev
->dev;

268 
wœ–ess_dev
 *
wdev
 = 
dev
->
›“80211_±r
;

269 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

271 ()
d©a
;

273 ià(!
wdev
)

274  
NOTIFY_DONE
;

276 ià(
wdev
->
why
 !ğ
sdev
->wiphy)

277  
NOTIFY_DONE
;

279 
	`SLSI_NET_INFO
(
dev
, "IPv6: %pI6\n", &
iç
->
addr
.
s6_addr
);

281 
	`¦si_¥šlock_lock
(&
ndev_vif
->
v6addr_lock
);

282 
	`memıy
(&
ndev_vif
->
v6add»ss
, &
iç
->
addr
, (
š6_addr
));

283 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
v6addr_lock
);

286 
	}
}

289 
	$¦si_dump_sy¡em_”rÜ_bufãr
(
¦si_dev
 *
sdev
)

291 
	`mu‹x_lock
(&
sdev
->
sys_”rÜ_log_buf
.
log_buf_mu‹x
);

292 
	`SLSI_INFO
(
sdev
, "Sy¡emƒ¼Ü saved†ogs:\n--BEGIN--\n%s--END--\n", sdev->
sys_”rÜ_log_buf
.
log_buf
);

293 
	`mu‹x_uÆock
(&
sdev
->
sys_”rÜ_log_buf
.
log_buf_mu‹x
);

294 
	}
}

296 
	$¦si_add_log_to_sy¡em_”rÜ_bufãr
(
¦si_dev
 *
sdev
, *
šput_bufãr
)

298 
pos
 = 
sdev
->
sys_”rÜ_log_buf
.pos;

299 
buf_size
 = 
sdev
->
sys_”rÜ_log_buf
.
log_buf_size
 - 
pos
;

300 
u32
 
time
[2] = { 0 };

302 
	`g‘_k”Ãl_time¡amp
(
time
);

303 
	`mu‹x_lock
(&
sdev
->
sys_”rÜ_log_buf
.
log_buf_mu‹x
);

304 
sdev
->
sys_”rÜ_log_buf
.
pos
 +ğ
	`sú´štf
(sdev->sys_”rÜ_log_buf.
log_buf
 +…os, 
buf_size
 -…os, "[%d.%d] ", 
time
[0],ime[1]);

306 
pos
 = 
sdev
->
sys_”rÜ_log_buf
.pos;

307 
buf_size
 = 
sdev
->
sys_”rÜ_log_buf
.
log_buf_size
 - 
pos
;

309 
sdev
->
sys_”rÜ_log_buf
.
pos
 +ğ
	`sú´štf
(sdev->sys_”rÜ_log_buf.
log_buf
 +…os, 
buf_size
 -…os, 
šput_bufãr
);

310 
	`mu‹x_uÆock
(&
sdev
->
sys_”rÜ_log_buf
.
log_buf_mu‹x
);

311 
	}
}

313 
	$¦si_sys_”rÜ_log_š™
(
¦si_dev
 *
sdev
)

315 
	`mu‹x_š™
(&
sdev
->
sys_”rÜ_log_buf
.
log_buf_mu‹x
);

316 
sdev
->
sys_”rÜ_log_buf
.
pos
 = 0;

317 
sdev
->
sys_”rÜ_log_buf
.
log_buf
 = 
NULL
;

318 
sdev
->
sys_”rÜ_log_buf
.
log_buf_size
 = 
SYSTEM_ERROR_BUFFER_SZ
;

320 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "AÎoÿtšg %d memÜy fÜ sy¡em_”rÜ_log_bufãr\n", sdev->
sys_”rÜ_log_buf
.
log_buf_size
);

321 
sdev
->
sys_”rÜ_log_buf
.
log_buf
 = 
	`kz®loc
(sdev->sys_”rÜ_log_buf.
log_buf_size
, 
GFP_KERNEL
);

322 ià(!
sdev
->
sys_”rÜ_log_buf
.
log_buf
)

323 
	`SLSI_ERR_NODEV
("Failedo‡llocate system_error_log_buffer\n");

324 
	}
}

326 
¦si_dev
 *
	$¦si_dev_©ch
(
deviû
 *
dev
, 
scsc_mx
 *
cÜe
, 
scsc_£rviû_ş›Á
 *
mx_wÏn_ş›Á
)

328 
¦si_dev
 *
sdev
;

329 
i
;

331 
	`SLSI_DBG1_NODEV
(
SLSI_INIT_DEINIT
, "Add Device\n");

333 
sdev
 = 
	`¦si_cfg80211_Ãw
(
dev
);

334 ià(!
sdev
) {

335 
	`SLSI_ERR_NODEV
("No sdev\n");

336  
NULL
;

339 
sdev
->
mlme_blocked
 = 
çl£
;

340 
sdev
->
wÏn_£rviû_Ú
 = 0;

341 
sdev
->
»quœe_£rviû_şo£
 = 
çl£
;

343 
	`SLSI_MUTEX_INIT
(
sdev
->
Ãtdev_add_»move_mu‹x
);

344 
	`mu‹x_š™
(&
sdev
->
Ãtdev_»move_mu‹x
);

345 
	`SLSI_MUTEX_INIT
(
sdev
->
¡¬t_¡İ_mu‹x
);

346 
	`SLSI_MUTEX_INIT
(
sdev
->
deviû_cÚfig_mu‹x
);

347 
	`SLSI_MUTEX_INIT
(
sdev
->
logg”_mu‹x
);

348 
	`¦si_¥šlock_ü—‹
(&
sdev
->
Ãtdev_lock
);

349 
	`¦si_¥šlock_ü—‹
(&
sdev
->
wake_¡©s_lock
);

350 
sdev
->
dev
 = dev;

351 
sdev
->
maxw–l_cÜe
 = 
cÜe
;

352 
	`memıy
(&
sdev
->
mx_wÏn_ş›Á
, mx_wÏn_ş›Á, (
scsc_£rviû_ş›Á
));

354 
sdev
->
ç_»pÜ‹d
 = 
çl£
;

355 
sdev
->
p2p_û¹if
 = 
çl£
;

356 
sdev
->
®low_sw™ch_40_mhz
 = 
Œue
;

357 
sdev
->
®low_sw™ch_80_mhz
 = 
Œue
;

358 
sdev
->
mib
[0].
mib_fe_Çme
 = 
¦si_mib_fe
;

359 
sdev
->
mib
[1].
mib_fe_Çme
 = 
¦si_mib_fe2
;

360 
sdev
->
loÿl_mib
.
mib_fe_Çme
 = 
loÿl_mib_fe
;

361 
sdev
->
maddr_fe_Çme
 = 
maddr_fe
;

362 
sdev
->
deviû_cÚfig
.
qos_šfo
 = -1;

363 
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 = 
SLSI_HOSTSTATE_CELLULAR_ACTIVE
;

364 
sdev
->
acs_chªÃl_sw™ched
 = 
çl£
;

365 
	`mem£t
(&
sdev
->
ch_šfo_mib
, 0xFF, (
¦si_ch_šfo_mib
));

367 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


368 
sdev
->
num_5g_»¡riùed_chªÃls
 = 0;

371 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


372 
sdev
->
deviû_cÚfig
.
okc_mode
 = 0;

373 
sdev
->
deviû_cÚfig
.
wes_mode
 = 0;

374 
sdev
->
deviû_cÚfig
.
rßm_sÿn_mode
 = 0;

377 
	`¦si_log_ş›Ás_š™
(
sdev
);

378 
	`¦si_Œaffic_mÚ_ş›Ás_š™
(
sdev
);

379 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 4, 0))

380 
	`¦si_wake_lock_š™
(
NULL
, &
sdev
->
wÏn_wl
.
ws
, "wlan");

381 
	`¦si_wake_lock_š™
(
NULL
, &
sdev
->
wÏn_wl_mlme
.
ws
, "wlan_mlme");

382 
	`¦si_wake_lock_š™
(
NULL
, &
sdev
->
wÏn_wl_ma
.
ws
, "wlan_ma");

383 
	`¦si_wake_lock_š™
(
NULL
, &
sdev
->
wÏn_wl_rßm
.
ws
, "wlan_roam");

384 
	`¦si_wake_lock_š™
(
NULL
, &
sdev
->
wÏn_wl_š™
.
ws
, "wlan_init");

386 
	`¦si_wake_lock_š™
(&
sdev
->
wÏn_wl
, 
WAKE_LOCK_SUSPEND
, "wlan");

387 
	`¦si_wake_lock_š™
(&
sdev
->
wÏn_wl_mlme
, 
WAKE_LOCK_SUSPEND
, "wlan_mlme");

388 
	`¦si_wake_lock_š™
(&
sdev
->
wÏn_wl_ma
, 
WAKE_LOCK_SUSPEND
, "wlan_ma");

389 
	`¦si_wake_lock_š™
(&
sdev
->
wÏn_wl_rßm
, 
WAKE_LOCK_SUSPEND
, "wlan_roam");

390 
	`¦si_wake_lock_š™
(&
sdev
->
wÏn_wl_š™
, 
WAKE_LOCK_SUSPEND
, "wlan_init");

393 
sdev
->
»cov”y_Ãxt_¡©e
 = 0;

394 
	`š™_com¶‘iÚ
(&
sdev
->
»cov”y_»move_com¶‘iÚ
);

395 
	`š™_com¶‘iÚ
(&
sdev
->
»cov”y_¡İ_com¶‘iÚ
);

396 
	`š™_com¶‘iÚ
(&
sdev
->
»cov”y_com¶‘ed
);

397 
	`š™_com¶‘iÚ
(&
sdev
->
£rviû_ç_¡¬‹d_šdiÿtiÚ
);

398 
	`š™_com¶‘iÚ
(&
sdev
->
»cov”y_ç_§ã_com¶‘e
);

399 
sdev
->
»cov”y_¡©us
 = 0;

401 
sdev
->
‹rm_udi_u£rs
 = &term_udi_users;

402 
sdev
->
sig_wa™_cfm_timeout
 = &sig_wait_cfm_timeout;

403 
	`¦si_sig_£nd_š™
(&
sdev
->
sig_wa™
);

404 
	`¦si_sys_”rÜ_log_š™
(
sdev
);

406 
i
 = 0; i < 
SLSI_LLS_AC_MAX
; i++)

407 
	`©omic_£t
(&
sdev
->
tx_ho¡_g
[
i
], ((1 << 2) | i));

409 ià(
	`¦si_skb_wÜk_š™
(
sdev
, 
NULL
, &sdev->
rx_dbg_§p
, "¦si_wÏn_rx_dbg_§p", 
¦si_rx_dbg_§p_wÜk
) != 0)

410 
”r_if
;

412 ià(
	`¦si_Ãtif_š™
(
sdev
) != 0) {

413 
	`SLSI_ERR
(
sdev
, "Can‚ot createhe‚etwork interface\n");

414 
”r_ù¾_wq_š™
;

416 
	`¦si_h_š™
(
sdev
, 
dev
);

418 ià(
	`¦si_udi_node_š™
(
sdev
, 
dev
) != 0) {

419 
	`SLSI_ERR
(
sdev
, "failedo init UDI\n");

420 
”r_h_š™
;

423 
	`¦si_ü—‹_´oc_dœ
(
sdev
);

426 
	`¦si_»gd_š™
(
sdev
);

428 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


429 
	`¦si_Æ80211_v’dÜ_š™
(
sdev
);

432 ià(
	`¦si_cfg80211_»gi¡”
(
sdev
) != 0) {

433 
	`SLSI_ERR
(
sdev
, "failedo„egister with cfg80211\n");

434 
”r_udi_´oc_š™
;

437 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

438 
sdev
->
š‘6addr_nÙif›r
.
nÙif›r_ÿÎ
 = 
¦si_dev_š‘6addr_chªged
;

439 ià(
	`»gi¡”_š‘6addr_nÙif›r
(&
sdev
->
š‘6addr_nÙif›r
) != 0) {

440 
	`SLSI_ERR
(
sdev
, "failedo„egister inet6addr_notifier\n");

441 
”r_cfg80211_»gi¡”ed
;

445 
sdev
->
š‘addr_nÙif›r
.
nÙif›r_ÿÎ
 = 
¦si_dev_š‘addr_chªged
;

446 ià(
	`»gi¡”_š‘addr_nÙif›r
(&
sdev
->
š‘addr_nÙif›r
) != 0) {

447 
	`SLSI_ERR
(
sdev
, "failedo„egister inetaddr_notifier\n");

448 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

449 
	`uÄegi¡”_š‘6addr_nÙif›r
(&
sdev
->
š‘6addr_nÙif›r
);

451 
”r_cfg80211_»gi¡”ed
;

454 #ifdeà
SLSI_TEST_DEV


455 
	`¦si_š™_Ãtdev_mac_addr
(
sdev
);

457 
	`¦si_rx_ba_š™
(
sdev
);

459 ià(
	`¦si_Ãtif_»gi¡”
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_WLAN
]) != 0) {

460 
	`SLSI_ERR
(
sdev
, "failedo„egister with wlan‚etdev\n");

461 
”r_š‘addr_»gi¡”ed
;

463 #ifdeà
CONFIG_SCSC_WLAN_STA_ONLY


464 
	`SLSI_ERR
(
sdev
, "CONFIG_SCSC_WLAN_STA_ONLY:‚ot„egistering…2p‚etdev\n");

466 ià(
	`¦si_Ãtif_»gi¡”
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_P2P
]) != 0) {

467 
	`SLSI_ERR
(
sdev
, "failedo„egister with…2p‚etdev\n");

468 
”r_wÏn_»gi¡”ed
;

470 #ià
	`defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

471 #ià
	`defšed
(
CONFIG_SCSC_WLAN_MHS_STATIC_INTERFACE
è|| (defšed(
SCSC_SEP_VERSION
è&& SCSC_SEP_VERSION >ğ9è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

472 ià(
	`¦si_Ãtif_»gi¡”
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
]) != 0) {

473 
	`SLSI_ERR
(
sdev
, "failedo„egister with…2px_wlan1‚etdev\n");

474 
”r_p2p_»gi¡”ed
;

476 
	`rcu_assign_poš‹r
(
sdev
->
Ãtdev_­
, sdev->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
]);

479 #ià
CONFIG_SCSC_WLAN_MAX_INTERFACES
 >= 4

480 ià(
	`¦si_Ãtif_»gi¡”
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_NAN
]) != 0) {

481 
	`SLSI_ERR
(
sdev
, "failedo„egister with NAN‚etdev\n");

482 #ià
	`defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

483 #ià
	`defšed
(
CONFIG_SCSC_WLAN_MHS_STATIC_INTERFACE
è|| (defšed(
SCSC_SEP_VERSION
è&& SCSC_SEP_VERSION >ğ9è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

484 
”r_p2px_wÏn_»gi¡”ed
;

486 
”r_p2p_»gi¡”ed
;

489 
”r_p2p_»gi¡”ed
;

494 #ifdeà
CONFIG_SCSC_WLAN_KIC_OPS


495 ià(
	`wifi_kic_»gi¡”
(
sdev
) < 0)

496 
	`SLSI_ERR
(
sdev
, "failedo„egister Wi-Fi KIC ops\n");

498 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


499 
sdev
->
’hªûd_pkt_f‹r_’abËd
 = 
Œue
;

501 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STOPPED
;

502 
sdev
->
cu¼’t_t¥ec_id
 = -1;

503 
sdev
->
t¥ec_”rÜ_code
 = -1;

506 
sdev
->
deviû_wq
 = 
	`®loc_Üd”ed_wÜkqueue
("slsi_wlan_wq", 0);

507 ià(!
sdev
->
deviû_wq
) {

508 
	`SLSI_ERR
(
sdev
, "Cannot‡llocate workqueue\n");

509 #ià
CONFIG_SCSC_WLAN_MAX_INTERFACES
 >= 4

510 
”r_Çn_»gi¡”ed
;

512 #ià
	`defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

513 #ià
	`defšed
(
CONFIG_SCSC_WLAN_MHS_STATIC_INTERFACE
è|| (defšed(
SCSC_SEP_VERSION
è&& SCSC_SEP_VERSION >ğ9è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

514 
”r_p2px_wÏn_»gi¡”ed
;

516 
”r_p2p_»gi¡”ed
;

519 
”r_p2p_»gi¡”ed
;

523 
	`INIT_WORK
(&
sdev
->
»cov”y_wÜk_Ú_¡İ
, 
¦si_çu»_»£t
);

524 
	`INIT_WORK
(&
sdev
->
»cov”y_wÜk
, 
¦si_subsy¡em_»£t
);

525 
	`INIT_WORK
(&
sdev
->
»cov”y_wÜk_Ú_¡¬t
, 
¦si_ch_»cov”y
);

526 
	`INIT_WORK
(&
sdev
->
sy¡em_”rÜ_u£r_ç_wÜk
, 
¦si_sy¡em_”rÜ_»cov”y
);

527 #ià
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

528 
	`INIT_WORK
(&
sdev
->
ch£t_loggšg_wÜk
, 
¦si_cŞËù_ch£t_logs
);

530 
	`INIT_WORK
(&
sdev
->
Œigg”_wÏn_ç_wÜk
, 
¦si_Œigg”_£rviû_çu»
);

531  
sdev
;

533 #ià
CONFIG_SCSC_WLAN_MAX_INTERFACES
 >= 4

534 
”r_Çn_»gi¡”ed
:

535 
	`¦si_Ãtif_»move
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_NAN
]);

538 #ià
	`defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

539 #ià
	`defšed
(
CONFIG_SCSC_WLAN_MHS_STATIC_INTERFACE
è|| (defšed(
SCSC_SEP_VERSION
è&& SCSC_SEP_VERSION >ğ9è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

540 
”r_p2px_wÏn_»gi¡”ed
:

541 
	`¦si_Ãtif_»move
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
]);

542 
	`rcu_assign_poš‹r
(
sdev
->
Ãtdev_­
, 
NULL
);

546 
”r_p2p_»gi¡”ed
:

547 
	`¦si_Ãtif_»move
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_P2P
]);

549 
”r_wÏn_»gi¡”ed
:

550 
	`¦si_Ãtif_»move
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_WLAN
]);

552 
”r_š‘addr_»gi¡”ed
:

553 
	`uÄegi¡”_š‘addr_nÙif›r
(&
sdev
->
š‘addr_nÙif›r
);

554 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

555 
	`uÄegi¡”_š‘6addr_nÙif›r
(&
sdev
->
š‘6addr_nÙif›r
);

558 
”r_cfg80211_»gi¡”ed
:

559 
	`¦si_cfg80211_uÄegi¡”
(
sdev
);

561 
”r_udi_´oc_š™
:

562 
	`¦si_Œaffic_mÚ_ş›Ás_deš™
(
sdev
);

563 
	`¦si_»move_´oc_dœ
(
sdev
);

564 
	`¦si_udi_node_deš™
(
sdev
);

566 
”r_h_š™
:

567 
	`¦si_h_deš™
(
sdev
);

568 
	`¦si_Ãtif_deš™
(
sdev
);

570 
”r_ù¾_wq_š™
:

571 
	`¦si_skb_wÜk_deš™
(&
sdev
->
rx_dbg_§p
);

573 
”r_if
:

574 
	`¦si_wake_lock_de¡roy
(&
sdev
->
wÏn_wl
);

575 
	`¦si_wake_lock_de¡roy
(&
sdev
->
wÏn_wl_mlme
);

576 
	`¦si_wake_lock_de¡roy
(&
sdev
->
wÏn_wl_ma
);

577 
	`¦si_wake_lock_de¡roy
(&
sdev
->
wÏn_wl_rßm
);

578 
	`¦si_wake_lock_de¡roy
(&
sdev
->
wÏn_wl_š™
);

580 
	`¦si_cfg80211_ä“
(
sdev
);

581  
NULL
;

582 
	}
}

584 
	$¦si_dev_d‘ach
(
¦si_dev
 *
sdev
)

586 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "Remove Device\n");

588 
	`¦si_¡İ
(
sdev
);

590 #ifdeà
CONFIG_SCSC_WLAN_KIC_OPS


591 
	`wifi_kic_uÄegi¡”
();

593 
	`com¶‘e_®l
(&
sdev
->
sig_wa™
.
com¶‘iÚ
);

594 
	`com¶‘e_®l
(&
sdev
->
»cov”y_»move_com¶‘iÚ
);

595 
	`com¶‘e_®l
(&
sdev
->
»cov”y_¡İ_com¶‘iÚ
);

596 
	`com¶‘e_®l
(&
sdev
->
»cov”y_com¶‘ed
);

597 
	`com¶‘e_®l
(&
sdev
->
£rviû_ç_¡¬‹d_šdiÿtiÚ
);

598 
	`com¶‘e_®l
(&
sdev
->
»cov”y_ç_§ã_com¶‘e
);

600 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Unregister inetaddr_notifier\n");

601 
	`uÄegi¡”_š‘addr_nÙif›r
(&
sdev
->
š‘addr_nÙif›r
);

603 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

604 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Unregister inet6addr_notifier\n");

605 
	`uÄegi¡”_š‘6addr_nÙif›r
(&
sdev
->
š‘6addr_nÙif›r
);

608 
	`WARN_ON
(!
sdev
->
deviû_wq
);

609 ià(
sdev
->
deviû_wq
)

610 
	`æush_wÜkqueue
(
sdev
->
deviû_wq
);

612 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


613 
	`¦si_Æ80211_v’dÜ_deš™
(
sdev
);

616 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Unregister‚etif\n");

617 
	`¦si_Ãtif_»move_®l
(
sdev
);

619 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Unregister cfg80211\n");

620 
	`¦si_cfg80211_uÄegi¡”
(
sdev
);

622 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Remove…rocƒntries\n");

623 
	`¦si_»move_´oc_dœ
(
sdev
);

625 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "De-initialisehe Traffic monitor\n");

626 
	`¦si_Œaffic_mÚ_ş›Ás_deš™
(
sdev
);

628 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "De-initialisehe UDI\n");

629 
	`¦si_log_ş›Ás_‹rmš©e
(
sdev
);

630 
	`¦si_udi_node_deš™
(
sdev
);

632 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "De-initialise Hip\n");

633 
	`¦si_h_deš™
(
sdev
);

635 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "De-initialise‚etif\n");

636 
	`¦si_Ãtif_deš™
(
sdev
);

638 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "De-initialise Regulatory\n");

639 
	`¦si_»gd_deš™
(
sdev
);

641 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Stop Work Queues\n");

642 
	`¦si_skb_wÜk_deš™
(&
sdev
->
rx_dbg_§p
);

644 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Clean up wakelocks\n");

645 
	`¦si_wake_lock_de¡roy
(&
sdev
->
wÏn_wl
);

646 
	`¦si_wake_lock_de¡roy
(&
sdev
->
wÏn_wl_mlme
);

647 
	`¦si_wake_lock_de¡roy
(&
sdev
->
wÏn_wl_ma
);

648 
	`¦si_wake_lock_de¡roy
(&
sdev
->
wÏn_wl_rßm
);

649 
	`¦si_wake_lock_de¡roy
(&
sdev
->
wÏn_wl_š™
);

651 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Free cfg80211\n");

652 
	`¦si_cfg80211_ä“
(
sdev
);

653 
	}
}

655 
__š™
 
	$¦si_dev_lßd
()

657 
	`SLSI_INFO_NODEV
("Loading Maxwell Wi-Fi driver\n");

659 ià(
	`¦si_udi_š™
())

660 
	`SLSI_INFO_NODEV
("Failedo init udi - continuing\n");

662 ià(
	`¦si_sm_£rviû_driv”_»gi¡”
())

663 
	`SLSI_INFO_NODEV
("slsi_sm_service_driver_register failed - continuing\n");

666 
	`§p_mlme_š™
();

667 
	`§p_ma_š™
();

668 
	`§p_dbg_š™
();

669 
	`§p_‹¡_š™
();

672 #ià
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 9

673 
	`¦si_ü—‹_sysfs_maÿddr
();

674 
	`¦si_ü—‹_sysfs_v”siÚ_šfo
();

676 #ià
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

677 
	`¦si_ü—‹_sysfs_debug_dump
();

678 
	`scsc_wÏn_mm­_ü—‹
();

680 
	`¦si_ü—‹_sysfs_pm
();

681 
	`¦si_ü—‹_sysfs_ªt
();

682 
	`SLSI_INFO_NODEV
("--- Maxwell Wi-Fi driver†oaded successfully ---\n");

684 
	}
}

686 
__ex™
 
	$¦si_dev_uÆßd
()

688 
	`SLSI_INFO_NODEV
("Unloading Maxwell Wi-Fi driver\n");

690 #ià
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 9

691 
	`¦si_de¡roy_sysfs_maÿddr
();

692 
	`¦si_de¡roy_sysfs_v”siÚ_šfo
();

694 #ià
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

695 
	`scsc_wÏn_mm­_de¡roy
();

696 
	`¦si_de¡roy_sysfs_debug_dump
();

698 
	`¦si_de¡roy_sysfs_pm
();

699 
	`¦si_de¡roy_sysfs_ªt
();

701 
	`§p_mlme_deš™
();

702 
	`§p_ma_deš™
();

703 
	`§p_dbg_deš™
();

704 
	`§p_‹¡_deš™
();

706 
	`¦si_sm_£rviû_driv”_uÄegi¡”
();

708 
	`¦si_udi_deš™
();

710 
	`SLSI_INFO_NODEV
("--- Maxwell Wi-Fi driver unloaded successfully ---\n");

711 
	}
}

713 
moduË_š™
(
¦si_dev_lßd
);

714 
moduË_ex™
(
¦si_dev_uÆßd
);

716 
MODULE_DESCRIPTION
("mx140 Wi-Fi Driver");

717 
MODULE_AUTHOR
("SLSI");

718 
MODULE_LICENSE
("GPL‡nd‡dditional„ights");

	@dev.h

7 #iâdeà
__SLSI_DEVICE_H__


8 
	#__SLSI_DEVICE_H__


	)

10 
	~<lšux/š™.h
>

11 
	~<lšux/deviû.h
>

12 
	~<lšux/š‘deviû.h
>

13 
	~<Ãt/addrcÚf.h
>

15 
	~<lšux/v”siÚ.h
>

16 
	~<lšux/moduË.h
>

17 
	~<lšux/¡ršg.h
>

18 
	~<lšux/k”Ãl.h
>

19 
	~<lšux/Ãtdeviû.h
>

20 
	~<lšux/‘h”deviû.h
>

21 
	~<lšux/¿‹lim™.h
>

22 
	~<lšux/.h
>

24 
	~<lšux/com¶‘iÚ.h
>

25 
	~<lšux/wÜkqueue.h
>

26 
	~<lšux/time.h
>

27 
	~<lšux/sched.h
>

28 
	~<lšux/v”siÚ.h
>

29 
	~<lšux/Æ80211.h
>

30 
	~<lšux/wœ–ess.h
>

31 
	~<lšux/´oc_fs.h
>

32 
	~<lšux/›“80211.h
>

33 
	~<Ãt/cfg80211.h
>

34 
	~<lšux/Æ80211.h
>

36 
	~<scsc/scsc_mx.h
>

38 
	~"çpi.h
"

39 
	~"cÚ¡.h
"

40 
	~"uts.h
"

41 
	~"h.h
"

42 
	~"log_ş›Ás.h
"

43 
	~"¤c_sšk.h
"

44 
	~"scsc_wifi_fcq.h
"

45 
	~"scsc_wifi_cm_if.h
"

46 
	~"h4.h
"

47 
	~"Æ80211_v’dÜ.h
"

48 
	~"Œaffic_mÚ™Ü.h
"

49 
	~"»g_šfo.h
"

51 
	#FAPI_MAJOR_VERSION
(
v
è(((vè>> 8è& 0xFF)

	)

52 
	#FAPI_MINOR_VERSION
(
v
è((vè& 0xFF)

	)

55 
	#SLSI_80211_MODE_11B
 0

	)

56 
	#SLSI_80211_MODE_11G
 1

	)

57 
	#SLSI_80211_MODE_11N
 2

	)

58 
	#SLSI_80211_MODE_11A
 3

	)

59 
	#SLSI_80211_MODE_11AC
 4

	)

60 
	#SLSI_80211_MODE_11AX
 5

	)

62 
	#SLSI_FW_API_RATE_HT_SELECTOR_FIELD
 0xc000

	)

63 
	#SLSI_FW_API_RATE_NON_HT_SELECTED
 0x4000

	)

64 
	#SLSI_FW_API_RATE_HT_SELECTED
 0x8000

	)

65 
	#SLSI_FW_API_RATE_VHT_SELECTED
 0xc000

	)

66 
	#SLSI_FW_API_RATE_HE_SELECTED
 0x10000

	)

68 
	#SLSI_FW_API_RATE_VHT_MCS_FIELD
 0x000F

	)

69 
	#SLSI_FW_API_RATE_HT_MCS_FIELD
 0x003F

	)

70 
	#SLSI_FW_API_RATE_INDEX_FIELD
 0x1fff

	)

71 
	#SLSI_FW_API_RATE_VHT_NSS_FIELD
 0x0070

	)

72 
	#SLSI_FW_API_RATE_HT_NSS_FIELD
 0x0040

	)

74 
	#SLSI_FW_API_RATE_BW_FIELD
 0x0600

	)

75 
	#SLSI_FW_API_RATE_BW_40MHZ
 0x0200

	)

76 
	#SLSI_FW_API_RATE_BW_20MHZ
 0x0000

	)

78 
	#SLSI_FW_API_RATE_SGI
 0x0100

	)

79 
	#SLSI_FW_API_RATE_GF
 0x0080

	)

80 
	#SLSI_FW_API_RATE_11AX_GI_POSN
 17

	)

81 
	#SLSI_FW_API_RATE_11AX_GI
 (0x3 << 
SLSI_FW_API_RATE_11AX_GI_POSN
)

	)

82 
	#SLSI_FW_API_GET_11AX_GI
(
v®
è((v® & 
SLSI_FW_API_RATE_11AX_GI
è>> 
SLSI_FW_API_RATE_11AX_GI_POSN
)

	)

84 
	#SLSI_HOSTSTATE_LCD_ACTIVE
 0x0001

	)

85 
	#SLSI_HOSTSTATE_CELLULAR_ACTIVE
 0x0002

	)

86 
	#SLSI_HOSTSTATE_SAR_ACTIVE
 0x0004

	)

87 
	#SLSI_HOSTSTATE_GRIP_ACTIVE
 0x0040

	)

88 
	#SLSI_HOSTSTATE_LOW_LATENCY_ACTIVE
 0x0080

	)

89 
	#SLSI_HOST_TAG_ARP_MASK
 
	`BIT
(15)

	)

90 
	#SLSI_ARP_UNPAUSE_THRESHOLD
 4

	)

92 
	#HEAD_SAR_BACKOFF_DISABLED
 -1

	)

93 
	#HEAD_SAR_BACKOFF_ENABLED
 0

	)

94 
	#BODY_SAR_BACKOFF_DISABLED
 1

	)

95 
	#BODY_SAR_BACKOFF_ENABLED
 2

	)

96 
	#NR_MMWAVE_SAR_BACKOFF_DISABLED
 3

	)

97 
	#NR_MMWAVE_SAR_BACKOFF_ENABLED
 4

	)

98 
	#NR_SUB6_SAR_BACKOFF_DISABLED
 5

	)

99 
	#NR_SUB6_SAR_BACKOFF_ENABLED
 6

	)

100 
	#SAR_BACKOFF_DISABLE_ALL
 7

	)

101 
	#MHS_SAR_BACKOFF_DISABLED
 8

	)

102 
	#MHS_SAR_BACKOFF_ENABLED
 9

	)

104 
	#SUB6_SAR_1_BAND
 7

	)

105 
	#SUB6_SAR_2_BAND
 38

	)

106 
	#SUB6_SAR_3_BAND
 40

	)

107 
	#SUB6_SAR_4_BAND
 41

	)

108 
	#SUB6_SAR_5_BAND
 77

	)

109 
	#SUB6_SAR_6_BAND
 78

	)

111 
	#SLSI_HOSTSTATE_MHS_SAR_ACTIVE
 0x0010

	)

112 
	#SLSI_HOSTSTATE_HEAD_SAR_ACTIVE
 0x0020

	)

113 
	#SLSI_HOSTSTATE_GRIP_SAR_ACTIVE
 0x0040

	)

114 
	#SLSI_HOSTSTATE_LOW_LATENCY_ACTIVE
 0x0080

	)

115 
	#SLSI_HOSTSTATE_SAR_INIT_MASK
 0x0083

	)

116 
	#SLSI_HOSTSTATE_BASE_MASK
 0x000C

	)

117 
	#SLSI_HOSTSTATE_BASE_NONE
 0

	)

118 
	#SLSI_HOSTSTATE_BASE_MMW
 1

	)

119 
	#SLSI_HOSTSTATE_BASE_SUB6
 2

	)

120 
	#SLSI_HOSTSTATE_BASE_POS
 2

	)

121 
	#SLSI_HOSTSTATE_SUB6_BAND_MASK
 0x0700

	)

122 
	#SLSI_HOSTSTATE_SUB6_BAND_POS
 8

	)

125 
	#SLSI_MIN_RTT_ID
 1

	)

126 
	#SLSI_MAX_RTT_ID
 7

	)

128 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


129 
	#SLSI_MAX_ARP_SEND_FRAME
 8

	)

132 
	#HOME_TIME_BIT
 
	`BIT
(0)

	)

133 
	#HOME_AWAY_TIME_BIT
 
	`BIT
(1)

	)

134 
	#MAX_CHANNEL_TIME_BIT
 
	`BIT
(2)

	)

135 
	#MAX_CHANNEL_PASSIVE_TIME_BIT
 
	`BIT
(3)

	)

136 
	#LATENCY_ALL_SET_MASK
 (
HOME_TIME_BIT
 | \

137 
HOME_AWAY_TIME_BIT
 | \

138 
MAX_CHANNEL_TIME_BIT
 | \

139 
MAX_CHANNEL_PASSIVE_TIME_BIT
)

	)

142 
	#SYSTEM_ERROR_BUFFER_SZ
 4096

	)

150 cÚ¡ 
u16
 
	g¦si_¿‹s_bË
[3][2][12] = {

177 cÚ¡ 
u16
 
	g¦si_he_¿‹s_bË_2x2
[4][12][3] = {

205 
	smsduhdr
 {

206 
	mh_de¡
[
ETH_ALEN
];

207 
	mh_sourû
[
ETH_ALEN
];

208 
__be16
 
	mËn
;

209 
	md§p
;

210 
	ms§p
;

211 
	mui
;

212 
	moui
[3];

213 
__be16
 
	mty³
;

214 } 
__©Œibu‹__
((
·cked
));

216 
šlše
 
	$‘hr_ii_to_subäame_msdu
(
sk_buff
 *
skb
)

218 
‘hhdr
 *
ehdr
;

219 
msduhdr
 
msduh
;

221 
ehdr
 = 
	`‘h_hdr
(
skb
);

222 
	`‘h”_addr_cİy
(
msduh
.
h_de¡
, 
ehdr
->h_dest);

223 
	`‘h”_addr_cİy
(
msduh
.
h_sourû
, 
ehdr
->h_source);

225 
msduh
.
Ën
 = 
	`ıu_to_be16
(
skb
->len - 6);

226 
msduh
.
d§p
 = 0xaa;

227 
msduh
.
s§p
 = 0xaa;

228 
msduh
.
ui
 = 0x03;

229 
	`mem£t
(
msduh
.
oui
, 0x0, 3);

230 
msduh
.
ty³
 = 
ehdr
->
h_´Ùo
;

231 ()
	`skb_push
(
skb
, (
msduhdr
è- (
‘hhdr
));

233 
skb
->
mac_h—d”
 -ğ((
msduhdr
è- (
‘hhdr
));

234 
	`memıy
(
skb
->
d©a
, &
msduh
, (
msduhdr
));

235 
	}
}

237 
	#SLSI_TX_PROCESS_ID_MIN
 (0xC001)

	)

238 
	#SLSI_TX_PROCESS_ID_MAX
 (0xCF00)

	)

239 
	#SLSI_TX_PROCESS_ID_UDI_MIN
 (0xCF01)

	)

240 
	#SLSI_TX_PROCESS_ID_UDI_MAX
 (0xCFFE)

	)

246 
	#SLSI_RX_WAKELOCK_TIME
 (200)

	)

247 
	#MAX_BA_BUFFER_SIZE
 64

	)

248 
	#NUM_BA_SESSIONS_PER_PEER
 8

	)

249 
	#SLSI_NCHO_MAX_CHANNEL_LIST
 20

	)

250 
	#SLSI_MAX_CHANNEL_LIST
 20

	)

251 
	#SLSI_MAX_RX_BA_SESSIONS
 (8)

	)

252 
	#SLSI_STA_ACTION_FRAME_BITMAP
 (
SLSI_ACTION_FRAME_PUBLIC
 | 
SLSI_ACTION_FRAME_WMM
 | 
SLSI_ACTION_FRAME_WNM
 |\

253 
SLSI_ACTION_FRAME_QOS
 | 
SLSI_ACTION_FRAME_PROTECTED_DUAL
 |\

254 
SLSI_ACTION_FRAME_RADIO_MEASUREMENT
)

	)

255 
	#SLSI_STA_ACTION_FRAME_SUSPEND_BITMAP
 (
SLSI_ACTION_FRAME_PUBLIC
 | 
SLSI_ACTION_FRAME_WMM
 | 
SLSI_ACTION_FRAME_WNM
 |\

256 
SLSI_ACTION_FRAME_QOS
 | 
SLSI_ACTION_FRAME_PROTECTED_DUAL
)

	)

259 
	#SLSI_DEFAULT_AP_DISCONNECT_IND_TIMEOUT
 3000

	)

261 
	#NUM_COUNTRY
 (300)

	)

263 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


264 
	#SLSI_MUTEX_INIT
(
¦si_mu‹x__
) \

266 (
¦si_mu‹x__
).
owÃr
 = 
NULL
; \

267 
	`mu‹x_š™
(&(
¦si_mu‹x__
).
mu‹x
); \

268 (
¦si_mu‹x__
).
v®id
 = 
Œue
; \

269 } 0)

	)

271 
	#SLSI_MUTEX_LOCK
(
¦si_mu‹x_to_lock
) \

273 (
¦si_mu‹x_to_lock
).
lše_no_befÜe
 = 
__LINE__
; \

274 (
¦si_mu‹x_to_lock
).
fe_Çme_befÜe
 = 
__FILE__
; \

275 
	`mu‹x_lock
(&(
¦si_mu‹x_to_lock
).
mu‹x
); \

276 (
¦si_mu‹x_to_lock
).
owÃr
 = 
cu¼’t
; \

277 (
¦si_mu‹x_to_lock
).
lše_no_aá”
 = 
__LINE__
; \

278 (
¦si_mu‹x_to_lock
).
fe_Çme_aá”
 = 
__FILE__
; \

279 (
¦si_mu‹x_to_lock
).
funùiÚ
 = 
__func__
; \

280 } 0)

	)

282 
	#SLSI_MUTEX_UNLOCK
(
¦si_mu‹x_to_uÆock
) \

284 (
¦si_mu‹x_to_uÆock
).
owÃr
 = 
NULL
; \

285 
	`mu‹x_uÆock
(&(
¦si_mu‹x_to_uÆock
).
mu‹x
); \

286 } 0)

	)

287 
	#SLSI_MUTEX_IS_LOCKED
(
¦si_mu‹x__
è
	`mu‹x_is_locked
(&(¦si_mu‹x__).
mu‹x
)

	)

289 
	s¦si_mu‹x
 {

290 
boŞ
 
	mv®id
;

291 
u32
 
	mlše_no_befÜe
;

292 cÚ¡ 
u8
 *
	mfe_Çme_befÜe
;

294 
mu‹x
 
	mmu‹x
;

295 
u32
 
	mlše_no_aá”
;

296 cÚ¡ 
u8
 *
	mfe_Çme_aá”
;

297 cÚ¡ 
u8
 *
	mfunùiÚ
;

298 
sk_¡ruù
 *
	mowÃr
;

302 
	#SLSI_MUTEX_INIT
(
mu‹x__
è
	`mu‹x_š™
(&(mu‹x__))

	)

303 
	#SLSI_MUTEX_LOCK
(
mu‹x_to_lock
è
	`mu‹x_lock
(&(mu‹x_to_lock))

	)

304 
	#SLSI_MUTEX_UNLOCK
(
mu‹x_to_uÆock
è
	`mu‹x_uÆock
(&(mu‹x_to_uÆock))

	)

305 
	#SLSI_MUTEX_IS_LOCKED
(
mu‹x__
è
	`mu‹x_is_locked
(&(mu‹x__))

	)

308 
	#OS_UNUSED_PARAMETER
(
x
è(()(x))

	)

310 
	#SLSI_HOST_TAG_TRAFFIC_QUEUE
(
hg
è(hg & 0x00000003)

	)

327 
	s¦si_sig_£nd
 {

329 
¥šlock_t
 
	m£nd_sigÇl_lock
;

330 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


331 
¦si_mu‹x
 
	mmu‹x
;

334 
mu‹x
 
	mmu‹x
;

336 
com¶‘iÚ
 
	mcom¶‘iÚ
;

338 
u16
 
	m´oûss_id
;

339 
u16
 
	m»q_id
;

340 
u16
 
	mcfm_id
;

341 
u16
 
	mšd_id
;

342 
sk_buff
 *
	mcfm
;

343 
sk_buff
 *
	mšd
;

344 
sk_buff
 *
	mmib_”rÜ
;

347 
šlše
 
	$¦si_sig_£nd_š™
(
¦si_sig_£nd
 *
sig_£nd
)

349 
	`¥š_lock_š™
(&
sig_£nd
->
£nd_sigÇl_lock
);

350 
sig_£nd
->
»q_id
 = 0;

351 
sig_£nd
->
cfm_id
 = 0;

352 
sig_£nd
->
´oûss_id
 = 
SLSI_TX_PROCESS_ID_MIN
;

353 
	`SLSI_MUTEX_INIT
(
sig_£nd
->
mu‹x
);

354 
	`š™_com¶‘iÚ
(&
sig_£nd
->
com¶‘iÚ
);

355 
	}
}

357 
	s¦si_ba_äame_desc
 {

358 
boŞ
 
	maùive
;

359 
sk_buff
 *
	msigÇl
;

360 
u16
 
	m¢
;

363 
	s¦si_ba_£ssiÚ_rx
 {

364 
boŞ
 
	maùive
;

365 
boŞ
 
	mu£d
;

366 *
	mvif
;

367 
¦si_ba_äame_desc
 
	mbufãr
[
MAX_BA_BUFFER_SIZE
];

368 
u16
 
	mbufãr_size
;

369 
u16
 
	moccup›d_¦Ùs
;

370 
u16
 
	mex³ùed_¢
;

371 
u16
 
	m¡¬t_¢
;

372 
u16
 
	mhighe¡_»ûived_¢
;

373 
boŞ
 
	mşosšg
;

374 
boŞ
 
	mŒigg”_ba_aá”_s¢
;

375 
u8
 
	mtid
;

378 
boŞ
 
	mtim”_Ú
;

379 
tim”_li¡
 
	mba_age_tim”
;

380 
Ãt_deviû
 *
	mdev
;

383 
	#SLSI_TID_MAX
 (16)

	)

384 
	#SLSI_AMPDU_F_INITIATED
 (0x0001)

	)

385 
	#SLSI_AMPDU_F_CREATED
 (0x0002)

	)

386 
	#SLSI_AMPDU_F_OPERATIONAL
 (0x0004)

	)

388 
	#SLSI_SCAN_HW_ID
 0

	)

389 
	#SLSI_SCAN_SCHED_ID
 1

	)

390 
	#SLSI_SCAN_MAX
 3

	)

392 
	#SLSI_SCAN_SSID_MAP_MAX
 10

	)

393 
	#SLSI_SCAN_SSID_MAP_EXPIRY_AGE
 2

	)

394 
	#SLSI_FW_SCAN_DONE_TIMEOUT_MSEC
 (20 * 1000)

	)

395 
	#MAX_CHANNEL_COUNT
 40

	)

397 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

398 
	e¦si_bss_£cur™y
 {

399 
	mSLSI_BSS_SECURED_NO
 = 
BIT
(0),

400 
	mSLSI_BSS_SECURED_PSK
 = 
BIT
(1),

401 
	mSLSI_BSS_SECURED_1x
 = 
BIT
(2),

402 
	mSLSI_BSS_SECURED_SAE
 = 
BIT
(3)

405 
	s¦si_ssid_šfo
 {

406 
li¡_h—d
 
	mli¡
;

407 
cfg80211_ssid
 
	mssid
;

408 
li¡_h—d
 
	mbssid_li¡
;

409 
u8
 
	makm_ty³
;

412 
	s¦si_bssid_šfo
 {

413 
li¡_h—d
 
	mli¡
;

414 
u8
 
	mbssid
[
ETH_ALEN
];

415 
u16
 
	mäeq
;

416 
	mrssi
;

417 
boŞ
 
	mcÚÃù_©‹m±ed
;

421 
	s¦si_bssid_bÏckli¡_šfo
 {

422 
li¡_h—d
 
	mli¡
;

423 
u8
 
	mbssid
[
ETH_ALEN
];

424 
	m’d_time
;

427 
	s¦si_ioùl_bÏckli¡_šfo
 {

428 
li¡_h—d
 
	mli¡
;

429 
u8
 
	mbssid
[
ETH_ALEN
];

432 
	s¦si_sÿn_»suÉ
 {

433 
u8
 
	mbssid
[
ETH_ALEN
];

434 
u8
 
	mhidd’
;

435 
	mrssi
;

436 
sk_buff
 *
	m´obe_»¥
;

437 
sk_buff
 *
	mb—cÚ
;

438 
¦si_sÿn_»suÉ
 *
	mÃxt
;

439 
	mbªd
;

440 
u8
 
	mssid
[32];

441 
u8
 
	mssid_Ëngth
;

442 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

443 
u8
 
	makm_ty³
;

450 
	s¦si_sÿn
 {

452 
cfg80211_sÿn_»que¡
 *
	msÿn_»q
;

453 
¦si_acs_»que¡
 *
	macs_»que¡
;

454 
cfg80211_sched_sÿn_»que¡
 *
	msched_»q
;

455 
boŞ
 
	m»queue_timeout_wÜk
;

458 
boŞ
 
	mis_blockšg_sÿn
;

460 
¦si_sÿn_»suÉ
 *
	msÿn_»suÉs
;

463 
	s¦si_ssid_m­
 {

464 
u8
 
	mbssid
[
ETH_ALEN
];

465 
u8
 
	mssid
[32];

466 
u8
 
	mssid_Ën
;

467 
u8
 
	mage
;

468 
	mbªd
;

471 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


472 
	s¦si_’hªûd_¬p_couÁ”s
 {

473 
u16
 
	m¬p_»q_couÁ_äom_Ãtdev
;

474 
u16
 
	m¬p_»q_couÁ_to_low”_mac
;

475 
u16
 
	m¬p_»q_rx_couÁ_by_low”_mac
;

476 
u16
 
	m¬p_»q_couÁ_tx_sucûss
;

477 
u16
 
	m¬p_r¥_rx_couÁ_by_low”_mac
;

478 
u16
 
	m¬p_r¥_rx_couÁ_by_uµ”_mac
;

479 
u16
 
	m¬p_r¥_couÁ_to_Ãtdev
;

480 
u16
 
	m¬p_r¥_couÁ_out_of_Üd”_drİ
;

481 
u16
 
	m­_lšk_aùive
;

482 
boŞ
 
	mis_du¶iÿ‹_addr_d‘eùed
;

486 
	s¦si_³”
 {

490 
boŞ
 
	mv®id
;

491 
u8
 
	madd»ss
[
ETH_ALEN
];

494 
u8
 
	mcÚÃùed_¡©e
;

495 
u16
 
	maid
;

497 
boŞ
 
	mis_wps
;

498 
u16
 
	mÿ·b™›s
;

499 
boŞ
 
	mqos_’abËd
;

500 
u8
 
	mqueue£t
;

501 
scsc_wifi_fcq_d©a_q£t
 
	md©a_qs
;

502 
scsc_wifi_fcq_ù¾_q
 
	mù¾_q
;

504 
boŞ
 
	mauthÜized
;

505 
boŞ
 
	m·œwi£_key_£t
;

508 
sk_buff
 *
	massoc_›
;

509 
sk_buff_h—d
 
	mbufã»d_äames
;

511 
sk_buff
 *
	massoc_»¥_›
;

518 
u8
 
	mwmm_acm
;

524 
u8
 
	mt¥ec_e¡ablished
;

525 
u8
 
	mu­sd
;

532 
¡©iÚ_šfo
 
	msšfo
;

534 
¿‹lim™_¡©e
 
	msšfo_mib_g‘_rs
;

535 
¦si_ba_£ssiÚ_rx
 *
	mba_£ssiÚ_rx
[
NUM_BA_SESSIONS_PER_PEER
];

537 
boŞ
 
	mqos_m­_£t
;

538 
cfg80211_qos_m­
 
	mqos_m­
;

539 
u16
 
	mndl_vif
;

540 
u8
 
	mndp_couÁ
;

545 
	#SLSI_VIFTYPE_UNSPECIFIED
 0xFFFF

	)

547 
	s¦si_vif_mgmt_tx
 {

548 
u64
 
	mcook›
;

549 
u16
 
	mho¡_g
;

550 cÚ¡ 
u8
 *
	mbuf
;

551 
size_t
 
	mbuf_Ën
;

552 
u8
 
	mexp_äame
;

555 
	s¦si_wmm_ac
 {

556 
u8
 
	maci_aif¢
;

557 
u8
 
	mecw
;

558 
u16
 
	mtxİ_lim™
;

559 } 
	g__·cked
;

573 
	s¦si_wmm_·¿m‘”_–em’t
 {

574 
u8
 
	meid
;

575 
u8
 
	mËn
;

576 
u8
 
	moui
[3];

577 
u8
 
	moui_ty³
;

578 
u8
 
	moui_subty³
;

579 
u8
 
	mv”siÚ
;

580 
u8
 
	mqos_šfo
;

581 
u8
 
	m»£rved
;

582 
¦si_wmm_ac
 
	mac
[4];

583 } 
	g__·cked
;

585 
	#SLSI_MIN_FILTER_ID
 0x80

	)

588 
	#SLSI_AP_ALL_IPV6_PKTS_FILTER_ID
 0x80

	)

591 #ià
IS_ENABLED
(
CONFIG_IPV6
)

593 
	e¦si_f‹r_id
 {

594 
	mSLSI_LOCAL_ARP_FILTER_ID
 = 
SLSI_MIN_FILTER_ID
,

595 
	mSLSI_ALL_BC_MC_FILTER_ID
,

596 
	mSLSI_PROXY_ARP_FILTER_ID
,

597 
	mSLSI_LOCAL_NS_FILTER_ID
,

598 
	mSLSI_PROXY_ARP_NA_FILTER_ID
,

599 #iâdeà
CONFIG_SCSC_WLAN_DISABLE_NAT_KA


600 
	mSLSI_NAT_IPSEC_FILTER_ID
,

602 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


603 
	mSLSI_OPT_OUT_ALL_FILTER_ID
,

604 
	mSLSI_OPT_IN_TCP4_FILTER_ID
,

605 
	mSLSI_OPT_IN_TCP6_FILTER_ID
,

607 
	mSLSI_MULTI_TO_UNICAST_IPV4_ID
,

608 
	mSLSI_MULTI_TO_UNICAST_IPv6_ID
,

609 
	mSLSI_ALL_ARP_FILTER_ID
,

610 
	mSLSI_REGD_MC_FILTER_ID
,

613 
	e¦si_f‹r_id
 {

614 
	mSLSI_LOCAL_ARP_FILTER_ID
 = 
SLSI_MIN_FILTER_ID
,

615 
	mSLSI_ALL_BC_MC_FILTER_ID
,

616 
	mSLSI_PROXY_ARP_FILTER_ID
,

617 
	mSLSI_ALL_IPV6_PKTS_FILTER_ID
,

618 #iâdeà
CONFIG_SCSC_WLAN_DISABLE_NAT_KA


619 
	mSLSI_NAT_IPSEC_FILTER_ID
,

621 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


622 
	mSLSI_OPT_OUT_ALL_FILTER_ID
,

623 
	mSLSI_OPT_IN_TCP4_FILTER_ID
,

624 
	mSLSI_OPT_IN_TCP6_FILTER_ID
,

626 
	mSLSI_MULTI_TO_UNICAST_IPV4_ID
,

627 
	mSLSI_ALL_ARP_FILTER_ID
,

628 
	mSLSI_REGD_MC_FILTER_ID
,

632 
	#SLSI_MAX_PKT_FILTERS
 16

	)

634 #iâdeà
CONFIG_SCSC_WLAN_DISABLE_NAT_KA


636 
	#SLSI_MC_ADDR_ENTRY_MAX
 (
SLSI_MIN_FILTER_ID
 + 
SLSI_MAX_PKT_FILTERS
 - 
SLSI_REGD_MC_FILTER_ID
)

	)

638 
	#SLSI_MC_ADDR_ENTRY_MAX
 (
SLSI_MIN_FILTER_ID
 + 
SLSI_MAX_PKT_FILTERS
 - 
SLSI_REGD_MC_FILTER_ID
 + 1)

	)

648 
	#SLSI_VIF_STATUS_UNSPECIFIED
 0

	)

649 
	#SLSI_VIF_STATUS_CONNECTING
 1

	)

650 
	#SLSI_VIF_STATUS_CONNECTED
 2

	)

651 
	#SLSI_VIF_STATUS_DISCONNECTING
 3

	)

654 
	#SLSI_MAX_KEEPALIVE_ID
 3

	)

656 
	s¦si_Ï¡_cÚÃùed_bss
 {

657 
u8
 
	madd»ss
[
ETH_ALEN
];

658 
	mª‹Âa_mode
;

659 
	mrssi
;

660 
	mmode
;

661 
	m·s¥ošt_v”siÚ
;

662 
	m¢r
;

663 
	mnoi£_Ëv–
;

664 
u16
 
	mbªdwidth
;

665 
u16
 
	mrßmšg_couÁ
;

666 
u16
 
	mchªÃl_äeq
;

667 
u16
 
	mtx_d©a_¿‹
;

668 
u8
 
	mrßmšg_akm
;

669 
u8
 
	mkv
;

670 
u32
 
	mkv›
;

671 
boŞ
 
	mmimo_u£d
;

672 
u8
 
	mssid
[
IEEE80211_MAX_SSID_LEN
 + 1];

673 
u8
 
	mssid_Ën
;

676 
	e¦si_w·3_auth_¡©e
 {

677 
	mSLSI_WPA3_PREAUTH
,

678 
	mSLSI_WPA3_AUTHENTICATING
,

679 
	mSLSI_WPA3_AUTHENTICATED


682 
	s¦si_vif_¡a
 {

684 
u8
 
	mvif_¡©us
;

685 
boŞ
 
	mis_wps
;

686 
boŞ
 
	mrßm_Ú_discÚÃù
;

687 
u16
 
	m—p_ho¡g
;

688 
u16
 
	mm4_ho¡_g
;

689 
u16
 
	mk“·live_ho¡_g
[
SLSI_MAX_KEEPALIVE_ID
];

691 
sk_buff
 *
	mrßm_mlme_´oûdu»_¡¬‹d_šd
;

696 
u16
 
	m»¥_id
;

697 
boŞ
 
	mg¿tu™ous_¬p_Ãeded
;

700 
u8
 
	m»gd_mc_addr_couÁ
;

701 
u8
 
	m»gd_mc_addr
[
SLSI_MC_ADDR_ENTRY_MAX
][
ETH_ALEN
];

702 
¦si_¥šlock
 
	m»gd_mc_addr_lock
;

704 
boŞ
 
	mgroup_key_£t
;

705 
boŞ
 
	mw•_key_£t
;

706 
sk_buff
 *
	mmlme_sÿn_šd_skb
;

707 
boŞ
 
	mrßm_š_´og»ss
;

708 
	mtdls_³”_¡a_»cÜds
;

709 
boŞ
 
	mtdls_’abËd
;

710 
cfg80211_bss
 *
	m¡a_bss
;

711 
u8
 *
	massoc_»q_add_šfo_–em
;

712 
	massoc_»q_add_šfo_–em_Ën
;

715 
li¡_h—d
 
	mÃtwÜk_m­
;

716 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

717 
li¡_h—d
 
	mssid_šfo
;

718 
li¡_h—d
 
	mbÏckli¡_h—d
;

721 
¦si_wmm_ac
 
	mwmm_ac
[4];

722 
boŞ
 
	mnd_ofæßd_’abËd
;

723 
	md©a_¿‹_mbps
;

724 
	mmax_¿‹_mbps
;

727 
¦si_Ï¡_cÚÃùed_bss
 
	mÏ¡_cÚÃùed_bss
;

728 
cfg80211_üy±o_£‰šgs
 
	müy±o
;

731 
©omic_t
 
	mdrİ_rßmed_šd
;

732 
u8
 *
	mv’dÜ_discÚÃù_›s
;

733 
	mv’dÜ_discÚÃù_›s_Ën
;

734 
u8
 
	mbssid
[
ETH_ALEN
];

735 
u8
 
	mssid
[
IEEE80211_MAX_SSID_LEN
];

736 
u8
 
	mssid_Ën
;

737 
u8
 *
	mr¢_›
;

738 
	mr¢_›_Ën
;

739 
	mu£_£t_pmk§
;

742 
u16
 
	mchªÃls_24_ghz
;

743 
u32
 
	mchªÃls_5_ghz
;

744 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

745 
boŞ
 
	mdrv_bss_£ËùiÚ
;

746 
boŞ
 
	mdrv_cÚÃù_»q_Úgošg
;

749 
cfg80211_cÚÃù_·¿ms
 
	msme
;

750 cÚ¡ 
u8
 *
	mcÚÃùed_bssid
;

751 cÚ¡ 
u8
 *
	mcÚÃùed_ssid
;

752 
	mcÚÃùed_ssid_Ën
;

753 
u8
 
	makm_ty³
;

754 
	mb—cÚ_št
;

755 
¦si_w·3_auth_¡©e
 
	mw·3_auth_¡©e
;

756 
u32
 
	maùiÚ_äame_bm­
;

757 
u32
 
	maùiÚ_äame_su¥’d_bm­
;

758 
boŞ
 
	mw·3_§e_»cÚÃùiÚ
;

762 
	s¦si_vif_unsync
 {

763 
d–ayed_wÜk
 
	mroc_expœy_wÜk
;

764 
d–ayed_wÜk
 
	md–_vif_wÜk
;

765 
d–ayed_wÜk
 
	mhs2_d–_vif_wÜk
;

766 
d–ayed_wÜk
 
	mun£t_chªÃl_expœy_wÜk
;

767 
u64
 
	mroc_cook›
;

768 
u8
 *
	m´obe_r¥_›s
;

769 
size_t
 
	m´obe_r¥_›s_Ën
;

770 
boŞ
 
	m›s_chªged
;

771 
boŞ
 
	mli¡’_ofæßd
;

772 
boŞ
 
	m¦si_p2p_cÚtšuous_fuÎsÿn
;

775 
	s¦si_Ï¡_discÚÃùed_¡a
 {

776 
u8
 
	madd»ss
[
ETH_ALEN
];

777 
u32
 
	mrx_»Œy_·ck‘s
;

778 
u32
 
	mrx_bc_mc_·ck‘s
;

779 
u16
 
	mÿ·b™›s
;

780 
	mbªdwidth
;

781 
	mª‹Âa_mode
;

782 
	mrssi
;

783 
	mmode
;

784 
u16
 
	mtx_d©a_¿‹
;

785 
boŞ
 
	mmimo_u£d
;

786 
u16
 
	m»asÚ
;

787 
	msuµÜt_mode
;

790 
	s¦si_vif_­
 {

791 
¦si_wmm_·¿m‘”_–em’t
 
	mwmm_›
;

792 
¦si_Ï¡_discÚÃùed_¡a
 
	mÏ¡_discÚÃùed_¡a
;

793 
u8
 *
	mÿche_wmm_›
;

794 
u8
 *
	mÿche_w·_›
;

795 
u8
 *
	madd_šfo_›s
;

796 
size_t
 
	mwmm_›_Ën
;

797 
size_t
 
	mw·_›_Ën
;

798 
size_t
 
	madd_šfo_›s_Ën
;

799 
boŞ
 
	mp2p_gc_keys_£t
;

800 
boŞ
 
	m´ivacy
;

801 
boŞ
 
	mqos_’abËd
;

802 
	mb—cÚ_š‹rv®
;

803 
	mmode
;

804 
boŞ
 
	mnÚ_ht_bss_´e£Á
;

805 
scsc_wifi_fcq_d©a_q£t
 
	mgroup_d©a_qs
;

806 
u32
 
	mch”
;

807 
u16
 
	mchªÃl_äeq
;

808 
u8
 
	mssid
[
IEEE80211_MAX_SSID_LEN
];

809 
u8
 
	mssid_Ën
;

810 #ifdeà
CONFIG_SCSC_WLAN_MAC_ACL_PER_MAC


811 
cfg80211_aş_d©a
 *
	maş_d©a_bÏckli¡
;

815 
	s¦si_Çn_ndl_šfo
 {

816 
u8
 
	m³”_nmi
[
ETH_ALEN
];

817 
s8
 
	mndp_couÁ
;

820 
	s¦si_Çn_discov”y_šfo
 {

821 
u8
 
	m³”_addr
[
ETH_ALEN
];

822 
u8
 
	m£ssiÚ_id
;

823 
u8
 
	mm©ch_id
;

824 
¦si_Çn_discov”y_šfo
 *
	mÃxt
;

827 
	endp_¦Ù_¡©us
 {

828 
	mndp_¦Ù_¡©us_ä“
,

829 
	mndp_¦Ù_¡©us_š_u£
,

830 
	mndp_¦Ù_¡©us_‹rmš©šg
,

833 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


834 
	s¦si_vif_Çn
 {

835 
¦si_h®_Çn_cÚfig_»q
 
	mcÚfig
;

836 
u32
 
	m£rviû_id_m­
;

837 
u32
 
	mfŞlowup_id_m­
;

838 
u32
 
	mndp_š¡ªû_id_m­
;

839 
u32
 
	mÃxt_£rviû_id
;

840 
u32
 
	mÃxt_ndp_š¡ªû_id
;

841 
¦si_Çn_ndl_šfo
 
	mndl_li¡
[
SLSI_NAN_MAX_NDP_INSTANCES
];

842 
u8
 
	mndp_ndi
[
SLSI_NAN_MAX_NDP_INSTANCES
][
ETH_ALEN
];

843 
u16
 
	mndp_š¡ªû_id2ndl_vif
[
SLSI_NAN_MAX_NDP_INSTANCES
];

844 
u16
 
	mndp_loÿl_ndp_š¡ªû_id
[
SLSI_NAN_MAX_NDP_INSTANCES
];

845 
ndp_¦Ù_¡©us
 
	mndp_¡©e
[
SLSI_NAN_MAX_NDP_INSTANCES
];

850 
u16
 
	mfŞlowup_Œªs_id_m­
[
SLSI_NAN_MAX_HOST_FOLLOWUP_REQ
][2];

851 
com¶‘iÚ
 
	mndp_d–ay
;

853 
u8
 
	mdi§bË_şu¡”_m”ge
;

854 
u16
 
	mÇn_sdf_æags
[
SLSI_NAN_MAX_SERVICE_ID
 + 1];

856 
u8
 
	mndp_couÁ
;

858 
u8
 
	mloÿl_nmi
[
ETH_ALEN
];

859 
u8
 
	mşu¡”_id
[
ETH_ALEN
];

860 
u32
 
	mİ”©šg_chªÃl
[2];

861 
u8
 
	mrŞe
;

862 
u8
 
	m¡©e
;

863 
u8
 
	mma¡”_´ef_v®ue
;

864 
u32
 
	mamr_low”
;

865 
u32
 
	mamr_high”
;

866 
u8
 
	mhİcouÁ
;

867 
u32
 
	m¿ndom_mac_š‹rv®_£c
;

868 
u8
 
	mm©chid
;

869 
¦si_Çn_discov”y_šfo
 *
	mdisc_šfo
;

870 
	mndp_¡¬t_time
;

874 
	#TCP_ACK_SUPPRESSION_RECORDS_MAX
 16

	)

875 
	#TCP_ACK_SUPPRESSION_RECORD_UNUSED_TIMEOUT
 10

	)

877 
	#TCP_ACK_SUPPRESSION_OPTIONS_OFFSET
 20

	)

878 
	#TCP_ACK_SUPPRESSION_OPTION_EOL
 0

	)

879 
	#TCP_ACK_SUPPRESSION_OPTION_NOP
 1

	)

880 
	#TCP_ACK_SUPPRESSION_OPTION_MSS
 2

	)

881 
	#TCP_ACK_SUPPRESSION_OPTION_WINDOW
 3

	)

882 
	#TCP_ACK_SUPPRESSION_OPTION_SACK
 5

	)

884 
	#SLSI_IS_VIF_CHANNEL_5G
(
ndev_vif
è((Òdev_vif)->
chª
è? (Òdev_vif)->chª->
hw_v®ue
 > 14è: 0)

	)

886 
	s¦si_tı_ack_s
 {

887 
u32
 
	mdaddr
;

888 
u32
 
	mdpÜt
;

889 
u32
 
	m§ddr
;

890 
u32
 
	m¥Üt
;

891 
sk_buff_h—d
 
	mli¡
;

892 
u8
 
	mwšdow_muÉl›r
;

893 
u16
 
	mmss
;

894 
u32
 
	mack_£q
;

895 
u16
 
	m¦ow_¡¬t_couÁ
;

896 
u8
 
	mcouÁ
;

897 
u8
 
	mmax
;

898 
u8
 
	mage
;

899 
tim”_li¡
 
	mtim”
;

900 
boŞ
 
	m¡©e
;

901 
ktime_t
 
	mÏ¡_£Á
;

902 
boŞ
 
	mtı_¦ow_¡¬t
;

905 
u16
 
	mhy¡”esis
;

906 
u32
 
	mÏ¡_tı_¿‹
;

907 
ktime_t
 
	mÏ¡_§m¶e_time
;

908 
u32
 
	mÏ¡_ack_£q
;

909 
u64
 
	mnum_by‹s
;

910 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


911 
u8
 
	m¡»am_id
;

912 
u8
 
	mrx_wšdow_sÿË
;

914 
Ãtdev_vif
 *
	mndev_vif
;

917 
	s¦si_tı_ack_¡©s
 {

918 
u32
 
	mck_acks
;

919 
u32
 
	mck_suµ»s£d
;

920 
u32
 
	mck_£Á
;

921 
u32
 
	mck_max
;

922 
u32
 
	mck_timeout
;

923 
u32
 
	mck_dacks
;

924 
u32
 
	mck_§cks
;

925 
u32
 
	mck_d–ay_acks
;

926 
u32
 
	mck_low_wšdow
;

927 
u32
 
	mck_noÿche
;

928 
u32
 
	mck_nÜecÜd
;

929 
u32
 
	mck_hasd©a
;

930 
u32
 
	mck_psh
;

931 
u32
 
	mck_drİ³d
;

932 
u32
 
	mck_ktime
;

933 
u32
 
	mck_Ï¡»cÜd
;

934 
u32
 
	mck_£¬ch»cÜd
;

935 
u32
 
	mck_eû
;

938 
	#SLSI_NETIF_SET_TID_OFF
 0

	)

939 
	#SLSI_NETIF_SET_TID_ALL_UDP
 1

	)

941 
	s¦si_Ãtif_£t_tid_©Œ
 {

942 
u8
 
	mmode
;

943 
u32
 
	muid
;

944 
u8
 
	mtid
;

947 
	sÃtdev_vif
 {

948 
¦si_dev
 *
	msdev
;

949 
wœ–ess_dev
 
	mwdev
;

950 
©omic_t
 
	mis_»gi¡”ed
;

951 
boŞ
 
	mis_avaabË
;

952 
boŞ
 
	mis_fw_‹¡
;

953 #ià
defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

954 
boŞ
 
	mis_ws_ruÂšg
;

960 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


961 
¦si_mu‹x
 
	mvif_mu‹x
;

964 
mu‹x
 
	mvif_mu‹x
;

966 
¦si_sig_£nd
 
	msig_wa™
;

967 #iâdeà
CONFIG_SCSC_WLAN_RX_NAPI


968 
¦si_skb_wÜk
 
	mrx_d©a
;

970 
¦si_skb_wÜk
 
	mrx_mlme
;

971 
u16
 
	miâum
;

972 
Æ80211_iáy³
 
	miáy³
;

973 
›“80211_chªÃl
 *
	mchª
;

974 
u16
 
	mdriv”_chªÃl
;

975 
boŞ
 
	mdrv_š_p2p_´oûdu»
;

976 
cfg80211_chª_def
 *
	mchªdef
;

977 
cfg80211_chª_def
 
	mchªdef_§ved
;

983 
__be32
 
	madd»ss
;

985 #ià
IS_ENABLED
(
CONFIG_IPV6
)

986 
š6_addr
 
	mv6add»ss
;

987 
¦si_¥šlock
 
	mv6addr_lock
;

989 
Ãt_deviû_¡©s
 
	m¡©s
;

990 
u32
 
	mrx_·ck‘s
[
SLSI_LLS_AC_MAX
];

991 
u32
 
	mtx_·ck‘s
[
SLSI_LLS_AC_MAX
];

992 
u32
 
	mtx_no_ack
[
SLSI_LLS_AC_MAX
];

993 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


994 
¦si_mu‹x
 
	msÿn_mu‹x
;

995 
¦si_mu‹x
 
	msÿn_»suÉ_mu‹x
;

998 
mu‹x
 
	msÿn_mu‹x
;

999 
mu‹x
 
	msÿn_»suÉ_mu‹x
;

1002 
¦si_sÿn
 
	msÿn
[
SLSI_SCAN_MAX
];

1004 
¦si_¤c_sšk_·¿ms
 
	m¤c_sšk_·¿ms
;

1005 
u16
 
	mpow”_mode
;

1006 
u16
 
	m£t_pow”_mode
;

1008 
boŞ
 
	maùiv©ed
;

1009 
u16
 
	mvif_ty³
;

1010 
¦si_¥šlock
 
	m³”_lock
;

1011 
	m³”_¡a_»cÜds
;

1012 
¦si_³”
 *
	m³”_¡a_»cÜd
[
SLSI_ADHOC_PEER_CONNECTIONS_MAX
];

1019 
	mcfg80211_sšfo_g’”©iÚ
;

1022 
¦si_¥šlock
 
	mba_lock
;

1023 
sk_buff_h—d
 
	mba_com¶‘e
;

1024 
©omic_t
 
	mba_æush
;

1026 
u64
 
	mmgmt_tx_cook›
;

1027 
¦si_vif_mgmt_tx
 
	mmgmt_tx_d©a
;

1028 
d–ayed_wÜk
 
	msÿn_timeout_wÜk
;

1029 
d–ayed_wÜk
 
	mbÏckli¡_d–_wÜk
;

1030 
boŞ
 
	md–‘e_´obe_»q_›s
;

1034 
u8
 *
	m´obe_»q_›s
;

1035 
size_t
 
	m´obe_»q_›_Ën
;

1037 
¦si_vif_unsync
 
	munsync
;

1038 
¦si_vif_¡a
 
	m¡a
;

1039 
¦si_vif_­
 
	m­
;

1040 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1041 
¦si_vif_Çn
 
	mÇn
;

1043 
boŞ
 
	mmgmt_tx_gas_äame
;

1044 
u8
 
	mgas_äame_mac_addr
[
ETH_ALEN
];

1045 
boŞ
 
	macs
;

1047 
¦si_¥šlock
 
	mtı_ack_lock
;

1048 
¦si_tı_ack_s
 *
	mÏ¡_tı_ack
;

1049 
¦si_tı_ack_s
 
	mack_suµ»ssiÚ
[
TCP_ACK_SUPPRESSION_RECORDS_MAX
];

1050 
¦si_tı_ack_¡©s
 
	mtı_ack_¡©s
;

1052 
ktime_t
 
	mÏ¡_tim”_time
;

1053 
u32
 
	m»pÜt_time
;

1054 
u32
 
	mnum_by‹s_tx_³r_tim”
;

1055 
u32
 
	mnum_by‹s_rx_³r_tim”
;

1056 
u32
 
	mnum_by‹s_tx_³r_£c
;

1057 
u32
 
	mnum_by‹s_rx_³r_£c
;

1058 
u32
 
	mthroughput_tx
;

1059 
u32
 
	mthroughput_rx
;

1060 
u32
 
	mthroughput_tx_bps
;

1061 
u32
 
	mthroughput_rx_bps
;

1062 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


1063 
boŞ
 
	m’hªûd_¬p_d‘eù_’abËd
;

1064 
¦si_’hªûd_¬p_couÁ”s
 
	m’hªûd_¬p_¡©s
;

1065 
u8
 
	mrg‘__addr
[4];

1066 
	m’hªûd_¬p_ho¡_g
[
SLSI_MAX_ARP_SEND_FRAME
];

1068 
cfg80211_­_£‰šgs
 
	mbackup_£‰šgs
;

1069 #ifdeà
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL


1070 
©omic_t
 
	m¬p_tx_couÁ
;

1072 
wÜk_¡ruù
 
	msched_sÿn_¡İ_wk
;

1073 
u8
 
	mŒaffic_mÚ_¡©e
;

1074 
wÜk_¡ruù
 
	mŒaffic_mÚ_wÜk
;

1075 
wÜk_¡ruù
 
	m£t_muÉiÿ¡_f‹r_wÜk
;

1076 
¦si_Ãtif_£t_tid_©Œ
 
	m£t_tid_©Œ
;

1077 
wÜk_¡ruù
 
	mupd©e_pkt_f‹r_wÜk
;

1078 
boŞ
 
	mis_İt_out_·ck‘
;

1079 
cfg80211_aş_d©a
 *
	maş_d©a_suµliÿÁ
;

1080 
cfg80211_aş_d©a
 *
	maş_d©a_h®
;

1081 
li¡_h—d
 
	maş_d©a_fw_li¡
;

1082 
li¡_h—d
 
	maş_d©a_ioùl_li¡
;

1085 
	s¦si_802_11d_»g_domaš
 {

1086 
u8
 *
	mcouÁryli¡
;

1087 
›“80211_»gdomaš
 *
	m»gdomaš
;

1088 
	mcouÁry_Ën
;

1091 
	s¦si_­f_ÿ·b™›s
 {

1092 
u16
 
	mv”siÚ
;

1093 
u16
 
	mmax_Ëngth
;

1096 
	s¦si_ioùl_¬gs
 {

1097 
	m¬g_couÁ
;

1098 
u8
 *
	m¬gs
[];

1101 
	s¦si_rßm_sÿn_chªÃls
 {

1102 
	mn
;

1103 
u8
 
	mchªÃls
[
SLSI_MAX_CHANNEL_LIST
];

1106 
	e¦si_sub6_¡©e
 {

1107 
	mSUB6_SAR_1
 = 1,

1108 
	mSUB6_SAR_2
,

1109 
	mSUB6_SAR_3
,

1110 
	mSUB6_SAR_4
,

1111 
	mSUB6_SAR_5
,

1112 
	mSUB6_SAR_6
,

1115 
	s¦si_dev_cÚfig
 {

1119 
	#SLSI_FREQ_BAND_AUTO
 0

	)

1120 
	#SLSI_FREQ_BAND_5GHZ
 1

	)

1121 
	#SLSI_FREQ_BAND_2GHZ
 2

	)

1122 
	msuµÜ‹d_bªd
;

1124 
›“80211_suµÜ‹d_bªd
 *
	mbªd_5G
;

1125 
›“80211_suµÜ‹d_bªd
 *
	mbªd_2G
;

1132 
	mu£r_su¥’d_mode
;

1138 
	mrx_f‹r_num
;

1143 
boŞ
 
	mrx_f‹r_ruË_¡¬‹d
;

1146 
	#SLSI_NO_OF_SCAN_CHANLS_FOR_AUTO_CHAN_MAX
 14

	)

1147 
	m­_auto_chª
;

1150 
	mqos_šfo
;

1151 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1153 
	mokc_mode
;

1156 
	mwes_mode
;

1158 
	mrßm_sÿn_mode
;

1160 
	mdfs_sÿn_mode
;

1162 
	mncho_mode
;

1165 
¦si_rßm_sÿn_chªÃls
 
	mwes_rßm_sÿn_li¡
;

1167 
¦si_802_11d_»g_domaš
 
	mdomaš_šfo
;

1169 
¦si_rßm_sÿn_chªÃls
 
	mËgacy_rßm_sÿn_li¡
;

1171 
	m­_discÚÃù_šd_timeout
;

1173 
u16
 
	mho¡_¡©e
;

1174 
boŞ
 
	mho¡_¡©e_sub6_bªd
;

1176 
	mrssi_boo¡_5g
;

1177 
	mrssi_boo¡_2g
;

1178 
boŞ
 
	mdi§bË_ch12_ch13
;

1179 
boŞ
 
	mfw_’hªûd_¬p_d‘eù_suµÜ‹d
;

1180 
boŞ
 
	mfw_­f_suµÜ‹d
;

1181 
¦si_­f_ÿ·b™›s
 
	m­f_ÿp
;

1184 
	#SLSI_DEVICE_STATE_ATTACHING
 0

	)

1185 
	#SLSI_DEVICE_STATE_STOPPED
 1

	)

1186 
	#SLSI_DEVICE_STATE_STARTING
 2

	)

1187 
	#SLSI_DEVICE_STATE_STARTED
 3

	)

1188 
	#SLSI_DEVICE_STATE_STOPPING
 4

	)

1190 
	#SLSI_NET_INDEX_WLAN
 1

	)

1191 
	#SLSI_NET_INDEX_P2P
 2

	)

1192 
	#SLSI_NET_INDEX_P2PX_SWLAN
 3

	)

1193 
	#SLSI_NET_INDEX_NAN
 4

	)

1194 
	#SLSI_NET_INDEX_DETECT
 (
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1)

	)

1197 
	e¦si_p2p_¡©es
 {

1198 
	mP2P_IDLE_NO_VIF
,

1199 
	mP2P_IDLE_VIF_ACTIVE
,

1200 
	mP2P_SCANNING
,

1201 
	mP2P_LISTENING
,

1202 
	mP2P_ACTION_FRAME_TX_RX
,

1203 
	mP2P_GROUP_FORMED_CLI
,

1204 
	mP2P_GROUP_FORMED_GO
,

1212 
	e¦si_wÏn_¡©e
 {

1213 
	mWLAN_UNSYNC_NO_VIF
 = 0,

1214 
	mWLAN_UNSYNC_VIF_ACTIVE
,

1215 
	mWLAN_UNSYNC_VIF_TX


1219 
	#SLSI_WAKELOCK_TIME_MSEC_EAPOL
 (1000)

	)

1221 
	s¦si_ch_šfo_mib
 {

1222 
u16
 
	mch_v”siÚ
;

1225 
	s¦si_¶©_šfo_mib
 {

1226 
u16
 
	m¶©_bud
;

1230 
šlše
 *
	$¦si_p2p_¡©e_‹xt
(
u8
 
¡©e
)

1232 
¡©e
) {

1233 
P2P_IDLE_NO_VIF
:

1235 
P2P_IDLE_VIF_ACTIVE
:

1237 
P2P_SCANNING
:

1239 
P2P_LISTENING
:

1241 
P2P_ACTION_FRAME_TX_RX
:

1243 
P2P_GROUP_FORMED_CLI
:

1245 
P2P_GROUP_FORMED_GO
:

1250 
	}
}

1252 
	#SLSI_WLAN_MAX_HCF_PLATFORM_LEN
 (128)

	)

1254 
	s¦si_dev_mib_šfo
 {

1255 *
	mmib_fe_Çme
;

1256 
	mmib_hash
;

1259 
u8
 *
	mmib_d©a
;

1260 
u32
 
	mmib_Ën
;

1261 
	m¶©fÜm
[
SLSI_WLAN_MAX_HCF_PLATFORM_LEN
];

1264 
	#SLSI_WLAN_MAX_MIB_FILE
 2

	)

1266 #ià
IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

1267 
	s¦si_dev_mib_cŞËù_fe
 {

1268 
	mfe_Çme
[32];

1269 
u16
 
	mËn
;

1270 
u8
 *
	md©a
;

1271 } 
	g__·cked
;

1273 
	s¦si_dev_mib_cŞËù
 {

1274 
boŞ
 
	m’abËd
;

1276 
¥šlock_t
 
	mš_cŞËùiÚ
;

1277 
	mnum_fes
;

1279 
¦si_dev_mib_cŞËù_fe
 
	mfe
[
SLSI_WLAN_MAX_MIB_FILE
 + 1];

1284 
	ssys_”rÜ_log
 {

1285 
	mpos
;

1286 *
	mlog_buf
;

1287 
	mlog_buf_size
;

1288 
mu‹x
 
	mlog_buf_mu‹x
;

1291 
	s¦si_dev
 {

1293 
deviû
 *
	mdev
;

1294 
why
 *
	mwhy
;

1296 
¦si_h
 
	mh
;

1297 
¦si_h4
 
	mh4_š¡
;

1299 
scsc_wifi_cm_if
 
	mcm_if
;

1300 
scsc_mx
 *
	mmaxw–l_cÜe
;

1301 
scsc_£rviû_ş›Á
 
	mmx_wÏn_ş›Á
;

1302 
scsc_£rviû
 *
	m£rviû
;

1303 
¦si_ch_šfo_mib
 
	mch_šfo_mib
;

1304 
¦si_¶©_šfo_mib
 
	m¶©_šfo_mib
;

1305 
u16
 
	m»g_dom_v”siÚ
;

1307 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


1308 
¦si_mu‹x
 
	mÃtdev_add_»move_mu‹x
;

1311 
mu‹x
 
	mÃtdev_add_»move_mu‹x
;

1314 
mu‹x
 
	mÃtdev_»move_mu‹x
;

1315 
	mÃtdev_up_couÁ
;

1316 
Ãt_deviû
 
__rcu
 *
	mÃtdev
[
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1];

1317 
Ãt_deviû
 
__rcu
 *
	mÃtdev_­
;

1318 
Ãt_deviû
 
__rcu
 *
	mÃtdev_p2p
;

1319 
u8
 
	mÃtdev_add»s£s
[
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1][
ETH_ALEN
];

1320 
boŞ
 
	m»quœe_vif_d–‘e
[
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1];

1321 
	mdeviû_¡©e
;

1324 
u32
 
	magg_dev_throughput_tx
;

1325 
u32
 
	magg_dev_throughput_rx
;

1328 
©omic_t
 
	mš_·u£_¡©e
;

1329 
wÜk_¡ruù
 
	m»cov”y_wÜk_Ú_¡İ
;

1330 
wÜk_¡ruù
 
	m»cov”y_wÜk
;

1331 
wÜk_¡ruù
 
	m»cov”y_wÜk_Ú_¡¬t
;

1332 
wÜk_¡ruù
 
	mŒigg”_wÏn_ç_wÜk
;

1333 
wÜk_¡ruù
 
	msy¡em_”rÜ_u£r_ç_wÜk
;

1334 #ià
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

1335 
wÜk_¡ruù
 
	mch£t_loggšg_wÜk
;

1338 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


1339 
¦si_mu‹x
 
	m¡¬t_¡İ_mu‹x
;

1342 
mu‹x
 
	m¡¬t_¡İ_mu‹x
;

1345 
¦si_log_ş›Ás
 
	mlog_ş›Ás
;

1346 *
	muf_cdev
;

1349 
	m´ocfs_š¡ªû
;

1350 
´oc_dœ_’Œy
 *
	m´ocfs_dœ
;

1353 
u8
 
	mhw_addr
[
ETH_ALEN
];

1354 
¦si_dev_mib_šfo
 
	mmib
[
SLSI_WLAN_MAX_MIB_FILE
];

1355 
¦si_dev_mib_šfo
 
	mloÿl_mib
;

1356 #ià
IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

1357 
¦si_dev_mib_cŞËù
 
	mcŞËù_mib
;

1359 *
	mmaddr_fe_Çme
;

1360 
boŞ
 *
	m‹rm_udi_u£rs
;

1361 *
	msig_wa™_cfm_timeout
;

1363 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


1364 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 4, 0))

1365 
scsc_wake_lock
 
	mwÏn_wl
;

1366 
scsc_wake_lock
 
	mwÏn_wl_mlme
;

1367 
scsc_wake_lock
 
	mwÏn_wl_ma
;

1368 
scsc_wake_lock
 
	mwÏn_wl_rßm
;

1369 
scsc_wake_lock
 
	mwÏn_wl_š™
;

1371 
wake_lock
 
	mwÏn_wl
;

1372 
wake_lock
 
	mwÏn_wl_mlme
;

1373 
wake_lock
 
	mwÏn_wl_ma
;

1374 
wake_lock
 
	mwÏn_wl_rßm
;

1375 
wake_lock
 
	mwÏn_wl_š™
;

1378 
¦si_sig_£nd
 
	msig_wa™
;

1379 
¦si_skb_wÜk
 
	mrx_dbg_§p
;

1380 
©omic_t
 
	mtx_ho¡_g
[
SLSI_LLS_AC_MAX
];

1381 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


1382 
¦si_mu‹x
 
	mdeviû_cÚfig_mu‹x
;

1385 
mu‹x
 
	mdeviû_cÚfig_mu‹x
;

1387 
¦si_dev_cÚfig
 
	mdeviû_cÚfig
;

1389 
nÙif›r_block
 
	mš‘addr_nÙif›r
;

1390 #ià
IS_ENABLED
(
CONFIG_IPV6
)

1391 
nÙif›r_block
 
	mš‘6addr_nÙif›r
;

1394 
wÜkqueue_¡ruù
 *
	mdeviû_wq
;

1395 
¦si_p2p_¡©es
 
	mp2p_¡©e
;

1397 
¦si_wÏn_¡©e
 
	mwÏn_unsync_vif_¡©e
;

1399 
	mcu¼’t_t¥ec_id
;

1400 
	mt¥ec_”rÜ_code
;

1401 
u8
 
	mp2p_group_exp_äame
;

1402 
boŞ
 
	mš™Ÿl_sÿn
;

1404 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


1405 
¦si_gsÿn
 *
	mgsÿn
;

1406 
¦si_gsÿn_»suÉ
 *
	mgsÿn_hash_bË
[
SLSI_GSCAN_HASH_TABLE_SIZE
];

1407 
	mnum_gsÿn_»suÉs
;

1408 
	mbufãr_th»shŞd
;

1409 
	mbufãr_cÚsumed
;

1410 
¦si_buck‘
 
	mbuck‘
[
SLSI_GSCAN_MAX_BUCKETS
];

1411 
li¡_h—d
 
	mhÙli¡_»suÉs
;

1412 
boŞ
 
	m•no_aùive
;

1414 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


1415 
u8
 
	msÿn_mac_addr
[6];

1416 
boŞ
 
	msÿn_addr_£t
;

1418 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1419 
	mmšÜ_´of
;

1421 
¦si_ba_£ssiÚ_rx
 
	mrx_ba_bufãr_poŞ
[
SLSI_MAX_RX_BA_SESSIONS
];

1422 
¦si_¥šlock
 
	mrx_ba_bufãr_poŞ_lock
;

1423 
boŞ
 
	mç_»pÜ‹d
;

1424 
boŞ
 
	mp2p_û¹if
;

1425 
boŞ
 
	mmlme_blocked
;

1426 
©omic_t
 
	mdebug_šds
;

1427 
	m»cov”y_Ãxt_¡©e
;

1428 
com¶‘iÚ
 
	m»cov”y_»move_com¶‘iÚ
;

1429 
com¶‘iÚ
 
	m»cov”y_¡İ_com¶‘iÚ
;

1430 
com¶‘iÚ
 
	m»cov”y_com¶‘ed
;

1431 
com¶‘iÚ
 
	m£rviû_ç_¡¬‹d_šdiÿtiÚ
;

1432 
com¶‘iÚ
 
	m»cov”y_ç_§ã_com¶‘e
;

1433 
	m»cov”y_¡©us
;

1434 
boŞ
 
	m»cov”y_ç_§ã
;

1435 
¦si_ssid_m­
 
	mssid_m­
[
SLSI_SCAN_SSID_MAP_MAX
];

1436 
boŞ
 
	mbªd_5g_suµÜ‹d
;

1437 
	msuµÜ‹d_2g_chªÃls
[14];

1438 
	msuµÜ‹d_5g_chªÃls
[25];

1439 
	m’abËd_chªÃl_couÁ
;

1440 
boŞ
 
	mfw_ht_’abËd
;

1441 
u8
 
	mfw_ht_ÿp
[4];

1442 
boŞ
 
	mfw_vht_’abËd
;

1443 
u8
 
	mfw_vht_ÿp
[4];

1444 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


1445 
u8
 
	mwifi_sh¬šg_5ghz_chªÃl
[8];

1446 
	mv®id_5g_chª
[25];

1447 
	mwifi_sh¬šg_5g_»¡riùed_chªÃls
[25];

1448 
	mnum_5g_»¡riùed_chªÃls
;

1450 
boŞ
 
	mfw_SoáAp_2g_40mhz_’abËd
;

1451 
boŞ
 
	mÇn_’abËd
;

1452 
u16
 
	massoc_»suÉ_code
;

1453 
boŞ
 
	m®low_sw™ch_40_mhz
;

1454 
boŞ
 
	m®low_sw™ch_80_mhz
;

1455 #ifdeà
CONFIG_SCSC_WLAN_AP_INFO_FILE


1457 
boŞ
 
	mdu®bªd_cÚcu¼’cy
;

1458 
u32
 
	msoá­_max_ş›Á
;

1460 
u32
 
	mfw_dw–l_time
;

1461 
	mÎs_num_¿dio
;

1463 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


1464 
¦si_mu‹x
 
	mlogg”_mu‹x
;

1467 
mu‹x
 
	mlogg”_mu‹x
;

1469 
¦si_Œaffic_mÚ_ş›Ás
 
	mŒaffic_mÚ_ş›Ás
;

1471 
¦si_¹t_id_·¿ms
 *
	m¹t_id_·¿ms
[
SLSI_MAX_RTT_ID
];

1472 
boŞ
 
	macs_chªÃl_sw™ched
;

1473 
	m»cov”y_timeout
;

1474 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


1475 
boŞ
 
	mfw_mac_¿ndomiz©iÚ_’abËd
;

1478 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


1479 
boŞ
 
	m’hªûd_pkt_f‹r_’abËd
;

1481 
»g_d©aba£
 
	m»gdb
;

1482 
u8
 
	mfÜûd_bªdwidth
;

1483 
boŞ
 
	m»quœe_£rviû_şo£
;

1484 
boŞ
 
	mmac_chªged
;

1485 #ifdeà
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL


1486 
©omic_t
 
	mù¾_·u£_¡©e
;

1487 
u16
 
	mfw_max_¬p_couÁ
;

1488 
©omic_t
 
	m¬p_tx_couÁ
;

1490 
u8
 
	mfw_ext_ÿp_›
[9];

1491 
u32
 
	mfw_ext_ÿp_›_Ën
;

1492 
¦si_¥šlock
 
	mÃtdev_lock
;

1493 
	mhome_time
;

1494 
	mhome_away_time
;

1495 
	mmax_chªÃl_time
;

1496 
	mmax_chªÃl_·ssive_time
;

1497 
	mwÏn_£rviû_Ú
;

1498 
¦si_wÏn_driv”_wake_»asÚ_út
 
	mwake_»asÚ_¡©s
;

1499 
¦si_¥šlock
 
	mwake_¡©s_lock
;

1500 
u8
 
	mÏ‹ncy_·¿m_mask
;

1501 
boŞ
 
	md‘eù_vif_aùive
;

1502 
boŞ
 
	mmax_dtim_»cv
;

1503 #iâdeà
SCSC_SEP_VERSION


1504 
boŞ
 
	mfÜûd_£_7
;

1506 
boŞ
 
	migmp_ofæßd_aùiv©ed
;

1507 
	mdeçuÉ_sÿn_›s_Ën
;

1508 
u8
 *
	mdeçuÉ_sÿn_›s
;

1509 
sys_”rÜ_log
 
	msys_”rÜ_log_buf
;

1517 
	s¦si_rßmšg_ÃtwÜk_m­_’Œy
 {

1518 
li¡_h—d
 
	mli¡
;

1519 
	mÏ¡_£’_jiff›s
;

1520 
cfg80211_ssid
 
	mssid
;

1521 
u8
 
	mš™Ÿl_bssid
[
ETH_ALEN
];

1522 
boŞ
 
	mÚly_Úe_­_£’
;

1523 
u16
 
	mchªÃls_24_ghz
;

1529 
u32
 
	mchªÃls_5_ghz
;

1530 
	mchªÃl_jiff›s
[39];

1533 
	#LLC_SNAP_HDR_LEN
 8

	)

1534 
	sÎc_¢­_hdr
 {

1535 
u8
 
	mÎc_d§p
;

1536 
u8
 
	mÎc_s§p
;

1537 
u8
 
	mÎc_ù¾
;

1538 
u8
 
	m¢­_oui
[3];

1539 
u16
 
	m¢­_ty³
;

1540 } 
	g__·cked
;

1542 
¦si_rx_d©a_d–iv”_skb
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
boŞ
 
ùx_Çpi
);

1543 
¦si_rx_dbg_§p_wÜk
(
wÜk_¡ruù
 *
wÜk
);

1544 
¦si_rx_Ãtdev_d©a_wÜk
(
wÜk_¡ruù
 *
wÜk
);

1545 
¦si_rx_Ãtdev_mlme_wÜk
(
wÜk_¡ruù
 *
wÜk
);

1546 
¦si_rx_’queue_Ãtdev_mlme
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
, 
u16
 
vif
);

1547 
›“80211_chªÃl
 *
¦si_rx_sÿn_·ss_to_cfg80211
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1548 
¦si_rx_bufã»d_äames
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
);

1549 
¦si_rx_blockšg_sigÇls
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
);

1550 
¦si_sÿn_com¶‘e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
sÿn_id
, 
boŞ
 
abÜ‹d
,

1551 
boŞ
 
æush_sÿn_»suÉs
);

1552 
¦si_tx_·u£_queues
(
¦si_dev
 *
sdev
);

1553 
¦si_tx_uÅau£_queues
(
¦si_dev
 *
sdev
);

1554 
¦si_tx_cÚŒŞ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1555 
¦si_tx_d©a
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1556 
¦si_tx_d©a_low”
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
);

1557 
boŞ
 
¦si_is_‹¡_mode_’abËd
();

1558 
boŞ
 
¦si_is_rf_‹¡_mode_’abËd
();

1559 
¦si_š™_Ãtdev_mac_addr
(
¦si_dev
 *
sdev
);

1560 
boŞ
 
¦si_dev_Îs_suµÜ‹d
();

1561 
boŞ
 
¦si_dev_gsÿn_suµÜ‹d
();

1562 
boŞ
 
¦si_dev_•no_suµÜ‹d
();

1563 
boŞ
 
¦si_dev_vo_vi_block_ack
();

1564 
¦si_dev_g‘_sÿn_»suÉ_couÁ
();

1565 
boŞ
 
¦si_dev_Î¦ogs_suµÜ‹d
();

1566 
¦si_dev_Çn_suµÜ‹d
(
¦si_dev
 *
sdev
);

1567 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1568 
boŞ
 
¦si_dev_Çn_is_v6_lšk_v_šşude
();

1569 
¦si_g‘_Çn_max_ndp_š¡ªûs
();

1570 
¦si_g‘_Çn_max_ndi_içûs
();

1571 
¦si_g‘_Çn_ndp_d–ay
();

1572 
¦si_g‘_Çn_ndp_max_time
();

1573 
boŞ
 
¦si_g‘_Çn_mac_¿ndom
();

1575 
boŞ
 
¦si_g‘_Ëgacy_§r_backoff
();

1576 
¦si_sched_sÿn_¡İ³d
(
wÜk_¡ruù
 *
wÜk
);

1577 
boŞ
 
¦si_dev_¹t_suµÜ‹d
();

1578 
¦si_dev
 *
¦si_g‘_sdev
();

1579 
¦si_dump_sy¡em_”rÜ_bufãr
(
¦si_dev
 *
sdev
);

1580 
¦si_add_log_to_sy¡em_”rÜ_bufãr
(
¦si_dev
 *
sdev
, *
šput_bufãr
);

1582 
šlše
 
u16
 
	$¦si_tx_ho¡_g
(
¦si_dev
 *
sdev
, 
¦si_Œaffic_q
 
tq
)

1584 
u16
 
ho¡_g
 = 0;

1592 
ho¡_g
 = (
u16
)
	`©omic_add_»tuº
(4, &
sdev
->
tx_ho¡_g
[
tq
]);

1593 
ho¡_g
 &ğ~
SLSI_HOST_TAG_ARP_MASK
;

1595  
ho¡_g
;

1596 
	}
}

1598 
šlše
 
u16
 
	$¦si_tx_mgmt_ho¡_g
(
¦si_dev
 *
sdev
)

1601  
	`¦si_tx_ho¡_g
(
sdev
, 0);

1602 
	}
}

1604 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1605 
šlše
 
Ãt_deviû
 *
	$¦si_Çn_g‘_Ãtdev_rcu
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

1607 
u8
 
bÿ¡_addr
[
ETH_ALEN
] = {0xff, 0xff, 0xff, 0xff, 0xff, 0xff};

1608 
u8
 *
¤c_addr
 = 
NULL
;

1609 
u8
 *
de¡_addr
 = 
NULL
;

1610 
u8
 
idx
 = 0;

1612 
	`WARN_ON
(!
	`rcu_»ad_lock_h–d
());

1614 
	`çpi_g‘_sigid
(
skb
)) {

1615 
MA_BLOCKACK_IND
:

1617 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
ma_blockack_šd
.
»asÚ_code
è=ğ
FAPI_REASONCODE_UNSPECIFIED_REASON
) {

1618 
›“80211_b¬
 *
b¬
 = (
	`çpi_g‘_d©®’
(
skb
)è? (›“80211_b¬ *)
	`çpi_g‘_d©a
(skbè: 
NULL
;

1620 ià(!
b¬
)

1621  
NULL
;

1622 
de¡_addr
 = 
b¬
->
¿
;

1624 
›“80211_mgmt
 *
mgmt
 = (
	`çpi_g‘_mgm’
(
skb
)è? 
	`çpi_g‘_mgmt
(skbè: 
NULL
;

1626 ià(!
mgmt
) {

1627 
de¡_addr
 = 
bÿ¡_addr
;

1628 
¤c_addr
 = 
	`çpi_g‘_buff
(
skb
, 
u
.
ma_blockack_šd
.
³”_q¡a_add»ss
);

1630 
de¡_addr
 = 
mgmt
->
da
;

1635 
MA_UNITDATA_IND
:

1637 
‘hhdr
 *
‘h_hdr
 = (‘hhd¸*)
	`çpi_g‘_d©a
(
skb
);

1638 
u32
 
d©a_Ën
 = 
	`çpi_g‘_d©®’
(
skb
);

1640 ià(!
‘h_hdr
 || 
d©a_Ën
 < (*eth_hdr)) {

1641 
	`WARN
(1, "šv®id†’:%d\n", 
d©a_Ën
);

1642  
NULL
;

1645 
¤c_addr
 = 
‘h_hdr
->
h_sourû
;

1646 
de¡_addr
 = 
‘h_hdr
->
h_de¡
;

1650 
	`WARN
(1, "UnhªdËd sigÇl: 0x%.4x\n", 
	`çpi_g‘_sigid
(
skb
));

1651  
NULL
;

1654 
idx
 = 
SLSI_NAN_DATA_IFINDEX_START
; idx <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; idx++) {

1655 
Ãtdev_vif
 *
ndev_vif
;

1656 
u8
 
i
 = 0;

1658 ià(
sdev
->
Ãtdev
[
idx
]) {

1668 ià(
de¡_addr
 && 
	`is_muÉiÿ¡_‘h”_addr
(dest_addr)) {

1669 
ndev_vif
 = (
Ãtdev_vif
 *)
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
idx
]);

1670 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

1671 
i
 = 0; i < 
SLSI_PEER_INDEX_MAX
; i++) {

1672 ià(
ndev_vif
->
³”_¡a_»cÜd
[
i
] &&

1673 
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
v®id
 &&

1674 
¤c_addr
 &&

1675 
	`‘h”_addr_equ®
(
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
add»ss
, 
¤c_addr
)) {

1676 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

1677  
	`rcu_d”eã»nû
(
sdev
->
Ãtdev
[
idx
]);

1680 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

1681 } ià(
de¡_addr
 && 
	`‘h”_addr_equ®
(de¡_addr, 
sdev
->
Ãtdev
[
idx
]->
dev_addr
)) {

1682  
	`rcu_d”eã»nû
(
sdev
->
Ãtdev
[
idx
]);

1686  
NULL
;

1687 
	}
}

1690 
šlše
 
Ãt_deviû
 *
	$¦si_g‘_Ãtdev_rcu
(
¦si_dev
 *
sdev
, 
u16
 
iâum
)

1692 
	`WARN_ON
(!
	`rcu_»ad_lock_h–d
());

1693 ià(
iâum
 > 
CONFIG_SCSC_WLAN_MAX_INTERFACES
) {

1695  
NULL
;

1697  
	`rcu_d”eã»nû
(
sdev
->
Ãtdev
[
iâum
]);

1698 
	}
}

1700 
šlše
 
Ãt_deviû
 *
	$¦si_g‘_Ãtdev_locked
(
¦si_dev
 *
sdev
, 
u16
 
iâum
)

1702 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
sdev
->
Ãtdev_add_»move_mu‹x
));

1703 ià(
iâum
 > 
CONFIG_SCSC_WLAN_MAX_INTERFACES
) {

1704 
	`WARN
(1, "iâum:%d", 
iâum
);

1705  
NULL
;

1707  
sdev
->
Ãtdev
[
iâum
];

1708 
	}
}

1710 
šlše
 
Ãt_deviû
 *
	$¦si_g‘_Ãtdev
(
¦si_dev
 *
sdev
, 
u16
 
iâum
)

1712 
Ãt_deviû
 *
dev
;

1714 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1715 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
iâum
);

1716 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1718  
dev
;

1719 
	}
}

1721 
šlše
 
Ãt_deviû
 *
	$¦si_g‘_Ãtdev_by_mac_addr
(
¦si_dev
 *
sdev
, 
u8
 *
mac_addr
, 
¡¬t_idx
)

1723 
i
;

1725 ià(!
¡¬t_idx
)

1726 
¡¬t_idx
 = 1;

1727 
i
 = 
¡¬t_idx
; i < 
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1; i++) {

1728 ià(
sdev
->
Ãtdev
[
i
] && 
	`‘h”_addr_equ®
(
mac_addr
, sdev->Ãtdev[i]->
dev_addr
))

1729  
sdev
->
Ãtdev
[
i
];

1731  
NULL
;

1732 
	}
}

1734 
šlše
 
Ãt_deviû
 *
	$¦si_g‘_Ãtdev_by_mac_addr_locked
(
¦si_dev
 *
sdev
, 
u8
 *
mac_addr
, 
¡¬t_idx
)

1736 
Ãt_deviû
 *
dev
;

1738 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1739 
dev
 = 
	`¦si_g‘_Ãtdev_by_mac_addr
(
sdev
, 
mac_addr
, 
¡¬t_idx
);

1740 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1742  
dev
;

1743 
	}
}

1745 
šlše
 
Ãt_deviû
 *
	$¦si_g‘_Ãtdev_by_iâame_locked
(
¦si_dev
 *
sdev
, 
u8
 *
iâame
)

1747 
i
;

1749 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
sdev
->
Ãtdev_add_»move_mu‹x
));

1750 
i
 = 1; i < 
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1; i++) {

1751 ià(
sdev
->
Ãtdev
[
i
] && 
	`¡rcmp
(
iâame
, sdev->Ãtdev[i]->
Çme
) == 0)

1752  
sdev
->
Ãtdev
[
i
];

1754  
NULL
;

1755 
	}
}

1757 
šlše
 
Ãt_deviû
 *
	$¦si_g‘_Ãtdev_by_iâame
(
¦si_dev
 *
sdev
, 
u8
 *
iâame
)

1759 
Ãt_deviû
 *
dev
;

1761 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1762 
dev
 = 
	`¦si_g‘_Ãtdev_by_iâame_locked
(
sdev
, 
iâame
);

1763 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1765  
dev
;

1766 
	}
}

1768 
šlše
 
	$¦si_g‘_suµÜ‹d_mode
(cÚ¡ 
u8
 *
³”_›
)

1770 cÚ¡ 
u8
 *
³”_›_d©a
;

1771 
u8
 
³”_›_Ën
;

1772 
i
;

1773 
suµÜ‹d_¿‹
;

1775 
³”_›_Ën
 = 
³”_›
[1];

1776 
³”_›_d©a
 = &
³”_›
[2];

1777 
i
 = 0; i < 
³”_›_Ën
; i++) {

1778 
suµÜ‹d_¿‹
 = ((
³”_›_d©a
[
i
] & 0x7F) / 2);

1779 ià(
suµÜ‹d_¿‹
 > 11)

1780  
SLSI_80211_MODE_11G
;

1782  
SLSI_80211_MODE_11B
;

1783 
	}
}

1786 *
¦si_mib_fe
;

1787 *
¦si_mib_fe2
;

1789 #ifdeà
CONFIG_SCSC_WLAN_NW_PKT_DROP


1790 
by·ss_backlog
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

	@fapi.h

9 #iâdeà
_FAPI_H__


10 
	#_FAPI_H__


	)

12 #ifdeà
__ılu¥lus


16 
	#FAPI_SIG_TYPE_MASK
 0x0F00

	)

17 
	#FAPI_SIG_TYPE_REQ
 0x0000

	)

18 
	#FAPI_SIG_TYPE_CFM
 0x0100

	)

19 
	#FAPI_SIG_TYPE_RES
 0x0200

	)

20 
	#FAPI_SIG_TYPE_IND
 0x0300

	)

22 
	#FAPI_SAP_TYPE_MASK
 0xF000

	)

23 
	#FAPI_SAP_TYPE_MA
 0x1000

	)

24 
	#FAPI_SAP_TYPE_MLME
 0x2000

	)

25 
	#FAPI_SAP_TYPE_DEBUG
 0x8000

	)

26 
	#FAPI_SAP_TYPE_TEST
 0x9000

	)

28 
	#FAPI_DEBUG_SAP_ENG_VERSION
 0x0001

	)

29 
	#FAPI_DATA_SAP_ENG_VERSION
 0x0001

	)

30 
	#FAPI_CONTROL_SAP_ENG_VERSION
 0x000d

	)

31 
	#FAPI_TEST_SAP_ENG_VERSION
 0x0017

	)

32 
	#FAPI_DEBUG_SAP_VERSION
 0x0d03

	)

33 
	#FAPI_TEST_SAP_VERSION
 0x0e00

	)

34 
	#FAPI_DATA_SAP_VERSION
 0x0e01

	)

35 
	#FAPI_CONTROL_SAP_VERSION
 0x0e09

	)

37 
	#FAPI_ACLPOLICY_BLACKLIST
 0x0000

	)

38 
	#FAPI_ACLPOLICY_WHITELIST
 0x0001

	)

40 
	#FAPI_ACTION_STOP
 0x0000

	)

41 
	#FAPI_ACTION_START
 0x0001

	)

43 
	#FAPI_APFFILTERMODE_DISABLED
 0x0000

	)

44 
	#FAPI_APFFILTERMODE_SUSPEND
 0x0001

	)

45 
	#FAPI_APFFILTERMODE_ACTIVE
 0x0002

	)

47 
	#FAPI_AUTHENTICATIONTYPE_OPEN_SYSTEM
 0x0000

	)

48 
	#FAPI_AUTHENTICATIONTYPE_SHARED_KEY
 0x0001

	)

49 
	#FAPI_AUTHENTICATIONTYPE_SAE
 0x0003

	)

50 
	#FAPI_AUTHENTICATIONTYPE_LEAP
 0x0080

	)

52 
	#FAPI_BAND_AUTO
 0x0000

	)

53 
	#FAPI_BAND_5GHZ
 0x0001

	)

54 
	#FAPI_BAND_2_4GHZ
 0x0002

	)

56 
	#FAPI_BANDWIDTH_20_MHZ
 0x0

	)

57 
	#FAPI_BANDWIDTH_40_MHZ
 0x1

	)

58 
	#FAPI_BANDWIDTH_80_MHZ
 0x2

	)

59 
	#FAPI_BANDWIDTH_160_MHZ
 0x3

	)

61 
	#FAPI_BLOCKACKPOLICY_DELAYED_BLOCKACK
 0x0

	)

62 
	#FAPI_BLOCKACKPOLICY_IMMEDIATE_BLOCKACK
 0x1

	)

64 
	#FAPI_BULKDATADESCRIPTOR_INLINE
 0x0000

	)

65 
	#FAPI_BULKDATADESCRIPTOR_SMAPPER
 0x0001

	)

67 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_20MHZ
 0x00

	)

68 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_40MHZ
 0x01

	)

69 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_80MHZ
 0x02

	)

70 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_160MHZ
 0x03

	)

72 
	#FAPI_CONNECTIONTYPE_WLAN_INFRASTRUCTURE
 0x0000

	)

73 
	#FAPI_CONNECTIONTYPE_P2P_OPERATION
 0x0001

	)

74 
	#FAPI_CONNECTIONTYPE_NAN_FURTHER_SERVICE_SLOT
 0x0004

	)

75 
	#FAPI_CONNECTIONTYPE_WLAN_RANGING
 0x0005

	)

77 
	#FAPI_CWSTARTFLAGS_NONE
 0x0000

	)

78 
	#FAPI_CWSTARTFLAGS_SCAN_CHANNEL
 0x0001

	)

80 
	#FAPI_CWTYPE_SINE
 0x0000

	)

81 
	#FAPI_CWTYPE_RAMP
 0x0001

	)

82 
	#FAPI_CWTYPE_TWO_TONE
 0x0002

	)

83 
	#FAPI_CWTYPE_DC
 0x0003

	)

84 
	#FAPI_CWTYPE_PRN
 0x0004

	)

86 
	#FAPI_DATARATE_NONE
 0x0000

	)

87 
	#FAPI_DATARATE_11B20_1MBPS
 0x0001

	)

88 
	#FAPI_DATARATE_11B20_2MBPS
 0x0002

	)

89 
	#FAPI_DATARATE_11B20_5M5BPS
 0x0005

	)

90 
	#FAPI_DATARATE_11B20_11MBPS
 0x000b

	)

91 
	#FAPI_DATARATE_11A20_6MBPS
 0x2006

	)

92 
	#FAPI_DATARATE_11A20_9MBPS
 0x2009

	)

93 
	#FAPI_DATARATE_11A20_12MBPS
 0x200c

	)

94 
	#FAPI_DATARATE_11A20_18MBPS
 0x2012

	)

95 
	#FAPI_DATARATE_11A20_24MBPS
 0x2018

	)

96 
	#FAPI_DATARATE_11A20_36MBPS
 0x2024

	)

97 
	#FAPI_DATARATE_11A20_48MBPS
 0x2030

	)

98 
	#FAPI_DATARATE_11A20_54MBPS
 0x2036

	)

99 
	#FAPI_DATARATE_11N20_6M5BPS
 0x4000

	)

100 
	#FAPI_DATARATE_11N20_13MBPS
 0x4001

	)

101 
	#FAPI_DATARATE_11N20_19M5BPS
 0x4002

	)

102 
	#FAPI_DATARATE_11N20_26MBPS
 0x4003

	)

103 
	#FAPI_DATARATE_11N20_39MBPS
 0x4004

	)

104 
	#FAPI_DATARATE_11N20_52MBPS
 0x4005

	)

105 
	#FAPI_DATARATE_11N20_58M5BPS
 0x4006

	)

106 
	#FAPI_DATARATE_11N20_65MBPS
 0x4007

	)

107 
	#FAPI_DATARATE_11N20_7M2BPS_SGI
 0x4040

	)

108 
	#FAPI_DATARATE_11N20_14M4BPS_SGI
 0x4041

	)

109 
	#FAPI_DATARATE_11N20_21M7BPS_SGI
 0x4042

	)

110 
	#FAPI_DATARATE_11N20_28M9BPS_SGI
 0x4043

	)

111 
	#FAPI_DATARATE_11N20_43M3BPS_SGI
 0x4044

	)

112 
	#FAPI_DATARATE_11N20_57M8BPS_SGI
 0x4045

	)

113 
	#FAPI_DATARATE_11N20_65MBPS_SGI
 0x4046

	)

114 
	#FAPI_DATARATE_11N20_72M2BPS_SGI
 0x4047

	)

115 
	#FAPI_DATARATE_11N20_13MBPS_NSS2
 0x4088

	)

116 
	#FAPI_DATARATE_11N20_26MBPS_NSS2
 0x4089

	)

117 
	#FAPI_DATARATE_11N20_39MBPS_NSS2
 0x408a

	)

118 
	#FAPI_DATARATE_11N20_52MBPS_NSS2
 0x408b

	)

119 
	#FAPI_DATARATE_11N20_78MBPS_NSS2
 0x408c

	)

120 
	#FAPI_DATARATE_11N20_104MBPS_NSS2
 0x408d

	)

121 
	#FAPI_DATARATE_11N20_117MBPS_NSS2
 0x408e

	)

122 
	#FAPI_DATARATE_11N20_130MBPS_NSS2
 0x408f

	)

123 
	#FAPI_DATARATE_11N20_14M4BPS_SGI_NSS2
 0x40c8

	)

124 
	#FAPI_DATARATE_11N20_28M9BPS_SGI_NSS2
 0x40c9

	)

125 
	#FAPI_DATARATE_11N20_43M3BPS_SGI_NSS2
 0x40ÿ

	)

126 
	#FAPI_DATARATE_11N20_57M8BPS_SGI_NSS2
 0x40cb

	)

127 
	#FAPI_DATARATE_11N20_86M7BPS_SGI_NSS2
 0x40cc

	)

128 
	#FAPI_DATARATE_11N20_115M6BPS_SGI_NSS2
 0x40cd

	)

129 
	#FAPI_DATARATE_11N20_130MBPS_SGI_NSS2
 0x40û

	)

130 
	#FAPI_DATARATE_11N20_144M4BPS_SGI_NSS2
 0x40cf

	)

131 
	#FAPI_DATARATE_11N40_13M5BPS
 0x4400

	)

132 
	#FAPI_DATARATE_11N40_27MBPS
 0x4401

	)

133 
	#FAPI_DATARATE_11N40_40M5BPS
 0x4402

	)

134 
	#FAPI_DATARATE_11N40_54MBPS
 0x4403

	)

135 
	#FAPI_DATARATE_11N40_81MBPS
 0x4404

	)

136 
	#FAPI_DATARATE_11N40_108MBPS
 0x4405

	)

137 
	#FAPI_DATARATE_11N40_121M5BPS
 0x4406

	)

138 
	#FAPI_DATARATE_11N40_135MBPS
 0x4407

	)

139 
	#FAPI_DATARATE_11N40_6MBPS
 0x4420

	)

140 
	#FAPI_DATARATE_11N40_15MBPS_SGI
 0x4440

	)

141 
	#FAPI_DATARATE_11N40_30MBPS_SGI
 0x4441

	)

142 
	#FAPI_DATARATE_11N40_45MBPS_SGI
 0x4442

	)

143 
	#FAPI_DATARATE_11N40_60MBPS_SGI
 0x4443

	)

144 
	#FAPI_DATARATE_11N40_90MBPS_SGI
 0x4444

	)

145 
	#FAPI_DATARATE_11N40_120MBPS_SGI
 0x4445

	)

146 
	#FAPI_DATARATE_11N40_135MBPS_SGI
 0x4446

	)

147 
	#FAPI_DATARATE_11N40_150MBPS_SGI
 0x4447

	)

148 
	#FAPI_DATARATE_11N40_6M7BPS_SGI
 0x4460

	)

149 
	#FAPI_DATARATE_11N40_27MBPS_NSS2
 0x4488

	)

150 
	#FAPI_DATARATE_11N40_54MBPS_NSS2
 0x4489

	)

151 
	#FAPI_DATARATE_11N40_81MBPS_NSS2
 0x448a

	)

152 
	#FAPI_DATARATE_11N40_108MBPS_NSS2
 0x448b

	)

153 
	#FAPI_DATARATE_11N40_162MBPS_NSS2
 0x448c

	)

154 
	#FAPI_DATARATE_11N40_216MBPS_NSS2
 0x448d

	)

155 
	#FAPI_DATARATE_11N40_243MBPS_NSS2
 0x448e

	)

156 
	#FAPI_DATARATE_11N40_270MBPS_NSS2
 0x448f

	)

157 
	#FAPI_DATARATE_11N40_30MBPS_SGI_NSS2
 0x44c8

	)

158 
	#FAPI_DATARATE_11N40_60MBPS_SGI_NSS2
 0x44c9

	)

159 
	#FAPI_DATARATE_11N40_90MBPS_SGI_NSS2
 0x44ÿ

	)

160 
	#FAPI_DATARATE_11N40_120MBPS_SGI_NSS2
 0x44cb

	)

161 
	#FAPI_DATARATE_11N40_180MBPS_SGI_NSS2
 0x44cc

	)

162 
	#FAPI_DATARATE_11N40_240MBPS_SGI_NSS2
 0x44cd

	)

163 
	#FAPI_DATARATE_11N40_270MBPS_SGI_NSS2
 0x44û

	)

164 
	#FAPI_DATARATE_11N40_300MBPS_SGI_NSS2
 0x44cf

	)

165 
	#FAPI_DATARATE_11AC20_6M5BPS
 0x6000

	)

166 
	#FAPI_DATARATE_11AC20_13MBPS
 0x6001

	)

167 
	#FAPI_DATARATE_11AC20_19M5BPS
 0x6002

	)

168 
	#FAPI_DATARATE_11AC20_26MBPS
 0x6003

	)

169 
	#FAPI_DATARATE_11AC20_39MBPS
 0x6004

	)

170 
	#FAPI_DATARATE_11AC20_52MBPS
 0x6005

	)

171 
	#FAPI_DATARATE_11AC20_58M5BPS
 0x6006

	)

172 
	#FAPI_DATARATE_11AC20_65MBPS
 0x6007

	)

173 
	#FAPI_DATARATE_11AC20_78MBPS
 0x6008

	)

174 
	#FAPI_DATARATE_11AC20_97M5BPS
 0x600a

	)

175 
	#FAPI_DATARATE_11AC20_7M2BPS_SGI
 0x6040

	)

176 
	#FAPI_DATARATE_11AC20_14M4BPS_SGI
 0x6041

	)

177 
	#FAPI_DATARATE_11AC20_21M7BPS_SGI
 0x6042

	)

178 
	#FAPI_DATARATE_11AC20_28M9BPS_SGI
 0x6043

	)

179 
	#FAPI_DATARATE_11AC20_43M3BPS_SGI
 0x6044

	)

180 
	#FAPI_DATARATE_11AC20_57M8BPS_SGI
 0x6045

	)

181 
	#FAPI_DATARATE_11AC20_65MBPS_SGI
 0x6046

	)

182 
	#FAPI_DATARATE_11AC20_72M2BPS_SGI
 0x6047

	)

183 
	#FAPI_DATARATE_11AC20_86M7BPS_SGI
 0x6048

	)

184 
	#FAPI_DATARATE_11AC20_108M3BPS_SGI
 0x604a

	)

185 
	#FAPI_DATARATE_11AC20_13MBPS_NSS2
 0x6080

	)

186 
	#FAPI_DATARATE_11AC20_26MBPS_NSS2
 0x6081

	)

187 
	#FAPI_DATARATE_11AC20_39MBPS_NSS2
 0x6082

	)

188 
	#FAPI_DATARATE_11AC20_52MBPS_NSS2
 0x6083

	)

189 
	#FAPI_DATARATE_11AC20_78MBPS_NSS2
 0x6084

	)

190 
	#FAPI_DATARATE_11AC20_104MBPS_NSS2
 0x6085

	)

191 
	#FAPI_DATARATE_11AC20_117MBPS_NSS2
 0x6086

	)

192 
	#FAPI_DATARATE_11AC20_130MBPS_NSS2
 0x6087

	)

193 
	#FAPI_DATARATE_11AC20_156MBPS_NSS2
 0x6088

	)

194 
	#FAPI_DATARATE_11AC20_195MBPS_NSS2
 0x608a

	)

195 
	#FAPI_DATARATE_11AC20_14M4BPS_SGI_NSS2
 0x60c0

	)

196 
	#FAPI_DATARATE_11AC20_28M9BPS_SGI_NSS2
 0x60c1

	)

197 
	#FAPI_DATARATE_11AC20_43M3BPS_SGI_NSS2
 0x60c2

	)

198 
	#FAPI_DATARATE_11AC20_57M8BPS_SGI_NSS2
 0x60c3

	)

199 
	#FAPI_DATARATE_11AC20_86M7BPS_SGI_NSS2
 0x60c4

	)

200 
	#FAPI_DATARATE_11AC20_115M6BPS_SGI_NSS2
 0x60c5

	)

201 
	#FAPI_DATARATE_11AC20_130MBPS_SGI_NSS2
 0x60c6

	)

202 
	#FAPI_DATARATE_11AC20_144M4BPS_SGI_NSS2
 0x60c7

	)

203 
	#FAPI_DATARATE_11AC20_173M3BPS_SGI_NSS2
 0x60c8

	)

204 
	#FAPI_DATARATE_11AC20_216M7BPS_SGI_NSS2
 0x60ÿ

	)

205 
	#FAPI_DATARATE_11AC40_13M5BPS
 0x6400

	)

206 
	#FAPI_DATARATE_11AC40_27MBPS
 0x6401

	)

207 
	#FAPI_DATARATE_11AC40_40M5BPS
 0x6402

	)

208 
	#FAPI_DATARATE_11AC40_54MBPS
 0x6403

	)

209 
	#FAPI_DATARATE_11AC40_81MBPS
 0x6404

	)

210 
	#FAPI_DATARATE_11AC40_108MBPS
 0x6405

	)

211 
	#FAPI_DATARATE_11AC40_121M5BPS
 0x6406

	)

212 
	#FAPI_DATARATE_11AC40_135MBPS
 0x6407

	)

213 
	#FAPI_DATARATE_11AC40_162MBPS
 0x6408

	)

214 
	#FAPI_DATARATE_11AC40_180MBPS
 0x6409

	)

215 
	#FAPI_DATARATE_11AC40_202M5BPS
 0x640a

	)

216 
	#FAPI_DATARATE_11AC40_225MBPS
 0x640b

	)

217 
	#FAPI_DATARATE_11AC40_15MBPS_SGI
 0x6440

	)

218 
	#FAPI_DATARATE_11AC40_30MBPS_SGI
 0x6441

	)

219 
	#FAPI_DATARATE_11AC40_45MBPS_SGI
 0x6442

	)

220 
	#FAPI_DATARATE_11AC40_60MBPS_SGI
 0x6443

	)

221 
	#FAPI_DATARATE_11AC40_90MBPS_SGI
 0x6444

	)

222 
	#FAPI_DATARATE_11AC40_120MBPS_SGI
 0x6445

	)

223 
	#FAPI_DATARATE_11AC40_135MBPS_SGI
 0x6446

	)

224 
	#FAPI_DATARATE_11AC40_150MBPS_SGI
 0x6447

	)

225 
	#FAPI_DATARATE_11AC40_180MBPS_SGI
 0x6448

	)

226 
	#FAPI_DATARATE_11AC40_200MBPS_SGI
 0x6449

	)

227 
	#FAPI_DATARATE_11AC40_225MBPS_SGI
 0x644a

	)

228 
	#FAPI_DATARATE_11AC40_250MBPS_SGI
 0x644b

	)

229 
	#FAPI_DATARATE_11AC40_27MBPS_NSS2
 0x6480

	)

230 
	#FAPI_DATARATE_11AC40_54MBPS_NSS2
 0x6481

	)

231 
	#FAPI_DATARATE_11AC40_81MBPS_NSS2
 0x6482

	)

232 
	#FAPI_DATARATE_11AC40_108MBPS_NSS2
 0x6483

	)

233 
	#FAPI_DATARATE_11AC40_162MBPS_NSS2
 0x6484

	)

234 
	#FAPI_DATARATE_11AC40_216MBPS_NSS2
 0x6485

	)

235 
	#FAPI_DATARATE_11AC40_243MBPS_NSS2
 0x6486

	)

236 
	#FAPI_DATARATE_11AC40_270MBPS_NSS2
 0x6487

	)

237 
	#FAPI_DATARATE_11AC40_324MBPS_NSS2
 0x6488

	)

238 
	#FAPI_DATARATE_11AC40_360MBPS_NSS2
 0x6489

	)

239 
	#FAPI_DATARATE_11AC40_405MBPS_NSS2
 0x648a

	)

240 
	#FAPI_DATARATE_11AC40_450MBPS_NSS2
 0x648b

	)

241 
	#FAPI_DATARATE_11AC40_30MBPS_SGI_NSS2
 0x64c0

	)

242 
	#FAPI_DATARATE_11AC40_60MBPS_SGI_NSS2
 0x64c1

	)

243 
	#FAPI_DATARATE_11AC40_90MBPS_SGI_NSS2
 0x64c2

	)

244 
	#FAPI_DATARATE_11AC40_120MBPS_SGI_NSS2
 0x64c3

	)

245 
	#FAPI_DATARATE_11AC40_180MBPS_SGI_NSS2
 0x64c4

	)

246 
	#FAPI_DATARATE_11AC40_240MBPS_SGI_NSS2
 0x64c5

	)

247 
	#FAPI_DATARATE_11AC40_270MBPS_SGI_NSS2
 0x64c6

	)

248 
	#FAPI_DATARATE_11AC40_300MBPS_SGI_NSS2
 0x64c7

	)

249 
	#FAPI_DATARATE_11AC40_360MBPS_SGI_NSS2
 0x64c8

	)

250 
	#FAPI_DATARATE_11AC40_400MBPS_SGI_NSS2
 0x64c9

	)

251 
	#FAPI_DATARATE_11AC40_450MBPS_SGI_NSS2
 0x64ÿ

	)

252 
	#FAPI_DATARATE_11AC40_500MBPS_SGI_NSS2
 0x64cb

	)

253 
	#FAPI_DATARATE_11AC80_29M3BPS
 0x6800

	)

254 
	#FAPI_DATARATE_11AC80_58M5BPS
 0x6801

	)

255 
	#FAPI_DATARATE_11AC80_87M8BPS
 0x6802

	)

256 
	#FAPI_DATARATE_11AC80_117MBPS
 0x6803

	)

257 
	#FAPI_DATARATE_11AC80_175M5BPS
 0x6804

	)

258 
	#FAPI_DATARATE_11AC80_234MBPS
 0x6805

	)

259 
	#FAPI_DATARATE_11AC80_263M3BPS
 0x6806

	)

260 
	#FAPI_DATARATE_11AC80_292M5BPS
 0x6807

	)

261 
	#FAPI_DATARATE_11AC80_351MBPS
 0x6808

	)

262 
	#FAPI_DATARATE_11AC80_390MBPS
 0x6809

	)

263 
	#FAPI_DATARATE_11AC80_438M8BPS
 0x680a

	)

264 
	#FAPI_DATARATE_11AC80_487M5BPS
 0x680b

	)

265 
	#FAPI_DATARATE_11AC80_32M5BPS_SGI
 0x6840

	)

266 
	#FAPI_DATARATE_11AC80_65MBPS_SGI
 0x6841

	)

267 
	#FAPI_DATARATE_11AC80_97M5BPS_SGI
 0x6842

	)

268 
	#FAPI_DATARATE_11AC80_130MBPS_SGI
 0x6843

	)

269 
	#FAPI_DATARATE_11AC80_195MBPS_SGI
 0x6844

	)

270 
	#FAPI_DATARATE_11AC80_260MBPS_SGI
 0x6845

	)

271 
	#FAPI_DATARATE_11AC80_292M5BPS_SGI
 0x6846

	)

272 
	#FAPI_DATARATE_11AC80_325MBPS_SGI
 0x6847

	)

273 
	#FAPI_DATARATE_11AC80_390MBPS_SGI
 0x6848

	)

274 
	#FAPI_DATARATE_11AC80_433M3BPS_SGI
 0x6849

	)

275 
	#FAPI_DATARATE_11AC80_487M5BPS_SGI
 0x684a

	)

276 
	#FAPI_DATARATE_11AC80_541M7BPS_SGI
 0x684b

	)

277 
	#FAPI_DATARATE_11AC80_58M5BPS_NSS2
 0x6880

	)

278 
	#FAPI_DATARATE_11AC80_117MBPS_NSS2
 0x6881

	)

279 
	#FAPI_DATARATE_11AC80_175M5BPS_NSS2
 0x6882

	)

280 
	#FAPI_DATARATE_11AC80_234MBPS_NSS2
 0x6883

	)

281 
	#FAPI_DATARATE_11AC80_351MBPS_NSS2
 0x6884

	)

282 
	#FAPI_DATARATE_11AC80_468MBPS_NSS2
 0x6885

	)

283 
	#FAPI_DATARATE_11AC80_526M5BPS_NSS2
 0x6886

	)

284 
	#FAPI_DATARATE_11AC80_585MBPS_NSS2
 0x6887

	)

285 
	#FAPI_DATARATE_11AC80_702MBPS_NSS2
 0x6888

	)

286 
	#FAPI_DATARATE_11AC80_780MBPS_NSS2
 0x6889

	)

287 
	#FAPI_DATARATE_11AC80_877M5BPS_NSS2
 0x688a

	)

288 
	#FAPI_DATARATE_11AC80_975MBPS_NSS2
 0x688b

	)

289 
	#FAPI_DATARATE_11AC80_65MBPS_SGI_NSS2
 0x68c0

	)

290 
	#FAPI_DATARATE_11AC80_130MBPS_SGI_NSS2
 0x68c1

	)

291 
	#FAPI_DATARATE_11AC80_195MBPS_SGI_NSS2
 0x68c2

	)

292 
	#FAPI_DATARATE_11AC80_260MBPS_SGI_NSS2
 0x68c3

	)

293 
	#FAPI_DATARATE_11AC80_390MBPS_SGI_NSS2
 0x68c4

	)

294 
	#FAPI_DATARATE_11AC80_520MBPS_SGI_NSS2
 0x68c5

	)

295 
	#FAPI_DATARATE_11AC80_585MBPS_SGI_NSS2
 0x68c6

	)

296 
	#FAPI_DATARATE_11AC80_650MBPS_SGI_NSS2
 0x68c7

	)

297 
	#FAPI_DATARATE_11AC80_780MBPS_SGI_NSS2
 0x68c8

	)

298 
	#FAPI_DATARATE_11AC80_866M7BPS_SGI_NSS2
 0x68c9

	)

299 
	#FAPI_DATARATE_11AC80_975MBPS_SGI_NSS2
 0x68ÿ

	)

300 
	#FAPI_DATARATE_11AC80_1083M3BPS_SGI_NSS2
 0x68cb

	)

301 
	#FAPI_DATARATE_11AC160_58M5BPS
 0x6c00

	)

302 
	#FAPI_DATARATE_11AC160_117MBPS
 0x6c01

	)

303 
	#FAPI_DATARATE_11AC160_175M5BPS
 0x6c02

	)

304 
	#FAPI_DATARATE_11AC160_234MBPS
 0x6c03

	)

305 
	#FAPI_DATARATE_11AC160_351MBPS
 0x6c04

	)

306 
	#FAPI_DATARATE_11AC160_468MBPS
 0x6c05

	)

307 
	#FAPI_DATARATE_11AC160_526M5BPS
 0x6c06

	)

308 
	#FAPI_DATARATE_11AC160_585MBPS
 0x6c07

	)

309 
	#FAPI_DATARATE_11AC160_702MBPS
 0x6c08

	)

310 
	#FAPI_DATARATE_11AC160_780MBPS
 0x6c09

	)

311 
	#FAPI_DATARATE_11AC160_877M5BPS
 0x6c0a

	)

312 
	#FAPI_DATARATE_11AC160_975MBPS
 0x6c0b

	)

313 
	#FAPI_DATARATE_11AC160_65MBPS_SGI
 0x6c40

	)

314 
	#FAPI_DATARATE_11AC160_130MBPS_SGI
 0x6c41

	)

315 
	#FAPI_DATARATE_11AC160_195MBPS_SGI
 0x6c42

	)

316 
	#FAPI_DATARATE_11AC160_260MBPS_SGI
 0x6c43

	)

317 
	#FAPI_DATARATE_11AC160_390MBPS_SGI
 0x6c44

	)

318 
	#FAPI_DATARATE_11AC160_520MBPS_SGI
 0x6c45

	)

319 
	#FAPI_DATARATE_11AC160_585MBPS_SGI
 0x6c46

	)

320 
	#FAPI_DATARATE_11AC160_650MBPS_SGI
 0x6c47

	)

321 
	#FAPI_DATARATE_11AC160_780MBPS_SGI
 0x6c48

	)

322 
	#FAPI_DATARATE_11AC160_866M7BPS_SGI
 0x6c49

	)

323 
	#FAPI_DATARATE_11AC160_975MBPS_SGI
 0x6c4a

	)

324 
	#FAPI_DATARATE_11AC160_1083M3BPS_SGI
 0x6c4b

	)

325 
	#FAPI_DATARATE_11AC160_117MBPS_NSS2
 0x6c80

	)

326 
	#FAPI_DATARATE_11AC160_234MBPS_NSS2
 0x6c81

	)

327 
	#FAPI_DATARATE_11AC160_351MBPS_NSS2
 0x6c82

	)

328 
	#FAPI_DATARATE_11AC160_468MBPS_NSS2
 0x6c83

	)

329 
	#FAPI_DATARATE_11AC160_702MBPS_NSS2
 0x6c84

	)

330 
	#FAPI_DATARATE_11AC160_936MBPS_NSS2
 0x6c85

	)

331 
	#FAPI_DATARATE_11AC160_1053MBPS_NSS2
 0x6c86

	)

332 
	#FAPI_DATARATE_11AC160_1170MBPS_NSS2
 0x6c87

	)

333 
	#FAPI_DATARATE_11AC160_1404MBPS_NSS2
 0x6c88

	)

334 
	#FAPI_DATARATE_11AC160_1560MBPS_NSS2
 0x6c89

	)

335 
	#FAPI_DATARATE_11AC160_1755MBPS_NSS2
 0x6c8a

	)

336 
	#FAPI_DATARATE_11AC160_1950MBPS_NSS2
 0x6c8b

	)

337 
	#FAPI_DATARATE_11AC160_130MBPS_SGI_NSS2
 0x6cc0

	)

338 
	#FAPI_DATARATE_11AC160_260MBPS_SGI_NSS2
 0x6cc1

	)

339 
	#FAPI_DATARATE_11AC160_390MBPS_SGI_NSS2
 0x6cc2

	)

340 
	#FAPI_DATARATE_11AC160_520MBPS_SGI_NSS2
 0x6cc3

	)

341 
	#FAPI_DATARATE_11AC160_780MBPS_SGI_NSS2
 0x6cc4

	)

342 
	#FAPI_DATARATE_11AC160_1040MBPS_SGI_NSS2
 0x6cc5

	)

343 
	#FAPI_DATARATE_11AC160_1170MBPS_SGI_NSS2
 0x6cc6

	)

344 
	#FAPI_DATARATE_11AC160_1300MBPS_SGI_NSS2
 0x6cc7

	)

345 
	#FAPI_DATARATE_11AC160_1560MBPS_SGI_NSS2
 0x6cc8

	)

346 
	#FAPI_DATARATE_11AC160_1733M3BPS_SGI_NSS2
 0x6cc9

	)

347 
	#FAPI_DATARATE_11AC160_1950MBPS_SGI_NSS2
 0x6cÿ

	)

348 
	#FAPI_DATARATE_11AC160_2166M7BPS_SGI_NSS2
 0x6ccb

	)

349 
	#FAPI_DATARATE_11AX20_8M6BPS_1GI
 0x8000

	)

350 
	#FAPI_DATARATE_11AX20_17M2BPS_1GI
 0x8001

	)

351 
	#FAPI_DATARATE_11AX20_25M8BPS_1GI
 0x8002

	)

352 
	#FAPI_DATARATE_11AX20_34M4BPS_1GI
 0x8003

	)

353 
	#FAPI_DATARATE_11AX20_51M6BPS_1GI
 0x8004

	)

354 
	#FAPI_DATARATE_11AX20_68M8BPS_1GI
 0x8005

	)

355 
	#FAPI_DATARATE_11AX20_77M4BPS_1GI
 0x8006

	)

356 
	#FAPI_DATARATE_11AX20_86MBPS_1GI
 0x8007

	)

357 
	#FAPI_DATARATE_11AX20_103M2BPS_1GI
 0x8008

	)

358 
	#FAPI_DATARATE_11AX20_114M7BPS_1GI
 0x8009

	)

359 
	#FAPI_DATARATE_11AX20_129MBPS_1GI
 0x800a

	)

360 
	#FAPI_DATARATE_11AX20_143M4BPS_1GI
 0x800b

	)

361 
	#FAPI_DATARATE_11AX20_8M1BPS_2GI
 0x8010

	)

362 
	#FAPI_DATARATE_11AX20_16M3BPS_2GI
 0x8011

	)

363 
	#FAPI_DATARATE_11AX20_24M4BPS_2GI
 0x8012

	)

364 
	#FAPI_DATARATE_11AX20_32M5BPS_2GI
 0x8013

	)

365 
	#FAPI_DATARATE_11AX20_48M8BPS_2GI
 0x8014

	)

366 
	#FAPI_DATARATE_11AX20_65MBPS_2GI
 0x8015

	)

367 
	#FAPI_DATARATE_11AX20_73M1BPS_2GI
 0x8016

	)

368 
	#FAPI_DATARATE_11AX20_81M3BPS_2GI
 0x8017

	)

369 
	#FAPI_DATARATE_11AX20_97M5BPS_2GI
 0x8018

	)

370 
	#FAPI_DATARATE_11AX20_108M3BPS_2GI
 0x8019

	)

371 
	#FAPI_DATARATE_11AX20_121M9BPS_2GI
 0x801a

	)

372 
	#FAPI_DATARATE_11AX20_135M4BPS_2GI
 0x801b

	)

373 
	#FAPI_DATARATE_11AX20_7M3BPS_4GI
 0x8020

	)

374 
	#FAPI_DATARATE_11AX20_14M6BPS_4GI
 0x8021

	)

375 
	#FAPI_DATARATE_11AX20_21M9BPS_4GI
 0x8022

	)

376 
	#FAPI_DATARATE_11AX20_29M3BPS_4GI
 0x8023

	)

377 
	#FAPI_DATARATE_11AX20_43M9BPS_4GI
 0x8024

	)

378 
	#FAPI_DATARATE_11AX20_58M5BPS_4GI
 0x8025

	)

379 
	#FAPI_DATARATE_11AX20_65M8BPS_4GI
 0x8026

	)

380 
	#FAPI_DATARATE_11AX20_73M1BPS_4GI
 0x8027

	)

381 
	#FAPI_DATARATE_11AX20_87M8BPS_4GI
 0x8028

	)

382 
	#FAPI_DATARATE_11AX20_97M5BPS_4GI
 0x8029

	)

383 
	#FAPI_DATARATE_11AX20_109M7BPS_4GI
 0x802a

	)

384 
	#FAPI_DATARATE_11AX20_121M9BPS_4GI
 0x802b

	)

385 
	#FAPI_DATARATE_11AX20_4M3BPS_1GI_DCM
 0x8040

	)

386 
	#FAPI_DATARATE_11AX20_8M6BPS_1GI_DCM
 0x8041

	)

387 
	#FAPI_DATARATE_11AX20_17M2BPS_1GI_DCM
 0x8043

	)

388 
	#FAPI_DATARATE_11AX20_25M8BPS_1GI_DCM
 0x8044

	)

389 
	#FAPI_DATARATE_11AX20_4MBPS_2GI_DCM
 0x8050

	)

390 
	#FAPI_DATARATE_11AX20_8M1BPS_2GI_DCM
 0x8051

	)

391 
	#FAPI_DATARATE_11AX20_16M3BPS_2GI_DCM
 0x8053

	)

392 
	#FAPI_DATARATE_11AX20_24M4BPS_2GI_DCM
 0x8054

	)

393 
	#FAPI_DATARATE_11AX20_3M6BPS_4GI_DCM
 0x8060

	)

394 
	#FAPI_DATARATE_11AX20_7M3BPS_4GI_DCM
 0x8061

	)

395 
	#FAPI_DATARATE_11AX20_14M6BPS_4GI_DCM
 0x8063

	)

396 
	#FAPI_DATARATE_11AX20_21M9BPS_4GI_DCM
 0x8064

	)

397 
	#FAPI_DATARATE_11AX20_17M2BPS_1GI_NSS2
 0x8080

	)

398 
	#FAPI_DATARATE_11AX20_34M4BPS_1GI_NSS2
 0x8081

	)

399 
	#FAPI_DATARATE_11AX20_51M6BPS_1GI_NSS2
 0x8082

	)

400 
	#FAPI_DATARATE_11AX20_68M8BPS_1GI_NSS2
 0x8083

	)

401 
	#FAPI_DATARATE_11AX20_103M2BPS_1GI_NSS2
 0x8084

	)

402 
	#FAPI_DATARATE_11AX20_137M6BPS_1GI_NSS2
 0x8085

	)

403 
	#FAPI_DATARATE_11AX20_154M9BPS_1GI_NSS2
 0x8086

	)

404 
	#FAPI_DATARATE_11AX20_172M1BPS_1GI_NSS2
 0x8087

	)

405 
	#FAPI_DATARATE_11AX20_206M5BPS_1GI_NSS2
 0x8088

	)

406 
	#FAPI_DATARATE_11AX20_229M4BPS_1GI_NSS2
 0x8089

	)

407 
	#FAPI_DATARATE_11AX20_258M1BPS_1GI_NSS2
 0x808a

	)

408 
	#FAPI_DATARATE_11AX20_286M8BPS_1GI_NSS2
 0x808b

	)

409 
	#FAPI_DATARATE_11AX20_16M3BPS_2GI_NSS2
 0x8090

	)

410 
	#FAPI_DATARATE_11AX20_32M5BPS_2GI_NSS2
 0x8091

	)

411 
	#FAPI_DATARATE_11AX20_48M8BPS_2GI_NSS2
 0x8092

	)

412 
	#FAPI_DATARATE_11AX20_65MBPS_2GI_NSS2
 0x8093

	)

413 
	#FAPI_DATARATE_11AX20_97M5BPS_2GI_NSS2
 0x8094

	)

414 
	#FAPI_DATARATE_11AX20_130MBPS_2GI_NSS2
 0x8095

	)

415 
	#FAPI_DATARATE_11AX20_146M3BPS_2GI_NSS2
 0x8096

	)

416 
	#FAPI_DATARATE_11AX20_162M5BPS_2GI_NSS2
 0x8097

	)

417 
	#FAPI_DATARATE_11AX20_195MBPS_2GI_NSS2
 0x8098

	)

418 
	#FAPI_DATARATE_11AX20_216M7BPS_2GI_NSS2
 0x8099

	)

419 
	#FAPI_DATARATE_11AX20_243M8BPS_2GI_NSS2
 0x809a

	)

420 
	#FAPI_DATARATE_11AX20_270M8BPS_2GI_NSS2
 0x809b

	)

421 
	#FAPI_DATARATE_11AX20_14M6BPS_4GI_NSS2
 0x80a0

	)

422 
	#FAPI_DATARATE_11AX20_29M3BPS_4GI_NSS2
 0x80a1

	)

423 
	#FAPI_DATARATE_11AX20_43M9BPS_4GI_NSS2
 0x80a2

	)

424 
	#FAPI_DATARATE_11AX20_58M5BPS_4GI_NSS2
 0x80a3

	)

425 
	#FAPI_DATARATE_11AX20_87M8BPS_4GI_NSS2
 0x80a4

	)

426 
	#FAPI_DATARATE_11AX20_117MBPS_4GI_NSS2
 0x80a5

	)

427 
	#FAPI_DATARATE_11AX20_131M6BPS_4GI_NSS2
 0x80a6

	)

428 
	#FAPI_DATARATE_11AX20_146M3BPS_4GI_NSS2
 0x80a7

	)

429 
	#FAPI_DATARATE_11AX20_175M5BPS_4GI_NSS2
 0x80a8

	)

430 
	#FAPI_DATARATE_11AX20_195MBPS_4GI_NSS2
 0x80a9

	)

431 
	#FAPI_DATARATE_11AX20_219M4BPS_4GI_NSS2
 0x80¯

	)

432 
	#FAPI_DATARATE_11AX20_243M8BPS_4GI_NSS2
 0x80ab

	)

433 
	#FAPI_DATARATE_11AX20_8M6BPS_1GI_NSS2_DCM
 0x80c0

	)

434 
	#FAPI_DATARATE_11AX20_17M2BPS_1GI_NSS2_DCM
 0x80c1

	)

435 
	#FAPI_DATARATE_11AX20_34M4BPS_1GI_NSS2_DCM
 0x80c3

	)

436 
	#FAPI_DATARATE_11AX20_51M6BPS_1GI_NSS2_DCM
 0x80c4

	)

437 
	#FAPI_DATARATE_11AX20_8M1BPS_2GI_NSS2_DCM
 0x80d0

	)

438 
	#FAPI_DATARATE_11AX20_16M3BPS_2GI_NSS2_DCM
 0x80d1

	)

439 
	#FAPI_DATARATE_11AX20_32M5BPS_2GI_NSS2_DCM
 0x80d3

	)

440 
	#FAPI_DATARATE_11AX20_48M8BPS_2GI_NSS2_DCM
 0x80d4

	)

441 
	#FAPI_DATARATE_11AX20_7M3BPS_4GI_NSS2_DCM
 0x80e0

	)

442 
	#FAPI_DATARATE_11AX20_14M6BPS_4GI_NSS2_DCM
 0x80e1

	)

443 
	#FAPI_DATARATE_11AX20_29M3BPS_4GI_NSS2_DCM
 0x80e3

	)

444 
	#FAPI_DATARATE_11AX20_43M9BPS_4GI_NSS2_DCM
 0x80e4

	)

445 
	#FAPI_DATARATE_11AX40_17M2BPS_1GI
 0x8400

	)

446 
	#FAPI_DATARATE_11AX40_34M4BPS_1GI
 0x8401

	)

447 
	#FAPI_DATARATE_11AX40_51M6BPS_1GI
 0x8402

	)

448 
	#FAPI_DATARATE_11AX40_68M8BPS_1GI
 0x8403

	)

449 
	#FAPI_DATARATE_11AX40_103M2BPS_1GI
 0x8404

	)

450 
	#FAPI_DATARATE_11AX40_137M6BPS_1GI
 0x8405

	)

451 
	#FAPI_DATARATE_11AX40_154M9BPS_1GI
 0x8406

	)

452 
	#FAPI_DATARATE_11AX40_172M1BPS_1GI
 0x8407

	)

453 
	#FAPI_DATARATE_11AX40_206M5BPS_1GI
 0x8408

	)

454 
	#FAPI_DATARATE_11AX40_229M4BPS_1GI
 0x8409

	)

455 
	#FAPI_DATARATE_11AX40_258M1BPS_1GI
 0x840a

	)

456 
	#FAPI_DATARATE_11AX40_286M8BPS_1GI
 0x840b

	)

457 
	#FAPI_DATARATE_11AX40_16M3BPS_2GI
 0x8410

	)

458 
	#FAPI_DATARATE_11AX40_32M5BPS_2GI
 0x8411

	)

459 
	#FAPI_DATARATE_11AX40_48M8BPS_2GI
 0x8412

	)

460 
	#FAPI_DATARATE_11AX40_65MBPS_2GI
 0x8413

	)

461 
	#FAPI_DATARATE_11AX40_97M5BPS_2GI
 0x8414

	)

462 
	#FAPI_DATARATE_11AX40_130MBPS_2GI
 0x8415

	)

463 
	#FAPI_DATARATE_11AX40_146M3BPS_2GI
 0x8416

	)

464 
	#FAPI_DATARATE_11AX40_162M5BPS_2GI
 0x8417

	)

465 
	#FAPI_DATARATE_11AX40_195MBPS_2GI
 0x8418

	)

466 
	#FAPI_DATARATE_11AX40_216M7BPS_2GI
 0x8419

	)

467 
	#FAPI_DATARATE_11AX40_243M8BPS_2GI
 0x841a

	)

468 
	#FAPI_DATARATE_11AX40_270M8BPS_2GI
 0x841b

	)

469 
	#FAPI_DATARATE_11AX40_14M6BPS_4GI
 0x8420

	)

470 
	#FAPI_DATARATE_11AX40_29M3BPS_4GI
 0x8421

	)

471 
	#FAPI_DATARATE_11AX40_43M9BPS_4GI
 0x8422

	)

472 
	#FAPI_DATARATE_11AX40_58M5BPS_4GI
 0x8423

	)

473 
	#FAPI_DATARATE_11AX40_87M8BPS_4GI
 0x8424

	)

474 
	#FAPI_DATARATE_11AX40_117MBPS_4GI
 0x8425

	)

475 
	#FAPI_DATARATE_11AX40_131M6BPS_4GI
 0x8426

	)

476 
	#FAPI_DATARATE_11AX40_146M3BPS_4GI
 0x8427

	)

477 
	#FAPI_DATARATE_11AX40_175M5BPS_4GI
 0x8428

	)

478 
	#FAPI_DATARATE_11AX40_195MBPS_4GI
 0x8429

	)

479 
	#FAPI_DATARATE_11AX40_219M4BPS_4GI
 0x842a

	)

480 
	#FAPI_DATARATE_11AX40_243M8BPS_4GI
 0x842b

	)

481 
	#FAPI_DATARATE_11AX40_8M6BPS_1GI_DCM
 0x8440

	)

482 
	#FAPI_DATARATE_11AX40_17M2BPS_1GI_DCM
 0x8441

	)

483 
	#FAPI_DATARATE_11AX40_34M4BPS_1GI_DCM
 0x8443

	)

484 
	#FAPI_DATARATE_11AX40_51M6BPS_1GI_DCM
 0x8444

	)

485 
	#FAPI_DATARATE_11AX40_8M1BPS_2GI_DCM
 0x8450

	)

486 
	#FAPI_DATARATE_11AX40_16M3BPS_2GI_DCM
 0x8451

	)

487 
	#FAPI_DATARATE_11AX40_32M5BPS_2GI_DCM
 0x8453

	)

488 
	#FAPI_DATARATE_11AX40_48M8BPS_2GI_DCM
 0x8454

	)

489 
	#FAPI_DATARATE_11AX40_7M3BPS_4GI_DCM
 0x8460

	)

490 
	#FAPI_DATARATE_11AX40_14M6BPS_4GI_DCM
 0x8461

	)

491 
	#FAPI_DATARATE_11AX40_29M3BPS_4GI_DCM
 0x8463

	)

492 
	#FAPI_DATARATE_11AX40_43M9BPS_4GI_DCM
 0x8464

	)

493 
	#FAPI_DATARATE_11AX40_34M4BPS_1GI_NSS2
 0x8480

	)

494 
	#FAPI_DATARATE_11AX40_68M8BPS_1GI_NSS2
 0x8481

	)

495 
	#FAPI_DATARATE_11AX40_103M2BPS_1GI_NSS2
 0x8482

	)

496 
	#FAPI_DATARATE_11AX40_137M6BPS_1GI_NSS2
 0x8483

	)

497 
	#FAPI_DATARATE_11AX40_206M5BPS_1GI_NSS2
 0x8484

	)

498 
	#FAPI_DATARATE_11AX40_275M3BPS_1GI_NSS2
 0x8485

	)

499 
	#FAPI_DATARATE_11AX40_309M7BPS_1GI_NSS2
 0x8486

	)

500 
	#FAPI_DATARATE_11AX40_344M1BPS_1GI_NSS2
 0x8487

	)

501 
	#FAPI_DATARATE_11AX40_412M9BPS_1GI_NSS2
 0x8488

	)

502 
	#FAPI_DATARATE_11AX40_458M8BPS_1GI_NSS2
 0x8489

	)

503 
	#FAPI_DATARATE_11AX40_516M2BPS_1GI_NSS2
 0x848a

	)

504 
	#FAPI_DATARATE_11AX40_573M5BPS_1GI_NSS2
 0x848b

	)

505 
	#FAPI_DATARATE_11AX40_32M5BPS_2GI_NSS2
 0x8490

	)

506 
	#FAPI_DATARATE_11AX40_65MBPS_2GI_NSS2
 0x8491

	)

507 
	#FAPI_DATARATE_11AX40_97M5BPS_2GI_NSS2
 0x8492

	)

508 
	#FAPI_DATARATE_11AX40_130MBPS_2GI_NSS2
 0x8493

	)

509 
	#FAPI_DATARATE_11AX40_195MBPS_2GI_NSS2
 0x8494

	)

510 
	#FAPI_DATARATE_11AX40_260MBPS_2GI_NSS2
 0x8495

	)

511 
	#FAPI_DATARATE_11AX40_292M5BPS_2GI_NSS2
 0x8496

	)

512 
	#FAPI_DATARATE_11AX40_325MBPS_2GI_NSS2
 0x8497

	)

513 
	#FAPI_DATARATE_11AX40_390MBPS_2GI_NSS2
 0x8498

	)

514 
	#FAPI_DATARATE_11AX40_433M3BPS_2GI_NSS2
 0x8499

	)

515 
	#FAPI_DATARATE_11AX40_487M5BPS_2GI_NSS2
 0x849a

	)

516 
	#FAPI_DATARATE_11AX40_541M7BPS_2GI_NSS2
 0x849b

	)

517 
	#FAPI_DATARATE_11AX40_29M3BPS_4GI_NSS2
 0x84a0

	)

518 
	#FAPI_DATARATE_11AX40_58M5BPS_4GI_NSS2
 0x84a1

	)

519 
	#FAPI_DATARATE_11AX40_87M8BPS_4GI_NSS2
 0x84a2

	)

520 
	#FAPI_DATARATE_11AX40_117MBPS_4GI_NSS2
 0x84a3

	)

521 
	#FAPI_DATARATE_11AX40_175M5BPS_4GI_NSS2
 0x84a4

	)

522 
	#FAPI_DATARATE_11AX40_234MBPS_4GI_NSS2
 0x84a5

	)

523 
	#FAPI_DATARATE_11AX40_263M3BPS_4GI_NSS2
 0x84a6

	)

524 
	#FAPI_DATARATE_11AX40_292M5BPS_4GI_NSS2
 0x84a7

	)

525 
	#FAPI_DATARATE_11AX40_351MBPS_4GI_NSS2
 0x84a8

	)

526 
	#FAPI_DATARATE_11AX40_390MBPS_4GI_NSS2
 0x84a9

	)

527 
	#FAPI_DATARATE_11AX40_438M8BPS_4GI_NSS2
 0x84¯

	)

528 
	#FAPI_DATARATE_11AX40_487M5BPS_4GI_NSS2
 0x84ab

	)

529 
	#FAPI_DATARATE_11AX40_17M2BPS_1GI_NSS2_DCM
 0x84c0

	)

530 
	#FAPI_DATARATE_11AX40_34M4BPS_1GI_NSS2_DCM
 0x84c1

	)

531 
	#FAPI_DATARATE_11AX40_68M8BPS_1GI_NSS2_DCM
 0x84c3

	)

532 
	#FAPI_DATARATE_11AX40_103M2BPS_1GI_NSS2_DCM
 0x84c4

	)

533 
	#FAPI_DATARATE_11AX40_16M3BPS_2GI_NSS2_DCM
 0x84d0

	)

534 
	#FAPI_DATARATE_11AX40_32M5BPS_2GI_NSS2_DCM
 0x84d1

	)

535 
	#FAPI_DATARATE_11AX40_65MBPS_2GI_NSS2_DCM
 0x84d3

	)

536 
	#FAPI_DATARATE_11AX40_97M5BPS_2GI_NSS2_DCM
 0x84d4

	)

537 
	#FAPI_DATARATE_11AX40_14M6BPS_4GI_NSS2_DCM
 0x84e0

	)

538 
	#FAPI_DATARATE_11AX40_29M3BPS_4GI_NSS2_DCM
 0x84e1

	)

539 
	#FAPI_DATARATE_11AX40_58M5BPS_4GI_NSS2_DCM
 0x84e3

	)

540 
	#FAPI_DATARATE_11AX40_87M8BPS_4GI_NSS2_DCM
 0x84e4

	)

541 
	#FAPI_DATARATE_11AX80_36MBPS_1GI
 0x8800

	)

542 
	#FAPI_DATARATE_11AX80_72M1BPS_1GI
 0x8801

	)

543 
	#FAPI_DATARATE_11AX80_108M1BPS_1GI
 0x8802

	)

544 
	#FAPI_DATARATE_11AX80_144M1BPS_1GI
 0x8803

	)

545 
	#FAPI_DATARATE_11AX80_216M2BPS_1GI
 0x8804

	)

546 
	#FAPI_DATARATE_11AX80_288M2BPS_1GI
 0x8805

	)

547 
	#FAPI_DATARATE_11AX80_324M3BPS_1GI
 0x8806

	)

548 
	#FAPI_DATARATE_11AX80_360M3BPS_1GI
 0x8807

	)

549 
	#FAPI_DATARATE_11AX80_432M4BPS_1GI
 0x8808

	)

550 
	#FAPI_DATARATE_11AX80_480M4BPS_1GI
 0x8809

	)

551 
	#FAPI_DATARATE_11AX80_540M4BPS_1GI
 0x880a

	)

552 
	#FAPI_DATARATE_11AX80_600M4BPS_1GI
 0x880b

	)

553 
	#FAPI_DATARATE_11AX80_34MBPS_2GI
 0x8810

	)

554 
	#FAPI_DATARATE_11AX80_68M1BPS_2GI
 0x8811

	)

555 
	#FAPI_DATARATE_11AX80_102M1BPS_2GI
 0x8812

	)

556 
	#FAPI_DATARATE_11AX80_136M1BPS_2GI
 0x8813

	)

557 
	#FAPI_DATARATE_11AX80_204M2BPS_2GI
 0x8814

	)

558 
	#FAPI_DATARATE_11AX80_272M2BPS_2GI
 0x8815

	)

559 
	#FAPI_DATARATE_11AX80_306M3BPS_2GI
 0x8816

	)

560 
	#FAPI_DATARATE_11AX80_340M3BPS_2GI
 0x8817

	)

561 
	#FAPI_DATARATE_11AX80_408M3BPS_2GI
 0x8818

	)

562 
	#FAPI_DATARATE_11AX80_453M7BPS_2GI
 0x8819

	)

563 
	#FAPI_DATARATE_11AX80_510M4BPS_2GI
 0x881a

	)

564 
	#FAPI_DATARATE_11AX80_567M1BPS_2GI
 0x881b

	)

565 
	#FAPI_DATARATE_11AX80_30M6BPS_4GI
 0x8820

	)

566 
	#FAPI_DATARATE_11AX80_61M3BPS_4GI
 0x8821

	)

567 
	#FAPI_DATARATE_11AX80_91M9BPS_4GI
 0x8822

	)

568 
	#FAPI_DATARATE_11AX80_122M5BPS_4GI
 0x8823

	)

569 
	#FAPI_DATARATE_11AX80_183M8BPS_4GI
 0x8824

	)

570 
	#FAPI_DATARATE_11AX80_245MBPS_4GI
 0x8825

	)

571 
	#FAPI_DATARATE_11AX80_275M6BPS_4GI
 0x8826

	)

572 
	#FAPI_DATARATE_11AX80_306M3BPS_4GI
 0x8827

	)

573 
	#FAPI_DATARATE_11AX80_367M5BPS_4GI
 0x8828

	)

574 
	#FAPI_DATARATE_11AX80_408M3BPS_4GI
 0x8829

	)

575 
	#FAPI_DATARATE_11AX80_459M4BPS_4GI
 0x882a

	)

576 
	#FAPI_DATARATE_11AX80_510M4BPS_4GI
 0x882b

	)

577 
	#FAPI_DATARATE_11AX80_18MBPS_1GI_DCM
 0x8840

	)

578 
	#FAPI_DATARATE_11AX80_36MBPS_1GI_DCM
 0x8841

	)

579 
	#FAPI_DATARATE_11AX80_72M1BPS_1GI_DCM
 0x8843

	)

580 
	#FAPI_DATARATE_11AX80_108M1BPS_1GI_DCM
 0x8844

	)

581 
	#FAPI_DATARATE_11AX80_17MBPS_2GI_DCM
 0x8850

	)

582 
	#FAPI_DATARATE_11AX80_34MBPS_2GI_DCM
 0x8851

	)

583 
	#FAPI_DATARATE_11AX80_68M1BPS_2GI_DCM
 0x8853

	)

584 
	#FAPI_DATARATE_11AX80_102M1BPS_2GI_DCM
 0x8854

	)

585 
	#FAPI_DATARATE_11AX80_15M3BPS_4GI_DCM
 0x8860

	)

586 
	#FAPI_DATARATE_11AX80_30M6BPS_4GI_DCM
 0x8861

	)

587 
	#FAPI_DATARATE_11AX80_61M3BPS_4GI_DCM
 0x8863

	)

588 
	#FAPI_DATARATE_11AX80_91M9BPS_4GI_DCM
 0x8864

	)

589 
	#FAPI_DATARATE_11AX80_72M1BPS_1GI_NSS2
 0x8880

	)

590 
	#FAPI_DATARATE_11AX80_144M1BPS_1GI_NSS2
 0x8881

	)

591 
	#FAPI_DATARATE_11AX80_216M2BPS_1GI_NSS2
 0x8882

	)

592 
	#FAPI_DATARATE_11AX80_288M2BPS_1GI_NSS2
 0x8883

	)

593 
	#FAPI_DATARATE_11AX80_432M4BPS_1GI_NSS2
 0x8884

	)

594 
	#FAPI_DATARATE_11AX80_576M5BPS_1GI_NSS2
 0x8885

	)

595 
	#FAPI_DATARATE_11AX80_648M5BPS_1GI_NSS2
 0x8886

	)

596 
	#FAPI_DATARATE_11AX80_720M6BPS_1GI_NSS2
 0x8887

	)

597 
	#FAPI_DATARATE_11AX80_864M7BPS_1GI_NSS2
 0x8888

	)

598 
	#FAPI_DATARATE_11AX80_960M7BPS_1GI_NSS2
 0x8889

	)

599 
	#FAPI_DATARATE_11AX80_1080M9BPS_1GI_NSS2
 0x888a

	)

600 
	#FAPI_DATARATE_11AX80_1201MBPS_1GI_NSS2
 0x888b

	)

601 
	#FAPI_DATARATE_11AX80_68M1BPS_2GI_NSS2
 0x8890

	)

602 
	#FAPI_DATARATE_11AX80_136M1BPS_2GI_NSS2
 0x8891

	)

603 
	#FAPI_DATARATE_11AX80_204M2BPS_2GI_NSS2
 0x8892

	)

604 
	#FAPI_DATARATE_11AX80_272M2BPS_2GI_NSS2
 0x8893

	)

605 
	#FAPI_DATARATE_11AX80_408M3BPS_2GI_NSS2
 0x8894

	)

606 
	#FAPI_DATARATE_11AX80_544M4BPS_2GI_NSS2
 0x8895

	)

607 
	#FAPI_DATARATE_11AX80_612M5BPS_2GI_NSS2
 0x8896

	)

608 
	#FAPI_DATARATE_11AX80_680M6BPS_2GI_NSS2
 0x8897

	)

609 
	#FAPI_DATARATE_11AX80_816M7BPS_2GI_NSS2
 0x8898

	)

610 
	#FAPI_DATARATE_11AX80_907M4BPS_2GI_NSS2
 0x8899

	)

611 
	#FAPI_DATARATE_11AX80_1020M8BPS_2GI_NSS2
 0x889a

	)

612 
	#FAPI_DATARATE_11AX80_1134M3BPS_2GI_NSS2
 0x889b

	)

613 
	#FAPI_DATARATE_11AX80_61M3BPS_4GI_NSS2
 0x88a0

	)

614 
	#FAPI_DATARATE_11AX80_122M5BPS_4GI_NSS2
 0x88a1

	)

615 
	#FAPI_DATARATE_11AX80_183M8BPS_4GI_NSS2
 0x88a2

	)

616 
	#FAPI_DATARATE_11AX80_245MBPS_4GI_NSS2
 0x88a3

	)

617 
	#FAPI_DATARATE_11AX80_367M5BPS_4GI_NSS2
 0x88a4

	)

618 
	#FAPI_DATARATE_11AX80_490MBPS_4GI_NSS2
 0x88a5

	)

619 
	#FAPI_DATARATE_11AX80_551M3BPS_4GI_NSS2
 0x88a6

	)

620 
	#FAPI_DATARATE_11AX80_612M5BPS_4GI_NSS2
 0x88a7

	)

621 
	#FAPI_DATARATE_11AX80_735MBPS_4GI_NSS2
 0x88a8

	)

622 
	#FAPI_DATARATE_11AX80_816M6BPS_4GI_NSS2
 0x88a9

	)

623 
	#FAPI_DATARATE_11AX80_918M8BPS_4GI_NSS2
 0x88¯

	)

624 
	#FAPI_DATARATE_11AX80_1020M8BPS_4GI_NSS2
 0x88ab

	)

625 
	#FAPI_DATARATE_11AX80_36MBPS_1GI_NSS2_DCM
 0x88c0

	)

626 
	#FAPI_DATARATE_11AX80_72M1BPS_1GI_NSS2_DCM
 0x88c1

	)

627 
	#FAPI_DATARATE_11AX80_144M1BPS_1GI_NSS2_DCM
 0x88c3

	)

628 
	#FAPI_DATARATE_11AX80_216M2BPS_1GI_NSS2_DCM
 0x88c4

	)

629 
	#FAPI_DATARATE_11AX80_34MBPS_2GI_NSS2_DCM
 0x88d0

	)

630 
	#FAPI_DATARATE_11AX80_68M1BPS_2GI_NSS2_DCM
 0x88d1

	)

631 
	#FAPI_DATARATE_11AX80_136M1BPS_2GI_NSS2_DCM
 0x88d3

	)

632 
	#FAPI_DATARATE_11AX80_204M2BPS_2GI_NSS2_DCM
 0x88d4

	)

633 
	#FAPI_DATARATE_11AX80_30M6BPS_4GI_NSS2_DCM
 0x88e0

	)

634 
	#FAPI_DATARATE_11AX80_61M3BPS_4GI_NSS2_DCM
 0x88e1

	)

635 
	#FAPI_DATARATE_11AX80_122M5BPS_4GI_NSS2_DCM
 0x88e3

	)

636 
	#FAPI_DATARATE_11AX80_183M8BPS_4GI_NSS2_DCM
 0x88e4

	)

637 
	#FAPI_DATARATE_11AX160_72M1BPS_1GI
 0x8c00

	)

638 
	#FAPI_DATARATE_11AX160_144M1BPS_1GI
 0x8c01

	)

639 
	#FAPI_DATARATE_11AX160_216M2BPS_1GI
 0x8c02

	)

640 
	#FAPI_DATARATE_11AX160_288M2BPS_1GI
 0x8c03

	)

641 
	#FAPI_DATARATE_11AX160_432M4BPS_1GI
 0x8c04

	)

642 
	#FAPI_DATARATE_11AX160_576M5BPS_1GI
 0x8c05

	)

643 
	#FAPI_DATARATE_11AX160_648M5BPS_1GI
 0x8c06

	)

644 
	#FAPI_DATARATE_11AX160_720M6BPS_1GI
 0x8c07

	)

645 
	#FAPI_DATARATE_11AX160_864M7BPS_1GI
 0x8c08

	)

646 
	#FAPI_DATARATE_11AX160_960M7BPS_1GI
 0x8c09

	)

647 
	#FAPI_DATARATE_11AX160_1080M9BPS_1GI
 0x8c0a

	)

648 
	#FAPI_DATARATE_11AX160_1201MBPS_1GI
 0x8c0b

	)

649 
	#FAPI_DATARATE_11AX160_68M1BPS_2GI
 0x8c10

	)

650 
	#FAPI_DATARATE_11AX160_136M1BPS_2GI
 0x8c11

	)

651 
	#FAPI_DATARATE_11AX160_204M2BPS_2GI
 0x8c12

	)

652 
	#FAPI_DATARATE_11AX160_272M2BPS_2GI
 0x8c13

	)

653 
	#FAPI_DATARATE_11AX160_408M3BPS_2GI
 0x8c14

	)

654 
	#FAPI_DATARATE_11AX160_544M4BPS_2GI
 0x8c15

	)

655 
	#FAPI_DATARATE_11AX160_612M5BPS_2GI
 0x8c16

	)

656 
	#FAPI_DATARATE_11AX160_680M6BPS_2GI
 0x8c17

	)

657 
	#FAPI_DATARATE_11AX160_816M7BPS_2GI
 0x8c18

	)

658 
	#FAPI_DATARATE_11AX160_907M4BPS_2GI
 0x8c19

	)

659 
	#FAPI_DATARATE_11AX160_1020M8BPS_2GI
 0x8c1a

	)

660 
	#FAPI_DATARATE_11AX160_1134M2BPS_2GI
 0x8c1b

	)

661 
	#FAPI_DATARATE_11AX160_61M3BPS_4GI
 0x8c20

	)

662 
	#FAPI_DATARATE_11AX160_122M5BPS_4GI
 0x8c21

	)

663 
	#FAPI_DATARATE_11AX160_183M8BPS_4GI
 0x8c22

	)

664 
	#FAPI_DATARATE_11AX160_245MBPS_4GI
 0x8c23

	)

665 
	#FAPI_DATARATE_11AX160_367M5BPS_4GI
 0x8c24

	)

666 
	#FAPI_DATARATE_11AX160_490MBPS_4GI
 0x8c25

	)

667 
	#FAPI_DATARATE_11AX160_551M3BPS_4GI
 0x8c26

	)

668 
	#FAPI_DATARATE_11AX160_612M5BPS_4GI
 0x8c27

	)

669 
	#FAPI_DATARATE_11AX160_735MBPS_4GI
 0x8c28

	)

670 
	#FAPI_DATARATE_11AX160_816M6BPS_4GI
 0x8c29

	)

671 
	#FAPI_DATARATE_11AX160_918M8BPS_4GI
 0x8c2a

	)

672 
	#FAPI_DATARATE_11AX160_1020M8BPS_4GI
 0x8c2b

	)

673 
	#FAPI_DATARATE_11AX160_36MBPS_1GI_DCM
 0x8c40

	)

674 
	#FAPI_DATARATE_11AX160_72M1BPS_1GI_DCM
 0x8c41

	)

675 
	#FAPI_DATARATE_11AX160_144M1BPS_1GI_DCM
 0x8c43

	)

676 
	#FAPI_DATARATE_11AX160_216M2BPS_1GI_DCM
 0x8c44

	)

677 
	#FAPI_DATARATE_11AX160_34MBPS_2GI_DCM
 0x8c50

	)

678 
	#FAPI_DATARATE_11AX160_68M1BPS_2GI_DCM
 0x8c51

	)

679 
	#FAPI_DATARATE_11AX160_136M1BPS_2GI_DCM
 0x8c53

	)

680 
	#FAPI_DATARATE_11AX160_204M2BPS_2GI_DCM
 0x8c54

	)

681 
	#FAPI_DATARATE_11AX160_30M6BPS_4GI_DCM
 0x8c60

	)

682 
	#FAPI_DATARATE_11AX160_61M3BPS_4GI_DCM
 0x8c61

	)

683 
	#FAPI_DATARATE_11AX160_122M5BPS_4GI_DCM
 0x8c63

	)

684 
	#FAPI_DATARATE_11AX160_183M8BPS_4GI_DCM
 0x8c64

	)

685 
	#FAPI_DATARATE_11AX160_144M1BPS_1GI_NSS2
 0x8c80

	)

686 
	#FAPI_DATARATE_11AX160_288M2BPS_1GI_NSS2
 0x8c81

	)

687 
	#FAPI_DATARATE_11AX160_432M4BPS_1GI_NSS2
 0x8c82

	)

688 
	#FAPI_DATARATE_11AX160_576M5BPS_1GI_NSS2
 0x8c83

	)

689 
	#FAPI_DATARATE_11AX160_864M7BPS_1GI_NSS2
 0x8c84

	)

690 
	#FAPI_DATARATE_11AX160_1152M9BPS_1GI_NSS2
 0x8c85

	)

691 
	#FAPI_DATARATE_11AX160_1297M1BPS_1GI_NSS2
 0x8c86

	)

692 
	#FAPI_DATARATE_11AX160_1441M2BPS_1GI_NSS2
 0x8c87

	)

693 
	#FAPI_DATARATE_11AX160_1729M4BPS_1GI_NSS2
 0x8c88

	)

694 
	#FAPI_DATARATE_11AX160_1921M5BPS_1GI_NSS2
 0x8c89

	)

695 
	#FAPI_DATARATE_11AX160_2161M8BPS_1GI_NSS2
 0x8c8a

	)

696 
	#FAPI_DATARATE_11AX160_2401M9BPS_1GI_NSS2
 0x8c8b

	)

697 
	#FAPI_DATARATE_11AX160_136M1BPS_2GI_NSS2
 0x8c90

	)

698 
	#FAPI_DATARATE_11AX160_272M2BPS_2GI_NSS2
 0x8c91

	)

699 
	#FAPI_DATARATE_11AX160_408M3BPS_2GI_NSS2
 0x8c92

	)

700 
	#FAPI_DATARATE_11AX160_544M4BPS_2GI_NSS2
 0x8c93

	)

701 
	#FAPI_DATARATE_11AX160_816M7BPS_2GI_NSS2
 0x8c94

	)

702 
	#FAPI_DATARATE_11AX160_1088M9BPS_2GI_NSS2
 0x8c95

	)

703 
	#FAPI_DATARATE_11AX160_1225MBPS_2GI_NSS2
 0x8c96

	)

704 
	#FAPI_DATARATE_11AX160_1361M1BPS_2GI_NSS2
 0x8c97

	)

705 
	#FAPI_DATARATE_11AX160_1633M3BPS_2GI_NSS2
 0x8c98

	)

706 
	#FAPI_DATARATE_11AX160_1814M8BPS_2GI_NSS2
 0x8c99

	)

707 
	#FAPI_DATARATE_11AX160_2041M7BPS_2GI_NSS2
 0x8c9a

	)

708 
	#FAPI_DATARATE_11AX160_2268M5BPS_2GI_NSS2
 0x8c9b

	)

709 
	#FAPI_DATARATE_11AX160_122M5BPS_4GI_NSS2
 0x8ÿ0

	)

710 
	#FAPI_DATARATE_11AX160_245MBPS_4GI_NSS2
 0x8ÿ1

	)

711 
	#FAPI_DATARATE_11AX160_367M5BPS_4GI_NSS2
 0x8ÿ2

	)

712 
	#FAPI_DATARATE_11AX160_490MBPS_4GI_NSS2
 0x8ÿ3

	)

713 
	#FAPI_DATARATE_11AX160_735MBPS_4GI_NSS2
 0x8ÿ4

	)

714 
	#FAPI_DATARATE_11AX160_980MBPS_4GI_NSS2
 0x8ÿ5

	)

715 
	#FAPI_DATARATE_11AX160_1102M5BPS_4GI_NSS2
 0x8ÿ6

	)

716 
	#FAPI_DATARATE_11AX160_1225MBPS_4GI_NSS2
 0x8ÿ7

	)

717 
	#FAPI_DATARATE_11AX160_1470MBPS_4GI_NSS2
 0x8ÿ8

	)

718 
	#FAPI_DATARATE_11AX160_1633M3BPS_4GI_NSS2
 0x8ÿ9

	)

719 
	#FAPI_DATARATE_11AX160_1837M5BPS_4GI_NSS2
 0x8ÿa

	)

720 
	#FAPI_DATARATE_11AX160_2041M6BPS_4GI_NSS2
 0x8ÿb

	)

721 
	#FAPI_DATARATE_11AX160_72M1BPS_1GI_NSS2_DCM
 0x8cc0

	)

722 
	#FAPI_DATARATE_11AX160_144M1BPS_1GI_NSS2_DCM
 0x8cc1

	)

723 
	#FAPI_DATARATE_11AX160_288M2BPS_1GI_NSS2_DCM
 0x8cc3

	)

724 
	#FAPI_DATARATE_11AX160_432M4BPS_1GI_NSS2_DCM
 0x8cc4

	)

725 
	#FAPI_DATARATE_11AX160_68M1BPS_2GI_NSS2_DCM
 0x8cd0

	)

726 
	#FAPI_DATARATE_11AX160_136M1BPS_2GI_NSS2_DCM
 0x8cd1

	)

727 
	#FAPI_DATARATE_11AX160_272M2BPS_2GI_NSS2_DCM
 0x8cd3

	)

728 
	#FAPI_DATARATE_11AX160_408M3BPS_2GI_NSS2_DCM
 0x8cd4

	)

729 
	#FAPI_DATARATE_11AX160_61M3BPS_4GI_NSS2_DCM
 0x8û0

	)

730 
	#FAPI_DATARATE_11AX160_122M5BPS_4GI_NSS2_DCM
 0x8û1

	)

731 
	#FAPI_DATARATE_11AX160_245MBPS_4GI_NSS2_DCM
 0x8û3

	)

732 
	#FAPI_DATARATE_11AX160_367M5BPS_4GI_NSS2_DCM
 0x8û4

	)

733 
	#FAPI_DATARATE_CTR_TOTAL
 0xe000

	)

734 
	#FAPI_DATARATE_CTR_NO_ERROR
 0xe001

	)

735 
	#FAPI_DATARATE_CTR_CRC_ERROR
 0xe002

	)

736 
	#FAPI_DATARATE_CTR_BAD_SIGNAL
 0xe003

	)

737 
	#FAPI_DATARATE_CTR_STBC
 0xe004

	)

738 
	#FAPI_DATARATE_CTR_DUPLICATE
 0xe005

	)

739 
	#FAPI_DATARATE_CTR_ERROR
 0xe006

	)

740 
	#FAPI_DATARATE_CTR_LDPC
 0xe007

	)

741 
	#FAPI_DATARATE_CTR_BEAMFORMED
 0xe008

	)

742 
	#FAPI_DATARATE_CTR_FROM_AP
 0xe009

	)

743 
	#FAPI_DATARATE_CTR_INVALID_RSSI
 0xe00a

	)

745 
	#FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
 0x0000

	)

746 
	#FAPI_DATAUNITDESCRIPTOR_IEEE802_3_FRAME
 0x0001

	)

747 
	#FAPI_DATAUNITDESCRIPTOR_AMSDU_SUBFRAME
 0x0002

	)

748 
	#FAPI_DATAUNITDESCRIPTOR_AMSDU
 0x0003

	)

749 
	#FAPI_DATAUNITDESCRIPTOR_TCP_ACK
 0x0004

	)

751 
	#FAPI_DEVICEROLE_INFRASTRUCTURE_STATION
 0x0001

	)

752 
	#FAPI_DEVICEROLE_P2P_GO
 0x0002

	)

753 
	#FAPI_DEVICEROLE_P2P_DEVICE
 0x0003

	)

754 
	#FAPI_DEVICEROLE_P2P_CLIENT
 0x0004

	)

756 
	#FAPI_DEVICESTATE_IDLE
 0

	)

757 
	#FAPI_DEVICESTATE_RX_RUNNING
 1

	)

758 
	#FAPI_DEVICESTATE_TX_RUNNING
 2

	)

759 
	#FAPI_DEVICESTATE_CW_RUNNING
 3

	)

760 
	#FAPI_DEVICESTATE_BIST_RUNNING
 4

	)

762 
	#FAPI_DFSREGULATORY_UNKNOWN
 0x0000

	)

763 
	#FAPI_DFSREGULATORY_FCC
 0x0001

	)

764 
	#FAPI_DFSREGULATORY_ETSI
 0x0002

	)

765 
	#FAPI_DFSREGULATORY_JAPAN
 0x0003

	)

766 
	#FAPI_DFSREGULATORY_GLOBAL
 0x0004

	)

767 
	#FAPI_DFSREGULATORY_CHINA
 0x0006

	)

769 
	#FAPI_DIRECTION_TRANSMIT
 0x0000

	)

770 
	#FAPI_DIRECTION_RECEIVE
 0x0001

	)

772 
	#FAPI_ENDPOINT_HOSTIO
 0x0001

	)

773 
	#FAPI_ENDPOINT_DPLP
 0x0002

	)

775 
	#FAPI_EPNOPOLICY_HIDDEN
 0x0001

	)

776 
	#FAPI_EPNOPOLICY_A_BAND
 0x0002

	)

777 
	#FAPI_EPNOPOLICY_G_BAND
 0x0004

	)

778 
	#FAPI_EPNOPOLICY_STRICT_MATCH
 0x0008

	)

779 
	#FAPI_EPNOPOLICY_SAME_NETWORK
 0x0010

	)

780 
	#FAPI_EPNOPOLICY_AUTH_OPEN
 0x0100

	)

781 
	#FAPI_EPNOPOLICY_AUTH_PSK
 0x0200

	)

782 
	#FAPI_EPNOPOLICY_AUTH_EAPOL
 0x0400

	)

784 
	#FAPI_EVENT_WIFI_EVENT_ASSOCIATION_REQUESTED
 0x0000

	)

785 
	#FAPI_EVENT_WIFI_EVENT_AUTH_COMPLETE
 0x0001

	)

786 
	#FAPI_EVENT_WIFI_EVENT_ASSOC_COMPLETE
 0x0002

	)

787 
	#FAPI_EVENT_WIFI_EVENT_FW_AUTH_STARTED
 0x0003

	)

788 
	#FAPI_EVENT_WIFI_EVENT_FW_ASSOC_STARTED
 0x0004

	)

789 
	#FAPI_EVENT_WIFI_EVENT_FW_RE_ASSOC_STARTED
 0x0005

	)

790 
	#FAPI_EVENT_WIFI_EVENT_DRIVER_SCAN_REQUESTED
 0x0006

	)

791 
	#FAPI_EVENT_WIFI_EVENT_DRIVER_SCAN_RESULT_FOUND
 0x0007

	)

792 
	#FAPI_EVENT_WIFI_EVENT_DRIVER_SCAN_COMPLETE
 0x0008

	)

793 
	#FAPI_EVENT_WIFI_EVENT_G_SCAN_STARTED
 0x0009

	)

794 
	#FAPI_EVENT_WIFI_EVENT_G_SCAN_COMPLETE
 0x000a

	)

795 
	#FAPI_EVENT_WIFI_EVENT_DISASSOCIATION_REQUESTED
 0x000b

	)

796 
	#FAPI_EVENT_WIFI_EVENT_RE_ASSOCIATION_REQUESTED
 0x000c

	)

797 
	#FAPI_EVENT_WIFI_EVENT_ROAM_REQUESTED
 0x000d

	)

798 
	#FAPI_EVENT_WIFI_EVENT_BEACON_RECEIVED
 0x000e

	)

799 
	#FAPI_EVENT_WIFI_EVENT_ROAM_SCAN_STARTED
 0x000f

	)

800 
	#FAPI_EVENT_WIFI_EVENT_ROAM_SCAN_COMPLETE
 0x0010

	)

801 
	#FAPI_EVENT_WIFI_EVENT_ROAM_SEARCH_STARTED
 0x0011

	)

802 
	#FAPI_EVENT_WIFI_EVENT_ROAM_SEARCH_STOPPED
 0x0012

	)

803 
	#FAPI_EVENT_WIFI_EVENT_CHANNEL_SWITCH_ANOUNCEMENT
 0x0014

	)

804 
	#FAPI_EVENT_WIFI_EVENT_FW_EAPOL_FRAME_TRANSMIT_START
 0x0015

	)

805 
	#FAPI_EVENT_WIFI_EVENT_FW_EAPOL_FRAME_TRANSMIT_STOP
 0x0016

	)

806 
	#FAPI_EVENT_WIFI_EVENT_DRIVER_EAPOL_FRAME_TRANSMIT_REQUESTED
 0x0017

	)

807 
	#FAPI_EVENT_WIFI_EVENT_FW_EAPOL_FRAME_RECEIVED
 0x0018

	)

808 
	#FAPI_EVENT_WIFI_EVENT_DRIVER_EAPOL_FRAME_RECEIVED
 0x001a

	)

809 
	#FAPI_EVENT_WIFI_EVENT_BLOCK_ACK_NEGOTIATION_COMPLETE
 0x001b

	)

810 
	#FAPI_EVENT_WIFI_EVENT_BT_COEX_BT_SCO_START
 0x001c

	)

811 
	#FAPI_EVENT_WIFI_EVENT_BT_COEX_BT_SCO_STOP
 0x001d

	)

812 
	#FAPI_EVENT_WIFI_EVENT_BT_COEX_BT_SCAN_START
 0x001e

	)

813 
	#FAPI_EVENT_WIFI_EVENT_BT_COEX_BT_SCAN_STOP
 0x001f

	)

814 
	#FAPI_EVENT_WIFI_EVENT_BT_COEX_BT_HID_START
 0x0020

	)

815 
	#FAPI_EVENT_WIFI_EVENT_BT_COEX_BT_HID_STOP
 0x0021

	)

816 
	#FAPI_EVENT_WIFI_EVENT_ROAM_AUTH_STARTED
 0x0022

	)

817 
	#FAPI_EVENT_WIFI_EVENT_ROAM_AUTH_COMPLETE
 0x0023

	)

818 
	#FAPI_EVENT_WIFI_EVENT_ROAM_ASSOC_STARTED
 0x0024

	)

819 
	#FAPI_EVENT_WIFI_EVENT_ROAM_ASSOC_COMPLETE
 0x0025

	)

820 
	#FAPI_EVENT_WIFI_EVENT_G_SCAN_STOP
 0x0026

	)

821 
	#FAPI_EVENT_WIFI_EVENT_G_SCAN_CYCLE_STARTED
 0x0027

	)

822 
	#FAPI_EVENT_WIFI_EVENT_G_SCAN_CYCLE_COMPLETED
 0x0028

	)

823 
	#FAPI_EVENT_WIFI_EVENT_G_SCAN_BUCKET_STARTED
 0x0029

	)

824 
	#FAPI_EVENT_WIFI_EVENT_G_SCAN_BUCKET_COMPLETED
 0x002a

	)

825 
	#FAPI_EVENT_WIFI_EVENT_G_SCAN_RESULTS_AVAILABLE
 0x002b

	)

826 
	#FAPI_EVENT_WIFI_EVENT_G_SCAN_CAPABILITIES
 0x002c

	)

827 
	#FAPI_EVENT_WIFI_EVENT_ROAM_CANDIDATE_FOUND
 0x002d

	)

828 
	#FAPI_EVENT_WIFI_EVENT_ROAM_SCAN_CONFIG
 0x002e

	)

829 
	#FAPI_EVENT_WIFI_EVENT_AUTH_TIMEOUT
 0x002f

	)

830 
	#FAPI_EVENT_WIFI_EVENT_ASSOC_TIMEOUT
 0x0030

	)

831 
	#FAPI_EVENT_WIFI_EVENT_MEM_ALLOC_FAILURE
 0x0031

	)

832 
	#FAPI_EVENT_WIFI_EVENT_DRIVER_PNO_ADD
 0x0032

	)

833 
	#FAPI_EVENT_WIFI_EVENT_DRIVER_PNO_REMOVE
 0x0033

	)

834 
	#FAPI_EVENT_WIFI_EVENT_DRIVER_PNO_NETWORK_FOUND
 0x0034

	)

835 
	#FAPI_EVENT_WIFI_EVENT_DRIVER_PNO_SCAN_REQUESTED
 0x0035

	)

836 
	#FAPI_EVENT_WIFI_EVENT_DRIVER_PNO_SCAN_RESULT_FOUND
 0x0036

	)

837 
	#FAPI_EVENT_WIFI_EVENT_DRIVER_PNO_SCAN_COMPLETE
 0x0037

	)

838 
	#FAPI_EVENT_WIFI_EVENT_FW_BTM_FRAME_REQUEST
 0x0038

	)

839 
	#FAPI_EVENT_WIFI_EVENT_FW_BTM_FRAME_RESPONSE
 0x0039

	)

840 
	#FAPI_EVENT_WIFI_EVENT_FW_NR_FRAME_REQUEST
 0x003a

	)

841 
	#FAPI_EVENT_WIFI_EVENT_FW_CONNECTION_ATTEMPT_ABORTED
 0x003c

	)

842 
	#FAPI_EVENT_WIFI_EVENT_ROAM_AUTH_TIMEOUT
 0x003d

	)

843 
	#FAPI_EVENT_WIFI_EVENT_ROAM_SCAN_RESULT
 0x003e

	)

844 
	#FAPI_EVENT_WIFI_EVENT_ROAM_RSSI_THRESHOLD
 0x003f

	)

845 
	#FAPI_EVENT_WIFI_EVENT_FW_BEACON_REPORT_REQUEST
 0x0040

	)

846 
	#FAPI_EVENT_WIFI_EVENT_FW_FTM_RANGE_REQUEST
 0x0041

	)

847 
	#FAPI_EVENT_WIFI_EVENT_FW_NAN_ROLE_TYPE
 0x0042

	)

848 
	#FAPI_EVENT_WIFI_EVENT_FW_FRAME_TRANSMIT_FAILURE
 0x0043

	)

849 
	#FAPI_EVENT_WIFI_EVENT_FW_NR_FRAME_RESPONSE
 0x0044

	)

850 
	#FAPI_EVENT_WIFI_EVENT_NAN_AVAILABILITY_UPDATE
 0x0045

	)

851 
	#FAPI_EVENT_WIFI_EVENT_NAN_ULW_UPDATE
 0x0046

	)

852 
	#FAPI_EVENT_WIFI_EVENT_NAN_TRAFFIC_UPDATE
 0x0047

	)

853 
	#FAPI_EVENT_WIFI_EVENT_BLACKOUT_START
 0x0064

	)

854 
	#FAPI_EVENT_WIFI_EVENT_BLACKOUT_STOP
 0x0065

	)

855 
	#FAPI_EVENT_WIFI_EVENT_NAN_PUBLISH_TERMINATED
 0x0100

	)

856 
	#FAPI_EVENT_WIFI_EVENT_NAN_SUBSCRIBE_TERMINATED
 0x0101

	)

857 
	#FAPI_EVENT_WIFI_EVENT_NAN_MATCH_EXPIRED
 0x0102

	)

858 
	#FAPI_EVENT_WIFI_EVENT_NAN_ADDRESS_CHANGED
 0x0103

	)

859 
	#FAPI_EVENT_WIFI_EVENT_NAN_CLUSTER_STARTED
 0x0104

	)

860 
	#FAPI_EVENT_WIFI_EVENT_NAN_CLUSTER_JOINED
 0x0105

	)

861 
	#FAPI_EVENT_WIFI_EVENT_NAN_TRANSMIT_FOLLOWUP
 0x0106

	)

863 
	#FAPI_HIDDENSSID_NOT_HIDDEN
 0x0000

	)

864 
	#FAPI_HIDDENSSID_HIDDEN_ZERO_LENGTH
 0x0001

	)

865 
	#FAPI_HIDDENSSID_HIDDEN_ZERO_DATA
 0x0002

	)

867 
	#FAPI_HT_NON_HT_RATE
 0x1

	)

868 
	#FAPI_HT_HT_RATE
 0x2

	)

869 
	#FAPI_HT_VHT_RATE
 0x3

	)

871 
	#FAPI_KEYTYPE_GROUP
 0x0000

	)

872 
	#FAPI_KEYTYPE_PAIRWISE
 0x0001

	)

873 
	#FAPI_KEYTYPE_WEP
 0x0002

	)

874 
	#FAPI_KEYTYPE_IGTK
 0x0003

	)

875 
	#FAPI_KEYTYPE_PMK
 0x0004

	)

876 
	#FAPI_KEYTYPE_BIGTK
 0x0005

	)

877 
	#FAPI_KEYTYPE_FIRST_ILLEGAL
 0x0006

	)

879 
	#FAPI_MESSAGETYPE_EAP_MESSAGE
 0x0001

	)

880 
	#FAPI_MESSAGETYPE_EAPOL_KEY_M123
 0x0002

	)

881 
	#FAPI_MESSAGETYPE_EAPOL_KEY_M4
 0x0003

	)

882 
	#FAPI_MESSAGETYPE_ARP
 0x0004

	)

883 
	#FAPI_MESSAGETYPE_DHCP
 0x0005

	)

884 
	#FAPI_MESSAGETYPE_NEIGHBOR_DISCOVERY
 0x0006

	)

885 
	#FAPI_MESSAGETYPE_WAI_MESSAGE
 0x0007

	)

886 
	#FAPI_MESSAGETYPE_ANY_OTHER
 0x0008

	)

887 
	#FAPI_MESSAGETYPE_IEEE80211_ACTION
 0x0010

	)

888 
	#FAPI_MESSAGETYPE_IEEE80211_MGMT
 0x0011

	)

890 
	#FAPI_MODE_SOURCE
 0x0001

	)

891 
	#FAPI_MODE_SINK
 0x0002

	)

892 
	#FAPI_MODE_LOOPBACK
 0x0003

	)

894 
	#FAPI_NANAVAILABILITYDURATION_16MS
 0x00

	)

895 
	#FAPI_NANAVAILABILITYDURATION_32MS
 0x01

	)

896 
	#FAPI_NANAVAILABILITYDURATION_64MS
 0x02

	)

898 
	#FAPI_NANOPERATIONCONTROL_MAC_ADDRESS_EVENT
 0x0002

	)

899 
	#FAPI_NANOPERATIONCONTROL_START_CLUSTER_EVENT
 0x0004

	)

900 
	#FAPI_NANOPERATIONCONTROL_JOINED_CLUSTER_EVENT
 0x0008

	)

902 
	#FAPI_NANSDFCONTROL_PUBLISH_END_EVENT
 0x0001

	)

903 
	#FAPI_NANSDFCONTROL_SUBSCRIBE_END_EVENT
 0x0002

	)

904 
	#FAPI_NANSDFCONTROL_MATCH_EXPIRED_EVENT
 0x0004

	)

905 
	#FAPI_NANSDFCONTROL_RECEIVED_FOLLOWUP_EVENT
 0x0008

	)

906 
	#FAPI_NANSDFCONTROL_FOLLOWUP_TRANSMIT_STATUS
 0x0010

	)

908 
	#FAPI_PACKETFILTERMODE_OPT_OUT
 0x01

	)

909 
	#FAPI_PACKETFILTERMODE_OPT_IN
 0x02

	)

910 
	#FAPI_PACKETFILTERMODE_OPT_OUT_SLEEP
 0x04

	)

911 
	#FAPI_PACKETFILTERMODE_OPT_IN_SLEEP
 0x08

	)

913 
	#FAPI_PMALLOCAREA_PMALLOC_STATS
 0x0000

	)

914 
	#FAPI_PMALLOCAREA_PMALLOC_FSM_STATS
 0x0001

	)

915 
	#FAPI_PMALLOCAREA_HOSTIO_SIG_SIZES
 0x0002

	)

917 
	#FAPI_POWERMANAGEMENTMODE_ACTIVE_MODE
 0x0000

	)

918 
	#FAPI_POWERMANAGEMENTMODE_POWER_SAVE
 0x0001

	)

920 
	#FAPI_PRIMARYCHANNELPOSITION_P0
 0x00

	)

921 
	#FAPI_PRIMARYCHANNELPOSITION_P1
 0x01

	)

922 
	#FAPI_PRIMARYCHANNELPOSITION_P2
 0x02

	)

923 
	#FAPI_PRIMARYCHANNELPOSITION_P3
 0x03

	)

924 
	#FAPI_PRIMARYCHANNELPOSITION_P4
 0x04

	)

925 
	#FAPI_PRIMARYCHANNELPOSITION_P5
 0x05

	)

926 
	#FAPI_PRIMARYCHANNELPOSITION_P6
 0x06

	)

927 
	#FAPI_PRIMARYCHANNELPOSITION_P7
 0x07

	)

928 
	#FAPI_PRIMARYCHANNELPOSITION_NOT_APPLICABLE
 0x08

	)

930 
	#FAPI_PRIORITY_QOS_UP0
 0x0000

	)

931 
	#FAPI_PRIORITY_QOS_UP1
 0x0001

	)

932 
	#FAPI_PRIORITY_QOS_UP2
 0x0002

	)

933 
	#FAPI_PRIORITY_QOS_UP3
 0x0003

	)

934 
	#FAPI_PRIORITY_QOS_UP4
 0x0004

	)

935 
	#FAPI_PRIORITY_QOS_UP5
 0x0005

	)

936 
	#FAPI_PRIORITY_QOS_UP6
 0x0006

	)

937 
	#FAPI_PRIORITY_QOS_UP7
 0x0007

	)

938 
	#FAPI_PRIORITY_CONTENTION
 0x8000

	)

940 
	#FAPI_PROCEDURETYPE_UNKNOWN
 0x0000

	)

941 
	#FAPI_PROCEDURETYPE_CONNECTION_STARTED
 0x0001

	)

942 
	#FAPI_PROCEDURETYPE_DEVICE_DISCOVERED
 0x0002

	)

943 
	#FAPI_PROCEDURETYPE_ROAMING_STARTED
 0x0003

	)

945 
	#FAPI_PROCESSOR_DEFAULT
 0x0

	)

946 
	#FAPI_PROCESSOR_CHIPCPU
 0x1

	)

947 
	#FAPI_PROCESSOR_HOSTCPU
 0x3

	)

949 
	#FAPI_PROTOCOL_UDP
 0x0001

	)

950 
	#FAPI_PROTOCOL_TCP
 0x0002

	)

952 
	#FAPI_PURPOSE_BEACON
 0x0001

	)

953 
	#FAPI_PURPOSE_PROBE_RESPONSE
 0x0002

	)

954 
	#FAPI_PURPOSE_ASSOCIATION_RESPONSE
 0x0004

	)

955 
	#FAPI_PURPOSE_LOCAL
 0x0008

	)

956 
	#FAPI_PURPOSE_ASSOCIATION_REQUEST
 0x0010

	)

957 
	#FAPI_PURPOSE_PROBE_REQUEST
 0x0020

	)

959 
	#FAPI_RADIOBITMAP_RADIO_0
 0x0001

	)

960 
	#FAPI_RADIOBITMAP_RADIO_1
 0x0002

	)

962 
	#FAPI_REASONCODE_RESERVED
 0x0000

	)

963 
	#FAPI_REASONCODE_UNSPECIFIED_REASON
 0x0001

	)

964 
	#FAPI_REASONCODE_DEAUTHENTICATED_INVALID_AUTHENTICATION
 0x0002

	)

965 
	#FAPI_REASONCODE_DEAUTHENTICATED_LEAVING
 0x0003

	)

966 
	#FAPI_REASONCODE_DEAUTHENTICATED_NO_MORE_STATIONS
 0x0005

	)

967 
	#FAPI_REASONCODE_DEAUTHENTICATED_INVALID_CLASS_2_FRAME
 0x0006

	)

968 
	#FAPI_REASONCODE_DEAUTHENTICATED_INVALID_CLASS_3_FRAME
 0x0007

	)

969 
	#FAPI_REASONCODE_DEAUTHENTICATED_REASON_INVALID_IE
 0x000d

	)

970 
	#FAPI_REASONCODE_DEAUTHENTICATED_4_WAY_HANDSHAKE_TIMEOUT
 0x000f

	)

971 
	#FAPI_REASONCODE_DEAUTHENTICATED_GROUP_HANDSHAKE_TIMEOUT
 0x0010

	)

972 
	#FAPI_REASONCODE_DEAUTHENTICATED_HANDSHAKE_ELEMENT_MISMATCH
 0x0011

	)

973 
	#FAPI_REASONCODE_DEAUTHENTICATED_REASON_INVALID_RSNE
 0x0014

	)

974 
	#FAPI_REASONCODE_DEAUTHENTICATED_802_1_X_AUTH_FAILED
 0x0017

	)

975 
	#FAPI_REASONCODE_TDLS_PEER_UNREACHABLE
 0x0019

	)

976 
	#FAPI_REASONCODE_TDLS_TEARDOWN_UNSPECIFIED_REASON
 0x001a

	)

977 
	#FAPI_REASONCODE_QOS_UNSPECIFIED_REASON
 0x0020

	)

978 
	#FAPI_REASONCODE_QOS_EXCESSIVE_NOT_ACK
 0x0022

	)

979 
	#FAPI_REASONCODE_QOS_TXOP_LIMIT_EXCEEDED
 0x0023

	)

980 
	#FAPI_REASONCODE_QSTA_LEAVING
 0x0024

	)

981 
	#FAPI_REASONCODE_END
 0x0025

	)

982 
	#FAPI_REASONCODE_UNKNOWN
 0x0026

	)

983 
	#FAPI_REASONCODE_TIMEOUT
 0x0027

	)

984 
	#FAPI_REASONCODE_KEEP_ALIVE_FAILURE
 0x0028

	)

985 
	#FAPI_REASONCODE_START
 0x0029

	)

986 
	#FAPI_REASONCODE_DEAUTHENTICATED_REASON_INVALID_PMKID
 0x0031

	)

987 
	#FAPI_REASONCODE_INVALID_PMKID
 0x0049

	)

988 
	#FAPI_REASONCODE_SYNCHRONISATION_LOSS
 0x8003

	)

989 
	#FAPI_REASONCODE_SECURITY_REQUIRED
 0x8004

	)

990 
	#FAPI_REASONCODE_ROAMING_FAILURE_LINK_LOSS_NO_CANDIDATE
 0x8005

	)

991 
	#FAPI_REASONCODE_HOTSPOT_MAX_CLIENT_REACHED
 0x8006

	)

992 
	#FAPI_REASONCODE_CHANNEL_SWITCH_FAILURE
 0x8007

	)

993 
	#FAPI_REASONCODE_REPORTING_ABORTED_SCANNING
 0x8008

	)

994 
	#FAPI_REASONCODE_REPORTING_ABORTED_ROAMING
 0x8009

	)

995 
	#FAPI_REASONCODE_OUT_OF_RANGE_SEQUENCE_NUMBER
 0x800a

	)

996 
	#FAPI_REASONCODE_MISUSE_OF_AMSDU
 0x800b

	)

997 
	#FAPI_REASONCODE_NAN_SERVICE_TERMINATED_TIMEOUT
 0x9001

	)

998 
	#FAPI_REASONCODE_NAN_SERVICE_TERMINATED_USER_REQUEST
 0x9002

	)

999 
	#FAPI_REASONCODE_NAN_SERVICE_TERMINATED_COUNT_REACHED
 0x9003

	)

1000 
	#FAPI_REASONCODE_NAN_SERVICE_TERMINATED_DISCOVERY_SHUTDOWN
 0x9004

	)

1001 
	#FAPI_REASONCODE_NAN_TRANSMIT_FOLLOWUP_SUCCESS
 0x9006

	)

1002 
	#FAPI_REASONCODE_NAN_TRANSMIT_FOLLOWUP_FAILURE
 0x9007

	)

1003 
	#FAPI_REASONCODE_NDP_ACCEPTED
 0x9008

	)

1004 
	#FAPI_REASONCODE_NDP_REJECTED
 0x9009

	)

1005 
	#FAPI_REASONCODE_NDP_RESPONSE_TIMEOUT
 0x900a

	)

1007 
	#FAPI_REPORTMODE_RESERVED
 0x0001

	)

1008 
	#FAPI_REPORTMODE_END_OF_SCAN_CYCLE
 0x0002

	)

1009 
	#FAPI_REPORTMODE_REAL_TIME
 0x0004

	)

1010 
	#FAPI_REPORTMODE_NO_BATCH
 0x0008

	)

1012 
	#FAPI_RESULTCODE_SUCCESS
 0x0000

	)

1013 
	#FAPI_RESULTCODE_UNSPECIFIED_FAILURE
 0x0001

	)

1014 
	#FAPI_RESULTCODE_INVALID_PARAMETERS
 0x0026

	)

1015 
	#FAPI_RESULTCODE_REJECTED_INVALID_IE
 0x0028

	)

1016 
	#FAPI_RESULTCODE_NOT_ALLOWED
 0x0030

	)

1017 
	#FAPI_RESULTCODE_NOT_PRESENT
 0x0031

	)

1018 
	#FAPI_RESULTCODE_TRANSMISSION_FAILURE
 0x004f

	)

1019 
	#FAPI_RESULTCODE_TOO_MANY_SIMULTANEOUS_REQUESTS
 0x8001

	)

1020 
	#FAPI_RESULTCODE_BSS_ALREADY_STARTED_OR_JOINED
 0x8002

	)

1021 
	#FAPI_RESULTCODE_NOT_SUPPORTED
 0x8003

	)

1022 
	#FAPI_RESULTCODE_INVALID_STATE
 0x8004

	)

1023 
	#FAPI_RESULTCODE_INSUFFICIENT_RESOURCE
 0x8006

	)

1024 
	#FAPI_RESULTCODE_INVALID_VIRTUAL_INTERFACE_INDEX
 0x800a

	)

1025 
	#FAPI_RESULTCODE_HOST_REQUEST_SUCCESS
 0x800b

	)

1026 
	#FAPI_RESULTCODE_HOST_REQUEST_FAILED
 0x800c

	)

1027 
	#FAPI_RESULTCODE_INVALID_FREQUENCY
 0x800e

	)

1028 
	#FAPI_RESULTCODE_PROBE_TIMEOUT
 0x800f

	)

1029 
	#FAPI_RESULTCODE_AUTH_TIMEOUT
 0x8010

	)

1030 
	#FAPI_RESULTCODE_ASSOC_TIMEOUT
 0x8011

	)

1031 
	#FAPI_RESULTCODE_ASSOC_ABORT
 0x8012

	)

1032 
	#FAPI_RESULTCODE_AUTH_NO_ACK
 0x8013

	)

1033 
	#FAPI_RESULTCODE_ASSOC_NO_ACK
 0x8014

	)

1034 
	#FAPI_RESULTCODE_AUTH_TX_FAIL
 0x8015

	)

1035 
	#FAPI_RESULTCODE_ASSOC_TX_FAIL
 0x8016

	)

1036 
	#FAPI_RESULTCODE_AUTH_FAILED_CODE
 0x8100

	)

1037 
	#FAPI_RESULTCODE_ASSOC_FAILED_CODE
 0x8200

	)

1038 
	#FAPI_RESULTCODE_INVALID_TLV_VALUE
 0x9000

	)

1039 
	#FAPI_RESULTCODE_NAN_PROTOCOL_FAILURE
 0x9001

	)

1040 
	#FAPI_RESULTCODE_NAN_INVALID_SESSION_ID
 0x9002

	)

1041 
	#FAPI_RESULTCODE_NAN_INVALID_REQUESTOR_INSTANCE_ID
 0x9003

	)

1042 
	#FAPI_RESULTCODE_UNSUPPORTED_CONCURRENCY
 0x9004

	)

1043 
	#FAPI_RESULTCODE_NAN_INVALID_NDP_ID
 0x9005

	)

1044 
	#FAPI_RESULTCODE_NAN_INVALID_MATCH_ID
 0x9006

	)

1045 
	#FAPI_RESULTCODE_NAN_NO_OTA_ACK
 0x9007

	)

1046 
	#FAPI_RESULTCODE_NAN_INVALID_AVAILABILITY
 0x9008

	)

1047 
	#FAPI_RESULTCODE_NAN_IMMUTABLE_UNACCEPTABLE
 0x9009

	)

1048 
	#FAPI_RESULTCODE_NAN_REJECTED_SECURITY_POLICY
 0x900a

	)

1049 
	#FAPI_RESULTCODE_NDP_REJECTED
 0x900b

	)

1050 
	#FAPI_RESULTCODE_NDL_UNACCEPTABLE
 0x900c

	)

1051 
	#FAPI_RESULTCODE_NDL_FAILED_SCHEDULE
 0x900d

	)

1053 
	#FAPI_ROAMINGTYPE_LEGACY
 0x0000

	)

1054 
	#FAPI_ROAMINGTYPE_NCHO
 0x0001

	)

1056 
	#FAPI_RTTBANDWIDTH_20MHZ
 0x0004

	)

1057 
	#FAPI_RTTBANDWIDTH_40MHZ
 0x0008

	)

1058 
	#FAPI_RTTBANDWIDTH_80MHZ
 0x0010

	)

1059 
	#FAPI_RTTBANDWIDTH_160MHZ
 0x0020

	)

1061 
	#FAPI_RTTPEERTYPE_NOT_SPECIFIED
 0x00

	)

1062 
	#FAPI_RTTPEERTYPE_AP
 0x01

	)

1063 
	#FAPI_RTTPEERTYPE_STA
 0x02

	)

1064 
	#FAPI_RTTPEERTYPE_P2P_GO
 0x03

	)

1065 
	#FAPI_RTTPEERTYPE_P2P_CLIENT
 0x04

	)

1066 
	#FAPI_RTTPEERTYPE_NAN
 0x05

	)

1068 
	#FAPI_RTTPREAMBLE_LEGACY
 0x0001

	)

1069 
	#FAPI_RTTPREAMBLE_HT
 0x0002

	)

1070 
	#FAPI_RTTPREAMBLE_VHT
 0x0004

	)

1072 
	#FAPI_RTTSTATUS_SUCCESS
 0x0000

	)

1073 
	#FAPI_RTTSTATUS_UNSPECIFIED_FAILURE
 0x0001

	)

1074 
	#FAPI_RTTSTATUS_FAIL_NO_RESPONSE
 0x0002

	)

1075 
	#FAPI_RTTSTATUS_FAIL_REJECTED
 0x0003

	)

1076 
	#FAPI_RTTSTATUS_FAIL_NOT_SCHEDULED
 0x0004

	)

1077 
	#FAPI_RTTSTATUS_FAIL_TIMEOUT
 0x0005

	)

1078 
	#FAPI_RTTSTATUS_FAIL_INCORRECT_CHANNEL
 0x0006

	)

1079 
	#FAPI_RTTSTATUS_FAIL_FTM_NOT_SUPPORTED
 0x0007

	)

1080 
	#FAPI_RTTSTATUS_FAIL_MEASUREMENT_ABORTED
 0x0008

	)

1081 
	#FAPI_RTTSTATUS_FAIL_INVALID_TIME_STAMP
 0x0009

	)

1082 
	#FAPI_RTTSTATUS_FAIL_NO_FTM_RECEIVED
 0x000a

	)

1083 
	#FAPI_RTTSTATUS_FAIL_BURST_NOT_SCHEDULED
 0x000b

	)

1084 
	#FAPI_RTTSTATUS_FAIL_BUSY_TRY_LATER
 0x000c

	)

1085 
	#FAPI_RTTSTATUS_FAIL_INVALID_REQUEST
 0x000d

	)

1086 
	#FAPI_RTTSTATUS_FAIL_FTM_PARAMETER_OVERRIDE
 0x000f

	)

1088 
	#FAPI_RTTTYPE_ONE_SIDED
 0x01

	)

1089 
	#FAPI_RTTTYPE_TWO_SIDED
 0x02

	)

1091 
	#FAPI_RULEFLAG_NO_IR
 0x0001

	)

1092 
	#FAPI_RULEFLAG_DFS
 0x0002

	)

1093 
	#FAPI_RULEFLAG_NO_OFDM
 0x0004

	)

1094 
	#FAPI_RULEFLAG_NO_INDOOR
 0x0008

	)

1095 
	#FAPI_RULEFLAG_NO_OUTDOOR
 0x0010

	)

1097 
	#FAPI_RXSTARTFLAGS_NONE
 0x0000

	)

1098 
	#FAPI_RXSTARTFLAGS_SCAN_CHANNEL
 0x0001

	)

1099 
	#FAPI_RXSTARTFLAGS_FILTERING
 0x0002

	)

1100 
	#FAPI_RXSTARTFLAGS_BEAMFORMING
 0x0004

	)

1101 
	#FAPI_RXSTARTFLAGS_ACK
 0x0008

	)

1102 
	#FAPI_RXSTARTFLAGS_LP_MODE
 0x0010

	)

1103 
	#FAPI_RXSTARTFLAGS_CHAN_RSSI
 0x0020

	)

1104 
	#FAPI_RXSTARTFLAGS_DISABLE_EXTERNAL_LNA
 0x0040

	)

1105 
	#FAPI_RXSTARTFLAGS_VALIDATE
 0x0080

	)

1107 
	#FAPI_SCANMODE_LEGACY
 0x0000

	)

1108 
	#FAPI_SCANMODE_LOW_LATENCY
 0x0001

	)

1110 
	#FAPI_SCANPOLICY_PASSIVE
 0x01

	)

1111 
	#FAPI_SCANPOLICY_TEST_MODE
 0x02

	)

1112 
	#FAPI_SCANPOLICY_ANY_RA
 0x04

	)

1113 
	#FAPI_SCANPOLICY_2_4GHZ
 0x08

	)

1114 
	#FAPI_SCANPOLICY_5GHZ
 0x10

	)

1115 
	#FAPI_SCANPOLICY_NON_DFS
 0x20

	)

1116 
	#FAPI_SCANPOLICY_DFS
 0x40

	)

1117 
	#FAPI_SCANPOLICY_ON_CHANNEL
 0x80

	)

1119 
	#FAPI_SCANTYPE_INITIAL_SCAN
 0x0001

	)

1120 
	#FAPI_SCANTYPE_FULL_SCAN
 0x0002

	)

1121 
	#FAPI_SCANTYPE_SCHEDULED_SCAN
 0x0003

	)

1122 
	#FAPI_SCANTYPE_P2P_SCAN_FULL
 0x0004

	)

1123 
	#FAPI_SCANTYPE_P2P_SCAN_SOCIAL
 0x0005

	)

1124 
	#FAPI_SCANTYPE_OBSS_SCAN
 0x0006

	)

1125 
	#FAPI_SCANTYPE_AP_AUTO_CHANNEL_SELECTION
 0x0007

	)

1126 
	#FAPI_SCANTYPE_GSCAN
 0x0009

	)

1127 
	#FAPI_SCANTYPE_SINGLE_CHANNEL_SCAN
 0x000a

	)

1128 
	#FAPI_SCANTYPE_MEASUREMENT_SCAN
 0x0010

	)

1129 
	#FAPI_SCANTYPE_SOFT_CACHED_ROAMING_SCAN
 0x0011

	)

1130 
	#FAPI_SCANTYPE_SOFT_FULL_ROAMING_SCAN
 0x0012

	)

1131 
	#FAPI_SCANTYPE_HARD_CACHED_ROAMING_SCAN
 0x0013

	)

1132 
	#FAPI_SCANTYPE_HARD_FULL_ROAMING_SCAN
 0x0014

	)

1133 
	#FAPI_SCANTYPE_OBSS_SCAN_INTERNAL
 0x0015

	)

1134 
	#FAPI_SCANTYPE_NAN_SCAN
 0x0016

	)

1135 
	#FAPI_SCANTYPE_FTM_NEIGHBOUR_SCAN
 0x0017

	)

1136 
	#FAPI_SCANTYPE_OBSS_NARROW_BW_SCAN
 0x0018

	)

1137 
	#FAPI_SCANTYPE_FIRST_ILLEGAL
 0x0019

	)

1139 
	#FAPI_STATSSTOPBITMAP_STATS_RADIO
 0x0001

	)

1140 
	#FAPI_STATSSTOPBITMAP_STATS_RADIO_CCA
 0x0002

	)

1141 
	#FAPI_STATSSTOPBITMAP_STATS_RADIO_CHANNELS
 0x0004

	)

1142 
	#FAPI_STATSSTOPBITMAP_STATS_RADIO_SCAN
 0x0008

	)

1143 
	#FAPI_STATSSTOPBITMAP_STATS_IFACE
 0x0010

	)

1144 
	#FAPI_STATSSTOPBITMAP_STATS_IFACE_TXRATE
 0x0020

	)

1145 
	#FAPI_STATSSTOPBITMAP_STATS_IFACE_AC
 0x0040

	)

1146 
	#FAPI_STATSSTOPBITMAP_STATS_IFACE_CONTENSION
 0x0080

	)

1148 
	#FAPI_TDLSACTION_DISCOVERY
 0x0000

	)

1149 
	#FAPI_TDLSACTION_SETUP
 0x0001

	)

1150 
	#FAPI_TDLSACTION_TEARDOWN
 0x0002

	)

1152 
	#FAPI_TDLSEVENT_CONNECTED
 0x0001

	)

1153 
	#FAPI_TDLSEVENT_DISCONNECTED
 0x0002

	)

1154 
	#FAPI_TDLSEVENT_DISCOVERED
 0x0003

	)

1156 
	#FAPI_TRANSMISSIONSTATUS_SUCCESSFUL
 0x0000

	)

1157 
	#FAPI_TRANSMISSIONSTATUS_RETRY_LIMIT
 0x0001

	)

1158 
	#FAPI_TRANSMISSIONSTATUS_UNSPECIFIED_FAILURE1
 0x00010

	)

1159 
	#FAPI_TRANSMISSIONSTATUS_UNSPECIFIED_FAILURE2
 0x00011

	)

1160 
	#FAPI_TRANSMISSIONSTATUS_UNSPECIFIED_FAILURE3
 0x00012

	)

1161 
	#FAPI_TRANSMISSIONSTATUS_UNSPECIFIED_FAILURE4
 0x00013

	)

1162 
	#FAPI_TRANSMISSIONSTATUS_UNSPECIFIED_FAILURE5
 0x00014

	)

1163 
	#FAPI_TRANSMISSIONSTATUS_UNSPECIFIED_FAILURE6
 0x00015

	)

1164 
	#FAPI_TRANSMISSIONSTATUS_TX_LIFETIME
 0x0002

	)

1165 
	#FAPI_TRANSMISSIONSTATUS_NO_BSS
 0x0003

	)

1166 
	#FAPI_TRANSMISSIONSTATUS_EXCESSIVE_DATA_LENGTH
 0x0004

	)

1167 
	#FAPI_TRANSMISSIONSTATUS_UNAVAILABLE_KEY_MAPPING
 0x0005

	)

1168 
	#FAPI_TRANSMISSIONSTATUS_UNSPECIFIED_FAILURE
 0x0006

	)

1169 
	#FAPI_TRANSMISSIONSTATUS_DATA_RETRY_LIMIT
 0x0007

	)

1170 
	#FAPI_TRANSMISSIONSTATUS_NON_DATA_RETRY_LIMIT
 0x0008

	)

1171 
	#FAPI_TRANSMISSIONSTATUS_DATA_TX_LIFETIME
 0x0009

	)

1172 
	#FAPI_TRANSMISSIONSTATUS_NON_DATA_TX_LIFETIME
 0x000a

	)

1173 
	#FAPI_TRANSMISSIONSTATUS_DATA_CANCELLED
 0x000b

	)

1174 
	#FAPI_TRANSMISSIONSTATUS_NON_DATA_CANCELLED
 0x000c

	)

1176 
	#FAPI_TXDATATYPE_DATA_WORD
 0x0000

	)

1177 
	#FAPI_TXDATATYPE_DATA_RANDOM
 0x0001

	)

1178 
	#FAPI_TXDATATYPE_DATA_CUSTOM
 0x0002

	)

1180 
	#FAPI_TXHEMODE_HE_SU
 0x0000

	)

1181 
	#FAPI_TXHEMODE_HE_ER_SU
 0x0001

	)

1182 
	#FAPI_TXHEMODE_HE_ER_SU_10MHZ
 0x0002

	)

1183 
	#FAPI_TXHEMODE_HE_MU_TB_STANDALONE
 0x0003

	)

1184 
	#FAPI_TXHEMODE_HE_MU_TB
 0x0004

	)

1186 
	#FAPI_TXREADFLAGS_NONE
 0x0000

	)

1187 
	#FAPI_TXREADFLAGS_FRAME_COUNTING
 0x0001

	)

1188 
	#FAPI_TXREADFLAGS_THERMAL_CUTOUT
 0x0002

	)

1190 
	#FAPI_TXSETPARAMSFLAGS_NONE
 0x0000

	)

1191 
	#FAPI_TXSETPARAMSFLAGS_ACK
 0x0001

	)

1192 
	#FAPI_TXSETPARAMSFLAGS_DUPLICATE_80
 0x0002

	)

1193 
	#FAPI_TXSETPARAMSFLAGS_DUPLICATE_40
 0x0004

	)

1194 
	#FAPI_TXSETPARAMSFLAGS_DEAFEN_RX
 0x0008

	)

1195 
	#FAPI_TXSETPARAMSFLAGS_CS
 0x0010

	)

1196 
	#FAPI_TXSETPARAMSFLAGS_SCAN_CHANNEL
 0x0020

	)

1197 
	#FAPI_TXSETPARAMSFLAGS_SHORT_PREAMBLE
 0x0040

	)

1198 
	#FAPI_TXSETPARAMSFLAGS_DISABLE_SCRAMBLER
 0x0080

	)

1199 
	#FAPI_TXSETPARAMSFLAGS_LDPC
 0x0100

	)

1200 
	#FAPI_TXSETPARAMSFLAGS_STBC
 0x0200

	)

1201 
	#FAPI_TXSETPARAMSFLAGS_DISABLE_SPREADER
 0x0400

	)

1202 
	#FAPI_TXSETPARAMSFLAGS_GREENFIELD_PREAMBLE
 0x0800

	)

1203 
	#FAPI_TXSETPARAMSFLAGS_RX_LOW_POWER
 0x1000

	)

1204 
	#FAPI_TXSETPARAMSFLAGS_IBSS_FRAMES
 0x2000

	)

1205 
	#FAPI_TXSETPARAMSFLAGS_BEAMFORMING
 0x4000

	)

1206 
	#FAPI_TXSETPARAMSFLAGS_DISABLE_EXTERNAL_LNA
 0x8000

	)

1208 
	#FAPI_TXSETPARAMSFLAGS2_NONE
 0x0000

	)

1209 
	#FAPI_TXSETPARAMSFLAGS2_IFS
 0x0001

	)

1210 
	#FAPI_TXSETPARAMSFLAGS2_VALIDATE
 0x0002

	)

1212 
	#FAPI_TYPEOFAIRPOWER_EIRP
 0x00

	)

1213 
	#FAPI_TYPEOFAIRPOWER_TPO
 0x01

	)

1214 
	#FAPI_TYPEOFAIRPOWER_RAW
 0x02

	)

1216 
	#FAPI_USAGE_NO_USE
 0x0

	)

1217 
	#FAPI_USAGE_USE
 0x1

	)

1219 
	#FAPI_VIFRANGE_VIF_INDEX_MIN
 0x0001

	)

1220 
	#FAPI_VIFRANGE_VIF_INDEX_MAX
 0x000f

	)

1222 
	#FAPI_VIFTYPE_UNSYNCHRONISED
 0x0000

	)

1223 
	#FAPI_VIFTYPE_STATION
 0x0002

	)

1224 
	#FAPI_VIFTYPE_AP
 0x0003

	)

1225 
	#FAPI_VIFTYPE_WLANLITE
 0x0004

	)

1226 
	#FAPI_VIFTYPE_NAN
 0x0005

	)

1227 
	#FAPI_VIFTYPE_DISCOVERY
 0x0006

	)

1228 
	#FAPI_VIFTYPE_PRECONNECT
 0x0007

	)

1229 
	#FAPI_VIFTYPE_DETECT
 0x0008

	)

1230 
	#FAPI_VIFTYPE_MONITOR
 0x0010

	)

1231 
	#FAPI_VIFTYPE_SCAN
 0x0020

	)

1232 
	#FAPI_VIFTYPE_OFFCHANNEL
 0x0021

	)

1233 
	#FAPI_VIFTYPE_RANGE
 0x0022

	)

1235 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_20MHZ_PRIMARYCHANNELPOSITION_P0
 0x0000

	)

1236 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_20MHZ_PRIMARYCHANNELPOSITION_P1
 0x0001

	)

1237 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_20MHZ_PRIMARYCHANNELPOSITION_P2
 0x0002

	)

1238 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_20MHZ_PRIMARYCHANNELPOSITION_P3
 0x0003

	)

1239 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_20MHZ_PRIMARYCHANNELPOSITION_P4
 0x0004

	)

1240 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_20MHZ_PRIMARYCHANNELPOSITION_P5
 0x0005

	)

1241 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_20MHZ_PRIMARYCHANNELPOSITION_P6
 0x0006

	)

1242 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_20MHZ_PRIMARYCHANNELPOSITION_P7
 0x0007

	)

1243 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_20MHZ_PRIMARYCHANNELPOSITION_NOT_APPLICABLE
 0x0008

	)

1244 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_40MHZ_PRIMARYCHANNELPOSITION_P0
 0x0100

	)

1245 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_40MHZ_PRIMARYCHANNELPOSITION_P1
 0x0101

	)

1246 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_40MHZ_PRIMARYCHANNELPOSITION_P2
 0x0102

	)

1247 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_40MHZ_PRIMARYCHANNELPOSITION_P3
 0x0103

	)

1248 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_40MHZ_PRIMARYCHANNELPOSITION_P4
 0x0104

	)

1249 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_40MHZ_PRIMARYCHANNELPOSITION_P5
 0x0105

	)

1250 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_40MHZ_PRIMARYCHANNELPOSITION_P6
 0x0106

	)

1251 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_40MHZ_PRIMARYCHANNELPOSITION_P7
 0x0107

	)

1252 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_40MHZ_PRIMARYCHANNELPOSITION_NOT_APPLICABLE
 0x0108

	)

1253 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_80MHZ_PRIMARYCHANNELPOSITION_P0
 0x0200

	)

1254 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_80MHZ_PRIMARYCHANNELPOSITION_P1
 0x0201

	)

1255 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_80MHZ_PRIMARYCHANNELPOSITION_P2
 0x0202

	)

1256 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_80MHZ_PRIMARYCHANNELPOSITION_P3
 0x0203

	)

1257 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_80MHZ_PRIMARYCHANNELPOSITION_P4
 0x0204

	)

1258 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_80MHZ_PRIMARYCHANNELPOSITION_P5
 0x0205

	)

1259 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_80MHZ_PRIMARYCHANNELPOSITION_P6
 0x0206

	)

1260 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_80MHZ_PRIMARYCHANNELPOSITION_P7
 0x0207

	)

1261 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_80MHZ_PRIMARYCHANNELPOSITION_NOT_APPLICABLE
 0x0208

	)

1262 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_160MHZ_PRIMARYCHANNELPOSITION_P0
 0x0300

	)

1263 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_160MHZ_PRIMARYCHANNELPOSITION_P1
 0x0301

	)

1264 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_160MHZ_PRIMARYCHANNELPOSITION_P2
 0x0302

	)

1265 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_160MHZ_PRIMARYCHANNELPOSITION_P3
 0x0303

	)

1266 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_160MHZ_PRIMARYCHANNELPOSITION_P4
 0x0304

	)

1267 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_160MHZ_PRIMARYCHANNELPOSITION_P5
 0x0305

	)

1268 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_160MHZ_PRIMARYCHANNELPOSITION_P6
 0x0306

	)

1269 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_160MHZ_PRIMARYCHANNELPOSITION_P7
 0x0307

	)

1270 
	#FAPI_CHANNELBANDWIDTH_BANDWIDTH_160MHZ_PRIMARYCHANNELPOSITION_NOT_APPLICABLE
 0x0308

	)

1272 
	#MA_UNITDATA_REQ
 0x1000

	)

1273 
	#MA_SPARE_1_REQ
 0x1002

	)

1274 
	#MA_SPARE_2_REQ
 0x1003

	)

1275 
	#MA_SPARE_3_REQ
 0x1004

	)

1276 
	#MA_SPARE_SIGNAL_1_REQ
 0x1005

	)

1277 
	#MA_SPARE_SIGNAL_2_REQ
 0x1006

	)

1278 
	#MA_SPARE_SIGNAL_3_REQ
 0x1007

	)

1279 
	#MA_UNITDATA_CFM
 0x1100

	)

1280 
	#MA_SPARE_1_CFM
 0x1102

	)

1281 
	#MA_SPARE_2_CFM
 0x1103

	)

1282 
	#MA_SPARE_3_CFM
 0x1104

	)

1283 
	#MA_SPARE_SIGNAL_1_CFM
 0x1105

	)

1284 
	#MA_SPARE_SIGNAL_2_CFM
 0x1106

	)

1285 
	#MA_SPARE_SIGNAL_3_CFM
 0x1107

	)

1286 
	#MA_SPARE_1_RES
 0x1200

	)

1287 
	#MA_SPARE_2_RES
 0x1201

	)

1288 
	#MA_SPARE_3_RES
 0x1202

	)

1289 
	#MA_SPARE_SIGNAL_1_RES
 0x1203

	)

1290 
	#MA_SPARE_SIGNAL_2_RES
 0x1204

	)

1291 
	#MA_SPARE_SIGNAL_3_RES
 0x1205

	)

1292 
	#MA_UNITDATA_IND
 0x1300

	)

1293 
	#MA_BLOCKACK_IND
 0x1301

	)

1294 
	#MA_SPARE_1_IND
 0x1302

	)

1295 
	#MA_SPARE_2_IND
 0x1303

	)

1296 
	#MA_SPARE_3_IND
 0x1304

	)

1297 
	#MA_SPARE_SIGNAL_1_IND
 0x1305

	)

1298 
	#MA_SPARE_SIGNAL_2_IND
 0x1306

	)

1299 
	#MA_SPARE_SIGNAL_3_IND
 0x1307

	)

1300 
	#MLME_GET_REQ
 0x2001

	)

1301 
	#MLME_SET_REQ
 0x2002

	)

1302 
	#MLME_POWERMGT_REQ
 0x2003

	)

1303 
	#MLME_ADD_INFO_ELEMENTS_REQ
 0x2004

	)

1304 
	#MLME_ADD_SCAN_REQ
 0x2005

	)

1305 
	#MLME_DEL_SCAN_REQ
 0x2006

	)

1306 
	#MLME_ADD_VIF_REQ
 0x2007

	)

1307 
	#MLME_DEL_VIF_REQ
 0x2008

	)

1308 
	#MLME_START_REQ
 0x2009

	)

1309 
	#MLME_SET_CHANNEL_REQ
 0x200a

	)

1310 
	#MLME_CONNECT_REQ
 0x200b

	)

1311 
	#MLME_REASSOCIATE_REQ
 0x200c

	)

1312 
	#MLME_ROAM_REQ
 0x200d

	)

1313 
	#MLME_DISCONNECT_REQ
 0x200e

	)

1314 
	#MLME_REGISTER_ACTION_FRAME_REQ
 0x200f

	)

1315 
	#MLME_SEND_FRAME_REQ
 0x2010

	)

1316 
	#MLME_RESET_DWELL_TIME_REQ
 0x2011

	)

1317 
	#MLME_SET_TRAFFIC_PARAMETERS_REQ
 0x2012

	)

1318 
	#MLME_DEL_TRAFFIC_PARAMETERS_REQ
 0x2013

	)

1319 
	#MLME_SET_PACKET_FILTER_REQ
 0x2014

	)

1320 
	#MLME_SET_IP_ADDRESS_REQ
 0x2015

	)

1321 
	#MLME_SET_ACL_REQ
 0x2016

	)

1322 
	#MLME_SETKEYS_REQ
 0x2018

	)

1323 
	#MLME_GET_KEY_SEQUENCE_REQ
 0x201a

	)

1324 
	#MLME_SET_PMK_REQ
 0x201c

	)

1325 
	#MLME_SET_CACHED_CHANNELS_REQ
 0x201f

	)

1326 
	#MLME_SET_WHITELIST_SSID_REQ
 0x2020

	)

1327 
	#MLME_TDLS_ACTION_REQ
 0x2021

	)

1328 
	#MLME_CHANNEL_SWITCH_REQ
 0x2022

	)

1329 
	#MLME_MONITOR_RSSI_REQ
 0x2023

	)

1330 
	#MLME_START_LINK_STATISTICS_REQ
 0x2024

	)

1331 
	#MLME_STOP_LINK_STATISTICS_REQ
 0x2025

	)

1332 
	#MLME_SET_PNO_LIST_REQ
 0x2027

	)

1333 
	#MLME_HOST_STATE_REQ
 0x2028

	)

1334 
	#MLME_ADD_RANGE_REQ
 0x2029

	)

1335 
	#MLME_DEL_RANGE_REQ
 0x202a

	)

1336 
	#MLME_SET_NOA_REQ
 0x202b

	)

1337 
	#MLME_SET_CTWINDOW_REQ
 0x202c

	)

1338 
	#MLME_NAN_START_REQ
 0x202d

	)

1339 
	#MLME_NAN_CONFIG_REQ
 0x202e

	)

1340 
	#MLME_NAN_PUBLISH_REQ
 0x202f

	)

1341 
	#MLME_NAN_SUBSCRIBE_REQ
 0x2030

	)

1342 
	#MLME_NAN_FOLLOWUP_REQ
 0x2031

	)

1343 
	#MLME_UNSET_CHANNEL_REQ
 0x2032

	)

1344 
	#MLME_SET_COUNTRY_REQ
 0x2033

	)

1345 
	#MLME_FORWARD_BEACON_REQ
 0x2034

	)

1346 
	#MLME_NDP_REQUEST_REQ
 0x2035

	)

1347 
	#MLME_NDP_RESPONSE_REQ
 0x2036

	)

1348 
	#MLME_NDP_TERMINATE_REQ
 0x2037

	)

1349 
	#MLME_ROAMING_CHANNEL_LIST_REQ
 0x203a

	)

1350 
	#MLME_SET_BSS_MAX_CHANNEL_WIDTH_REQ
 0x203b

	)

1351 
	#MLME_SET_SCAN_MODE_REQ
 0x203c

	)

1352 
	#MLME_INSTALL_APF_REQ
 0x203d

	)

1353 
	#MLME_READ_APF_REQ
 0x203e

	)

1354 
	#MLME_SET_NUM_ANTENNAS_REQ
 0x203f

	)

1355 
	#MLME_ARP_DETECT_REQ
 0x2040

	)

1356 
	#MLME_SET_ROAMING_TYPE_REQ
 0x2041

	)

1357 
	#MLME_SET_BAND_REQ
 0x2042

	)

1358 
	#MLME_SET_ROAMING_PARAMETERS_REQ
 0x2043

	)

1359 
	#MLME_WIFISHARING_PERMITTED_CHANNELS_REQ
 0x2044

	)

1360 
	#MLME_SPARE_7_REQ
 0x2045

	)

1361 
	#MLME_SPARE_8_REQ
 0x2046

	)

1362 
	#MLME_CONFIGURE_MONITOR_MODE_REQ
 0x2047

	)

1363 
	#MLME_SPARE_9_REQ
 0x2048

	)

1364 
	#MLME_SPARE_10_REQ
 0x2049

	)

1365 
	#MLME_SPARE_11_REQ
 0x204a

	)

1366 
	#MLME_NAN_RANGE_REQ
 0x204b

	)

1367 
	#MLME_NAN_RANGE_CANCEL_REQ
 0x204c

	)

1368 
	#MLME_DELBA_REQ
 0x204d

	)

1369 
	#MLME_GET_NUM_ANTENNAS_REQ
 0x204e

	)

1370 
	#MLME_START_DETECT_REQ
 0x204f

	)

1371 
	#MLME_SPARE_SIGNAL_1_REQ
 0x2050

	)

1372 
	#MLME_SPARE_SIGNAL_2_REQ
 0x2051

	)

1373 
	#MLME_SPARE_SIGNAL_3_REQ
 0x2052

	)

1374 
	#MLME_GET_CFM
 0x2101

	)

1375 
	#MLME_SET_CFM
 0x2102

	)

1376 
	#MLME_POWERMGT_CFM
 0x2103

	)

1377 
	#MLME_ADD_INFO_ELEMENTS_CFM
 0x2104

	)

1378 
	#MLME_ADD_SCAN_CFM
 0x2105

	)

1379 
	#MLME_DEL_SCAN_CFM
 0x2106

	)

1380 
	#MLME_ADD_VIF_CFM
 0x2107

	)

1381 
	#MLME_DEL_VIF_CFM
 0x2108

	)

1382 
	#MLME_START_CFM
 0x2109

	)

1383 
	#MLME_SET_CHANNEL_CFM
 0x210a

	)

1384 
	#MLME_CONNECT_CFM
 0x210b

	)

1385 
	#MLME_REASSOCIATE_CFM
 0x210c

	)

1386 
	#MLME_ROAM_CFM
 0x210d

	)

1387 
	#MLME_DISCONNECT_CFM
 0x210e

	)

1388 
	#MLME_REGISTER_ACTION_FRAME_CFM
 0x210f

	)

1389 
	#MLME_SEND_FRAME_CFM
 0x2110

	)

1390 
	#MLME_RESET_DWELL_TIME_CFM
 0x2111

	)

1391 
	#MLME_SET_TRAFFIC_PARAMETERS_CFM
 0x2112

	)

1392 
	#MLME_DEL_TRAFFIC_PARAMETERS_CFM
 0x2113

	)

1393 
	#MLME_SET_PACKET_FILTER_CFM
 0x2114

	)

1394 
	#MLME_SET_IP_ADDRESS_CFM
 0x2115

	)

1395 
	#MLME_SET_ACL_CFM
 0x2116

	)

1396 
	#MLME_SETKEYS_CFM
 0x2118

	)

1397 
	#MLME_GET_KEY_SEQUENCE_CFM
 0x211a

	)

1398 
	#MLME_SET_PMK_CFM
 0x211c

	)

1399 
	#MLME_SET_CACHED_CHANNELS_CFM
 0x211f

	)

1400 
	#MLME_SET_WHITELIST_SSID_CFM
 0x2120

	)

1401 
	#MLME_TDLS_ACTION_CFM
 0x2121

	)

1402 
	#MLME_CHANNEL_SWITCH_CFM
 0x2122

	)

1403 
	#MLME_MONITOR_RSSI_CFM
 0x2123

	)

1404 
	#MLME_START_LINK_STATISTICS_CFM
 0x2124

	)

1405 
	#MLME_STOP_LINK_STATISTICS_CFM
 0x2125

	)

1406 
	#MLME_SET_PNO_LIST_CFM
 0x2127

	)

1407 
	#MLME_HOST_STATE_CFM
 0x2128

	)

1408 
	#MLME_ADD_RANGE_CFM
 0x2129

	)

1409 
	#MLME_DEL_RANGE_CFM
 0x212a

	)

1410 
	#MLME_SET_NOA_CFM
 0x212b

	)

1411 
	#MLME_SET_CTWINDOW_CFM
 0x212c

	)

1412 
	#MLME_NAN_START_CFM
 0x212d

	)

1413 
	#MLME_NAN_CONFIG_CFM
 0x212e

	)

1414 
	#MLME_NAN_PUBLISH_CFM
 0x212f

	)

1415 
	#MLME_NAN_SUBSCRIBE_CFM
 0x2130

	)

1416 
	#MLME_NAN_FOLLOWUP_CFM
 0x2131

	)

1417 
	#MLME_UNSET_CHANNEL_CFM
 0x2132

	)

1418 
	#MLME_SET_COUNTRY_CFM
 0x2133

	)

1419 
	#MLME_FORWARD_BEACON_CFM
 0x2134

	)

1420 
	#MLME_NDP_REQUEST_CFM
 0x2135

	)

1421 
	#MLME_NDP_RESPONSE_CFM
 0x2136

	)

1422 
	#MLME_NDP_TERMINATE_CFM
 0x2137

	)

1423 
	#MLME_ROAMING_CHANNEL_LIST_CFM
 0x213a

	)

1424 
	#MLME_SET_BSS_MAX_CHANNEL_WIDTH_CFM
 0x213b

	)

1425 
	#MLME_SET_SCAN_MODE_CFM
 0x213c

	)

1426 
	#MLME_INSTALL_APF_CFM
 0x213d

	)

1427 
	#MLME_READ_APF_CFM
 0x213e

	)

1428 
	#MLME_SET_NUM_ANTENNAS_CFM
 0x213f

	)

1429 
	#MLME_ARP_DETECT_CFM
 0x2140

	)

1430 
	#MLME_SET_ROAMING_TYPE_CFM
 0x2141

	)

1431 
	#MLME_SET_BAND_CFM
 0x2142

	)

1432 
	#MLME_SET_ROAMING_PARAMETERS_CFM
 0x2143

	)

1433 
	#MLME_WIFISHARING_PERMITTED_CHANNELS_CFM
 0x2144

	)

1434 
	#MLME_SPARE_7_CFM
 0x2145

	)

1435 
	#MLME_SPARE_8_CFM
 0x2146

	)

1436 
	#MLME_CONFIGURE_MONITOR_MODE_CFM
 0x2147

	)

1437 
	#MLME_SPARE_9_CFM
 0x2148

	)

1438 
	#MLME_SPARE_10_CFM
 0x2149

	)

1439 
	#MLME_SPARE_11_CFM
 0x214a

	)

1440 
	#MLME_NAN_RANGE_CFM
 0x214b

	)

1441 
	#MLME_NAN_RANGE_CANCEL_CFM
 0x214c

	)

1442 
	#MLME_DELBA_CFM
 0x214d

	)

1443 
	#MLME_GET_NUM_ANTENNAS_CFM
 0x214e

	)

1444 
	#MLME_START_DETECT_CFM
 0x214f

	)

1445 
	#MLME_SPARE_SIGNAL_1_CFM
 0x2150

	)

1446 
	#MLME_SPARE_SIGNAL_2_CFM
 0x2151

	)

1447 
	#MLME_SPARE_SIGNAL_3_CFM
 0x2152

	)

1448 
	#MLME_CONNECT_RES
 0x2200

	)

1449 
	#MLME_CONNECTED_RES
 0x2201

	)

1450 
	#MLME_REASSOCIATE_RES
 0x2202

	)

1451 
	#MLME_ROAMED_RES
 0x2203

	)

1452 
	#MLME_TDLS_PEER_RES
 0x2204

	)

1453 
	#MLME_SYNCHRONISED_RES
 0x2205

	)

1454 
	#MLME_SPARE_2_RES
 0x2206

	)

1455 
	#MLME_SPARE_3_RES
 0x2207

	)

1456 
	#MLME_SPARE_4_RES
 0x2208

	)

1457 
	#MLME_SPARE_SIGNAL_1_RES
 0x2209

	)

1458 
	#MLME_SPARE_SIGNAL_2_RES
 0x220a

	)

1459 
	#MLME_SPARE_SIGNAL_3_RES
 0x220b

	)

1460 
	#MLME_SCAN_IND
 0x2300

	)

1461 
	#MLME_SCAN_DONE_IND
 0x2301

	)

1462 
	#MLME_LISTEN_END_IND
 0x2302

	)

1463 
	#MLME_CONNECT_IND
 0x2303

	)

1464 
	#MLME_CONNECTED_IND
 0x2304

	)

1465 
	#MLME_REASSOCIATE_IND
 0x2305

	)

1466 
	#MLME_ROAM_IND
 0x2306

	)

1467 
	#MLME_ROAMED_IND
 0x2307

	)

1468 
	#MLME_DISCONNECT_IND
 0x2308

	)

1469 
	#MLME_DISCONNECTED_IND
 0x2309

	)

1470 
	#MLME_PROCEDURE_STARTED_IND
 0x230a

	)

1471 
	#MLME_MIC_FAILURE_IND
 0x230b

	)

1472 
	#MLME_FRAME_TRANSMISSION_IND
 0x230c

	)

1473 
	#MLME_RECEIVED_FRAME_IND
 0x230d

	)

1474 
	#MLME_TDLS_PEER_IND
 0x230f

	)

1475 
	#MLME_RSSI_REPORT_IND
 0x2312

	)

1476 
	#MLME_AC_PRIORITY_UPDATE_IND
 0x2313

	)

1477 
	#MLME_RANGE_IND
 0x2314

	)

1478 
	#MLME_RANGE_DONE_IND
 0x2315

	)

1479 
	#MLME_EVENT_LOG_IND
 0x2316

	)

1480 
	#MLME_NAN_EVENT_IND
 0x2317

	)

1481 
	#MLME_NAN_SERVICE_IND
 0x2318

	)

1482 
	#MLME_NAN_FOLLOWUP_IND
 0x2319

	)

1483 
	#MLME_CHANNEL_SWITCHED_IND
 0x231a

	)

1484 
	#MLME_SYNCHRONISED_IND
 0x231b

	)

1485 
	#MLME_BEACON_REPORTING_EVENT_IND
 0x231c

	)

1486 
	#MLME_ROAMING_CHANNEL_LIST_IND
 0x231d

	)

1487 
	#MLME_BLACKLISTED_IND
 0x231e

	)

1488 
	#MLME_NDP_REQUEST_IND
 0x231f

	)

1489 
	#MLME_NDP_REQUESTED_IND
 0x2320

	)

1490 
	#MLME_NDP_RESPONSE_IND
 0x2321

	)

1491 
	#MLME_NDP_TERMINATED_IND
 0x2323

	)

1492 
	#MLME_SPARE_5_IND
 0x2324

	)

1493 
	#MLME_SPARE_6_IND
 0x2325

	)

1494 
	#MLME_NAN_RANGE_IND
 0x2326

	)

1495 
	#MLME_SPARE_7_IND
 0x2327

	)

1496 
	#MLME_START_DETECT_IND
 0x2328

	)

1497 
	#MLME_SPARE_SIGNAL_1_IND
 0x2329

	)

1498 
	#MLME_SPARE_SIGNAL_2_IND
 0x232a

	)

1499 
	#MLME_SPARE_SIGNAL_3_IND
 0x232b

	)

1500 
	#DEBUG_SPARE_1_REQ
 0x8000

	)

1501 
	#DEBUG_SPARE_2_REQ
 0x8001

	)

1502 
	#DEBUG_SPARE_3_REQ
 0x8002

	)

1503 
	#DEBUG_SPARE_SIGNAL_1_REQ
 0x8003

	)

1504 
	#DEBUG_SPARE_SIGNAL_2_REQ
 0x8004

	)

1505 
	#DEBUG_SPARE_SIGNAL_3_REQ
 0x8005

	)

1506 
	#DEBUG_SPARE_1_CFM
 0x8100

	)

1507 
	#DEBUG_SPARE_2_CFM
 0x8101

	)

1508 
	#DEBUG_SPARE_3_CFM
 0x8102

	)

1509 
	#DEBUG_SPARE_SIGNAL_1_CFM
 0x8103

	)

1510 
	#DEBUG_SPARE_SIGNAL_2_CFM
 0x8104

	)

1511 
	#DEBUG_SPARE_SIGNAL_3_CFM
 0x8105

	)

1512 
	#DEBUG_SPARE_1_RES
 0x8200

	)

1513 
	#DEBUG_SPARE_2_RES
 0x8201

	)

1514 
	#DEBUG_SPARE_3_RES
 0x8202

	)

1515 
	#DEBUG_SPARE_SIGNAL_1_RES
 0x8203

	)

1516 
	#DEBUG_SPARE_SIGNAL_2_RES
 0x8204

	)

1517 
	#DEBUG_SPARE_SIGNAL_3_RES
 0x8205

	)

1518 
	#DEBUG_WORD12IND
 0x8301

	)

1519 
	#DEBUG_FAULT_IND
 0x8302

	)

1520 
	#DEBUG_WORDS_IND
 0x8303

	)

1521 
	#DEBUG_SPARE_2_IND
 0x8304

	)

1522 
	#DEBUG_SPARE_3_IND
 0x8305

	)

1523 
	#DEBUG_SPARE_4_IND
 0x8306

	)

1524 
	#DEBUG_SPARE_SIGNAL_1_IND
 0x8307

	)

1525 
	#DEBUG_SPARE_SIGNAL_2_IND
 0x8308

	)

1526 
	#DEBUG_SPARE_SIGNAL_3_IND
 0x8309

	)

1527 
	#TEST_BLOCK_REQUESTS_REQ
 0x9000

	)

1528 
	#TEST_PANIC_REQ
 0x9001

	)

1529 
	#TEST_SUSPEND_REQ
 0x9002

	)

1530 
	#TEST_RESUME_REQ
 0x9003

	)

1531 
	#RADIO_LOGGING_REQ
 0x9004

	)

1532 
	#WLANLITE_CW_START_REQ
 0x9005

	)

1533 
	#WLANLITE_CW_STOP_REQ
 0x9006

	)

1534 
	#WLANLITE_TX_SET_PARAMS_REQ
 0x9007

	)

1535 
	#WLANLITE_TX_START_REQ
 0x9008

	)

1536 
	#WLANLITE_TX_READ_REQ
 0x9009

	)

1537 
	#WLANLITE_TX_STOP_REQ
 0x900a

	)

1538 
	#WLANLITE_RX_START_REQ
 0x900b

	)

1539 
	#WLANLITE_RX_READ_REQ
 0x900c

	)

1540 
	#WLANLITE_RX_STOP_REQ
 0x900d

	)

1541 
	#WLANLITE_STATUS_REQ
 0x900e

	)

1542 
	#TEST_PMALLOC_REQ
 0x900f

	)

1543 
	#TEST_CONFIGURE_MONITOR_MODE_REQ
 0x9010

	)

1544 
	#TEST_CHECK_FW_ALIVE_REQ
 0x9012

	)

1545 
	#DEBUG_GENERIC_REQ
 0x9013

	)

1546 
	#DEBUG_PKT_SINK_START_REQ
 0x9014

	)

1547 
	#DEBUG_PKT_SINK_STOP_REQ
 0x9015

	)

1548 
	#DEBUG_PKT_SINK_REPORT_REQ
 0x9016

	)

1549 
	#DEBUG_PKT_GEN_START_REQ
 0x9017

	)

1550 
	#DEBUG_PKT_GEN_STOP_REQ
 0x9018

	)

1551 
	#DEBUG_PKT_GEN_REPORT_REQ
 0x9019

	)

1552 
	#WLANLITE_RADIO_SELECT_REQ
 0x901a

	)

1553 
	#TEST_HIP_TESTER_START_REQ
 0x901b

	)

1554 
	#TEST_HIP_TESTER_STOP_REQ
 0x901c

	)

1555 
	#TEST_HIP_TESTER_SET_PARAMS_REQ
 0x901d

	)

1556 
	#TEST_HIP_TESTER_REPORT_REQ
 0x901e

	)

1557 
	#TEST_BIST_GET_TX_GAIN_REQ
 0x901f

	)

1558 
	#TEST_START_WLANLITE_REQ
 0x9020

	)

1559 
	#TEST_SPARE_2_REQ
 0x9021

	)

1560 
	#TEST_SPARE_3_REQ
 0x9022

	)

1561 
	#PHY_EVENT_LOGGING_REQ
 0x9023

	)

1562 
	#TEST_SPARE_SIGNAL_1_REQ
 0x9024

	)

1563 
	#TEST_SPARE_SIGNAL_2_REQ
 0x9025

	)

1564 
	#TEST_SPARE_SIGNAL_3_REQ
 0x9026

	)

1565 
	#RADIO_LOGGING_CFM
 0x9100

	)

1566 
	#WLANLITE_CW_START_CFM
 0x9101

	)

1567 
	#WLANLITE_TX_SET_PARAMS_CFM
 0x9102

	)

1568 
	#WLANLITE_CW_STOP_CFM
 0x9103

	)

1569 
	#WLANLITE_TX_START_CFM
 0x9104

	)

1570 
	#WLANLITE_TX_READ_CFM
 0x9105

	)

1571 
	#WLANLITE_TX_STOP_CFM
 0x9106

	)

1572 
	#WLANLITE_RX_START_CFM
 0x9107

	)

1573 
	#WLANLITE_RX_READ_CFM
 0x9108

	)

1574 
	#WLANLITE_RX_STOP_CFM
 0x9109

	)

1575 
	#WLANLITE_STATUS_CFM
 0x910a

	)

1576 
	#TEST_PMALLOC_CFM
 0x910b

	)

1577 
	#TEST_CONFIGURE_MONITOR_MODE_CFM
 0x910c

	)

1578 
	#TEST_CHECK_FW_ALIVE_CFM
 0x910e

	)

1579 
	#TEST_SUSPEND_CFM
 0x910f

	)

1580 
	#TEST_RESUME_CFM
 0x9110

	)

1581 
	#DEBUG_GENERIC_CFM
 0x9111

	)

1582 
	#WLANLITE_RADIO_SELECT_CFM
 0x9112

	)

1583 
	#TEST_HIP_TESTER_START_CFM
 0x9113

	)

1584 
	#TEST_HIP_TESTER_STOP_CFM
 0x9114

	)

1585 
	#TEST_HIP_TESTER_SET_PARAMS_CFM
 0x9115

	)

1586 
	#TEST_BIST_GET_TX_GAIN_CFM
 0x9116

	)

1587 
	#TEST_START_WLANLITE_CFM
 0x9117

	)

1588 
	#TEST_SPARE_2_CFM
 0x9118

	)

1589 
	#TEST_SPARE_3_CFM
 0x9119

	)

1590 
	#PHY_EVENT_LOGGING_CFM
 0x911A

	)

1591 
	#TEST_SPARE_SIGNAL_1_CFM
 0x911b

	)

1592 
	#TEST_SPARE_SIGNAL_2_CFM
 0x911c

	)

1593 
	#TEST_SPARE_SIGNAL_3_CFM
 0x911d

	)

1594 
	#TEST_SPARE_1_RES
 0x9200

	)

1595 
	#TEST_SPARE_2_RES
 0x9201

	)

1596 
	#TEST_SPARE_3_RES
 0x9202

	)

1597 
	#TEST_SPARE_SIGNAL_1_RES
 0x9203

	)

1598 
	#TEST_SPARE_SIGNAL_2_RES
 0x9204

	)

1599 
	#TEST_SPARE_SIGNAL_3_RES
 0x9205

	)

1600 
	#RADIO_LOGGING_IND
 0x9300

	)

1601 
	#DEBUG_GENERIC_IND
 0x9301

	)

1602 
	#DEBUG_PKT_SINK_REPORT_IND
 0x9302

	)

1603 
	#DEBUG_PKT_GEN_REPORT_IND
 0x9303

	)

1604 
	#TEST_HIP_TESTER_REPORT_IND
 0x9304

	)

1605 
	#TEST_SPARE_1_IND
 0x9305

	)

1606 
	#TEST_SPARE_2_IND
 0x9306

	)

1607 
	#TEST_SPARE_3_IND
 0x9307

	)

1608 
	#PHY_EVENT_LOGGING_IND
 0x9308

	)

1609 
	#TEST_SPARE_SIGNAL_1_IND
 0x9309

	)

1610 
	#TEST_SPARE_SIGNAL_2_IND
 0x930a

	)

1611 
	#TEST_SPARE_SIGNAL_3_IND
 0x930b

	)

1613 
	sçpi_sigÇl_h—d”
 {

1614 
__Ë16
 
id
;

1615 
__Ë16
 
»ûiv”_pid
;

1616 
__Ë16
 
£nd”_pid
;

1617 
__Ë32
 
fw_»ã»nû
;

1618 } 
__·cked
;

1620 
	sçpi_vif_sigÇl_h—d”
 {

1621 
__Ë16
 
id
;

1622 
__Ë16
 
»ûiv”_pid
;

1623 
__Ë16
 
£nd”_pid
;

1624 
__Ë32
 
fw_»ã»nû
;

1625 
__Ë16
 
vif
;

1626 } 
__·cked
;

1628 
	sçpi_sigÇl
 {

1629 
__Ë16
 
id
;

1630 
__Ë16
 
»ûiv”_pid
;

1631 
__Ë16
 
£nd”_pid
;

1632 
__Ë32
 
fw_»ã»nû
;

1636 
__Ë16
 
vif
;

1637 
__Ë16
 
ho¡_g
;

1638 
__Ë16
 
´iÜ™y
;

1639 
__Ë16
 
³”_šdex
;

1640 
__Ë16
 
d©a_un™_desütÜ
;

1641 
__Ë16
 
bulk_d©a_desütÜ
;

1642 
__Ë32
 
¥¬e_1
;

1643 
__Ë32
 
¥¬e_2
;

1644 
__Ë32
 
¥¬e_3
;

1645 
u8
 
dr
[0];

1646 } 
__·cked
 
ma_un™d©a_»q
;

1648 
__Ë16
 
vif
;

1649 
__Ë32
 
¥¬e_1
;

1650 
__Ë32
 
¥¬e_2
;

1651 
__Ë32
 
¥¬e_3
;

1652 
u8
 
dr
[0];

1653 } 
__·cked
 
ma_¥¬e_1_»q
;

1655 
__Ë16
 
vif
;

1656 
__Ë32
 
¥¬e_1
;

1657 
__Ë32
 
¥¬e_2
;

1658 
__Ë32
 
¥¬e_3
;

1659 
u8
 
dr
[0];

1660 } 
__·cked
 
ma_¥¬e_2_»q
;

1662 
__Ë16
 
vif
;

1663 
__Ë32
 
¥¬e_1
;

1664 
__Ë32
 
¥¬e_2
;

1665 
__Ë32
 
¥¬e_3
;

1666 
u8
 
dr
[0];

1667 } 
__·cked
 
ma_¥¬e_3_»q
;

1669 
__Ë16
 
vif
;

1670 
__Ë32
 
¥¬e_1
;

1671 
__Ë32
 
¥¬e_2
;

1672 
__Ë32
 
¥¬e_3
;

1673 
u8
 
dr
[0];

1674 } 
__·cked
 
ma_¥¬e_sigÇl_1_»q
;

1676 
__Ë16
 
vif
;

1677 
__Ë32
 
¥¬e_1
;

1678 
__Ë32
 
¥¬e_2
;

1679 
__Ë32
 
¥¬e_3
;

1680 
u8
 
dr
[0];

1681 } 
__·cked
 
ma_¥¬e_sigÇl_2_»q
;

1683 
__Ë16
 
vif
;

1684 
__Ë32
 
¥¬e_1
;

1685 
__Ë32
 
¥¬e_2
;

1686 
__Ë32
 
¥¬e_3
;

1687 
u8
 
dr
[0];

1688 } 
__·cked
 
ma_¥¬e_sigÇl_3_»q
;

1690 
__Ë16
 
vif
;

1691 
__Ë16
 
ŒªsmissiÚ_¡©us
;

1692 
__Ë16
 
ho¡_g
;

1693 
__Ë16
 
£qu’û_numb”
;

1694 
__Ë16
 
³”_šdex
;

1695 
__Ë32
 
¥¬e_1
;

1696 
__Ë32
 
¥¬e_2
;

1697 
__Ë32
 
¥¬e_3
;

1698 
u8
 
dr
[0];

1699 } 
__·cked
 
ma_un™d©a_cfm
;

1701 
__Ë16
 
vif
;

1702 
__Ë16
 
»suÉ_code
;

1703 
__Ë32
 
¥¬e_1
;

1704 
__Ë32
 
¥¬e_2
;

1705 
__Ë32
 
¥¬e_3
;

1706 
u8
 
dr
[0];

1707 } 
__·cked
 
ma_¥¬e_1_cfm
;

1709 
__Ë16
 
vif
;

1710 
__Ë16
 
»suÉ_code
;

1711 
__Ë32
 
¥¬e_1
;

1712 
__Ë32
 
¥¬e_2
;

1713 
__Ë32
 
¥¬e_3
;

1714 
u8
 
dr
[0];

1715 } 
__·cked
 
ma_¥¬e_2_cfm
;

1717 
__Ë16
 
vif
;

1718 
__Ë16
 
»suÉ_code
;

1719 
__Ë32
 
¥¬e_1
;

1720 
__Ë32
 
¥¬e_2
;

1721 
__Ë32
 
¥¬e_3
;

1722 
u8
 
dr
[0];

1723 } 
__·cked
 
ma_¥¬e_3_cfm
;

1725 
__Ë16
 
vif
;

1726 
__Ë16
 
»suÉ_code
;

1727 
__Ë32
 
¥¬e_1
;

1728 
__Ë32
 
¥¬e_2
;

1729 
__Ë32
 
¥¬e_3
;

1730 
u8
 
dr
[0];

1731 } 
__·cked
 
ma_¥¬e_sigÇl_1_cfm
;

1733 
__Ë16
 
vif
;

1734 
__Ë16
 
»suÉ_code
;

1735 
__Ë32
 
¥¬e_1
;

1736 
__Ë32
 
¥¬e_2
;

1737 
__Ë32
 
¥¬e_3
;

1738 
u8
 
dr
[0];

1739 } 
__·cked
 
ma_¥¬e_sigÇl_2_cfm
;

1741 
__Ë16
 
vif
;

1742 
__Ë16
 
»suÉ_code
;

1743 
__Ë32
 
¥¬e_1
;

1744 
__Ë32
 
¥¬e_2
;

1745 
__Ë32
 
¥¬e_3
;

1746 
u8
 
dr
[0];

1747 } 
__·cked
 
ma_¥¬e_sigÇl_3_cfm
;

1749 
__Ë16
 
vif
;

1750 
__Ë32
 
¥¬e_1
;

1751 
__Ë32
 
¥¬e_2
;

1752 
__Ë32
 
¥¬e_3
;

1753 
u8
 
dr
[0];

1754 } 
__·cked
 
ma_¥¬e_1_»s
;

1756 
__Ë16
 
vif
;

1757 
__Ë32
 
¥¬e_1
;

1758 
__Ë32
 
¥¬e_2
;

1759 
__Ë32
 
¥¬e_3
;

1760 
u8
 
dr
[0];

1761 } 
__·cked
 
ma_¥¬e_2_»s
;

1763 
__Ë16
 
vif
;

1764 
__Ë32
 
¥¬e_1
;

1765 
__Ë32
 
¥¬e_2
;

1766 
__Ë32
 
¥¬e_3
;

1767 
u8
 
dr
[0];

1768 } 
__·cked
 
ma_¥¬e_3_»s
;

1770 
__Ë16
 
vif
;

1771 
__Ë32
 
¥¬e_1
;

1772 
__Ë32
 
¥¬e_2
;

1773 
__Ë32
 
¥¬e_3
;

1774 
u8
 
dr
[0];

1775 } 
__·cked
 
ma_¥¬e_sigÇl_1_»s
;

1777 
__Ë16
 
vif
;

1778 
__Ë32
 
¥¬e_1
;

1779 
__Ë32
 
¥¬e_2
;

1780 
__Ë32
 
¥¬e_3
;

1781 
u8
 
dr
[0];

1782 } 
__·cked
 
ma_¥¬e_sigÇl_2_»s
;

1784 
__Ë16
 
vif
;

1785 
__Ë32
 
¥¬e_1
;

1786 
__Ë32
 
¥¬e_2
;

1787 
__Ë32
 
¥¬e_3
;

1788 
u8
 
dr
[0];

1789 } 
__·cked
 
ma_¥¬e_sigÇl_3_»s
;

1791 
__Ë16
 
vif
;

1792 
__Ë16
 
d©a_un™_desütÜ
;

1793 
__Ë16
 
£qu’û_numb”
;

1794 
__Ë16
 
´iÜ™y
;

1795 
__Ë16
 
³”_šdex
;

1796 
__Ë16
 
´İr›¿ty_šfÜm©iÚ_Ëngth
;

1797 
__Ë16
 
bulk_d©a_desütÜ
;

1798 
__Ë32
 
¥¬e_1
;

1799 
__Ë32
 
¥¬e_2
;

1800 
__Ë32
 
¥¬e_3
;

1801 
u8
 
dr
[0];

1802 } 
__·cked
 
ma_un™d©a_šd
;

1804 
__Ë16
 
vif
;

1805 
u8
 
³”_q¡a_add»ss
[
ETH_ALEN
];

1806 
__Ë16
 
£qu’û_numb”
;

1807 
__Ë16
 
»asÚ_code
;

1808 
__Ë16
 
blockack_·¿m‘”_£t
;

1809 
__Ë16
 
dœeùiÚ
;

1810 
__Ë32
 
¥¬e_1
;

1811 
__Ë32
 
¥¬e_2
;

1812 
__Ë32
 
¥¬e_3
;

1813 
u8
 
dr
[0];

1814 } 
__·cked
 
ma_blockack_šd
;

1816 
__Ë16
 
vif
;

1817 
__Ë32
 
¥¬e_1
;

1818 
__Ë32
 
¥¬e_2
;

1819 
__Ë32
 
¥¬e_3
;

1820 
u8
 
dr
[0];

1821 } 
__·cked
 
ma_¥¬e_1_šd
;

1823 
__Ë16
 
vif
;

1824 
__Ë32
 
¥¬e_1
;

1825 
__Ë32
 
¥¬e_2
;

1826 
__Ë32
 
¥¬e_3
;

1827 
u8
 
dr
[0];

1828 } 
__·cked
 
ma_¥¬e_2_šd
;

1830 
__Ë16
 
vif
;

1831 
__Ë32
 
¥¬e_1
;

1832 
__Ë32
 
¥¬e_2
;

1833 
__Ë32
 
¥¬e_3
;

1834 
u8
 
dr
[0];

1835 } 
__·cked
 
ma_¥¬e_3_šd
;

1837 
__Ë16
 
vif
;

1838 
__Ë32
 
¥¬e_1
;

1839 
__Ë32
 
¥¬e_2
;

1840 
__Ë32
 
¥¬e_3
;

1841 
u8
 
dr
[0];

1842 } 
__·cked
 
ma_¥¬e_sigÇl_1_šd
;

1844 
__Ë16
 
vif
;

1845 
__Ë32
 
¥¬e_1
;

1846 
__Ë32
 
¥¬e_2
;

1847 
__Ë32
 
¥¬e_3
;

1848 
u8
 
dr
[0];

1849 } 
__·cked
 
ma_¥¬e_sigÇl_2_šd
;

1851 
__Ë16
 
vif
;

1852 
__Ë32
 
¥¬e_1
;

1853 
__Ë32
 
¥¬e_2
;

1854 
__Ë32
 
¥¬e_3
;

1855 
u8
 
dr
[0];

1856 } 
__·cked
 
ma_¥¬e_sigÇl_3_šd
;

1858 
__Ë16
 
vif
;

1859 
__Ë32
 
¥¬e_1
;

1860 
__Ë32
 
¥¬e_2
;

1861 
__Ë32
 
¥¬e_3
;

1862 
u8
 
dr
[0];

1863 } 
__·cked
 
mlme_g‘_»q
;

1865 
__Ë16
 
vif
;

1866 
__Ë32
 
¥¬e_1
;

1867 
__Ë32
 
¥¬e_2
;

1868 
__Ë32
 
¥¬e_3
;

1869 
u8
 
dr
[0];

1870 } 
__·cked
 
mlme_£t_»q
;

1872 
__Ë16
 
vif
;

1873 
__Ë16
 
pow”_mªagem’t_mode
;

1874 
__Ë32
 
¥¬e_1
;

1875 
__Ë32
 
¥¬e_2
;

1876 
__Ë32
 
¥¬e_3
;

1877 
u8
 
dr
[0];

1878 } 
__·cked
 
mlme_pow”mgt_»q
;

1880 
__Ë16
 
vif
;

1881 
__Ë16
 
pu½o£
;

1882 
__Ë32
 
¥¬e_1
;

1883 
__Ë32
 
¥¬e_2
;

1884 
__Ë32
 
¥¬e_3
;

1885 
u8
 
dr
[0];

1886 } 
__·cked
 
mlme_add_šfo_–em’ts_»q
;

1888 
__Ë16
 
vif
;

1889 
__Ë16
 
sÿn_id
;

1890 
__Ë16
 
sÿn_ty³
;

1891 
u8
 
deviû_add»ss
[
ETH_ALEN
];

1892 
__Ë16
 
»pÜt_mode_b™m­
;

1893 
__Ë32
 
¥¬e_1
;

1894 
__Ë32
 
¥¬e_2
;

1895 
__Ë32
 
¥¬e_3
;

1896 
u8
 
dr
[0];

1897 } 
__·cked
 
mlme_add_sÿn_»q
;

1899 
__Ë16
 
vif
;

1900 
__Ë16
 
sÿn_id
;

1901 
__Ë32
 
¥¬e_1
;

1902 
__Ë32
 
¥¬e_2
;

1903 
__Ë32
 
¥¬e_3
;

1904 
u8
 
dr
[0];

1905 } 
__·cked
 
mlme_d–_sÿn_»q
;

1907 
__Ë16
 
vif
;

1908 
u8
 
š‹rçû_add»ss
[
ETH_ALEN
];

1909 
__Ë16
 
vœtu®_š‹rçû_ty³
;

1910 
u8
 
deviû_add»ss
[
ETH_ALEN
];

1911 
__Ë32
 
¥¬e_1
;

1912 
__Ë32
 
¥¬e_2
;

1913 
__Ë32
 
¥¬e_3
;

1914 
u8
 
dr
[0];

1915 } 
__·cked
 
mlme_add_vif_»q
;

1917 
__Ë16
 
vif
;

1918 
__Ë32
 
¥¬e_1
;

1919 
__Ë32
 
¥¬e_2
;

1920 
__Ë32
 
¥¬e_3
;

1921 
u8
 
dr
[0];

1922 } 
__·cked
 
mlme_d–_vif_»q
;

1924 
__Ë16
 
vif
;

1925 
u8
 
bssid
[
ETH_ALEN
];

1926 
__Ë16
 
b—cÚ_³riod
;

1927 
__Ë16
 
dtim_³riod
;

1928 
__Ë16
 
ÿ·b™y_šfÜm©iÚ
;

1929 
__Ë16
 
auth’tiÿtiÚ_ty³
;

1930 
__Ë16
 
hidd’_ssid
;

1931 
__Ë16
 
chªÃl_äequ’cy
;

1932 
__Ë16
 
chªÃl_šfÜm©iÚ
;

1933 
__Ë32
 
¥¬e_1
;

1934 
__Ë32
 
¥¬e_2
;

1935 
__Ë32
 
¥¬e_3
;

1936 
u8
 
dr
[0];

1937 } 
__·cked
 
mlme_¡¬t_»q
;

1939 
__Ë16
 
vif
;

1940 
__Ë16
 
avaab™y_du¿tiÚ
;

1941 
__Ë16
 
avaab™y_š‹rv®
;

1942 
__Ë16
 
couÁ
;

1943 
__Ë16
 
chªÃl_äequ’cy
;

1944 
__Ë32
 
¥¬e_1
;

1945 
__Ë32
 
¥¬e_2
;

1946 
__Ë32
 
¥¬e_3
;

1947 
u8
 
dr
[0];

1948 } 
__·cked
 
mlme_£t_chªÃl_»q
;

1950 
__Ë16
 
vif
;

1951 
u8
 
bssid
[
ETH_ALEN
];

1952 
__Ë16
 
auth’tiÿtiÚ_ty³
;

1953 
__Ë16
 
chªÃl_äequ’cy
;

1954 
__Ë32
 
¥¬e_1
;

1955 
__Ë32
 
¥¬e_2
;

1956 
__Ë32
 
¥¬e_3
;

1957 
u8
 
dr
[0];

1958 } 
__·cked
 
mlme_cÚÃù_»q
;

1960 
__Ë16
 
vif
;

1961 
__Ë32
 
¥¬e_1
;

1962 
__Ë32
 
¥¬e_2
;

1963 
__Ë32
 
¥¬e_3
;

1964 
u8
 
dr
[0];

1965 } 
__·cked
 
mlme_»assocŸ‹_»q
;

1967 
__Ë16
 
vif
;

1968 
u8
 
bssid
[
ETH_ALEN
];

1969 
__Ë16
 
chªÃl_äequ’cy
;

1970 
__Ë32
 
¥¬e_1
;

1971 
__Ë32
 
¥¬e_2
;

1972 
__Ë32
 
¥¬e_3
;

1973 
u8
 
dr
[0];

1974 } 
__·cked
 
mlme_rßm_»q
;

1976 
__Ë16
 
vif
;

1977 
u8
 
³”_¡a_add»ss
[
ETH_ALEN
];

1978 
__Ë16
 
»asÚ_code
;

1979 
__Ë32
 
¥¬e_1
;

1980 
__Ë32
 
¥¬e_2
;

1981 
__Ë32
 
¥¬e_3
;

1982 
u8
 
dr
[0];

1983 } 
__·cked
 
mlme_discÚÃù_»q
;

1985 
__Ë16
 
vif
;

1986 
__Ë32
 
aùiÚ_äame_ÿ‹gÜy_b™m­_aùive
;

1987 
__Ë32
 
aùiÚ_äame_ÿ‹gÜy_b™m­_su¥’ded
;

1988 
__Ë32
 
¥¬e_1
;

1989 
__Ë32
 
¥¬e_2
;

1990 
__Ë32
 
¥¬e_3
;

1991 
u8
 
dr
[0];

1992 } 
__·cked
 
mlme_»gi¡”_aùiÚ_äame_»q
;

1994 
__Ë16
 
vif
;

1995 
__Ë16
 
ho¡_g
;

1996 
__Ë16
 
d©a_un™_desütÜ
;

1997 
__Ë16
 
mes§ge_ty³
;

1998 
__Ë16
 
chªÃl_äequ’cy
;

1999 
__Ë32
 
dw–l_time
;

2000 
__Ë32
 
³riod
;

2001 
__Ë32
 
¥¬e_1
;

2002 
__Ë32
 
¥¬e_2
;

2003 
__Ë32
 
¥¬e_3
;

2004 
u8
 
dr
[0];

2005 } 
__·cked
 
mlme_£nd_äame_»q
;

2007 
__Ë16
 
vif
;

2008 
__Ë32
 
¥¬e_1
;

2009 
__Ë32
 
¥¬e_2
;

2010 
__Ë32
 
¥¬e_3
;

2011 
u8
 
dr
[0];

2012 } 
__·cked
 
mlme_»£t_dw–l_time_»q
;

2014 
__Ë16
 
vif
;

2015 
__Ë16
 
u£r_´iÜ™y
;

2016 
__Ë16
 
medium_time
;

2017 
__Ë16
 
mšimum_d©a_¿‹
;

2018 
u8
 
³”_add»ss
[
ETH_ALEN
];

2019 
__Ë32
 
¥¬e_1
;

2020 
__Ë32
 
¥¬e_2
;

2021 
__Ë32
 
¥¬e_3
;

2022 
u8
 
dr
[0];

2023 } 
__·cked
 
mlme_£t_Œaffic_·¿m‘”s_»q
;

2025 
__Ë16
 
vif
;

2026 
__Ë16
 
u£r_´iÜ™y
;

2027 
__Ë32
 
¥¬e_1
;

2028 
__Ë32
 
¥¬e_2
;

2029 
__Ë32
 
¥¬e_3
;

2030 
u8
 
dr
[0];

2031 } 
__·cked
 
mlme_d–_Œaffic_·¿m‘”s_»q
;

2033 
__Ë16
 
vif
;

2034 
__Ë32
 
¥¬e_1
;

2035 
__Ë32
 
¥¬e_2
;

2036 
__Ë32
 
¥¬e_3
;

2037 
u8
 
dr
[0];

2038 } 
__·cked
 
mlme_£t_·ck‘_f‹r_»q
;

2040 
__Ë16
 
vif
;

2041 
__Ë16
 
_v”siÚ
;

2042 
u8
 
muÉiÿ¡_add»ss
[
ETH_ALEN
];

2043 
__Ë32
 
¥¬e_1
;

2044 
__Ë32
 
¥¬e_2
;

2045 
__Ë32
 
¥¬e_3
;

2046 
u8
 
dr
[0];

2047 } 
__·cked
 
mlme_£t__add»ss_»q
;

2049 
__Ë16
 
vif
;

2050 
__Ë16
 
’Œ›s
;

2051 
__Ë16
 
aş_pŞicy
;

2052 
__Ë32
 
¥¬e_1
;

2053 
__Ë32
 
¥¬e_2
;

2054 
__Ë32
 
¥¬e_3
;

2055 
u8
 
dr
[0];

2056 } 
__·cked
 
mlme_£t_aş_»q
;

2058 
__Ë16
 
vif
;

2059 
__Ë16
 
Ëngth
;

2060 
__Ë16
 
key_id
;

2061 
__Ë16
 
key_ty³
;

2062 
u8
 
add»ss
[
ETH_ALEN
];

2063 
__Ë16
 
£qu’û_numb”
[8];

2064 
__Ë32
 
ch”_su™e_£ËùÜ
;

2065 
__Ë32
 
¥¬e_1
;

2066 
__Ë32
 
¥¬e_2
;

2067 
__Ë32
 
¥¬e_3
;

2068 
u8
 
dr
[0];

2069 } 
__·cked
 
mlme_£tkeys_»q
;

2071 
__Ë16
 
vif
;

2072 
__Ë16
 
key_id
;

2073 
__Ë16
 
key_ty³
;

2074 
__Ë32
 
¥¬e_1
;

2075 
__Ë32
 
¥¬e_2
;

2076 
__Ë32
 
¥¬e_3
;

2077 
u8
 
dr
[0];

2078 } 
__·cked
 
mlme_g‘_key_£qu’û_»q
;

2080 
__Ë16
 
vif
;

2081 
__Ë32
 
¥¬e_1
;

2082 
__Ë32
 
¥¬e_2
;

2083 
__Ë32
 
¥¬e_3
;

2084 
u8
 
dr
[0];

2085 } 
__·cked
 
mlme_£t_pmk_»q
;

2087 
__Ë16
 
vif
;

2088 
__Ë32
 
¥¬e_1
;

2089 
__Ë32
 
¥¬e_2
;

2090 
__Ë32
 
¥¬e_3
;

2091 
u8
 
dr
[0];

2092 } 
__·cked
 
mlme_£t_ÿched_chªÃls_»q
;

2094 
__Ë16
 
vif
;

2095 
__Ë32
 
¥¬e_1
;

2096 
__Ë32
 
¥¬e_2
;

2097 
__Ë32
 
¥¬e_3
;

2098 
u8
 
dr
[0];

2099 } 
__·cked
 
mlme_£t_wh™–i¡_ssid_»q
;

2101 
__Ë16
 
vif
;

2102 
u8
 
³”_¡a_add»ss
[
ETH_ALEN
];

2103 
__Ë16
 
tdls_aùiÚ
;

2104 
__Ë16
 
chªÃl_äequ’cy
;

2105 
__Ë16
 
chªÃl_šfÜm©iÚ
;

2106 
__Ë32
 
¥¬e_1
;

2107 
__Ë32
 
¥¬e_2
;

2108 
__Ë32
 
¥¬e_3
;

2109 
u8
 
dr
[0];

2110 } 
__·cked
 
mlme_tdls_aùiÚ_»q
;

2112 
__Ë16
 
vif
;

2113 
__Ë16
 
chªÃl_äequ’cy
;

2114 
__Ë16
 
chªÃl_šfÜm©iÚ
;

2115 
__Ë32
 
¥¬e_1
;

2116 
__Ë32
 
¥¬e_2
;

2117 
__Ë32
 
¥¬e_3
;

2118 
u8
 
dr
[0];

2119 } 
__·cked
 
mlme_chªÃl_sw™ch_»q
;

2121 
__Ë16
 
vif
;

2122 
__Ë16
 
low_rssi_th»shŞd
;

2123 
__Ë16
 
high_rssi_th»shŞd
;

2124 
__Ë16
 
rssi_mÚ™Üšg_’abËd
;

2125 
__Ë32
 
¥¬e_1
;

2126 
__Ë32
 
¥¬e_2
;

2127 
__Ë32
 
¥¬e_3
;

2128 
u8
 
dr
[0];

2129 } 
__·cked
 
mlme_mÚ™Ü_rssi_»q
;

2131 
__Ë16
 
vif
;

2132 
__Ë16
 
mpdu_size_th»shŞd
;

2133 
__Ë16
 
agg»ssive_¡©i¡ics_g©h”šg_’abËd
;

2134 
__Ë32
 
¥¬e_1
;

2135 
__Ë32
 
¥¬e_2
;

2136 
__Ë32
 
¥¬e_3
;

2137 
u8
 
dr
[0];

2138 } 
__·cked
 
mlme_¡¬t_lšk_¡©i¡ics_»q
;

2140 
__Ë16
 
vif
;

2141 
__Ë16
 
¡©i¡ics_¡İ_b™m­
;

2142 
__Ë32
 
¥¬e_1
;

2143 
__Ë32
 
¥¬e_2
;

2144 
__Ë32
 
¥¬e_3
;

2145 
u8
 
dr
[0];

2146 } 
__·cked
 
mlme_¡İ_lšk_¡©i¡ics_»q
;

2148 
__Ë16
 
vif
;

2149 
__Ë32
 
¥¬e_1
;

2150 
__Ë32
 
¥¬e_2
;

2151 
__Ë32
 
¥¬e_3
;

2152 
u8
 
dr
[0];

2153 } 
__·cked
 
mlme_£t_²o_li¡_»q
;

2155 
__Ë16
 
vif
;

2156 
__Ë16
 
ho¡_¡©e
;

2157 
__Ë32
 
¥¬e_1
;

2158 
__Ë32
 
¥¬e_2
;

2159 
__Ë32
 
¥¬e_3
;

2160 
u8
 
dr
[0];

2161 } 
__·cked
 
mlme_ho¡_¡©e_»q
;

2163 
__Ë16
 
vif
;

2164 
__Ë16
 
¹t_id
;

2165 
u8
 
deviû_add»ss
[
ETH_ALEN
];

2166 
__Ë32
 
¥¬e_1
;

2167 
__Ë32
 
¥¬e_2
;

2168 
__Ë32
 
¥¬e_3
;

2169 
u8
 
dr
[0];

2170 } 
__·cked
 
mlme_add_¿nge_»q
;

2172 
__Ë16
 
vif
;

2173 
__Ë16
 
¹t_id
;

2174 
__Ë16
 
’Œ›s
;

2175 
__Ë32
 
¥¬e_1
;

2176 
__Ë32
 
¥¬e_2
;

2177 
__Ë32
 
¥¬e_3
;

2178 
u8
 
dr
[0];

2179 } 
__·cked
 
mlme_d–_¿nge_»q
;

2181 
__Ë16
 
vif
;

2182 
__Ë16
 
»que¡_id
;

2183 
__Ë16
 
nß_couÁ
;

2184 
__Ë32
 
š‹rv®
;

2185 
__Ë32
 
du¿tiÚ
;

2186 
__Ë32
 
¥¬e_1
;

2187 
__Ë32
 
¥¬e_2
;

2188 
__Ë32
 
¥¬e_3
;

2189 
u8
 
dr
[0];

2190 } 
__·cked
 
mlme_£t_nß_»q
;

2192 
__Ë16
 
vif
;

2193 
__Ë16
 
ùwšdow
;

2194 
__Ë32
 
¥¬e_1
;

2195 
__Ë32
 
¥¬e_2
;

2196 
__Ë32
 
¥¬e_3
;

2197 
u8
 
dr
[0];

2198 } 
__·cked
 
mlme_£t_ùwšdow_»q
;

2200 
__Ë16
 
vif
;

2201 
__Ë16
 
Çn_İ”©iÚ_cÚŒŞ_æags
;

2202 
__Ë32
 
¥¬e_1
;

2203 
__Ë32
 
¥¬e_2
;

2204 
__Ë32
 
¥¬e_3
;

2205 
u8
 
dr
[0];

2206 } 
__·cked
 
mlme_Çn_¡¬t_»q
;

2208 
__Ë16
 
vif
;

2209 
__Ë16
 
Çn_İ”©iÚ_cÚŒŞ_æags
;

2210 
__Ë32
 
¥¬e_1
;

2211 
__Ë32
 
¥¬e_2
;

2212 
__Ë32
 
¥¬e_3
;

2213 
u8
 
dr
[0];

2214 } 
__·cked
 
mlme_Çn_cÚfig_»q
;

2216 
__Ë16
 
vif
;

2217 
__Ë16
 
£ssiÚ_id
;

2218 
__Ë16
 
Çn_sdf_æags
;

2219 
__Ë32
 
¥¬e_1
;

2220 
__Ë32
 
¥¬e_2
;

2221 
__Ë32
 
¥¬e_3
;

2222 
u8
 
dr
[0];

2223 } 
__·cked
 
mlme_Çn_publish_»q
;

2225 
__Ë16
 
vif
;

2226 
__Ë16
 
£ssiÚ_id
;

2227 
__Ë16
 
Çn_sdf_æags
;

2228 
__Ë32
 
¥¬e_1
;

2229 
__Ë32
 
¥¬e_2
;

2230 
__Ë32
 
¥¬e_3
;

2231 
u8
 
dr
[0];

2232 } 
__·cked
 
mlme_Çn_subsüibe_»q
;

2234 
__Ë16
 
vif
;

2235 
__Ë16
 
£ssiÚ_id
;

2236 
__Ë16
 
m©ch_id
;

2237 
__Ë16
 
Çn_sdf_æags
;

2238 
__Ë32
 
¥¬e_1
;

2239 
__Ë32
 
¥¬e_2
;

2240 
__Ë32
 
¥¬e_3
;

2241 
u8
 
dr
[0];

2242 } 
__·cked
 
mlme_Çn_fŞlowup_»q
;

2244 
__Ë16
 
vif
;

2245 
__Ë32
 
¥¬e_1
;

2246 
__Ë32
 
¥¬e_2
;

2247 
__Ë32
 
¥¬e_3
;

2248 
u8
 
dr
[0];

2249 } 
__·cked
 
mlme_un£t_chªÃl_»q
;

2251 
__Ë16
 
vif
;

2252 
__Ë16
 
couÁry_code
;

2253 
__Ë16
 
dfs_»guÏtÜy_domaš
;

2254 
__Ë32
 
¥¬e_2
;

2255 
__Ë32
 
¥¬e_3
;

2256 
u8
 
dr
[0];

2257 } 
__·cked
 
mlme_£t_couÁry_»q
;

2259 
__Ë16
 
vif
;

2260 
__Ë16
 
ws_aùiÚ
;

2261 
__Ë16
 
¥¬e_1
;

2262 
__Ë32
 
¥¬e_2
;

2263 
__Ë32
 
¥¬e_3
;

2264 
u8
 
dr
[0];

2265 } 
__·cked
 
mlme_fÜw¬d_b—cÚ_»q
;

2267 
__Ë16
 
vif
;

2268 
__Ë16
 
ndl_vif_šdex
;

2269 
__Ë16
 
m©ch_id
;

2270 
u8
 
loÿl_ndp_š‹rçû_add»ss
[
ETH_ALEN
];

2271 
u8
 
³”_nmi
[
ETH_ALEN
];

2272 
__Ë16
 
ndp_š¡ªû_id
;

2273 
__Ë32
 
¥¬e_1
;

2274 
__Ë32
 
¥¬e_2
;

2275 
__Ë32
 
¥¬e_3
;

2276 
u8
 
dr
[0];

2277 } 
__·cked
 
mlme_ndp_»que¡_»q
;

2279 
__Ë16
 
vif
;

2280 
__Ë16
 
»que¡_id
;

2281 
__Ë16
 
ndl_vif_šdex
;

2282 
__Ë16
 
»asÚ_code
;

2283 
u8
 
loÿl_ndp_š‹rçû_add»ss
[
ETH_ALEN
];

2284 
__Ë16
 
ndp_š¡ªû_id
;

2285 
__Ë32
 
¥¬e_1
;

2286 
__Ë32
 
¥¬e_2
;

2287 
__Ë32
 
¥¬e_3
;

2288 
u8
 
dr
[0];

2289 } 
__·cked
 
mlme_ndp_»¥Ú£_»q
;

2291 
__Ë16
 
vif
;

2292 
__Ë16
 
ndp_š¡ªû_id
;

2293 
__Ë32
 
¥¬e_1
;

2294 
__Ë32
 
¥¬e_2
;

2295 
__Ë32
 
¥¬e_3
;

2296 
u8
 
dr
[0];

2297 } 
__·cked
 
mlme_ndp_‹rmš©e_»q
;

2299 
__Ë16
 
vif
;

2300 
__Ë32
 
¥¬e_1
;

2301 
__Ë32
 
¥¬e_2
;

2302 
__Ë32
 
¥¬e_3
;

2303 
u8
 
dr
[0];

2304 } 
__·cked
 
mlme_rßmšg_chªÃl_li¡_»q
;

2306 
__Ë16
 
vif
;

2307 
__Ë16
 
chªÃl_šfÜm©iÚ
;

2308 
__Ë16
 
´ÙeùiÚ_scİe
;

2309 
__Ë32
 
¥¬e_2
;

2310 
__Ë32
 
¥¬e_3
;

2311 
u8
 
dr
[0];

2312 } 
__·cked
 
mlme_£t_bss_max_chªÃl_width_»q
;

2314 
__Ë16
 
vif
;

2315 
__Ë16
 
sÿn_mode
;

2316 
__Ë16
 
max_chªÃl_time_aùive
;

2317 
__Ë16
 
home_away_time
;

2318 
__Ë16
 
home_time
;

2319 
__Ë16
 
max_chªÃl_time_·ssive
;

2320 
__Ë32
 
¥¬e_3
;

2321 
u8
 
dr
[0];

2322 } 
__·cked
 
mlme_£t_sÿn_mode_»q
;

2324 
__Ë16
 
vif
;

2325 
__Ë16
 
f‹r_mode
;

2326 
__Ë32
 
¥¬e_1
;

2327 
__Ë32
 
¥¬e_2
;

2328 
__Ë32
 
¥¬e_3
;

2329 
u8
 
dr
[0];

2330 } 
__·cked
 
mlme_š¡®l_­f_»q
;

2332 
__Ë16
 
vif
;

2333 
__Ë32
 
¥¬e_1
;

2334 
__Ë32
 
¥¬e_2
;

2335 
__Ë32
 
¥¬e_3
;

2336 
u8
 
dr
[0];

2337 } 
__·cked
 
mlme_»ad_­f_»q
;

2339 
__Ë16
 
vif
;

2340 
__Ë16
 
numb”_of_ª‹Âas
;

2341 
__Ë32
 
¥¬e_1
;

2342 
__Ë32
 
¥¬e_2
;

2343 
__Ë32
 
¥¬e_3
;

2344 
u8
 
dr
[0];

2345 } 
__·cked
 
mlme_£t_num_ª‹Âas_»q
;

2347 
__Ë16
 
vif
;

2348 
__Ë16
 
¬p_d‘eù_aùiÚ
;

2349 
__Ë32
 
¥¬e_1
;

2350 
__Ë32
 
¥¬e_2
;

2351 
__Ë32
 
¥¬e_3
;

2352 
u8
 
dr
[0];

2353 } 
__·cked
 
mlme_¬p_d‘eù_»q
;

2355 
__Ë16
 
vif
;

2356 
__Ë16
 
rßmšg_ty³
;

2357 
__Ë32
 
¥¬e_1
;

2358 
__Ë32
 
¥¬e_2
;

2359 
__Ë32
 
¥¬e_3
;

2360 
u8
 
dr
[0];

2361 } 
__·cked
 
mlme_£t_rßmšg_ty³_»q
;

2363 
__Ë16
 
vif
;

2364 
__Ë16
 
bªd
;

2365 
__Ë32
 
¥¬e_1
;

2366 
__Ë32
 
¥¬e_2
;

2367 
__Ë32
 
¥¬e_3
;

2368 
u8
 
dr
[0];

2369 } 
__·cked
 
mlme_£t_bªd_»q
;

2371 
__Ë16
 
vif
;

2372 
__Ë32
 
¥¬e_1
;

2373 
__Ë32
 
¥¬e_2
;

2374 
__Ë32
 
¥¬e_3
;

2375 
u8
 
dr
[0];

2376 } 
__·cked
 
mlme_£t_rßmšg_·¿m‘”s_»q
;

2378 
__Ë16
 
vif
;

2379 
__Ë32
 
¥¬e_1
;

2380 
__Ë32
 
¥¬e_2
;

2381 
__Ë32
 
¥¬e_3
;

2382 
u8
 
dr
[0];

2383 } 
__·cked
 
mlme_wifish¬šg_³rm™‹d_chªÃls_»q
;

2385 
__Ë16
 
vif
;

2386 
__Ë32
 
¥¬e_1
;

2387 
__Ë32
 
¥¬e_2
;

2388 
__Ë32
 
¥¬e_3
;

2389 
u8
 
dr
[0];

2390 } 
__·cked
 
mlme_¥¬e_7_»q
;

2392 
__Ë16
 
vif
;

2393 
__Ë32
 
¥¬e_1
;

2394 
__Ë32
 
¥¬e_2
;

2395 
__Ë32
 
¥¬e_3
;

2396 
u8
 
dr
[0];

2397 } 
__·cked
 
mlme_¥¬e_8_»q
;

2399 
__Ë16
 
vif
;

2400 
__Ë16
 
chªÃl_äequ’cy_£gm’t0
;

2401 
__Ë16
 
chªÃl_šfÜm©iÚ
;

2402 
__Ë16
 
chªÃl_äequ’cy_£gm’t1
;

2403 
__Ë32
 
¥¬e_1
;

2404 
__Ë32
 
¥¬e_2
;

2405 
__Ë32
 
¥¬e_3
;

2406 
u8
 
dr
[0];

2407 } 
__·cked
 
mlme_cÚfigu»_mÚ™Ü_mode_»q
;

2409 
__Ë16
 
vif
;

2410 
__Ë32
 
¥¬e_1
;

2411 
__Ë32
 
¥¬e_2
;

2412 
__Ë32
 
¥¬e_3
;

2413 
u8
 
dr
[0];

2414 } 
__·cked
 
mlme_¥¬e_9_»q
;

2416 
__Ë16
 
vif
;

2417 
__Ë32
 
¥¬e_1
;

2418 
__Ë32
 
¥¬e_2
;

2419 
__Ë32
 
¥¬e_3
;

2420 
u8
 
dr
[0];

2421 } 
__·cked
 
mlme_¥¬e_10_»q
;

2423 
__Ë16
 
vif
;

2424 
__Ë32
 
¥¬e_1
;

2425 
__Ë32
 
¥¬e_2
;

2426 
__Ë32
 
¥¬e_3
;

2427 
u8
 
dr
[0];

2428 } 
__·cked
 
mlme_¥¬e_11_»q
;

2430 
__Ë16
 
vif
;

2431 
__Ë32
 
¥¬e_1
;

2432 
__Ë32
 
¥¬e_2
;

2433 
__Ë32
 
¥¬e_3
;

2434 
u8
 
dr
[0];

2435 } 
__·cked
 
mlme_Çn_¿nge_»q
;

2437 
__Ë16
 
vif
;

2438 
__Ë32
 
¥¬e_1
;

2439 
__Ë32
 
¥¬e_2
;

2440 
__Ë32
 
¥¬e_3
;

2441 
u8
 
dr
[0];

2442 } 
__·cked
 
mlme_Çn_¿nge_ÿnûl_»q
;

2444 
__Ë16
 
vif
;

2445 
u8
 
³”_q¡a_add»ss
[
ETH_ALEN
];

2446 
__Ë16
 
£qu’û_numb”
;

2447 
__Ë16
 
u£r_´iÜ™y
;

2448 
__Ë16
 
»asÚ
;

2449 
__Ë16
 
dœeùiÚ
;

2450 
__Ë32
 
¥¬e_1
;

2451 
__Ë32
 
¥¬e_2
;

2452 
__Ë32
 
¥¬e_3
;

2453 
u8
 
dr
[0];

2454 } 
__·cked
 
mlme_d–ba_»q
;

2456 
__Ë16
 
vif
;

2457 
__Ë32
 
¥¬e_1
;

2458 
__Ë32
 
¥¬e_2
;

2459 
__Ë32
 
¥¬e_3
;

2460 
u8
 
dr
[0];

2461 } 
__·cked
 
mlme_g‘_num_ª‹Âas_»q
;

2463 
__Ë16
 
vif
;

2464 
__Ë32
 
¥¬e_1
;

2465 
__Ë32
 
¥¬e_2
;

2466 
__Ë32
 
¥¬e_3
;

2467 
u8
 
dr
[0];

2468 } 
__·cked
 
mlme_¡¬t_d‘eù_»q
;

2470 
__Ë16
 
vif
;

2471 
__Ë32
 
¥¬e_1
;

2472 
__Ë32
 
¥¬e_2
;

2473 
__Ë32
 
¥¬e_3
;

2474 
u8
 
dr
[0];

2475 } 
__·cked
 
mlme_¥¬e_sigÇl_1_»q
;

2477 
__Ë16
 
vif
;

2478 
__Ë32
 
¥¬e_1
;

2479 
__Ë32
 
¥¬e_2
;

2480 
__Ë32
 
¥¬e_3
;

2481 
u8
 
dr
[0];

2482 } 
__·cked
 
mlme_¥¬e_sigÇl_2_»q
;

2484 
__Ë16
 
vif
;

2485 
__Ë32
 
¥¬e_1
;

2486 
__Ë32
 
¥¬e_2
;

2487 
__Ë32
 
¥¬e_3
;

2488 
u8
 
dr
[0];

2489 } 
__·cked
 
mlme_¥¬e_sigÇl_3_»q
;

2491 
__Ë16
 
vif
;

2492 
__Ë32
 
¥¬e_1
;

2493 
__Ë32
 
¥¬e_2
;

2494 
__Ë32
 
¥¬e_3
;

2495 
u8
 
dr
[0];

2496 } 
__·cked
 
mlme_g‘_cfm
;

2498 
__Ë16
 
vif
;

2499 
__Ë32
 
¥¬e_1
;

2500 
__Ë32
 
¥¬e_2
;

2501 
__Ë32
 
¥¬e_3
;

2502 
u8
 
dr
[0];

2503 } 
__·cked
 
mlme_£t_cfm
;

2505 
__Ë16
 
vif
;

2506 
__Ë16
 
»suÉ_code
;

2507 
__Ë32
 
¥¬e_1
;

2508 
__Ë32
 
¥¬e_2
;

2509 
__Ë32
 
¥¬e_3
;

2510 
u8
 
dr
[0];

2511 } 
__·cked
 
mlme_pow”mgt_cfm
;

2513 
__Ë16
 
vif
;

2514 
__Ë16
 
»suÉ_code
;

2515 
__Ë32
 
¥¬e_1
;

2516 
__Ë32
 
¥¬e_2
;

2517 
__Ë32
 
¥¬e_3
;

2518 
u8
 
dr
[0];

2519 } 
__·cked
 
mlme_add_šfo_–em’ts_cfm
;

2521 
__Ë16
 
vif
;

2522 
__Ë16
 
»suÉ_code
;

2523 
__Ë16
 
sÿn_id
;

2524 
__Ë32
 
¥¬e_1
;

2525 
__Ë32
 
¥¬e_2
;

2526 
__Ë32
 
¥¬e_3
;

2527 
u8
 
dr
[0];

2528 } 
__·cked
 
mlme_add_sÿn_cfm
;

2530 
__Ë16
 
vif
;

2531 
__Ë16
 
»suÉ_code
;

2532 
__Ë16
 
sÿn_id
;

2533 
__Ë32
 
¥¬e_1
;

2534 
__Ë32
 
¥¬e_2
;

2535 
__Ë32
 
¥¬e_3
;

2536 
u8
 
dr
[0];

2537 } 
__·cked
 
mlme_d–_sÿn_cfm
;

2539 
__Ë16
 
vif
;

2540 
__Ë16
 
»suÉ_code
;

2541 
__Ë32
 
¥¬e_1
;

2542 
__Ë32
 
¥¬e_2
;

2543 
__Ë32
 
¥¬e_3
;

2544 
u8
 
dr
[0];

2545 } 
__·cked
 
mlme_add_vif_cfm
;

2547 
__Ë16
 
vif
;

2548 
__Ë16
 
»suÉ_code
;

2549 
__Ë32
 
¥¬e_1
;

2550 
__Ë32
 
¥¬e_2
;

2551 
__Ë32
 
¥¬e_3
;

2552 
u8
 
dr
[0];

2553 } 
__·cked
 
mlme_d–_vif_cfm
;

2555 
__Ë16
 
vif
;

2556 
__Ë16
 
»suÉ_code
;

2557 
__Ë32
 
¥¬e_1
;

2558 
__Ë32
 
¥¬e_2
;

2559 
__Ë32
 
¥¬e_3
;

2560 
u8
 
dr
[0];

2561 } 
__·cked
 
mlme_¡¬t_cfm
;

2563 
__Ë16
 
vif
;

2564 
__Ë16
 
»suÉ_code
;

2565 
__Ë32
 
¥¬e_1
;

2566 
__Ë32
 
¥¬e_2
;

2567 
__Ë32
 
¥¬e_3
;

2568 
u8
 
dr
[0];

2569 } 
__·cked
 
mlme_£t_chªÃl_cfm
;

2571 
__Ë16
 
vif
;

2572 
__Ë16
 
»suÉ_code
;

2573 
__Ë32
 
¥¬e_1
;

2574 
__Ë32
 
¥¬e_2
;

2575 
__Ë32
 
¥¬e_3
;

2576 
u8
 
dr
[0];

2577 } 
__·cked
 
mlme_cÚÃù_cfm
;

2579 
__Ë16
 
vif
;

2580 
__Ë16
 
»suÉ_code
;

2581 
__Ë32
 
¥¬e_1
;

2582 
__Ë32
 
¥¬e_2
;

2583 
__Ë32
 
¥¬e_3
;

2584 
u8
 
dr
[0];

2585 } 
__·cked
 
mlme_»assocŸ‹_cfm
;

2587 
__Ë16
 
vif
;

2588 
__Ë16
 
»suÉ_code
;

2589 
__Ë32
 
¥¬e_1
;

2590 
__Ë32
 
¥¬e_2
;

2591 
__Ë32
 
¥¬e_3
;

2592 
u8
 
dr
[0];

2593 } 
__·cked
 
mlme_rßm_cfm
;

2595 
__Ë16
 
vif
;

2596 
u8
 
³”_¡a_add»ss
[
ETH_ALEN
];

2597 
__Ë16
 
»suÉ_code
;

2598 
__Ë32
 
¥¬e_1
;

2599 
__Ë32
 
¥¬e_2
;

2600 
__Ë32
 
¥¬e_3
;

2601 
u8
 
dr
[0];

2602 } 
__·cked
 
mlme_discÚÃù_cfm
;

2604 
__Ë16
 
vif
;

2605 
__Ë16
 
»suÉ_code
;

2606 
__Ë32
 
¥¬e_1
;

2607 
__Ë32
 
¥¬e_2
;

2608 
__Ë32
 
¥¬e_3
;

2609 
u8
 
dr
[0];

2610 } 
__·cked
 
mlme_»gi¡”_aùiÚ_äame_cfm
;

2612 
__Ë16
 
vif
;

2613 
__Ë16
 
ho¡_g
;

2614 
__Ë16
 
»suÉ_code
;

2615 
__Ë32
 
¥¬e_1
;

2616 
__Ë32
 
¥¬e_2
;

2617 
__Ë32
 
¥¬e_3
;

2618 
u8
 
dr
[0];

2619 } 
__·cked
 
mlme_£nd_äame_cfm
;

2621 
__Ë16
 
vif
;

2622 
__Ë16
 
»suÉ_code
;

2623 
__Ë32
 
¥¬e_1
;

2624 
__Ë32
 
¥¬e_2
;

2625 
__Ë32
 
¥¬e_3
;

2626 
u8
 
dr
[0];

2627 } 
__·cked
 
mlme_»£t_dw–l_time_cfm
;

2629 
__Ë16
 
vif
;

2630 
__Ë16
 
»suÉ_code
;

2631 
__Ë32
 
¥¬e_1
;

2632 
__Ë32
 
¥¬e_2
;

2633 
__Ë32
 
¥¬e_3
;

2634 
u8
 
dr
[0];

2635 } 
__·cked
 
mlme_£t_Œaffic_·¿m‘”s_cfm
;

2637 
__Ë16
 
vif
;

2638 
__Ë16
 
»suÉ_code
;

2639 
__Ë32
 
¥¬e_1
;

2640 
__Ë32
 
¥¬e_2
;

2641 
__Ë32
 
¥¬e_3
;

2642 
u8
 
dr
[0];

2643 } 
__·cked
 
mlme_d–_Œaffic_·¿m‘”s_cfm
;

2645 
__Ë16
 
vif
;

2646 
__Ë32
 
¥¬e_1
;

2647 
__Ë32
 
¥¬e_2
;

2648 
__Ë32
 
¥¬e_3
;

2649 
u8
 
dr
[0];

2650 } 
__·cked
 
mlme_£t_·ck‘_f‹r_cfm
;

2652 
__Ë16
 
vif
;

2653 
__Ë16
 
»suÉ_code
;

2654 
__Ë32
 
¥¬e_1
;

2655 
__Ë32
 
¥¬e_2
;

2656 
__Ë32
 
¥¬e_3
;

2657 
u8
 
dr
[0];

2658 } 
__·cked
 
mlme_£t__add»ss_cfm
;

2660 
__Ë16
 
vif
;

2661 
__Ë16
 
»suÉ_code
;

2662 
__Ë32
 
¥¬e_1
;

2663 
__Ë32
 
¥¬e_2
;

2664 
__Ë32
 
¥¬e_3
;

2665 
u8
 
dr
[0];

2666 } 
__·cked
 
mlme_£t_aş_cfm
;

2668 
__Ë16
 
vif
;

2669 
__Ë16
 
»suÉ_code
;

2670 
__Ë32
 
¥¬e_1
;

2671 
__Ë32
 
¥¬e_2
;

2672 
__Ë32
 
¥¬e_3
;

2673 
u8
 
dr
[0];

2674 } 
__·cked
 
mlme_£tkeys_cfm
;

2676 
__Ë16
 
vif
;

2677 
__Ë16
 
£qu’û_numb”
[8];

2678 
__Ë16
 
»suÉ_code
;

2679 
__Ë32
 
¥¬e_1
;

2680 
__Ë32
 
¥¬e_2
;

2681 
__Ë32
 
¥¬e_3
;

2682 
u8
 
dr
[0];

2683 } 
__·cked
 
mlme_g‘_key_£qu’û_cfm
;

2685 
__Ë16
 
vif
;

2686 
__Ë16
 
»suÉ_code
;

2687 
__Ë32
 
¥¬e_1
;

2688 
__Ë32
 
¥¬e_2
;

2689 
__Ë32
 
¥¬e_3
;

2690 
u8
 
dr
[0];

2691 } 
__·cked
 
mlme_£t_pmk_cfm
;

2693 
__Ë16
 
vif
;

2694 
__Ë16
 
»suÉ_code
;

2695 
__Ë32
 
¥¬e_1
;

2696 
__Ë32
 
¥¬e_2
;

2697 
__Ë32
 
¥¬e_3
;

2698 
u8
 
dr
[0];

2699 } 
__·cked
 
mlme_£t_ÿched_chªÃls_cfm
;

2701 
__Ë16
 
vif
;

2702 
__Ë16
 
»suÉ_code
;

2703 
__Ë32
 
¥¬e_1
;

2704 
__Ë32
 
¥¬e_2
;

2705 
__Ë32
 
¥¬e_3
;

2706 
u8
 
dr
[0];

2707 } 
__·cked
 
mlme_£t_wh™–i¡_ssid_cfm
;

2709 
__Ë16
 
vif
;

2710 
__Ë16
 
»suÉ_code
;

2711 
__Ë32
 
¥¬e_1
;

2712 
__Ë32
 
¥¬e_2
;

2713 
__Ë32
 
¥¬e_3
;

2714 
u8
 
dr
[0];

2715 } 
__·cked
 
mlme_tdls_aùiÚ_cfm
;

2717 
__Ë16
 
vif
;

2718 
__Ë16
 
»suÉ_code
;

2719 
__Ë32
 
¥¬e_1
;

2720 
__Ë32
 
¥¬e_2
;

2721 
__Ë32
 
¥¬e_3
;

2722 
u8
 
dr
[0];

2723 } 
__·cked
 
mlme_chªÃl_sw™ch_cfm
;

2725 
__Ë16
 
vif
;

2726 
__Ë16
 
»suÉ_code
;

2727 
__Ë32
 
¥¬e_1
;

2728 
__Ë32
 
¥¬e_2
;

2729 
__Ë32
 
¥¬e_3
;

2730 
u8
 
dr
[0];

2731 } 
__·cked
 
mlme_mÚ™Ü_rssi_cfm
;

2733 
__Ë16
 
vif
;

2734 
__Ë16
 
»suÉ_code
;

2735 
__Ë32
 
¥¬e_1
;

2736 
__Ë32
 
¥¬e_2
;

2737 
__Ë32
 
¥¬e_3
;

2738 
u8
 
dr
[0];

2739 } 
__·cked
 
mlme_¡¬t_lšk_¡©i¡ics_cfm
;

2741 
__Ë16
 
vif
;

2742 
__Ë16
 
»suÉ_code
;

2743 
__Ë32
 
¥¬e_1
;

2744 
__Ë32
 
¥¬e_2
;

2745 
__Ë32
 
¥¬e_3
;

2746 
u8
 
dr
[0];

2747 } 
__·cked
 
mlme_¡İ_lšk_¡©i¡ics_cfm
;

2749 
__Ë16
 
vif
;

2750 
__Ë16
 
»suÉ_code
;

2751 
__Ë32
 
¥¬e_1
;

2752 
__Ë32
 
¥¬e_2
;

2753 
__Ë32
 
¥¬e_3
;

2754 
u8
 
dr
[0];

2755 } 
__·cked
 
mlme_£t_²o_li¡_cfm
;

2757 
__Ë16
 
vif
;

2758 
__Ë16
 
»suÉ_code
;

2759 
__Ë32
 
¥¬e_1
;

2760 
__Ë32
 
¥¬e_2
;

2761 
__Ë32
 
¥¬e_3
;

2762 
u8
 
dr
[0];

2763 } 
__·cked
 
mlme_ho¡_¡©e_cfm
;

2765 
__Ë16
 
vif
;

2766 
__Ë16
 
»suÉ_code
;

2767 
__Ë16
 
¹t_id
;

2768 
__Ë32
 
¥¬e_1
;

2769 
__Ë32
 
¥¬e_2
;

2770 
__Ë32
 
¥¬e_3
;

2771 
u8
 
dr
[0];

2772 } 
__·cked
 
mlme_add_¿nge_cfm
;

2774 
__Ë16
 
vif
;

2775 
__Ë16
 
»suÉ_code
;

2776 
__Ë16
 
¹t_id
;

2777 
__Ë32
 
¥¬e_1
;

2778 
__Ë32
 
¥¬e_2
;

2779 
__Ë32
 
¥¬e_3
;

2780 
u8
 
dr
[0];

2781 } 
__·cked
 
mlme_d–_¿nge_cfm
;

2783 
__Ë16
 
vif
;

2784 
__Ë16
 
»suÉ_code
;

2785 
__Ë32
 
¥¬e_1
;

2786 
__Ë32
 
¥¬e_2
;

2787 
__Ë32
 
¥¬e_3
;

2788 
u8
 
dr
[0];

2789 } 
__·cked
 
mlme_£t_nß_cfm
;

2791 
__Ë16
 
vif
;

2792 
__Ë16
 
»suÉ_code
;

2793 
__Ë32
 
¥¬e_1
;

2794 
__Ë32
 
¥¬e_2
;

2795 
__Ë32
 
¥¬e_3
;

2796 
u8
 
dr
[0];

2797 } 
__·cked
 
mlme_£t_ùwšdow_cfm
;

2799 
__Ë16
 
vif
;

2800 
__Ë16
 
»suÉ_code
;

2801 
__Ë32
 
¥¬e_1
;

2802 
__Ë32
 
¥¬e_2
;

2803 
__Ë32
 
¥¬e_3
;

2804 
u8
 
dr
[0];

2805 } 
__·cked
 
mlme_Çn_¡¬t_cfm
;

2807 
__Ë16
 
vif
;

2808 
__Ë16
 
»suÉ_code
;

2809 
__Ë32
 
¥¬e_1
;

2810 
__Ë32
 
¥¬e_2
;

2811 
__Ë32
 
¥¬e_3
;

2812 
u8
 
dr
[0];

2813 } 
__·cked
 
mlme_Çn_cÚfig_cfm
;

2815 
__Ë16
 
vif
;

2816 
__Ë16
 
»suÉ_code
;

2817 
__Ë32
 
¥¬e_1
;

2818 
__Ë32
 
¥¬e_2
;

2819 
__Ë32
 
¥¬e_3
;

2820 
u8
 
dr
[0];

2821 } 
__·cked
 
mlme_Çn_publish_cfm
;

2823 
__Ë16
 
vif
;

2824 
__Ë16
 
»suÉ_code
;

2825 
__Ë32
 
¥¬e_1
;

2826 
__Ë32
 
¥¬e_2
;

2827 
__Ë32
 
¥¬e_3
;

2828 
u8
 
dr
[0];

2829 } 
__·cked
 
mlme_Çn_subsüibe_cfm
;

2831 
__Ë16
 
vif
;

2832 
__Ë16
 
»suÉ_code
;

2833 
__Ë32
 
¥¬e_1
;

2834 
__Ë32
 
¥¬e_2
;

2835 
__Ë32
 
¥¬e_3
;

2836 
u8
 
dr
[0];

2837 } 
__·cked
 
mlme_Çn_fŞlowup_cfm
;

2839 
__Ë16
 
vif
;

2840 
__Ë16
 
»suÉ_code
;

2841 
__Ë32
 
¥¬e_1
;

2842 
__Ë32
 
¥¬e_2
;

2843 
__Ë32
 
¥¬e_3
;

2844 
u8
 
dr
[0];

2845 } 
__·cked
 
mlme_un£t_chªÃl_cfm
;

2847 
__Ë16
 
vif
;

2848 
__Ë16
 
»suÉ_code
;

2849 
__Ë32
 
¥¬e_1
;

2850 
__Ë32
 
¥¬e_2
;

2851 
__Ë32
 
¥¬e_3
;

2852 
u8
 
dr
[0];

2853 } 
__·cked
 
mlme_£t_couÁry_cfm
;

2855 
__Ë16
 
vif
;

2856 
__Ë16
 
»suÉ_code
;

2857 
__Ë32
 
¥¬e_1
;

2858 
__Ë32
 
¥¬e_2
;

2859 
__Ë32
 
¥¬e_3
;

2860 
u8
 
dr
[0];

2861 } 
__·cked
 
mlme_fÜw¬d_b—cÚ_cfm
;

2863 
__Ë16
 
vif
;

2864 
__Ë16
 
»suÉ_code
;

2865 
__Ë32
 
¥¬e_1
;

2866 
__Ë32
 
¥¬e_2
;

2867 
__Ë32
 
¥¬e_3
;

2868 
u8
 
dr
[0];

2869 } 
__·cked
 
mlme_ndp_»que¡_cfm
;

2871 
__Ë16
 
vif
;

2872 
__Ë16
 
»suÉ_code
;

2873 
__Ë32
 
¥¬e_1
;

2874 
__Ë32
 
¥¬e_2
;

2875 
__Ë32
 
¥¬e_3
;

2876 
u8
 
dr
[0];

2877 } 
__·cked
 
mlme_ndp_»¥Ú£_cfm
;

2879 
__Ë16
 
vif
;

2880 
__Ë16
 
»suÉ_code
;

2881 
__Ë32
 
¥¬e_1
;

2882 
__Ë32
 
¥¬e_2
;

2883 
__Ë32
 
¥¬e_3
;

2884 
u8
 
dr
[0];

2885 } 
__·cked
 
mlme_ndp_‹rmš©e_cfm
;

2887 
__Ë16
 
vif
;

2888 
__Ë16
 
»suÉ_code
;

2889 
__Ë32
 
¥¬e_1
;

2890 
__Ë32
 
¥¬e_2
;

2891 
__Ë32
 
¥¬e_3
;

2892 
u8
 
dr
[0];

2893 } 
__·cked
 
mlme_rßmšg_chªÃl_li¡_cfm
;

2895 
__Ë16
 
vif
;

2896 
__Ë16
 
»suÉ_code
;

2897 
__Ë32
 
¥¬e_1
;

2898 
__Ë32
 
¥¬e_2
;

2899 
__Ë32
 
¥¬e_3
;

2900 
u8
 
dr
[0];

2901 } 
__·cked
 
mlme_£t_bss_max_chªÃl_width_cfm
;

2903 
__Ë16
 
vif
;

2904 
__Ë16
 
»suÉ_code
;

2905 
__Ë32
 
¥¬e_1
;

2906 
__Ë32
 
¥¬e_2
;

2907 
__Ë32
 
¥¬e_3
;

2908 
u8
 
dr
[0];

2909 } 
__·cked
 
mlme_£t_sÿn_mode_cfm
;

2911 
__Ë16
 
vif
;

2912 
__Ë16
 
»suÉ_code
;

2913 
__Ë32
 
¥¬e_1
;

2914 
__Ë32
 
¥¬e_2
;

2915 
__Ë32
 
¥¬e_3
;

2916 
u8
 
dr
[0];

2917 } 
__·cked
 
mlme_š¡®l_­f_cfm
;

2919 
__Ë16
 
vif
;

2920 
__Ë16
 
»suÉ_code
;

2921 
__Ë32
 
¥¬e_1
;

2922 
__Ë32
 
¥¬e_2
;

2923 
__Ë32
 
¥¬e_3
;

2924 
u8
 
dr
[0];

2925 } 
__·cked
 
mlme_»ad_­f_cfm
;

2927 
__Ë16
 
vif
;

2928 
__Ë16
 
»suÉ_code
;

2929 
__Ë32
 
¥¬e_1
;

2930 
__Ë32
 
¥¬e_2
;

2931 
__Ë32
 
¥¬e_3
;

2932 
u8
 
dr
[0];

2933 } 
__·cked
 
mlme_£t_num_ª‹Âas_cfm
;

2935 
__Ë16
 
vif
;

2936 
__Ë16
 
»suÉ_code
;

2937 
__Ë32
 
¥¬e_1
;

2938 
__Ë32
 
¥¬e_2
;

2939 
__Ë32
 
¥¬e_3
;

2940 
u8
 
dr
[0];

2941 } 
__·cked
 
mlme_¬p_d‘eù_cfm
;

2943 
__Ë16
 
vif
;

2944 
__Ë16
 
»suÉ_code
;

2945 
__Ë32
 
¥¬e_1
;

2946 
__Ë32
 
¥¬e_2
;

2947 
__Ë32
 
¥¬e_3
;

2948 
u8
 
dr
[0];

2949 } 
__·cked
 
mlme_£t_rßmšg_ty³_cfm
;

2951 
__Ë16
 
vif
;

2952 
__Ë16
 
»suÉ_code
;

2953 
__Ë32
 
¥¬e_1
;

2954 
__Ë32
 
¥¬e_2
;

2955 
__Ë32
 
¥¬e_3
;

2956 
u8
 
dr
[0];

2957 } 
__·cked
 
mlme_£t_bªd_cfm
;

2959 
__Ë16
 
vif
;

2960 
__Ë16
 
»suÉ_code
;

2961 
__Ë32
 
¥¬e_1
;

2962 
__Ë32
 
¥¬e_2
;

2963 
__Ë32
 
¥¬e_3
;

2964 
u8
 
dr
[0];

2965 } 
__·cked
 
mlme_£t_rßmšg_·¿m‘”s_cfm
;

2967 
__Ë16
 
vif
;

2968 
__Ë16
 
»suÉ_code
;

2969 
__Ë32
 
¥¬e_1
;

2970 
__Ë32
 
¥¬e_2
;

2971 
__Ë32
 
¥¬e_3
;

2972 
u8
 
dr
[0];

2973 } 
__·cked
 
mlme_wifish¬šg_³rm™‹d_chªÃls_cfm
;

2975 
__Ë16
 
vif
;

2976 
__Ë16
 
»suÉ_code
;

2977 
__Ë32
 
¥¬e_1
;

2978 
__Ë32
 
¥¬e_2
;

2979 
__Ë32
 
¥¬e_3
;

2980 
u8
 
dr
[0];

2981 } 
__·cked
 
mlme_¥¬e_7_cfm
;

2983 
__Ë16
 
vif
;

2984 
__Ë16
 
»suÉ_code
;

2985 
__Ë32
 
¥¬e_1
;

2986 
__Ë32
 
¥¬e_2
;

2987 
__Ë32
 
¥¬e_3
;

2988 
u8
 
dr
[0];

2989 } 
__·cked
 
mlme_¥¬e_8_cfm
;

2991 
__Ë16
 
vif
;

2992 
__Ë16
 
»suÉ_code
;

2993 
__Ë32
 
¥¬e_1
;

2994 
__Ë32
 
¥¬e_2
;

2995 
__Ë32
 
¥¬e_3
;

2996 
u8
 
dr
[0];

2997 } 
__·cked
 
mlme_cÚfigu»_mÚ™Ü_mode_cfm
;

2999 
__Ë16
 
vif
;

3000 
__Ë16
 
»suÉ_code
;

3001 
__Ë32
 
¥¬e_1
;

3002 
__Ë32
 
¥¬e_2
;

3003 
__Ë32
 
¥¬e_3
;

3004 
u8
 
dr
[0];

3005 } 
__·cked
 
mlme_¥¬e_9_cfm
;

3007 
__Ë16
 
vif
;

3008 
__Ë16
 
»suÉ_code
;

3009 
__Ë32
 
¥¬e_1
;

3010 
__Ë32
 
¥¬e_2
;

3011 
__Ë32
 
¥¬e_3
;

3012 
u8
 
dr
[0];

3013 } 
__·cked
 
mlme_¥¬e_10_cfm
;

3015 
__Ë16
 
vif
;

3016 
__Ë16
 
»suÉ_code
;

3017 
__Ë32
 
¥¬e_1
;

3018 
__Ë32
 
¥¬e_2
;

3019 
__Ë32
 
¥¬e_3
;

3020 
u8
 
dr
[0];

3021 } 
__·cked
 
mlme_¥¬e_11_cfm
;

3023 
__Ë16
 
vif
;

3024 
__Ë16
 
»suÉ_code
;

3025 
__Ë32
 
¥¬e_1
;

3026 
__Ë32
 
¥¬e_2
;

3027 
__Ë32
 
¥¬e_3
;

3028 
u8
 
dr
[0];

3029 } 
__·cked
 
mlme_Çn_¿nge_cfm
;

3031 
__Ë16
 
vif
;

3032 
__Ë16
 
»suÉ_code
;

3033 
__Ë32
 
¥¬e_1
;

3034 
__Ë32
 
¥¬e_2
;

3035 
__Ë32
 
¥¬e_3
;

3036 
u8
 
dr
[0];

3037 } 
__·cked
 
mlme_Çn_¿nge_ÿnûl_cfm
;

3039 
__Ë16
 
vif
;

3040 
__Ë16
 
»suÉ_code
;

3041 
__Ë32
 
¥¬e_1
;

3042 
__Ë32
 
¥¬e_2
;

3043 
__Ë32
 
¥¬e_3
;

3044 
u8
 
dr
[0];

3045 } 
__·cked
 
mlme_d–ba_cfm
;

3047 
__Ë16
 
vif
;

3048 
__Ë16
 
»suÉ_code
;

3049 
__Ë16
 
numb”_of_ª‹Âas
;

3050 
__Ë32
 
¥¬e_1
;

3051 
__Ë32
 
¥¬e_2
;

3052 
__Ë32
 
¥¬e_3
;

3053 
u8
 
dr
[0];

3054 } 
__·cked
 
mlme_g‘_num_ª‹Âas_cfm
;

3056 
__Ë16
 
vif
;

3057 
__Ë16
 
»suÉ_code
;

3058 
__Ë32
 
¥¬e_1
;

3059 
__Ë32
 
¥¬e_2
;

3060 
__Ë32
 
¥¬e_3
;

3061 
u8
 
dr
[0];

3062 } 
__·cked
 
mlme_¡¬t_d‘eù_cfm
;

3064 
__Ë16
 
vif
;

3065 
__Ë16
 
»suÉ_code
;

3066 
__Ë32
 
¥¬e_1
;

3067 
__Ë32
 
¥¬e_2
;

3068 
__Ë32
 
¥¬e_3
;

3069 
u8
 
dr
[0];

3070 } 
__·cked
 
mlme_¥¬e_sigÇl_1_cfm
;

3072 
__Ë16
 
vif
;

3073 
__Ë16
 
»suÉ_code
;

3074 
__Ë32
 
¥¬e_1
;

3075 
__Ë32
 
¥¬e_2
;

3076 
__Ë32
 
¥¬e_3
;

3077 
u8
 
dr
[0];

3078 } 
__·cked
 
mlme_¥¬e_sigÇl_2_cfm
;

3080 
__Ë16
 
vif
;

3081 
__Ë16
 
»suÉ_code
;

3082 
__Ë32
 
¥¬e_1
;

3083 
__Ë32
 
¥¬e_2
;

3084 
__Ë32
 
¥¬e_3
;

3085 
u8
 
dr
[0];

3086 } 
__·cked
 
mlme_¥¬e_sigÇl_3_cfm
;

3088 
__Ë16
 
vif
;

3089 
__Ë32
 
¥¬e_1
;

3090 
__Ë32
 
¥¬e_2
;

3091 
__Ë32
 
¥¬e_3
;

3092 
u8
 
dr
[0];

3093 } 
__·cked
 
mlme_cÚÃù_»s
;

3095 
__Ë16
 
vif
;

3096 
__Ë16
 
assocŸtiÚ_id’tif›r
;

3097 
__Ë32
 
¥¬e_1
;

3098 
__Ë32
 
¥¬e_2
;

3099 
__Ë32
 
¥¬e_3
;

3100 
u8
 
dr
[0];

3101 } 
__·cked
 
mlme_cÚÃùed_»s
;

3103 
__Ë16
 
vif
;

3104 
__Ë32
 
¥¬e_1
;

3105 
__Ë32
 
¥¬e_2
;

3106 
__Ë32
 
¥¬e_3
;

3107 
u8
 
dr
[0];

3108 } 
__·cked
 
mlme_»assocŸ‹_»s
;

3110 
__Ë16
 
vif
;

3111 
__Ë32
 
¥¬e_1
;

3112 
__Ë32
 
¥¬e_2
;

3113 
__Ë32
 
¥¬e_3
;

3114 
u8
 
dr
[0];

3115 } 
__·cked
 
mlme_rßmed_»s
;

3117 
__Ë16
 
vif
;

3118 
__Ë16
 
³”_šdex
;

3119 
__Ë16
 
tdls_ev’t
;

3120 
__Ë32
 
¥¬e_1
;

3121 
__Ë32
 
¥¬e_2
;

3122 
__Ë32
 
¥¬e_3
;

3123 
u8
 
dr
[0];

3124 } 
__·cked
 
mlme_tdls_³”_»s
;

3126 
__Ë16
 
vif
;

3127 
__Ë16
 
»suÉ_code
;

3128 
u8
 
bssid
[
ETH_ALEN
];

3129 
__Ë32
 
¥¬e_3
;

3130 
u8
 
dr
[0];

3131 } 
__·cked
 
mlme_synchrÚi£d_»s
;

3133 
__Ë16
 
vif
;

3134 
__Ë32
 
¥¬e_1
;

3135 
__Ë32
 
¥¬e_2
;

3136 
__Ë32
 
¥¬e_3
;

3137 
u8
 
dr
[0];

3138 } 
__·cked
 
mlme_¥¬e_2_»s
;

3140 
__Ë16
 
vif
;

3141 
__Ë32
 
¥¬e_1
;

3142 
__Ë32
 
¥¬e_2
;

3143 
__Ë32
 
¥¬e_3
;

3144 
u8
 
dr
[0];

3145 } 
__·cked
 
mlme_¥¬e_3_»s
;

3147 
__Ë16
 
vif
;

3148 
__Ë32
 
¥¬e_1
;

3149 
__Ë32
 
¥¬e_2
;

3150 
__Ë32
 
¥¬e_3
;

3151 
u8
 
dr
[0];

3152 } 
__·cked
 
mlme_¥¬e_4_»s
;

3154 
__Ë16
 
vif
;

3155 
__Ë32
 
¥¬e_1
;

3156 
__Ë32
 
¥¬e_2
;

3157 
__Ë32
 
¥¬e_3
;

3158 
u8
 
dr
[0];

3159 } 
__·cked
 
mlme_¥¬e_sigÇl_1_»s
;

3161 
__Ë16
 
vif
;

3162 
__Ë32
 
¥¬e_1
;

3163 
__Ë32
 
¥¬e_2
;

3164 
__Ë32
 
¥¬e_3
;

3165 
u8
 
dr
[0];

3166 } 
__·cked
 
mlme_¥¬e_sigÇl_2_»s
;

3168 
__Ë16
 
vif
;

3169 
__Ë32
 
¥¬e_1
;

3170 
__Ë32
 
¥¬e_2
;

3171 
__Ë32
 
¥¬e_3
;

3172 
u8
 
dr
[0];

3173 } 
__·cked
 
mlme_¥¬e_sigÇl_3_»s
;

3175 
__Ë16
 
vif
;

3176 
__Ë16
 
chªÃl_äequ’cy
;

3177 
__Ë16
 
rssi
;

3178 
__Ë16
 
sÿn_id
;

3179 
__Ë16
 
hÙli¡ed_­
;

3180 
__Ë16
 
´eã¼edÃtwÜk_­
;

3181 
__Ë16
 
ªqp_–em’ts_Ëngth
;

3182 
__Ë16
 
ÃtwÜk_block_id
;

3183 
__Ë16
 
¢r
;

3184 
__Ë16
 
¥¬e_1
;

3185 
__Ë32
 
¥¬e_2
;

3186 
__Ë32
 
¥¬e_3
;

3187 
u8
 
dr
[0];

3188 } 
__·cked
 
mlme_sÿn_šd
;

3190 
__Ë16
 
vif
;

3191 
__Ë16
 
sÿn_id
;

3192 
__Ë32
 
¥¬e_1
;

3193 
__Ë32
 
¥¬e_2
;

3194 
__Ë32
 
¥¬e_3
;

3195 
u8
 
dr
[0];

3196 } 
__·cked
 
mlme_sÿn_dÚe_šd
;

3198 
__Ë16
 
vif
;

3199 
__Ë32
 
¥¬e_1
;

3200 
__Ë32
 
¥¬e_2
;

3201 
__Ë32
 
¥¬e_3
;

3202 
u8
 
dr
[0];

3203 } 
__·cked
 
mlme_li¡’_’d_šd
;

3205 
__Ë16
 
vif
;

3206 
__Ë16
 
»suÉ_code
;

3207 
__Ë32
 
¥¬e_1
;

3208 
__Ë32
 
¥¬e_2
;

3209 
__Ë32
 
¥¬e_3
;

3210 
u8
 
dr
[0];

3211 } 
__·cked
 
mlme_cÚÃù_šd
;

3213 
__Ë16
 
vif
;

3214 
__Ë16
 
assocŸtiÚ_id’tif›r
;

3215 
__Ë32
 
¥¬e_1
;

3216 
__Ë32
 
¥¬e_2
;

3217 
__Ë32
 
¥¬e_3
;

3218 
u8
 
dr
[0];

3219 } 
__·cked
 
mlme_cÚÃùed_šd
;

3221 
__Ë16
 
vif
;

3222 
__Ë16
 
»suÉ_code
;

3223 
__Ë32
 
¥¬e_1
;

3224 
__Ë32
 
¥¬e_2
;

3225 
__Ë32
 
¥¬e_3
;

3226 
u8
 
dr
[0];

3227 } 
__·cked
 
mlme_»assocŸ‹_šd
;

3229 
__Ë16
 
vif
;

3230 
__Ë16
 
»suÉ_code
;

3231 
__Ë32
 
¥¬e_1
;

3232 
__Ë32
 
¥¬e_2
;

3233 
__Ë32
 
¥¬e_3
;

3234 
u8
 
dr
[0];

3235 } 
__·cked
 
mlme_rßm_šd
;

3237 
__Ë16
 
vif
;

3238 
__Ë16
 
‹mpÜ®_keys_»quœed
;

3239 
__Ë32
 
¥¬e_1
;

3240 
__Ë32
 
¥¬e_2
;

3241 
__Ë32
 
¥¬e_3
;

3242 
u8
 
dr
[0];

3243 } 
__·cked
 
mlme_rßmed_šd
;

3245 
__Ë16
 
vif
;

3246 
u8
 
³”_¡a_add»ss
[
ETH_ALEN
];

3247 
__Ë32
 
¥¬e_1
;

3248 
__Ë32
 
¥¬e_2
;

3249 
__Ë32
 
¥¬e_3
;

3250 
u8
 
dr
[0];

3251 } 
__·cked
 
mlme_discÚÃù_šd
;

3253 
__Ë16
 
vif
;

3254 
u8
 
³”_¡a_add»ss
[
ETH_ALEN
];

3255 
__Ë16
 
»asÚ_code
;

3256 
__Ë32
 
¥¬e_1
;

3257 
__Ë32
 
¥¬e_2
;

3258 
__Ë32
 
¥¬e_3
;

3259 
u8
 
dr
[0];

3260 } 
__·cked
 
mlme_discÚÃùed_šd
;

3262 
__Ë16
 
vif
;

3263 
__Ë16
 
´oûdu»_ty³
;

3264 
__Ë16
 
assocŸtiÚ_id’tif›r
;

3265 
__Ë32
 
¥¬e_1
;

3266 
__Ë32
 
¥¬e_2
;

3267 
__Ë32
 
¥¬e_3
;

3268 
u8
 
dr
[0];

3269 } 
__·cked
 
mlme_´oûdu»_¡¬‹d_šd
;

3271 
__Ë16
 
vif
;

3272 
u8
 
³”_¡a_add»ss
[
ETH_ALEN
];

3273 
__Ë16
 
key_ty³
;

3274 
__Ë16
 
key_id
;

3275 
__Ë16
 
key_£qu’û_numb”
[8];

3276 
__Ë32
 
¥¬e_1
;

3277 
__Ë32
 
¥¬e_2
;

3278 
__Ë32
 
¥¬e_3
;

3279 
u8
 
dr
[0];

3280 } 
__·cked
 
mlme_mic_çu»_šd
;

3282 
__Ë16
 
vif
;

3283 
__Ë16
 
ho¡_g
;

3284 
__Ë16
 
ŒªsmissiÚ_¡©us
;

3285 
__Ë32
 
¥¬e_1
;

3286 
__Ë32
 
¥¬e_2
;

3287 
__Ë32
 
¥¬e_3
;

3288 
u8
 
dr
[0];

3289 } 
__·cked
 
mlme_äame_ŒªsmissiÚ_šd
;

3291 
__Ë16
 
vif
;

3292 
__Ë16
 
d©a_un™_desütÜ
;

3293 
__Ë16
 
chªÃl_äequ’cy
;

3294 
__Ë32
 
¥¬e_1
;

3295 
__Ë32
 
¥¬e_2
;

3296 
__Ë32
 
¥¬e_3
;

3297 
u8
 
dr
[0];

3298 } 
__·cked
 
mlme_»ûived_äame_šd
;

3300 
__Ë16
 
vif
;

3301 
u8
 
³”_¡a_add»ss
[
ETH_ALEN
];

3302 
__Ë16
 
³”_šdex
;

3303 
__Ë16
 
tdls_ev’t
;

3304 
__Ë16
 
»asÚ_code
;

3305 
__Ë32
 
¥¬e_1
;

3306 
__Ë32
 
¥¬e_2
;

3307 
__Ë32
 
¥¬e_3
;

3308 
u8
 
dr
[0];

3309 } 
__·cked
 
mlme_tdls_³”_šd
;

3311 
__Ë16
 
vif
;

3312 
u8
 
bssid
[
ETH_ALEN
];

3313 
__Ë16
 
rssi
;

3314 
__Ë32
 
¥¬e_1
;

3315 
__Ë32
 
¥¬e_2
;

3316 
__Ë32
 
¥¬e_3
;

3317 
u8
 
dr
[0];

3318 } 
__·cked
 
mlme_rssi_»pÜt_šd
;

3320 
__Ë16
 
vif
;

3321 
__Ë16
 
ac_´iÜ™y
;

3322 
__Ë32
 
¥¬e_1
;

3323 
__Ë32
 
¥¬e_2
;

3324 
__Ë32
 
¥¬e_3
;

3325 
u8
 
dr
[0];

3326 } 
__·cked
 
mlme_ac_´iÜ™y_upd©e_šd
;

3328 
__Ë16
 
vif
;

3329 
__Ë16
 
¹t_id
;

3330 
__Ë16
 
’Œ›s
;

3331 
__Ë32
 
¥¬e_1
;

3332 
__Ë32
 
¥¬e_2
;

3333 
__Ë32
 
¥¬e_3
;

3334 
u8
 
dr
[0];

3335 } 
__·cked
 
mlme_¿nge_šd
;

3337 
__Ë16
 
vif
;

3338 
__Ë16
 
¹t_id
;

3339 
__Ë32
 
¥¬e_1
;

3340 
__Ë32
 
¥¬e_2
;

3341 
__Ë32
 
¥¬e_3
;

3342 
u8
 
dr
[0];

3343 } 
__·cked
 
mlme_¿nge_dÚe_šd
;

3345 
__Ë16
 
vif
;

3346 
__Ë16
 
ev’t
;

3347 
u8
 
time¡amp
[8];

3348 
__Ë32
 
¥¬e_1
;

3349 
__Ë32
 
¥¬e_2
;

3350 
__Ë32
 
¥¬e_3
;

3351 
u8
 
dr
[0];

3352 } 
__·cked
 
mlme_ev’t_log_šd
;

3354 
__Ë16
 
vif
;

3355 
__Ë16
 
ev’t
;

3356 
__Ë16
 
id’tif›r
;

3357 
u8
 
add»ss_Ü_id’tif›r
[
ETH_ALEN
];

3358 
__Ë16
 
»asÚ_code
;

3359 
__Ë32
 
¥¬e_1
;

3360 
__Ë32
 
¥¬e_2
;

3361 
__Ë32
 
¥¬e_3
;

3362 
u8
 
dr
[0];

3363 } 
__·cked
 
mlme_Çn_ev’t_šd
;

3365 
__Ë16
 
vif
;

3366 
__Ë16
 
£ssiÚ_id
;

3367 
__Ë16
 
m©ch_id
;

3368 
__Ë32
 
¥¬e_1
;

3369 
__Ë16
 
¥¬e_2
;

3370 
__Ë32
 
¥¬e_3
;

3371 
__Ë32
 
¥¬e_4
;

3372 
__Ë32
 
¥¬e_5
;

3373 
u8
 
dr
[0];

3374 } 
__·cked
 
mlme_Çn_£rviû_šd
;

3376 
__Ë16
 
vif
;

3377 
__Ë16
 
£ssiÚ_id
;

3378 
__Ë16
 
m©ch_id
;

3379 
u8
 
³”_Çn_mªagem’t_š‹rçû_add»ss
[
ETH_ALEN
];

3380 
__Ë32
 
¥¬e_1
;

3381 
__Ë32
 
¥¬e_2
;

3382 
__Ë32
 
¥¬e_3
;

3383 
u8
 
dr
[0];

3384 } 
__·cked
 
mlme_Çn_fŞlowup_šd
;

3386 
__Ë16
 
vif
;

3387 
__Ë16
 
chªÃl_äequ’cy
;

3388 
__Ë16
 
chªÃl_šfÜm©iÚ
;

3389 
__Ë32
 
¥¬e_1
;

3390 
__Ë32
 
¥¬e_2
;

3391 
__Ë32
 
¥¬e_3
;

3392 
u8
 
dr
[0];

3393 } 
__·cked
 
mlme_chªÃl_sw™ched_šd
;

3395 
__Ë16
 
vif
;

3396 
__Ë16
 
rssi
;

3397 
__Ë16
 
¥¬e_1
;

3398 
__Ë32
 
¥¬e_2
;

3399 
__Ë32
 
¥¬e_3
;

3400 
u8
 
dr
[0];

3401 } 
__·cked
 
mlme_synchrÚi£d_šd
;

3403 
__Ë16
 
vif
;

3404 
__Ë16
 
abÜt_»asÚ
;

3405 
__Ë16
 
¥¬e_1
;

3406 
__Ë32
 
¥¬e_2
;

3407 
__Ë32
 
¥¬e_3
;

3408 
u8
 
dr
[0];

3409 } 
__·cked
 
mlme_b—cÚ_»pÜtšg_ev’t_šd
;

3411 
__Ë16
 
vif
;

3412 
__Ë32
 
¥¬e_1
;

3413 
__Ë32
 
¥¬e_2
;

3414 
__Ë32
 
¥¬e_3
;

3415 
u8
 
dr
[0];

3416 } 
__·cked
 
mlme_rßmšg_chªÃl_li¡_šd
;

3418 
__Ë16
 
vif
;

3419 
u8
 
bssid
[
ETH_ALEN
];

3420 
__Ë32
 
»assocŸtiÚ_»Œy_d–ay
;

3421 
__Ë32
 
¥¬e_1
;

3422 
__Ë32
 
¥¬e_2
;

3423 
__Ë32
 
¥¬e_3
;

3424 
u8
 
dr
[0];

3425 } 
__·cked
 
mlme_bÏckli¡ed_šd
;

3427 
__Ë16
 
vif
;

3428 
u8
 
³”_ndp_š‹rçû_add»ss
[
ETH_ALEN
];

3429 
__Ë16
 
»suÉ_code
;

3430 
__Ë16
 
ndp_š¡ªû_id
;

3431 
__Ë32
 
¥¬e_1
;

3432 
__Ë32
 
¥¬e_2
;

3433 
__Ë32
 
¥¬e_3
;

3434 
u8
 
dr
[0];

3435 } 
__·cked
 
mlme_ndp_»que¡_šd
;

3437 
__Ë16
 
vif
;

3438 
__Ë16
 
£ssiÚ_id
;

3439 
__Ë16
 
»que¡_id
;

3440 
u8
 
³”_Çn_mªagem’t_š‹rçû_add»ss
[
ETH_ALEN
];

3441 
__Ë16
 
£cur™y_»quœed
;

3442 
__Ë32
 
¥¬e_1
;

3443 
__Ë32
 
¥¬e_2
;

3444 
__Ë32
 
¥¬e_3
;

3445 
u8
 
dr
[0];

3446 } 
__·cked
 
mlme_ndp_»que¡ed_šd
;

3448 
__Ë16
 
vif
;

3449 
u8
 
³”_ndp_š‹rçû_add»ss
[
ETH_ALEN
];

3450 
__Ë16
 
»suÉ_code
;

3451 
__Ë16
 
ndp_š¡ªû_id
;

3452 
__Ë32
 
¥¬e_1
;

3453 
__Ë32
 
¥¬e_2
;

3454 
__Ë32
 
¥¬e_3
;

3455 
u8
 
dr
[0];

3456 } 
__·cked
 
mlme_ndp_»¥Ú£_šd
;

3458 
__Ë16
 
vif
;

3459 
__Ë16
 
ndp_š¡ªû_id
;

3460 
__Ë32
 
¥¬e_1
;

3461 
__Ë32
 
¥¬e_2
;

3462 
__Ë32
 
¥¬e_3
;

3463 
u8
 
dr
[0];

3464 } 
__·cked
 
mlme_ndp_‹rmš©ed_šd
;

3466 
__Ë16
 
vif
;

3467 
__Ë32
 
¥¬e_1
;

3468 
__Ë32
 
¥¬e_2
;

3469 
__Ë32
 
¥¬e_3
;

3470 
u8
 
dr
[0];

3471 } 
__·cked
 
mlme_¥¬e_5_šd
;

3473 
__Ë16
 
vif
;

3474 
__Ë32
 
¥¬e_1
;

3475 
__Ë32
 
¥¬e_2
;

3476 
__Ë32
 
¥¬e_3
;

3477 
u8
 
dr
[0];

3478 } 
__·cked
 
mlme_¥¬e_6_šd
;

3480 
__Ë16
 
vif
;

3481 
__Ë32
 
¥¬e_1
;

3482 
__Ë32
 
¥¬e_2
;

3483 
__Ë32
 
¥¬e_3
;

3484 
u8
 
dr
[0];

3485 } 
__·cked
 
mlme_Çn_¿nge_šd
;

3487 
__Ë16
 
vif
;

3488 
__Ë32
 
¥¬e_1
;

3489 
__Ë32
 
¥¬e_2
;

3490 
__Ë32
 
¥¬e_3
;

3491 
u8
 
dr
[0];

3492 } 
__·cked
 
mlme_¥¬e_7_šd
;

3494 
__Ë16
 
vif
;

3495 
__Ë16
 
»suÉ
;

3496 
__Ë32
 
¥¬e_1
;

3497 
__Ë32
 
¥¬e_2
;

3498 
__Ë32
 
¥¬e_3
;

3499 
u8
 
dr
[0];

3500 } 
__·cked
 
mlme_¡¬t_d‘eù_šd
;

3502 
__Ë16
 
vif
;

3503 
__Ë32
 
¥¬e_1
;

3504 
__Ë32
 
¥¬e_2
;

3505 
__Ë32
 
¥¬e_3
;

3506 
u8
 
dr
[0];

3507 } 
__·cked
 
mlme_¥¬e_sigÇl_1_šd
;

3509 
__Ë16
 
vif
;

3510 
__Ë32
 
¥¬e_1
;

3511 
__Ë32
 
¥¬e_2
;

3512 
__Ë32
 
¥¬e_3
;

3513 
u8
 
dr
[0];

3514 } 
__·cked
 
mlme_¥¬e_sigÇl_2_šd
;

3516 
__Ë16
 
vif
;

3517 
__Ë32
 
¥¬e_1
;

3518 
__Ë32
 
¥¬e_2
;

3519 
__Ë32
 
¥¬e_3
;

3520 
u8
 
dr
[0];

3521 } 
__·cked
 
mlme_¥¬e_sigÇl_3_šd
;

3523 
__Ë16
 
vif
;

3524 
__Ë32
 
¥¬e_1
;

3525 
__Ë32
 
¥¬e_2
;

3526 
__Ë32
 
¥¬e_3
;

3527 
u8
 
dr
[0];

3528 } 
__·cked
 
debug_¥¬e_1_»q
;

3530 
__Ë16
 
vif
;

3531 
__Ë32
 
¥¬e_1
;

3532 
__Ë32
 
¥¬e_2
;

3533 
__Ë32
 
¥¬e_3
;

3534 
u8
 
dr
[0];

3535 } 
__·cked
 
debug_¥¬e_2_»q
;

3537 
__Ë16
 
vif
;

3538 
__Ë32
 
¥¬e_1
;

3539 
__Ë32
 
¥¬e_2
;

3540 
__Ë32
 
¥¬e_3
;

3541 
u8
 
dr
[0];

3542 } 
__·cked
 
debug_¥¬e_3_»q
;

3544 
__Ë16
 
vif
;

3545 
__Ë32
 
¥¬e_1
;

3546 
__Ë32
 
¥¬e_2
;

3547 
__Ë32
 
¥¬e_3
;

3548 
u8
 
dr
[0];

3549 } 
__·cked
 
debug_¥¬e_sigÇl_1_»q
;

3551 
__Ë16
 
vif
;

3552 
__Ë32
 
¥¬e_1
;

3553 
__Ë32
 
¥¬e_2
;

3554 
__Ë32
 
¥¬e_3
;

3555 
u8
 
dr
[0];

3556 } 
__·cked
 
debug_¥¬e_sigÇl_2_»q
;

3558 
__Ë16
 
vif
;

3559 
__Ë32
 
¥¬e_1
;

3560 
__Ë32
 
¥¬e_2
;

3561 
__Ë32
 
¥¬e_3
;

3562 
u8
 
dr
[0];

3563 } 
__·cked
 
debug_¥¬e_sigÇl_3_»q
;

3565 
__Ë16
 
vif
;

3566 
__Ë16
 
»suÉ_code
;

3567 
__Ë32
 
¥¬e_1
;

3568 
__Ë32
 
¥¬e_2
;

3569 
__Ë32
 
¥¬e_3
;

3570 
u8
 
dr
[0];

3571 } 
__·cked
 
debug_¥¬e_1_cfm
;

3573 
__Ë16
 
vif
;

3574 
__Ë16
 
»suÉ_code
;

3575 
__Ë32
 
¥¬e_1
;

3576 
__Ë32
 
¥¬e_2
;

3577 
__Ë32
 
¥¬e_3
;

3578 
u8
 
dr
[0];

3579 } 
__·cked
 
debug_¥¬e_2_cfm
;

3581 
__Ë16
 
vif
;

3582 
__Ë16
 
»suÉ_code
;

3583 
__Ë32
 
¥¬e_1
;

3584 
__Ë32
 
¥¬e_2
;

3585 
__Ë32
 
¥¬e_3
;

3586 
u8
 
dr
[0];

3587 } 
__·cked
 
debug_¥¬e_3_cfm
;

3589 
__Ë16
 
vif
;

3590 
__Ë16
 
»suÉ_code
;

3591 
__Ë32
 
¥¬e_1
;

3592 
__Ë32
 
¥¬e_2
;

3593 
__Ë32
 
¥¬e_3
;

3594 
u8
 
dr
[0];

3595 } 
__·cked
 
debug_¥¬e_sigÇl_1_cfm
;

3597 
__Ë16
 
vif
;

3598 
__Ë16
 
»suÉ_code
;

3599 
__Ë32
 
¥¬e_1
;

3600 
__Ë32
 
¥¬e_2
;

3601 
__Ë32
 
¥¬e_3
;

3602 
u8
 
dr
[0];

3603 } 
__·cked
 
debug_¥¬e_sigÇl_2_cfm
;

3605 
__Ë16
 
vif
;

3606 
__Ë16
 
»suÉ_code
;

3607 
__Ë32
 
¥¬e_1
;

3608 
__Ë32
 
¥¬e_2
;

3609 
__Ë32
 
¥¬e_3
;

3610 
u8
 
dr
[0];

3611 } 
__·cked
 
debug_¥¬e_sigÇl_3_cfm
;

3613 
__Ë16
 
vif
;

3614 
__Ë32
 
¥¬e_1
;

3615 
__Ë32
 
¥¬e_2
;

3616 
__Ë32
 
¥¬e_3
;

3617 
u8
 
dr
[0];

3618 } 
__·cked
 
debug_¥¬e_1_»s
;

3620 
__Ë16
 
vif
;

3621 
__Ë32
 
¥¬e_1
;

3622 
__Ë32
 
¥¬e_2
;

3623 
__Ë32
 
¥¬e_3
;

3624 
u8
 
dr
[0];

3625 } 
__·cked
 
debug_¥¬e_2_»s
;

3627 
__Ë16
 
vif
;

3628 
__Ë32
 
¥¬e_1
;

3629 
__Ë32
 
¥¬e_2
;

3630 
__Ë32
 
¥¬e_3
;

3631 
u8
 
dr
[0];

3632 } 
__·cked
 
debug_¥¬e_3_»s
;

3634 
__Ë16
 
vif
;

3635 
__Ë32
 
¥¬e_1
;

3636 
__Ë32
 
¥¬e_2
;

3637 
__Ë32
 
¥¬e_3
;

3638 
u8
 
dr
[0];

3639 } 
__·cked
 
debug_¥¬e_sigÇl_1_»s
;

3641 
__Ë16
 
vif
;

3642 
__Ë32
 
¥¬e_1
;

3643 
__Ë32
 
¥¬e_2
;

3644 
__Ë32
 
¥¬e_3
;

3645 
u8
 
dr
[0];

3646 } 
__·cked
 
debug_¥¬e_sigÇl_2_»s
;

3648 
__Ë16
 
vif
;

3649 
__Ë32
 
¥¬e_1
;

3650 
__Ë32
 
¥¬e_2
;

3651 
__Ë32
 
¥¬e_3
;

3652 
u8
 
dr
[0];

3653 } 
__·cked
 
debug_¥¬e_sigÇl_3_»s
;

3655 
__Ë16
 
vif
;

3656 
__Ë16
 
moduË_id
;

3657 
__Ë16
 
moduË_sub_id
;

3658 
__Ë32
 
time¡amp
;

3659 
__Ë16
 
debug_wÜds
[12];

3660 
__Ë16
 
£qu’û_numb”
;

3661 
__Ë32
 
¥¬e_1
;

3662 
__Ë32
 
¥¬e_2
;

3663 
__Ë32
 
¥¬e_3
;

3664 
u8
 
dr
[0];

3665 } 
__·cked
 
debug_wÜd12_šd
;

3667 
__Ë16
 
vif
;

3668 
__Ë16
 
çuÉid
;

3669 
__Ë16
 
couÁ
;

3670 
__Ë32
 
time¡amp
;

3671 
__Ë32
 
¬g
;

3672 
__Ë16
 
ıu
;

3673 
__Ë16
 
£qu’û_numb”
;

3674 
__Ë32
 
¥¬e_1
;

3675 
__Ë32
 
¥¬e_2
;

3676 
__Ë32
 
¥¬e_3
;

3677 
u8
 
dr
[0];

3678 } 
__·cked
 
debug_çuÉ_šd
;

3680 
__Ë16
 
vif
;

3681 
__Ë16
 
moduË_id
;

3682 
__Ë16
 
moduË_sub_id
;

3683 
__Ë32
 
time¡amp
;

3684 
__Ë16
 
£qu’û_numb”
;

3685 
__Ë32
 
¥¬e_1
;

3686 
__Ë32
 
¥¬e_2
;

3687 
__Ë32
 
¥¬e_3
;

3688 
u8
 
dr
[0];

3689 } 
__·cked
 
debug_wÜds_šd
;

3691 
__Ë16
 
vif
;

3692 
__Ë32
 
¥¬e_1
;

3693 
__Ë32
 
¥¬e_2
;

3694 
__Ë32
 
¥¬e_3
;

3695 
u8
 
dr
[0];

3696 } 
__·cked
 
debug_¥¬e_2_šd
;

3698 
__Ë16
 
vif
;

3699 
__Ë32
 
¥¬e_1
;

3700 
__Ë32
 
¥¬e_2
;

3701 
__Ë32
 
¥¬e_3
;

3702 
u8
 
dr
[0];

3703 } 
__·cked
 
debug_¥¬e_3_šd
;

3705 
__Ë16
 
vif
;

3706 
__Ë32
 
¥¬e_1
;

3707 
__Ë32
 
¥¬e_2
;

3708 
__Ë32
 
¥¬e_3
;

3709 
u8
 
dr
[0];

3710 } 
__·cked
 
debug_¥¬e_4_šd
;

3712 
__Ë16
 
vif
;

3713 
__Ë32
 
¥¬e_1
;

3714 
__Ë32
 
¥¬e_2
;

3715 
__Ë32
 
¥¬e_3
;

3716 
u8
 
dr
[0];

3717 } 
__·cked
 
debug_¥¬e_sigÇl_1_šd
;

3719 
__Ë16
 
vif
;

3720 
__Ë32
 
¥¬e_1
;

3721 
__Ë32
 
¥¬e_2
;

3722 
__Ë32
 
¥¬e_3
;

3723 
u8
 
dr
[0];

3724 } 
__·cked
 
debug_¥¬e_sigÇl_2_šd
;

3726 
__Ë16
 
vif
;

3727 
__Ë32
 
¥¬e_1
;

3728 
__Ë32
 
¥¬e_2
;

3729 
__Ë32
 
¥¬e_3
;

3730 
u8
 
dr
[0];

3731 } 
__·cked
 
debug_¥¬e_sigÇl_3_šd
;

3733 
__Ë16
 
vif
;

3734 
__Ë32
 
¥¬e_1
;

3735 
__Ë32
 
¥¬e_2
;

3736 
__Ë32
 
¥¬e_3
;

3737 
u8
 
dr
[0];

3738 } 
__·cked
 
‹¡_block_»que¡s_»q
;

3740 
__Ë16
 
vif
;

3741 
__Ë32
 
¥¬e_1
;

3742 
__Ë32
 
¥¬e_2
;

3743 
__Ë32
 
¥¬e_3
;

3744 
u8
 
dr
[0];

3745 } 
__·cked
 
‹¡_·nic_»q
;

3747 
__Ë16
 
vif
;

3748 
__Ë32
 
¥¬e_1
;

3749 
__Ë32
 
¥¬e_2
;

3750 
__Ë32
 
¥¬e_3
;

3751 
u8
 
dr
[0];

3752 } 
__·cked
 
‹¡_su¥’d_»q
;

3754 
__Ë16
 
vif
;

3755 
__Ë32
 
¥¬e_1
;

3756 
__Ë32
 
¥¬e_2
;

3757 
__Ë32
 
¥¬e_3
;

3758 
u8
 
dr
[0];

3759 } 
__·cked
 
‹¡_»sume_»q
;

3761 
__Ë32
 
loggšg_sourû
;

3762 
__Ë32
 
loggšg_äequ’cy
;

3763 
__Ë32
 
ÿ±u»_¡»am
;

3764 
__Ë32
 
Œigg”_mode
;

3765 
__Ë32
 
d–ay
;

3766 
__Ë32
 
bufãr_size
;

3767 
__Ë32
 
¥¬e_1
;

3768 
__Ë32
 
¥¬e_2
;

3769 
__Ë32
 
¥¬e_3
;

3770 
u8
 
dr
[0];

3771 } 
__·cked
 
¿dio_loggšg_»q
;

3773 
__Ë16
 
äeq
;

3774 
__Ë16
 
pow”
;

3775 
__Ë16
 
æags
;

3776 
__Ë16
 
ty³
;

3777 
__Ë16
 
am¶™ude
;

3778 
__Ë32
 
äeq1
;

3779 
__Ë32
 
äeq2
;

3780 
__Ë16
 
pha£
;

3781 
__Ë32
 
¥¬e_1
;

3782 
__Ë32
 
¥¬e_2
;

3783 
__Ë32
 
¥¬e_3
;

3784 
u8
 
dr
[0];

3785 } 
__·cked
 
wÏÆ™e_cw_¡¬t_»q
;

3787 
__Ë32
 
¥¬e_1
;

3788 
__Ë32
 
¥¬e_2
;

3789 
__Ë32
 
¥¬e_3
;

3790 
u8
 
dr
[0];

3791 } 
__·cked
 
wÏÆ™e_cw_¡İ_»q
;

3793 
__Ë16
 
äeq
;

3794 
__Ë16
 
¿‹
;

3795 
__Ë16
 
chªÃl_šfÜm©iÚ
;

3796 
__Ë16
 
pow”
;

3797 
__Ë16
 
Ëngth
;

3798 
__Ë32
 
š‹rv®
;

3799 
__Ë16
 
æags
;

3800 
__Ë16
 
aid
;

3801 
__Ë16
 
di¡ªû_to_bªd_edge_h®f_mhz
;

3802 
__Ë16
 
»guÏtÜy_domaš
;

3803 
__Ë16
 
æags2
;

3804 
__Ë16
 
he_mode
;

3805 
u8
 
he_ru_®loÿtiÚ
;

3806 
u8
 
he_Éf
;

3807 
__Ë32
 
¥¬e_2
;

3808 
__Ë32
 
¥¬e_3
;

3809 
u8
 
dr
[0];

3810 } 
__·cked
 
wÏÆ™e_tx_£t_·¿ms_»q
;

3812 
__Ë32
 
num_äames_to_£nd
;

3813 
__Ë16
 
d©a_ty³
;

3814 
__Ë16
 
d©a_·¿m
;

3815 
u8
 
de¡_addr
[
ETH_ALEN
];

3816 
u8
 
¤c_addr
[
ETH_ALEN
];

3817 
u8
 
bssid
[
ETH_ALEN
];

3818 
__Ë16
 
num_mpdus_³r_ampdu
;

3819 
__Ë32
 
¥¬e_1
;

3820 
__Ë32
 
¥¬e_2
;

3821 
__Ë32
 
¥¬e_3
;

3822 
u8
 
dr
[0];

3823 } 
__·cked
 
wÏÆ™e_tx_¡¬t_»q
;

3825 
__Ë32
 
¥¬e_1
;

3826 
__Ë32
 
¥¬e_2
;

3827 
__Ë32
 
¥¬e_3
;

3828 
u8
 
dr
[0];

3829 } 
__·cked
 
wÏÆ™e_tx_»ad_»q
;

3831 
__Ë32
 
¥¬e_1
;

3832 
__Ë32
 
¥¬e_2
;

3833 
__Ë32
 
¥¬e_3
;

3834 
u8
 
dr
[0];

3835 } 
__·cked
 
wÏÆ™e_tx_¡İ_»q
;

3837 
__Ë16
 
äeq
;

3838 
__Ë16
 
chªÃl_šfÜm©iÚ
;

3839 
__Ë16
 
æags
;

3840 
u8
 
mac_addr
[
ETH_ALEN
];

3841 
u8
 
bssid
[
ETH_ALEN
];

3842 
__Ë16
 
aid
;

3843 
__Ë16
 
num_mpdus_³r_ampdu
;

3844 
__Ë16
 
»guÏtÜy_domaš
;

3845 
__Ë16
 
¥¬e_1
;

3846 
__Ë32
 
¥¬e_2
;

3847 
__Ë32
 
¥¬e_3
;

3848 
u8
 
dr
[0];

3849 } 
__·cked
 
wÏÆ™e_rx_¡¬t_»q
;

3851 
__Ë32
 
¥¬e_1
;

3852 
__Ë32
 
¥¬e_2
;

3853 
__Ë32
 
¥¬e_3
;

3854 
u8
 
dr
[0];

3855 } 
__·cked
 
wÏÆ™e_rx_»ad_»q
;

3857 
__Ë32
 
¥¬e_1
;

3858 
__Ë32
 
¥¬e_2
;

3859 
__Ë32
 
¥¬e_3
;

3860 
u8
 
dr
[0];

3861 } 
__·cked
 
wÏÆ™e_rx_¡İ_»q
;

3863 
__Ë32
 
¥¬e_1
;

3864 
__Ë32
 
¥¬e_2
;

3865 
__Ë32
 
¥¬e_3
;

3866 
u8
 
dr
[0];

3867 } 
__·cked
 
wÏÆ™e_¡©us_»q
;

3869 
__Ë16
 
®loc_¬—
;

3870 
__Ë32
 
¥¬e_1
;

3871 
__Ë32
 
¥¬e_2
;

3872 
__Ë32
 
¥¬e_3
;

3873 
u8
 
dr
[0];

3874 } 
__·cked
 
‹¡_pm®loc_»q
;

3876 
__Ë16
 
vif
;

3877 
__Ë32
 
¥¬e_1
;

3878 
__Ë32
 
¥¬e_2
;

3879 
__Ë32
 
¥¬e_3
;

3880 
u8
 
dr
[0];

3881 } 
__·cked
 
‹¡_cÚfigu»_mÚ™Ü_mode_»q
;

3883 
__Ë32
 
¥¬e_1
;

3884 
__Ë32
 
¥¬e_2
;

3885 
__Ë32
 
¥¬e_3
;

3886 
u8
 
dr
[0];

3887 } 
__·cked
 
‹¡_check_fw_®ive_»q
;

3889 
__Ë16
 
vif
;

3890 
__Ë16
 
debug_wÜds
[8];

3891 
__Ë32
 
¥¬e_1
;

3892 
__Ë32
 
¥¬e_2
;

3893 
__Ë32
 
¥¬e_3
;

3894 
u8
 
dr
[0];

3895 } 
__·cked
 
debug_g’”ic_»q
;

3897 
__Ë16
 
vif
;

3898 
__Ë16
 
’d_pošt
;

3899 
__Ë16
 
dœeùiÚ
;

3900 
__Ë32
 
š‹rv®
;

3901 
__Ë16
 
·ck‘s_³r_š‹rv®
;

3902 
__Ë32
 
¥¬e_1
;

3903 
__Ë32
 
¥¬e_2
;

3904 
__Ë32
 
¥¬e_3
;

3905 
u8
 
dr
[0];

3906 } 
__·cked
 
debug_pkt_sšk_¡¬t_»q
;

3908 
__Ë16
 
vif
;

3909 
__Ë16
 
’d_pošt
;

3910 
__Ë16
 
dœeùiÚ
;

3911 
__Ë32
 
¥¬e_1
;

3912 
__Ë32
 
¥¬e_2
;

3913 
__Ë32
 
¥¬e_3
;

3914 
u8
 
dr
[0];

3915 } 
__·cked
 
debug_pkt_sšk_¡İ_»q
;

3917 
__Ë16
 
vif
;

3918 
__Ë16
 
’d_pošt
;

3919 
__Ë16
 
dœeùiÚ
;

3920 
__Ë32
 
»pÜt_š‹rv®
;

3921 
__Ë32
 
¥¬e_1
;

3922 
__Ë32
 
¥¬e_2
;

3923 
__Ë32
 
¥¬e_3
;

3924 
u8
 
dr
[0];

3925 } 
__·cked
 
debug_pkt_sšk_»pÜt_»q
;

3927 
__Ë16
 
vif
;

3928 
__Ë16
 
’d_pošt
;

3929 
__Ë16
 
dœeùiÚ
;

3930 
__Ë32
 
š‹rv®
;

3931 
__Ë16
 
size
;

3932 
__Ë16
 
·ck‘s_³r_š‹rv®
;

3933 
__Ë32
 
v4de¡š©iÚ_add»ss
;

3934 
__Ë16
 
·ck‘s_³r_š‹¼u±
;

3935 
__Ë16
 
u£_¡»amšg
;

3936 
__Ë32
 
¥¬e_1
;

3937 
__Ë32
 
¥¬e_2
;

3938 
__Ë32
 
¥¬e_3
;

3939 
u8
 
dr
[0];

3940 } 
__·cked
 
debug_pkt_g’_¡¬t_»q
;

3942 
__Ë16
 
vif
;

3943 
__Ë16
 
’d_pošt
;

3944 
__Ë16
 
dœeùiÚ
;

3945 
__Ë32
 
¥¬e_1
;

3946 
__Ë32
 
¥¬e_2
;

3947 
__Ë32
 
¥¬e_3
;

3948 
u8
 
dr
[0];

3949 } 
__·cked
 
debug_pkt_g’_¡İ_»q
;

3951 
__Ë16
 
vif
;

3952 
__Ë16
 
’d_pošt
;

3953 
__Ë16
 
dœeùiÚ
;

3954 
__Ë32
 
»pÜt_š‹rv®
;

3955 
__Ë32
 
¥¬e_1
;

3956 
__Ë32
 
¥¬e_2
;

3957 
__Ë32
 
¥¬e_3
;

3958 
u8
 
dr
[0];

3959 } 
__·cked
 
debug_pkt_g’_»pÜt_»q
;

3961 
__Ë16
 
¿dio_b™m­
;

3962 
__Ë32
 
¥¬e_1
;

3963 
__Ë32
 
¥¬e_2
;

3964 
__Ë32
 
¥¬e_3
;

3965 
u8
 
dr
[0];

3966 } 
__·cked
 
wÏÆ™e_¿dio_£Ëù_»q
;

3968 
__Ë16
 
vif
;

3969 
__Ë16
 
mode
;

3970 
__Ë16
 
’d_pošt
;

3971 
__Ë16
 
´ÙocŞ
;

3972 
__Ë32
 
š‹rv®
;

3973 
__Ë16
 
·ck‘s_³r_š‹rv®
;

3974 
__Ë16
 
·ck‘s_size
;

3975 
__Ë32
 
¥¬e_1
;

3976 
__Ë32
 
¥¬e_2
;

3977 
__Ë32
 
¥¬e_3
;

3978 
u8
 
dr
[0];

3979 } 
__·cked
 
‹¡_h_‹¡”_¡¬t_»q
;

3981 
__Ë16
 
vif
;

3982 
__Ë16
 
¡»am_id
;

3983 
__Ë32
 
¥¬e_1
;

3984 
__Ë32
 
¥¬e_2
;

3985 
__Ë32
 
¥¬e_3
;

3986 
u8
 
dr
[0];

3987 } 
__·cked
 
‹¡_h_‹¡”_¡İ_»q
;

3989 
__Ë16
 
vif
;

3990 
__Ë16
 
¡»am_id
;

3991 
__Ë32
 
¥¬e_1
;

3992 
__Ë32
 
¥¬e_2
;

3993 
__Ë32
 
¥¬e_3
;

3994 
u8
 
dr
[0];

3995 } 
__·cked
 
‹¡_h_‹¡”_£t_·¿ms_»q
;

3997 
__Ë16
 
vif
;

3998 
__Ë16
 
¡»am_id
;

3999 
__Ë32
 
»pÜt_š‹rv®
;

4000 
__Ë32
 
¥¬e_1
;

4001 
__Ë32
 
¥¬e_2
;

4002 
__Ë32
 
¥¬e_3
;

4003 
u8
 
dr
[0];

4004 } 
__·cked
 
‹¡_h_‹¡”_»pÜt_»q
;

4006 
__Ë16
 
äeq
;

4007 
__Ë16
 
tx_gaš
;

4008 
__Ë16
 
rx_gaš
;

4009 
__Ë32
 
¥¬e_1
;

4010 
__Ë32
 
¥¬e_2
;

4011 
__Ë32
 
¥¬e_3
;

4012 
u8
 
dr
[0];

4013 } 
__·cked
 
‹¡_bi¡_g‘_tx_gaš_»q
;

4015 
__Ë16
 
¥¬e_1
;

4016 
__Ë32
 
¥¬e_2
;

4017 
__Ë32
 
¥¬e_3
;

4018 
__Ë32
 
¥¬e_4
;

4019 
u8
 
dr
[0];

4020 } 
__·cked
 
‹¡_¡¬t_wÏÆ™e_»q
;

4022 
__Ë16
 
vif
;

4023 
__Ë32
 
¥¬e_1
;

4024 
__Ë32
 
¥¬e_2
;

4025 
__Ë32
 
¥¬e_3
;

4026 
u8
 
dr
[0];

4027 } 
__·cked
 
‹¡_¥¬e_2_»q
;

4029 
__Ë16
 
vif
;

4030 
__Ë32
 
¥¬e_1
;

4031 
__Ë32
 
¥¬e_2
;

4032 
__Ë32
 
¥¬e_3
;

4033 
u8
 
dr
[0];

4034 } 
__·cked
 
‹¡_¥¬e_3_»q
;

4036 
__Ë32
 
commªd_ty³
;

4037 
__Ë16
 
ev’t_mask_wÜd0
;

4038 
__Ë16
 
ev’t_mask_wÜd1
;

4039 
__Ë16
 
ev’t_mask_wÜd2
;

4040 
__Ë16
 
ev’t_mask_wÜd3
;

4041 
__Ë16
 
İtiÚs
;

4042 
__Ë32
 
ev’t_couÁ_ù¾_Œigg”03
;

4043 
__Ë32
 
ev’t_couÁ_ù¾_Œigg”47
;

4044 
__Ë16
 
ev’t_m©ch0
;

4045 
__Ë16
 
ev’t_m©ch1
;

4046 
__Ë16
 
ev’t_m©ch2
;

4047 
__Ë16
 
ev’t_m©ch3
;

4048 
__Ë32
 
¥¬e_1
;

4049 
__Ë32
 
¥¬e_2
;

4050 
__Ë32
 
¥¬e_3
;

4051 
u8
 
dr
[0];

4052 } 
__·cked
 
phy_ev’t_loggšg_»q
;

4054 
__Ë16
 
vif
;

4055 
__Ë32
 
¥¬e_1
;

4056 
__Ë32
 
¥¬e_2
;

4057 
__Ë32
 
¥¬e_3
;

4058 
u8
 
dr
[0];

4059 } 
__·cked
 
‹¡_¥¬e_sigÇl_1_»q
;

4061 
__Ë16
 
vif
;

4062 
__Ë32
 
¥¬e_1
;

4063 
__Ë32
 
¥¬e_2
;

4064 
__Ë32
 
¥¬e_3
;

4065 
u8
 
dr
[0];

4066 } 
__·cked
 
‹¡_¥¬e_sigÇl_2_»q
;

4068 
__Ë16
 
vif
;

4069 
__Ë32
 
¥¬e_1
;

4070 
__Ë32
 
¥¬e_2
;

4071 
__Ë32
 
¥¬e_3
;

4072 
u8
 
dr
[0];

4073 } 
__·cked
 
‹¡_¥¬e_sigÇl_3_»q
;

4075 
__Ë16
 
»suÉ_code
;

4076 
__Ë32
 
¥¬e_1
;

4077 
__Ë32
 
¥¬e_2
;

4078 
__Ë32
 
¥¬e_3
;

4079 
u8
 
dr
[0];

4080 } 
__·cked
 
¿dio_loggšg_cfm
;

4082 
__Ë16
 
»suÉ_code
;

4083 
__Ë32
 
¥¬e_1
;

4084 
__Ë32
 
¥¬e_2
;

4085 
__Ë32
 
¥¬e_3
;

4086 
u8
 
dr
[0];

4087 } 
__·cked
 
wÏÆ™e_cw_¡¬t_cfm
;

4089 
__Ë16
 
»suÉ_code
;

4090 
__Ë32
 
¥¬e_1
;

4091 
__Ë32
 
¥¬e_2
;

4092 
__Ë32
 
¥¬e_3
;

4093 
u8
 
dr
[0];

4094 } 
__·cked
 
wÏÆ™e_tx_£t_·¿ms_cfm
;

4096 
__Ë16
 
»suÉ_code
;

4097 
__Ë32
 
¥¬e_1
;

4098 
__Ë32
 
¥¬e_2
;

4099 
__Ë32
 
¥¬e_3
;

4100 
u8
 
dr
[0];

4101 } 
__·cked
 
wÏÆ™e_cw_¡İ_cfm
;

4103 
__Ë16
 
»suÉ_code
;

4104 
__Ë32
 
¥¬e_1
;

4105 
__Ë32
 
¥¬e_2
;

4106 
__Ë32
 
¥¬e_3
;

4107 
u8
 
dr
[0];

4108 } 
__·cked
 
wÏÆ™e_tx_¡¬t_cfm
;

4110 
__Ë16
 
»suÉ_code
;

4111 
__Ë16
 
æags
;

4112 
__Ë32
 
ùr_äames_Ëá_to_£nd
;

4113 
__Ë32
 
ŒªsmissiÚ_back_off
;

4114 
__Ë16
 
wª‹d_pow”_rg‘
;

4115 
__Ë16
 
fš®_pow”_rg‘
;

4116 
__Ë16
 
oob_cÚ¡¿št
;

4117 
__Ë16
 
Ï¡_Œim_·_‹m³¿tu»
;

4118 
__Ë16
 
cu¼’t_·_‹m³¿tu»
;

4119 
__Ë16
 
Ï¡_Œim_amb›Á_‹m³¿tu»
;

4120 
__Ë16
 
cu¼’t_amb›Á_‹m³¿tu»
;

4121 
__Ë16
 
‹mp_pow”_adju¡
;

4122 
__Ë32
 
ùr_äames_sucûss
;

4123 
__Ë32
 
¥¬e_1
;

4124 
__Ë32
 
¥¬e_2
;

4125 
__Ë32
 
¥¬e_3
;

4126 
u8
 
dr
[0];

4127 } 
__·cked
 
wÏÆ™e_tx_»ad_cfm
;

4129 
__Ë16
 
»suÉ_code
;

4130 
__Ë32
 
¥¬e_1
;

4131 
__Ë32
 
¥¬e_2
;

4132 
__Ë32
 
¥¬e_3
;

4133 
u8
 
dr
[0];

4134 } 
__·cked
 
wÏÆ™e_tx_¡İ_cfm
;

4136 
__Ë16
 
»suÉ_code
;

4137 
__Ë32
 
¥¬e_1
;

4138 
__Ë32
 
¥¬e_2
;

4139 
__Ë32
 
¥¬e_3
;

4140 
u8
 
dr
[0];

4141 } 
__·cked
 
wÏÆ™e_rx_¡¬t_cfm
;

4143 
__Ë16
 
»suÉ_code
;

4144 
__Ë32
 
äeq_off£t_cur
;

4145 
__Ë32
 
äeq_off£t_avg
;

4146 
__Ë16
 
rssi_cur
;

4147 
__Ë16
 
rssi_avg
;

4148 
__Ë16
 
rssi_mš
;

4149 
__Ë16
 
rssi_max
;

4150 
__Ë16
 
¢r_cur
;

4151 
__Ë16
 
¢r_avg
;

4152 
__Ë16
 
¢r_mš
;

4153 
__Ë16
 
¢r_max
;

4154 
__Ë32
 
š‹rv®
;

4155 
__Ë32
 
¥¬e_1
;

4156 
__Ë32
 
¥¬e_2
;

4157 
__Ë32
 
¥¬e_3
;

4158 
u8
 
dr
[0];

4159 } 
__·cked
 
wÏÆ™e_rx_»ad_cfm
;

4161 
__Ë16
 
»suÉ_code
;

4162 
__Ë32
 
¥¬e_1
;

4163 
__Ë32
 
¥¬e_2
;

4164 
__Ë32
 
¥¬e_3
;

4165 
u8
 
dr
[0];

4166 } 
__·cked
 
wÏÆ™e_rx_¡İ_cfm
;

4168 
__Ë16
 
»suÉ_code
;

4169 
__Ë16
 
deviû_¡©e
;

4170 
__Ë32
 
¥¬e_1
;

4171 
__Ë32
 
¥¬e_2
;

4172 
__Ë32
 
¥¬e_3
;

4173 
u8
 
dr
[0];

4174 } 
__·cked
 
wÏÆ™e_¡©us_cfm
;

4176 
__Ë32
 
¥¬e_1
;

4177 
__Ë32
 
¥¬e_2
;

4178 
__Ë32
 
¥¬e_3
;

4179 
u8
 
dr
[0];

4180 } 
__·cked
 
‹¡_pm®loc_cfm
;

4182 
__Ë16
 
vif
;

4183 
__Ë16
 
»suÉ_code
;

4184 
__Ë32
 
¥¬e_1
;

4185 
__Ë32
 
¥¬e_2
;

4186 
__Ë32
 
¥¬e_3
;

4187 
u8
 
dr
[0];

4188 } 
__·cked
 
‹¡_cÚfigu»_mÚ™Ü_mode_cfm
;

4190 
__Ë32
 
¥¬e_1
;

4191 
__Ë32
 
¥¬e_2
;

4192 
__Ë32
 
¥¬e_3
;

4193 
u8
 
dr
[0];

4194 } 
__·cked
 
‹¡_check_fw_®ive_cfm
;

4196 
__Ë32
 
¥¬e_1
;

4197 
__Ë32
 
¥¬e_2
;

4198 
__Ë32
 
¥¬e_3
;

4199 
u8
 
dr
[0];

4200 } 
__·cked
 
‹¡_su¥’d_cfm
;

4202 
__Ë32
 
¥¬e_1
;

4203 
__Ë32
 
¥¬e_2
;

4204 
__Ë32
 
¥¬e_3
;

4205 
u8
 
dr
[0];

4206 } 
__·cked
 
‹¡_»sume_cfm
;

4208 
__Ë16
 
vif
;

4209 
__Ë16
 
debug_wÜds
[8];

4210 
__Ë32
 
¥¬e_1
;

4211 
__Ë32
 
¥¬e_2
;

4212 
__Ë32
 
¥¬e_3
;

4213 
u8
 
dr
[0];

4214 } 
__·cked
 
debug_g’”ic_cfm
;

4216 
__Ë16
 
»suÉ_code
;

4217 
__Ë32
 
¥¬e_1
;

4218 
__Ë32
 
¥¬e_2
;

4219 
__Ë32
 
¥¬e_3
;

4220 
u8
 
dr
[0];

4221 } 
__·cked
 
wÏÆ™e_¿dio_£Ëù_cfm
;

4223 
__Ë16
 
vif
;

4224 
__Ë16
 
»suÉ_code
;

4225 
__Ë16
 
¡»am_id
;

4226 
__Ë32
 
¥¬e_1
;

4227 
__Ë32
 
¥¬e_2
;

4228 
__Ë32
 
¥¬e_3
;

4229 
u8
 
dr
[0];

4230 } 
__·cked
 
‹¡_h_‹¡”_¡¬t_cfm
;

4232 
__Ë16
 
vif
;

4233 
__Ë16
 
»suÉ_code
;

4234 
__Ë16
 
¡»am_id
;

4235 
__Ë32
 
du¿tiÚ
;

4236 
__Ë32
 
couÁ
;

4237 
__Ë32
 
çed_couÁ
;

4238 
__Ë32
 
où‘s
;

4239 
__Ë32
 
mbps
;

4240 
__Ë16
 
idË_¿tio
;

4241 
__Ë16
 
št_Ï‹ncy
;

4242 
__Ë32
 
‹¡”_»£rved1
;

4243 
__Ë32
 
‹¡”_»£rved2
;

4244 
__Ë32
 
¥¬e_1
;

4245 
__Ë32
 
¥¬e_2
;

4246 
__Ë32
 
¥¬e_3
;

4247 
u8
 
dr
[0];

4248 } 
__·cked
 
‹¡_h_‹¡”_¡İ_cfm
;

4250 
__Ë16
 
vif
;

4251 
__Ë16
 
»suÉ_code
;

4252 
__Ë16
 
¡»am_id
;

4253 
__Ë32
 
¥¬e_1
;

4254 
__Ë32
 
¥¬e_2
;

4255 
__Ë32
 
¥¬e_3
;

4256 
u8
 
dr
[0];

4257 } 
__·cked
 
‹¡_h_‹¡”_£t_·¿ms_cfm
;

4259 
__Ë16
 
»suÉ_code
;

4260 
__Ë32
 
gaš
;

4261 
__Ë32
 
¥¬e_1
;

4262 
__Ë32
 
¥¬e_2
;

4263 
__Ë32
 
¥¬e_3
;

4264 
u8
 
dr
[0];

4265 } 
__·cked
 
‹¡_bi¡_g‘_tx_gaš_cfm
;

4267 
__Ë16
 
»suÉ_code
;

4268 
__Ë16
 
¥¬e_1
;

4269 
__Ë32
 
¥¬e_2
;

4270 
__Ë32
 
¥¬e_3
;

4271 
__Ë32
 
¥¬e_4
;

4272 
u8
 
dr
[0];

4273 } 
__·cked
 
‹¡_¡¬t_wÏÆ™e_cfm
;

4275 
__Ë16
 
vif
;

4276 
__Ë16
 
»suÉ_code
;

4277 
__Ë32
 
¥¬e_1
;

4278 
__Ë32
 
¥¬e_2
;

4279 
__Ë32
 
¥¬e_3
;

4280 
u8
 
dr
[0];

4281 } 
__·cked
 
‹¡_¥¬e_2_cfm
;

4283 
__Ë16
 
vif
;

4284 
__Ë16
 
»suÉ_code
;

4285 
__Ë32
 
¥¬e_1
;

4286 
__Ë32
 
¥¬e_2
;

4287 
__Ë32
 
¥¬e_3
;

4288 
u8
 
dr
[0];

4289 } 
__·cked
 
‹¡_¥¬e_3_cfm
;

4291 
__Ë16
 
»suÉ_code
;

4292 
__Ë32
 
¥¬e_1
;

4293 
__Ë32
 
¥¬e_2
;

4294 
__Ë32
 
¥¬e_3
;

4295 
u8
 
dr
[0];

4296 } 
__·cked
 
phy_ev’t_loggšg_cfm
;

4298 
__Ë16
 
vif
;

4299 
__Ë16
 
»suÉ_code
;

4300 
__Ë32
 
¥¬e_1
;

4301 
__Ë32
 
¥¬e_2
;

4302 
__Ë32
 
¥¬e_3
;

4303 
u8
 
dr
[0];

4304 } 
__·cked
 
‹¡_¥¬e_sigÇl_1_cfm
;

4306 
__Ë16
 
vif
;

4307 
__Ë16
 
»suÉ_code
;

4308 
__Ë32
 
¥¬e_1
;

4309 
__Ë32
 
¥¬e_2
;

4310 
__Ë32
 
¥¬e_3
;

4311 
u8
 
dr
[0];

4312 } 
__·cked
 
‹¡_¥¬e_sigÇl_2_cfm
;

4314 
__Ë16
 
vif
;

4315 
__Ë16
 
»suÉ_code
;

4316 
__Ë32
 
¥¬e_1
;

4317 
__Ë32
 
¥¬e_2
;

4318 
__Ë32
 
¥¬e_3
;

4319 
u8
 
dr
[0];

4320 } 
__·cked
 
‹¡_¥¬e_sigÇl_3_cfm
;

4322 
__Ë16
 
vif
;

4323 
__Ë32
 
¥¬e_1
;

4324 
__Ë32
 
¥¬e_2
;

4325 
__Ë32
 
¥¬e_3
;

4326 
u8
 
dr
[0];

4327 } 
__·cked
 
‹¡_¥¬e_1_»s
;

4329 
__Ë16
 
vif
;

4330 
__Ë32
 
¥¬e_1
;

4331 
__Ë32
 
¥¬e_2
;

4332 
__Ë32
 
¥¬e_3
;

4333 
u8
 
dr
[0];

4334 } 
__·cked
 
‹¡_¥¬e_2_»s
;

4336 
__Ë16
 
vif
;

4337 
__Ë32
 
¥¬e_1
;

4338 
__Ë32
 
¥¬e_2
;

4339 
__Ë32
 
¥¬e_3
;

4340 
u8
 
dr
[0];

4341 } 
__·cked
 
‹¡_¥¬e_3_»s
;

4343 
__Ë16
 
vif
;

4344 
__Ë32
 
¥¬e_1
;

4345 
__Ë32
 
¥¬e_2
;

4346 
__Ë32
 
¥¬e_3
;

4347 
u8
 
dr
[0];

4348 } 
__·cked
 
‹¡_¥¬e_sigÇl_1_»s
;

4350 
__Ë16
 
vif
;

4351 
__Ë32
 
¥¬e_1
;

4352 
__Ë32
 
¥¬e_2
;

4353 
__Ë32
 
¥¬e_3
;

4354 
u8
 
dr
[0];

4355 } 
__·cked
 
‹¡_¥¬e_sigÇl_2_»s
;

4357 
__Ë16
 
vif
;

4358 
__Ë32
 
¥¬e_1
;

4359 
__Ë32
 
¥¬e_2
;

4360 
__Ë32
 
¥¬e_3
;

4361 
u8
 
dr
[0];

4362 } 
__·cked
 
‹¡_¥¬e_sigÇl_3_»s
;

4364 
__Ë32
 
£qu’û_numb”
;

4365 
__Ë32
 
mÜe_d©a
;

4366 
__Ë32
 
¥¬e_1
;

4367 
__Ë32
 
¥¬e_2
;

4368 
__Ë32
 
¥¬e_3
;

4369 
u8
 
dr
[0];

4370 } 
__·cked
 
¿dio_loggšg_šd
;

4372 
__Ë16
 
vif
;

4373 
__Ë16
 
debug_wÜds
[8];

4374 
__Ë32
 
¥¬e_1
;

4375 
__Ë32
 
¥¬e_2
;

4376 
__Ë32
 
¥¬e_3
;

4377 
u8
 
dr
[0];

4378 } 
__·cked
 
debug_g’”ic_šd
;

4380 
__Ë16
 
vif
;

4381 
__Ë16
 
’d_pošt
;

4382 
__Ë16
 
dœeùiÚ
;

4383 
__Ë32
 
du¿tiÚ
;

4384 
__Ë32
 
»ûived_·ck‘s
;

4385 
__Ë32
 
»ûived_où‘s
;

4386 
__Ë32
 
kbps
;

4387 
__Ë16
 
idË_¿tio
;

4388 
__Ë16
 
št_Ï‹ncy
;

4389 
__Ë16
 
ä“_kby‹s
;

4390 
__Ë32
 
¥¬e_1
;

4391 
__Ë32
 
¥¬e_2
;

4392 
__Ë32
 
¥¬e_3
;

4393 
u8
 
dr
[0];

4394 } 
__·cked
 
debug_pkt_sšk_»pÜt_šd
;

4396 
__Ë16
 
vif
;

4397 
__Ë16
 
’d_pošt
;

4398 
__Ë16
 
dœeùiÚ
;

4399 
__Ë32
 
du¿tiÚ
;

4400 
__Ë32
 
»ûived_·ck‘s
;

4401 
__Ë32
 
çed_couÁ
;

4402 
__Ë32
 
»ûived_où‘s
;

4403 
__Ë32
 
kbps
;

4404 
__Ë16
 
idË_¿tio
;

4405 
__Ë16
 
št_Ï‹ncy
;

4406 
__Ë16
 
ä“_kby‹s
;

4407 
__Ë32
 
¥¬e_1
;

4408 
__Ë32
 
¥¬e_2
;

4409 
__Ë32
 
¥¬e_3
;

4410 
u8
 
dr
[0];

4411 } 
__·cked
 
debug_pkt_g’_»pÜt_šd
;

4413 
__Ë16
 
vif
;

4414 
__Ë16
 
¡»am_id
;

4415 
__Ë32
 
du¿tiÚ
;

4416 
__Ë32
 
couÁ
;

4417 
__Ë32
 
çed_couÁ
;

4418 
__Ë32
 
où‘s
;

4419 
__Ë32
 
mbps
;

4420 
__Ë16
 
idË_¿tio
;

4421 
__Ë16
 
št_Ï‹ncy
;

4422 
__Ë32
 
‹¡”_»£rved1
;

4423 
__Ë32
 
‹¡”_»£rved2
;

4424 
__Ë32
 
¥¬e_1
;

4425 
__Ë32
 
¥¬e_2
;

4426 
__Ë32
 
¥¬e_3
;

4427 
u8
 
dr
[0];

4428 } 
__·cked
 
‹¡_h_‹¡”_»pÜt_šd
;

4430 
__Ë16
 
vif
;

4431 
__Ë32
 
¥¬e_1
;

4432 
__Ë32
 
¥¬e_2
;

4433 
__Ë32
 
¥¬e_3
;

4434 
u8
 
dr
[0];

4435 } 
__·cked
 
‹¡_¥¬e_1_šd
;

4437 
__Ë16
 
vif
;

4438 
__Ë32
 
¥¬e_1
;

4439 
__Ë32
 
¥¬e_2
;

4440 
__Ë32
 
¥¬e_3
;

4441 
u8
 
dr
[0];

4442 } 
__·cked
 
‹¡_¥¬e_2_šd
;

4444 
__Ë16
 
vif
;

4445 
__Ë32
 
¥¬e_1
;

4446 
__Ë32
 
¥¬e_2
;

4447 
__Ë32
 
¥¬e_3
;

4448 
u8
 
dr
[0];

4449 } 
__·cked
 
‹¡_¥¬e_3_šd
;

4451 
__Ë32
 
commªd_ty³
;

4452 
__Ë32
 
£qu’û_numb”
;

4453 
__Ë32
 
mÜe_d©a
;

4454 
__Ë32
 
¥¬e_1
;

4455 
__Ë32
 
¥¬e_2
;

4456 
__Ë32
 
¥¬e_3
;

4457 
u8
 
dr
[0];

4458 } 
__·cked
 
phy_ev’t_loggšg_šd
;

4460 
__Ë16
 
vif
;

4461 
__Ë32
 
¥¬e_1
;

4462 
__Ë32
 
¥¬e_2
;

4463 
__Ë32
 
¥¬e_3
;

4464 
u8
 
dr
[0];

4465 } 
__·cked
 
‹¡_¥¬e_sigÇl_1_šd
;

4467 
__Ë16
 
vif
;

4468 
__Ë32
 
¥¬e_1
;

4469 
__Ë32
 
¥¬e_2
;

4470 
__Ë32
 
¥¬e_3
;

4471 
u8
 
dr
[0];

4472 } 
__·cked
 
‹¡_¥¬e_sigÇl_2_šd
;

4474 
__Ë16
 
vif
;

4475 
__Ë32
 
¥¬e_1
;

4476 
__Ë32
 
¥¬e_2
;

4477 
__Ë32
 
¥¬e_3
;

4478 
u8
 
dr
[0];

4479 } 
__·cked
 
‹¡_¥¬e_sigÇl_3_šd
;

4480 } 
u
;

4481 } 
__·cked
;

4483 
	#çpi_sig_size
(
mp_Çme
è((
u16
)
	`off£tof
(
çpi_sigÇl
, 
u
.mp_Çme.
dr
))

	)

4485 
	#çpi_g‘_sigid
(
mp_skb
è
	`Ë16_to_ıu
(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->
id
)

	)

4487 
šlše
 
boŞ
 
çpi_is_mlme
(
sk_buff
 *
skb
)

4489  (
çpi_g‘_sigid
(
skb
è& 
FAPI_SAP_TYPE_MASK
è=ğ
FAPI_SAP_TYPE_MLME
;

4492 
šlše
 
boŞ
 
çpi_is_ma
(
sk_buff
 *
skb
)

4494  (
çpi_g‘_sigid
(
skb
è& 
FAPI_SAP_TYPE_MASK
è=ğ
FAPI_SAP_TYPE_MA
;

4497 
šlše
 
boŞ
 
çpi_is_debug
(
sk_buff
 *
skb
)

4499  (
çpi_g‘_sigid
(
skb
è& 
FAPI_SAP_TYPE_MASK
è=ğ
FAPI_SAP_TYPE_DEBUG
;

4502 
šlše
 
boŞ
 
çpi_is_‹¡
(
sk_buff
 *
skb
)

4504  (
çpi_g‘_sigid
(
skb
è& 
FAPI_SAP_TYPE_MASK
è=ğ
FAPI_SAP_TYPE_TEST
;

4507 
šlše
 
boŞ
 
çpi_is_»q
(
sk_buff
 *
skb
)

4509  (
çpi_g‘_sigid
(
skb
è& 
FAPI_SIG_TYPE_MASK
è=ğ
FAPI_SIG_TYPE_REQ
;

4512 
šlše
 
boŞ
 
çpi_is_cfm
(
sk_buff
 *
skb
)

4514  (
çpi_g‘_sigid
(
skb
è& 
FAPI_SIG_TYPE_MASK
è=ğ
FAPI_SIG_TYPE_CFM
;

4517 
šlše
 
boŞ
 
çpi_is_»s
(
sk_buff
 *
skb
)

4519  (
çpi_g‘_sigid
(
skb
è& 
FAPI_SIG_TYPE_MASK
è=ğ
FAPI_SIG_TYPE_RES
;

4522 
šlše
 
boŞ
 
çpi_is_šd
(
sk_buff
 *
skb
)

4524  (
çpi_g‘_sigid
(
skb
è& 
FAPI_SIG_TYPE_MASK
è=ğ
FAPI_SIG_TYPE_IND
;

4527 
šlše
 
u16
 
çpi_g‘_ex³ùed_size_bË
(
sk_buff
 *
skb
, cÚ¡ u16 
çpi_size_bË
[], 
size_t
 
bË_size
, u16 
¡¬t_id
)

4529 
u16
 
id
 = 
çpi_g‘_sigid
(
skb
);

4531 ià(
id
 < 
¡¬t_id
)

4534 ià(
id
 - 
¡¬t_id
 >ğ(
u16
)
bË_size
)

4537  
çpi_size_bË
[
id
 - 
¡¬t_id
];

4540 
šlše
 
u16
 
çpi_g‘_ex³ùed_size
(
sk_buff
 *
skb
)

4542 cÚ¡ 
u16
 
çpi_ma_»q_size_bË
[] = {

4543 
çpi_sig_size
(
ma_un™d©a_»q
),

4545 
çpi_sig_size
(
ma_¥¬e_1_»q
),

4546 
çpi_sig_size
(
ma_¥¬e_2_»q
),

4547 
çpi_sig_size
(
ma_¥¬e_3_»q
),

4548 
çpi_sig_size
(
ma_¥¬e_sigÇl_1_»q
),

4549 
çpi_sig_size
(
ma_¥¬e_sigÇl_2_»q
),

4550 
çpi_sig_size
(
ma_¥¬e_sigÇl_3_»q
),

4553 cÚ¡ 
u16
 
çpi_mlme_»q_size_bË
[] = {

4554 
çpi_sig_size
(
mlme_g‘_»q
),

4555 
çpi_sig_size
(
mlme_£t_»q
),

4556 
çpi_sig_size
(
mlme_pow”mgt_»q
),

4557 
çpi_sig_size
(
mlme_add_šfo_–em’ts_»q
),

4558 
çpi_sig_size
(
mlme_add_sÿn_»q
),

4559 
çpi_sig_size
(
mlme_d–_sÿn_»q
),

4560 
çpi_sig_size
(
mlme_add_vif_»q
),

4561 
çpi_sig_size
(
mlme_d–_vif_»q
),

4562 
çpi_sig_size
(
mlme_¡¬t_»q
),

4563 
çpi_sig_size
(
mlme_£t_chªÃl_»q
),

4564 
çpi_sig_size
(
mlme_cÚÃù_»q
),

4565 
çpi_sig_size
(
mlme_»assocŸ‹_»q
),

4566 
çpi_sig_size
(
mlme_rßm_»q
),

4567 
çpi_sig_size
(
mlme_discÚÃù_»q
),

4568 
çpi_sig_size
(
mlme_»gi¡”_aùiÚ_äame_»q
),

4569 
çpi_sig_size
(
mlme_£nd_äame_»q
),

4570 
çpi_sig_size
(
mlme_»£t_dw–l_time_»q
),

4571 
çpi_sig_size
(
mlme_£t_Œaffic_·¿m‘”s_»q
),

4572 
çpi_sig_size
(
mlme_d–_Œaffic_·¿m‘”s_»q
),

4573 
çpi_sig_size
(
mlme_£t_·ck‘_f‹r_»q
),

4574 
çpi_sig_size
(
mlme_£t__add»ss_»q
),

4575 
çpi_sig_size
(
mlme_£t_aş_»q
),

4577 
çpi_sig_size
(
mlme_£tkeys_»q
),

4579 
çpi_sig_size
(
mlme_g‘_key_£qu’û_»q
),

4581 
çpi_sig_size
(
mlme_£t_pmk_»q
),

4584 
çpi_sig_size
(
mlme_£t_ÿched_chªÃls_»q
),

4585 
çpi_sig_size
(
mlme_£t_wh™–i¡_ssid_»q
),

4586 
çpi_sig_size
(
mlme_tdls_aùiÚ_»q
),

4587 
çpi_sig_size
(
mlme_chªÃl_sw™ch_»q
),

4588 
çpi_sig_size
(
mlme_mÚ™Ü_rssi_»q
),

4589 
çpi_sig_size
(
mlme_¡¬t_lšk_¡©i¡ics_»q
),

4590 
çpi_sig_size
(
mlme_¡İ_lšk_¡©i¡ics_»q
),

4592 
çpi_sig_size
(
mlme_£t_²o_li¡_»q
),

4593 
çpi_sig_size
(
mlme_ho¡_¡©e_»q
),

4594 
çpi_sig_size
(
mlme_add_¿nge_»q
),

4595 
çpi_sig_size
(
mlme_d–_¿nge_»q
),

4596 
çpi_sig_size
(
mlme_£t_nß_»q
),

4597 
çpi_sig_size
(
mlme_£t_ùwšdow_»q
),

4598 
çpi_sig_size
(
mlme_Çn_¡¬t_»q
),

4599 
çpi_sig_size
(
mlme_Çn_cÚfig_»q
),

4600 
çpi_sig_size
(
mlme_Çn_publish_»q
),

4601 
çpi_sig_size
(
mlme_Çn_subsüibe_»q
),

4602 
çpi_sig_size
(
mlme_Çn_fŞlowup_»q
),

4603 
çpi_sig_size
(
mlme_un£t_chªÃl_»q
),

4604 
çpi_sig_size
(
mlme_£t_couÁry_»q
),

4605 
çpi_sig_size
(
mlme_fÜw¬d_b—cÚ_»q
),

4606 
çpi_sig_size
(
mlme_ndp_»que¡_»q
),

4607 
çpi_sig_size
(
mlme_ndp_»¥Ú£_»q
),

4608 
çpi_sig_size
(
mlme_ndp_‹rmš©e_»q
),

4611 
çpi_sig_size
(
mlme_rßmšg_chªÃl_li¡_»q
),

4612 
çpi_sig_size
(
mlme_£t_bss_max_chªÃl_width_»q
),

4613 
çpi_sig_size
(
mlme_£t_sÿn_mode_»q
),

4614 
çpi_sig_size
(
mlme_š¡®l_­f_»q
),

4615 
çpi_sig_size
(
mlme_»ad_­f_»q
),

4616 
çpi_sig_size
(
mlme_£t_num_ª‹Âas_»q
),

4617 
çpi_sig_size
(
mlme_¬p_d‘eù_»q
),

4618 
çpi_sig_size
(
mlme_£t_rßmšg_ty³_»q
),

4619 
çpi_sig_size
(
mlme_£t_bªd_»q
),

4620 
çpi_sig_size
(
mlme_£t_rßmšg_·¿m‘”s_»q
),

4621 
çpi_sig_size
(
mlme_wifish¬šg_³rm™‹d_chªÃls_»q
),

4622 
çpi_sig_size
(
mlme_¥¬e_7_»q
),

4623 
çpi_sig_size
(
mlme_¥¬e_8_»q
),

4624 
çpi_sig_size
(
mlme_cÚfigu»_mÚ™Ü_mode_»q
),

4625 
çpi_sig_size
(
mlme_¥¬e_9_»q
),

4626 
çpi_sig_size
(
mlme_¥¬e_10_»q
),

4627 
çpi_sig_size
(
mlme_¥¬e_11_»q
),

4628 
çpi_sig_size
(
mlme_Çn_¿nge_»q
),

4629 
çpi_sig_size
(
mlme_Çn_¿nge_ÿnûl_»q
),

4630 
çpi_sig_size
(
mlme_d–ba_»q
),

4631 
çpi_sig_size
(
mlme_g‘_num_ª‹Âas_»q
),

4632 
çpi_sig_size
(
mlme_¡¬t_d‘eù_»q
),

4633 
çpi_sig_size
(
mlme_¥¬e_sigÇl_1_»q
),

4634 
çpi_sig_size
(
mlme_¥¬e_sigÇl_2_»q
),

4635 
çpi_sig_size
(
mlme_¥¬e_sigÇl_3_»q
),

4638 cÚ¡ 
u16
 
çpi_debug_»q_size_bË
[] = {

4639 
çpi_sig_size
(
debug_¥¬e_1_»q
),

4640 
çpi_sig_size
(
debug_¥¬e_2_»q
),

4641 
çpi_sig_size
(
debug_¥¬e_3_»q
),

4642 
çpi_sig_size
(
debug_¥¬e_sigÇl_1_»q
),

4643 
çpi_sig_size
(
debug_¥¬e_sigÇl_2_»q
),

4644 
çpi_sig_size
(
debug_¥¬e_sigÇl_3_»q
),

4647 cÚ¡ 
u16
 
çpi_‹¡_»q_size_bË
[] = {

4648 
çpi_sig_size
(
‹¡_block_»que¡s_»q
),

4649 
çpi_sig_size
(
‹¡_·nic_»q
),

4650 
çpi_sig_size
(
‹¡_su¥’d_»q
),

4651 
çpi_sig_size
(
‹¡_»sume_»q
),

4652 
çpi_sig_size
(
¿dio_loggšg_»q
),

4653 
çpi_sig_size
(
wÏÆ™e_cw_¡¬t_»q
),

4654 
çpi_sig_size
(
wÏÆ™e_cw_¡İ_»q
),

4655 
çpi_sig_size
(
wÏÆ™e_tx_£t_·¿ms_»q
),

4656 
çpi_sig_size
(
wÏÆ™e_tx_¡¬t_»q
),

4657 
çpi_sig_size
(
wÏÆ™e_tx_»ad_»q
),

4658 
çpi_sig_size
(
wÏÆ™e_tx_¡İ_»q
),

4659 
çpi_sig_size
(
wÏÆ™e_rx_¡¬t_»q
),

4660 
çpi_sig_size
(
wÏÆ™e_rx_»ad_»q
),

4661 
çpi_sig_size
(
wÏÆ™e_rx_¡İ_»q
),

4662 
çpi_sig_size
(
wÏÆ™e_¡©us_»q
),

4663 
çpi_sig_size
(
‹¡_pm®loc_»q
),

4664 
çpi_sig_size
(
‹¡_cÚfigu»_mÚ™Ü_mode_»q
),

4666 
çpi_sig_size
(
‹¡_check_fw_®ive_»q
),

4667 
çpi_sig_size
(
debug_g’”ic_»q
),

4668 
çpi_sig_size
(
debug_pkt_sšk_¡¬t_»q
),

4669 
çpi_sig_size
(
debug_pkt_sšk_¡İ_»q
),

4670 
çpi_sig_size
(
debug_pkt_sšk_»pÜt_»q
),

4671 
çpi_sig_size
(
debug_pkt_g’_¡¬t_»q
),

4672 
çpi_sig_size
(
debug_pkt_g’_¡İ_»q
),

4673 
çpi_sig_size
(
debug_pkt_g’_»pÜt_»q
),

4674 
çpi_sig_size
(
wÏÆ™e_¿dio_£Ëù_»q
),

4675 
çpi_sig_size
(
‹¡_h_‹¡”_¡¬t_»q
),

4676 
çpi_sig_size
(
‹¡_h_‹¡”_¡İ_»q
),

4677 
çpi_sig_size
(
‹¡_h_‹¡”_£t_·¿ms_»q
),

4678 
çpi_sig_size
(
‹¡_h_‹¡”_»pÜt_»q
),

4679 
çpi_sig_size
(
‹¡_bi¡_g‘_tx_gaš_»q
),

4680 
çpi_sig_size
(
‹¡_¡¬t_wÏÆ™e_»q
),

4681 
çpi_sig_size
(
‹¡_¥¬e_2_»q
),

4682 
çpi_sig_size
(
‹¡_¥¬e_3_»q
),

4683 
çpi_sig_size
(
phy_ev’t_loggšg_»q
),

4684 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_1_»q
),

4685 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_2_»q
),

4686 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_3_»q
),

4689 cÚ¡ 
u16
 
çpi_ma_cfm_size_bË
[] = {

4690 
çpi_sig_size
(
ma_un™d©a_cfm
),

4692 
çpi_sig_size
(
ma_¥¬e_1_cfm
),

4693 
çpi_sig_size
(
ma_¥¬e_2_cfm
),

4694 
çpi_sig_size
(
ma_¥¬e_3_cfm
),

4695 
çpi_sig_size
(
ma_¥¬e_sigÇl_1_cfm
),

4696 
çpi_sig_size
(
ma_¥¬e_sigÇl_2_cfm
),

4697 
çpi_sig_size
(
ma_¥¬e_sigÇl_3_cfm
),

4700 cÚ¡ 
u16
 
çpi_mlme_cfm_size_bË
[] = {

4701 
çpi_sig_size
(
mlme_g‘_cfm
),

4702 
çpi_sig_size
(
mlme_£t_cfm
),

4703 
çpi_sig_size
(
mlme_pow”mgt_cfm
),

4704 
çpi_sig_size
(
mlme_add_šfo_–em’ts_cfm
),

4705 
çpi_sig_size
(
mlme_add_sÿn_cfm
),

4706 
çpi_sig_size
(
mlme_d–_sÿn_cfm
),

4707 
çpi_sig_size
(
mlme_add_vif_cfm
),

4708 
çpi_sig_size
(
mlme_d–_vif_cfm
),

4709 
çpi_sig_size
(
mlme_¡¬t_cfm
),

4710 
çpi_sig_size
(
mlme_£t_chªÃl_cfm
),

4711 
çpi_sig_size
(
mlme_cÚÃù_cfm
),

4712 
çpi_sig_size
(
mlme_»assocŸ‹_cfm
),

4713 
çpi_sig_size
(
mlme_rßm_cfm
),

4714 
çpi_sig_size
(
mlme_discÚÃù_cfm
),

4715 
çpi_sig_size
(
mlme_»gi¡”_aùiÚ_äame_cfm
),

4716 
çpi_sig_size
(
mlme_£nd_äame_cfm
),

4717 
çpi_sig_size
(
mlme_»£t_dw–l_time_cfm
),

4718 
çpi_sig_size
(
mlme_£t_Œaffic_·¿m‘”s_cfm
),

4719 
çpi_sig_size
(
mlme_d–_Œaffic_·¿m‘”s_cfm
),

4720 
çpi_sig_size
(
mlme_£t_·ck‘_f‹r_cfm
),

4721 
çpi_sig_size
(
mlme_£t__add»ss_cfm
),

4722 
çpi_sig_size
(
mlme_£t_aş_cfm
),

4724 
çpi_sig_size
(
mlme_£tkeys_cfm
),

4726 
çpi_sig_size
(
mlme_g‘_key_£qu’û_cfm
),

4728 
çpi_sig_size
(
mlme_£t_pmk_cfm
),

4731 
çpi_sig_size
(
mlme_£t_ÿched_chªÃls_cfm
),

4732 
çpi_sig_size
(
mlme_£t_wh™–i¡_ssid_cfm
),

4733 
çpi_sig_size
(
mlme_tdls_aùiÚ_cfm
),

4734 
çpi_sig_size
(
mlme_chªÃl_sw™ch_cfm
),

4735 
çpi_sig_size
(
mlme_mÚ™Ü_rssi_cfm
),

4736 
çpi_sig_size
(
mlme_¡¬t_lšk_¡©i¡ics_cfm
),

4737 
çpi_sig_size
(
mlme_¡İ_lšk_¡©i¡ics_cfm
),

4739 
çpi_sig_size
(
mlme_£t_²o_li¡_cfm
),

4740 
çpi_sig_size
(
mlme_ho¡_¡©e_cfm
),

4741 
çpi_sig_size
(
mlme_add_¿nge_cfm
),

4742 
çpi_sig_size
(
mlme_d–_¿nge_cfm
),

4743 
çpi_sig_size
(
mlme_£t_nß_cfm
),

4744 
çpi_sig_size
(
mlme_£t_ùwšdow_cfm
),

4745 
çpi_sig_size
(
mlme_Çn_¡¬t_cfm
),

4746 
çpi_sig_size
(
mlme_Çn_cÚfig_cfm
),

4747 
çpi_sig_size
(
mlme_Çn_publish_cfm
),

4748 
çpi_sig_size
(
mlme_Çn_subsüibe_cfm
),

4749 
çpi_sig_size
(
mlme_Çn_fŞlowup_cfm
),

4750 
çpi_sig_size
(
mlme_un£t_chªÃl_cfm
),

4751 
çpi_sig_size
(
mlme_£t_couÁry_cfm
),

4752 
çpi_sig_size
(
mlme_fÜw¬d_b—cÚ_cfm
),

4753 
çpi_sig_size
(
mlme_ndp_»que¡_cfm
),

4754 
çpi_sig_size
(
mlme_ndp_»¥Ú£_cfm
),

4755 
çpi_sig_size
(
mlme_ndp_‹rmš©e_cfm
),

4758 
çpi_sig_size
(
mlme_rßmšg_chªÃl_li¡_cfm
),

4759 
çpi_sig_size
(
mlme_£t_bss_max_chªÃl_width_cfm
),

4760 
çpi_sig_size
(
mlme_£t_sÿn_mode_cfm
),

4761 
çpi_sig_size
(
mlme_š¡®l_­f_cfm
),

4762 
çpi_sig_size
(
mlme_»ad_­f_cfm
),

4763 
çpi_sig_size
(
mlme_£t_num_ª‹Âas_cfm
),

4764 
çpi_sig_size
(
mlme_¬p_d‘eù_cfm
),

4765 
çpi_sig_size
(
mlme_£t_rßmšg_ty³_cfm
),

4766 
çpi_sig_size
(
mlme_£t_bªd_cfm
),

4767 
çpi_sig_size
(
mlme_£t_rßmšg_·¿m‘”s_cfm
),

4768 
çpi_sig_size
(
mlme_wifish¬šg_³rm™‹d_chªÃls_cfm
),

4769 
çpi_sig_size
(
mlme_¥¬e_7_cfm
),

4770 
çpi_sig_size
(
mlme_¥¬e_8_cfm
),

4771 
çpi_sig_size
(
mlme_cÚfigu»_mÚ™Ü_mode_cfm
),

4772 
çpi_sig_size
(
mlme_¥¬e_9_cfm
),

4773 
çpi_sig_size
(
mlme_¥¬e_10_cfm
),

4774 
çpi_sig_size
(
mlme_¥¬e_11_cfm
),

4775 
çpi_sig_size
(
mlme_Çn_¿nge_cfm
),

4776 
çpi_sig_size
(
mlme_Çn_¿nge_ÿnûl_cfm
),

4777 
çpi_sig_size
(
mlme_d–ba_cfm
),

4778 
çpi_sig_size
(
mlme_g‘_num_ª‹Âas_cfm
),

4779 
çpi_sig_size
(
mlme_¡¬t_d‘eù_cfm
),

4780 
çpi_sig_size
(
mlme_¥¬e_sigÇl_1_cfm
),

4781 
çpi_sig_size
(
mlme_¥¬e_sigÇl_2_cfm
),

4782 
çpi_sig_size
(
mlme_¥¬e_sigÇl_3_cfm
),

4785 cÚ¡ 
u16
 
çpi_debug_cfm_size_bË
[] = {

4786 
çpi_sig_size
(
debug_¥¬e_1_cfm
),

4787 
çpi_sig_size
(
debug_¥¬e_2_cfm
),

4788 
çpi_sig_size
(
debug_¥¬e_3_cfm
),

4789 
çpi_sig_size
(
debug_¥¬e_sigÇl_1_cfm
),

4790 
çpi_sig_size
(
debug_¥¬e_sigÇl_2_cfm
),

4791 
çpi_sig_size
(
debug_¥¬e_sigÇl_3_cfm
),

4794 cÚ¡ 
u16
 
çpi_‹¡_cfm_size_bË
[] = {

4795 
çpi_sig_size
(
¿dio_loggšg_cfm
),

4796 
çpi_sig_size
(
wÏÆ™e_cw_¡¬t_cfm
),

4797 
çpi_sig_size
(
wÏÆ™e_tx_£t_·¿ms_cfm
),

4798 
çpi_sig_size
(
wÏÆ™e_cw_¡İ_cfm
),

4799 
çpi_sig_size
(
wÏÆ™e_tx_¡¬t_cfm
),

4800 
çpi_sig_size
(
wÏÆ™e_tx_»ad_cfm
),

4801 
çpi_sig_size
(
wÏÆ™e_tx_¡İ_cfm
),

4802 
çpi_sig_size
(
wÏÆ™e_rx_¡¬t_cfm
),

4803 
çpi_sig_size
(
wÏÆ™e_rx_»ad_cfm
),

4804 
çpi_sig_size
(
wÏÆ™e_rx_¡İ_cfm
),

4805 
çpi_sig_size
(
wÏÆ™e_¡©us_cfm
),

4806 
çpi_sig_size
(
‹¡_pm®loc_cfm
),

4807 
çpi_sig_size
(
‹¡_cÚfigu»_mÚ™Ü_mode_cfm
),

4809 
çpi_sig_size
(
‹¡_check_fw_®ive_cfm
),

4810 
çpi_sig_size
(
‹¡_su¥’d_cfm
),

4811 
çpi_sig_size
(
‹¡_»sume_cfm
),

4812 
çpi_sig_size
(
debug_g’”ic_cfm
),

4813 
çpi_sig_size
(
wÏÆ™e_¿dio_£Ëù_cfm
),

4814 
çpi_sig_size
(
‹¡_h_‹¡”_¡¬t_cfm
),

4815 
çpi_sig_size
(
‹¡_h_‹¡”_¡İ_cfm
),

4816 
çpi_sig_size
(
‹¡_h_‹¡”_£t_·¿ms_cfm
),

4817 
çpi_sig_size
(
‹¡_bi¡_g‘_tx_gaš_cfm
),

4818 
çpi_sig_size
(
‹¡_¡¬t_wÏÆ™e_cfm
),

4819 
çpi_sig_size
(
‹¡_¥¬e_2_cfm
),

4820 
çpi_sig_size
(
‹¡_¥¬e_3_cfm
),

4821 
çpi_sig_size
(
phy_ev’t_loggšg_cfm
),

4822 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_1_cfm
),

4823 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_2_cfm
),

4824 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_3_cfm
),

4827 cÚ¡ 
u16
 
çpi_ma_šd_size_bË
[] = {

4828 
çpi_sig_size
(
ma_un™d©a_šd
),

4829 
çpi_sig_size
(
ma_blockack_šd
),

4830 
çpi_sig_size
(
ma_¥¬e_1_šd
),

4831 
çpi_sig_size
(
ma_¥¬e_2_šd
),

4832 
çpi_sig_size
(
ma_¥¬e_3_šd
),

4833 
çpi_sig_size
(
ma_¥¬e_sigÇl_1_šd
),

4834 
çpi_sig_size
(
ma_¥¬e_sigÇl_2_šd
),

4835 
çpi_sig_size
(
ma_¥¬e_sigÇl_3_šd
),

4838 cÚ¡ 
u16
 
çpi_mlme_šd_size_bË
[] = {

4839 
çpi_sig_size
(
mlme_sÿn_šd
),

4840 
çpi_sig_size
(
mlme_sÿn_dÚe_šd
),

4841 
çpi_sig_size
(
mlme_li¡’_’d_šd
),

4842 
çpi_sig_size
(
mlme_cÚÃù_šd
),

4843 
çpi_sig_size
(
mlme_cÚÃùed_šd
),

4844 
çpi_sig_size
(
mlme_»assocŸ‹_šd
),

4845 
çpi_sig_size
(
mlme_rßm_šd
),

4846 
çpi_sig_size
(
mlme_rßmed_šd
),

4847 
çpi_sig_size
(
mlme_discÚÃù_šd
),

4848 
çpi_sig_size
(
mlme_discÚÃùed_šd
),

4849 
çpi_sig_size
(
mlme_´oûdu»_¡¬‹d_šd
),

4850 
çpi_sig_size
(
mlme_mic_çu»_šd
),

4851 
çpi_sig_size
(
mlme_äame_ŒªsmissiÚ_šd
),

4852 
çpi_sig_size
(
mlme_»ûived_äame_šd
),

4854 
çpi_sig_size
(
mlme_tdls_³”_šd
),

4857 
çpi_sig_size
(
mlme_rssi_»pÜt_šd
),

4858 
çpi_sig_size
(
mlme_ac_´iÜ™y_upd©e_šd
),

4859 
çpi_sig_size
(
mlme_¿nge_šd
),

4860 
çpi_sig_size
(
mlme_¿nge_dÚe_šd
),

4861 
çpi_sig_size
(
mlme_ev’t_log_šd
),

4862 
çpi_sig_size
(
mlme_Çn_ev’t_šd
),

4863 
çpi_sig_size
(
mlme_Çn_£rviû_šd
),

4864 
çpi_sig_size
(
mlme_Çn_fŞlowup_šd
),

4865 
çpi_sig_size
(
mlme_chªÃl_sw™ched_šd
),

4866 
çpi_sig_size
(
mlme_synchrÚi£d_šd
),

4867 
çpi_sig_size
(
mlme_b—cÚ_»pÜtšg_ev’t_šd
),

4868 
çpi_sig_size
(
mlme_rßmšg_chªÃl_li¡_šd
),

4869 
çpi_sig_size
(
mlme_bÏckli¡ed_šd
),

4870 
çpi_sig_size
(
mlme_ndp_»que¡_šd
),

4871 
çpi_sig_size
(
mlme_ndp_»que¡ed_šd
),

4872 
çpi_sig_size
(
mlme_ndp_»¥Ú£_šd
),

4874 
çpi_sig_size
(
mlme_ndp_‹rmš©ed_šd
),

4875 
çpi_sig_size
(
mlme_¥¬e_5_šd
),

4876 
çpi_sig_size
(
mlme_¥¬e_6_šd
),

4877 
çpi_sig_size
(
mlme_Çn_¿nge_šd
),

4878 
çpi_sig_size
(
mlme_¥¬e_7_šd
),

4879 
çpi_sig_size
(
mlme_¡¬t_d‘eù_šd
),

4880 
çpi_sig_size
(
mlme_¥¬e_sigÇl_1_šd
),

4881 
çpi_sig_size
(
mlme_¥¬e_sigÇl_2_šd
),

4882 
çpi_sig_size
(
mlme_¥¬e_sigÇl_3_šd
),

4885 cÚ¡ 
u16
 
çpi_debug_šd_size_bË
[] = {

4886 
çpi_sig_size
(
debug_wÜd12_šd
),

4887 
çpi_sig_size
(
debug_çuÉ_šd
),

4888 
çpi_sig_size
(
debug_wÜds_šd
),

4889 
çpi_sig_size
(
debug_¥¬e_2_šd
),

4890 
çpi_sig_size
(
debug_¥¬e_3_šd
),

4891 
çpi_sig_size
(
debug_¥¬e_4_šd
),

4892 
çpi_sig_size
(
debug_¥¬e_sigÇl_1_šd
),

4893 
çpi_sig_size
(
debug_¥¬e_sigÇl_2_šd
),

4894 
çpi_sig_size
(
debug_¥¬e_sigÇl_3_šd
),

4897 cÚ¡ 
u16
 
çpi_‹¡_šd_size_bË
[] = {

4898 
çpi_sig_size
(
¿dio_loggšg_šd
),

4899 
çpi_sig_size
(
debug_g’”ic_šd
),

4900 
çpi_sig_size
(
debug_pkt_sšk_»pÜt_šd
),

4901 
çpi_sig_size
(
debug_pkt_g’_»pÜt_šd
),

4902 
çpi_sig_size
(
‹¡_h_‹¡”_»pÜt_šd
),

4903 
çpi_sig_size
(
‹¡_¥¬e_1_šd
),

4904 
çpi_sig_size
(
‹¡_¥¬e_2_šd
),

4905 
çpi_sig_size
(
‹¡_¥¬e_3_šd
),

4906 
çpi_sig_size
(
phy_ev’t_loggšg_šd
),

4907 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_1_šd
),

4908 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_2_šd
),

4909 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_3_šd
),

4912 cÚ¡ 
u16
 
çpi_mlme_»s_size_bË
[] = {

4913 
çpi_sig_size
(
mlme_cÚÃù_»s
),

4914 
çpi_sig_size
(
mlme_cÚÃùed_»s
),

4915 
çpi_sig_size
(
mlme_»assocŸ‹_»s
),

4916 
çpi_sig_size
(
mlme_rßmed_»s
),

4917 
çpi_sig_size
(
mlme_tdls_³”_»s
),

4918 
çpi_sig_size
(
mlme_synchrÚi£d_»s
),

4919 
çpi_sig_size
(
mlme_¥¬e_2_»s
),

4920 
çpi_sig_size
(
mlme_¥¬e_3_»s
),

4921 
çpi_sig_size
(
mlme_¥¬e_4_»s
),

4922 
çpi_sig_size
(
mlme_¥¬e_sigÇl_1_»s
),

4923 
çpi_sig_size
(
mlme_¥¬e_sigÇl_2_»s
),

4924 
çpi_sig_size
(
mlme_¥¬e_sigÇl_3_»s
),

4927 cÚ¡ 
u16
 
çpi_ma_»s_size_bË
[] = {

4928 
çpi_sig_size
(
ma_¥¬e_1_»s
),

4929 
çpi_sig_size
(
ma_¥¬e_2_»s
),

4930 
çpi_sig_size
(
ma_¥¬e_3_»s
),

4931 
çpi_sig_size
(
ma_¥¬e_sigÇl_1_»s
),

4932 
çpi_sig_size
(
ma_¥¬e_sigÇl_2_»s
),

4933 
çpi_sig_size
(
ma_¥¬e_sigÇl_3_»s
),

4936 cÚ¡ 
u16
 
çpi_debug_»s_size_bË
[] = {

4937 
çpi_sig_size
(
debug_¥¬e_1_»s
),

4938 
çpi_sig_size
(
debug_¥¬e_2_»s
),

4939 
çpi_sig_size
(
debug_¥¬e_3_»s
),

4940 
çpi_sig_size
(
debug_¥¬e_sigÇl_1_»s
),

4941 
çpi_sig_size
(
debug_¥¬e_sigÇl_2_»s
),

4942 
çpi_sig_size
(
debug_¥¬e_sigÇl_3_»s
),

4945 cÚ¡ 
u16
 
çpi_‹¡_»s_size_bË
[] = {

4946 
çpi_sig_size
(
‹¡_¥¬e_1_»s
),

4947 
çpi_sig_size
(
‹¡_¥¬e_2_»s
),

4948 
çpi_sig_size
(
‹¡_¥¬e_3_»s
),

4949 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_1_»s
),

4950 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_2_»s
),

4951 
çpi_sig_size
(
‹¡_¥¬e_sigÇl_3_»s
),

4954 ià(
çpi_is_mlme
(
skb
è&& 
çpi_is_»q
(skb))

4955  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_mlme_»q_size_bË
, 
ARRAY_SIZE
(çpi_mlme_»q_size_bË), 
MLME_GET_REQ
);

4956 ià(
çpi_is_mlme
(
skb
è&& 
çpi_is_cfm
(skb))

4957  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_mlme_cfm_size_bË
, 
ARRAY_SIZE
(çpi_mlme_cfm_size_bË), 
MLME_GET_CFM
);

4958 ià(
çpi_is_mlme
(
skb
è&& 
çpi_is_»s
(skb))

4959  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_mlme_»s_size_bË
, 
ARRAY_SIZE
(çpi_mlme_»s_size_bË), 
MLME_CONNECT_RES
);

4960 ià(
çpi_is_mlme
(
skb
è&& 
çpi_is_šd
(skb))

4961  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_mlme_šd_size_bË
, 
ARRAY_SIZE
(çpi_mlme_šd_size_bË), 
MLME_SCAN_IND
);

4962 ià(
çpi_is_ma
(
skb
è&& 
çpi_is_»q
(skb))

4963  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_ma_»q_size_bË
, 
ARRAY_SIZE
(çpi_ma_»q_size_bË), 
MA_UNITDATA_REQ
);

4964 ià(
çpi_is_ma
(
skb
è&& 
çpi_is_cfm
(skb))

4965  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_ma_cfm_size_bË
, 
ARRAY_SIZE
(çpi_ma_cfm_size_bË), 
MA_UNITDATA_CFM
);

4966 ià(
çpi_is_ma
(
skb
è&& 
çpi_is_šd
(skb))

4967  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_ma_šd_size_bË
, 
ARRAY_SIZE
(çpi_ma_šd_size_bË), 
MA_UNITDATA_IND
);

4968 ià(
çpi_is_debug
(
skb
è&& 
çpi_is_»q
(skb))

4969  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_debug_»q_size_bË
, 
ARRAY_SIZE
(çpi_debug_»q_size_bË), 
DEBUG_GENERIC_REQ
);

4970 ià(
çpi_is_debug
(
skb
è&& 
çpi_is_cfm
(skb))

4971  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_debug_cfm_size_bË
, 
ARRAY_SIZE
(çpi_debug_cfm_size_bË), 
DEBUG_GENERIC_CFM
);

4972 ià(
çpi_is_debug
(
skb
è&& 
çpi_is_šd
(skb))

4973  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_debug_šd_size_bË
, 
ARRAY_SIZE
(çpi_debug_šd_size_bË), 
DEBUG_WORD12IND
);

4974 ià(
çpi_is_‹¡
(
skb
è&& 
çpi_is_»q
(skb))

4975  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_‹¡_»q_size_bË
, 
ARRAY_SIZE
(çpi_‹¡_»q_size_bË), 
TEST_BLOCK_REQUESTS_REQ
);

4976 ià(
çpi_is_‹¡
(
skb
è&& 
çpi_is_cfm
(skb))

4977  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_‹¡_cfm_size_bË
, 
ARRAY_SIZE
(çpi_‹¡_cfm_size_bË), 
RADIO_LOGGING_CFM
);

4978 ià(
çpi_is_‹¡
(
skb
è&& 
çpi_is_šd
(skb))

4979  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_‹¡_šd_size_bË
, 
ARRAY_SIZE
(çpi_‹¡_šd_size_bË), 
RADIO_LOGGING_IND
);

4980 ià(
çpi_is_mlme
(
skb
è&& 
çpi_is_»s
(skb))

4981  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_ma_»s_size_bË
, 
ARRAY_SIZE
(çpi_ma_»s_size_bË), 
MA_SPARE_SIGNAL_1_RES
);

4982 ià(
çpi_is_mlme
(
skb
è&& 
çpi_is_»s
(skb))

4983  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_debug_»s_size_bË
, 
ARRAY_SIZE
(çpi_debug_»s_size_bË), 
DEBUG_SPARE_SIGNAL_1_RES
);

4984 ià(
çpi_is_mlme
(
skb
è&& 
çpi_is_»s
(skb))

4985  
çpi_g‘_ex³ùed_size_bË
(
skb
, 
çpi_‹¡_»s_size_bË
, 
ARRAY_SIZE
(çpi_‹¡_»s_size_bË), 
TEST_SPARE_SIGNAL_1_RES
);

4990 #ifdeà
__ılu¥lus


	@fw_test.c

6 
	~<Ãt/cfg80211.h
>

7 
	~<lšux/‘h”deviû.h
>

8 
	~"dev.h
"

9 
	~"çpi.h
"

10 
	~"fw_‹¡.h
"

11 
	~"debug.h
"

12 
	~"mgt.h
"

13 
	~"mlme.h
"

14 
	~"Ãtif.h
"

15 
	~"ba.h
"

16 
	~"§p_mlme.h
"

18 
¦si_fw_‹¡_§ve_äame
(
¦si_dev
 *
sdev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
§ved_skbs
[
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1], sk_bufà*
skb
, 
boŞ
 
udi_h—d”
)

20 
u16
 
	gvif
;

22 
	gskb
 = 
skb_cİy
(
skb
, 
GFP_KERNEL
);

24 ià(
	gudi_h—d”
)

25 
skb_puÎ
(
skb
, (
udi_msg_t
));

27 
	gvif
 = 
çpi_g‘_vif
(
skb
);

29 
SLSI_DBG3
(
sdev
, 
SLSI_FW_TEST
, "sig:0x%.4X, vif:%d\n", 
çpi_g‘_sigid
(
skb
), 
vif
);

30 
¦si_debug_äame
(
sdev
, 
NULL
, 
skb
, "SAVE");

32 
¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

33 
kä“_skb
(
§ved_skbs
[
vif
]);

34 
	g§ved_skbs
[
vif
] = 
skb
;

35 
¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

38 
	$¦si_fw_‹¡_´oûss_äame
(
¦si_dev
 *
sdev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
, 
boŞ
 
udi_h—d”
)

40 
u16
 
vif
;

42 
skb
 = 
	`skb_cİy
(skb, 
GFP_KERNEL
);

44 ià(
udi_h—d”
)

45 
	`skb_puÎ
(
skb
, (
udi_msg_t
));

47 
vif
 = 
	`çpi_g‘_vif
(
skb
);

49 
	`SLSI_DBG3
(
sdev
, 
SLSI_FW_TEST
, "sig:0x%.4X, vif:%d\n", 
	`çpi_g‘_sigid
(
skb
), 
vif
);

50 
	`¦si_debug_äame
(
sdev
, 
NULL
, 
skb
, "PROCESS");

52 
	`¦si_skb_wÜk_’queue
(&
fw‹¡
->
fw_‹¡_wÜk
, 
skb
);

53 
	}
}

55 
	$¦si_fw_‹¡_sigÇl
(
¦si_dev
 *
sdev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

57 
u16
 
vif
 = 
	`çpi_g‘_vif
(
skb
);

60 
fw‹¡
->
fw_‹¡_’abËd
 = 
Œue
;

61 
	`SLSI_DBG3
(
sdev
, 
SLSI_FW_TEST
, "0x%p: sig:0x%.4X, vif:%d\n", 
skb
, 
	`çpi_g‘_sigid
(skb), 
vif
);

63 ià(
	`WARN
(
vif
 > 
CONFIG_SCSC_WLAN_MAX_INTERFACES
, "vif(%d) > CONFIG_SCSC_WLAN_MAX_INTERFACES", vif))

64  -
EINVAL
;

66 
	`çpi_g‘_sigid
(
skb
)) {

67 
MLME_ADD_VIF_REQ
:

68 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: SavMLME_ADD_VIF_REQ(0x%.4X, vif:%d)\n", 
skb
, 
	`çpi_g‘_sigid
(skb), 
vif
);

69 
	`¦si_fw_‹¡_§ve_äame
(
sdev
, 
fw‹¡
, fw‹¡->
mlme_add_vif_»q
, 
skb
, 
çl£
);

70 
	`¦si_fw_‹¡_´oûss_äame
(
sdev
, 
fw‹¡
, 
skb
, 
çl£
);

72 
MLME_CONNECT_REQ
:

73 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: SavMLME_CONNECT_REQ(0x%.4X, vif:%d)\n", 
skb
, 
	`çpi_g‘_sigid
(skb), 
vif
);

74 
	`¦si_fw_‹¡_§ve_äame
(
sdev
, 
fw‹¡
, fw‹¡->
mlme_cÚÃù_»q
, 
skb
, 
çl£
);

76 
MLME_DEL_VIF_REQ
:

77 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: SavMLME_DEL_VIF_REQ(0x%.4X, vif:%d)\n", 
skb
, 
	`çpi_g‘_sigid
(skb), 
vif
);

78 
	`¦si_fw_‹¡_´oûss_äame
(
sdev
, 
fw‹¡
, 
skb
, 
çl£
);

85 
	}
}

87 
	$¦si_fw_‹¡_sigÇl_w™h_udi_h—d”
(
¦si_dev
 *
sdev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

89 
udi_msg_t
 *
udi_msg
 = (udi_msg_ˆ*)
skb
->
d©a
;

90 
çpi_vif_sigÇl_h—d”
 *
çpi_h—d”
 = (çpi_vif_sigÇl_h—d” *)(
skb
->
d©a
 + (
udi_msg_t
));

92 ià(!
fw‹¡
->
fw_‹¡_’abËd
)

95 
	`SLSI_DBG3
(
sdev
, 
SLSI_FW_TEST
, "0x%p: sig:0x%.4X, vif:%d\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

97 ià(
udi_msg
->
dœeùiÚ
 =ğ
SLSI_LOG_DIRECTION_TO_HOST
) {

98 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
)) {

99 
MLME_DISCONNECT_IND
:

100 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: Proûs MLME_DISCONNECT_IND(0x%.4X, vif:%d)\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

101 
	`¦si_fw_‹¡_´oûss_äame
(
sdev
, 
fw‹¡
, 
skb
, 
Œue
);

103 
MLME_DISCONNECTED_IND
:

104 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: Proûs MLME_DISCONNECTED_IND(0x%.4X, vif:%d)\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

105 
	`¦si_fw_‹¡_´oûss_äame
(
sdev
, 
fw‹¡
, 
skb
, 
Œue
);

107 
MLME_CONNECT_IND
:

108 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: Proûs MLME_CONNECT_IND(0x%.4X, vif:%d)\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

109 
	`¦si_fw_‹¡_´oûss_äame
(
sdev
, 
fw‹¡
, 
skb
, 
Œue
);

111 
MLME_CONNECTED_IND
:

112 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: Proûs MLME_CONNECTED_IND(0x%.4X, vif:%d)\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

113 
	`¦si_fw_‹¡_´oûss_äame
(
sdev
, 
fw‹¡
, 
skb
, 
Œue
);

115 
MLME_ROAMED_IND
:

116 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: Proûs MLME_ROAMED_IND(0x%.4X, vif:%d)\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

117 
	`¦si_fw_‹¡_´oûss_äame
(
sdev
, 
fw‹¡
, 
skb
, 
Œue
);

119 
MLME_TDLS_PEER_IND
:

120 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: Proûs MLME_TDLS_PEER_IND(0x%.4X, vif:%d)\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

121 
	`¦si_fw_‹¡_´oûss_äame
(
sdev
, 
fw‹¡
, 
skb
, 
Œue
);

123 
MLME_CONNECT_CFM
:

124 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: SavMLME_CONNECT_CFM(0x%.4X, vif:%d)\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

125 
	`¦si_fw_‹¡_§ve_äame
(
sdev
, 
fw‹¡
, fw‹¡->
mlme_cÚÃù_cfm
, 
skb
, 
Œue
);

127 
MLME_PROCEDURE_STARTED_IND
:

128 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: SavMLME_PROCEDURE_STARTED_IND(0x%.4X, vif:%d)\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

129 
	`¦si_fw_‹¡_§ve_äame
(
sdev
, 
fw‹¡
, fw‹¡->
mlme_´oûdu»_¡¬‹d_šd
, 
skb
, 
Œue
);

130 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: Proûs MLME_PROCEDURE_STARTED_IND(0x%.4X, vif:%d)\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

131 
	`¦si_fw_‹¡_´oûss_äame
(
sdev
, 
fw‹¡
, 
skb
, 
Œue
);

133 
MLME_START_CFM
:

134 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: Proûs MLME_START_CFM(0x%.4X, vif:%d)\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

135 
	`¦si_fw_‹¡_´oûss_äame
(
sdev
, 
fw‹¡
, 
skb
, 
Œue
);

136 
sdev
->
deviû_cÚfig
.
­_discÚÃù_šd_timeout
 = 
SLSI_DEFAULT_AP_DISCONNECT_IND_TIMEOUT
;

138 
MA_BLOCKACK_IND
:

139 
	`SLSI_DBG2
(
sdev
, 
SLSI_FW_TEST
, "0x%p: Proûs MA_BLOCKACK_IND(0x%.4X, vif:%d)\n", 
skb
, 
	`Ë16_to_ıu
(
çpi_h—d”
->
id
),†e16_to_ıu(çpi_h—d”->
vif
));

140 
	`¦si_fw_‹¡_´oûss_äame
(
sdev
, 
fw‹¡
, 
skb
, 
Œue
);

148 
	}
}

150 
	$¦si_fw_‹¡_cÚÃù_¡©iÚ_rßm
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

152 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

153 
¦si_³”
 *
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

154 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

155 
sk_buff
 *
mlme_´oûdu»_¡¬‹d_šd
;

157 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

159 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "StiÚ CÚÃù(vif:%dèRßm\n", 
ndev_vif
->
iâum
);

161 ià(
	`WARN
(!
ndev_vif
->
is_fw_‹¡
, "!is_fw_test"))

164 ià(
	`WARN
(!
ndev_vif
->
aùiv©ed
, "Not Activated"))

167 ià(
	`WARN
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
, "Not Station Vif"))

170 ià(
	`WARN
(!
³”
, "peer‚ot found"))

173 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

174 
mlme_´oûdu»_¡¬‹d_šd
 = 
fw‹¡
->mlme_´oûdu»_¡¬‹d_šd[
ndev_vif
->
iâum
];

175 
fw‹¡
->
mlme_´oûdu»_¡¬‹d_šd
[
ndev_vif
->
iâum
] = 
NULL
;

176 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

178 ià(
	`WARN
(!
mlme_´oûdu»_¡¬‹d_šd
, "mlme_procedure_started_ind‚ot found"))

181 
	`¦si_rx_ba_¡İ_®l
(
dev
, 
³”
);

183 
	`SLSI_ETHER_COPY
(
³”
->
add»ss
, 
mgmt
->
bssid
);

184 
	`¦si_³”_upd©e_assoc_»q
(
sdev
, 
dev
, 
³”
, 
mlme_´oûdu»_¡¬‹d_šd
);

185 
	`¦si_³”_upd©e_assoc_r¥
(
sdev
, 
dev
, 
³”
, 
	`skb_cİy
(
skb
, 
GFP_KERNEL
));

186 
	}
}

188 
	$¦si_fw_‹¡_cÚÃù_¡¬t_¡©iÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

190 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

191 
sk_buff
 *
»q
;

192 
sk_buff
 *
cfm
;

193 
sk_buff
 *
šd
;

194 
¦si_³”
 *
³”
;

195 
u8
 
bssid
[
ETH_ALEN
];

197 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

199 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "StiÚ CÚÃù S¹(vif:%d)\n", 
ndev_vif
->
iâum
);

201 ià(
	`WARN
(!
ndev_vif
->
is_fw_‹¡
, "!is_fw_test"))

203 ià(
	`WARN
(
ndev_vif
->
aùiv©ed
, "Already Activated"))

206 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

207 
»q
 = 
fw‹¡
->
mlme_cÚÃù_»q
[
ndev_vif
->
iâum
];

208 
cfm
 = 
fw‹¡
->
mlme_cÚÃù_cfm
[
ndev_vif
->
iâum
];

209 
šd
 = 
fw‹¡
->
mlme_´oûdu»_¡¬‹d_šd
[
ndev_vif
->
iâum
];

210 ià(
»q
)

211 
	`SLSI_ETHER_COPY
(
bssid
, 
	`çpi_g‘_buff
(
»q
, 
u
.
mlme_cÚÃù_»q
.bssid));

212 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

214 ià(
	`WARN
(!
»q
, "mlme_connect_req Not found"))

216 ià(
	`WARN
(!
cfm
, "mlme_connect_cfm Not found"))

219 
ndev_vif
->
iáy³
 = 
NL80211_IFTYPE_STATION
;

220 
dev
->
›“80211_±r
->
iáy³
 = 
NL80211_IFTYPE_STATION
;

221 
ndev_vif
->
vif_ty³
 = 
FAPI_VIFTYPE_STATION
;

223 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "vif:%d slsi_vif_aùiv©ed\n", 
ndev_vif
->
iâum
);

224 ià(
	`WARN
(
	`¦si_vif_aùiv©ed
(
sdev
, 
dev
) != 0, "slsi_vif_activated() Failed"))

227 
³”
 = 
	`¦si_³”_add
(
sdev
, 
dev
, 
bssid
, 
SLSI_STA_PEER_QUEUESET
 + 1);

228 ià(
	`WARN
(!
³”
, "¦si_³”_add(%pMèFaed", 
bssid
)) {

229 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

233 
	`¦si_³”_upd©e_assoc_»q
(
sdev
, 
dev
, 
³”
, 
	`skb_cİy
(
skb
, 
GFP_KERNEL
));

234 
	}
}

236 
	$¦si_fw_‹¡_cÚÃù_¡©iÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

238 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

239 
sk_buff
 *
»q
;

240 
sk_buff
 *
cfm
;

241 
sk_buff
 *
šd
;

242 
¦si_³”
 *
³”
;

243 
u16
 
»suÉ
;

245 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

247 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "StiÚ CÚÃù(vif:%d)\n", 
ndev_vif
->
iâum
);

249 ià(
	`WARN
(!
ndev_vif
->
is_fw_‹¡
, "!is_fw_test"))

252 
»suÉ
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_cÚÃù_šd
.
»suÉ_code
);

254 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

255 
»q
 = 
fw‹¡
->
mlme_cÚÃù_»q
[
ndev_vif
->
iâum
];

256 
cfm
 = 
fw‹¡
->
mlme_cÚÃù_cfm
[
ndev_vif
->
iâum
];

257 
šd
 = 
fw‹¡
->
mlme_´oûdu»_¡¬‹d_šd
[
ndev_vif
->
iâum
];

258 
fw‹¡
->
mlme_cÚÃù_»q
[
ndev_vif
->
iâum
] = 
NULL
;

259 
fw‹¡
->
mlme_cÚÃù_cfm
[
ndev_vif
->
iâum
] = 
NULL
;

260 
fw‹¡
->
mlme_´oûdu»_¡¬‹d_šd
[
ndev_vif
->
iâum
] = 
NULL
;

261 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

263 ià(
	`WARN
(!
»q
, "mlme_connect_req Not found"))

264 
ex™
;

265 ià(
	`WARN
(!
cfm
, "mlme_connect_cfm Not found"))

266 
ex™
;

267 ià(
FAPI_RESULTCODE_SUCCESS
 =ğ
»suÉ
 &&

268 
	`WARN
(!
šd
, "mlme_procedure_started_ind Not found"))

269 
ex™
;

270 ià(
FAPI_RESULTCODE_SUCCESS
 !ğ
»suÉ
)

271 
ex™
;

273 ià(
	`WARN
(!
ndev_vif
->
aùiv©ed
, "Not Activated"))

276 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
	`çpi_g‘_buff
(
»q
, 
u
.
mlme_cÚÃù_»q
.
bssid
));

277 ià(
	`WARN
(!
³”
, "¦si_g‘_³”_äom_mac(%pMèFaed", 
	`çpi_g‘_buff
(
»q
, 
u
.
mlme_cÚÃù_»q
.
bssid
)))

278 
ex™
;

280 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

281 
	`Ãtif_ÿ¼›r_Ú
(
dev
);

283 
ex™
:

284 
	`kä“_skb
(
»q
);

285 
	`kä“_skb
(
cfm
);

286 
	`kä“_skb
(
šd
);

287 
	}
}

289 
	$¦si_fw_‹¡_¡¬‹d_ÃtwÜk
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

291 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

292 
u16
 
»suÉ
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_¡¬t_cfm
.
»suÉ_code
);

294 
	`SLSI_UNUSED_PARAMETER
(
fw‹¡
);

296 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

298 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "S¹ N‘wÜk(vif:%d)\n", 
ndev_vif
->
iâum
);

300 ià(
	`WARN
(!
ndev_vif
->
is_fw_‹¡
, "!is_fw_test"))

302 ià(
	`WARN
(
ndev_vif
->
aùiv©ed
, "Already Activated"))

305 
ndev_vif
->
iáy³
 = 
NL80211_IFTYPE_AP
;

306 
dev
->
›“80211_±r
->
iáy³
 = 
NL80211_IFTYPE_AP
;

307 
ndev_vif
->
vif_ty³
 = 
FAPI_VIFTYPE_AP
;

309 ià(
	`WARN
(
	`¦si_vif_aùiv©ed
(
sdev
, 
dev
) != 0, "slsi_vif_activated() Failed"))

312 ià(
FAPI_RESULTCODE_SUCCESS
 =ğ
»suÉ
)

313 
	`Ãtif_ÿ¼›r_Ú
(
dev
);

314 
	}
}

316 
	$¦si_fw_‹¡_¡İ_ÃtwÜk
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

318 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

320 
	`SLSI_UNUSED_PARAMETER
(
fw‹¡
);

321 
	`SLSI_UNUSED_PARAMETER
(
skb
);

323 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

325 ià(!
ndev_vif
->
is_fw_‹¡
)

328 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "Stİpšg N‘wÜk(vif:%d)\n", 
ndev_vif
->
iâum
);

330 ià(
	`WARN
(!
ndev_vif
->
aùiv©ed
, "Not Activated"))

333 
	`Ãtif_ÿ¼›r_off
(
dev
);

334 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

335 
	}
}

337 
	$¦si_fw_‹¡_cÚÃù_¡¬t_­
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

339 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

340 
¦si_³”
 *
³”
 = 
NULL
;

341 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

342 
u16
 
³”_šdex
;

344 
	`SLSI_UNUSED_PARAMETER
(
fw‹¡
);

346 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

348 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "N‘wÜk P“¸CÚÃù S¹(vif:%d)\n", 
ndev_vif
->
iâum
);

349 
	`WARN
(!
ndev_vif
->
is_fw_‹¡
, "!is_fw_test");

351 ià(
	`WARN
(!
ndev_vif
->
aùiv©ed
, "Not Activated"))

354 ià(
	`WARN_ON
(!
	`›“80211_is_assoc_»q
(
mgmt
->
äame_cÚŒŞ
) &&

355 !
	`›“80211_is_»assoc_»q
(
mgmt
->
äame_cÚŒŞ
)))

357 
³”_šdex
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_´oûdu»_¡¬‹d_šd
.
assocŸtiÚ_id’tif›r
);

359 
³”
 = 
	`¦si_³”_add
(
sdev
, 
dev
, 
mgmt
->
§
, 
³”_šdex
);

360 ià(
	`WARN_ON
(!
³”
))

363 
	`¦si_³”_upd©e_assoc_»q
(
sdev
, 
dev
, 
³”
, 
	`skb_cİy
(
skb
, 
GFP_KERNEL
));

364 
³”
->
cÚÃùed_¡©e
 = 
SLSI_STA_CONN_STATE_CONNECTING
;

365 
	}
}

367 
	$¦si_fw_‹¡_cÚÃùed_ÃtwÜk
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

369 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

370 
¦si_³”
 *
³”
 = 
NULL
;

371 
u16
 
aid
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_cÚÃùed_šd
.
assocŸtiÚ_id’tif›r
);

373 
	`SLSI_UNUSED_PARAMETER
(
fw‹¡
);

375 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

377 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "N‘wÜk P“¸CÚÃù(vif:%d,‡id:%d)\n", 
ndev_vif
->
iâum
, 
aid
);

378 
	`WARN
(!
ndev_vif
->
is_fw_‹¡
, "!is_fw_test");

380 ià(
	`WARN
(!
ndev_vif
->
aùiv©ed
, "Not Activated"))

383 ià(
	`WARN_ON
(
aid
 > 
SLSI_PEER_INDEX_MAX
))

386 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
aid
 - 1);

387 ià(
	`WARN
(!
³”
, "P“r×id:%dèNÙ Found", 
aid
))

390 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

391 
³”
->
cÚÃùed_¡©e
 = 
SLSI_STA_CONN_STATE_CONNECTED
;

393 
	`¦si_rx_bufã»d_äames
(
sdev
, 
dev
, 
³”
);

394 
	}
}

397 
	$¦si_fw_‹¡_´oûdu»_¡¬‹d_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

399 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

400 
sk_buff
 *
add_vif_»q
;

401 
u16
 
viáy³
 = 
FAPI_VIFTYPE_STATION
;

403 ià(!
ndev_vif
->
is_fw_‹¡
) {

404 
	`kä“_skb
(
skb
);

408 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "Proûdu»S¹ed(vif:%d)\n", 
ndev_vif
->
iâum
);

410 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_´oûdu»_¡¬‹d_šd
.
´oûdu»_ty³
è!ğ
FAPI_PROCEDURETYPE_CONNECTION_STARTED
) {

411 
	`kä“_skb
(
skb
);

416 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

417 
add_vif_»q
 = 
fw‹¡
->
mlme_add_vif_»q
[
ndev_vif
->
iâum
];

418 ià(
add_vif_»q
)

419 
viáy³
 = 
	`çpi_g‘_u16
(
add_vif_»q
, 
u
.
mlme_add_vif_»q
.
vœtu®_š‹rçû_ty³
);

420 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

422 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "S¹ UDIe¡ N‘Deviû(vif:%d)\n", 
ndev_vif
->
iâum
);

423 ià(
	`WARN
(!
add_vif_»q
, "fwtest->mlme_add_vif_req[ndev_vif->ifnum] == NULL"))

424 
out
;

426 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

428 
viáy³
) {

429 
FAPI_VIFTYPE_STATION
:

430 
	`¦si_fw_‹¡_cÚÃù_¡¬t_¡©iÚ
(
sdev
, 
dev
, 
fw‹¡
, 
skb
);

432 
FAPI_VIFTYPE_AP
:

433 
	`¦si_fw_‹¡_cÚÃù_¡¬t_­
(
sdev
, 
dev
, 
fw‹¡
, 
skb
);

436 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "vif:%d vœtu®_š‹rçû_ty³:%d NOT SUPPORTED\n", 
ndev_vif
->
iâum
, 
viáy³
);

440 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

442 
out
:

443 
	`kä“_skb
(
skb
);

444 
	}
}

447 
	$¦si_fw_‹¡_cÚÃù_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

449 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

450 
sk_buff
 *
add_vif_»q
;

451 
u16
 
viáy³
 = 
FAPI_VIFTYPE_STATION
;

453 ià(!
ndev_vif
->
is_fw_‹¡
) {

454 
	`kä“_skb
(
skb
);

458 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "N‘wÜk P“¸CÚÃù(vif:%d)\n", 
ndev_vif
->
iâum
);

460 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

461 
add_vif_»q
 = 
fw‹¡
->
mlme_add_vif_»q
[
ndev_vif
->
iâum
];

462 ià(
add_vif_»q
)

463 
viáy³
 = 
	`çpi_g‘_u16
(
add_vif_»q
, 
u
.
mlme_add_vif_»q
.
vœtu®_š‹rçû_ty³
);

464 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

466 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "S¹ UDIe¡ N‘Deviû(vif:%d)\n", 
ndev_vif
->
iâum
);

467 ià(
	`WARN
(!
add_vif_»q
, "fwtest->mlme_add_vif_req[ndev_vif->ifnum] == NULL"))

468 
out
;

470 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

472 
viáy³
) {

473 
FAPI_VIFTYPE_STATION
:

474 
	`¦si_fw_‹¡_cÚÃù_¡©iÚ
(
sdev
, 
dev
, 
fw‹¡
, 
skb
);

477 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "vif:%d vœtu®_š‹rçû_ty³:%d NOT SUPPORTED\n", 
ndev_vif
->
iâum
, 
viáy³
);

481 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

483 
out
:

484 
	`kä“_skb
(
skb
);

485 
	}
}

487 
	$¦si_fw_‹¡_cÚÃùed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

489 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

490 
sk_buff
 *
add_vif_»q
;

491 
u16
 
viáy³
 = 
FAPI_VIFTYPE_STATION
;

493 ià(!
ndev_vif
->
is_fw_‹¡
) {

494 
	`kä“_skb
(
skb
);

498 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "CÚÃùed(vif:%d)\n", 
ndev_vif
->
iâum
);

500 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

501 
add_vif_»q
 = 
fw‹¡
->
mlme_add_vif_»q
[
ndev_vif
->
iâum
];

502 ià(
add_vif_»q
)

503 
viáy³
 = 
	`çpi_g‘_u16
(
add_vif_»q
, 
u
.
mlme_add_vif_»q
.
vœtu®_š‹rçû_ty³
);

504 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

506 ià(
	`WARN
(!
add_vif_»q
, "fwtest->mlme_add_vif_req[ndev_vif->ifnum] == NULL"))

507 
out
;

509 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

511 
viáy³
) {

512 
FAPI_VIFTYPE_AP
:

513 
	`¦si_fw_‹¡_cÚÃùed_ÃtwÜk
(
sdev
, 
dev
, 
fw‹¡
, 
skb
);

516 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "vif:%d vœtu®_š‹rçû_ty³:%d NOT SUPPORTED\n", 
ndev_vif
->
iâum
, 
viáy³
);

520 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

522 
out
:

523 
	`kä“_skb
(
skb
);

524 
	}
}

526 
	$¦si_fw_‹¡_rßmed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

528 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

529 
sk_buff
 *
add_vif_»q
;

530 
u16
 
viáy³
 = 
FAPI_VIFTYPE_STATION
;

532 ià(!
ndev_vif
->
is_fw_‹¡
) {

533 
	`kä“_skb
(
skb
);

537 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "Rßmed(vif:%d)\n", 
ndev_vif
->
iâum
);

539 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

540 
add_vif_»q
 = 
fw‹¡
->
mlme_add_vif_»q
[
ndev_vif
->
iâum
];

541 ià(
add_vif_»q
)

542 
viáy³
 = 
	`çpi_g‘_u16
(
add_vif_»q
, 
u
.
mlme_add_vif_»q
.
vœtu®_š‹rçû_ty³
);

543 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

545 ià(
	`WARN
(!
add_vif_»q
, "fwtest->mlme_add_vif_req[ndev_vif->ifnum] == NULL"))

546 
out
;

548 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

550 
viáy³
) {

551 
FAPI_VIFTYPE_STATION
:

552 
	`¦si_fw_‹¡_cÚÃù_¡©iÚ_rßm
(
sdev
, 
dev
, 
fw‹¡
, 
skb
);

555 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "vif:%d vœtu®_š‹rçû_ty³:%d NOT SUPPORTED\n", 
ndev_vif
->
iâum
, 
viáy³
);

559 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

561 
out
:

562 
	`kä“_skb
(
skb
);

563 
	}
}

565 
	$¦si_fw_‹¡_discÚÃù_¡©iÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

567 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

568 
¦si_³”
 *
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

570 
	`SLSI_UNUSED_PARAMETER
(
fw‹¡
);

571 
	`SLSI_UNUSED_PARAMETER
(
skb
);

573 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

575 ià(!
ndev_vif
->
is_fw_‹¡
)

578 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "StiÚ DiscÚÃù(vif:%d)\n", 
ndev_vif
->
iâum
);

580 ià(
	`WARN
(!
ndev_vif
->
aùiv©ed
, "Not Activated"))

583 
	`Ãtif_ÿ¼›r_off
(
dev
);

584 ià(
³”
) {

585 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

586 
	`¦si_³”_»move
(
sdev
, 
dev
, 
³”
);

587 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

589 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

590 
	}
}

592 
	$¦si_fw_‹¡_discÚÃù_ÃtwÜk
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

594 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

598 
¦si_³”
 *
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_discÚÃù_šd
.
³”_¡a_add»ss
));

600 
	`SLSI_UNUSED_PARAMETER
(
fw‹¡
);

602 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

604 ià(!
ndev_vif
->
is_fw_‹¡
)

607 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "N‘wÜk P“¸DiscÚÃù(vif:%d)\n", 
ndev_vif
->
iâum
);

609 ià(
³”
) {

610 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

611 
	`¦si_³”_»move
(
sdev
, 
dev
, 
³”
);

612 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

614 
	}
}

616 
	$¦si_fw_‹¡_discÚÃùed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

618 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

619 
sk_buff
 *
add_vif_»q
;

620 
u16
 
viáy³
 = 
FAPI_VIFTYPE_STATION
;

622 ià(!
ndev_vif
->
is_fw_‹¡
) {

623 
	`kä“_skb
(
skb
);

627 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

628 
add_vif_»q
 = 
fw‹¡
->
mlme_add_vif_»q
[
ndev_vif
->
iâum
];

629 ià(
add_vif_»q
)

630 
viáy³
 = 
	`çpi_g‘_u16
(
add_vif_»q
, 
u
.
mlme_add_vif_»q
.
vœtu®_š‹rçû_ty³
);

631 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

633 ià(
	`WARN
(!
add_vif_»q
, "fwtest->mlme_add_vif_req[ndev_vif->ifnum] == NULL"))

634 
out
;

636 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

638 
viáy³
) {

639 
FAPI_VIFTYPE_STATION
:

640 
	`¦si_fw_‹¡_discÚÃù_¡©iÚ
(
sdev
, 
dev
, 
fw‹¡
, 
skb
);

642 
FAPI_VIFTYPE_AP
:

643 
	`¦si_fw_‹¡_discÚÃù_ÃtwÜk
(
sdev
, 
dev
, 
fw‹¡
, 
skb
);

646 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "vif:%d vœtu®_š‹rçû_ty³:%d NOT SUPPORTED\n", 
ndev_vif
->
iâum
, 
viáy³
);

649 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

651 
out
:

652 
	`kä“_skb
(
skb
);

653 
	}
}

655 
	$¦si_fw_‹¡_tdls_ev’t_cÚÃùed
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

657 
¦si_³”
 *
³”
 = 
NULL
;

658 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

659 
u16
 
³”_šdex
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_tdls_³”_šd
.peer_index);

661 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

662 
ndev_vif
->
¡a
.
tdls_’abËd
 = 
Œue
;

663 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "TDLS cÚÃù (vif:%d,…“r_šdex:%d, mac:%pM)\n", 
	`çpi_g‘_vif
(
skb
), 
³”_šdex
, 
	`çpi_g‘_buff
(skb, 
u
.
mlme_tdls_³”_šd
.
³”_¡a_add»ss
));

665 ià((
ndev_vif
->
¡a
.
tdls_³”_¡a_»cÜds
è+ 1 > 
SLSI_TDLS_PEER_CONNECTIONS_MAX
) {

666 
	`SLSI_NET_ERR
(
dev
, "max TDLS†im™„—ched (³”_šdex:%d)\n", 
³”_šdex
);

667 
out
;

670 ià(
³”_šdex
 < 
SLSI_TDLS_PEER_INDEX_MIN
 ||…“r_šdex > 
SLSI_TDLS_PEER_INDEX_MAX
) {

671 
	`SLSI_NET_ERR
(
dev
, "šcÜ»ù index (³”_šdex:%d)\n", 
³”_šdex
);

672 
out
;

675 
³”
 = 
	`¦si_³”_add
(
sdev
, 
dev
, 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_tdls_³”_šd
.
³”_¡a_add»ss
), 
³”_šdex
);

676 ià(!
³”
) {

677 
	`SLSI_NET_ERR
(
dev
, "peer‡dd failed\n");

678 
out
;

682 
³”
->
qos_’abËd
 = 
Œue
;

683 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

686 
	`¦si_tdls_move_·ck‘s
(
sdev
, 
dev
, 
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
], 
³”
, 
Œue
);

688 
out
:

689 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

690 
	}
}

692 
	$¦si_fw_‹¡_tdls_ev’t_discÚÃùed
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

694 
¦si_³”
 *
³”
 = 
NULL
;

695 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

697 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

698 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "TDLS dis-cÚÃù (vif:%d, mac:%pM)\n", 
ndev_vif
->
iâum
, 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_tdls_³”_šd
.
³”_¡a_add»ss
));

700 
	`¦si_¥šlock_lock
(&
ndev_vif
->
tı_ack_lock
);

701 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

702 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_tdls_³”_šd
.
³”_¡a_add»ss
));

703 ià(!
³”
 || (³”->
aid
 == 0)) {

704 
	`WARN_ON
(!
³”
 || (³”->
aid
 == 0));

705 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "can't find…eer by MAC‡ddress\n");

706 
out
;

709 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DISCONNECTED
);

712 
	`¦si_tdls_move_·ck‘s
(
sdev
, 
dev
, 
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
], 
³”
, 
çl£
);

713 
	`¦si_³”_»move
(
sdev
, 
dev
, 
³”
);

714 
out
:

715 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

716 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

717 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

718 
	}
}

720 
	$¦si_fw_‹¡_tdls_³”_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

722 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

723 
sk_buff
 *
add_vif_»q
;

724 
u16
 
vif_ty³
 = 0;

725 
u16
 
tdls_ev’t
;

727 ià(!
ndev_vif
->
is_fw_‹¡
) {

728 
	`kä“_skb
(
skb
);

731 ià(
	`WARN
(!
ndev_vif
->
aùiv©ed
, "Not Activated")) {

732 
	`kä“_skb
(
skb
);

735 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

736 
add_vif_»q
 = 
fw‹¡
->
mlme_add_vif_»q
[
ndev_vif
->
iâum
];

737 ià(
add_vif_»q
)

738 
vif_ty³
 = 
	`çpi_g‘_u16
(
add_vif_»q
, 
u
.
mlme_add_vif_»q
.
vœtu®_š‹rçû_ty³
);

739 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

741 ià(
	`WARN
(
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
, "Not STA VIF")) {

742 
	`kä“_skb
(
skb
);

746 
tdls_ev’t
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_tdls_³”_šd
.tdls_event);

747 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "TDLS…“r(vif:%ddls_ev’t:%d)\n", 
ndev_vif
->
iâum
, 
tdls_ev’t
);

748 
tdls_ev’t
) {

749 
FAPI_TDLSEVENT_CONNECTED
:

750 
	`¦si_fw_‹¡_tdls_ev’t_cÚÃùed
(
sdev
, 
dev
, 
skb
);

752 
FAPI_TDLSEVENT_DISCONNECTED
:

753 
	`¦si_fw_‹¡_tdls_ev’t_discÚÃùed
(
sdev
, 
dev
, 
skb
);

755 
FAPI_TDLSEVENT_DISCOVERED
:

759 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "vif:%ddls_ev’t:%d‚Ù suµÜ‹d\n", 
ndev_vif
->
iâum
, 
tdls_ev’t
);

762 
	`kä“_skb
(
skb
);

763 
	}
}

766 
	$¦si_fw_‹¡_¡¬t_cfm
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

768 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

769 
sk_buff
 *
add_vif_»q
;

770 
u16
 
viáy³
 = 
FAPI_VIFTYPE_UNSYNCHRONISED
;

772 ià(!
ndev_vif
->
is_fw_‹¡
) {

773 
	`kä“_skb
(
skb
);

777 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "N‘wÜk S¹(vif:%d)\n", 
ndev_vif
->
iâum
);

779 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

780 
add_vif_»q
 = 
fw‹¡
->
mlme_add_vif_»q
[
ndev_vif
->
iâum
];

781 ià(
add_vif_»q
)

782 
viáy³
 = 
	`çpi_g‘_u16
(
add_vif_»q
, 
u
.
mlme_add_vif_»q
.
vœtu®_š‹rçû_ty³
);

783 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

785 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "S¹ UDIe¡ N‘Deviû(vif:%d)\n", 
ndev_vif
->
iâum
);

786 ià(
	`WARN
(!
add_vif_»q
, "fwtest->mlme_add_vif_req[ndev_vif->ifnum] == NULL"))

787 
out
;

789 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

791 
viáy³
) {

792 
FAPI_VIFTYPE_AP
:

793 
	`¦si_fw_‹¡_¡¬‹d_ÃtwÜk
(
sdev
, 
dev
, 
fw‹¡
, 
skb
);

796 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "vif:%d vœtu®_š‹rçû_ty³:%d NOT SUPPORTED\n", 
ndev_vif
->
iâum
, 
viáy³
);

800 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

802 
out
:

803 
	`kä“_skb
(
skb
);

804 
	}
}

806 
	$¦si_fw_‹¡_add_vif_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

808 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

810 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

811 
	`SLSI_UNUSED_PARAMETER
(
fw‹¡
);

813 
	`SLSI_DBG1
(
sdev
, 
SLSI_FW_TEST
, "M¬k UDIe¡ N‘Deviû(vif:%d)\n", 
	`çpi_g‘_vif
(
skb
));

814 
ndev_vif
->
is_fw_‹¡
 = 
Œue
;

815 
	`kä“_skb
(
skb
);

816 
	}
}

818 
	$¦si_fw_‹¡_d–_vif_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

820 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

821 
sk_buff
 *
add_vif_»q
;

822 
u16
 
viáy³
 = 
FAPI_VIFTYPE_UNSYNCHRONISED
;

824 
	`SLSI_DBG1
(
sdev
, 
SLSI_FW_TEST
, "Unm¬k UDIe¡ N‘Deviû(vif:%d)\n", 
	`çpi_g‘_vif
(
skb
));

826 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

827 
add_vif_»q
 = 
fw‹¡
->
mlme_add_vif_»q
[
ndev_vif
->
iâum
];

828 ià(
add_vif_»q
)

829 
viáy³
 = 
	`çpi_g‘_u16
(
add_vif_»q
, 
u
.
mlme_add_vif_»q
.
vœtu®_š‹rçû_ty³
);

830 
	`kä“_skb
(
fw‹¡
->
mlme_add_vif_»q
[
ndev_vif
->
iâum
]);

831 
	`kä“_skb
(
fw‹¡
->
mlme_cÚÃù_»q
[
ndev_vif
->
iâum
]);

832 
	`kä“_skb
(
fw‹¡
->
mlme_cÚÃù_cfm
[
ndev_vif
->
iâum
]);

833 
	`kä“_skb
(
fw‹¡
->
mlme_´oûdu»_¡¬‹d_šd
[
ndev_vif
->
iâum
]);

835 
fw‹¡
->
mlme_add_vif_»q
[
ndev_vif
->
iâum
] = 
NULL
;

836 
fw‹¡
->
mlme_cÚÃù_»q
[
ndev_vif
->
iâum
] = 
NULL
;

837 
fw‹¡
->
mlme_cÚÃù_cfm
[
ndev_vif
->
iâum
] = 
NULL
;

838 
fw‹¡
->
mlme_´oûdu»_¡¬‹d_šd
[
ndev_vif
->
iâum
] = 
NULL
;

839 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

841 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

843 
viáy³
) {

847 
FAPI_VIFTYPE_AP
:

848 
	`¦si_fw_‹¡_¡İ_ÃtwÜk
(
sdev
, 
dev
, 
fw‹¡
, 
skb
);

851 ià(
ndev_vif
->
is_fw_‹¡
 &&‚dev_vif->
aùiv©ed
) {

852 
	`Ãtif_ÿ¼›r_off
(
dev
);

853 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

857 
ndev_vif
->
is_fw_‹¡
 = 
çl£
;

859 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

861 
	`kä“_skb
(
skb
);

862 
	}
}

864 
	$¦si_fw_‹¡_ma_blockack_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
)

866 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

868 ià(!
ndev_vif
->
is_fw_‹¡
) {

869 
	`kä“_skb
(
skb
);

873 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_FW_TEST
, "MA Block Ack IndiÿtiÚ(vif:%d)\n", 
ndev_vif
->
iâum
);

874 
	`¦si_rx_blockack_šd
(
sdev
, 
dev
, 
skb
);

875 
	}
}

877 
	$¦si_fw_‹¡_wÜk
(
wÜk_¡ruù
 *
wÜk
)

879 
¦si_fw_‹¡
 *
fw_‹¡
 = 
	`cÚš”_of
(
wÜk
, ¦si_fw_‹¡, 
fw_‹¡_wÜk
.work);

880 
¦si_dev
 *
sdev
 = 
fw_‹¡
->sdev;

881 
sk_buff
 *
skb
 = 
	`¦si_skb_wÜk_dequeue
(&
fw_‹¡
->
fw_‹¡_wÜk
);

882 
Ãt_deviû
 *
dev
;

884 
skb
) {

885 
u16
 
vif
 = 
	`çpi_g‘_vif
(
skb
);

887 
	`SLSI_DBG3
(
sdev
, 
SLSI_FW_TEST
, "0x%p: SigÇl:0x%.4X, vif:%d\n", 
skb
, 
	`çpi_g‘_sigid
(skb), 
vif
);

889 ià(
	`WARN
(!
vif
, "!vif")) {

890 
	`kä“_skb
(
skb
);

891 
skb
 = 
	`¦si_skb_wÜk_dequeue
(&
fw_‹¡
->
fw_‹¡_wÜk
);

895 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

896 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
vif
);

897 ià(!
dev
) {

899 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

900 
	`kä“_skb
(
skb
);

901 
skb
 = 
	`¦si_skb_wÜk_dequeue
(&
fw_‹¡
->
fw_‹¡_wÜk
);

905 
	`çpi_g‘_sigid
(
skb
)) {

906 
MLME_PROCEDURE_STARTED_IND
:

907 
	`¦si_fw_‹¡_´oûdu»_¡¬‹d_šd
(
sdev
, 
dev
, 
fw_‹¡
, 
skb
);

909 
MLME_CONNECT_IND
:

910 
	`¦si_fw_‹¡_cÚÃù_šd
(
sdev
, 
dev
, 
fw_‹¡
, 
skb
);

912 
MLME_ROAMED_IND
:

913 
	`¦si_fw_‹¡_rßmed_šd
(
sdev
, 
dev
, 
fw_‹¡
, 
skb
);

915 
MLME_CONNECTED_IND
:

916 
	`¦si_fw_‹¡_cÚÃùed_šd
(
sdev
, 
dev
, 
fw_‹¡
, 
skb
);

918 
MLME_DISCONNECT_IND
:

919 
MLME_DISCONNECTED_IND
:

920 
	`¦si_fw_‹¡_discÚÃùed_šd
(
sdev
, 
dev
, 
fw_‹¡
, 
skb
);

922 
MLME_TDLS_PEER_IND
:

923 
	`¦si_fw_‹¡_tdls_³”_šd
(
sdev
, 
dev
, 
fw_‹¡
, 
skb
);

925 
MLME_START_CFM
:

926 
	`¦si_fw_‹¡_¡¬t_cfm
(
sdev
, 
dev
, 
fw_‹¡
, 
skb
);

928 
MLME_ADD_VIF_REQ
:

929 
	`¦si_fw_‹¡_add_vif_»q
(
sdev
, 
dev
, 
fw_‹¡
, 
skb
);

931 
MLME_DEL_VIF_REQ
:

932 
	`¦si_fw_‹¡_d–_vif_»q
(
sdev
, 
dev
, 
fw_‹¡
, 
skb
);

934 
MA_BLOCKACK_IND
:

935 
	`¦si_fw_‹¡_ma_blockack_šd
(
sdev
, 
dev
, 
fw_‹¡
, 
skb
);

938 
	`WARN
(1, "Unhandled Signal");

939 
	`kä“_skb
(
skb
);

942 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

944 
skb
 = 
	`¦si_skb_wÜk_dequeue
(&
fw_‹¡
->
fw_‹¡_wÜk
);

946 
	}
}

948 
	$¦si_fw_‹¡_š™
(
¦si_dev
 *
sdev
, 
¦si_fw_‹¡
 *
fw‹¡
)

950 
	`SLSI_DBG1
(
sdev
, 
SLSI_FW_TEST
, "\n");

951 
	`mem£t
(
fw‹¡
, 0x00, (
¦si_fw_‹¡
));

952 
fw‹¡
->
sdev
 = sdev;

953 
	`¦si_¥šlock_ü—‹
(&
fw‹¡
->
fw_‹¡_lock
);

954 
	`¦si_skb_wÜk_š™
(
sdev
, 
NULL
, &
fw‹¡
->
fw_‹¡_wÜk
, "¦si_wÏn_fw_‹¡", 
¦si_fw_‹¡_wÜk
);

955 
	}
}

957 
	$¦si_fw_‹¡_deš™
(
¦si_dev
 *
sdev
, 
¦si_fw_‹¡
 *
fw‹¡
)

959 
i
;

961 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

963 
	`SLSI_DBG1
(
sdev
, 
SLSI_FW_TEST
, "\n");

964 
fw‹¡
->
fw_‹¡_’abËd
 = 
çl£
;

965 
	`¦si_skb_wÜk_deš™
(&
fw‹¡
->
fw_‹¡_wÜk
);

966 
	`¦si_¥šlock_lock
(&
fw‹¡
->
fw_‹¡_lock
);

967 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

968 
	`kä“_skb
(
fw‹¡
->
mlme_add_vif_»q
[
i
]);

969 
	`kä“_skb
(
fw‹¡
->
mlme_cÚÃù_»q
[
i
]);

970 
	`kä“_skb
(
fw‹¡
->
mlme_cÚÃù_cfm
[
i
]);

971 
	`kä“_skb
(
fw‹¡
->
mlme_´oûdu»_¡¬‹d_šd
[
i
]);

973 
fw‹¡
->
mlme_add_vif_»q
[
i
] = 
NULL
;

974 
fw‹¡
->
mlme_cÚÃù_»q
[
i
] = 
NULL
;

975 
fw‹¡
->
mlme_cÚÃù_cfm
[
i
] = 
NULL
;

976 
fw‹¡
->
mlme_´oûdu»_¡¬‹d_šd
[
i
] = 
NULL
;

978 
	`¦si_¥šlock_uÆock
(&
fw‹¡
->
fw_‹¡_lock
);

979 
	`mem£t
(
fw‹¡
, 0x00, (
¦si_fw_‹¡
));

980 
	}
}

	@fw_test.h

7 #iâdeà
__SLSI_FW_TEST_H__


8 
	#__SLSI_FW_TEST_H__


	)

10 
	~"dev.h
"

12 
	s¦si_fw_‹¡
 {

13 
¦si_dev
 *
	msdev
;

14 
boŞ
 
	mfw_‹¡_’abËd
;

15 
¦si_skb_wÜk
 
	mfw_‹¡_wÜk
;

16 
¦si_¥šlock
 
	mfw_‹¡_lock
;

17 
sk_buff
 *
	mmlme_add_vif_»q
[
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1];

18 
sk_buff
 *
	mmlme_cÚÃù_»q
[
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1];

19 
sk_buff
 *
	mmlme_cÚÃù_cfm
[
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1];

20 
sk_buff
 *
	mmlme_´oûdu»_¡¬‹d_šd
[
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1];

23 
¦si_fw_‹¡_š™
(
¦si_dev
 *
sdev
, 
¦si_fw_‹¡
 *
fw‹¡
);

24 
¦si_fw_‹¡_deš™
(
¦si_dev
 *
sdev
, 
¦si_fw_‹¡
 *
fw‹¡
);

25 
¦si_fw_‹¡_sigÇl
(
¦si_dev
 *
sdev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
);

26 
¦si_fw_‹¡_sigÇl_w™h_udi_h—d”
(
¦si_dev
 *
sdev
, 
¦si_fw_‹¡
 *
fw‹¡
, 
sk_buff
 *
skb
);

	@hanged_record.h

7 #iâdeà
__HANGED_RECORD_H__


8 
	#__HANGED_RECORD_H__


	)

10 
	#HANGED_FW_VERSION_SIZE
 (70)

	)

11 
	#HANGED_HOST_VERSION_SIZE
 (64)

	)

12 
	#HANGED_VERSION_SIZE
 (4)

	)

13 
	#HANGED_FW_PANIC_SIZE
 (4)

	)

14 
	#HANGED_OFFSET_SIZE
 (4)

	)

15 
	#HANGED_RESERVED
 (3)

	)

16 
	#HANGED_PANIC_RECORD_COUNT
 (145)

	)

17 
	#HANGED_PANIC_RECORD_SIZE
 ((
HANGED_PANIC_RECORD_COUNT
è* (
scsc_fw_»cÜd_t
))

	)

20 
	#HANGED_OFFSET_DATA
 "011C"

	)

22 
	#HANGED_PANIC_VERSION
 "0000"

	)

24 
	tscsc_fw_»cÜd_t
;

27 
	sscsc_hªged_»cÜd
 {

28 
	mhªg_ty³
[5];

29 
	mv”
[8];

30 
	mcook
[16];

31 
	mhg01
[8];

32 
	mhg02
[8];

33 
	mhg03
[8];

34 
	mhg04
[8];

35 
	mhg05
[8];

36 
	mhg06
[8];

37 
	mv”siÚ
[
HANGED_VERSION_SIZE
];

38 
	mfw_v”siÚ
[
HANGED_FW_VERSION_SIZE
];

39 
	mho¡_v”siÚ
[
HANGED_HOST_VERSION_SIZE
];

41 
	mfw_·nic
[
HANGED_FW_PANIC_SIZE
];

43 
	moff£t_d©a
[
HANGED_OFFSET_SIZE
];

44 
	m»£rved
[
HANGED_RESERVED
];

45 
	m·nic_»cÜd
[
HANGED_PANIC_RECORD_SIZE
];

46 } 
	g__·cked
;

51 
	#HANGED_PANIC_RECORD_HEX_SZ
 (((
scsc_fw_»cÜd_t
è* 2))

	)

52 
	#HANGED_VERSION_FORMATTING
 "%04X"

	)

53 
	#HANGED_FW_PANIC_FORMATTING
 "%04X"

	)

54 
	#HANGED_PANIC_REC_FORMATTING
 "%08X"

	)

	@hip.c

7 
	~<scsc/scsc_logršg.h
>

9 
	~"h.h
"

10 
	~"debug.h
"

11 
	~"´ocfs.h
"

12 
	~"§p.h
"

13 
	~"h4.h
"

14 #ifdeà
CONFIG_SCSC_SMAPPER


15 
	~"h4_sm­³r.h
"

19 
	sh_§p
 {

20 
§p_­i
 *
	m§p
[
SAP_TOTAL
];

21 } 
	gh_§p_cÚt
;

24 
	$¦si_h_§p_»gi¡”
(
§p_­i
 *sap_api)

26 
u8
 
şass
 = 
§p_­i
->
§p_şass
;

28 ià(
şass
 >ğ
SAP_TOTAL
)

29  -
ENODEV
;

31 
h_§p_cÚt
.
§p
[
şass
] = 
§p_­i
;

34 
	}
}

37 
	$¦si_h_§p_uÄegi¡”
(
§p_­i
 *sap_api)

39 
u8
 
şass
 = 
§p_­i
->
§p_şass
;

41 ià(
şass
 >ğ
SAP_TOTAL
)

42  -
ENODEV
;

44 
h_§p_cÚt
.
§p
[
şass
] = 
NULL
;

47 
	}
}

49 
	$¦si_h_§p_£tup
(
¦si_dev
 *
sdev
)

52 
u16
 
v”siÚ
 = 0;

53 
u32
 
cÚf_h4_v”
 = 0;

55 
cÚf_h4_v”
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
š™
);

58 ià((!
h_§p_cÚt
.
§p
[
SAP_MLME
]è|| (!h_§p_cÚt.§p[
SAP_MA
]) ||

59 (!
h_§p_cÚt
.
§p
[
SAP_DBG
]è|| (!h_§p_cÚt.§p[
SAP_TST
]))

60  -
ENODEV
;

62 ià(
h_§p_cÚt
.
§p
[
SAP_MLME
]->
§p_v”siÚ_suµÜ‹d
) {

63 ià(
cÚf_h4_v”
 == 4)

64 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_mlme_v”
);

65 ià(
cÚf_h4_v”
 == 5)

66 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_mlme_v”
);

67 ià(
h_§p_cÚt
.
§p
[
SAP_MLME
]->
	`§p_v”siÚ_suµÜ‹d
(
v”siÚ
))

68  -
ENODEV
;

70  -
ENODEV
;

73 ià(
h_§p_cÚt
.
§p
[
SAP_MA
]->
§p_v”siÚ_suµÜ‹d
) {

74 ià(
cÚf_h4_v”
 == 4)

75 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_ma_v”
);

76 ià(
cÚf_h4_v”
 == 5)

77 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_ma_v”
);

78 ià(
h_§p_cÚt
.
§p
[
SAP_MA
]->
	`§p_v”siÚ_suµÜ‹d
(
v”siÚ
))

79  -
ENODEV
;

81  -
ENODEV
;

84 ià(
h_§p_cÚt
.
§p
[
SAP_DBG
]->
§p_v”siÚ_suµÜ‹d
) {

85 ià(
cÚf_h4_v”
 == 4)

86 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_debug_v”
);

87 ià(
cÚf_h4_v”
 == 5)

88 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_debug_v”
);

89 ià(
h_§p_cÚt
.
§p
[
SAP_DBG
]->
	`§p_v”siÚ_suµÜ‹d
(
v”siÚ
))

90  -
ENODEV
;

92  -
ENODEV
;

95 ià(
h_§p_cÚt
.
§p
[
SAP_TST
]->
§p_v”siÚ_suµÜ‹d
) {

96 ià(
cÚf_h4_v”
 == 4)

97 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_‹¡_v”
);

98 ià(
cÚf_h4_v”
 == 5)

99 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_‹¡_v”
);

100 ià(
h_§p_cÚt
.
§p
[
SAP_TST
]->
	`§p_v”siÚ_suµÜ‹d
(
v”siÚ
))

101  -
ENODEV
;

103  -
ENODEV
;

108 
	}
}

110 
	$¦si_h_£rviû_nÙif›r
(
nÙif›r_block
 *
nb
, 
ev’t
, *
d©a
)

112 
¦si_dev
 *
sdev
 = (¦si_dev *)
d©a
;

113 
i
;

115 ià(!
sdev
)

116  
NOTIFY_BAD
;

119 ià((!
h_§p_cÚt
.
§p
[
SAP_MLME
]è|| (!h_§p_cÚt.§p[
SAP_MA
]) ||

120 (!
h_§p_cÚt
.
§p
[
SAP_DBG
]è|| (!h_§p_cÚt.§p[
SAP_TST
]))

121  
NOTIFY_BAD
;

124 
i
 = 0; i < 
SAP_TOTAL
; i++)

125 ià(
h_§p_cÚt
.
§p
[
i
]->
§p_nÙif›r
) {

126 ià(
h_§p_cÚt
.
§p
[
i
]->
	`§p_nÙif›r
(
sdev
, 
ev’t
))

127  
NOTIFY_BAD
;

130 
ev’t
) {

131 
SCSC_WIFI_STOP
:

132 
	`SLSI_INFO
(
sdev
, "Freeze HIP4\n");

133 
	`mu‹x_lock
(&
sdev
->
h
.
h_mu‹x
);

134 
	`h4_ä“ze
(&
sdev
->
h4_š¡
);

135 
	`mu‹x_uÆock
(&
sdev
->
h
.
h_mu‹x
);

138 
SCSC_WIFI_FAILURE_RESET
:

139 
	`SLSI_INFO
(
sdev
, "Set HIP4 up‡gain\n");

140 
	`mu‹x_lock
(&
sdev
->
h
.
h_mu‹x
);

141 
	`h4_£tup
(&
sdev
->
h4_š¡
);

142 
	`mu‹x_uÆock
(&
sdev
->
h
.
h_mu‹x
);

145 
SCSC_WIFI_SUSPEND
:

146 
	`SLSI_INFO
(
sdev
, "Suspend HIP4\n");

147 
	`mu‹x_lock
(&
sdev
->
h
.
h_mu‹x
);

148 
	`h4_su¥’d
(&
sdev
->
h4_š¡
);

149 
	`mu‹x_uÆock
(&
sdev
->
h
.
h_mu‹x
);

152 
SCSC_WIFI_RESUME
:

153 
	`SLSI_INFO
(
sdev
, "Resume HIP4\n");

154 
	`mu‹x_lock
(&
sdev
->
h
.
h_mu‹x
);

155 
	`h4_»sume
(&
sdev
->
h4_š¡
);

156 
	`mu‹x_uÆock
(&
sdev
->
h
.
h_mu‹x
);

159 
SCSC_WIFI_SUBSYSTEM_RESET
:

160 
SCSC_WIFI_CHIP_READY
:

164 
	`SLSI_INFO
(
sdev
, "UnknowÀev’ˆcod%lu\n", 
ev’t
);

168  
NOTIFY_OK
;

169 
	}
}

171 
nÙif›r_block
 
	gcm_nb
 = {

172 .
nÙif›r_ÿÎ
 = 
¦si_h_£rviû_nÙif›r
,

175 
	$¦si_h_š™
(
¦si_dev
 *
sdev
, 
deviû
 *
dev
)

177 
	`SLSI_UNUSED_PARAMETER
(
dev
);

179 
	`mem£t
(&
sdev
->
h4_š¡
, 0, (sdev->hip4_inst));

181 
sdev
->
h
.sdev = sdev;

182 
	`©omic_£t
(&
sdev
->
h
.
h_¡©e
, 
SLSI_HIP_STATE_STOPPED
);

183 
	`mu‹x_š™
(&
sdev
->
h
.
h_mu‹x
);

188 
	`¦si_wÏn_£rviû_nÙif›r_»gi¡”
(&
cm_nb
);

191 
	}
}

193 
	$¦si_h_deš™
(
¦si_dev
 *
sdev
)

195 
	`¦si_wÏn_£rviû_nÙif›r_uÄegi¡”
(&
cm_nb
);

196 
	`mu‹x_de¡roy
(&
sdev
->
h
.
h_mu‹x
);

197 
	}
}

199 
	$¦si_h_¡¬t
(
¦si_dev
 *
sdev
)

201 ià(!
sdev
->
maxw–l_cÜe
) {

202 
	`SLSI_ERR
(
sdev
, "Maxwell core does‚otƒxist\n");

203  -
EINVAL
;

206 
	`SLSI_DBG4
(
sdev
, 
SLSI_HIP_INIT_DEINIT
, "[1/3]. Update HIP state (SLSI_HIP_STATE_STARTING)\n");

207 
	`©omic_£t
(&
sdev
->
h
.
h_¡©e
, 
SLSI_HIP_STATE_STARTING
);

209 
	`SLSI_DBG4
(
sdev
, 
SLSI_HIP_INIT_DEINIT
, "[2/3]. Initialise HIP\n");

210 ià(
	`h4_š™
(&
sdev
->
h4_š¡
)) {

211 
	`©omic_£t
(&
sdev
->
h
.
h_¡©e
, 
SLSI_HIP_STATE_STOPPED
);

212 
	`SLSI_ERR
(
sdev
, "hip4_init failed\n");

213  -
EINVAL
;

216 
	`SLSI_DBG4
(
sdev
, 
SLSI_HIP_INIT_DEINIT
, "[3/3]. Update HIP state (SLSI_HIP_STATE_STARTED)\n");

217 
	`©omic_£t
(&
sdev
->
h
.
h_¡©e
, 
SLSI_HIP_STATE_STARTED
);

220 
	}
}

223 
	$¦si_h_rx
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

225 
u16
 
pid
;

228 ià((!
h_§p_cÚt
.
§p
[
SAP_MLME
]è|| (!h_§p_cÚt.§p[
SAP_MA
]) ||

229 (!
h_§p_cÚt
.
§p
[
SAP_DBG
]è|| (!h_§p_cÚt.§p[
SAP_TST
]))

230  -
ENODEV
;

239 ià(
	`çpi_is_ma
(
skb
))

240 
	`SCSC_BIN_TAG_DEBUG
(
BIN_WIFI_DATA_RX
, 
skb
->
d©a
, skb->
Ën
);

242 
	`SCSC_BIN_TAG_DEBUG
(
BIN_WIFI_CTRL_RX
, 
skb
->
d©a
, skb->
Ën
);

244 
	`¦si_log_ş›Ás_log_sigÇl_ç¡
(
sdev
, &sdev->
log_ş›Ás
, 
skb
, 
SLSI_LOG_DIRECTION_TO_HOST
);

245 
pid
 = 
	`çpi_g‘_u16
(
skb
, 
»ûiv”_pid
);

246 ià(
pid
 >ğ
SLSI_TX_PROCESS_ID_UDI_MIN
 &&…id <ğ
SLSI_TX_PROCESS_ID_UDI_MAX
) {

247 #ifdeà
CONFIG_SCSC_SMAPPER


248 
	`h4_sm­³r_ä“_m­³d_skb
(
skb
);

250 
	`kä“_skb
(
skb
);

254 ià(
	`çpi_is_ma
(
skb
)) {

258 ià(
	`çpi_g‘_sigid
(
skb
è=ğ
MA_BLOCKACK_IND
)

259  
h_§p_cÚt
.
§p
[
SAP_MLME
]->
	`§p_hªdËr
(
sdev
, 
skb
);

261  
h_§p_cÚt
.
§p
[
SAP_MA
]->
	`§p_hªdËr
(
sdev
, 
skb
);

264 ià(
	`çpi_is_mlme
(
skb
))

265  
h_§p_cÚt
.
§p
[
SAP_MLME
]->
	`§p_hªdËr
(
sdev
, 
skb
);

267 ià(
	`çpi_is_debug
(
skb
))

268  
h_§p_cÚt
.
§p
[
SAP_DBG
]->
	`§p_hªdËr
(
sdev
, 
skb
);

270 ià(
	`çpi_is_‹¡
(
skb
))

271  
h_§p_cÚt
.
§p
[
SAP_TST
]->
	`§p_hªdËr
(
sdev
, 
skb
);

273  -
EIO
;

274 
	}
}

277 
	$¦si_h_tx_dÚe
(
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
, u8 
ac
)

279  
h_§p_cÚt
.
§p
[
SAP_MA
]->
	`§p_txdÚe
(
sdev
, 
vif
, 
³”_šdex
, 
ac
);

280 
	}
}

282 
	$¦si_h_£tup
(
¦si_dev
 *
sdev
)

284 
u32
 
»t_v®
;

285 
	`mu‹x_lock
(&
sdev
->
h
.
h_mu‹x
);

288 
»t_v®
 = 
	`h4_£tup
(&
sdev
->
h4_š¡
);

290 
	`mu‹x_uÆock
(&
sdev
->
h
.
h_mu‹x
);

291  
»t_v®
;

292 
	}
}

294 #ifdeà
CONFIG_SCSC_SMAPPER


295 
	$¦si_h_cÚsume_sm­³r_’Œy
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

297  
	`h4_sm­³r_cÚsume_’Œy
(
sdev
, &sdev->
h4_š¡
, 
skb
);

298 
	}
}

300 
sk_buff
 *
	$¦si_h_g‘_skb_äom_sm­³r
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

302  
	`h4_sm­³r_g‘_skb
(
sdev
, &sdev->
h4_š¡
, 
skb
);

303 
	}
}

305 *
	$¦si_h_g‘_skb_d©a_äom_sm­³r
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

307  
	`h4_sm­³r_g‘_skb_d©a
(
sdev
, &sdev->
h4_š¡
, 
skb
);

308 
	}
}

311 
	$¦si_h_¡İ
(
¦si_dev
 *
sdev
)

313 
	`mu‹x_lock
(&
sdev
->
h
.
h_mu‹x
);

315 ià(
	`©omic_»ad
(&
sdev
->
h
.
h_¡©e
è!ğ
SLSI_HIP_STATE_STARTED
) {

316 
	`mu‹x_uÆock
(&
sdev
->
h
.
h_mu‹x
);

319 
	`SLSI_DBG4
(
sdev
, 
SLSI_HIP_INIT_DEINIT
, "Update HIP state (SLSI_HIP_STATE_STOPPING)\n");

320 
	`©omic_£t
(&
sdev
->
h
.
h_¡©e
, 
SLSI_HIP_STATE_STOPPING
);

322 
	`h4_deš™
(&
sdev
->
h4_š¡
);

324 
	`SLSI_DBG4
(
sdev
, 
SLSI_HIP_INIT_DEINIT
, "Update HIP state (SLSI_HIP_STATE_STOPPED)\n");

325 
	`©omic_£t
(&
sdev
->
h
.
h_¡©e
, 
SLSI_HIP_STATE_STOPPED
);

327 
	`mu‹x_uÆock
(&
sdev
->
h
.
h_mu‹x
);

329 
	}
}

330 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


331 
	$¦si_h_£t_Çpi_ıu
(
¦si_dev
 *
sdev
, 
u8
 
Çpi_ıu
, 
boŞ
 
³rf_mode
)

333 
	`h4_£t_Çpi_ıu
(&
sdev
->
h4_š¡
, 
Çpi_ıu
, 
³rf_mode
);

334 
	}
}

336 
	$¦si_h_»´oûss_sk³d_ù¾_bh
(
¦si_dev
 *
sdev
)

338 
¦si_h4
 *
h4
 = &
sdev
->
h4_š¡
;

340 
	`h4_sched_wq_ù¾
(
h4
);

341 
	}
}

343 
	$¦si_h_»´oûss_sk³d_d©a_bh
(
¦si_dev
 *
sdev
)

345 
¦si_h4
 *
h4
 = &
sdev
->
h4_š¡
;

347 
	`h4_sched_wq
(
h4
);

348 
	}
}

	@hip.h

7 #iâdeà
__SLSI_HIP_H__


8 
	#__SLSI_HIP_H__


	)

10 
	~<lšux/ty³s.h
>

11 
	~<lšux/deviû.h
>

12 
	~<lšux/skbuff.h
>

14 
	g¦si_dev
;

19 
	s¦si_ÿrd_šfo
 {

20 
u16
 
	mch_id
;

21 
u32
 
	mfw_bud
;

22 
u16
 
	mfw_h_v”siÚ
;

23 
u32
 
	msdio_block_size
;

34 
	e¦si_h_¡©e
 {

35 
	mSLSI_HIP_STATE_STOPPED
,

36 
	mSLSI_HIP_STATE_STARTING
,

37 
	mSLSI_HIP_STATE_STARTED
,

38 
	mSLSI_HIP_STATE_STOPPING
,

39 
	mSLSI_HIP_STATE_BLOCKED


42 
	s¦si_h
 {

43 
¦si_dev
 *
	msdev
;

44 
¦si_ÿrd_šfo
 
	mÿrd_šfo
;

46 
mu‹x
 
	mh_mu‹x
;

49 
©omic_t
 
	mh_¡©e
;

52 
	#SLSI_HIP_PARAM_SLOT_COUNT
 2

	)

54 
¦si_h_š™
(
¦si_dev
 *
sdev
, 
deviû
 *
dev
);

55 
¦si_h_deš™
(
¦si_dev
 *
sdev
);

57 
¦si_h_¡¬t
(
¦si_dev
 *
sdev
);

58 
¦si_h_£tup
(
¦si_dev
 *
sdev
);

59 
¦si_h_cÚsume_sm­³r_’Œy
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
);

60 *
¦si_h_g‘_skb_d©a_äom_sm­³r
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
);

61 
sk_buff
 *
¦si_h_g‘_skb_äom_sm­³r
(
¦si_dev
 *
sdev
, sk_bufà*
skb
);

62 
¦si_h_¡İ
(
¦si_dev
 *
sdev
);

63 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


64 
¦si_h_£t_Çpi_ıu
(
¦si_dev
 *
sdev
, 
u8
 
Çpi_ıu
, 
boŞ
 
³rf_mode
);

65 
¦si_h_»´oûss_sk³d_ù¾_bh
(
¦si_dev
 *
sdev
);

67 
¦si_h_»´oûss_sk³d_d©a_bh
(
¦si_dev
 *
sdev
);

71 
	g§p_­i
;

72 
	gsk_buff
;

75 
¦si_h_§p_»gi¡”
(
§p_­i
 *sap_api);

77 
¦si_h_§p_uÄegi¡”
(
§p_­i
 *sap_api);

79 
¦si_h_rx
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
);

81 
¦si_h_§p_£tup
(
¦si_dev
 *
sdev
);

83 
¦si_h_tx_dÚe
(
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
, u8 
ac
);

	@hip4.c

7 
	~<lšux/¦ab.h
>

8 
	~<lšux/š‹¼u±.h
>

9 
	~<lšux/d–ay.h
>

10 
	~<lšux/wÜkqueue.h
>

11 
	~<scsc/scsc_mx.h
>

12 
	~<scsc/scsc_miäam.h
>

13 
	~<lšux/ktime.h
>

14 
	~<lšux/kth»ad.h
>

15 
	~<scsc/scsc_logršg.h
>

16 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


17 
	~<lšux/ıu.h
>

18 
	~<lšux/b™m­.h
>

21 
	~"h4.h
"

22 
	~"mbulk.h
"

23 
	~"dev.h
"

24 
	~"h4_§m¶”.h
"

26 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


27 
	~"scsc_wifogg”_ršgs.h
"

30 
	~"debug.h
"

33 
DEFINE_SPINLOCK
(
š_Çpi_cÚ‹xt
);

35 #iâdeà
CONFIG_SCSC_WLAN_RX_NAPI


36 
boŞ
 
	gh4_rx_æowcÚŒŞ
;

39 
boŞ
 
	gh4_sy¡em_wq
;

40 
moduË_·¿m
(
h4_sy¡em_wq
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

41 
MODULE_PARM_DESC
(
h4_sy¡em_wq
, "Use system wq instead of‚amed workqueue. (default: N)");

43 #ià
IS_ENABLED
(
CONFIG_SCSC_LOGRING
)

44 
boŞ
 
	gh4_dyÇmic_loggšg
 = 
Œue
;

45 
moduË_·¿m
(
h4_dyÇmic_loggšg
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

46 
MODULE_PARM_DESC
(
h4_dyÇmic_loggšg
, "Dynamic†ogging,†ogring is disabled ifput > hip4_qos_med_tput_in_mbps. (default: Y)");

48 
	gh4_dyÇmic_loggšg_ut_š_mbps
 = 150;

49 
moduË_·¿m
(
h4_dyÇmic_loggšg_ut_š_mbps
, , 
S_IRUGO
 | 
S_IWUSR
);

50 
MODULE_PARM_DESC
(
h4_dyÇmic_loggšg_ut_š_mbps
, "throughput (in Mbps)o‡pply dynamic†ogring†ogging");

53 #ifdeà
CONFIG_SCSC_QOS


54 
boŞ
 
	gh4_qos_’abË
 = 
Œue
;

55 
moduË_·¿m
(
h4_qos_’abË
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

56 
MODULE_PARM_DESC
(
h4_qos_’abË
, "enable HIP4 PM QoS. (default: Y)");

58 
	gh4_qos_max_ut_š_mbps
 = 250;

59 
moduË_·¿m
(
h4_qos_max_ut_š_mbps
, , 
S_IRUGO
 | 
S_IWUSR
);

60 
MODULE_PARM_DESC
(
h4_qos_max_ut_š_mbps
, "throughput (in Mbps)o‡pply Max PM QoS");

62 
	gh4_qos_med_ut_š_mbps
 = 150;

63 
moduË_·¿m
(
h4_qos_med_ut_š_mbps
, , 
S_IRUGO
 | 
S_IWUSR
);

64 
MODULE_PARM_DESC
(
h4_qos_med_ut_š_mbps
, "throughput (in Mbps)o‡pply Median PM QoS");

67 #ifdeà
CONFIG_SCSC_SMAPPER


68 
boŞ
 
	gh4_sm­³r_’abË
 = 
Œue
;

69 
moduË_·¿m
(
h4_sm­³r_’abË
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

70 
MODULE_PARM_DESC
(
h4_sm­³r_’abË
, "enable HIP4 SMAPPER. (default: Y)");

71 
boŞ
 
	gh4_sm­³r_is_’abËd
;

74 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


75 
	#SLSI_HIP_NAPI_STATE_ENABLED
 (0x1)

	)

77 #ifdeà
CONFIG_SOC_EXYNOS7885


78 
	gÇpi_£Ëù_ıu
 = 7;

80 
	gÇpi_£Ëù_ıu
;

82 
moduË_·¿m
(
Çpi_£Ëù_ıu
, , 0644);

83 
MODULE_PARM_DESC
(
Çpi_£Ëù_ıu
, "select‡ specific CPUoƒxecute NAPI…oll");

85 
ušt
 
	gh4_Çpi_num_rx_pkts
 = 80;

86 
moduË_·¿m
(
h4_Çpi_num_rx_pkts
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

87 
MODULE_PARM_DESC
(
h4_Çpi_num_rx_pkts
, "number of…ackets in Rx queueo deem it‡s full");

89 
ušt
 
	gh4_Çpi_num_rx_fuÎ
 = 3;

90 
moduË_·¿m
(
h4_Çpi_num_rx_fuÎ
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

91 
MODULE_PARM_DESC
(
h4_Çpi_num_rx_fuÎ
, "number of iterations of Rx queue fullhat signalo moveo high…erformance");

94 
	gmax_bufã»d_äames
 = 10000;

95 
moduË_·¿m
(
max_bufã»d_äames
, , 
S_IRUGO
 | 
S_IWUSR
);

96 
MODULE_PARM_DESC
(
max_bufã»d_äames
, "Maximum‚umber of frameso buffer inhe driver");

98 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


99 
ktime_t
 
	gšŒ_»ûived_fb
;

100 
ktime_t
 
	gbh_š™_fb
;

101 
ktime_t
 
	gbh_’d_fb
;

102 
ktime_t
 
	gšŒ_»ûived_ù¾
;

103 
ktime_t
 
	gbh_š™_ù¾
;

104 
ktime_t
 
	gbh_’d_ù¾
;

105 
ktime_t
 
	gšŒ_»ûived_d©a
;

106 
ktime_t
 
	gbh_š™_d©a
;

107 
ktime_t
 
	gbh_’d_d©a
;

109 
ktime_t
 
	gšŒ_»ûived
;

110 
ktime_t
 
	gbh_š™
;

111 
ktime_t
 
	gbh_’d
;

113 
ktime_t
 
	gwdt
;

114 
ktime_t
 
	g£nd
;

115 
ktime_t
 
	gşosšg
;

117 
	erw
 {

118 
	mwidx
,

119 
	mridx
,

122 
u8
 
h4_»ad_šdex
(
¦si_h4
 *
h
, 
u32
 
q
, 
rw
 
r_w
);

126 
	#FW_OWN_OFS
 (64)

	)

146 
	gq_idx_Ïyout
[6][2] = {

147 { 0, 
FW_OWN_OFS
 + 0},

148 { 1, 
FW_OWN_OFS
 + 1},

149 { 
FW_OWN_OFS
 + 2, 2},

150 { 
FW_OWN_OFS
 + 3, 3},

151 { 
FW_OWN_OFS
 + 4, 4},

152 { 5, 
FW_OWN_OFS
 + 5}

156 
	#FW_OWN_VIF
 (96)

	)

181 
	#MAX_STORM
 5

	)

184 
	#SLSI_HIP_WAKELOCK_TIME_OUT_IN_MS
 (1000)

	)

186 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


188 
u64
 
	ghi¡og¿m_1
;

189 
u64
 
	ghi¡og¿m_2
;

190 
u64
 
	ghi¡og¿m_3
;

191 
u64
 
	ghi¡og¿m_4
;

192 
u64
 
	ghi¡og¿m_5
;

193 
u64
 
	ghi¡og¿m_6
;

194 
u64
 
	gmax_j™‹r
;

196 
	#HISTO_1
 1000

	)

197 
	#HISTO_2
 10000

	)

198 
	#HISTO_3
 100000

	)

199 
	#HISTO_4
 1000000

	)

200 
	#HISTO_5
 10000000

	)

202 
u64
 
	ghi¡og¿m_1_d©a
;

203 
u64
 
	ghi¡og¿m_2_d©a
;

204 
u64
 
	ghi¡og¿m_3_d©a
;

205 
u64
 
	ghi¡og¿m_4_d©a
;

206 
u64
 
	ghi¡og¿m_5_d©a
;

207 
u64
 
	ghi¡og¿m_6_d©a
;

208 
u64
 
	gmax_d©a
;

210 
	#HISTO_1_DATA
 50

	)

211 
	#HISTO_2_DATA
 100

	)

212 
	#HISTO_3_DATA
 150

	)

213 
	#HISTO_4_DATA
 200

	)

214 
	#HISTO_5_DATA
 250

	)

217 
	#MAX_HISTORY_RECORDS
 32

	)

219 
	#FH
 0

	)

220 
	#TH
 1

	)

222 
	sh4_hi¡Üy
 {

223 
boŞ
 
	mdœ
;

224 
u32
 
	msigÇl
;

225 
u32
 
	mút
;

226 
ktime_t
 
	mÏ¡_time
;

227 } 
	gh4_sigÇl_hi¡Üy
[
MAX_HISTORY_RECORDS
];

229 
u32
 
	ghi¡Üy_»cÜd
;

232 
	$h4_hi¡Üy_»cÜd_add
(
boŞ
 
dœ
, 
u32
 
sigÇl_id
)

234 
h4_hi¡Üy
 
»cÜd
;

236 
»cÜd
 = 
h4_sigÇl_hi¡Üy
[
hi¡Üy_»cÜd
];

238 ià(
»cÜd
.
sigÇl
 =ğ
sigÇl_id
 &&„ecÜd.
dœ
 == dir) {

240 
»cÜd
.
Ï¡_time
 = 
	`ktime_g‘
();

241 
»cÜd
.
út
 += 1;

242 
h4_sigÇl_hi¡Üy
[
hi¡Üy_»cÜd
] = 
»cÜd
;

246 
hi¡Üy_»cÜd
 = (hi¡Üy_»cÜd + 1è& (
MAX_HISTORY_RECORDS
 - 1);

248 
»cÜd
 = 
h4_sigÇl_hi¡Üy
[
hi¡Üy_»cÜd
];

249 
»cÜd
.
dœ
 = dir;

250 
»cÜd
.
sigÇl
 = 
sigÇl_id
;

251 
»cÜd
.
út
 = 1;

252 
»cÜd
.
Ï¡_time
 = 
	`ktime_g‘
();

253 
h4_sigÇl_hi¡Üy
[
hi¡Üy_»cÜd
] = 
»cÜd
;

254 
	}
}

256 
	#HIP4_HISTORY
(
š_£q_fe
, 
m
, 
fmt
, 
¬g
 ...) \

258 ià(
š_£q_fe
) \

259 
	`£q_´štf
(
m
, 
fmt
, ## 
¬g
); \

261 
	`SLSI_ERR_NODEV
(
fmt
, ## 
¬g
); \

262 } 0)

	)

264 
	$h4_hi¡Üy_»cÜd_´št
(
boŞ
 
š_£q_fe
, 
£q_fe
 *
m
)

266 
h4_hi¡Üy
 
»cÜd
;

267 
u32
 
i
, 
pos
;

268 
ktime_t
 
Şd
;

270 
Şd
 = 
	`ktime_£t
(0, 0);

273 
pos
 = (
hi¡Üy_»cÜd
 + 1è& (
MAX_HISTORY_RECORDS
 - 1);

275 
	`HIP4_HISTORY
(
š_£q_fe
, 
m
, "dir\t signal\t cnt\t†ast_time(ns) \t\t gap(ns)\n");

276 
	`HIP4_HISTORY
(
š_£q_fe
, 
m
, "-----------------------------------------------------------------------------\n");

277 
i
 = 0; i < 
MAX_HISTORY_RECORDS
; i++) {

278 
»cÜd
 = 
h4_sigÇl_hi¡Üy
[
pos
];

280 ià(
»cÜd
.
út
) {

281 
	`HIP4_HISTORY
(
š_£q_fe
, 
m
, "%s\ˆ0x%04x\ˆ%d\ˆ%Îd \t%Îd\n", 
»cÜd
.
dœ
 ? "<--TH" : "FH-->",

282 
»cÜd
.
sigÇl
,„ecÜd.
út
, 
	`ktime_to_ns
ÔecÜd.
Ï¡_time
), ktime_to_ns(
	`ktime_sub
ÔecÜd.Ï¡_time, 
Şd
)));

284 
Şd
 = 
»cÜd
.
Ï¡_time
;

285 
pos
 = (po + 1è& (
MAX_HISTORY_RECORDS
 - 1);

287 
	}
}

289 
	$h4_´oc_show_hi¡Üy
(
£q_fe
 *
m
, *
v
)

291 
	`h4_hi¡Üy_»cÜd_´št
(
Œue
, 
m
);

293 
	}
}

295 
	$h4_´oc_hi¡Üy_İ’
(
šode
 *šode, 
fe
 *file)

297  
	`sšgË_İ’
(
fe
, 
h4_´oc_show_hi¡Üy
, 
	`PDE_DATA
(
šode
));

298 
	}
}

300 cÚ¡ 
fe_İ”©iÚs
 
	gh4_´ocfs_hi¡Üy_fİs
 = {

301 .
owÃr
 = 
THIS_MODULE
,

302 .
	gİ’
 = 
h4_´oc_hi¡Üy_İ’
,

303 .
	g»ad
 = 
£q_»ad
,

304 .
	gÎ£ek
 = 
£q_l£ek
,

305 .
	g»Ëa£
 = 
sšgË_»Ëa£
,

308 
	$h4_´oc_show
(
£q_fe
 *
m
, *
v
)

310 
¦si_h4
 *
h
 = 
m
->
´iv©e
;

311 
h4_h_cÚŒŞ
 *
h_cÚŒŞ
;

312 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

313 
u8
 
i
;

315 
u32
 
cÚf_h4_v”
 = 0;

316 *
h_±r
;

318 ià(!
h
->
h_´iv
) {

319 
	`£q_puts
(
m
, "HIP4‚ot‡ctive\n");

323 
cÚf_h4_v”
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ
(&
h
->
h_cÚŒŞ
->
š™
);

326 ià(
cÚf_h4_v”
 != 4 && conf_hip4_ver != 3) {

327 
	`SLSI_ERR_NODEV
("FW V”siÚ %d‚Ù suµÜ‹d o¸H ha nÙ b“À£ˆup\n", 
cÚf_h4_v”
);

333 
h_±r
 = 
	`scsc_mx_£rviû_mif_addr_to_±r
(
sdev
->
£rviû
, 
h
->
h_»f
);

335 
h_cÚŒŞ
 = (
h4_h_cÚŒŞ
 *)(
h_±r
 +

336 
HIP4_WLAN_CONFIG_OFFSET
);

338 
	`£q_puts
(
m
, "-----------------------------------------\n");

339 
	`£q_puts
(
m
, "HIP4 CONFIG:\n");

340 
	`£q_puts
(
m
, "-----------------------------------------\n");

341 
	`£q_´štf
(
m
, "cÚfig k”ÃÈadd¸ = %p\n", 
h_cÚŒŞ
);

342 ià(
cÚf_h4_v”
 == 4) {

343 
	`£q_´štf
(
m
, "h4_v”siÚ_4‡dd¸ = 0x%p\n", &
h_cÚŒŞ
->
cÚfig_v4
);

344 
	`£q_´štf
(
m
, "magic_numb” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
magic_numb”
);

345 
	`£q_´štf
(
m
, "h_cÚfig_v” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
h_cÚfig_v”
);

346 
	`£q_´štf
(
m
, "cÚfig_ËÀ = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
cÚfig_Ën
);

347 
	`£q_´štf
(
m
, "com·t_æag = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
com·t_æag
);

348 
	`£q_´štf
(
m
, "§p_mlme_v” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
§p_mlme_v”
);

349 
	`£q_´štf
(
m
, "§p_ma_v” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
§p_ma_v”
);

350 
	`£q_´štf
(
m
, "§p_debug_v” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
§p_debug_v”
);

351 
	`£q_´štf
(
m
, "§p_‹¡_v” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
§p_‹¡_v”
);

352 
	`£q_´štf
(
m
, "fw_bud_id = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
fw_bud_id
);

353 
	`£q_´štf
(
m
, "fw_·tch_id = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
fw_·tch_id
);

354 
	`£q_´štf
(
m
, "unid©_»q_h—droom = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
unid©_»q_h—droom
);

355 
	`£q_´štf
(
m
, "unid©_»q_room = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
unid©_»q_room
);

356 
	`£q_´štf
(
m
, "bulk_bufãr_®igÀ = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
bulk_bufãr_®ign
);

357 
	`£q_´štf
(
m
, "ho¡_ÿche_lš = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
ho¡_ÿche_lše
);

358 
	`£q_´štf
(
m
, "ho¡_buf_loø = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
ho¡_buf_loc
);

359 
	`£q_´štf
(
m
, "ho¡_buf_sz = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
ho¡_buf_sz
);

360 
	`£q_´štf
(
m
, "fw_buf_loø = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
fw_buf_loc
);

361 
	`£q_´štf
(
m
, "fw_buf_sz = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
fw_buf_sz
);

362 
	`£q_´štf
(
m
, "mib_buf_loø = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
mib_loc
);

363 
	`£q_´štf
(
m
, "mib_buf_sz = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
mib_sz
);

364 
	`£q_´štf
(
m
, "log_cÚfig_loø = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
log_cÚfig_loc
);

365 
	`£q_´štf
(
m
, "log_cÚfig_sz = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
log_cÚfig_sz
);

366 
	`£q_´štf
(
m
, "mif_fh_št_À = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
mif_fh_št_n
);

367 
	`£q_´štf
(
m
, "mif_th_št_n[FH_CTRL] = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
mif_th_št_n
[
HIP4_MIF_Q_FH_CTRL
]);

368 
	`£q_´štf
(
m
, "mif_th_št_n[FH_DAT] = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
mif_th_št_n
[
HIP4_MIF_Q_FH_DAT
]);

369 
	`£q_´štf
(
m
, "mif_th_št_n[FH_RFB] = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
mif_th_št_n
[
HIP4_MIF_Q_FH_RFB
]);

370 
	`£q_´štf
(
m
, "mif_th_št_n[TH_CTRL] = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
mif_th_št_n
[
HIP4_MIF_Q_TH_CTRL
]);

371 
	`£q_´štf
(
m
, "mif_th_št_n[TH_DAT] = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
mif_th_št_n
[
HIP4_MIF_Q_TH_DAT
]);

372 
	`£q_´štf
(
m
, "mif_th_št_n[TH_RFB] = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
mif_th_št_n
[
HIP4_MIF_Q_TH_RFB
]);

373 
	`£q_´štf
(
m
, "scbrd_loø = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
scbrd_loc
);

374 
	`£q_´štf
(
m
, "q_num = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
q_num
);

375 
	`£q_´štf
(
m
, "q_ËÀ = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
q_Ën
);

376 
	`£q_´štf
(
m
, "q_idx_sz = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v4
.
q_idx_sz
);

377 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++)

378 
	`£q_´štf
(
m
, "q_loc[%d] = 0x%x\n", 
i
, 
h_cÚŒŞ
->
cÚfig_v4
.
q_loc
[i]);

379 } ià(
cÚf_h4_v”
 == 5) {

380 
	`£q_´štf
(
m
, "h4_v”siÚ_5‡dd¸ğ0x%p\n", &
h_cÚŒŞ
->
cÚfig_v5
);

381 
	`£q_´štf
(
m
, "magic_numb” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
magic_numb”
);

382 
	`£q_´štf
(
m
, "h_cÚfig_v” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
h_cÚfig_v”
);

383 
	`£q_´štf
(
m
, "cÚfig_ËÀ = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
cÚfig_Ën
);

384 
	`£q_´štf
(
m
, "com·t_æag = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
com·t_æag
);

385 
	`£q_´štf
(
m
, "§p_mlme_v” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
§p_mlme_v”
);

386 
	`£q_´štf
(
m
, "§p_ma_v” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
§p_ma_v”
);

387 
	`£q_´štf
(
m
, "§p_debug_v” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
§p_debug_v”
);

388 
	`£q_´štf
(
m
, "§p_‹¡_v” = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
§p_‹¡_v”
);

389 
	`£q_´štf
(
m
, "fw_bud_id = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
fw_bud_id
);

390 
	`£q_´štf
(
m
, "fw_·tch_id = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
fw_·tch_id
);

391 
	`£q_´štf
(
m
, "unid©_»q_h—droom = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
unid©_»q_h—droom
);

392 
	`£q_´štf
(
m
, "unid©_»q_room = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
unid©_»q_room
);

393 
	`£q_´štf
(
m
, "bulk_bufãr_®igÀ = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
bulk_bufãr_®ign
);

394 
	`£q_´štf
(
m
, "ho¡_ÿche_lš = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
ho¡_ÿche_lše
);

395 
	`£q_´štf
(
m
, "ho¡_buf_loø = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
ho¡_buf_loc
);

396 
	`£q_´štf
(
m
, "ho¡_buf_sz = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
ho¡_buf_sz
);

397 
	`£q_´štf
(
m
, "fw_buf_loø = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
fw_buf_loc
);

398 
	`£q_´štf
(
m
, "fw_buf_sz = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
fw_buf_sz
);

399 
	`£q_´štf
(
m
, "mib_buf_loø = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
mib_loc
);

400 
	`£q_´štf
(
m
, "mib_buf_sz = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
mib_sz
);

401 
	`£q_´štf
(
m
, "log_cÚfig_loø = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
log_cÚfig_loc
);

402 
	`£q_´štf
(
m
, "log_cÚfig_sz = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
log_cÚfig_sz
);

403 
	`£q_´štf
(
m
, "mif_fh_št_À = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
mif_fh_št_n
);

404 
	`£q_´štf
(
m
, "mif_th_št_À = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
mif_th_št_n
);

405 
	`£q_´štf
(
m
, "scbrd_loø = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
scbrd_loc
);

406 
	`£q_´štf
(
m
, "q_num = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
q_num
);

407 
	`£q_´štf
(
m
, "q_ËÀ = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
q_Ën
);

408 
	`£q_´štf
(
m
, "q_idx_sz = 0x%x\n", 
h_cÚŒŞ
->
cÚfig_v5
.
q_idx_sz
);

409 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++)

410 
	`£q_´štf
(
m
, "q_loc[%d] = 0x%x\n", 
i
, 
h_cÚŒŞ
->
cÚfig_v5
.
q_loc
[i]);

412 
	`£q_puts
(
m
, "\n-----------------------------------------\n");

413 
	`£q_puts
(
m
, "HIP4 SCOREBOARD INDEXES:\n");

414 
	`£q_puts
(
m
, "-----------------------------------------\n");

415 
	`£q_´štf
(
m
, "ktim¡¬ˆ%Îd (ns)\n", 
	`ktime_to_ns
(
h
->
h_´iv
->
¡©s
.
¡¬t
));

416 
	`£q_´štf
(
m
, "ktimnow %Îd (ns)\n\n", 
	`ktime_to_ns
(
	`ktime_g‘
()));

418 
	`£q_´štf
(
m
, "rx_šŒ_toho¡ 0x%x\n", 
h
->
h_´iv
->
šŒ_toho¡
);

419 
	`£q_´štf
(
m
, "rx_šŒ_äomho¡ 0x%x\n\n", 
h
->
h_´iv
->
šŒ_äomho¡
);

422 
	`£q_´štf
(
m
, "HIP IRQs: %u\n", 
	`©omic_»ad
(&
h
->
h_´iv
->
¡©s
.
œqs
));

423 
	`£q_´štf
(
m
, "HIP IRQ ¥urious: %u\n", 
	`©omic_»ad
(&
h
->
h_´iv
->
¡©s
.
¥urious_œqs
));

424 
	`£q_´štf
(
m
, "FW debug-šds: %u\n\n", 
	`©omic_»ad
(&
sdev
->
debug_šds
));

426 
	`£q_puts
(
m
, "Queue\tIndex\tFrames\n");

427 
	`£q_puts
(
m
, "-----\t-----\t------\n");

429 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++) {

430 
	`£q_´štf
(
m
, "Q%dW\t0x%x\t\n", 
i
, 
	`h4_»ad_šdex
(
h
, i, 
widx
));

431 
	`£q_´štf
(
m
, "Q%dR\t0x%x\t%d\n", 
i
, 
	`h4_»ad_šdex
(
h
, i, 
ridx
), h->
h_´iv
->
¡©s
.
q_num_äames
[i]);

433 
	`£q_puts
(
m
, "\n");

435 
	}
}

437 
	$h4_´oc_İ’
(
šode
 *šode, 
fe
 *file)

439  
	`sšgË_İ’
(
fe
, 
h4_´oc_show
, 
	`PDE_DATA
(
šode
));

440 
	}
}

442 cÚ¡ 
fe_İ”©iÚs
 
	gh4_´ocfs_¡©s_fİs
 = {

443 .
owÃr
 = 
THIS_MODULE
,

444 .
	gİ’
 = 
h4_´oc_İ’
,

445 .
	g»ad
 = 
£q_»ad
,

446 .
	gÎ£ek
 = 
£q_l£ek
,

447 .
	g»Ëa£
 = 
sšgË_»Ëa£
,

450 
	$h4_´oc_j™‹r_show
(
£q_fe
 *
m
, *
v
)

452 
	`£q_puts
(
m
, "Values in‚s\n");

453 
	`£q_´štf
(
m
, "<%dÒs)\t\t\t\ˆ%Îd\n", 
HISTO_1
, 
hi¡og¿m_1
);

454 
	`£q_´štf
(
m
, "%dÒs)-%dÒs)\t\t\ˆ%Îd\n", 
HISTO_1
, 
HISTO_2
, 
hi¡og¿m_2
);

455 
	`£q_´štf
(
m
, "%dÒs)-%dÒs)\t\t\ˆ%Îd\n", 
HISTO_2
, 
HISTO_3
, 
hi¡og¿m_3
);

456 
	`£q_´štf
(
m
, "%dÒs)-%dÒs)\t\t\ˆ%Îd\n", 
HISTO_3
, 
HISTO_4
, 
hi¡og¿m_4
);

457 
	`£q_´štf
(
m
, "%dÒs)-%dÒs)\t\ˆ%Îd\n", 
HISTO_4
, 
HISTO_5
, 
hi¡og¿m_5
);

458 
	`£q_´štf
(
m
, ">%dÒs)\t\t\t\ˆ%Îd\n", 
HISTO_5
, 
hi¡og¿m_6
);

459 
	`£q_´štf
(
m
, "max j™‹rÒs)\t\t\t\ˆ%Îd\n", 
max_j™‹r
);

460 
	`£q_puts
(
m
, "--------------------------\n");

461 
	`£q_puts
(
m
, "Packets in TH DATA Q\n");

462 
	`£q_´štf
(
m
, "<%d\t\t%Îd\n", 
HISTO_1_DATA
, 
hi¡og¿m_1_d©a
);

463 
	`£q_´štf
(
m
, "%d-%d\t\t%Îd\n", 
HISTO_1_DATA
, 
HISTO_2_DATA
, 
hi¡og¿m_2_d©a
);

464 
	`£q_´štf
(
m
, "%d-%d\t\t%Îd\n", 
HISTO_2_DATA
, 
HISTO_3_DATA
, 
hi¡og¿m_3_d©a
);

465 
	`£q_´štf
(
m
, "%d-%d\t\t%Îd\n", 
HISTO_3_DATA
, 
HISTO_4_DATA
, 
hi¡og¿m_4_d©a
);

466 
	`£q_´štf
(
m
, "%d-%d\t\t%Îd\n", 
HISTO_4_DATA
, 
HISTO_5_DATA
, 
hi¡og¿m_5_d©a
);

467 
	`£q_´štf
(
m
, ">%d\t\t%Îd\n", 
HISTO_5_DATA
, 
hi¡og¿m_6_d©a
);

468 
	`£q_´štf
(
m
, "max d©a\t%Îd\n", 
max_d©a
);

470 
	}
}

472 
	$h4_´oc_j™‹r_İ’
(
šode
 *šode, 
fe
 *file)

474  
	`sšgË_İ’
(
fe
, 
h4_´oc_j™‹r_show
, 
	`PDE_DATA
(
šode
));

475 
	}
}

477 
ssize_t
 
	$h4_´oc_j™‹r_ş—r
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

479 
	`SLSI_INFO_NODEV
("Clear Histogram\n");

481 
hi¡og¿m_1
 = 0;

482 
hi¡og¿m_2
 = 0;

483 
hi¡og¿m_3
 = 0;

484 
hi¡og¿m_4
 = 0;

485 
hi¡og¿m_5
 = 0;

486 
hi¡og¿m_6
 = 0;

487 
max_j™‹r
 = 0;

489 
hi¡og¿m_1_d©a
 = 0;

490 
hi¡og¿m_2_d©a
 = 0;

491 
hi¡og¿m_3_d©a
 = 0;

492 
hi¡og¿m_4_d©a
 = 0;

493 
hi¡og¿m_5_d©a
 = 0;

494 
hi¡og¿m_6_d©a
 = 0;

495 
max_d©a
 = 0;

497  
couÁ
;

498 
	}
}

500 cÚ¡ 
fe_İ”©iÚs
 
	gh4_´ocfs_j™‹r_fİs
 = {

501 .
owÃr
 = 
THIS_MODULE
,

502 .
	gİ’
 = 
h4_´oc_j™‹r_İ’
,

503 .
	gwr™e
 = 
h4_´oc_j™‹r_ş—r
,

504 .
	g»ad
 = 
£q_»ad
,

505 .
	gÎ£ek
 = 
£q_l£ek
,

506 .
	g»Ëa£
 = 
sšgË_»Ëa£
,

510 
	#FB_NO_SPC_NUM_RET
 100

	)

511 
	#FB_NO_SPC_SLEEP_MS
 10

	)

512 
	#FB_NO_SPC_DELAY_US
 1000

	)

516 
	$h4_upd©e_šdex
(
¦si_h4
 *
h
, 
u32
 
q
, 
rw
 
r_w
, 
u8
 
v®ue
)

518 
h4_´iv
 *
h_´iv
 = 
h
->hip_priv;

520 
	`wr™e_lock_bh
(&
h_´iv
->
rw_scÜebßrd
);

521 ià(
h
->
h_´iv
->
v”siÚ
 == 5 || hip->hip_priv->version == 4) {

522 *((
u8
 *)(
h
->
h_´iv
->
scbrd_ba£
 + 
q_idx_Ïyout
[
q
][
r_w
])èğ
v®ue
;

524 
	`SLSI_ERR_NODEV
("Incorrect version\n");

525 
”rÜ
;

529 
	`smp_wmb
();

530 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
q
, 
r_w
, 
v®ue
, 0);

531 
”rÜ
:

532 
	`wr™e_uÆock_bh
(&
h_´iv
->
rw_scÜebßrd
);

533 
	}
}

537 
u8
 
	$h4_»ad_šdex
(
¦si_h4
 *
h
, 
u32
 
q
, 
rw
 
r_w
)

539 
h4_´iv
 *
h_´iv
 = 
h
->hip_priv;

540 
u32
 
v®ue
 = 0;

542 
	`»ad_lock_bh
(&
h_´iv
->
rw_scÜebßrd
);

543 ià(
h
->
h_´iv
->
v”siÚ
 == 5 || hip->hip_priv->version == 4) {

544 
v®ue
 = *((
u8
 *)(
h
->
h_´iv
->
scbrd_ba£
 + 
q_idx_Ïyout
[
q
][
r_w
]));

546 
	`SLSI_ERR_NODEV
("Incorrect version\n");

547 
”rÜ
;

551 
	`smp_rmb
();

552 
”rÜ
:

553 
	`»ad_uÆock_bh
(&
h_´iv
->
rw_scÜebßrd
);

554  
v®ue
;

555 
	}
}

557 
	$h4_dump_dbg
(
¦si_h4
 *
h
, 
mbulk
 *
m
, 
sk_buff
 *
skb
, 
scsc_£rviû
 *
£rviû
)

559 
i
 = 0;

560 
scsc_miäam_»f
 
»f
;

561 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


562 
	`SLSI_ERR_NODEV
("šŒ_toho¡_fb 0x%x\n", 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_FH_RFB
]);

563 
	`SLSI_ERR_NODEV
("šŒ_toho¡_ù¾ 0x%x\n", 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_CTRL
]);

564 
	`SLSI_ERR_NODEV
("šŒ_toho¡_d© 0x%x\n", 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
]);

566 
	`SLSI_ERR_NODEV
("šŒ_toho¡ 0x%x\n", 
h
->
h_´iv
->
šŒ_toho¡
);

568 
	`SLSI_ERR_NODEV
("šŒ_äomho¡ 0x%x\n", 
h
->
h_´iv
->
šŒ_äomho¡
);

571 
i
 = 0; i < 6; i++) {

572 
	`SLSI_ERR_NODEV
("Q%dW 0x%x\n", 
i
, 
	`h4_»ad_šdex
(
h
, i, 
widx
));

573 
	`SLSI_ERR_NODEV
("Q%dR 0x%x\n", 
i
, 
	`h4_»ad_šdex
(
h
, i, 
ridx
));

576 ià(
£rviû
)

577 
	`scsc_mx_£rviû_mif_dump_»gi¡”s
(
£rviû
);

579 ià(
m
 && 
£rviû
) {

580 ià(
	`scsc_mx_£rviû_mif_±r_to_addr
(
£rviû
, 
m
, &
»f
))

582 
	`SLSI_ERR_NODEV
("m: %°0x%x\n", 
m
, 
»f
);

583 
	`´št_hex_dump
(
KERN_ERR
, 
SCSC_PREFIX
 "mbulk ", 
DUMP_PREFIX_NONE
, 16, 1, 
m
, (
mbulk
), 0);

585 ià(
m
 && 
	`mbulk_has_sigÇl
(m))

586 
	`´št_hex_dump
(
KERN_ERR
, 
SCSC_PREFIX
 "sig ", 
DUMP_PREFIX_NONE
, 16, 1, 
	`mbulk_g‘_sigÇl
(
m
),

587 
	`MBULK_SEG_SIG_BUFSIZE
(
m
), 0);

588 ià(
skb
)

589 
	`´št_hex_dump
(
KERN_ERR
, 
SCSC_PREFIX
 "skb ", 
DUMP_PREFIX_NONE
, 16, 1, 
skb
->
d©a
, skb->
Ën
 > 0xff ? 0xff : skb->len, 0);

591 
	`SLSI_ERR_NODEV
("time: wdˆ %Îd\n", 
	`ktime_to_ns
(
wdt
));

592 
	`SLSI_ERR_NODEV
("time: s’d %Îd\n", 
	`ktime_to_ns
(
£nd
));

593 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


594 
	`SLSI_ERR_NODEV
("time: iÁr_fb %Îd\n", 
	`ktime_to_ns
(
šŒ_»ûived_fb
));

595 
	`SLSI_ERR_NODEV
("time: bh_š™_fb %Îd\n", 
	`ktime_to_ns
(
bh_š™_fb
));

596 
	`SLSI_ERR_NODEV
("time: bh_’d_fb %Îd\n", 
	`ktime_to_ns
(
bh_’d_fb
));

597 
	`SLSI_ERR_NODEV
("time: iÁr_ù¾ %Îd\n", 
	`ktime_to_ns
(
šŒ_»ûived_ù¾
));

598 
	`SLSI_ERR_NODEV
("time: bh_š™_ù¾ %Îd\n", 
	`ktime_to_ns
(
bh_š™_ù¾
));

599 
	`SLSI_ERR_NODEV
("time: bh_’d_ù¾ %Îd\n", 
	`ktime_to_ns
(
bh_’d_ù¾
));

600 
	`SLSI_ERR_NODEV
("time: iÁr_d©¨ %Îd\n", 
	`ktime_to_ns
(
šŒ_»ûived_d©a
));

601 
	`SLSI_ERR_NODEV
("time: bh_š™_d©¨%Îd\n", 
	`ktime_to_ns
(
bh_š™_d©a
));

602 
	`SLSI_ERR_NODEV
("time: bh_’d_d©¨ %Îd\n", 
	`ktime_to_ns
(
bh_’d_d©a
));

604 
	`SLSI_ERR_NODEV
("time: iÁ¸ %Îd\n", 
	`ktime_to_ns
(
šŒ_»ûived
));

605 
	`SLSI_ERR_NODEV
("time: bh_š™ %Îd\n", 
	`ktime_to_ns
(
bh_š™
));

606 
	`SLSI_ERR_NODEV
("time: bh_’d %Îd\n", 
	`ktime_to_ns
(
bh_’d
));

608 
	`SLSI_ERR_NODEV
("time: closšg %Îd\n", 
	`ktime_to_ns
(
şosšg
));

609 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


611 ià(!
skb
 && !
m
)

612 
	`h4_hi¡Üy_»cÜd_´št
(
çl£
, 
NULL
);

614 
	}
}

617 
mbulk
 *
	$h4_skb_to_mbulk
(
h4_´iv
 *
h
, 
sk_buff
 *
skb
, 
boŞ
 
ù¾_·ck‘
, 
mbulk_cŞour
 
cŞour
)

619 
mbulk
 *
m
 = 
NULL
;

620 *
sig
 = 
NULL
, *
b_d©a
 = NULL;

621 
size_t
 
·ylßd
 = 0;

622 
u8
 
poŞ_id
 = 
ù¾_·ck‘
 ? 
MBULK_POOL_ID_CTRL
 : 
MBULK_POOL_ID_DATA
;

623 
u8
 
h—droom
 = 0, 
room
 = 0;

624 
mbulk_şass
 
şas
 = 
ù¾_·ck‘
 ? 
MBULK_CLASS_FROM_HOST_CTL
 : 
MBULK_CLASS_FROM_HOST_DAT
;

625 
¦si_skb_cb
 *
cb
 = 
	`¦si_skb_cb_g‘
(
skb
);

626 #ifdeà
CONFIG_SCSC_WLAN_SG


627 
u32
 
lš—r_d©a
;

628 
u32
 
off£t
;

629 
u8
 
i
;

632 
·ylßd
 = 
skb
->
Ën
 - 
cb
->
sig_Ëngth
;

635 
h—droom
 = 
h
->
unid©_»q_h—droom
;

636 
room
 = 
h
->
unid©_»q_room
;

639 ià(
·ylßd
 > 0) {

641 
m
 = 
	`mbulk_w™h_sigÇl_®loc_by_poŞ
(
poŞ_id
, 
cŞour
, 
şas
, 
cb
->
sig_Ëngth
 + 4,

642 
·ylßd
 + 
h—droom
 + 
room
);

643 ià(!
m
)

644  
NULL
;

645 ià(!
	`mbulk_»£rve_h—d
(
m
, 
h—droom
))

646  
NULL
;

649 
m
 = 
	`mbulk_w™h_sigÇl_®loc_by_poŞ
(
poŞ_id
, 
cŞour
, 
şas
, 
cb
->
sig_Ëngth
 + 4, 0);

650 ià(!
m
)

651  
NULL
;

655 
sig
 = 
	`mbulk_g‘_sigÇl
(
m
);

656 ià(!
sig
) {

657 
	`mbulk_ä“_vœt_ho¡
(
m
);

658  
NULL
;

663 
	`memıy
(
sig
 + 4, 
skb
->
d©a
, 
cb
->
sig_Ëngth
);

667 ià(
·ylßd
 > 0) {

669 
b_d©a
 = 
	`mbulk_d©_rw
(
m
);

670 ià(!
b_d©a
) {

671 
	`mbulk_ä“_vœt_ho¡
(
m
);

672  
NULL
;

675 #ifdeà
CONFIG_SCSC_WLAN_SG


679 
lš—r_d©a
 = 
	`skb_h—dËn
(
skb
è- 
cb
->
sig_Ëngth
;

681 
off£t
 = 0;

683 ià(
lš—r_d©a
 > 0) {

685 
	`memıy
(
b_d©a
, 
skb
->
d©a
 + 
cb
->
sig_Ëngth
, 
lš—r_d©a
);

686 
off£t
 = 
lš—r_d©a
;

690 
i
 = 0; i < 
	`skb_shšfo
(
skb
)->
Ä_äags
; i++) {

691 
skb_äag_t
 *
äag
 = 
NULL
;

692 *
äag_va_d©a
;

693 
äag_size
;

695 
äag
 = &
	`skb_shšfo
(
skb
)->
äags
[
i
];

696 
	`WARN_ON
(!
äag
);

697 ià(!
äag
)

699 
äag_va_d©a
 = 
	`skb_äag_add»ss_§ã
(
äag
);

700 
	`WARN_ON
(!
äag_va_d©a
);

701 ià(!
äag_va_d©a
)

703 
äag_size
 = 
	`skb_äag_size
(
äag
);

705 
	`memıy
(
b_d©a
 + 
off£t
, 
äag_va_d©a
, 
äag_size
);

706 
off£t
 +ğ
äag_size
;

710 ià(
skb
->
_summed
 =ğ
CHECKSUM_PARTIAL
) {

711 
	`SLSI_DBG3_NODEV
(
SLSI_HIP
, "CHECKSUM_PARTIAL. Driver…erforming checksum\n");

712 ià(
skb
->
´ÙocŞ
 =ğ
	`htÚs
(
ETH_P_IP
)) {

713 
‘hhdr
 *
mach
 = (‘hhd¸*)
b_d©a
;

714 
hdr
 *
h
 = (hd¸*)((*)
b_d©a
 + (*
mach
));

715 
Ën
 = 
·ylßd
 - (*
mach
è- (
h
->
ihl
 << 2);

717 ià(
h
->
´ÙocŞ
 =ğ
IPPROTO_TCP
) {

718 
tıhdr
 *
th
 = (tıhd¸*)((*)
b_d©a
 + (*
mach
) +

719 (
h
->
ihl
 << 2));

720 
th
->
check
 = 0;

721 
th
->
check
 = 
	`csum_tıudp_magic
(
h
->
§ddr
, iph->
daddr
, 
Ën
,

722 
IPPROTO_TCP
,

723 
	`csum_·¹Ÿl
((*)
th
, 
Ën
, 0));

724 
	`SLSI_DBG3_NODEV
(
SLSI_HIP
, "th->check 0x%x\n", 
	`Áohs
(
th
->
check
));

725 } ià(
h
->
´ÙocŞ
 =ğ
IPPROTO_UDP
) {

726 
udphdr
 *
uh
 = (udphd¸*)((*)
b_d©a
 + (*
mach
) +

727 (
h
->
ihl
 << 2));

728 
uh
->
check
 = 0;

729 
uh
->
check
 = 
	`csum_tıudp_magic
(
h
->
§ddr
, iph->
daddr
, 
Ën
,

730 
IPPROTO_UDP
,

731 
	`csum_·¹Ÿl
((*)
uh
, 
Ën
, 0));

732 
	`SLSI_DBG3_NODEV
(
SLSI_HIP
, "uh->check 0x%x\n", 
	`Áohs
(
uh
->
check
));

738 
	`memıy
(
b_d©a
, 
skb
->
d©a
 + 
cb
->
sig_Ëngth
, 
·ylßd
);

740 
	`mbulk_­³nd_
(
m
, 
·ylßd
);

742 
m
->
æag
 |ğ
MBULK_F_OBOUND
;

744 #ifdeà
CONFIG_SCSC_SMAPPER


746 
cb
->
skb_addr
 = 
NULL
;

748  
m
;

749 
	}
}

752 
sk_buff
 *
	$h4_mbulk_to_skb
(
scsc_£rviû
 *
£rviû
, 
h4_´iv
 *
h_´iv
, 
mbulk
 *
m
, 
scsc_miäam_»f
 *
to_ä“
, 
boŞ
 
©omic
)

754 
¦si_skb_cb
 *
cb
;

755 
mbulk
 *
Ãxt_mbulk
[
MBULK_MAX_CHAIN
];

756 
sk_buff
 *
skb
 = 
NULL
;

757 
scsc_miäam_»f
 
»f
;

758 
scsc_miäam_»f
 
m_chaš_Ãxt
;

759 
u8
 
ä“
 = 0;

760 
u8
 
i
 = 0, 
j
 = 0;

761 
u8
 *
p
;

762 
size_t
 
by‹s_to_®loc
 = 0;

765 ià(
	`scsc_mx_£rviû_mif_±r_to_addr
(
£rviû
, 
m
, &
»f
)) {

766 
	`SLSI_ERR_NODEV
("mbulk‡ddress conversion failed\n");

767  
NULL
;

771 
to_ä“
[
ä“
++] = 
»f
;

773 
by‹s_to_®loc
 +ğ
m
->
sig_bufsz
 - 4;

774 
by‹s_to_®loc
 +ğ
m
->
Ën
;

777 ià((
	`MBULK_SEG_IS_CHAIN_HEAD
(
m
)è&& (
	`MBULK_SEG_IS_CHAINED
(m))) {

778 
m_chaš_Ãxt
 = 
	`mbulk_chaš_Ãxt
(
m
);

779 ià(!
m_chaš_Ãxt
) {

780 
	`SLSI_ERR_NODEV
("Mbulk is set MBULK_F_CHAIN_HEAD‡nd MBULK_F_CHAIN but m_chain_next is NULL\n");

781 
cÚt
;

785 
i
++;

787 
Ãxt_mbulk
[
i
 - 1] = 
	`scsc_mx_£rviû_mif_addr_to_±r
(
£rviû
, 
m_chaš_Ãxt
);

788 ià(!
Ãxt_mbulk
[
i
 - 1]) {

789 
	`SLSI_ERR_NODEV
("First Mbulk is set‡s MBULK_F_CHAIN but‚ext_mbulk is NULL\n");

790  
NULL
;

793 
to_ä“
[
ä“
++] = 
m_chaš_Ãxt
;

794 
by‹s_to_®loc
 +ğ
Ãxt_mbulk
[
i
 - 1]->
Ën
;

795 ià(
	`MBULK_SEG_IS_CHAINED
(
Ãxt_mbulk
[
i
 - 1])) {

797 
m_chaš_Ãxt
 = 
	`mbulk_chaš_Ãxt
(
Ãxt_mbulk
[
i
 - 1]);

798 ià(!
m_chaš_Ãxt
)

801 ià(
i
 >ğ
MBULK_MAX_CHAIN
) {

802 
	`SLSI_ERR_NODEV
("Max‚umber of chained MBULK„eached\n");

803  
NULL
;

811 
cÚt
:

812 ià(
©omic
) {

813 
skb
 = 
	`®loc_skb
(
by‹s_to_®loc
, 
GFP_ATOMIC
);

815 
	`¥š_uÆock_bh
(&
h_´iv
->
rx_lock
);

816 
skb
 = 
	`®loc_skb
(
by‹s_to_®loc
, 
GFP_KERNEL
);

817 
	`¥š_lock_bh
(&
h_´iv
->
rx_lock
);

819 ià(!
skb
) {

820 
	`SLSI_ERR_NODEV
("E¼Ü‡Îoÿtšg skb %d by‹s\n", 
by‹s_to_®loc
);

821  
NULL
;

824 
cb
 = 
	`¦si_skb_cb_š™
(
skb
);

825 
cb
->
sig_Ëngth
 = 
m
->
sig_bufsz
 - 4;

827 
cb
->
d©a_Ëngth
 = cb->
sig_Ëngth
;

829 
p
 = 
	`mbulk_g‘_sigÇl
(
m
);

830 ià(!
p
) {

831 
	`SLSI_ERR_NODEV
("No signal in Mbulk\n");

832 
	`´št_hex_dump
(
KERN_ERR
, 
SCSC_PREFIX
 "mbulk ", 
DUMP_PREFIX_NONE
, 16, 1, 
m
, (
mbulk
), 0);

833 #ifdeà
CONFIG_SCSC_SMAPPER


834 
	`h4_sm­³r_ä“_m­³d_skb
(
skb
);

836 
	`kä“_skb
(
skb
);

837  
NULL
;

840 
p
 += 4;

843 
	`memıy
(
	`skb_put
(
skb
, 
cb
->
sig_Ëngth
), 
p
, cb->sig_length);

845 ià(
m
->
Ën
)

846 
	`çpi_­³nd_d©a
(
skb
, 
	`mbulk_d©_r
(
m
), m->
Ën
);

847 
j
 = 0; j < 
i
; j++)

848 
	`çpi_­³nd_d©a
(
skb
, 
	`mbulk_d©_r
(
Ãxt_mbulk
[
j
]),‚ext_mbulk[j]->
Ën
);

850  
skb
;

851 
	}
}

855 
	$h4_q_add_sigÇl
(
¦si_h4
 *
h
, 
h4_h_q_cÚf
 
cÚf
, 
scsc_miäam_»f
 
phy_m
, 
scsc_£rviû
 *
£rviû
)

857 
h4_h_cÚŒŞ
 *
ù¾
 = 
h
->
h_cÚŒŞ
;

858 
h4_´iv
 *
h_´iv
 = 
h
->hip_priv;

859 
u8
 
idx_w
;

860 
u8
 
idx_r
;

863 
idx_w
 = 
	`h4_»ad_šdex
(
h
, 
cÚf
, 
widx
);

865 
idx_r
 = 
	`h4_»ad_šdex
(
h
, 
cÚf
, 
ridx
);

866 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
cÚf
, 
widx
, 
idx_w
, 1);

867 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
cÚf
, 
ridx
, 
idx_r
, 1);

870 ià(
idx_r
 =ğ((
idx_w
 + 1è& (
MAX_NUM
 - 1)))

871  -
ENOSPC
;

874 
ù¾
->
q
[
cÚf
].
¬¿y
[
idx_w
] = 
phy_m
;

876 
	`smp_wmb
();

877 
	`SCSC_HIP4_SAMPLER_QREF
(
h_´iv
->
mšÜ
, 
phy_m
, 
cÚf
);

878 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


879 
h
->
h_´iv
->
¡©s
.
q_num_äames
[
cÚf
] = hip->hip_priv->stats.q_num_frames[conf] + 1;

883 
idx_w
++;

884 
idx_w
 &ğ(
MAX_NUM
 - 1);

887 
	`h4_upd©e_šdex
(
h
, 
cÚf
, 
widx
, 
idx_w
);

889 
£nd
 = 
	`ktime_g‘
();

890 
	`scsc_£rviû_mifšŒb™_b™_£t
(
£rviû
, 
h_´iv
->
šŒ_äomho¡
, 
SCSC_MIFINTR_TARGET_R4
);

893 
	}
}

895 #ià
KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


896 
	$h4_w©chdog
(
tim”_li¡
 *
t
)

898 
	$h4_w©chdog
(
d©a
)

901 #ià
	`KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


902 
h4_´iv
 *
´iv
 = 
	`äom_tim”
Õriv, 
t
, 
w©chdog
);

903 
¦si_h4
 *
h
 = 
´iv
->hip;

905 
¦si_h4
 *
h
 = (¦si_h4 *)
d©a
;

907 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

908 
scsc_£rviû
 *
£rviû
;

909 
ktime_t
 
šŒ_ov
;

910 
æags
;

911 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


912 
boŞ
 
»Œigg”_w©chdog
 = 
Œue
;

913 
u8
 
i
;

916 ià(!
h
 || !
sdev
 || !sdev->
£rviû
 || !h->
h_´iv
)

919 
	`¥š_lock_œq§ve
(&
h
->
h_´iv
->
w©chdog_lock
, 
æags
);

920 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
))

921 
ex™
;

923 
wdt
 = 
	`ktime_g‘
();

925 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


927 ià(
	`‹¡_ªd_ş—r_b™
(
HIP4_MIF_Q_FH_RFB
, 
h
->
h_´iv
->
œq_b™m­
)) {

928 
šŒ_ov
 = 
	`ktime_add_ms
(
šŒ_»ûived_fb
, 
	`jiff›s_to_m£cs
(
HZ
));

929 ià((
	`ktime_com·»
(
šŒ_ov
, 
wdt
) < 0))

930 
»Œigg”_w©chdog
 = 
çl£
;

932 ià(
	`‹¡_ªd_ş—r_b™
(
HIP4_MIF_Q_TH_CTRL
, 
h
->
h_´iv
->
œq_b™m­
)) {

933 
šŒ_ov
 = 
	`ktime_add_ms
(
šŒ_»ûived_ù¾
, 
	`jiff›s_to_m£cs
(
HZ
));

934 ià((
	`ktime_com·»
(
šŒ_ov
, 
wdt
) < 0))

935 
»Œigg”_w©chdog
 = 
çl£
;

937 ià(
	`‹¡_ªd_ş—r_b™
(
HIP4_MIF_Q_TH_DAT
, 
h
->
h_´iv
->
œq_b™m­
)) {

938 
šŒ_ov
 = 
	`ktime_add_ms
(
šŒ_»ûived_d©a
, 
	`jiff›s_to_m£cs
(
HZ
));

939 ià((
	`ktime_com·»
(
šŒ_ov
, 
wdt
) < 0))

940 
»Œigg”_w©chdog
 = 
çl£
;

942 ià(
»Œigg”_w©chdog
) {

943 
wdt
 = 
	`ktime_£t
(0, 0);

945 
	`mod_tim”
(&
h
->
h_´iv
->
w©chdog
, 
jiff›s
 + 
HZ
 / 2);

946 
ex™
;

950 ià(
	`ktime_com·»
(
šŒ_»ûived
, 
wdt
) > 0) {

951 
wdt
 = 
	`ktime_£t
(0, 0);

952 
ex™
;

955 
šŒ_ov
 = 
	`ktime_add_ms
(
šŒ_»ûived
, 
	`jiff›s_to_m£cs
(
HZ
));

958 ià(!(
	`ktime_com·»
(
šŒ_ov
, 
wdt
) < 0)) {

959 
wdt
 = 
	`ktime_£t
(0, 0);

961 
	`mod_tim”
(&
h
->
h_´iv
->
w©chdog
, 
jiff›s
 + 
HZ
 / 2);

962 
ex™
;

967 
	`¥š_uÆock_œq»¡Üe
(&
h
->
h_´iv
->
w©chdog_lock
, 
æags
);

968 
	`h4_dump_dbg
(
h
, 
NULL
, NULL, 
sdev
->
£rviû
);

969 
	`¥š_lock_œq§ve
(&
h
->
h_´iv
->
w©chdog_lock
, 
æags
);

971 
£rviû
 = 
sdev
->service;

973 
	`SLSI_INFO_NODEV
("Hip4 watchdogriggered\n");

975 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


976 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++) {

977 ià(
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
] =ğ
MIF_NO_IRQ
)

979 ià(
	`scsc_£rviû_mifšŒb™_b™_mask_¡©us_g‘
(
£rviû
è& (1 << 
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
])) {

981 
	`SLSI_INFO_NODEV
("%d: IÁ”ru± Masked. UnmaskØ»¡¬ˆIÁ”ru±…roûssšg\n", 
i
);

982 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
]);

986 ià(
	`scsc_£rviû_mifšŒb™_b™_mask_¡©us_g‘
(
£rviû
è& (1 << 
h
->
h_´iv
->
šŒ_toho¡
)) {

988 
	`SLSI_INFO_NODEV
("Interrupt Masked. Unmasko„estart Interrupt…rocessing\n");

989 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

992 
ex™
:

993 
	`¥š_uÆock_œq»¡Üe
(&
h
->
h_´iv
->
w©chdog_lock
, 
æags
);

994 
	}
}

996 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


997 
	$h4_£t_Çpi_ıu
(
¦si_h4
 *
h
, 
u8
 
Çpi_ıu
, 
boŞ
 
³rf_mode
)

999 
h4_´iv
 *
h_´iv
;

1000 
¦si_dev
 *
sdev
;

1001 
æags
;

1003 ià(!
h
)

1006 
sdev
 = 
	`cÚš”_of
(
h
, 
¦si_dev
, 
h4_š¡
);

1007 ià(!
sdev
)

1010 
h_´iv
 = 
h
->hip_priv;

1012 ià(!
h_´iv
)

1015 ià(!
	`ıu_Úlše
(
Çpi_ıu
)) {

1016 
	`SLSI_ERR_NODEV
("CPU%d i ofæše.\n", 
Çpi_ıu
);

1017 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
]);

1021 
	`¦si_wake_lock
(&
h
->
h_´iv
->
h4_wake_lock_d©a
);

1022 ià(
Çpi_ıu
 !ğ
Çpi_£Ëù_ıu
) {

1023 
	`¥š_lock_œq§ve
(&
h
->
h_´iv
->
Çpi_ıu_lock
, 
æags
);

1024 
	`scsc_£rviû_mifšŒb™_b™_mask
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
]);

1025 ià(!
	`‹¡_b™
(
SLSI_HIP_NAPI_STATE_ENABLED
, &
h
->
h_´iv
->
Çpi_¡©e
)) {

1026 
	`¦si_wake_uÆock
(&
h
->
h_´iv
->
h4_wake_lock_d©a
);

1027 
	`SLSI_INFO_NODEV
("NAPI i ®»ady di§bËd oÀCPU%d\n", 
Çpi_£Ëù_ıu
);

1028 
	`¥š_uÆock_œq»¡Üe
(&
h
->
h_´iv
->
Çpi_ıu_lock
, 
æags
);

1032 
	`SLSI_INFO_NODEV
("di§bË NAPI oÀCPU%d\n", 
Çpi_£Ëù_ıu
);

1033 
	`ş—r_b™
(
SLSI_HIP_NAPI_STATE_ENABLED
, &
h
->
h_´iv
->
Çpi_¡©e
);

1034 
Çpi_£Ëù_ıu
 = 
Çpi_ıu
;

1037 
	`¥š_uÆock_œq»¡Üe
(&
h
->
h_´iv
->
Çpi_ıu_lock
, 
æags
);

1038 
	`Çpi_di§bË
(&
h
->
h_´iv
->
Çpi
);

1040 #ià
	`defšed
(
CONFIG_SOC_S5E9815
è&& defšed(
CONFIG_SCSC_QOS
)

1045 ià(
	`scsc_£rviû_£t_affš™y_ıu
(
sdev
->
£rviû
, 
Çpi_£Ëù_ıu
) != 0)

1046 
	`SLSI_ERR_NODEV
("çedØchªgIRQ‡ffš™y (CPU%d)\n", 
Çpi_£Ëù_ıu
);

1049 
	`loÿl_bh_di§bË
();

1050 
	`¥š_lock_œq§ve
(&
h
->
h_´iv
->
Çpi_ıu_lock
, 
æags
);

1052 
h_´iv
->
Çpi_³rf_mode
 = 
³rf_mode
;

1053 ià(!
	`‹¡_ªd_£t_b™
(
SLSI_HIP_NAPI_STATE_ENABLED
, &
h
->
h_´iv
->
Çpi_¡©e
)) {

1054 
	`SLSI_INFO_NODEV
("’abË NAPI oÀCPU%d\n", 
Çpi_£Ëù_ıu
);

1055 
	`Çpi_’abË
(&
h
->
h_´iv
->
Çpi
);

1057 ià(
Çpi_£Ëù_ıu
 =ğ
	`smp_´oûssÜ_id
()) {

1058 
	`Çpi_scheduË
(&
h
->
h_´iv
->
Çpi
);

1060 ià(
Çpi_£Ëù_ıu
 && 
	`ıu_Úlše
(napi_select_cpu))

1061 
	`scheduË_wÜk_Ú
(
Çpi_£Ëù_ıu
, &
h
->
h_´iv
->
šŒ_wq_Çpi_ıu_sw™ch
);

1063 
	`Çpi_scheduË
(&
h
->
h_´iv
->
Çpi
);

1067 
	`¥š_uÆock_œq»¡Üe
(&
h
->
h_´iv
->
Çpi_ıu_lock
, 
æags
);

1068 
	`loÿl_bh_’abË
();

1070 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
]);

1071 
	`¦si_wake_uÆock
(&
h
->
h_´iv
->
h4_wake_lock_d©a
);

1072 
	}
}

1074 
	$h4__fb
(
d©a
)

1077 
¦si_h4
 *
h
 = (*)
d©a
;

1078 
h4_´iv
 *
h_´iv
 = 
h
->hip_priv;

1079 
h4_h_cÚŒŞ
 *
ù¾
;

1080 
scsc_£rviû
 *
£rviû
;

1081 
¦si_dev
 *
sdev
;

1082 
boŞ
 
no_chªge
 = 
Œue
;

1083 
u8
 
idx_r
;

1084 
u8
 
idx_w
;

1085 
scsc_miäam_»f
 
»f
;

1086 *
mem
;

1088 ià(!
h_´iv
 || !h_´iv->
h
) {

1089 
	`SLSI_ERR_NODEV
("hip_priv or hip_priv->hip is Null\n");

1093 
h
 = 
h_´iv
->hip;

1094 
ù¾
 = 
h
->
h_cÚŒŞ
;

1096 ià(!
ù¾
) {

1097 
	`SLSI_ERR_NODEV
("hip->hip_control is Null\n");

1100 
sdev
 = 
	`cÚš”_of
(
h
, 
¦si_dev
, 
h4_š¡
);

1102 ià(!
sdev
 || !sdev->
£rviû
) {

1103 
	`SLSI_ERR_NODEV
("sdev or sdev->service is Null\n");

1107 
	`¥š_lock_bh
(&
h_´iv
->
rx_lock
);

1108 
£rviû
 = 
sdev
->service;

1109 
	`SCSC_HIP4_SAMPLER_INT_BH
(
h
->
h_´iv
->
mšÜ
, 2);

1110 
bh_š™_fb
 = 
	`ktime_g‘
();

1111 
	`ş—r_b™
(
HIP4_MIF_Q_FH_RFB
, 
h
->
h_´iv
->
œq_b™m­
);

1113 
idx_r
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_FH_RFB
, 
ridx
);

1114 
idx_w
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_FH_RFB
, 
widx
);

1116 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1117 ià(
idx_r
 !ğ
idx_w
) {

1118 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_FH_RFB
, 
ridx
, 
idx_r
, 1);

1119 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_FH_RFB
, 
widx
, 
idx_w
, 1);

1122 
idx_r
 !ğ
idx_w
) {

1123 
mbulk
 *
m
;

1124 
mbulk_cŞour
 
cŞour
;

1126 
no_chªge
 = 
çl£
;

1127 
»f
 = 
ù¾
->
q
[
HIP4_MIF_Q_FH_RFB
].
¬¿y
[
idx_r
];

1128 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1129 
	`SCSC_HIP4_SAMPLER_QREF
(
h_´iv
->
mšÜ
, 
»f
, 
HIP4_MIF_Q_FH_RFB
);

1131 
mem
 = 
	`scsc_mx_£rviû_mif_addr_to_±r
(
£rviû
, 
»f
);

1132 
m
 = (
mbulk
 *)
mem
;

1134 ià(!
m
) {

1135 
	`SLSI_ERR_NODEV
("FB: Mbulk is NULL\n");

1136 
cÚsume_fb_mbulk
;

1139 ià((
m
->
pid
 & 0x1è=ğ
MBULK_POOL_ID_DATA
) {

1140 
cŞour
 = 
	`mbulk_g‘_cŞour
(
MBULK_POOL_ID_DATA
, 
m
);

1141 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1142 
	`SCSC_HIP4_SAMPLER_VIF_PEER
(
h
->
h_´iv
->
mšÜ
,

1144 
	`SLSI_MBULK_COLOUR_GET_VIF
(
cŞour
),

1145 
	`SLSI_MBULK_COLOUR_GET_PEER_IDX
(
cŞour
));

1148 
u16
 
ho¡_g
;

1149 
u8
 *
g‘_ho¡_g
;

1154 
g‘_ho¡_g
 = (
u8
 *)
m
;

1155 
ho¡_g
 = 
g‘_ho¡_g
[37] << 8 | get_host_tag[36];

1156 
	`SCSC_HIP4_SAMPLER_PKT_TX_FB
(
h
->
h_´iv
->
mšÜ
, 
ho¡_g
);

1160 
	`¦si_h_tx_dÚe
(
sdev
,

1161 
	`SLSI_MBULK_COLOUR_GET_VIF
(
cŞour
),

1162 
	`SLSI_MBULK_COLOUR_GET_PEER_IDX
(
cŞour
),

1163 
	`SLSI_MBULK_COLOUR_GET_AC
(
cŞour
));

1165 
	`mbulk_ä“_vœt_ho¡
(
m
);

1166 
cÚsume_fb_mbulk
:

1168 
idx_r
++;

1169 
idx_r
 &ğ(
MAX_NUM
 - 1);

1170 
	`h4_upd©e_šdex
(
h
, 
HIP4_MIF_Q_FH_RFB
, 
ridx
, 
idx_r
);

1173 ià(
no_chªge
)

1174 
	`©omic_šc
(&
h
->
h_´iv
->
¡©s
.
¥urious_œqs
);

1176 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
şosšg
)) {

1177 
	`©omic_£t
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
, 0);

1178 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_FH_RFB
]);

1180 
	`SCSC_HIP4_SAMPLER_INT_OUT_BH
(
h
->
h_´iv
->
mšÜ
, 2);

1182 ià(
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock_tx
)) {

1183 
	`¦si_wake_uÆock
(&
h
->
h_´iv
->
h4_wake_lock_tx
);

1184 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


1185 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_RELEASED
, "h4_wake_lock_tx", 
WL_REASON_RX
);

1189 
bh_’d_fb
 = 
	`ktime_g‘
();

1190 
	`¥š_uÆock_bh
(&
h_´iv
->
rx_lock
);

1191 
	}
}

1193 
	$h4_œq_hªdËr_fb
(
œq
, *
d©a
)

1195 
¦si_h4
 *
h
 = (¦si_h4 *)
d©a
;

1196 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

1198 
	`SCSC_HIP4_SAMPLER_INT
(
h
->
h_´iv
->
mšÜ
, 2);

1199 
šŒ_»ûived_fb
 = 
	`ktime_g‘
();

1201 ià(!
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock_tx
)) {

1202 
	`¦si_wake_lock_timeout
(&
h
->
h_´iv
->
h4_wake_lock_tx
, 
	`m£cs_to_jiff›s
(
SLSI_HIP_WAKELOCK_TIME_OUT_IN_MS
));

1203 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


1204 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_TAKEN
, "h4_wake_lock_tx", 
WL_REASON_RX
);

1208 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
)) {

1209 
	`©omic_£t
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
, 1);

1210 
	`mod_tim”
(&
h
->
h_´iv
->
w©chdog
, 
jiff›s
 + 
HZ
);

1212 
	`£t_b™
(
HIP4_MIF_Q_FH_RFB
, 
h
->
h_´iv
->
œq_b™m­
);

1214 
	`scsc_£rviû_mifšŒb™_b™_mask
(
sdev
->
£rviû
, 
œq
);

1215 
	`skËt_hi_scheduË
(&
h
->
h_´iv
->
šŒ__fb
);

1218 
	`scsc_£rviû_mifšŒb™_b™_ş—r
(
sdev
->
£rviû
, 
œq
);

1219 
	`SCSC_HIP4_SAMPLER_INT_OUT
(
h
->
h_´iv
->
mšÜ
, 2);

1220 
	}
}

1222 
	$h4_wq_ù¾
(
wÜk_¡ruù
 *
d©a
)

1224 
h4_´iv
 *
h_´iv
 = 
	`cÚš”_of
(
d©a
, h4_´iv, 
šŒ_wq_ù¾
);

1225 
¦si_h4
 *
h
;

1226 
h4_h_cÚŒŞ
 *
ù¾
;

1227 
scsc_£rviû
 *
£rviû
;

1228 
¦si_dev
 *
sdev
;

1229 
u8
 
»Œy
;

1230 
boŞ
 
no_chªge
 = 
Œue
;

1231 
u8
 
idx_r
;

1232 
u8
 
idx_w
;

1233 
scsc_miäam_»f
 
»f
;

1234 *
mem
;

1235 
mbulk
 *
m
;

1236 #ià
	`defšed
(
CONFIG_SCSC_WLAN_DEBUG
è|| defšed(
CONFIG_SCSC_WLAN_HIP4_PROFILING
)

1237 
id
;

1240 ià(!
h_´iv
 || !h_´iv->
h
) {

1241 
	`SLSI_ERR_NODEV
("hip_priv or hip_priv->hip is Null\n");

1245 
h
 = 
h_´iv
->hip;

1246 
ù¾
 = 
h
->
h_cÚŒŞ
;

1248 ià(!
ù¾
) {

1249 
	`SLSI_ERR_NODEV
("hip->hip_control is Null\n");

1252 
sdev
 = 
	`cÚš”_of
(
h
, 
¦si_dev
, 
h4_š¡
);

1254 ià(!
sdev
 || !sdev->
£rviû
) {

1255 
	`SLSI_ERR_NODEV
("sdev or sdev->service is Null\n");

1259 
	`¥š_lock_bh
(&
h_´iv
->
rx_lock
);

1260 
£rviû
 = 
sdev
->service;

1261 
	`SCSC_HIP4_SAMPLER_INT_BH
(
h
->
h_´iv
->
mšÜ
, 1);

1262 
bh_š™_ù¾
 = 
	`ktime_g‘
();

1263 
	`ş—r_b™
(
HIP4_MIF_Q_TH_CTRL
, 
h
->
h_´iv
->
œq_b™m­
);

1265 
idx_r
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_TH_CTRL
, 
ridx
);

1266 
idx_w
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_TH_CTRL
, 
widx
);

1268 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1269 ià(
idx_r
 !ğ
idx_w
) {

1270 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_CTRL
, 
ridx
, 
idx_r
, 1);

1271 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_CTRL
, 
widx
, 
idx_w
, 1);

1274 
idx_r
 !ğ
idx_w
) {

1275 
sk_buff
 *
skb
;

1280 
scsc_miäam_»f
 
to_ä“
[
MBULK_MAX_CHAIN
 + 1] = { 0 };

1281 
u8
 
i
 = 0;

1283 
no_chªge
 = 
çl£
;

1285 
»f
 = 
ù¾
->
q
[
HIP4_MIF_Q_TH_CTRL
].
¬¿y
[
idx_r
];

1286 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1287 
	`SCSC_HIP4_SAMPLER_QREF
(
h_´iv
->
mšÜ
, 
»f
, 
HIP4_MIF_Q_TH_CTRL
);

1289 
mem
 = 
	`scsc_mx_£rviû_mif_addr_to_±r
(
£rviû
, 
»f
);

1290 
m
 = (
mbulk
 *)(
mem
);

1292 
skb
 = 
	`h4_mbulk_to_skb
(
£rviû
, 
h_´iv
, 
m
, 
to_ä“
, 
çl£
);

1293 ià(!
skb
) {

1294 
	`SLSI_ERR_NODEV
("Ctrl: Error…arsing or‡llocating skb\n");

1295 
	`h4_dump_dbg
(
h
, 
m
, 
skb
, 
£rviû
);

1296 
cÚsume_ùl_mbulk
;

1299 ià(
m
->
æag
 & 
MBULK_F_WAKEUP
) {

1300 
	`SLSI_INFO
(
sdev
, "WIFI wakeu°by MLME f¿m0x%x:\n", 
	`çpi_g‘_sigid
(
skb
));

1301 
	`SCSC_BIN_TAG_INFO
(
BINARY
, 
skb
->
d©a
, skb->
Ën
 > 128 ? 128 : skb->len);

1302 
	`¦si_skb_cb_g‘
(
skb
)->
wakeup
 = 
Œue
;

1305 #ià
	`defšed
(
CONFIG_SCSC_WLAN_DEBUG
è|| defšed(
CONFIG_SCSC_WLAN_HIP4_PROFILING
)

1306 
id
 = 
	`çpi_g‘_sigid
(
skb
);

1308 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1310 ià(
	`çpi_is_mlme
(
skb
))

1311 
	`SCSC_HIP4_SAMPLER_SIGNAL_CTRLRX
(
h_´iv
->
mšÜ
, (
id
 & 0xff00) >> 8, id & 0xff);

1313 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1314 
	`h4_hi¡Üy_»cÜd_add
(
TH
, 
id
);

1316 ià(
	`¦si_h_rx
(
sdev
, 
skb
) < 0) {

1317 
	`SLSI_ERR_NODEV
("Ctrl: Error detected slsi_hip_rx\n");

1318 
	`h4_dump_dbg
(
h
, 
m
, 
skb
, 
£rviû
);

1319 #ifdeà
CONFIG_SCSC_SMAPPER


1320 
	`h4_sm­³r_ä“_m­³d_skb
(
skb
);

1322 
	`kä“_skb
(
skb
);

1324 
cÚsume_ùl_mbulk
:

1326 
idx_r
++;

1327 
idx_r
 &ğ(
MAX_NUM
 - 1);

1330 (
»f
 = 
to_ä“
[
i
++])) {

1332 
»Œy
 = 
FB_NO_SPC_NUM_RET
;

1334 
	`h4_q_add_sigÇl
(
h
, 
HIP4_MIF_Q_TH_RFB
, 
»f
, 
£rviû
è&& (!
	`©omic_»ad
(&h->
h_´iv
->
şosšg
)è&& (
»Œy
 > 0)) {

1335 
	`SLSI_WARN_NODEV
("CŒl: NÙƒnough s·û iÀFB,„‘ry: %d/%d\n", 
»Œy
, 
FB_NO_SPC_NUM_RET
);

1336 
	`¥š_uÆock_bh
(&
h_´iv
->
rx_lock
);

1337 
	`m¦“p
(
FB_NO_SPC_SLEEP_MS
);

1338 
	`¥š_lock_bh
(&
h_´iv
->
rx_lock
);

1339 
»Œy
--;

1340 ià(
»Œy
 == 0)

1341 
	`SLSI_ERR_NODEV
("CŒl: FB ha nÙ b“Àä“d fÜ %d ms\n", 
FB_NO_SPC_NUM_RET
 * 
FB_NO_SPC_SLEEP_MS
);

1342 
	`SCSC_HIP4_SAMPLER_QFULL
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_RFB
);

1345 
	`h4_upd©e_šdex
(
h
, 
HIP4_MIF_Q_TH_CTRL
, 
ridx
, 
idx_r
);

1348 ià(
no_chªge
)

1349 
	`©omic_šc
(&
h
->
h_´iv
->
¡©s
.
¥urious_œqs
);

1351 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
şosšg
)) {

1352 
	`©omic_£t
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
, 0);

1353 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_CTRL
]);

1355 
	`SCSC_HIP4_SAMPLER_INT_OUT_BH
(
h
->
h_´iv
->
mšÜ
, 1);

1357 ià(
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock_ù¾
)) {

1358 
	`¦si_wake_uÆock
(&
h
->
h_´iv
->
h4_wake_lock_ù¾
);

1359 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


1360 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_RELEASED
, "h4_wake_lock_ù¾", 
WL_REASON_RX
);

1364 
bh_’d_ù¾
 = 
	`ktime_g‘
();

1365 
	`¥š_uÆock_bh
(&
h_´iv
->
rx_lock
);

1366 
	}
}

1368 
	$h4_œq_hªdËr_ù¾
(
œq
, *
d©a
)

1370 
¦si_h4
 *
h
 = (¦si_h4 *)
d©a
;

1371 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

1373 
	`SCSC_HIP4_SAMPLER_INT
(
h
->
h_´iv
->
mšÜ
, 1);

1374 
šŒ_»ûived_ù¾
 = 
	`ktime_g‘
();

1376 ià(!
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock_ù¾
)) {

1377 
	`¦si_wake_lock_timeout
(&
h
->
h_´iv
->
h4_wake_lock_ù¾
, 
	`m£cs_to_jiff›s
(
SLSI_HIP_WAKELOCK_TIME_OUT_IN_MS
));

1378 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


1379 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_TAKEN
, "h4_wake_lock_ù¾", 
WL_REASON_RX
);

1383 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
)) {

1384 
	`©omic_£t
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
, 1);

1385 
	`mod_tim”
(&
h
->
h_´iv
->
w©chdog
, 
jiff›s
 + 
HZ
);

1387 
	`£t_b™
(
HIP4_MIF_Q_TH_CTRL
, 
h
->
h_´iv
->
œq_b™m­
);

1389 
	`scsc_£rviû_mifšŒb™_b™_mask
(
sdev
->
£rviû
, 
œq
);

1391 ià(
h4_sy¡em_wq
)

1392 
	`scheduË_wÜk
(&
h
->
h_´iv
->
šŒ_wq_ù¾
);

1394 
	`queue_wÜk
(
h
->
h_´iv
->
h4_wÜkq
, &h->h_´iv->
šŒ_wq_ù¾
);

1397 
	`scsc_£rviû_mifšŒb™_b™_ş—r
(
sdev
->
£rviû
, 
œq
);

1398 
	`SCSC_HIP4_SAMPLER_INT_OUT
(
h
->
h_´iv
->
mšÜ
, 1);

1399 
	}
}

1401 
	$h4_sched_wq_ù¾
(
¦si_h4
 *
h
)

1403 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

1405 ià(!
h
 || !
sdev
 || !sdev->
£rviû
 || !h->
h_´iv
)

1408 ià(
	`©omic_»ad
(&
h
->
h_´iv
->
şosšg
))

1411 
	`h4_dump_dbg
(
h
, 
NULL
, NULL, 
sdev
->
£rviû
);

1413 ià(!
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock_ù¾
)) {

1414 
	`¦si_wake_lock_timeout
(&
h
->
h_´iv
->
h4_wake_lock_ù¾
, 
	`m£cs_to_jiff›s
(
SLSI_HIP_WAKELOCK_TIME_OUT_IN_MS
));

1415 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


1416 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_TAKEN
, "h4_wake_lock_ù¾", 
WL_REASON_RX
);

1420 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "Trigger wq for skipped ctrl BH\n");

1422 ià(
h4_sy¡em_wq
)

1423 
	`scheduË_wÜk
(&
h
->
h_´iv
->
šŒ_wq_ù¾
);

1425 if(!
	`queue_wÜk
(
h
->
h_´iv
->
h4_wÜkq
, &h->h_´iv->
šŒ_wq_ù¾
))

1426 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "hip4_wq_ctrl is‡lready scheduled\n");

1427 
	}
}

1429 
	$h4_Çpi_pŞl
(
Çpi_¡ruù
 *
Çpi
, 
budg‘
)

1431 
h4_´iv
 *
h_´iv
 = 
	`cÚš”_of
(
Çpi
, hip4_priv,‚api);

1432 
¦si_h4
 *
h
;

1433 
h4_h_cÚŒŞ
 *
ù¾
;

1434 
scsc_£rviû
 *
£rviû
;

1435 
¦si_dev
 *
sdev
;

1437 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1438 
id
;

1440 
u8
 
idx_r
;

1441 
u8
 
idx_w
;

1442 
scsc_miäam_»f
 
»f
;

1443 *
mem
;

1444 
mbulk
 *
m
;

1445 
u8
 
»Œy
;

1446 
u8
 
todo
 = 0;

1447 
wÜk_dÚe
 = 0;

1449 
	`¥š_lock_bh
(&
š_Çpi_cÚ‹xt
);

1450 ià(!
h_´iv
 || !h_´iv->
h
) {

1451 
	`SLSI_ERR_NODEV
("hip_priv or hip_priv->hip is Null\n");

1452 
	`¥š_uÆock_bh
(&
š_Çpi_cÚ‹xt
);

1456 
h
 = 
h_´iv
->hip;

1457 ià(!
h
 || !h->
h_´iv
) {

1458 
	`SLSI_ERR_NODEV
("either hip or hip->hip_priv is Null\n");

1459 
	`¥š_uÆock_bh
(&
š_Çpi_cÚ‹xt
);

1463 
ù¾
 = 
h
->
h_cÚŒŞ
;

1465 ià(!
ù¾
) {

1466 
	`SLSI_ERR_NODEV
("hip->hip_control is Null\n");

1467 
	`¥š_uÆock_bh
(&
š_Çpi_cÚ‹xt
);

1470 
sdev
 = 
	`cÚš”_of
(
h
, 
¦si_dev
, 
h4_š¡
);

1472 ià(!
sdev
 || !sdev->
£rviû
) {

1473 
	`SLSI_ERR_NODEV
("sdev or sdev->service is Null\n");

1474 
	`¥š_uÆock_bh
(&
š_Çpi_cÚ‹xt
);

1478 ià(
	`©omic_»ad
(&
sdev
->
h
.
h_¡©e
è!ğ
SLSI_HIP_STATE_STARTED
) {

1479 
	`Çpi_com¶‘e_dÚe
(
Çpi
, 0);

1480 
	`¥š_uÆock_bh
(&
š_Çpi_cÚ‹xt
);

1484 
	`¥š_lock_bh
(&
h_´iv
->
rx_lock
);

1485 
	`SCSC_HIP4_SAMPLER_INT_BH
(
h
->
h_´iv
->
mšÜ
, 0);

1486 ià(
	`ktime_com·»
(
bh_š™_d©a
, 
bh_’d_d©a
) <= 0) {

1487 
bh_š™_d©a
 = 
	`ktime_g‘
();

1488 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
şosšg
))

1489 
	`©omic_£t
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
, 0);

1491 
	`ş—r_b™
(
HIP4_MIF_Q_TH_DAT
, 
h
->
h_´iv
->
œq_b™m­
);

1493 
idx_r
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_TH_DAT
, 
ridx
);

1494 
idx_w
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_TH_DAT
, 
widx
);

1496 
£rviû
 = 
sdev
->service;

1498 ià(
idx_r
 =ğ
idx_w
) {

1499 
	`SLSI_DBG3
(
sdev
, 
SLSI_RX
, "nothingo do, NAPI Complete\n");

1500 
h
->
h_´iv
->
Çpi_rx_fuÎ_út
 = 0;

1501 
h_´iv
->
Çpi_rx_§tu¿‹d
 = 0;

1502 
bh_’d_d©a
 = 
	`ktime_g‘
();

1503 
	`Çpi_com¶‘e_dÚe
(
Çpi
, 0);

1504 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
şosšg
)) {

1506 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
]);

1509 ià(
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock_d©a
)) {

1510 
	`¦si_wake_uÆock
(&
h
->
h_´iv
->
h4_wake_lock_d©a
);

1511 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


1512 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_RELEASED
, "h4_wake_lock_d©a", 
WL_REASON_RX
);

1516 
’d
;

1519 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1520 ià(
idx_r
 !ğ
idx_w
) {

1521 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_DAT
, 
ridx
, 
idx_r
, 1);

1522 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_DAT
, 
widx
, 
idx_w
, 1);

1526 
todo
 = ((
idx_w
 - 
idx_r
) & 0xff);

1527 
	`SLSI_DBG3
(
sdev
, 
SLSI_RX
, "todo:%hhu\n", 
todo
);

1530 ià(!
Çpi_£Ëù_ıu
 && !
h_´iv
->
Çpi_³rf_mode
 && !h_´iv->
Çpi_rx_§tu¿‹d
) {

1531 ià(
todo
 > 
h4_Çpi_num_rx_pkts
)

1533 ià(++
h_´iv
->
Çpi_rx_fuÎ_út
 >ğ
h4_Çpi_num_rx_fuÎ
) {

1534 
	`SLSI_INFO
(
sdev
, "Rx queue saturating.. moveo…erformance mode\n");

1535 
h_´iv
->
Çpi_rx_§tu¿‹d
 = 1;

1538 
	`¦si_Œaffic_mÚ_ov”ride
(
sdev
);

1541 
h_´iv
->
Çpi_rx_fuÎ_út
 = 0;

1545 
idx_r
 !ğ
idx_w
) {

1546 
sk_buff
 *
skb
;

1551 
scsc_miäam_»f
 
to_ä“
[
MBULK_MAX_CHAIN
 + 1] = { 0 };

1552 
u8
 
i
 = 0;

1555 
»f
 = 
ù¾
->
q
[
HIP4_MIF_Q_TH_DAT
].
¬¿y
[
idx_r
];

1556 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1557 
	`SCSC_HIP4_SAMPLER_QREF
(
h_´iv
->
mšÜ
, 
»f
, 
HIP4_MIF_Q_TH_DAT
);

1559 
mem
 = 
	`scsc_mx_£rviû_mif_addr_to_±r
(
£rviû
, 
»f
);

1560 
m
 = (
mbulk
 *)(
mem
);

1561 
skb
 = 
	`h4_mbulk_to_skb
(
£rviû
, 
h_´iv
, 
m
, 
to_ä“
, 
Œue
);

1562 ià(!
skb
) {

1563 
	`SLSI_ERR_NODEV
("Dat: Error…arsing or‡llocating skb\n");

1564 
	`h4_dump_dbg
(
h
, 
m
, 
skb
, 
£rviû
);

1565 
cÚsume_d©_mbulk
;

1568 ià(
m
->
æag
 & 
MBULK_F_WAKEUP
) {

1569 
	`SLSI_INFO
(
sdev
, "WIFI wakeup by DATA frame:\n");

1570 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1571 
	`SCSC_BIN_TAG_INFO
(
BINARY
, 
skb
->
d©a
, skb->
Ën
 > 128 ? 128 : skb->len);

1573 
	`SCSC_BIN_TAG_INFO
(
BINARY
, 
	`çpi_g‘_d©a
(
skb
), 
	`çpi_g‘_d©®’
(skb) > 54 ? 54 : fapi_get_datalen(skb));

1575 
	`¦si_skb_cb_g‘
(
skb
)->
wakeup
 = 
Œue
;

1578 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1579 
id
 = 
	`çpi_g‘_sigid
(
skb
);

1580 
	`h4_hi¡Üy_»cÜd_add
(
TH
, 
id
);

1582 ià(
	`¦si_h_rx
(
sdev
, 
skb
) < 0) {

1583 
	`SLSI_ERR_NODEV
("Dat: Error detected slsi_hip_rx\n");

1584 
	`h4_dump_dbg
(
h
, 
m
, 
skb
, 
£rviû
);

1585 #ifdeà
CONFIG_SCSC_SMAPPER


1586 
	`h4_sm­³r_ä“_m­³d_skb
(
skb
);

1588 
	`kä“_skb
(
skb
);

1590 
cÚsume_d©_mbulk
:

1592 
idx_r
++;

1593 
idx_r
 &ğ(
MAX_NUM
 - 1);

1595 (
»f
 = 
to_ä“
[
i
++])) {

1597 
»Œy
 = 
FB_NO_SPC_NUM_RET
;

1598 
	`h4_q_add_sigÇl
(
h
, 
HIP4_MIF_Q_TH_RFB
, 
»f
, 
£rviû
è&& (!
	`©omic_»ad
(&h->
h_´iv
->
şosšg
)è&& (
»Œy
 > 0)) {

1599 
	`SLSI_WARN_NODEV
("D©: NÙƒnough s·û iÀFB,„‘ry: %d/%d\n", 
»Œy
, 
FB_NO_SPC_NUM_RET
);

1600 
	`ud–ay
(
FB_NO_SPC_DELAY_US
);

1601 
»Œy
--;

1603 ià(
»Œy
 == 0)

1604 
	`SLSI_ERR_NODEV
("D©: FB ha nÙ b“Àä“d fÜ %d us\n", 
FB_NO_SPC_NUM_RET
 * 
FB_NO_SPC_DELAY_US
);

1605 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1606 
	`SCSC_HIP4_SAMPLER_QFULL
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_RFB
);

1611 
wÜk_dÚe
++;

1612 ià(
budg‘
 =ğ
wÜk_dÚe
) {

1618 
	`h4_upd©e_šdex
(
h
, 
HIP4_MIF_Q_TH_DAT
, 
ridx
, 
idx_r
);

1620 ià(
wÜk_dÚe
 < 
budg‘
) {

1621 
	`SLSI_DBG3
(
sdev
, 
SLSI_RX
, "NAPI com¶‘(wÜk_dÚe:%d)\n", 
wÜk_dÚe
);

1622 
bh_’d_d©a
 = 
	`ktime_g‘
();

1623 
h
->
h_´iv
->
Çpi_rx_fuÎ_út
 = 0;

1624 
h_´iv
->
Çpi_rx_§tu¿‹d
 = 0;

1625 
	`Çpi_com¶‘e_dÚe
(
Çpi
, 
wÜk_dÚe
);

1626 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
şosšg
)) {

1628 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
]);

1630 ià(
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock_d©a
)) {

1631 
	`¦si_wake_uÆock
(&
h
->
h_´iv
->
h4_wake_lock_d©a
);

1632 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


1633 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_RELEASED
, "h4_wake_lock_d©a", 
WL_REASON_RX
);

1637 
’d
:

1638 
	`SLSI_DBG3
(
sdev
, 
SLSI_RX
, "wÜk dÚe:%d\n", 
wÜk_dÚe
);

1639 
	`SCSC_HIP4_SAMPLER_INT_OUT_BH
(
h
->
h_´iv
->
mšÜ
, 0);

1640 
	`¥š_uÆock_bh
(&
h_´iv
->
rx_lock
);

1641 
	`¥š_uÆock_bh
(&
š_Çpi_cÚ‹xt
);

1642  
wÜk_dÚe
;

1643 
	}
}

1645 
	$h4_œq_d©a_Çpi_sw™ch_wÜk
(
wÜk_¡ruù
 *
wÜk
)

1647 
h4_´iv
 *
h_´iv
 = 
	`cÚš”_of
(
wÜk
, h4_´iv, 
šŒ_wq_Çpi_ıu_sw™ch
);

1648 
	`loÿl_bh_di§bË
();

1649 
	`Çpi_scheduË
(&
h_´iv
->
Çpi
);

1650 
	`loÿl_bh_’abË
();

1651 
	}
}

1653 
	$h4_œq_hªdËr_d©
(
œq
, *
d©a
)

1655 
¦si_h4
 *
h
 = (¦si_h4 *)
d©a
;

1656 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

1657 
æags
;

1659 ià(!
h
 || !
sdev
 || !sdev->
£rviû
 || !h->
h_´iv
)

1662 
	`SCSC_HIP4_SAMPLER_INT
(
h
->
h_´iv
->
mšÜ
, 0);

1663 
šŒ_»ûived_d©a
 = 
	`ktime_g‘
();

1665 ià(!
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock_d©a
)) {

1666 
	`¦si_wake_lock_timeout
(&
h
->
h_´iv
->
h4_wake_lock_d©a
, 
	`m£cs_to_jiff›s
(
SLSI_HIP_WAKELOCK_TIME_OUT_IN_MS
));

1667 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


1668 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_TAKEN
, "h4_wake_lock_d©a", 
WL_REASON_RX
);

1672 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
)) {

1673 
	`©omic_£t
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
, 1);

1674 
	`mod_tim”
(&
h
->
h_´iv
->
w©chdog
, 
jiff›s
 + 
HZ
);

1676 
	`£t_b™
(
HIP4_MIF_Q_TH_DAT
, 
h
->
h_´iv
->
œq_b™m­
);

1679 
	`scsc_£rviû_mifšŒb™_b™_mask
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
]);

1681 
	`¥š_lock_œq§ve
(&
h
->
h_´iv
->
Çpi_ıu_lock
, 
æags
);

1682 ià(
	`‹¡_b™
(
SLSI_HIP_NAPI_STATE_ENABLED
, &
h
->
h_´iv
->
Çpi_¡©e
)) {

1683 ià(
Çpi_£Ëù_ıu
 && (Çpi_£Ëù_ıu !ğ
	`smp_´oûssÜ_id
()è&& 
	`ıu_Úlše
(napi_select_cpu))

1690 
	`scheduË_wÜk_Ú
(
Çpi_£Ëù_ıu
, &
h
->
h_´iv
->
šŒ_wq_Çpi_ıu_sw™ch
);

1692 
	`Çpi_scheduË
(&
h
->
h_´iv
->
Çpi
);

1694 
	`scsc_£rviû_mifšŒb™_b™_ş—r
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
]);

1696 
	`¥š_uÆock_œq»¡Üe
(&
h
->
h_´iv
->
Çpi_ıu_lock
, 
æags
);

1697 
	`SCSC_HIP4_SAMPLER_INT_OUT
(
h
->
h_´iv
->
mšÜ
, 0);

1698 
	}
}

1702 
boŞ
 
	$¦si_check_rx_æowcÚŒŞ
(
¦si_dev
 *
sdev
)

1704 
Ãtdev_vif
 *
ndev_vif
;

1705 
qËn
 = 0;

1707 
ndev_vif
 = 
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_WLAN
]);

1708 ià(
ndev_vif
)

1709 
qËn
 = 
	`skb_queue_Ën
(&
ndev_vif
->
rx_d©a
.
queue
);

1711 ià(!
	`mu‹x_Œylock
(&
sdev
->
Ãtdev_»move_mu‹x
))

1712 
ev®u©e
;

1714 #ià
	`defšed
(
SLSI_NET_INDEX_P2PX_SWLAN
)

1715 ià(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
]) {

1716 
ndev_vif
 = 
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
]);

1717 ià(
ndev_vif
)

1718 
qËn
 +ğ
	`skb_queue_Ën
(&
ndev_vif
->
rx_d©a
.
queue
);

1720 #–ià
	`defšed
(
SLSI_NET_INDEX_P2PX
)

1721 ià(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2PX
]) {

1722 
ndev_vif
 = 
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2PX
]);

1723 ià(
ndev_vif
)

1724 
qËn
 +ğ
	`skb_queue_Ën
(&
ndev_vif
->
rx_d©a
.
queue
);

1727 
	`mu‹x_uÆock
(&
sdev
->
Ãtdev_»move_mu‹x
);

1729 
ev®u©e
:

1730 ià(
qËn
 > 
max_bufã»d_äames
) {

1731 
	`SLSI_DBG1_NODEV
(
SLSI_HIP
, "max qËÀ»ached: %d\n", 
qËn
);

1732  
Œue
;

1734 
	`SLSI_DBG3_NODEV
(
SLSI_HIP
, "qËÀ%d\n", 
qËn
);

1736  
çl£
;

1737 
	}
}

1742 
	$h4_wq
(
wÜk_¡ruù
 *
d©a
)

1744 
h4_´iv
 *
h_´iv
 = 
	`cÚš”_of
(
d©a
, h4_´iv, 
šŒ_wq
);

1745 
¦si_h4
 *
h
 = 
h_´iv
->hip;

1746 
h4_h_cÚŒŞ
 *
ù¾
 = 
h
->
h_cÚŒŞ
;

1747 
scsc_miäam_»f
 
»f
;

1748 *
mem
;

1749 
mbulk
 *
m
;

1750 
u8
 
idx_r
;

1751 
u8
 
idx_w
;

1752 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

1753 
scsc_£rviû
 *
£rviû
;

1754 
boŞ
 
no_chªge
 = 
Œue
;

1755 
u8
 
»Œy
;

1756 
u32
 
·ck‘s_tÙ®
;

1758 #ià
	`defšed
(
CONFIG_SCSC_WLAN_HIP4_PROFILING
è|| defšed(
CONFIG_SCSC_WLAN_DEBUG
)

1759 
id
;

1762 ià(!
sdev
 || !sdev->
£rviû
) {

1763 
	`WARN_ON
(1);

1767 
£rviû
 = 
sdev
->service;

1769 
	`©omic_£t
(&
h
->
h_´iv
->
š_rx
, 1);

1770 
h4_rx_æowcÚŒŞ
 = 
	`¦si_check_rx_æowcÚŒŞ
(
sdev
);

1772 
	`©omic_£t
(&
h
->
h_´iv
->
š_rx
, 2);

1773 
	`¥š_lock_bh
(&
h_´iv
->
rx_lock
);

1774 
	`©omic_£t
(&
h
->
h_´iv
->
š_rx
, 3);

1776 
bh_š™
 = 
	`ktime_g‘
();

1778 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1781 
u64
 
j™‹r
;

1783 
j™‹r
 = 
	`ktime_to_ns
(
	`ktime_sub
(
bh_š™
, 
šŒ_»ûived
));

1785 ià(
j™‹r
 <ğ
HISTO_1
)

1786 
hi¡og¿m_1
++;

1787 ià(
j™‹r
 > 
HISTO_1
 && j™‹¸<ğ
HISTO_2
)

1788 
hi¡og¿m_2
++;

1789 ià(
j™‹r
 > 
HISTO_2
 && j™‹¸<ğ
HISTO_3
)

1790 
hi¡og¿m_3
++;

1791 ià(
j™‹r
 > 
HISTO_3
 && j™‹¸<ğ
HISTO_4
)

1792 
hi¡og¿m_4
++;

1793 ià(
j™‹r
 > 
HISTO_4
 && j™‹¸<ğ
HISTO_5
)

1794 
hi¡og¿m_5
++;

1796 
hi¡og¿m_6
++;

1798 ià(
j™‹r
 > 
max_j™‹r
)

1799 
max_j™‹r
 = 
j™‹r
;

1802 
idx_r
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_FH_RFB
, 
ridx
);

1803 
idx_w
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_FH_RFB
, 
widx
);

1805 ià(
idx_r
 !ğ
idx_w
) {

1806 
no_chªge
 = 
çl£
;

1807 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_FH_RFB
, 
ridx
, 
idx_r
, 1);

1808 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_FH_RFB
, 
widx
, 
idx_w
, 1);

1811 
	`SCSC_HIP4_SAMPLER_INT_BH
(
h_´iv
->
mšÜ
, 2);

1812 
idx_r
 !ğ
idx_w
) {

1813 
mbulk
 *
m
;

1814 
mbulk_cŞour
 
cŞour
;

1816 
»f
 = 
ù¾
->
q
[
HIP4_MIF_Q_FH_RFB
].
¬¿y
[
idx_r
];

1817 
	`SCSC_HIP4_SAMPLER_QREF
(
h_´iv
->
mšÜ
, 
»f
, 
HIP4_MIF_Q_FH_RFB
);

1818 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1819 
h
->
h_´iv
->
¡©s
.
q_num_äames
[
HIP4_MIF_Q_FH_RFB
] = hip->hip_priv->stats.q_num_frames[HIP4_MIF_Q_FH_RFB] + 1;

1821 
mem
 = 
	`scsc_mx_£rviû_mif_addr_to_±r
(
£rviû
, 
»f
);

1822 
m
 = (
mbulk
 *)
mem
;

1823 ià(!
m
) {

1824 
	`SLSI_ERR_NODEV
("FB: Mbulk i NULL 0x%x\n", 
»f
);

1825 
cÚsume_fb_mbulk
;

1829 ià((
m
->
pid
 & 0x1è=ğ
MBULK_POOL_ID_DATA
) {

1830 
cŞour
 = 
	`mbulk_g‘_cŞour
(
MBULK_POOL_ID_DATA
, 
m
);

1831 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1832 
	`SCSC_HIP4_SAMPLER_VIF_PEER
(
h
->
h_´iv
->
mšÜ
,

1834 
	`SLSI_MBULK_COLOUR_GET_VIF
(
cŞour
),

1835 
	`SLSI_MBULK_COLOUR_GET_PEER_IDX
(
cŞour
));

1838 
u16
 
ho¡_g
;

1839 
u8
 *
g‘_ho¡_g
;

1844 
g‘_ho¡_g
 = (
u8
 *)
m
;

1845 
ho¡_g
 = 
g‘_ho¡_g
[37] << 8 | get_host_tag[36];

1846 
	`SCSC_HIP4_SAMPLER_PKT_TX_FB
(
h
->
h_´iv
->
mšÜ
, 
ho¡_g
);

1850 
	`¦si_h_tx_dÚe
(
sdev
,

1851 
	`SLSI_MBULK_COLOUR_GET_VIF
(
cŞour
),

1852 
	`SLSI_MBULK_COLOUR_GET_PEER_IDX
(
cŞour
),

1853 
	`SLSI_MBULK_COLOUR_GET_AC
(
cŞour
));

1855 
	`mbulk_ä“_vœt_ho¡
(
m
);

1856 
cÚsume_fb_mbulk
:

1858 
idx_r
++;

1859 
idx_r
 &ğ(
MAX_NUM
 - 1);

1860 
	`h4_upd©e_šdex
(
h
, 
HIP4_MIF_Q_FH_RFB
, 
ridx
, 
idx_r
);

1862 
	`SCSC_HIP4_SAMPLER_INT_OUT_BH
(
h_´iv
->
mšÜ
, 2);

1864 
	`©omic_£t
(&
h
->
h_´iv
->
š_rx
, 4);

1866 
idx_r
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_TH_CTRL
, 
ridx
);

1867 
idx_w
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_TH_CTRL
, 
widx
);

1869 ià(
idx_r
 !ğ
idx_w
) {

1870 
no_chªge
 = 
çl£
;

1871 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_CTRL
, 
ridx
, 
idx_r
, 1);

1872 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_CTRL
, 
widx
, 
idx_w
, 1);

1875 
	`SCSC_HIP4_SAMPLER_INT_BH
(
h_´iv
->
mšÜ
, 1);

1876 
idx_r
 !ğ
idx_w
) {

1877 
sk_buff
 *
skb
;

1882 
scsc_miäam_»f
 
to_ä“
[
MBULK_MAX_CHAIN
 + 1] = { 0 };

1883 
u8
 
i
 = 0;

1886 
»f
 = 
ù¾
->
q
[
HIP4_MIF_Q_TH_CTRL
].
¬¿y
[
idx_r
];

1887 
	`SCSC_HIP4_SAMPLER_QREF
(
h_´iv
->
mšÜ
, 
»f
, 
HIP4_MIF_Q_TH_CTRL
);

1888 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1889 
h
->
h_´iv
->
¡©s
.
q_num_äames
[
HIP4_MIF_Q_TH_CTRL
] = hip->hip_priv->stats.q_num_frames[HIP4_MIF_Q_TH_CTRL] + 1;

1891 
mem
 = 
	`scsc_mx_£rviû_mif_addr_to_±r
(
£rviû
, 
»f
);

1892 
m
 = (
mbulk
 *)(
mem
);

1893 ià(!
m
) {

1894 
	`SLSI_ERR_NODEV
("CŒl: Mbulk i NULL 0x%x\n", 
»f
);

1895 
cÚsume_ùl_mbulk
;

1898 
skb
 = 
	`h4_mbulk_to_skb
(
£rviû
, 
h_´iv
, 
m
, 
to_ä“
, 
çl£
);

1899 ià(!
skb
) {

1900 
	`SLSI_ERR_NODEV
("Ctrl: Error…arsing or‡llocating skb\n");

1901 
	`h4_dump_dbg
(
h
, 
m
, 
skb
, 
£rviû
);

1902 
cÚsume_ùl_mbulk
;

1905 ià(
m
->
æag
 & 
MBULK_F_WAKEUP
) {

1906 
	`SLSI_INFO
(
sdev
, "WIFI wakeu°by MLME f¿m0x%x:\n", 
	`çpi_g‘_sigid
(
skb
));

1907 
	`SCSC_BIN_TAG_INFO
(
BINARY
, 
skb
->
d©a
, skb->
Ën
 > 128 ? 128 : skb->len);

1908 
	`¦si_skb_cb_g‘
(
skb
)->
wakeup
 = 
Œue
;

1911 #ià
	`defšed
(
CONFIG_SCSC_WLAN_HIP4_PROFILING
è|| defšed(
CONFIG_SCSC_WLAN_DEBUG
)

1912 
id
 = 
	`çpi_g‘_sigid
(
skb
);

1914 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1916 ià(
	`çpi_is_mlme
(
skb
))

1917 
	`SCSC_HIP4_SAMPLER_SIGNAL_CTRLRX
(
h_´iv
->
mšÜ
, (
id
 & 0xff00) >> 8, id & 0xff);

1919 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1920 
	`h4_hi¡Üy_»cÜd_add
(
TH
, 
id
);

1922 ià(
	`¦si_h_rx
(
sdev
, 
skb
) < 0) {

1923 
	`SLSI_ERR_NODEV
("Ctrl: Error detected slsi_hip_rx\n");

1924 
	`h4_dump_dbg
(
h
, 
m
, 
skb
, 
£rviû
);

1925 #ifdeà
CONFIG_SCSC_SMAPPER


1926 
	`h4_sm­³r_ä“_m­³d_skb
(
skb
);

1928 
	`kä“_skb
(
skb
);

1930 
cÚsume_ùl_mbulk
:

1932 
idx_r
++;

1933 
idx_r
 &ğ(
MAX_NUM
 - 1);

1936 (
»f
 = 
to_ä“
[
i
++])) {

1938 
»Œy
 = 
FB_NO_SPC_NUM_RET
;

1940 
	`h4_q_add_sigÇl
(
h
, 
HIP4_MIF_Q_TH_RFB
, 
»f
, 
£rviû
è&& (!
	`©omic_»ad
(&h->
h_´iv
->
şosšg
)è&& 
»Œy
 > 0) {

1941 
	`SLSI_WARN_NODEV
("CŒl: NÙƒnough s·û iÀFB,„‘ry: %d/%d\n", 
»Œy
, 
FB_NO_SPC_NUM_RET
);

1942 
	`¥š_uÆock_bh
(&
h_´iv
->
rx_lock
);

1943 
	`m¦“p
(
FB_NO_SPC_SLEEP_MS
);

1944 
	`¥š_lock_bh
(&
h_´iv
->
rx_lock
);

1945 
»Œy
--;

1946 ià(
»Œy
 == 0)

1947 
	`SLSI_ERR_NODEV
("CŒl: FB ha nÙ b“Àä“d fÜ %d ms\n", 
FB_NO_SPC_NUM_RET
 * 
FB_NO_SPC_SLEEP_MS
);

1948 
	`SCSC_HIP4_SAMPLER_QFULL
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_RFB
);

1951 
	`h4_upd©e_šdex
(
h
, 
HIP4_MIF_Q_TH_CTRL
, 
ridx
, 
idx_r
);

1954 
	`SCSC_HIP4_SAMPLER_INT_OUT_BH
(
h_´iv
->
mšÜ
, 1);

1956 ià(
h4_rx_æowcÚŒŞ
)

1957 
sk_d©a_q
;

1959 
	`©omic_£t
(&
h
->
h_´iv
->
š_rx
, 5);

1961 
idx_r
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_TH_DAT
, 
ridx
);

1962 
idx_w
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_TH_DAT
, 
widx
);

1964 ià(
idx_r
 !ğ
idx_w
) {

1965 
·ck‘s_tÙ®
 = 0;

1966 
no_chªge
 = 
çl£
;

1967 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_DAT
, 
ridx
, 
idx_r
, 1);

1968 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_DAT
, 
widx
, 
idx_w
, 1);

1969 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1972 
u8
 
num_·ck‘s
 = (
idx_w
 - 
idx_r
) % 256;

1974 ià(
num_·ck‘s
 <ğ
HISTO_1_DATA
)

1975 
hi¡og¿m_1_d©a
++;

1976 ià(
num_·ck‘s
 > 
HISTO_1_DATA
 &&‚um_·ck‘ <ğ
HISTO_2_DATA
)

1977 
hi¡og¿m_2_d©a
++;

1978 ià(
num_·ck‘s
 > 
HISTO_2_DATA
 &&‚um_·ck‘ <ğ
HISTO_3_DATA
)

1979 
hi¡og¿m_3_d©a
++;

1980 ià(
num_·ck‘s
 > 
HISTO_3_DATA
 &&‚um_·ck‘ <ğ
HISTO_4_DATA
)

1981 
hi¡og¿m_4_d©a
++;

1982 ià(
num_·ck‘s
 > 
HISTO_4_DATA
 &&‚um_·ck‘ <ğ
HISTO_5_DATA
)

1983 
hi¡og¿m_5_d©a
++;

1985 
hi¡og¿m_6_d©a
++;

1986 ià(
num_·ck‘s
 > 
max_d©a
)

1987 
max_d©a
 = 
num_·ck‘s
;

1992 
	`SCSC_HIP4_SAMPLER_INT_BH
(
h_´iv
->
mšÜ
, 0);

1993 
idx_r
 !ğ
idx_w
) {

1994 
sk_buff
 *
skb
;

1999 
scsc_miäam_»f
 
to_ä“
[
MBULK_MAX_CHAIN
 + 1] = { 0 };

2000 
u8
 
i
 = 0;

2002 
·ck‘s_tÙ®
++;

2004 
»f
 = 
ù¾
->
q
[
HIP4_MIF_Q_TH_DAT
].
¬¿y
[
idx_r
];

2005 
	`SCSC_HIP4_SAMPLER_QREF
(
h_´iv
->
mšÜ
, 
»f
, 
HIP4_MIF_Q_TH_DAT
);

2006 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


2007 
h
->
h_´iv
->
¡©s
.
q_num_äames
[
HIP4_MIF_Q_TH_DAT
] = hip->hip_priv->stats.q_num_frames[HIP4_MIF_Q_TH_DAT] + 1;

2009 
mem
 = 
	`scsc_mx_£rviû_mif_addr_to_±r
(
£rviû
, 
»f
);

2010 
m
 = (
mbulk
 *)(
mem
);

2011 ià(!
m
) {

2012 
	`SLSI_ERR_NODEV
("D©: Mbulk i NULL 0x%x\n", 
»f
);

2013 
cÚsume_d©_mbulk
;

2016 
skb
 = 
	`h4_mbulk_to_skb
(
£rviû
, 
h_´iv
, 
m
, 
to_ä“
, 
çl£
);

2017 ià(!
skb
) {

2018 
	`SLSI_ERR_NODEV
("Dat: Error…arsing or‡llocating skb\n");

2019 
	`h4_dump_dbg
(
h
, 
m
, 
skb
, 
£rviû
);

2020 
cÚsume_d©_mbulk
;

2023 ià(
m
->
æag
 & 
MBULK_F_WAKEUP
) {

2024 
	`SLSI_INFO
(
sdev
, "WIFI wakeup by DATA frame:\n");

2025 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


2026 
	`SCSC_BIN_TAG_INFO
(
BINARY
, 
skb
->
d©a
, skb->
Ën
 > 128 ? 128 : skb->len);

2028 
	`SCSC_BIN_TAG_INFO
(
BINARY
, 
	`çpi_g‘_d©a
(
skb
), 
	`çpi_g‘_d©®’
(skb) > 54 ? 54 : fapi_get_datalen(skb));

2030 
	`¦si_skb_cb_g‘
(
skb
)->
wakeup
 = 
Œue
;

2033 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


2034 
id
 = 
	`çpi_g‘_sigid
(
skb
);

2035 
	`h4_hi¡Üy_»cÜd_add
(
TH
, 
id
);

2037 ià(
	`¦si_h_rx
(
sdev
, 
skb
) < 0) {

2038 
	`SLSI_ERR_NODEV
("Dat: Error detected slsi_hip_rx\n");

2039 
	`h4_dump_dbg
(
h
, 
m
, 
skb
, 
£rviû
);

2040 #ifdeà
CONFIG_SCSC_SMAPPER


2041 
	`h4_sm­³r_ä“_m­³d_skb
(
skb
);

2043 
	`kä“_skb
(
skb
);

2045 
cÚsume_d©_mbulk
:

2047 
idx_r
++;

2048 
idx_r
 &ğ(
MAX_NUM
 - 1);

2051 (
»f
 = 
to_ä“
[
i
++])) {

2053 
»Œy
 = 
FB_NO_SPC_NUM_RET
;

2055 
	`h4_q_add_sigÇl
(
h
, 
HIP4_MIF_Q_TH_RFB
, 
»f
, 
£rviû
è&& (!
	`©omic_»ad
(&h->
h_´iv
->
şosšg
)è&& 
»Œy
 > 0) {

2056 
	`SLSI_WARN_NODEV
("D©: NÙƒnough s·û iÀFB,„‘ry: %d/%d\n", 
»Œy
, 
FB_NO_SPC_NUM_RET
);

2057 
	`¥š_uÆock_bh
(&
h_´iv
->
rx_lock
);

2058 
	`m¦“p
(
FB_NO_SPC_SLEEP_MS
);

2059 
	`¥š_lock_bh
(&
h_´iv
->
rx_lock
);

2060 
»Œy
--;

2061 ià(
»Œy
 == 0)

2062 
	`SLSI_ERR_NODEV
("D©: FB ha nÙ b“Àä“d fÜ %d ms\n", 
FB_NO_SPC_NUM_RET
 * 
FB_NO_SPC_SLEEP_MS
);

2063 
	`SCSC_HIP4_SAMPLER_QFULL
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_RFB
);

2067 
	`h4_upd©e_šdex
(
h
, 
HIP4_MIF_Q_TH_DAT
, 
ridx
, 
idx_r
);

2070 ià((
idx_r
 =ğ
idx_w
è&& (
·ck‘s_tÙ®
 < 
HIP4_POLLING_MAX_PACKETS
)) {

2071 
u8
 
Şd_idx
 = 
idx_w
;

2073 
idx_w
 = 
	`h4_»ad_šdex
(
h
, 
HIP4_MIF_Q_TH_DAT
, 
widx
);

2074 ià(
idx_w
 !ğ
Şd_idx
) {

2075 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_DAT
, 
ridx
, 
idx_r
, 1);

2076 
	`SCSC_HIP4_SAMPLER_Q
(
h_´iv
->
mšÜ
, 
HIP4_MIF_Q_TH_DAT
, 
widx
, 
idx_w
, 1);

2080 
	`SCSC_HIP4_SAMPLER_INT_OUT_BH
(
h_´iv
->
mšÜ
, 0);

2082 ià(
no_chªge
)

2083 
	`©omic_šc
(&
h
->
h_´iv
->
¡©s
.
¥urious_œqs
);

2085 
sk_d©a_q
:

2086 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
şosšg
)) {

2088 
	`©omic_£t
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
, 0);

2089 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

2092 ià(
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock
)) {

2093 
	`¦si_wake_uÆock
(&
h
->
h_´iv
->
h4_wake_lock
);

2094 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


2095 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_RELEASED
, "h4_wake_lock", 
WL_REASON_RX
);

2099 
bh_’d
 = 
	`ktime_g‘
();

2100 
	`©omic_£t
(&
h
->
h_´iv
->
š_rx
, 0);

2101 
	`¥š_uÆock_bh
(&
h_´iv
->
rx_lock
);

2102 
	}
}

2107 
	$h4_œq_hªdËr
(
œq
, *
d©a
)

2109 
¦si_h4
 *
h
 = (¦si_h4 *)
d©a
;

2110 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

2112 ()
œq
;

2114 ià(!
h
 || !
sdev
 || !sdev->
£rviû
 || !h->
h_´iv
)

2117 
	`SCSC_HIP4_SAMPLER_INT
(
h
->
h_´iv
->
mšÜ
, 0);

2118 
	`SCSC_HIP4_SAMPLER_INT
(
h
->
h_´iv
->
mšÜ
, 1);

2119 
	`SCSC_HIP4_SAMPLER_INT
(
h
->
h_´iv
->
mšÜ
, 2);

2120 
šŒ_»ûived
 = 
	`ktime_g‘
();

2122 ià(!
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock
)) {

2123 
	`¦si_wake_lock_timeout
(&
h
->
h_´iv
->
h4_wake_lock
, 
	`m£cs_to_jiff›s
(
SLSI_HIP_WAKELOCK_TIME_OUT_IN_MS
));

2124 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


2125 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_TAKEN
, "h4_wake_lock", 
WL_REASON_RX
);

2132 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
)) {

2133 
	`©omic_£t
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
, 1);

2134 
	`mod_tim”
(&
h
->
h_´iv
->
w©chdog
, 
jiff›s
 + 
HZ
);

2136 
	`SLSI_ERR_NODEV
("INTriggered while WDT is‡ctive\n");

2137 
	`SLSI_ERR_NODEV
("bh_š™ %Îd\n", 
	`ktime_to_ns
(
bh_š™
));

2138 
	`SLSI_ERR_NODEV
("bh_’d %Îd\n", 
	`ktime_to_ns
(
bh_’d
));

2139 
	`SLSI_ERR_NODEV
("h4_wq wÜk_busy %d\n", 
	`wÜk_busy
(&
h
->
h_´iv
->
šŒ_wq
));

2140 
	`SLSI_ERR_NODEV
("h4_´iv->š_rx %d\n", 
	`©omic_»ad
(&
h
->
h_´iv
->
š_rx
));

2143 ià(!
	`©omic_»ad
(&
h
->
h_´iv
->
š_su¥’d
)) {

2144 
	`scsc_£rviû_mifšŒb™_b™_mask
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

2145 
h
->
h_´iv
->
¡Üm_couÁ
 = 0;

2146 } ià(++
h
->
h_´iv
->
¡Üm_couÁ
 >ğ
MAX_STORM
) {

2152 
h
->
h_´iv
->
¡Üm_couÁ
 = 0;

2153 
	`scsc_£rviû_mifšŒb™_b™_mask
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

2156 
	`©omic_šc
(&
h
->
h_´iv
->
¡©s
.
œqs
);

2158 ià(
h4_sy¡em_wq
)

2159 
	`scheduË_wÜk
(&
h
->
h_´iv
->
šŒ_wq
);

2161 
	`queue_wÜk
(
h
->
h_´iv
->
h4_wÜkq
, &h->h_´iv->
šŒ_wq
);

2164 
	`scsc_£rviû_mifšŒb™_b™_ş—r
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

2165 
	`SCSC_HIP4_SAMPLER_INT_OUT
(
h
->
h_´iv
->
mšÜ
, 0);

2166 
	`SCSC_HIP4_SAMPLER_INT_OUT
(
h
->
h_´iv
->
mšÜ
, 1);

2167 
	`SCSC_HIP4_SAMPLER_INT_OUT
(
h
->
h_´iv
->
mšÜ
, 2);

2168 
	}
}

2170 
	$h4_sched_wq
(
¦si_h4
 *
h
)

2172 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

2174 ià(!
h
 || !
sdev
 || !sdev->
£rviû
 || !h->
h_´iv
)

2177 ià(
	`©omic_»ad
(&
h
->
h_´iv
->
şosšg
è|| !
h4_rx_æowcÚŒŞ
)

2180 ià(!
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock
)) {

2181 
	`¦si_wake_lock_timeout
(&
h
->
h_´iv
->
h4_wake_lock
, 
	`m£cs_to_jiff›s
(
SLSI_HIP_WAKELOCK_TIME_OUT_IN_MS
));

2182 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


2183 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_TAKEN
, "h4_wake_lock", 
WL_REASON_RX
);

2187 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "Trigger wq for skipped data BH\n");

2189 ià(
h4_sy¡em_wq
)

2190 
	`scheduË_wÜk
(&
h
->
h_´iv
->
šŒ_wq
);

2192 
	`queue_wÜk
(
h
->
h_´iv
->
h4_wÜkq
, &h->h_´iv->
šŒ_wq
);

2193 
	}
}

2195 #ifdeà
CONFIG_SCSC_QOS


2196 
	$h4_pm_qos_wÜk
(
wÜk_¡ruù
 *
d©a
)

2198 
h4_´iv
 *
h_´iv
 = 
	`cÚš”_of
(
d©a
, h4_´iv, 
pm_qos_wÜk
);

2199 
¦si_h4
 *
h
 = 
h_´iv
->hip;

2200 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

2201 
u8
 
¡©e
;

2203 ià(!
sdev
 || !sdev->
£rviû
) {

2204 
	`WARN_ON
(1);

2208 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "upd©tØ¡©%d\n", 
h_´iv
->
pm_qos_¡©e
);

2209 
	`¥š_lock_bh
(&
h_´iv
->
pm_qos_lock
);

2210 
¡©e
 = 
h_´iv
->
pm_qos_¡©e
;

2211 
	`¥š_uÆock_bh
(&
h_´iv
->
pm_qos_lock
);

2212 
	`scsc_£rviû_pm_qos_upd©e_»que¡
(
sdev
->
£rviû
, 
¡©e
);

2213 
	}
}

2215 
	$h4_Œaffic_mÚ™Ü_cb
(*
ş›Á_ùx
, 
u32
 
¡©e
, u32 
ut_tx
, u32 
ut_rx
)

2217 
¦si_h4
 *
h
 = (¦si_h4 *)
ş›Á_ùx
;

2218 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

2219 
u8
 
¡©e_befÜe
;

2221 ià(!
sdev
)

2224 
	`¥š_lock_bh
(&
h
->
h_´iv
->
pm_qos_lock
);

2225 
¡©e_befÜe
 = 
h
->
h_´iv
->
pm_qos_¡©e
;

2227 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "¡©e:%u -->ƒv’ˆ(¡©e:%u,put_tx:%u bps,put_rx:%u bps)\n", 
¡©e_befÜe
, 
¡©e
, 
ut_tx
, 
ut_rx
);

2229 ià(
¡©e
 =ğ
TRAFFIC_MON_CLIENT_STATE_HIGH
 || s‹ =ğ
TRAFFIC_MON_CLIENT_STATE_OVERRIDE
)

2230 
h
->
h_´iv
->
pm_qos_¡©e
 = 
SCSC_QOS_MAX
;

2231 ià(
¡©e
 =ğ
TRAFFIC_MON_CLIENT_STATE_MID
)

2232 
h
->
h_´iv
->
pm_qos_¡©e
 = 
SCSC_QOS_MED
;

2234 
h
->
h_´iv
->
pm_qos_¡©e
 = 
SCSC_QOS_DISABLED
;

2236 
	`¥š_uÆock_bh
(&
h
->
h_´iv
->
pm_qos_lock
);

2238 ià(
¡©e_befÜe
 !ğ
h
->
h_´iv
->
pm_qos_¡©e
)

2239 
	`scheduË_wÜk
(&
h
->
h_´iv
->
pm_qos_wÜk
);

2240 
	}
}

2243 #ià
IS_ENABLED
(
CONFIG_SCSC_LOGRING
)

2244 
	$h4_Œaffic_mÚ™Ü_logršg_cb
(*
ş›Á_ùx
, 
u32
 
¡©e
, u32 
ut_tx
, u32 
ut_rx
)

2246 
h4_´iv
 *
h_´iv
 = (h4_´iv *)
ş›Á_ùx
;

2247 
¦si_h4
 *
h
 = 
h_´iv
->hip;

2248 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

2250 ià(!
sdev
)

2253 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "ev’ˆ(¡©e:%u,put_tx:%u bps,put_rx:%u bps)\n", 
¡©e
, 
ut_tx
, 
ut_rx
);

2254 ià(
¡©e
 =ğ
TRAFFIC_MON_CLIENT_STATE_HIGH
 || s‹ =ğ
TRAFFIC_MON_CLIENT_STATE_MID
 || s‹ =ğ
TRAFFIC_MON_CLIENT_STATE_OVERRIDE
) {

2255 ià(
h4_dyÇmic_loggšg
)

2256 
	`scsc_logršg_’abË
(
çl£
);

2258 
	`scsc_logršg_’abË
(
Œue
);

2260 
	}
}

2263 
	$h4_š™
(
¦si_h4
 *
h
)

2265 *
h_±r
;

2266 
h4_h_cÚŒŞ
 *
h_cÚŒŞ
;

2267 
scsc_£rviû
 *
£rviû
;

2268 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

2269 
scsc_miäam_»f
 
»f
, 
»f_scÜebßrd
;

2270 
i
;

2271 
»t
;

2272 
u32
 
tÙ®_mib_Ën
;

2273 
u32
 
mib_fe_off£t
;

2274 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2275 
Ãt_deviû
 *
dev
;

2278 ià(!
sdev
 || !sdev->
£rviû
)

2279  -
EINVAL
;

2281 
h
->
h_´iv
 = 
	`kz®loc
((*h->h_´iv), 
GFP_ATOMIC
);

2282 ià(!
h
->
h_´iv
)

2283  -
ENOMEM
;

2285 
	`SLSI_INFO_NODEV
("HIP4_WLAN_CONFIG_SIZE (%d)\n", 
HIP4_WLAN_CONFIG_SIZE
);

2286 
	`SLSI_INFO_NODEV
("HIP4_WLAN_MIB_SIZE (%d)\n", 
HIP4_WLAN_MIB_SIZE
);

2287 
	`SLSI_INFO_NODEV
("HIP4_WLAN_TX_DAT_SIZE (%d)\n", 
HIP4_WLAN_TX_DAT_SIZE
);

2288 
	`SLSI_INFO_NODEV
("HIP4_WLAN_TX_CTL_SIZE (%d)\n", 
HIP4_WLAN_TX_CTL_SIZE
);

2289 
	`SLSI_INFO_NODEV
("HIP4_WLAN_RX_SIZE (%d)\n", 
HIP4_WLAN_RX_SIZE
);

2290 
	`SLSI_INFO_NODEV
("HIP4_WLAN_TOTAL_MEM (%d)\n", 
HIP4_WLAN_TOTAL_MEM
);

2291 
	`SLSI_INFO_NODEV
("HIP4_DAT_SLOTS (%d)\n", 
HIP4_DAT_SLOTS
);

2292 
	`SLSI_INFO_NODEV
("HIP4_CTL_SLOTS (%d)\n", 
HIP4_CTL_SLOTS
);

2293 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


2294 
	`mem£t
(&
h
->
h_´iv
->
¡©s
, 0, (hip->hip_priv->stats));

2295 
h
->
h_´iv
->
¡©s
.
¡¬t
 = 
	`ktime_g‘
();

2296 
h
->
h_´iv
->
¡©s
.
´ocfs_dœ
 = 
	`´oc_mkdœ
("driv”/h4", 
NULL
);

2297 ià(
h
->
h_´iv
->
¡©s
.
´ocfs_dœ
) {

2298 
	`´oc_ü—‹_d©a
("šfo", 
S_IRUSR
 | 
S_IRGRP
,

2299 
h
->
h_´iv
->
¡©s
.
´ocfs_dœ
, &
h4_´ocfs_¡©s_fİs
, hip);

2300 
	`´oc_ü—‹_d©a
("hi¡Üy", 
S_IRUSR
 | 
S_IRGRP
,

2301 
h
->
h_´iv
->
¡©s
.
´ocfs_dœ
, &
h4_´ocfs_hi¡Üy_fİs
, hip);

2302 
	`´oc_ü—‹_d©a
("j™‹r", 
S_IRUSR
 | 
S_IRGRP
,

2303 
h
->
h_´iv
->
¡©s
.
´ocfs_dœ
, &
h4_´ocfs_j™‹r_fİs
, hip);

2306 
h
->
h_´iv
->
mšÜ
 = 
	`h4_§m¶”_»gi¡”_h
(
sdev
->
maxw–l_cÜe
);

2307 ià(
h
->
h_´iv
->
mšÜ
 < 
SCSC_HIP4_INTERFACES
) {

2308 
	`SLSI_DBG1_NODEV
(
SLSI_HIP
, "»gi¡”ed w™h mšÜ %d\n", 
h
->
h_´iv
->
mšÜ
);

2309 
sdev
->
mšÜ_´of
 = 
h
->
h_´iv
->
mšÜ
;

2311 
	`SLSI_DBG1_NODEV
(
SLSI_HIP
, "hip4_sampler is‚otƒnabled\n");

2316 
h
->
h_´iv
->hip = hip;

2318 
£rviû
 = 
sdev
->service;

2320 
h
->
h_´iv
->
ho¡_poŞ_id_d©
 = 
MBULK_POOL_ID_DATA
;

2321 
h
->
h_´iv
->
ho¡_poŞ_id_ùl
 = 
MBULK_POOL_ID_CTRL
;

2325 
h_±r
 = 
	`scsc_mx_£rviû_mif_addr_to_±r
(
£rviû
, 
h
->
h_»f
);

2327 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


2329 
»t
 = 
	`mbulk_poŞ_add
(
MBULK_POOL_ID_DATA
, 
h_±r
 + 
HIP4_WLAN_TX_DAT_OFFSET
,

2330 
h_±r
 + 
HIP4_WLAN_TX_DAT_OFFSET
 + 
HIP4_WLAN_TX_DAT_SIZE
,

2331 (
HIP4_WLAN_TX_DAT_SIZE
 / 
HIP4_DAT_SLOTS
è- (
mbulk
), 5,

2332 
h
->
h_´iv
->
mšÜ
);

2333 ià(
»t
)

2334  
»t
;

2337 
»t
 = 
	`mbulk_poŞ_add
(
MBULK_POOL_ID_CTRL
, 
h_±r
 + 
HIP4_WLAN_TX_CTL_OFFSET
,

2338 
h_±r
 + 
HIP4_WLAN_TX_CTL_OFFSET
 + 
HIP4_WLAN_TX_CTL_SIZE
,

2339 (
HIP4_WLAN_TX_CTL_SIZE
 / 
HIP4_CTL_SLOTS
è- (
mbulk
), 0,

2340 
h
->
h_´iv
->
mšÜ
);

2341 ià(
»t
)

2342  
»t
;

2345 
»t
 = 
	`mbulk_poŞ_add
(
MBULK_POOL_ID_DATA
, 
h_±r
 + 
HIP4_WLAN_TX_DAT_OFFSET
,

2346 
h_±r
 + 
HIP4_WLAN_TX_DAT_OFFSET
 + 
HIP4_WLAN_TX_DAT_SIZE
,

2347 (
HIP4_WLAN_TX_DAT_SIZE
 / 
HIP4_DAT_SLOTS
è- (
mbulk
), 5);

2348 ià(
»t
)

2349  
»t
;

2352 
»t
 = 
	`mbulk_poŞ_add
(
MBULK_POOL_ID_CTRL
, 
h_±r
 + 
HIP4_WLAN_TX_CTL_OFFSET
,

2353 
h_±r
 + 
HIP4_WLAN_TX_CTL_OFFSET
 + 
HIP4_WLAN_TX_CTL_SIZE
,

2354 (
HIP4_WLAN_TX_CTL_SIZE
 / 
HIP4_CTL_SLOTS
è- (
mbulk
), 0);

2355 ià(
»t
)

2356  
»t
;

2360 
	`mem£t
(
h_±r
, 0, (
h4_h_cÚŒŞ
));

2363 
	`SCSC_HIP4_SAMPLER_RESET
(
h
->
h_´iv
->
mšÜ
);

2367 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2369 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_FH_CTRL
] = 
MIF_NO_IRQ
;

2371 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_FH_DAT
] = 
MIF_NO_IRQ
;

2373 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_RFB
] = 
MIF_NO_IRQ
;

2375 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_FH_RFB
] =

2376 
	`scsc_£rviû_mifšŒb™_»gi¡”_toho¡
(
£rviû
, 
h4_œq_hªdËr_fb
, 
h
);

2377 
	`scsc_£rviû_mifšŒb™_b™_mask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_FH_RFB
]);

2379 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_CTRL
] =

2380 
	`scsc_£rviû_mifšŒb™_»gi¡”_toho¡
(
£rviû
, 
h4_œq_hªdËr_ù¾
, 
h
);

2381 
	`scsc_£rviû_mifšŒb™_b™_mask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_CTRL
]);

2383 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
] =

2384 
	`scsc_£rviû_mifšŒb™_»gi¡”_toho¡
(
£rviû
, 
h4_œq_hªdËr_d©
, 
h
);

2385 
	`scsc_£rviû_mifšŒb™_b™_mask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
]);

2387 
	`rcu_»ad_lock
();

2389 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

2390 ià(!
dev
) {

2391 
	`SLSI_ERR
(
sdev
, "netdev No†ongerƒxists\n");

2392 
	`rcu_»ad_uÆock
();

2393  -
EINVAL
;

2395 
	`Ãtif_Çpi_add
(
dev
, &
h
->
h_´iv
->
Çpi
, 
h4_Çpi_pŞl
, 
NAPI_POLL_WEIGHT
);

2396 
	`rcu_»ad_uÆock
();

2399 
h
->
h_´iv
->
šŒ_toho¡
 =

2400 
	`scsc_£rviû_mifšŒb™_»gi¡”_toho¡
(
£rviû
, 
h4_œq_hªdËr
, 
h
);

2403 
	`scsc_£rviû_mifšŒb™_b™_mask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

2407 
h
->
h_´iv
->
šŒ_äomho¡
 =

2408 
	`scsc_£rviû_mifšŒb™_®loc_äomho¡
(
£rviû
, 
SCSC_MIFINTR_TARGET_R4
);

2411 
h_cÚŒŞ
 = (
h4_h_cÚŒŞ
 *)(
h_±r
 +

2412 
HIP4_WLAN_CONFIG_OFFSET
);

2415 ià(
	`scsc_mx_£rviû_mif_±r_to_addr
(
£rviû
, &
h_cÚŒŞ
->
scÜebßrd
, &
»f_scÜebßrd
))

2416  -
EFAULT
;

2419 
i
 = 0, 
tÙ®_mib_Ën
 = 0; i < 
SLSI_WLAN_MAX_MIB_FILE
; i++)

2420 
tÙ®_mib_Ën
 +ğ
sdev
->
mib
[
i
].
mib_Ën
;

2424 
	`mem£t
(
h_±r
 + 
HIP4_WLAN_MIB_OFFSET
, 0, 
HIP4_WLAN_MIB_SIZE
);

2426 ià(
tÙ®_mib_Ën
 > 
HIP4_WLAN_MIB_SIZE
) {

2427 
	`SLSI_ERR_NODEV
("MIB siz(%d), i bigg”hªhMIB AREA (%d). AbÜtšg memıy\n", 
tÙ®_mib_Ën
, 
HIP4_WLAN_MIB_SIZE
);

2428 
h_cÚŒŞ
->
cÚfig_v4
.
mib_loc
 = 0;

2429 
h_cÚŒŞ
->
cÚfig_v4
.
mib_sz
 = 0;

2430 
h_cÚŒŞ
->
cÚfig_v5
.
mib_loc
 = 0;

2431 
h_cÚŒŞ
->
cÚfig_v5
.
mib_sz
 = 0;

2432 
tÙ®_mib_Ën
 = 0;

2433 } ià(
tÙ®_mib_Ën
) {

2434 
	`SLSI_INFO_NODEV
("Lßdšg MIB iÁØsh¬ed memÜy, siz(%d)\n", 
tÙ®_mib_Ën
);

2436 
i
 = 0, 
mib_fe_off£t
 = 0;

2437 
i
 < 
SLSI_WLAN_MAX_MIB_FILE
;

2438 
i
++) {

2439 
	`SLSI_INFO_NODEV
("Lßdšg MIB %d iÁØsh¬ed memÜy, off£ˆ(%d), siz(%d),Ù® (%d)\n", 
i
, 
mib_fe_off£t
, 
sdev
->
mib
[i].
mib_Ën
, 
tÙ®_mib_Ën
);

2440 ià(
sdev
->
mib
[
i
].
mib_Ën
) {

2441 
	`memıy
((
u8
 *)
h_±r
 + 
HIP4_WLAN_MIB_OFFSET
 + 
mib_fe_off£t
, 
sdev
->
mib
[
i
].
mib_d©a
, sdev->mib[i].
mib_Ën
);

2442 
mib_fe_off£t
 +ğ
sdev
->
mib
[
i
].
mib_Ën
;

2445 
h_cÚŒŞ
->
cÚfig_v4
.
mib_loc
 = 
h
->
h_»f
 + 
HIP4_WLAN_MIB_OFFSET
;

2446 
h_cÚŒŞ
->
cÚfig_v4
.
mib_sz
 = 
tÙ®_mib_Ën
;

2447 
h_cÚŒŞ
->
cÚfig_v5
.
mib_loc
 = 
h
->
h_»f
 + 
HIP4_WLAN_MIB_OFFSET
;

2448 
h_cÚŒŞ
->
cÚfig_v5
.
mib_sz
 = 
tÙ®_mib_Ën
;

2450 
h_cÚŒŞ
->
cÚfig_v4
.
mib_loc
 = 0;

2451 
h_cÚŒŞ
->
cÚfig_v4
.
mib_sz
 = 0;

2452 
h_cÚŒŞ
->
cÚfig_v5
.
mib_loc
 = 0;

2453 
h_cÚŒŞ
->
cÚfig_v5
.
mib_sz
 = 0;

2458 
h_cÚŒŞ
->
cÚfig_v4
.
magic_numb”
 = 0xcaba0401;

2459 
h_cÚŒŞ
->
cÚfig_v4
.
h_cÚfig_v”
 = 4;

2460 
h_cÚŒŞ
->
cÚfig_v4
.
cÚfig_Ën
 = (
h4_h_cÚfig_v”siÚ_4
);

2461 
h_cÚŒŞ
->
cÚfig_v4
.
ho¡_ÿche_lše
 = 64;

2462 
h_cÚŒŞ
->
cÚfig_v4
.
ho¡_buf_loc
 = 
h
->
h_»f
 + 
HIP4_WLAN_TX_OFFSET
;

2463 
h_cÚŒŞ
->
cÚfig_v4
.
ho¡_buf_sz
 = 
HIP4_WLAN_TX_SIZE
;

2464 
h_cÚŒŞ
->
cÚfig_v4
.
fw_buf_loc
 = 
h
->
h_»f
 + 
HIP4_WLAN_RX_OFFSET
;

2465 
h_cÚŒŞ
->
cÚfig_v4
.
fw_buf_sz
 = 
HIP4_WLAN_RX_SIZE
;

2466 
h_cÚŒŞ
->
cÚfig_v4
.
log_cÚfig_loc
 = 0;

2468 
h_cÚŒŞ
->
cÚfig_v4
.
mif_fh_št_n
 = 
h
->
h_´iv
->
šŒ_äomho¡
;

2469 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++) {

2470 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2471 
h_cÚŒŞ
->
cÚfig_v4
.
mif_th_št_n
[
i
] = 
h
->
h_´iv
->
šŒ_toho¡_mul
[i];

2473 
h_cÚŒŞ
->
cÚfig_v4
.
mif_th_št_n
[
i
] = 
h
->
h_´iv
->
šŒ_toho¡
;

2477 
h_cÚŒŞ
->
cÚfig_v4
.
scbrd_loc
 = (
u32
)
»f_scÜebßrd
;

2478 
h_cÚŒŞ
->
cÚfig_v4
.
q_num
 = 6;

2479 
h_cÚŒŞ
->
cÚfig_v4
.
q_Ën
 = 256;

2480 
h_cÚŒŞ
->
cÚfig_v4
.
q_idx_sz
 = 1;

2482 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++) {

2483 ià(
	`scsc_mx_£rviû_mif_±r_to_addr
(
£rviû
, &
h_cÚŒŞ
->
q
[
i
].
¬¿y
, &
»f
))

2484  -
EFAULT
;

2485 
h_cÚŒŞ
->
cÚfig_v4
.
q_loc
[
i
] = (
u32
)
»f
;

2491 
h_cÚŒŞ
->
cÚfig_v5
.
magic_numb”
 = 0xcaba0401;

2492 
h_cÚŒŞ
->
cÚfig_v5
.
h_cÚfig_v”
 = 5;

2493 
h_cÚŒŞ
->
cÚfig_v5
.
cÚfig_Ën
 = (
h4_h_cÚfig_v”siÚ_5
);

2494 
h_cÚŒŞ
->
cÚfig_v5
.
ho¡_ÿche_lše
 = 64;

2495 
h_cÚŒŞ
->
cÚfig_v5
.
ho¡_buf_loc
 = 
h
->
h_»f
 + 
HIP4_WLAN_TX_OFFSET
;

2496 
h_cÚŒŞ
->
cÚfig_v5
.
ho¡_buf_sz
 = 
HIP4_WLAN_TX_SIZE
;

2497 
h_cÚŒŞ
->
cÚfig_v5
.
fw_buf_loc
 = 
h
->
h_»f
 + 
HIP4_WLAN_RX_OFFSET
;

2498 
h_cÚŒŞ
->
cÚfig_v5
.
fw_buf_sz
 = 
HIP4_WLAN_RX_SIZE
;

2499 
h_cÚŒŞ
->
cÚfig_v5
.
log_cÚfig_loc
 = 0;

2500 
h_cÚŒŞ
->
cÚfig_v5
.
mif_fh_št_n
 = 
h
->
h_´iv
->
šŒ_äomho¡
;

2501 
h_cÚŒŞ
->
cÚfig_v5
.
mif_th_št_n
 = 
h
->
h_´iv
->
šŒ_toho¡
;

2502 
h_cÚŒŞ
->
cÚfig_v5
.
q_num
 = 6;

2503 
h_cÚŒŞ
->
cÚfig_v5
.
q_Ën
 = 256;

2504 
h_cÚŒŞ
->
cÚfig_v5
.
q_idx_sz
 = 1;

2505 
h_cÚŒŞ
->
cÚfig_v5
.
scbrd_loc
 = (
u32
)
»f_scÜebßrd
;

2508 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++) {

2509 ià(
	`scsc_mx_£rviû_mif_±r_to_addr
(
£rviû
, &
h_cÚŒŞ
->
q
[
i
].
¬¿y
, &
»f
))

2510  -
EFAULT
;

2511 
h_cÚŒŞ
->
cÚfig_v5
.
q_loc
[
i
] = (
u32
)
»f
;

2516 
h_cÚŒŞ
->
š™
.
magic_numb”
 = 0xcaaa0400;

2517 ià(
	`scsc_mx_£rviû_mif_±r_to_addr
(
£rviû
, &
h_cÚŒŞ
->
cÚfig_v4
, &
»f
))

2518  -
EFAULT
;

2519 
h_cÚŒŞ
->
š™
.
v”siÚ_a_»f
 = 
»f
;

2521 ià(
	`scsc_mx_£rviû_mif_±r_to_addr
(
£rviû
, &
h_cÚŒŞ
->
cÚfig_v5
, &
»f
))

2522  -
EFAULT
;

2523 
h_cÚŒŞ
->
š™
.
v”siÚ_b_»f
 = 
»f
;

2526 
h
->
h_cÚŒŞ
 = hip_control;

2527 
h
->
h_´iv
->
scbrd_ba£
 = &
h_cÚŒŞ
->
scÜebßrd
;

2529 
	`¥š_lock_š™
(&
h
->
h_´iv
->
rx_lock
);

2530 
	`©omic_£t
(&
h
->
h_´iv
->
š_rx
, 0);

2531 
	`¥š_lock_š™
(&
h
->
h_´iv
->
tx_lock
);

2532 
	`©omic_£t
(&
h
->
h_´iv
->
š_tx
, 0);

2534 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2535 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 4, 0))

2536 
	`¦si_wake_lock_š™
(
NULL
, &
h
->
h_´iv
->
h4_wake_lock_tx
.
ws
, "hip4_wake_lock_tx");

2537 
	`¦si_wake_lock_š™
(
NULL
, &
h
->
h_´iv
->
h4_wake_lock_ù¾
.
ws
, "hip4_wake_lock_ctrl");

2538 
	`¦si_wake_lock_š™
(
NULL
, &
h
->
h_´iv
->
h4_wake_lock_d©a
.
ws
, "hip4_wake_lock_data");

2540 
	`¦si_wake_lock_š™
(&
h
->
h_´iv
->
h4_wake_lock_tx
, 
WAKE_LOCK_SUSPEND
, "hip4_wake_lock_tx");

2541 
	`¦si_wake_lock_š™
(&
h
->
h_´iv
->
h4_wake_lock_ù¾
, 
WAKE_LOCK_SUSPEND
, "hip4_wake_lock_ctrl");

2542 
	`¦si_wake_lock_š™
(&
h
->
h_´iv
->
h4_wake_lock_d©a
, 
WAKE_LOCK_SUSPEND
, "hip4_wake_lock_data");

2545 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 4, 0))

2546 
	`¦si_wake_lock_š™
(
NULL
, &
h
->
h_´iv
->
h4_wake_lock
.
ws
, "hip4_wake_lock");

2548 
	`¦si_wake_lock_š™
(&
h
->
h_´iv
->
h4_wake_lock
, 
WAKE_LOCK_SUSPEND
, "hip4_wake_lock");

2552 
h
->
h_´iv
->
h4_wÜkq
 = 
	`ü—‹_sšgËth»ad_wÜkqueue
("hip4_work");

2553 ià(!
h
->
h_´iv
->
h4_wÜkq
) {

2554 
	`SLSI_ERR_NODEV
("Error creating singlethread_workqueue\n");

2555  -
ENOMEM
;

2557 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2558 
	`¥š_lock_š™
(&
h
->
h_´iv
->
Çpi_ıu_lock
);

2559 
	`INIT_WORK
(&
h
->
h_´iv
->
šŒ_wq_Çpi_ıu_sw™ch
, 
h4_œq_d©a_Çpi_sw™ch_wÜk
);

2560 
	`INIT_WORK
(&
h
->
h_´iv
->
šŒ_wq_ù¾
, 
h4_wq_ù¾
);

2561 
	`skËt_š™
(&
h
->
h_´iv
->
šŒ__fb
, 
h4__fb
, ()hip);

2563 
	`INIT_WORK
(&
h
->
h_´iv
->
šŒ_wq
, 
h4_wq
);

2565 
	`rwlock_š™
(&
h
->
h_´iv
->
rw_scÜebßrd
);

2568 
	`©omic_£t
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
, 0);

2569 
	`¥š_lock_š™
(&
h
->
h_´iv
->
w©chdog_lock
);

2570 #ià
	`KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


2571 
	`tim”_£tup
(&
h
->
h_´iv
->
w©chdog
, 
h4_w©chdog
, 0);

2573 
	`£tup_tim”
(&
h
->
h_´iv
->
w©chdog
, 
h4_w©chdog
, ()hip);

2576 
	`©omic_£t
(&
h
->
h_´iv
->
gmod
, 
HIP4_DAT_SLOTS
);

2577 
	`©omic_£t
(&
h
->
h_´iv
->
gaùive
, 1);

2578 
	`¥š_lock_š™
(&
h
->
h_´iv
->
gbÙ_lock
);

2579 
h
->
h_´iv
->
§tu¿‹d
 = 0;

2581 #ifdeà
CONFIG_SCSC_SMAPPER


2583 ià(
h4_sm­³r_’abË
) {

2584 ià(
	`h4_sm­³r_š™
(
sdev
, 
h
)) {

2585 
	`SLSI_ERR_NODEV
("Error on hip4_smapper init\n");

2586 
h4_sm­³r_is_’abËd
 = 
çl£
;

2588 
h4_sm­³r_is_’abËd
 = 
Œue
;

2592 #ifdeà
CONFIG_SCSC_QOS


2594 
	`¥š_lock_š™
(&
h
->
h_´iv
->
pm_qos_lock
);

2596 ià(
h4_qos_’abË
) {

2597 ià(!
	`scsc_£rviû_pm_qos_add_»que¡
(
£rviû
, 
SCSC_QOS_DISABLED
)) {

2599 ià(
	`¦si_Œaffic_mÚ_ş›Á_»gi¡”
(
sdev
, 
h
, 
TRAFFIC_MON_CLIENT_MODE_EVENTS
, (
h4_qos_med_ut_š_mbps
 * 1000 * 1000), (
h4_qos_max_ut_š_mbps
 * 1000 * 1000), 
h4_Œaffic_mÚ™Ü_cb
))

2600 
	`SLSI_WARN
(
sdev
, "failedo‡dd PM QoS clientoraffic monitor\n");

2602 
	`INIT_WORK
(&
h
->
h_´iv
->
pm_qos_wÜk
, 
h4_pm_qos_wÜk
);

2604 
	`SLSI_WARN
(
sdev
, "failedo‡dd PM QoS„equest\n");

2608 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOGRING
)

2610 ià(
	`¦si_Œaffic_mÚ_ş›Á_»gi¡”
(
sdev
, 
h
->
h_´iv
, 
TRAFFIC_MON_CLIENT_MODE_EVENTS
, 0, (
h4_dyÇmic_loggšg_ut_š_mbps
 * 1000 * 1000), 
h4_Œaffic_mÚ™Ü_logršg_cb
))

2611 
	`SLSI_WARN
(
sdev
, "failedo‡dd Logring clientoraffic monitor\n");

2614 
	}
}

2620 
	$h4_ä“_ù¾_¦Ùs_couÁ
(
¦si_h4
 *
h
)

2622  
	`mbulk_poŞ_g‘_ä“_couÁ
(
MBULK_POOL_ID_CTRL
);

2623 
	}
}

2635 
	$scsc_wifi_Œªsm™_äame
(
¦si_h4
 *
h
, 
sk_buff
 *
skb
, 
boŞ
 
ù¾_·ck‘
, 
u8
 
vif_šdex
, u8 
³”_šdex
, u8 
´iÜ™y
)

2637 
scsc_£rviû
 *
£rviû
;

2638 
scsc_miäam_»f
 
off£t
;

2639 
mbulk
 *
m
;

2640 
mbulk_cŞour
 
cŞour
 = 0;

2641 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

2642 
çpi_sigÇl_h—d”
 *
çpi_h—d”
;

2643 
»t
 = 0;

2645 ià(!
h
 || !
sdev
 || !sdev->
£rviû
 || !
skb
 || !h->
h_´iv
)

2646  -
EINVAL
;

2648 
	`¥š_lock_bh
(&
h
->
h_´iv
->
tx_lock
);

2649 
	`©omic_£t
(&
h
->
h_´iv
->
š_tx
, 1);

2651 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2652 ià(!
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock_tx
)) {

2653 
	`¦si_wake_lock_timeout
(&
h
->
h_´iv
->
h4_wake_lock_tx
, 
	`m£cs_to_jiff›s
(
SLSI_HIP_WAKELOCK_TIME_OUT_IN_MS
));

2654 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


2655 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_TAKEN
, "h4_wake_lock_tx", 
WL_REASON_TX
);

2659 ià(!
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock
)) {

2660 
	`¦si_wake_lock_timeout
(&
h
->
h_´iv
->
h4_wake_lock
, 
	`m£cs_to_jiff›s
(
SLSI_HIP_WAKELOCK_TIME_OUT_IN_MS
));

2661 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


2662 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_TAKEN
, "h4_wake_lock", 
WL_REASON_TX
);

2667 
£rviû
 = 
sdev
->service;

2668 
çpi_h—d”
 = (
çpi_sigÇl_h—d”
 *)
skb
->
d©a
;

2670 ià(
	`çpi_is_ma
(
skb
))

2671 
	`SLSI_MBULK_COLOUR_SET
(
cŞour
, 
vif_šdex
, 
³”_šdex
, 
´iÜ™y
);

2673 
m
 = 
	`h4_skb_to_mbulk
(
h
->
h_´iv
, 
skb
, 
ù¾_·ck‘
, 
cŞour
);

2674 ià(!
m
) {

2675 
	`SCSC_HIP4_SAMPLER_MFULL
(
h
->
h_´iv
->
mšÜ
);

2676 
»t
 = -
ENOSPC
;

2677 
	`SLSI_ERR_NODEV
("mbulk is NULL\n");

2678 
”rÜ
;

2681 ià(
	`scsc_mx_£rviû_mif_±r_to_addr
(
£rviû
, 
m
, &
off£t
) < 0) {

2682 
	`mbulk_ä“_vœt_ho¡
(
m
);

2683 
»t
 = -
EFAULT
;

2684 
	`SLSI_ERR_NODEV
("Incorrect„eference memory\n");

2685 
”rÜ
;

2688 ià(
	`h4_q_add_sigÇl
(
h
, 
ù¾_·ck‘
 ? 
HIP4_MIF_Q_FH_CTRL
 : 
HIP4_MIF_Q_FH_DAT
, 
off£t
, 
£rviû
)) {

2689 
	`SCSC_HIP4_SAMPLER_QFULL
(
h
->
h_´iv
->
mšÜ
, 
ù¾_·ck‘
 ? 
HIP4_MIF_Q_FH_CTRL
 : 
HIP4_MIF_Q_FH_DAT
);

2690 
	`mbulk_ä“_vœt_ho¡
(
m
);

2691 
»t
 = -
ENOSPC
;

2692 
	`SLSI_ERR_NODEV
("No space\n");

2693 
”rÜ
;

2696 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


2697 ià(
ù¾_·ck‘
) {

2699 
	`SCSC_HIP4_SAMPLER_SIGNAL_CTRLTX
(
h
->
h_´iv
->
mšÜ
, (
çpi_h—d”
->
id
 & 0xff00) >> 8, fapi_header->id & 0xff);

2701 
	`SCSC_HIP4_SAMPLER_PKT_TX_HIP4
(
h
->
h_´iv
->
mšÜ
, 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
ho¡_g
));

2702 
	`SCSC_HIP4_SAMPLER_VIF_PEER
(
h
->
h_´iv
->
mšÜ
, 1, 
vif_šdex
, 
³”_šdex
);

2705 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


2706 
	`h4_hi¡Üy_»cÜd_add
(
FH
, 
çpi_h—d”
->
id
);

2716 ià(
ù¾_·ck‘
)

2717 
	`SCSC_BIN_TAG_DEBUG
(
BIN_WIFI_CTRL_TX
, 
skb
->
d©a
, 
	`skb_h—dËn
(skb));

2719 
	`SCSC_BIN_TAG_DEBUG
(
BIN_WIFI_DATA_TX
, 
skb
->
d©a
, 
	`skb_h—dËn
(skb));

2721 
	`¦si_log_ş›Ás_log_sigÇl_ç¡
(
sdev
, &sdev->
log_ş›Ás
, 
skb
, 
SLSI_LOG_DIRECTION_FROM_HOST
);

2722 
	`cÚsume_skb
(
skb
);

2723 
	`©omic_£t
(&
h
->
h_´iv
->
š_tx
, 0);

2724 
	`¥š_uÆock_bh
(&
h
->
h_´iv
->
tx_lock
);

2727 
”rÜ
:

2728 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2729 ià(
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock_tx
)) {

2730 
	`¦si_wake_uÆock
(&
h
->
h_´iv
->
h4_wake_lock_tx
);

2731 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


2732 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_RELEASED
, "h4_wake_lock_tx", 
WL_REASON_TX
);

2736 ià(
	`¦si_wake_lock_aùive
(&
h
->
h_´iv
->
h4_wake_lock
)) {

2737 
	`¦si_wake_uÆock
(&
h
->
h_´iv
->
h4_wake_lock
);

2738 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


2739 
	`SCSC_WLOG_WAKELOCK
(
WLOG_LAZY
, 
WL_RELEASED
, "h4_wake_lock", 
WL_REASON_TX
);

2743 
	`©omic_£t
(&
h
->
h_´iv
->
š_tx
, 0);

2744 
	`¥š_uÆock_bh
(&
h
->
h_´iv
->
tx_lock
);

2745  
»t
;

2746 
	}
}

2751 
	$h4_£tup
(
¦si_h4
 *
h
)

2753 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

2754 
scsc_£rviû
 *
£rviû
;

2755 
u32
 
cÚf_h4_v”
 = 0;

2757 ià(!
sdev
 || !sdev->
£rviû
)

2758  -
EIO
;

2760 ià(
	`©omic_»ad
(&
sdev
->
h
.
h_¡©e
è!ğ
SLSI_HIP_STATE_STARTED
)

2761  -
EIO
;

2763 
£rviû
 = 
sdev
->service;

2766 
cÚf_h4_v”
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ
(&
h
->
h_cÚŒŞ
->
š™
);

2769 ià(
cÚf_h4_v”
 != 4 && conf_hip4_ver != 5) {

2770 
	`SLSI_ERR_NODEV
("FW HIP cÚfig v”siÚ %d‚Ù suµÜ‹d\n", 
cÚf_h4_v”
);

2771  -
EIO
;

2774 ià(
cÚf_h4_v”
 == 4) {

2775 
h
->
h_´iv
->
unid©_»q_h—droom
 =

2776 
	`scsc_wifi_g‘_h_cÚfig_u8
(&
h
->
h_cÚŒŞ
, 
unid©_»q_h—droom
, 4);

2777 
h
->
h_´iv
->
unid©_»q_room
 =

2778 
	`scsc_wifi_g‘_h_cÚfig_u8
(&
h
->
h_cÚŒŞ
, 
unid©_»q_room
, 4);

2779 
h
->
h_´iv
->
v”siÚ
 = 4;

2781 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2782 
h
->
h_´iv
->
Çpi_rx_fuÎ_út
 = 0;

2783 
h
->
h_´iv
->
Çpi_rx_§tu¿‹d
 = 0;

2784 ià(!
	`‹¡_ªd_£t_b™
(
SLSI_HIP_NAPI_STATE_ENABLED
, &
h
->
h_´iv
->
Çpi_¡©e
))

2785 
	`Çpi_’abË
(&
h
->
h_´iv
->
Çpi
);

2789 
h
->
h_´iv
->
unid©_»q_h—droom
 =

2790 
	`scsc_wifi_g‘_h_cÚfig_u8
(&
h
->
h_cÚŒŞ
, 
unid©_»q_h—droom
, 5);

2791 
h
->
h_´iv
->
unid©_»q_room
 =

2792 
	`scsc_wifi_g‘_h_cÚfig_u8
(&
h
->
h_cÚŒŞ
, 
unid©_»q_room
, 5);

2793 
h
->
h_´iv
->
v”siÚ
 = 5;

2796 
	`©omic_£t
(&
h
->
h_´iv
->
¡©s
.
œqs
, 0);

2797 
	`©omic_£t
(&
h
->
h_´iv
->
¡©s
.
¥urious_œqs
, 0);

2798 
	`©omic_£t
(&
sdev
->
debug_šds
, 0);

2800 
	`©omic_£t
(&
h
->
h_´iv
->
şosšg
, 0);

2802 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2803 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_FH_RFB
]);

2804 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_CTRL
]);

2805 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
]);

2807 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

2810 
	}
}

2813 
	$h4_su¥’d
(
¦si_h4
 *
h
)

2815 
¦si_dev
 *
sdev
;

2816 
scsc_£rviû
 *
£rviû
;

2817 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2818 
u8
 
i
;

2821 ià(!
h
 || !h->
h_´iv
)

2824 
sdev
 = 
	`cÚš”_of
(
h
, 
¦si_dev
, 
h4_š¡
);

2825 ià(!
sdev
 || !sdev->
£rviû
)

2828 ià(
	`©omic_»ad
(&
sdev
->
h
.
h_¡©e
è!ğ
SLSI_HIP_STATE_STARTED
)

2831 
£rviû
 = 
sdev
->service;

2833 
	`¦si_log_ş›Á_msg
(
sdev
, 
UDI_DRV_SUSPEND_IND
, 0, 
NULL
);

2834 
	`SCSC_HIP4_SAMPLER_SUSPEND
(
h
->
h_´iv
->
mšÜ
);

2836 
	`©omic_£t
(&
h
->
h_´iv
->
š_su¥’d
, 1);

2838 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2839 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++)

2840 ià(
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
] !ğ
MIF_NO_IRQ
)

2841 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
]);

2843 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

2845 
	}
}

2847 
	$h4_»sume
(
¦si_h4
 *
h
)

2849 
¦si_dev
 *
sdev
;

2850 
scsc_£rviû
 *
£rviû
;

2851 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2852 
u8
 
i
;

2855 ià(!
h
 || !h->
h_´iv
)

2858 
sdev
 = 
	`cÚš”_of
(
h
, 
¦si_dev
, 
h4_š¡
);

2859 ià(!
sdev
 || !sdev->
£rviû
)

2862 ià(
	`©omic_»ad
(&
sdev
->
h
.
h_¡©e
è!ğ
SLSI_HIP_STATE_STARTED
)

2865 
£rviû
 = 
sdev
->service;

2867 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2868 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++)

2869 ià(
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
] !ğ
MIF_NO_IRQ
)

2870 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
]);

2872 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

2874 
	`¦si_log_ş›Á_msg
(
sdev
, 
UDI_DRV_RESUME_IND
, 0, 
NULL
);

2875 
	`SCSC_HIP4_SAMPLER_RESUME
(
h
->
h_´iv
->
mšÜ
);

2876 
	`©omic_£t
(&
h
->
h_´iv
->
š_su¥’d
, 0);

2877 
	}
}

2879 
	$h4_ä“ze
(
¦si_h4
 *
h
)

2881 
¦si_dev
 *
sdev
;

2882 
scsc_£rviû
 *
£rviû
;

2883 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2884 
u8
 
i
;

2887 ià(!
h
 || !h->
h_´iv
)

2890 
sdev
 = 
	`cÚš”_of
(
h
, 
¦si_dev
, 
h4_š¡
);

2891 ià(!
sdev
 || !sdev->
£rviû
)

2894 ià(
	`©omic_»ad
(&
sdev
->
h
.
h_¡©e
è!ğ
SLSI_HIP_STATE_STARTED
)

2897 
£rviû
 = 
sdev
->service;

2899 
şosšg
 = 
	`ktime_g‘
();

2900 
	`©omic_£t
(&
h
->
h_´iv
->
şosšg
, 1);

2902 
	`h4_dump_dbg
(
h
, 
NULL
, NULL, 
£rviû
);

2903 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2904 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++)

2905 ià(
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
] !ğ
MIF_NO_IRQ
)

2906 
	`scsc_£rviû_mifšŒb™_b™_mask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
]);

2908 ià(
	`‹¡_ªd_ş—r_b™
(
SLSI_HIP_NAPI_STATE_ENABLED
, &
h
->
h_´iv
->
Çpi_¡©e
))

2909 
	`Çpi_di§bË
(&
h
->
h_´iv
->
Çpi
);

2910 
h
->
h_´iv
->
Çpi_rx_fuÎ_út
 = 0;

2911 
h
->
h_´iv
->
Çpi_rx_§tu¿‹d
 = 0;

2912 
	`ÿnûl_wÜk_sync
(&
h
->
h_´iv
->
šŒ_wq_Çpi_ıu_sw™ch
);

2913 
	`ÿnûl_wÜk_sync
(&
h
->
h_´iv
->
šŒ_wq_ù¾
);

2914 
	`skËt_kl
(&
h
->
h_´iv
->
šŒ__fb
);

2916 
	`scsc_£rviû_mifšŒb™_b™_mask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

2917 
	`ÿnûl_wÜk_sync
(&
h
->
h_´iv
->
šŒ_wq
);

2919 
	`æush_wÜkqueue
(
h
->
h_´iv
->
h4_wÜkq
);

2920 
	`de¡roy_wÜkqueue
(
h
->
h_´iv
->
h4_wÜkq
);

2921 
	`©omic_£t
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
, 0);

2924 
	`d–_tim”_sync
(&
h
->
h_´iv
->
w©chdog
);

2925 
	}
}

2927 
	$h4_deš™
(
¦si_h4
 *
h
)

2929 
¦si_dev
 *
sdev
;

2930 
scsc_£rviû
 *
£rviû
;

2931 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2932 
u8
 
i
;

2935 ià(!
h
 || !h->
h_´iv
)

2938 
sdev
 = 
	`cÚš”_of
(
h
, 
¦si_dev
, 
h4_š¡
);

2939 ià(!
sdev
 || !sdev->
£rviû
)

2942 
£rviû
 = 
sdev
->service;

2944 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOGRING
)

2945 
	`¦si_Œaffic_mÚ_ş›Á_uÄegi¡”
(
sdev
, 
h
->
h_´iv
);

2947 
	`scsc_logršg_’abË
(
Œue
);

2949 #ifdeà
CONFIG_SCSC_QOS


2951 
	`¦si_Œaffic_mÚ_ş›Á_uÄegi¡”
(
sdev
, 
h
);

2952 
	`scsc_£rviû_pm_qos_»move_»que¡
(
£rviû
);

2955 #ifdeà
CONFIG_SCSC_SMAPPER


2957 ià(
h4_sm­³r_is_’abËd
) {

2958 
h4_sm­³r_is_’abËd
 = 
çl£
;

2959 
	`h4_sm­³r_deš™
(
sdev
, 
h
);

2963 
şosšg
 = 
	`ktime_g‘
();

2964 
	`©omic_£t
(&
h
->
h_´iv
->
şosšg
, 1);

2966 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2967 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++)

2968 ià(
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
] !ğ
MIF_NO_IRQ
)

2969 
	`scsc_£rviû_mifšŒb™_b™_mask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
]);

2971 ià(
	`‹¡_ªd_ş—r_b™
(
SLSI_HIP_NAPI_STATE_ENABLED
, &
h
->
h_´iv
->
Çpi_¡©e
))

2972 
	`Çpi_di§bË
(&
h
->
h_´iv
->
Çpi
);

2973 
h
->
h_´iv
->
Çpi_rx_fuÎ_út
 = 0;

2974 
h
->
h_´iv
->
Çpi_rx_§tu¿‹d
 = 0;

2975 
	`ÿnûl_wÜk_sync
(&
h
->
h_´iv
->
šŒ_wq_Çpi_ıu_sw™ch
);

2976 
	`ÿnûl_wÜk_sync
(&
h
->
h_´iv
->
šŒ_wq_ù¾
);

2977 
	`skËt_kl
(&
h
->
h_´iv
->
šŒ__fb
);

2979 
i
 = 0; i < 
MIF_HIP_CFG_Q_NUM
; i++)

2980 ià(
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
] !ğ
MIF_NO_IRQ
)

2981 
	`scsc_£rviû_mifšŒb™_uÄegi¡”_toho¡
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
i
]);

2983 
	`Ãtif_Çpi_d–
(&
h
->
h_´iv
->
Çpi
);

2985 
	`scsc_£rviû_mifšŒb™_b™_mask
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

2986 
	`ÿnûl_wÜk_sync
(&
h
->
h_´iv
->
šŒ_wq
);

2987 
	`scsc_£rviû_mifšŒb™_uÄegi¡”_toho¡
(
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡
);

2989 
	`æush_wÜkqueue
(
h
->
h_´iv
->
h4_wÜkq
);

2990 
	`de¡roy_wÜkqueue
(
h
->
h_´iv
->
h4_wÜkq
);

2992 
	`scsc_£rviû_mifšŒb™_ä“_äomho¡
(
£rviû
, 
h
->
h_´iv
->
šŒ_äomho¡
, 
SCSC_MIFINTR_TARGET_R4
);

2994 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


2995 
	`¦si_wake_lock_de¡roy
(&
h
->
h_´iv
->
h4_wake_lock_tx
);

2996 
	`¦si_wake_lock_de¡roy
(&
h
->
h_´iv
->
h4_wake_lock_ù¾
);

2997 
	`¦si_wake_lock_de¡roy
(&
h
->
h_´iv
->
h4_wake_lock_d©a
);

2999 
	`¦si_wake_lock_de¡roy
(&
h
->
h_´iv
->
h4_wake_lock
);

3002 
	`WARN_ON
(
	`©omic_»ad
(&
h
->
h_´iv
->
š_tx
));

3003 
	`WARN_ON
(
	`©omic_»ad
(&
h
->
h_´iv
->
š_rx
));

3005 
	`©omic_£t
(&
h
->
h_´iv
->
w©chdog_tim”_aùive
, 0);

3007 
	`d–_tim”_sync
(&
h
->
h_´iv
->
w©chdog
);

3009 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


3010 ià(
h
->
h_´iv
->
¡©s
.
´ocfs_dœ
) {

3011 
	`»move_´oc_’Œy
("driv”/h4/j™‹r", 
NULL
);

3012 
	`»move_´oc_’Œy
("driv”/h4/šfo", 
NULL
);

3013 
	`»move_´oc_’Œy
("driv”/h4/hi¡Üy", 
NULL
);

3014 
	`»move_´oc_’Œy
("driv”/h4", 
NULL
);

3018 
	`¥š_lock_bh
(&
š_Çpi_cÚ‹xt
);

3019 
	`kä“
(
h
->
h_´iv
);

3021 
h
->
h_´iv
 = 
NULL
;

3022 
	`¥š_uÆock_bh
(&
š_Çpi_cÚ‹xt
);

3025 
	`mbulk_poŞ_»move
(
MBULK_POOL_ID_DATA
);

3026 
	`mbulk_poŞ_»move
(
MBULK_POOL_ID_CTRL
);

3027 
	}
}

	@hip4.h

7 #iâdeà
__HIP4_H__


8 
	#__HIP4_H__


	)

18 
	~<lšux/š‹¼u±.h
>

19 
	~<lšux/ty³s.h
>

20 
	~<lšux/deviû.h
>

21 
	~<lšux/skbuff.h
>

22 
	~<scsc/scsc_miäam.h
>

23 
	~<scsc/scsc_mx.h
>

24 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


25 
	~<lšux/Ãtdeviû.h
>

27 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


28 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 4, 0))

29 
	~<scsc/scsc_wak–ock.h
>

31 
	~<lšux/wak–ock.h
>

34 
	~"mbulk.h
"

35 #ifdeà
CONFIG_SCSC_SMAPPER


36 
	~"h4_sm­³r.h
"

56 
	#HIP4_WLAN_CONFIG_OFFSET
 0x00000

	)

57 
	#HIP4_WLAN_CONFIG_SIZE
 0x02000

	)

59 
	#HIP4_WLAN_MIB_OFFSET
 (
HIP4_WLAN_CONFIG_OFFSET
 + 
HIP4_WLAN_CONFIG_SIZE
)

	)

60 
	#HIP4_WLAN_MIB_SIZE
 0x08000

	)

62 
	#HIP4_WLAN_TX_OFFSET
 (
HIP4_WLAN_MIB_OFFSET
 + 
HIP4_WLAN_MIB_SIZE
)

	)

64 
	#HIP4_WLAN_TX_DAT_OFFSET
 
HIP4_WLAN_TX_OFFSET


	)

65 
	#HIP4_WLAN_TX_DAT_SIZE
 0x100000

	)

67 
	#HIP4_WLAN_TX_CTL_OFFSET
 (
HIP4_WLAN_TX_DAT_OFFSET
 + 
HIP4_WLAN_TX_DAT_SIZE
)

	)

68 
	#HIP4_WLAN_TX_CTL_SIZE
 0x10000

	)

69 
	#HIP4_WLAN_TX_SIZE
 (
HIP4_WLAN_TX_DAT_SIZE
 + 
HIP4_WLAN_TX_CTL_SIZE
)

	)

71 
	#HIP4_WLAN_RX_OFFSET
 (
HIP4_WLAN_TX_CTL_OFFSET
 + 
HIP4_WLAN_TX_CTL_SIZE
)

	)

72 #ifdeà
CONFIG_SCSC_PCIE


73 
	#HIP4_WLAN_RX_SIZE
 0x80000

	)

75 
	#HIP4_WLAN_RX_SIZE
 0x100000

	)

78 
	#HIP4_WLAN_TOTAL_MEM
 (
HIP4_WLAN_CONFIG_SIZE
 + 
HIP4_WLAN_MIB_SIZE
 + \

79 
HIP4_WLAN_TX_SIZE
 + 
HIP4_WLAN_RX_SIZE
è

	)

81 
	#HIP4_POLLING_MAX_PACKETS
 512

	)

83 
	#HIP4_DAT_MBULK_SIZE
 (2 * 1024)

	)

84 
	#HIP4_DAT_SLOTS
 (
HIP4_WLAN_TX_DAT_SIZE
 / 
HIP4_DAT_MBULK_SIZE
)

	)

85 
	#HIP4_CTL_MBULK_SIZE
 (2 * 1024)

	)

86 
	#HIP4_CTL_SLOTS
 (
HIP4_WLAN_TX_CTL_SIZE
 / 
HIP4_CTL_MBULK_SIZE
)

	)

88 
	#MIF_HIP_CFG_Q_NUM
 6

	)

90 
	#MIF_NO_IRQ
 0xff

	)

93 
	#HIP4_SUPPORTED_V1
 3

	)

94 
	#HIP4_SUPPORTED_V2
 4

	)

96 
	eh4_h_q_cÚf
 {

97 
	mHIP4_MIF_Q_FH_CTRL
,

98 
	mHIP4_MIF_Q_FH_DAT
,

99 
	mHIP4_MIF_Q_FH_RFB
,

100 
	mHIP4_MIF_Q_TH_CTRL
,

101 
	mHIP4_MIF_Q_TH_DAT
,

102 
	mHIP4_MIF_Q_TH_RFB


105 
	sh4_h_cÚfig_v”siÚ_4
 {

107 
u32
 
	mmagic_numb”
;

108 
u16
 
	mh_cÚfig_v”
;

109 
u16
 
	mcÚfig_Ën
;

112 
u32
 
	mcom·t_æag
;

114 
u16
 
	m§p_mlme_v”
;

115 
u16
 
	m§p_ma_v”
;

116 
u16
 
	m§p_debug_v”
;

117 
u16
 
	m§p_‹¡_v”
;

119 
u32
 
	mfw_bud_id
;

120 
u32
 
	mfw_·tch_id
;

122 
u8
 
	munid©_»q_h—droom
;

123 
u8
 
	munid©_»q_room
;

124 
u8
 
	mbulk_bufãr_®ign
;

127 
u8
 
	mho¡_ÿche_lše
;

129 
u32
 
	mho¡_buf_loc
;

130 
u32
 
	mho¡_buf_sz
;

131 
u32
 
	mfw_buf_loc
;

132 
u32
 
	mfw_buf_sz
;

133 
u32
 
	mmib_loc
;

134 
u32
 
	mmib_sz
;

135 
u32
 
	mlog_cÚfig_loc
;

136 
u32
 
	mlog_cÚfig_sz
;

138 
u8
 
	mmif_fh_št_n
;

139 
u8
 
	m»£rved1
[3];

141 
u8
 
	mmif_th_št_n
[6];

142 
u8
 
	m»£rved2
[2];

144 
u32
 
	mscbrd_loc
;

146 
u16
 
	mq_num
;

147 
u16
 
	mq_Ën
;

148 
u16
 
	mq_idx_sz
;

149 
u8
 
	m»£rved3
[2];

151 
u32
 
	mq_loc
[
MIF_HIP_CFG_Q_NUM
];

153 #ifdeà
CONFIG_SCSC_SMAPPER


154 
u8
 
	msm­³r_th_»q
;

155 
u8
 
	msm­³r_fh_šd
;

156 
u8
 
	msm­³r_mbox_scb
;

157 
u8
 
	msm­³r_’Œ›s_bªks
[16];

158 
u8
 
	msm­³r_pow_sz
[16];

159 
u32
 
	msm­³r_bªk_addr
[16];

161 
u8
 
	m»£rved_nosm­³r
[99];

163 
u8
 
	m»£rved4
[16];

164 } 
	g__·cked
;

166 
	sh4_h_cÚfig_v”siÚ_5
 {

168 
u32
 
	mmagic_numb”
;

169 
u16
 
	mh_cÚfig_v”
;

170 
u16
 
	mcÚfig_Ën
;

173 
u32
 
	mcom·t_æag
;

175 
u16
 
	m§p_mlme_v”
;

176 
u16
 
	m§p_ma_v”
;

177 
u16
 
	m§p_debug_v”
;

178 
u16
 
	m§p_‹¡_v”
;

180 
u32
 
	mfw_bud_id
;

181 
u32
 
	mfw_·tch_id
;

183 
u8
 
	munid©_»q_h—droom
;

184 
u8
 
	munid©_»q_room
;

185 
u8
 
	mbulk_bufãr_®ign
;

188 
u8
 
	mho¡_ÿche_lše
;

190 
u32
 
	mho¡_buf_loc
;

191 
u32
 
	mho¡_buf_sz
;

192 
u32
 
	mfw_buf_loc
;

193 
u32
 
	mfw_buf_sz
;

194 
u32
 
	mmib_loc
;

195 
u32
 
	mmib_sz
;

196 
u32
 
	mlog_cÚfig_loc
;

197 
u32
 
	mlog_cÚfig_sz
;

199 
u8
 
	mmif_fh_št_n
;

200 
u8
 
	mmif_th_št_n
;

201 
u8
 
	m»£rved
[2];

203 
u32
 
	mscbrd_loc
;

205 
u16
 
	mq_num
;

206 
u16
 
	mq_Ën
;

207 
u16
 
	mq_idx_sz
;

208 
u8
 
	m»£rved2
[2];

210 
u32
 
	mq_loc
[
MIF_HIP_CFG_Q_NUM
];

212 
u8
 
	m»£rved3
[16];

213 } 
	g__·cked
;

215 
	sh4_h_š™
 {

217 
u32
 
	mmagic_numb”
;

219 
u32
 
	mcÚf_h4_v”
;

221 
u32
 
	mv”siÚ_a_»f
;

222 
u32
 
	mv”siÚ_b_»f
;

223 } 
	g__·cked
;

225 
	#MAX_NUM
 256

	)

226 
	sh4_h_q
 {

227 
u32
 
	m¬¿y
[
MAX_NUM
];

228 
u8
 
	midx_»ad
;

229 
u8
 
	midx_wr™e
;

230 
u8
 
	mtÙ®
;

231 } 
__®igÃd
(64);

233 
	sh4_h_cÚŒŞ
 {

234 
h4_h_š™
 
	mš™
;

235 
h4_h_cÚfig_v”siÚ_5
 
cÚfig_v5
 
__®igÃd
(32);

236 
h4_h_cÚfig_v”siÚ_4
 
cÚfig_v4
 
__®igÃd
(32);

237 
u32
 
	mscÜebßrd
[256] 
__®igÃd
(64);

238 
h4_h_q
 
	mq
[
MIF_HIP_CFG_Q_NUM
] 
__®igÃd
(64);

239 } 
__®igÃd
(4096);

241 
	g¦si_h4
;

244 
	sh4_´iv
 {

245 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


247 
¥šlock_t
 
	mÇpi_ıu_lock
;

248 
wÜk_¡ruù
 
	mšŒ_wq_Çpi_ıu_sw™ch
;

249 
wÜk_¡ruù
 
	mšŒ_wq_ù¾
;

250 
skËt_¡ruù
 
	mšŒ__fb
;

251 
Çpi_¡ruù
 
	mÇpi
;

252 
	mÇpi_¡©e
;

253 
boŞ
 
	mÇpi_³rf_mode
;

254 
u8
 
	mÇpi_rx_fuÎ_út
;

255 
u8
 
	mÇpi_rx_§tu¿‹d
;

257 
wÜk_¡ruù
 
	mšŒ_wq
;

261 
u32
 
	mšŒ_toho¡
;

264 
u32
 
	mšŒ_toho¡_mul
[
MIF_HIP_CFG_Q_NUM
];

266 
u32
 
	mšŒ_äomho¡
;

269 
¦si_h4
 *
	mh
;

272 
u8
 
	mho¡_poŞ_id_d©
;

274 
u8
 
	mho¡_poŞ_id_ùl
;

277 
¥šlock_t
 
	mrx_lock
;

279 
¥šlock_t
 
	mtx_lock
;

282 
rwlock_t
 
	mrw_scÜebßrd
;

285 
tim”_li¡
 
	mw©chdog
;

287 
¥šlock_t
 
	mw©chdog_lock
;

289 
©omic_t
 
	mw©chdog_tim”_aùive
;

290 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


291 
DECLARE_BITMAP
(
œq_b™m­
, 
MIF_HIP_CFG_Q_NUM
);

294 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


295 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


296 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 4, 0))

297 
scsc_wake_lock
 
	mh4_wake_lock_tx
;

298 
scsc_wake_lock
 
	mh4_wake_lock_ù¾
;

299 
scsc_wake_lock
 
	mh4_wake_lock_d©a
;

302 
wake_lock
 
	mh4_wake_lock_tx
;

303 
wake_lock
 
	mh4_wake_lock_ù¾
;

304 
wake_lock
 
	mh4_wake_lock_d©a
;

308 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 4, 0))

309 
scsc_wake_lock
 
	mh4_wake_lock
;

311 
wake_lock
 
	mh4_wake_lock
;

316 
©omic_t
 
	mşosšg
;

317 
©omic_t
 
	mš_tx
;

318 
©omic_t
 
	mš_rx
;

319 
©omic_t
 
	mš_su¥’d
;

320 
u32
 
	m¡Üm_couÁ
;

323 
©omic_t
 
	mœqs
;

324 
©omic_t
 
	m¥urious_œqs
;

325 
u32
 
	mq_num_äames
[
MIF_HIP_CFG_Q_NUM
];

326 
ktime_t
 
	m¡¬t
;

327 
´oc_dœ_’Œy
 *
	m´ocfs_dœ
;

328 } 
	m¡©s
;

330 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


332 
u32
 
	mmšÜ
;

334 
u8
 
	munid©_»q_h—droom
;

335 
u8
 
	munid©_»q_room
;

336 
u32
 
	mv”siÚ
;

337 *
	mscbrd_ba£
;

340 
©omic_t
 
	mgaùive
;

341 
©omic_t
 
	mgmod
;

342 
©omic_t
 
	mgcod
;

343 
	m§tu¿‹d
;

344 
	mgu¬d
;

346 
¥šlock_t
 
	mgbÙ_lock
;

348 #ifdeà
CONFIG_SCSC_SMAPPER


355 
h4_sm­³r_bªk
 
	msm­³r_bªks
[
HIP4_SMAPPER_TOTAL_BANKS
];

356 
h4_sm­³r_cÚŒŞ
 
	msm­³r_cÚŒŞ
;

358 #ifdeà
CONFIG_SCSC_QOS


360 
wÜk_¡ruù
 
	mpm_qos_wÜk
;

362 
¥šlock_t
 
	mpm_qos_lock
;

363 
u8
 
	mpm_qos_¡©e
;

366 *
	mmib_cŞËù
;

367 
u16
 
	mmib_sz
;

369 
mu‹x
 
	mš_cŞËùiÚ
;

371 
wÜkqueue_¡ruù
 *
	mh4_wÜkq
;

374 
	gscsc_£rviû
;

376 
	s¦si_h4
 {

377 
h4_´iv
 *
	mh_´iv
;

378 
h4_h_cÚŒŞ
 *
	mh_cÚŒŞ
;

379 
scsc_miäam_»f
 
	mh_»f
;

383 
h4_š™
(
¦si_h4
 *
h
);

384 
h4_£tup
(
¦si_h4
 *
h
);

385 
h4_su¥’d
(
¦si_h4
 *
h
);

386 
h4_»sume
(
¦si_h4
 *
h
);

387 
h4_ä“ze
(
¦si_h4
 *
h
);

388 
h4_deš™
(
¦si_h4
 *
h
);

389 
h4_ä“_ù¾_¦Ùs_couÁ
(
¦si_h4
 *
h
);

390 
h4_£t_Çpi_ıu
(
¦si_h4
 *
h
, 
u8
 
Çpi_ıu
, 
boŞ
 
³rf_mode
);

391 
scsc_wifi_Œªsm™_äame
(
¦si_h4
 *
h
, 
sk_buff
 *
skb
, 
boŞ
 
ù¾_·ck‘
, 
u8
 
vif_šdex
, u8 
³”_šdex
, u8 
´iÜ™y
);

392 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


393 
h4_sched_wq_ù¾
(
¦si_h4
 *
h
);

395 
h4_sched_wq
(
¦si_h4
 *
h
);

399 
	#scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u8
(
buff_±r
, 
memb”
è
	`Ë16_to_ıu
((((
h4_h_cÚfig_v”siÚ_4
 *)(buff_±r))->memb”))

	)

400 
	#scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(
buff_±r
, 
memb”
è
	`Ë16_to_ıu
((((
h4_h_cÚfig_v”siÚ_4
 *)(buff_±r))->memb”))

	)

401 
	#scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u32
(
buff_±r
, 
memb”
è
	`Ë32_to_ıu
((((
h4_h_cÚfig_v”siÚ_4
 *)(buff_±r))->memb”))

	)

402 
	#scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u8
(
buff_±r
, 
memb”
è
	`Ë16_to_ıu
((((
h4_h_cÚfig_v”siÚ_5
 *)(buff_±r))->memb”))

	)

403 
	#scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(
buff_±r
, 
memb”
è
	`Ë16_to_ıu
((((
h4_h_cÚfig_v”siÚ_5
 *)(buff_±r))->memb”))

	)

404 
	#scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u32
(
buff_±r
, 
memb”
è
	`Ë32_to_ıu
((((
h4_h_cÚfig_v”siÚ_5
 *)(buff_±r))->memb”))

	)

405 
	#scsc_wifi_g‘_h_cÚfig_u8
(
buff_±r
, 
memb”
, 
v”
è
	`Ë16_to_ıu
((((
h4_h_cÚfig_v”siÚ_
##v” *)(buff_±r->
cÚfig_v
##v”))->memb”))

	)

406 
	#scsc_wifi_g‘_h_cÚfig_u16
(
buff_±r
, 
memb”
, 
v”
è
	`Ë16_to_ıu
((((
h4_h_cÚfig_v”siÚ_
##v” *)(buff_±r->
cÚfig_v
##v”))->memb”))

	)

407 
	#scsc_wifi_g‘_h_cÚfig_u32
(
buff_±r
, 
memb”
, 
v”
è
	`Ë32_to_ıu
((((
h4_h_cÚfig_v”siÚ_
##v” *)(buff_±r->
cÚfig_v
##v”))->memb”))

	)

408 
	#scsc_wifi_g‘_h_cÚfig_v”siÚ
(
buff_±r
è
	`Ë32_to_ıu
((((
h4_h_š™
 *)(buff_±r))->
cÚf_h4_v”
))

	)

	@hip4_sampler.c

6 
	~<lšux/moduË.h
>

7 
	~<lšux/moduË·¿m.h
>

8 
	~<lšux/š™.h
>

9 
	~<lšux/kfifo.h
>

10 
	~<lšux/pŞl.h
>

11 
	~<lšux/wa™.h
>

12 
	~<lšux/sched.h
>

13 
	~<lšux/k”Ãl.h
>

14 
	~<lšux/¦ab.h
>

15 
	~<lšux/fs.h
>

16 
	~<lšux/”ºo.h
>

17 
	~<lšux/ty³s.h
>

18 
	~<lšux/mm.h
>

19 
	~<lšux/v”siÚ.h
>

20 
	~<lšux/h¬dœq.h
>

21 
	~<lšux/ıuäeq.h
>

23 
	~<lšux/ktime.h
>

24 
	~<lšux/h¹im”.h
>

25 
	~<asm/·ge.h
>

26 
	~<lšux/cdev.h
>

27 
	~<lšux/deviû.h
>

28 
	~<scsc/scsc_mx.h
>

29 #ià
IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

30 
	~<scsc/scsc_log_cŞËùÜ.h
>

32 
	~<lšux/d–ay.h
>

33 
	~<lšux/mu‹x.h
>

34 
	~"h4_§m¶”.h
"

36 
	~"debug.h
"

38 
	sh4_»cÜd
 {

39 
u32
 
	m»cÜd_num
;

40 
ktime_t
 
	mts
;

41 
u32
 
	m»cÜd
;

42 
u32
 
	m»cÜd2
;

43 } 
	g__·cked
;

45 
©omic_t
 
	gš_»ad
;

49 
DEFINE_SPINLOCK
(
g_¥šlock
);

51 
boŞ
 
	gh4_§m¶”_’abË
 = 
Œue
;

52 
moduË_·¿m
(
h4_§m¶”_’abË
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

53 
MODULE_PARM_DESC
(
h4_§m¶”_’abË
, "Enable hip4_sampler_enable. Run-time option - (default: Y)");

55 
boŞ
 
	gh4_§m¶”_dyÇmic
 = 
Œue
;

56 
moduË_·¿m
(
h4_§m¶”_dyÇmic
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

57 
MODULE_PARM_DESC
(
h4_§m¶”_dyÇmic
, "Enable hip4_sampler dynamic‡daptation based on TPUT. Run-time option - (default: Y)");

59 
	gh4_§m¶”_kfifo_Ën
 = 128 * 1024;

60 
moduË_·¿m
(
h4_§m¶”_kfifo_Ën
, , 
S_IRUGO
 | 
S_IWUSR
);

61 
MODULE_PARM_DESC
(
h4_§m¶”_kfifo_Ën
, "Streaming fifo buffer†ength in‚um of„ecords- default: 262144 Max: 262144. Loaded‡t /dev open");

63 
	gh4_§m¶”_¡©ic_kfifo_Ën
 = 128 * 1024;

64 
moduË_·¿m
(
h4_§m¶”_¡©ic_kfifo_Ën
, , 
S_IRUGO
 | 
S_IWUSR
);

65 
MODULE_PARM_DESC
(
h4_§m¶”_¡©ic_kfifo_Ën
, "Offline fifo buffer†ength in‚um of„ecords- default: 262144 Max: 262144. Loaded‡t /dev open");

67 
boŞ
 
	gh4_§m¶”_§m¶e_q
 = 
Œue
;

68 
moduË_·¿m
(
h4_§m¶”_§m¶e_q
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

69 
MODULE_PARM_DESC
(
h4_§m¶”_§m¶e_q
, "Sample Queues. Default: Y. Runime option");

71 
boŞ
 
	gh4_§m¶”_§m¶e_q»f
 = 
Œue
;

72 
moduË_·¿m
(
h4_§m¶”_§m¶e_q»f
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

73 
MODULE_PARM_DESC
(
h4_§m¶”_§m¶e_q»f
, "Sample Queue References. Default: Y. Runime option");

75 
boŞ
 
	gh4_§m¶”_§m¶e_št
 = 
Œue
;

76 
moduË_·¿m
(
h4_§m¶”_§m¶e_št
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

77 
MODULE_PARM_DESC
(
h4_§m¶”_§m¶e_št
, "Sample WQ/Tasklet Intr BH in/out. Default: Y. Runime option");

79 
boŞ
 
	gh4_§m¶”_§m¶e_çpi
 = 
Œue
;

80 
moduË_·¿m
(
h4_§m¶”_§m¶e_çpi
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

81 
MODULE_PARM_DESC
(
h4_§m¶”_§m¶e_çpi
, "Sample FAPI ctrl signals. Default: Y. Runime option");

83 
boŞ
 
	gh4_§m¶”_§m¶e_through
 = 
Œue
;

84 
moduË_·¿m
(
h4_§m¶”_§m¶e_through
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

85 
MODULE_PARM_DESC
(
h4_§m¶”_§m¶e_through
, "Samplehroughput. Default: Y. Runime option");

87 
boŞ
 
	gh4_§m¶”_§m¶e_tı
 = 
Œue
;

88 
moduË_·¿m
(
h4_§m¶”_§m¶e_tı
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

89 
MODULE_PARM_DESC
(
h4_§m¶”_§m¶e_tı
, "Sample TCP streams. Default: Y. Runime option");

91 
boŞ
 
	gh4_§m¶”_§m¶e_¡¬t_¡İ_q
 = 
Œue
;

92 
moduË_·¿m
(
h4_§m¶”_§m¶e_¡¬t_¡İ_q
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

93 
MODULE_PARM_DESC
(
h4_§m¶”_§m¶e_¡¬t_¡İ_q
, "Sample Stop/Start queues. Default: Y. Runime option");

95 
boŞ
 
	gh4_§m¶”_§m¶e_mbulk
 = 
Œue
;

96 
moduË_·¿m
(
h4_§m¶”_§m¶e_mbulk
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

97 
MODULE_PARM_DESC
(
h4_§m¶”_§m¶e_mbulk
, "Sample Mbulk counter. Default: Y. Runime option");

99 
boŞ
 
	gh4_§m¶”_§m¶e_qfuÎ
;

100 
moduË_·¿m
(
h4_§m¶”_§m¶e_qfuÎ
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

101 
MODULE_PARM_DESC
(
h4_§m¶”_§m¶e_qfuÎ
, "Sample Q fullƒvent. Default: N. Runime option");

103 
boŞ
 
	gh4_§m¶”_§m¶e_mfuÎ
 = 
Œue
;

104 
moduË_·¿m
(
h4_§m¶”_§m¶e_mfuÎ
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

105 
MODULE_PARM_DESC
(
h4_§m¶”_§m¶e_mfuÎ
, "Sample Mbulk fullƒvent. Default: Y. Runime option");

107 
boŞ
 
	gh4_§m¶”_vif
 = 
Œue
;

108 
moduË_·¿m
(
h4_§m¶”_vif
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

109 
MODULE_PARM_DESC
(
h4_§m¶”_vif
, "Sample VIF. Default: Y. Runime option");

111 
boŞ
 
	gh4_§m¶”_bÙ
 = 
Œue
;

112 
moduË_·¿m
(
h4_§m¶”_bÙ
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

113 
MODULE_PARM_DESC
(
h4_§m¶”_bÙ
, "Sample BOT. Default: Y. Runime option");

115 
boŞ
 
	gh4_§m¶”_pkt_tx
 = 
Œue
;

116 
moduË_·¿m
(
h4_§m¶”_pkt_tx
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

117 
MODULE_PARM_DESC
(
h4_§m¶”_pkt_tx
, "Track TX Data…acket TX->HIP4->FB. Default: Y. Runime option");

119 
boŞ
 
	gh4_§m¶”_su¥’d_»sume
 = 
Œue
;

120 
moduË_·¿m
(
h4_§m¶”_su¥’d_»sume
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

121 
MODULE_PARM_DESC
(
h4_§m¶”_su¥’d_»sume
, "Sample Suspend/Resumeƒvents. Default: Y. Runime option");

123 
	#HIP4_TPUT_HLIMIT
 400000000

	)

124 
	#HIP4_TPUT_LLIMIT
 350000000

	)

125 
	#HIP4_TPUT_HSECONDS
 1

	)

126 
	#HIP4_TPUT_LSECONDS
 5

	)

128 
boŞ
 
	gh4_§m¶”_§m¶e_q_hput
;

129 
boŞ
 
	gh4_§m¶”_§m¶e_q»f_hput
;

130 
boŞ
 
	gh4_§m¶”_§m¶e_št_hput
;

131 
boŞ
 
	gh4_§m¶”_§m¶e_çpi_hput
;

137 
boŞ
 
	gh4_§m¶”_vif_hput
;

138 
boŞ
 
	gh4_§m¶”_bÙ_hput
;

139 
boŞ
 
	gh4_§m¶”_pkt_tx_hput
;

140 
boŞ
 
	gh4_§m¶”_su¥’d_»sume_hput
;

142 
boŞ
 
	gh4_§m¶”_š_hut
;

143 
u16
 
	gh4_§m¶”_š_hut_£cÚds
;

145 
	#DRV_NAME
 "h4_§m¶”"

	)

146 
	#DEVICE_NAME
 "h4_§m¶”"

	)

148 #iâdeà
VM_RESERVED


149 
	#VM_RESERVED
 (
VM_DONTEXPAND
 | 
VM_DONTDUMP
)

	)

152 
	#VER_MAJOR
 0

	)

153 
	#VER_MINOR
 0

	)

155 
DECLARE_BITMAP
(
b™m­_h4_§m¶”_mšÜ
, 
SCSC_HIP4_DEBUG_INTERFACES
);

157 
	eh4_dg_”rÜs
 {

158 
	mNO_ERROR
 = 0,

159 
	mBUFFER_OVERFLOW
,

160 
	mKFIFO_ERROR
,

161 
	mKFIFO_FULL
,

164 
	eh4_ty³
 {

165 
	mSTREAMING
 = 0,

166 
	mOFFLINE
,

169 
	sh4_§m¶”_dev
 {

171 
fe
 *
	mfp
;

173 
cdev
 
	mcdev
;

175 
deviû
 *
	mdev
;

177 
scsc_mx
 *
	mmx
;

179 
DECLARE_KFIFO_PTR
(
fifo
, 
h4_»cÜd
);

181 
wa™_queue_h—d_t
 
	m»ad_wa™
;

183 
h4_dg_”rÜs
 
	m”rÜ
;

185 
mu‹x
 
	mmu‹x
;

187 
u32
 
	m»cÜd_num
;

189 
u32
 
	mkfifo_max
;

191 
h4_ty³
 
	mty³
;

193 
u32
 
	mmšÜ
;

200 
boŞ
 
	mš™
;

201 
dev_t
 
	mdeviû
;

202 
şass
 *
	mşass_h4_§m¶”
;

203 
h4_§m¶”_dev
 
	mdevs
[
SCSC_HIP4_DEBUG_INTERFACES
];

204 } 
	gh4_§m¶”
;

206 
	$__h4_§m¶”_upd©e_»cÜd
(
h4_§m¶”_dev
 *
h4_dev
, 
u32
 
mšÜ
, 
u8
 
·¿m1
, u8 
·¿m2
, u8 
·¿m3
, u8 
·¿m4
, u32 
·¿m5
)

208 
h4_»cÜd
 
ev
;

209 
u32
 
»t
;

210 
u32
 
ıu
;

211 
u32
 
äeq
 = 0;

214 ià(
h4_dev
->
fp
) {

216 ià(
	`kfifo_ava
(&
h4_dev
->
fifo
)) {

218 
ıu
 = 
	`smp_´oûssÜ_id
();

219 ià(
h4_dev
->
»cÜd_num
 % 64 == 0)

220 
äeq
 = (
	`ıuäeq_quick_g‘
(
ıu
) / 1000) & 0xfff;

221 
ev
.
»cÜd_num
 = (0x0000fffà& 
h4_dev
->»cÜd_num++è| (
ıu
 << 28è| (
äeq
 << 16);

222 
ev
.
ts
 = 
	`ktime_g‘
();

223 
ev
.
»cÜd
 = ((
·¿m1
 & 0xffè<< 24è| ((
·¿m2
 & 0xffè<< 16è| ((
·¿m3
 & 0xffè<< 8è| (
·¿m4
 & 0xff);

224 
ev
.
»cÜd2
 = 
·¿m5
;

225 
	`kfifo_put
(&
h4_dev
->
fifo
, 
ev
);

226 
»t
 = 
	`kfifo_Ën
(&
h4_dev
->
fifo
);

227 ià(
»t
 > 
h4_dev
->
kfifo_max
)

228 
h4_dev
->
kfifo_max
 = 
»t
;

230 
h4_dev
->
”rÜ
 = 
KFIFO_FULL
;

233 
	`wake_up_š‹¼u±ibË
(&
h4_dev
->
»ad_wa™
);

237 
h4_dev
 = &
h4_§m¶”
.
devs
[
mšÜ
 + 1];

240 ià(
	`kfifo_is_fuÎ
(&
h4_dev
->
fifo
))

241 
»t
 = 
	`kfifo_g‘
(&
h4_dev
->
fifo
, &
ev
);

242 
ıu
 = 
	`smp_´oûssÜ_id
();

243 ià(
h4_dev
->
»cÜd_num
 % 64 == 0)

244 
äeq
 = (
	`ıuäeq_quick_g‘
(
ıu
) / 1000) & 0xfff;

246 
ev
.
»cÜd_num
 = (0x0000fffà& 
h4_dev
->»cÜd_num++è| (
ıu
 << 28è| (
äeq
 << 16);

247 
ev
.
ts
 = 
	`ktime_g‘
();

248 
ev
.
»cÜd
 = ((
·¿m1
 & 0xffè<< 24è| ((
·¿m2
 & 0xffè<< 16è| ((
·¿m3
 & 0xffè<< 8è| (
·¿m4
 & 0xff);

249 
ev
.
»cÜd2
 = 
·¿m5
;

250 
	`kfifo_put
(&
h4_dev
->
fifo
, 
ev
);

252 
	}
}

254 
boŞ
 
	$h4_§m¶”_upd©e_»cÜd_f‹r
(
u8
 
·¿m1
)

256 
·¿m1
) {

257 
HIP4_MIF_Q_FH_CTRL
:

258 
HIP4_MIF_Q_FH_DAT
:

259 
HIP4_MIF_Q_FH_RFB
:

260 
HIP4_MIF_Q_TH_CTRL
:

261 
HIP4_MIF_Q_TH_DAT
:

262 
HIP4_MIF_Q_TH_RFB
:

263  
h4_§m¶”_§m¶e_q
;

264 
HIP4_SAMPLER_QREF
:

265  
h4_§m¶”_§m¶e_q»f
;

266 
HIP4_SAMPLER_SIGNAL_CTRLTX
:

267 
HIP4_SAMPLER_SIGNAL_CTRLRX
:

268  
h4_§m¶”_§m¶e_çpi
;

269 
HIP4_SAMPLER_THROUG
:

270 
HIP4_SAMPLER_THROUG_K
:

271 
HIP4_SAMPLER_THROUG_M
:

272  
h4_§m¶”_§m¶e_through
;

273 
HIP4_SAMPLER_STOP_Q
:

274 
HIP4_SAMPLER_START_Q
:

275  
h4_§m¶”_§m¶e_¡¬t_¡İ_q
;

276 
HIP4_SAMPLER_MBULK
:

277  
h4_§m¶”_§m¶e_mbulk
;

278 
HIP4_SAMPLER_QFULL
:

279  
h4_§m¶”_§m¶e_qfuÎ
;

280 
HIP4_SAMPLER_MFULL
:

281  
h4_§m¶”_§m¶e_mfuÎ
;

282 
HIP4_SAMPLER_INT
:

283 
HIP4_SAMPLER_INT_OUT
:

284 
HIP4_SAMPLER_INT_BH
:

285 
HIP4_SAMPLER_INT_OUT_BH
:

286  
h4_§m¶”_§m¶e_št
;

287 
HIP4_SAMPLER_RESET
:

288  
Œue
;

289 
HIP4_SAMPLER_PEER
:

290  
h4_§m¶”_vif
;

291 
HIP4_SAMPLER_BOT_RX
:

292 
HIP4_SAMPLER_BOT_TX
:

293 
HIP4_SAMPLER_BOT_ADD
:

294 
HIP4_SAMPLER_BOT_REMOVE
:

295 
HIP4_SAMPLER_BOT_START_Q
:

296 
HIP4_SAMPLER_BOT_STOP_Q
:

297 
HIP4_SAMPLER_BOT_QMOD_RX
:

298 
HIP4_SAMPLER_BOT_QMOD_TX
:

299  
h4_§m¶”_bÙ
;

300 
HIP4_SAMPLER_BOT_QMOD_START
:

301 
HIP4_SAMPLER_BOT_QMOD_STOP
:

302  
h4_§m¶”_§m¶e_¡¬t_¡İ_q
 || 
h4_§m¶”_bÙ
;

303 
HIP4_SAMPLER_PKT_TX
:

304 
HIP4_SAMPLER_PKT_TX_HIP4
:

305 
HIP4_SAMPLER_PKT_TX_FB
:

306  
h4_§m¶”_pkt_tx
;

307 
HIP4_SAMPLER_SUSPEND
:

308 
HIP4_SAMPLER_RESUME
:

309  
h4_§m¶”_su¥’d_»sume
;

310 
HIP4_SAMPLER_TCP_SYN
:

311 
HIP4_SAMPLER_TCP_FIN
:

312 
HIP4_SAMPLER_TCP_DATA
:

313 
HIP4_SAMPLER_TCP_ACK
:

314 
HIP4_SAMPLER_TCP_DATA_IN
:

315 
HIP4_SAMPLER_TCP_ACK_IN
:

316 
HIP4_SAMPLER_TCP_RWND
:

317 
HIP4_SAMPLER_TCP_CWND
:

318 
HIP4_SAMPLER_TCP_SEND_BUF
:

319  
h4_§m¶”_§m¶e_tı
;

321  
çl£
;

322 
	}
}

324 
	$h4_§m¶”_upd©e_»cÜd
(
u32
 
mšÜ
, 
u8
 
·¿m1
, u8 
·¿m2
, u8 
·¿m3
, u8 
·¿m4
, u32 
·¿m5
)

326 
h4_§m¶”_dev
 *
h4_dev
;

327 
æags
;

329 ià(!
	`h4_§m¶”_upd©e_»cÜd_f‹r
(
·¿m1
))

332 ià(!
h4_§m¶”_’abË
 || !
h4_§m¶”
.
š™
)

335 ià(
	`©omic_»ad
(&
š_»ad
))

338 ià(
mšÜ
 >ğ
SCSC_HIP4_INTERFACES
)

341 
	`¥š_lock_œq§ve
(&
g_¥šlock
, 
æags
);

342 
h4_dev
 = &
h4_§m¶”
.
devs
[
mšÜ
];

343 
	`__h4_§m¶”_upd©e_»cÜd
(
h4_dev
, 
mšÜ
, 
·¿m1
, 
·¿m2
, 
·¿m3
, 
·¿m4
, 
·¿m5
);

344 
	`¥š_uÆock_œq»¡Üe
(&
g_¥šlock
, 
æags
);

345 
	}
}

347 
	$h4_§m¶”_¡Üe_·¿m
()

349 
h4_§m¶”_§m¶e_q_hput
 = 
h4_§m¶”_§m¶e_q
;

350 
h4_§m¶”_§m¶e_q»f_hput
 = 
h4_§m¶”_§m¶e_q»f
;

351 
h4_§m¶”_§m¶e_št_hput
 = 
h4_§m¶”_§m¶e_št
;

352 
h4_§m¶”_§m¶e_çpi_hput
 = 
h4_§m¶”_§m¶e_çpi
;

358 
h4_§m¶”_vif_hput
 = 
h4_§m¶”_vif
;

359 
h4_§m¶”_bÙ_hput
 = 
h4_§m¶”_bÙ
;

360 
h4_§m¶”_pkt_tx_hput
 = 
h4_§m¶”_pkt_tx
;

361 
h4_§m¶”_su¥’d_»sume_hput
 = 
h4_§m¶”_su¥’d_»sume
;

364 
h4_§m¶”_§m¶e_q
 = 
çl£
;

365 
h4_§m¶”_§m¶e_q»f
 = 
çl£
;

366 
h4_§m¶”_§m¶e_št
 = 
çl£
;

367 
h4_§m¶”_§m¶e_çpi
 = 
çl£
;

373 
h4_§m¶”_vif
 = 
çl£
;

374 
h4_§m¶”_bÙ
 = 
çl£
;

375 
h4_§m¶”_pkt_tx
 = 
çl£
;

376 
h4_§m¶”_su¥’d_»sume
 = 
çl£
;

377 
	}
}

379 
	$h4_§m¶”_»¡Üe_·¿m
()

381 
h4_§m¶”_§m¶e_q
 = 
h4_§m¶”_§m¶e_q_hput
;

382 
h4_§m¶”_§m¶e_q»f
 = 
h4_§m¶”_§m¶e_q»f_hput
;

383 
h4_§m¶”_§m¶e_št
 = 
h4_§m¶”_§m¶e_št_hput
;

384 
h4_§m¶”_§m¶e_çpi
 = 
h4_§m¶”_§m¶e_çpi_hput
;

390 
h4_§m¶”_vif
 = 
h4_§m¶”_vif_hput
;

391 
h4_§m¶”_bÙ
 = 
h4_§m¶”_bÙ_hput
;

392 
h4_§m¶”_pkt_tx
 = 
h4_§m¶”_pkt_tx_hput
;

393 
h4_§m¶”_su¥’d_»sume
 = 
h4_§m¶”_su¥’d_»sume_hput
;

394 
	}
}

396 
	$h4_§m¶”_dyÇmic_sw™ch”
(
u32
 
bps
)

399 ià(
h4_§m¶”_š_hut
) {

400 ià(
bps
 < 
HIP4_TPUT_LLIMIT
) {

402 
h4_§m¶”_š_hut_£cÚds
++;

403 ià(
h4_§m¶”_š_hut_£cÚds
 >ğ
HIP4_TPUT_LSECONDS
) {

405 
h4_§m¶”_š_hut
 = 
çl£
;

406 
h4_§m¶”_š_hut_£cÚds
 = 0;

407 
	`h4_§m¶”_»¡Üe_·¿m
();

410 
h4_§m¶”_š_hut_£cÚds
 = 0;

413 ià(
bps
 > 
HIP4_TPUT_HLIMIT
) {

415 
h4_§m¶”_š_hut_£cÚds
++;

416 ià(
h4_§m¶”_š_hut_£cÚds
 >ğ
HIP4_TPUT_HSECONDS
) {

418 
h4_§m¶”_š_hut
 = 
Œue
;

419 
h4_§m¶”_š_hut_£cÚds
 = 0;

420 
	`h4_§m¶”_¡Üe_·¿m
();

423 
h4_§m¶”_š_hut_£cÚds
 = 0;

426 
	}
}

428 
u32
 
	gg_ut_rx
;

429 
u32
 
	gg_ut_tx
;

431 
	$h4_§m¶”_ut_mÚ™Ü
(*
ş›Á_ùx
, 
u32
 
¡©e
, u32 
ut_tx
, u32 
ut_rx
)

433 
h4_§m¶”_dev
 *h4_§m¶”_dev = (h4_§m¶”_dev *)
ş›Á_ùx
;

435 ià(!
h4_§m¶”_’abË
)

438 ià((
g_ut_tx
 =ğ
ut_tx
è&& (
g_ut_rx
 =ğ
ut_rx
))

441 
g_ut_tx
 = 
ut_tx
;

442 
g_ut_rx
 = 
ut_rx
;

444 ià(
h4_§m¶”_dyÇmic
) {

449 ià(
ut_rx
 > 
ut_tx
)

450 
	`h4_§m¶”_dyÇmic_sw™ch”
(
ut_rx
);

452 
	`h4_§m¶”_dyÇmic_sw™ch”
(
ut_tx
);

456 ià(
ut_tx
 < 1000) {

457 
	`SCSC_HIP4_SAMPLER_THROUG
(
h4_§m¶”_dev
->
mšÜ
, 1, (
ut_tx
 & 0xff00) >> 8,put_tx & 0xff);

458 } ià((
ut_tx
 >= 1000) && (tput_tx < (1000 * 1000))) {

459 
ut_tx
 =put_tx / 1000;

460 
	`SCSC_HIP4_SAMPLER_THROUG_K
(
h4_§m¶”_dev
->
mšÜ
, 1, (
ut_tx
 & 0xff00) >> 8,put_tx & 0xff);

462 
ut_tx
 =put_tx / (1000 * 1000);

463 
	`SCSC_HIP4_SAMPLER_THROUG_M
(
h4_§m¶”_dev
->
mšÜ
, 1, (
ut_tx
 & 0xff00) >> 8,put_tx & 0xff);

467 ià(
ut_rx
 < 1000) {

468 
	`SCSC_HIP4_SAMPLER_THROUG
(
h4_§m¶”_dev
->
mšÜ
, 0, (
ut_rx
 & 0xff00) >> 8,put_rx & 0xff);

469 } ià((
ut_rx
 >= 1000) && (tput_rx < (1000 * 1000))) {

470 
ut_rx
 =put_rx / 1000;

471 
	`SCSC_HIP4_SAMPLER_THROUG_K
(
h4_§m¶”_dev
->
mšÜ
, 0, (
ut_rx
 & 0xff00) >> 8,put_rx & 0xff);

473 
ut_rx
 =put_rx / (1000 * 1000);

474 
	`SCSC_HIP4_SAMPLER_THROUG_M
(
h4_§m¶”_dev
->
mšÜ
, 0, (
ut_rx
 & 0xff00) >> 8,put_rx & 0xff);

476 
	}
}

478 
	$h4_§m¶”_tı_decode
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
äame
, 
boŞ
 
äom_ba
)

480 
tıhdr
 *
tı_hdr
;

481 
‘hhdr
 *
ehdr
 = (‘hhd¸*)(
äame
);

482 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

483 
u8
 *
_äame
;

484 
u16
 
_d©a_off£t
;

485 
u8
 
hËn
;

486 
u16
 
Ën
;

487 
u8
 
´Ùo
;

488 
u8
 
idx
;

490 ià(!
h4_§m¶”_§m¶e_tı
)

493 ià(
	`be16_to_ıu
(
ehdr
->
h_´Ùo
è!ğ
ETH_P_IP
)

496 
_äame
 = 
äame
 + 
ETH_HLEN
;

497 
´Ùo
 = 
_äame
[9];

499 ià(
´Ùo
 !ğ
IPPROTO_TCP
)

502 
_d©a_off£t
 = 20;

503 
hËn
 = 
_äame
[0] & 0x0F;

504 
Ën
 = 
_äame
[2] << 8 | ip_frame[3];

506 ià(
hËn
 > 5)

507 
_d©a_off£t
 +ğ(
hËn
 - 5) * 4;

509 
tı_hdr
 = (
tıhdr
 *)(
_äame
 + 
_d©a_off£t
);

511 
	`¦si_¥šlock_lock
(&
ndev_vif
->
tı_ack_lock
);

513 
idx
 = 0; idx < 
TCP_ACK_SUPPRESSION_RECORDS_MAX
; idx++) {

514 
¦si_tı_ack_s
 *
tı_ack
;

515 
u32
 
rwnd
 = 0;

517 
tı_ack
 = &
ndev_vif
->
ack_suµ»ssiÚ
[
idx
];

518 ià((
tı_ack
->
dpÜt
 =ğ
tı_hdr
->
sourû
è&& (tı_ack->
¥Üt
 =ğtı_hdr->
de¡
)) {

519 ià(
äom_ba
 && 
tı_hdr
->
syn
 &&ı_hdr->
ack
) {

520 *
İtiÚs
;

521 
u32
 
İ’
 = 0, 
Ën
 = 0;

523 ià(
tı_hdr
->
doff
 > 5)

524 
İ’
 = (
tı_hdr
->
doff
 - 5) * 4;

526 
İtiÚs
 = (
u8
 *)
tı_hdr
 + 
TCP_ACK_SUPPRESSION_OPTIONS_OFFSET
;

528 
İ’
 > 0) {

529 
İtiÚs
[0]) {

530 
TCP_ACK_SUPPRESSION_OPTION_EOL
:

531 
Ën
 = 1;

533 
TCP_ACK_SUPPRESSION_OPTION_NOP
:

534 
Ën
 = 1;

536 
TCP_ACK_SUPPRESSION_OPTION_WINDOW
:

537 
tı_ack
->
rx_wšdow_sÿË
 = 
İtiÚs
[2];

538 
Ën
 = 
İtiÚs
[1];

541 
Ën
 = 
İtiÚs
[1];

547 ià((
Ën
 =ğ0è|| (ËÀ>ğ
İ’
))

550 ià(
İ’
 >ğ
Ën
)

551 
İ’
 -ğ
Ën
;

553 
İ’
 = 0;

554 
İtiÚs
 +ğ
Ën
;

557 ià(
Ën
 > ((
hËn
 * 4è+ (
tı_hdr
->
doff
 * 4))) {

558 ià(
äom_ba
)

559 
	`SCSC_HIP4_SAMPLER_TCP_DATA
(
sdev
->
mšÜ_´of
, 
tı_ack
->
¡»am_id
, 
tı_hdr
->
£q
);

561 
	`SCSC_HIP4_SAMPLER_TCP_DATA_IN
(
sdev
->
mšÜ_´of
, 
tı_ack
->
¡»am_id
, 
tı_hdr
->
£q
);

563 ià(
tı_ack
->
rx_wšdow_sÿË
)

564 
rwnd
 = 
	`be16_to_ıu
(
tı_hdr
->
wšdow
è* (2 << 
tı_ack
->
rx_wšdow_sÿË
);

566 
rwnd
 = 
	`be16_to_ıu
(
tı_hdr
->
wšdow
);

567 ià(
äom_ba
) {

568 
	`SCSC_HIP4_SAMPLER_TCP_ACK
(
sdev
->
mšÜ_´of
, 
tı_ack
->
¡»am_id
, 
	`be32_to_ıu
(
tı_hdr
->
ack_£q
));

569 
	`SCSC_HIP4_SAMPLER_TCP_RWND
(
sdev
->
mšÜ_´of
, 
tı_ack
->
¡»am_id
, 
rwnd
);

571 
	`SCSC_HIP4_SAMPLER_TCP_ACK_IN
(
sdev
->
mšÜ_´of
, 
tı_ack
->
¡»am_id
, 
	`be32_to_ıu
(
tı_hdr
->
ack_£q
));

577 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

578 
	}
}

580 #ià
IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

581 
	$h4_cŞËù_š™
(
scsc_log_cŞËùÜ_ş›Á
 *
cŞËù_ş›Á
)

584 
	`©omic_£t
(&
š_»ad
, 1);

586 
	}
}

588 
	$h4_cŞËù
(
scsc_log_cŞËùÜ_ş›Á
 *
cŞËù_ş›Á
, 
size_t
 
size
)

590 
i
 = 
SCSC_HIP4_DEBUG_INTERFACES
;

591 
»t
 = 0;

592 
æags
;

593 
u32
 
num_§m¶es
;

594 
h4_§m¶”_dev
 *
h4_dev
;

595 *
buf
;

596 
scsc_h4_§m¶”_h—d”
 
h—d”
;

599 
	`SLSI_INFO_NODEV
("Triggered†og collection in hip4_sampler\n");

601 ià(!
h4_§m¶”_’abË
)

604 
i
--)

605 ià(
h4_§m¶”
.
devs
[
i
].
mx
 =ğ
cŞËù_ş›Á
->
´v
 && h4_§m¶”.devs[i].
ty³
 =ğ
OFFLINE
) {

606 
h4_dev
 = &
h4_§m¶”
.
devs
[
i
];

607 
num_§m¶es
 = 
	`kfifo_Ën
(&
h4_dev
->
fifo
);

608 ià(!
num_§m¶es
)

610 
buf
 = 
	`vm®loc
(
num_§m¶es
 * (
h4_»cÜd
));

611 ià(!
buf
)

614 
	`mem£t
(&
h—d”
, 0, (header));

615 
	`memıy
(
h—d”
.
magic
, 
SCSC_HIP4_SAMPLER_MAGIC
, 4);

616 
h—d”
.
off£t_d©a
 = (header);

617 
h—d”
.
v”siÚ_majÜ
 = 
SCSC_HIP4_SAMPLER_HEADER_VERSION_MAJOR
;

618 
h—d”
.
v”siÚ_mšÜ
 = 
SCSC_HIP4_SAMPLER_HEADER_VERSION_MINOR
;

619 #ifdeà
CONFIG_SOC_EXYNOS9630


620 
h—d”
.
¶©fÜm
 = 
SCSC_HIP4_SAMPLER_EXYNOS9630
;

621 #–ià
	`defšed
(
CONFIG_SOC_EXYNOS9610
)

622 
h—d”
.
¶©fÜm
 = 
SCSC_HIP4_SAMPLER_EXYNOS9610
;

623 #–ià
	`defšed
(
CONFIG_SOC_EXYNOS7885
)

624 
h—d”
.
¶©fÜm
 = 
SCSC_HIP4_SAMPLER_EXYNOS7885
;

626 
h—d”
.
¶©fÜm
 = 
SCSC_HIP4_SAMPLER_UNDEF
;

629 
h—d”
.
§m¶e_ty³
 = 
SCSC_HIP4_SAMPLER_TYPE_TCP
;

630 ià(
h4_§m¶”_š_hut
)

631 
h—d”
.
h4_¡©us
 |ğ
	`BIT
(0);

632 #ifdeà
CONFIG_DEBUG_SPINLOCK


633 
h—d”
.
h4_¡©us
 |ğ
	`BIT
(1);

635 
h—d”
.
num_§m¶es
 =‚um_samples;

637 
»t
 = 
	`scsc_log_cŞËùÜ_wr™e
((*)&
h—d”
, (header), 1);

638 ià(
»t
)

639 
”rÜ
;

641 
	`¥š_lock_œq§ve
(&
g_¥šlock
, 
æags
);

642 
»t
 = 
	`kfifo_out
(&
h4_dev
->
fifo
, 
buf
, 
num_§m¶es
);

643 
	`¥š_uÆock_œq»¡Üe
(&
g_¥šlock
, 
æags
);

644 ià(!
»t
)

645 
”rÜ
;

646 
	`SLSI_DBG1_NODEV
(
SLSI_HIP
, "num_§m¶e %d„‘ %d sizoàh4_»cÜd %zu\n", 
num_§m¶es
, 
»t
, (
h4_»cÜd
));

647 
»t
 = 
	`scsc_log_cŞËùÜ_wr™e
(
buf
,„‘ * (
h4_»cÜd
), 1);

648 ià(
»t
)

649 
”rÜ
;

650 
	`vä“
(
buf
);

653 
”rÜ
:

654 
	`vä“
(
buf
);

655  
»t
;

656 
	}
}

658 
	$h4_cŞËù_’d
(
scsc_log_cŞËùÜ_ş›Á
 *
cŞËù_ş›Á
)

661 
	`©omic_£t
(&
š_»ad
, 0);

663 
	}
}

666 
scsc_log_cŞËùÜ_ş›Á
 
	gh4_cŞËù_ş›Á
 = {

667 .
Çme
 = "HIP4 Sampler",

668 .
	gty³
 = 
SCSC_LOG_CHUNK_HIP4_SAMPLER
,

669 .
	gcŞËù_š™
 = 
h4_cŞËù_š™
,

670 .
	gcŞËù
 = 
h4_cŞËù
,

671 .
	gcŞËù_’d
 = 
h4_cŞËù_’d
,

672 .
	g´v
 = 
NULL
,

676 
	$h4_§m¶”_İ’
(
šode
 *šode, 
fe
 *
fp
)

678 
h4_§m¶”_dev
 *
h4_dev
;

679 
»t
 = 0;

681 
h4_dev
 = 
	`cÚš”_of
(
šode
->
i_cdev
, 
h4_§m¶”_dev
, 
cdev
);

683 ià(
h4_dev
->
ty³
 =ğ
OFFLINE
) {

685 
fp
->
´iv©e_d©a
 = 
h4_dev
;

688 ià(
	`mu‹x_lock_š‹¼u±ibË
(&
h4_dev
->
mu‹x
))

689  -
ERESTARTSYS
;

691 ià(
fp
->
´iv©e_d©a
) {

692 
	`SLSI_INFO_NODEV
("Service‡lready started\n");

693 
»t
 = 0;

694 
’d
;

697 ià(
h4_§m¶”_kfifo_Ën
 > 256 * 1024) {

698 
	`SLSI_DBG1_NODEV
(
SLSI_HIP
, "h4_§m¶”_kfifo_ËÀ%d > 2262144. S‘ØMAX", 
h4_§m¶”_kfifo_Ën
);

699 
h4_§m¶”_kfifo_Ën
 = 256 * 1024;

702 
»t
 = 
	`kfifo_®loc
(&
h4_dev
->
fifo
, 
h4_§m¶”_kfifo_Ën
, 
GFP_KERNEL
);

703 ià(
»t
) {

704 
	`SLSI_ERR_NODEV
("kfifo_alloc failed");

705 
»t
 = -
ENOMEM
;

706 
’d
;

709 
fp
->
´iv©e_d©a
 = 
h4_dev
;

712 
h4_dev
->
”rÜ
 = 
NO_ERROR
;

714 
h4_dev
->
»cÜd_num
 = 0;

715 
h4_dev
->
kfifo_max
 = 0;

716 
h4_dev
->
fp
 = filp;

718 
	`SLSI_INFO_NODEV
("%s: Sam¶šg....\n", 
DRV_NAME
);

719 
’d
:

720 
	`mu‹x_uÆock
(&
h4_dev
->
mu‹x
);

721  
»t
;

722 
	}
}

724 
ssize_t
 
	$h4_§m¶”_»ad
(
fe
 *
fp
, 
__u£r
 *
buf
, 
size_t
 
Ën
, 
loff_t
 *
off£t
)

726 
cİ›d
;

727 
»t
 = 0;

728 
h4_§m¶”_dev
 *
h4_dev
;

730 
h4_dev
 = 
fp
->
´iv©e_d©a
;

732 ià(
h4_dev
->
ty³
 =ğ
OFFLINE
) {

734 ià(
	`mu‹x_lock_š‹¼u±ibË
(&
h4_dev
->
mu‹x
))

735  -
EINTR
;

736 
	`©omic_£t
(&
š_»ad
, 1);

737 
»t
 = 
	`kfifo_to_u£r
(&
h4_dev
->
fifo
, 
buf
, 
Ën
, &
cİ›d
);

738 
	`mu‹x_uÆock
(&
h4_dev
->
mu‹x
);

739  
»t
 ?„‘ : 
cİ›d
;

742 ià(
	`mu‹x_lock_š‹¼u±ibË
(&
h4_dev
->
mu‹x
))

743  -
EINTR
;

746 ià(
h4_dev
->
”rÜ
 !ğ
NO_ERROR
) {

747 
	`SLSI_ERR_NODEV
("Device inƒrror\n");

748 
»t
 = -
EIO
;

749 
’d
;

752 
Ën
) {

753 ià(
	`kfifo_Ën
(&
h4_dev
->
fifo
)) {

754 
»t
 = 
	`kfifo_to_u£r
(&
h4_dev
->
fifo
, 
buf
, 
Ën
, &
cİ›d
);

755 ià(!
»t
)

756 
»t
 = 
cİ›d
;

760 ià(
fp
->
f_æags
 & 
O_NONBLOCK
) {

761 
»t
 = -
EAGAIN
;

765 
»t
 = 
	`wa™_ev’t_š‹¼u±ibË
(
h4_dev
->
»ad_wa™
,

766 !
	`kfifo_is_em±y
(&
h4_dev
->
fifo
));

767 ià(
»t
 < 0)

770 
’d
:

771 
	`mu‹x_uÆock
(&
h4_dev
->
mu‹x
);

772  
»t
;

773 
	}
}

775 
	$h4_§m¶”_pŞl
(
fe
 *
fp
, 
pŞl_bË
 *
wa™
)

777 
h4_§m¶”_dev
 *
h4_dev
;

778 
»t
;

780 
h4_dev
 = 
fp
->
´iv©e_d©a
;

782 ià(
h4_dev
->
ty³
 =ğ
OFFLINE
)

786 ià(
	`mu‹x_lock_š‹¼u±ibË
(&
h4_dev
->
mu‹x
))

787  -
EINTR
;

789 ià(
h4_dev
->
”rÜ
 !ğ
NO_ERROR
) {

790 
»t
 = 
POLLERR
;

791 
’d
;

794 
	`pŞl_wa™
(
fp
, &
h4_dev
->
»ad_wa™
, 
wa™
);

796 ià(!
	`kfifo_is_em±y
(&
h4_dev
->
fifo
)) {

797 
»t
 = 
POLLIN
 | 
POLLRDNORM
;

798 
’d
;

801 
»t
 = 
POLLOUT
 | 
POLLWRNORM
;

803 
’d
:

804 
	`mu‹x_uÆock
(&
h4_dev
->
mu‹x
);

805  
»t
;

806 
	}
}

808 
	$h4_§m¶”_»Ëa£
(
šode
 *šode, 
fe
 *
fp
)

810 
h4_§m¶”_dev
 *
h4_dev
;

812 
h4_dev
 = 
	`cÚš”_of
(
šode
->
i_cdev
, 
h4_§m¶”_dev
, 
cdev
);

814 ià(
h4_dev
->
ty³
 =ğ
OFFLINE
) {

815 
	`©omic_£t
(&
š_»ad
, 0);

820 ià(
	`mu‹x_lock_š‹¼u±ibË
(&
h4_dev
->
mu‹x
))

821  -
EINTR
;

823 ià(!
h4_dev
->
fp
) {

824 
	`SLSI_ERR_NODEV
("Device‡lready closed\n");

825 
	`mu‹x_uÆock
(&
h4_dev
->
mu‹x
);

826  -
EIO
;

829 ià(
h4_dev
 !ğ
fp
->
´iv©e_d©a
) {

830 
	`SLSI_ERR_NODEV
("Data mismatch\n");

831 
	`mu‹x_uÆock
(&
h4_dev
->
mu‹x
);

832  -
EIO
;

835 
fp
->
´iv©e_d©a
 = 
NULL
;

836 
h4_dev
->
fp
 = 
NULL
;

837 
	`kfifo_ä“
(&
h4_dev
->
fifo
);

839 
	`mu‹x_uÆock
(&
h4_dev
->
mu‹x
);

840 
	`SLSI_INFO_NODEV
("%s: Sam¶šg...ƒnd. Kfifo_max = %d\n", 
DRV_NAME
, 
h4_dev
->
kfifo_max
);

842 
	}
}

844 cÚ¡ 
fe_İ”©iÚs
 
	gh4_§m¶”_fİs
 = {

845 .
owÃr
 = 
THIS_MODULE
,

846 .
	gİ’
 = 
h4_§m¶”_İ’
,

847 .
	g»ad
 = 
h4_§m¶”_»ad
,

848 .
	g»Ëa£
 = 
h4_§m¶”_»Ëa£
,

849 .
	gpŞl
 = 
h4_§m¶”_pŞl
,

853 
	$h4_§m¶”_»gi¡”_h
(
scsc_mx
 *
mx
)

855 
i
 = 
SCSC_HIP4_DEBUG_INTERFACES
;

857 
i
--)

858 ià(
h4_§m¶”
.
devs
[
i
].
mx
 == mx &&

859 
h4_§m¶”
.
devs
[
i
].
ty³
 =ğ
STREAMING
)

860  
i
;

861  -
ENODEV
;

862 
	}
}

864 
	$h4_§m¶”_ü—‹
(
¦si_dev
 *
sdev
, 
scsc_mx
 *
mx
)

866 
dev_t
 
devn
;

867 
»t
;

868 
dev_Çme
[20];

869 
mšÜ
;

870 
i
;

872 
	`SLSI_INFO_NODEV
("h4_§m¶” v”siÚ: %d.%d\n", 
VER_MAJOR
, 
VER_MINOR
);

874 
	`mem£t
(&
h4_§m¶”
, 0, (hip4_sampler));

876 ià(!
h4_§m¶”
.
š™
) {

877 
»t
 = 
	`®loc_chrdev_»giÚ
(&
h4_§m¶”
.
deviû
, 0, 
SCSC_HIP4_DEBUG_INTERFACES
, "hip4_sampler_char");

878 ià(
»t
)

879 
”rÜ
;

881 
h4_§m¶”
.
şass_h4_§m¶”
 = 
	`şass_ü—‹
(
THIS_MODULE
, 
DEVICE_NAME
);

882 ià(
	`IS_ERR
(
h4_§m¶”
.
şass_h4_§m¶”
)) {

883 
	`SLSI_ERR_NODEV
("hip4_sampler class creation failed\n");

884 
»t
 = 
	`PTR_ERR
(
h4_§m¶”
.
şass_h4_§m¶”
);

885 
”rÜ_şass
;

890 
mšÜ
 = 
	`fšd_fœ¡_z”o_b™
(
b™m­_h4_§m¶”_mšÜ
, 
SCSC_HIP4_DEBUG_INTERFACES
);

891 ià(
mšÜ
 >ğ
SCSC_HIP4_DEBUG_INTERFACES
) {

892 
	`SLSI_INFO_NODEV
("mšÜ %d > SCSC_TTY_MINORS\n", 
mšÜ
);

898 
i
 = 0; i < 
SCSC_HIP4_STREAM_CH
; i++) {

899 
mšÜ
 +ğ
i
;

900 
devn
 = 
	`MKDEV
(
	`MAJOR
(
h4_§m¶”
.
deviû
), 
	`MINOR
(
mšÜ
));

902 
	`¢´štf
(
dev_Çme
, (dev_Çme), "%s_%d_%s", "h4", 
i
, "sam_str");

904 
	`cdev_š™
(&
h4_§m¶”
.
devs
[
mšÜ
].
cdev
, &
h4_§m¶”_fİs
);

905 
h4_§m¶”
.
devs
[
mšÜ
].
cdev
.
owÃr
 = 
THIS_MODULE
;

906 
h4_§m¶”
.
devs
[
mšÜ
].
cdev
.
İs
 = &
h4_§m¶”_fİs
;

908 
»t
 = 
	`cdev_add
(&
h4_§m¶”
.
devs
[
mšÜ
].
cdev
, 
devn
, 1);

909 ià(
»t
) {

910 
h4_§m¶”
.
devs
[
mšÜ
].
cdev
.
dev
 = 0;

914 
h4_§m¶”
.
devs
[
mšÜ
].
dev
 =

915 
	`deviû_ü—‹
(
h4_§m¶”
.
şass_h4_§m¶”
, 
NULL
, h4_§m¶”.
devs
[
mšÜ
].
cdev
.
dev
, NULL, 
dev_Çme
);

917 ià(!
h4_§m¶”
.
devs
[
mšÜ
].
dev
) {

918 
	`SLSI_ERR_NODEV
("dev is NULL\n");

919 
h4_§m¶”
.
devs
[
mšÜ
].
cdev
.
dev
 = 0;

920 
	`cdev_d–
(&
h4_§m¶”
.
devs
[
mšÜ
].
cdev
);

924 
h4_§m¶”
.
devs
[
mšÜ
].
mx
 = mx;

926 
	`mu‹x_š™
(&
h4_§m¶”
.
devs
[
mšÜ
].
mu‹x
);

927 
h4_§m¶”
.
devs
[
mšÜ
].
kfifo_max
 = 0;

928 
h4_§m¶”
.
devs
[
mšÜ
].
ty³
 = 
STREAMING
;

929 
h4_§m¶”
.
devs
[
mšÜ
].minor = minor;

931 
	`š™_wa™queue_h—d
(&
h4_§m¶”
.
devs
[
mšÜ
].
»ad_wa™
);

933 
	`¦si_Œaffic_mÚ_ş›Á_»gi¡”
(

934 
sdev
,

935 &
h4_§m¶”
.
devs
[
mšÜ
],

936 
TRAFFIC_MON_CLIENT_MODE_PERIODIC
,

939 
h4_§m¶”_ut_mÚ™Ü
);

942 
	`£t_b™
(
mšÜ
, 
b™m­_h4_§m¶”_mšÜ
);

944 
mšÜ
++;

947 
devn
 = 
	`MKDEV
(
	`MAJOR
(
h4_§m¶”
.
deviû
), 
	`MINOR
(
mšÜ
));

949 
	`¢´štf
(
dev_Çme
, (dev_Çme), "%s_%d_%s", "h4", 
i
, "sam_off");

951 
	`cdev_š™
(&
h4_§m¶”
.
devs
[
mšÜ
].
cdev
, &
h4_§m¶”_fİs
);

952 
h4_§m¶”
.
devs
[
mšÜ
].
cdev
.
owÃr
 = 
THIS_MODULE
;

953 
h4_§m¶”
.
devs
[
mšÜ
].
cdev
.
İs
 = &
h4_§m¶”_fİs
;

955 
»t
 = 
	`cdev_add
(&
h4_§m¶”
.
devs
[
mšÜ
].
cdev
, 
devn
, 1);

956 ià(
»t
) {

957 
h4_§m¶”
.
devs
[
mšÜ
].
cdev
.
dev
 = 0;

961 
h4_§m¶”
.
devs
[
mšÜ
].
dev
 =

962 
	`deviû_ü—‹
(
h4_§m¶”
.
şass_h4_§m¶”
, 
NULL
, h4_§m¶”.
devs
[
mšÜ
].
cdev
.
dev
, NULL, 
dev_Çme
);

964 ià(!
h4_§m¶”
.
devs
[
mšÜ
].
dev
) {

965 
h4_§m¶”
.
devs
[
mšÜ
].
cdev
.
dev
 = 0;

966 
	`cdev_d–
(&
h4_§m¶”
.
devs
[
mšÜ
].
cdev
);

970 ià(
h4_§m¶”_¡©ic_kfifo_Ën
 > 256 * 1024) {

971 
	`SLSI_DBG1_NODEV
(
SLSI_HIP
, "h4_§m¶”_¡©ic_kfifo_ËÀ%d > 2262144. S‘ØMAX", 
h4_§m¶”_¡©ic_kfifo_Ën
);

972 
h4_§m¶”_¡©ic_kfifo_Ën
 = 256 * 1024;

974 
»t
 = 
	`kfifo_®loc
(&
h4_§m¶”
.
devs
[
mšÜ
].
fifo
, 
h4_§m¶”_¡©ic_kfifo_Ën
, 
GFP_KERNEL
);

975 ià(
»t
) {

976 
	`SLSI_ERR_NODEV
("kfifo_alloc failed");

977 
h4_§m¶”
.
devs
[
mšÜ
].
dev
 = 
NULL
;

978 
h4_§m¶”
.
devs
[
mšÜ
].
cdev
.
dev
 = 0;

979 
	`cdev_d–
(&
h4_§m¶”
.
devs
[
mšÜ
].
cdev
);

983 
h4_§m¶”
.
devs
[
mšÜ
].
mx
 = mx;

985 
	`mu‹x_š™
(&
h4_§m¶”
.
devs
[
mšÜ
].
mu‹x
);

986 
h4_§m¶”
.
devs
[
mšÜ
].
kfifo_max
 = 0;

987 
h4_§m¶”
.
devs
[
mšÜ
].
ty³
 = 
OFFLINE
;

990 
	`£t_b™
(
mšÜ
, 
b™m­_h4_§m¶”_mšÜ
);

993 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

994 
h4_cŞËù_ş›Á
.
´v
 = 
mx
;

995 
	`scsc_log_cŞËùÜ_»gi¡”_ş›Á
(&
h4_cŞËù_ş›Á
);

997 
h4_§m¶”
.
š™
 = 
Œue
;

999 
	`SLSI_INFO_NODEV
("%s: R—dyØ¡¬ˆ§m¶šg....\n", 
DRV_NAME
);

1003 
”rÜ_şass
:

1004 
	`uÄegi¡”_chrdev_»giÚ
(
h4_§m¶”
.
deviû
, 
SCSC_HIP4_DEBUG_INTERFACES
);

1005 
h4_§m¶”
.
š™
 = 
çl£
;

1006 
”rÜ
:

1008 
	}
}

1010 
	$h4_§m¶”_de¡roy
(
¦si_dev
 *
sdev
, 
scsc_mx
 *
mx
)

1012 
i
 = 
SCSC_HIP4_DEBUG_INTERFACES
;

1013 
h4_§m¶”_dev
 *
h4_dev
;

1015 
i
--)

1016 ià(
h4_§m¶”
.
devs
[
i
].
cdev
.
dev
 && h4_§m¶”.devs[i].
mx
) {

1017 
h4_dev
 = &
h4_§m¶”
.
devs
[
i
];

1021 ià(
h4_§m¶”
.
devs
[
i
].
fp
) {

1022 
h4_§m¶”
.
devs
[
i
].
fp
 = 
NULL
;

1023 
	`kfifo_ä“
(&
h4_§m¶”
.
devs
[
i
].
fifo
);

1025 ià(
h4_§m¶”
.
devs
[
i
].
ty³
 =ğ
OFFLINE
)

1026 
	`kfifo_ä“
(&
h4_§m¶”
.
devs
[
i
].
fifo
);

1028 
	`¦si_Œaffic_mÚ_ş›Á_uÄegi¡”
(
sdev
, 
h4_dev
);

1029 
	`deviû_de¡roy
(
h4_§m¶”
.
şass_h4_§m¶”
, h4_§m¶”.
devs
[
i
].
cdev
.
dev
);

1030 
	`cdev_d–
(&
h4_§m¶”
.
devs
[
i
].
cdev
);

1031 
	`mem£t
(&
h4_§m¶”
.
devs
[
i
].
cdev
, 0, (cdev));

1032 
h4_§m¶”
.
devs
[
i
].
mx
 = 
NULL
;

1033 
	`ş—r_b™
(
i
, 
b™m­_h4_§m¶”_mšÜ
);

1035 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

1036 
	`scsc_log_cŞËùÜ_uÄegi¡”_ş›Á
(&
h4_cŞËù_ş›Á
);

1038 
	`şass_de¡roy
(
h4_§m¶”
.
şass_h4_§m¶”
);

1039 
	`uÄegi¡”_chrdev_»giÚ
(
h4_§m¶”
.
deviû
, 
SCSC_HIP4_DEBUG_INTERFACES
);

1040 
h4_§m¶”
.
š™
 = 
çl£
;

1041 
	}
}

	@hip4_sampler.h

7 #iâdeà
__HIP4_SAMPLER_H__


8 
	#__HIP4_SAMPLER_H__


	)

10 
	~<lšux/´oc_fs.h
>

11 
	~<lšux/v”siÚ.h
>

12 
	~<lšux/£q_fe.h
>

13 
	~<Ãt/tı.h
>

15 
	~"dev.h
"

17 
	#HIP4_SAMPLER_SIGNAL_CTRLTX
 0x20

	)

18 
	#HIP4_SAMPLER_SIGNAL_CTRLRX
 0x21

	)

19 
	#HIP4_SAMPLER_THROUG
 0x22

	)

20 
	#HIP4_SAMPLER_THROUG_K
 0x23

	)

21 
	#HIP4_SAMPLER_THROUG_M
 0x24

	)

22 
	#HIP4_SAMPLER_STOP_Q
 0x25

	)

23 
	#HIP4_SAMPLER_START_Q
 0x26

	)

24 
	#HIP4_SAMPLER_QREF
 0x27

	)

25 
	#HIP4_SAMPLER_PEER
 0x29

	)

26 
	#HIP4_SAMPLER_BOT_RX
 0x2a

	)

27 
	#HIP4_SAMPLER_BOT_TX
 0x2b

	)

28 
	#HIP4_SAMPLER_BOT_ADD
 0x2c

	)

29 
	#HIP4_SAMPLER_BOT_REMOVE
 0x2d

	)

30 
	#HIP4_SAMPLER_BOT_STOP_Q
 0x2e

	)

31 
	#HIP4_SAMPLER_BOT_START_Q
 0x2f

	)

32 
	#HIP4_SAMPLER_BOT_QMOD_RX
 0x30

	)

33 
	#HIP4_SAMPLER_BOT_QMOD_TX
 0x31

	)

34 
	#HIP4_SAMPLER_BOT_QMOD_STOP
 0x32

	)

35 
	#HIP4_SAMPLER_BOT_QMOD_START
 0x33

	)

36 
	#HIP4_SAMPLER_PKT_TX
 0x40

	)

37 
	#HIP4_SAMPLER_PKT_TX_HIP4
 0x41

	)

38 
	#HIP4_SAMPLER_PKT_TX_FB
 0x42

	)

39 
	#HIP4_SAMPLER_SUSPEND
 0x50

	)

40 
	#HIP4_SAMPLER_RESUME
 0x51

	)

42 
	#HIP4_SAMPLER_TCP_SYN
 0x60

	)

43 
	#HIP4_SAMPLER_TCP_FIN
 0x61

	)

44 
	#HIP4_SAMPLER_TCP_DATA
 0x62

	)

45 
	#HIP4_SAMPLER_TCP_ACK
 0x63

	)

46 
	#HIP4_SAMPLER_TCP_RWND
 0x64

	)

47 
	#HIP4_SAMPLER_TCP_CWND
 0x65

	)

48 
	#HIP4_SAMPLER_TCP_SEND_BUF
 0x66

	)

49 
	#HIP4_SAMPLER_TCP_DATA_IN
 0x67

	)

50 
	#HIP4_SAMPLER_TCP_ACK_IN
 0x68

	)

52 
	#HIP4_SAMPLER_MBULK
 0x¯

	)

53 
	#HIP4_SAMPLER_QFULL
 0xbb

	)

54 
	#HIP4_SAMPLER_MFULL
 0xcc

	)

55 
	#HIP4_SAMPLER_INT
 0xdd

	)

56 
	#HIP4_SAMPLER_INT_OUT
 0x“

	)

57 
	#HIP4_SAMPLER_INT_BH
 0xde

	)

58 
	#HIP4_SAMPLER_INT_OUT_BH
 0xef

	)

59 
	#HIP4_SAMPLER_RESET
 0xff

	)

61 
	#SCSC_HIP4_INTERFACES
 1

	)

63 
	#SCSC_HIP4_STREAM_CH
 1

	)

64 
	#SCSC_HIP4_OFFLINE_CH
 
SCSC_HIP4_STREAM_CH


	)

66 #ià(
SCSC_HIP4_OFFLINE_CH
 !ğ
SCSC_HIP4_STREAM_CH
)

70 
	#SCSC_HIP4_DEBUG_INTERFACES
 ((
SCSC_HIP4_INTERFACES
è* (
SCSC_HIP4_STREAM_CH
 + 
SCSC_HIP4_OFFLINE_CH
))

	)

72 
	gscsc_mx
;

74 
h4_§m¶”_ü—‹
(
¦si_dev
 *
sdev
, 
scsc_mx
 *
mx
);

75 
h4_§m¶”_de¡roy
(
¦si_dev
 *
sdev
, 
scsc_mx
 *
mx
);

79 
h4_§m¶”_»gi¡”_h
(
scsc_mx
 *
mx
);

81 
h4_§m¶”_upd©e_»cÜd
(
u32
 
mšÜ
, 
u8
 
·¿m1
, u8 
·¿m2
, u8 
·¿m3
, u8 
·¿m4
, u32 
·¿m5
);

82 
h4_§m¶”_tı_decode
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
äame
, 
boŞ
 
äom_ba
);

84 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


85 
	#SCSC_HIP4_SAMPLER_Q
(
mšÜ
, 
q
, 
idx_rw
, 
v®ue
, 
rw
) \

86 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
q
, 
idx_rw
, 
v®ue
, 
rw
, 0)

	)

88 
	#SCSC_HIP4_SAMPLER_QREF
(
mšÜ
, 
»f
, 
q
) \

89 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_QREF
, (
»f
 & 0xff0000è>> 16, (»à& 0xff00è>> 8, (»à& 0xf0è| 
q
, 0)

	)

91 
	#SCSC_HIP4_SAMPLER_SIGNAL_CTRLTX
(
mšÜ
, 
by‹s16_h
, 
by‹s16_l
) \

92 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_SIGNAL_CTRLTX
, 0, 
by‹s16_h
, 
by‹s16_l
, 0)

	)

94 
	#SCSC_HIP4_SAMPLER_SIGNAL_CTRLRX
(
mšÜ
, 
by‹s16_h
, 
by‹s16_l
) \

95 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_SIGNAL_CTRLRX
, 0, 
by‹s16_h
, 
by‹s16_l
, 0)

	)

97 
	#SCSC_HIP4_SAMPLER_TCP_DECODE
(
sdev
, 
dev
, 
äame
, 
äom_ba
) \

98 
	`h4_§m¶”_tı_decode
(
sdev
, 
dev
, 
äame
, 
äom_ba
)

	)

100 
	#SCSC_HIP4_SAMPLER_THROUG
(
mšÜ
, 
rx_tx
, 
by‹s16_h
, 
by‹s16_l
) \

101 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_THROUG
, 
rx_tx
, 
by‹s16_h
, 
by‹s16_l
, 0)

	)

103 
	#SCSC_HIP4_SAMPLER_THROUG_K
(
mšÜ
, 
rx_tx
, 
by‹s16_h
, 
by‹s16_l
) \

104 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_THROUG_K
, 
rx_tx
, 
by‹s16_h
, 
by‹s16_l
, 0)

	)

106 
	#SCSC_HIP4_SAMPLER_THROUG_M
(
mšÜ
, 
rx_tx
, 
by‹s16_h
, 
by‹s16_l
) \

107 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_THROUG_M
, 
rx_tx
, 
by‹s16_h
, 
by‹s16_l
, 0)

	)

109 
	#SCSC_HIP4_SAMPLER_STOP_Q
(
mšÜ
, 
vif_id
) \

110 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_STOP_Q
, 0, 0, 
vif_id
, 0)

	)

112 
	#SCSC_HIP4_SAMPLER_START_Q
(
mšÜ
, 
vif_id
) \

113 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_START_Q
, 0, 0, 
vif_id
, 0)

	)

115 
	#SCSC_HIP4_SAMPLER_MBULK
(
mšÜ
, 
by‹s16_h
, 
by‹s16_l
, 
şas
) \

116 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_MBULK
, 
şas
, 
by‹s16_h
, 
by‹s16_l
, 0)

	)

118 
	#SCSC_HIP4_SAMPLER_QFULL
(
mšÜ
, 
q
) \

119 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_QFULL
, 0, 0, 
q
, 0)

	)

121 
	#SCSC_HIP4_SAMPLER_MFULL
(
mšÜ
) \

122 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_MFULL
, 0, 0, 0, 0)

	)

124 
	#SCSC_HIP4_SAMPLER_INT
(
mšÜ
, 
id
) \

125 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_INT
, 0, 0, 
id
, 0)

	)

127 
	#SCSC_HIP4_SAMPLER_INT_OUT
(
mšÜ
, 
id
) \

128 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_INT_OUT
, 0, 0, 
id
, 0)

	)

130 
	#SCSC_HIP4_SAMPLER_INT_BH
(
mšÜ
, 
id
) \

131 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_INT_BH
, 0, 0, 
id
, 0)

	)

133 
	#SCSC_HIP4_SAMPLER_INT_OUT_BH
(
mšÜ
, 
id
) \

134 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_INT_OUT_BH
, 0, 0, 
id
, 0)

	)

136 
	#SCSC_HIP4_SAMPLER_RESET
(
mšÜ
) \

137 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_RESET
, 0, 0, 0, 0)

	)

139 
	#SCSC_HIP4_SAMPLER_VIF_PEER
(
mšÜ
, 
tx
, 
vif
, 
³”_šdex
) \

140 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_PEER
, 
tx
, 
vif
, 
³”_šdex
, 0)

	)

142 
	#SCSC_HIP4_SAMPLER_BOT_RX
(
mšÜ
, 
vif
, 
³”_šdex
, 
´i
, 
smod_ªd_scod
) \

143 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_BOT_RX
, 
vif
, 
³”_šdex
, 
´i
, 
smod_ªd_scod
)

	)

145 
	#SCSC_HIP4_SAMPLER_BOT_TX
(
mšÜ
, 
vif
, 
³”_šdex
, 
´i
, 
smod_ªd_scod
) \

146 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_BOT_TX
, 
vif
, 
³”_šdex
, 
´i
, 
smod_ªd_scod
)

	)

148 
	#SCSC_HIP4_SAMPLER_BOT_ADD
(
mšÜ
, 
vif
, 
³”_šdex
, 
addr_0_to_3
) \

149 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_BOT_ADD
, 
vif
, 
³”_šdex
, 0, 
addr_0_to_3
)

	)

151 
	#SCSC_HIP4_SAMPLER_BOT_REMOVE
(
mšÜ
, 
vif
, 
³”_šdex
) \

152 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_BOT_REMOVE
, 
vif
, 
³”_šdex
, 0, 0)

	)

154 
	#SCSC_HIP4_SAMPLER_BOT_START_Q
(
mšÜ
, 
vif
, 
³”_šdex
) \

155 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_BOT_START_Q
, 
vif
, 
³”_šdex
, 0, 0)

	)

157 
	#SCSC_HIP4_SAMPLER_BOT_STOP_Q
(
mšÜ
, 
vif
, 
³”_šdex
) \

158 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_BOT_STOP_Q
, 
vif
, 
³”_šdex
, 0, 0)

	)

160 
	#SCSC_HIP4_SAMPLER_BOT_QMOD_RX
(
mšÜ
, 
vif
, 
³”_šdex
, 
´i
, 
qmod_ªd_qcod
) \

161 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_BOT_QMOD_RX
, 
vif
, 
³”_šdex
, 
´i
, 
qmod_ªd_qcod
)

	)

163 
	#SCSC_HIP4_SAMPLER_BOT_QMOD_TX
(
mšÜ
, 
vif
, 
³”_šdex
, 
´i
, 
qmod_ªd_qcod
) \

164 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_BOT_QMOD_TX
, 
vif
, 
³”_šdex
, 
´i
, 
qmod_ªd_qcod
)

	)

166 
	#SCSC_HIP4_SAMPLER_BOT_QMOD_START
(
mšÜ
, 
vif
, 
³”_šdex
, 
´iÜ™y
) \

167 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_BOT_QMOD_START
, 
vif
, 
³”_šdex
, 
´iÜ™y
, 0)

	)

169 
	#SCSC_HIP4_SAMPLER_BOT_QMOD_STOP
(
mšÜ
, 
vif
, 
³”_šdex
, 
´iÜ™y
) \

170 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_BOT_QMOD_STOP
, 
vif
, 
³”_šdex
, 
´iÜ™y
, 0)

	)

172 
	#SCSC_HIP4_SAMPLER_PKT_TX
(
mšÜ
, 
ho¡_g
) \

173 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_PKT_TX
, 0, (
ho¡_g
 >> 8è& 0xff, ho¡_g & 0xff, 0)

	)

175 
	#SCSC_HIP4_SAMPLER_PKT_TX_HIP4
(
mšÜ
, 
ho¡_g
) \

176 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_PKT_TX_HIP4
, 0, (
ho¡_g
 >> 8è& 0xff, ho¡_g & 0xff, 0)

	)

178 
	#SCSC_HIP4_SAMPLER_PKT_TX_FB
(
mšÜ
, 
ho¡_g
) \

179 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_PKT_TX_FB
, 0, (
ho¡_g
 >> 8è& 0xff, ho¡_g & 0xff, 0)

	)

181 
	#SCSC_HIP4_SAMPLER_SUSPEND
(
mšÜ
) \

182 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_SUSPEND
, 0, 0, 0, 0)

	)

184 
	#SCSC_HIP4_SAMPLER_RESUME
(
mšÜ
) \

185 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_RESUME
, 0, 0, 0, 0)

	)

187 
	#SCSC_HIP4_SAMPLER_TCP_SYN
(
mšÜ
, 
id
, 
mss
) \

188 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_TCP_SYN
, 
id
, 0, 0, 
mss
)

	)

190 
	#SCSC_HIP4_SAMPLER_TCP_FIN
(
mšÜ
, 
id
) \

191 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_TCP_FIN
, 
id
, 0, 0, 0)

	)

193 
	#SCSC_HIP4_SAMPLER_TCP_DATA
(
mšÜ
, 
id
, 
£q_num
) \

194 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_TCP_DATA
, 
id
, 0, 0, 
£q_num
)

	)

196 
	#SCSC_HIP4_SAMPLER_TCP_ACK
(
mšÜ
, 
id
, 
ack_num
) \

197 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_TCP_ACK
, 
id
, 0, 0, 
ack_num
)

	)

199 
	#SCSC_HIP4_SAMPLER_TCP_DATA_IN
(
mšÜ
, 
id
, 
£q_num
) \

200 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_TCP_DATA_IN
, 
id
, 0, 0, 
£q_num
)

	)

202 
	#SCSC_HIP4_SAMPLER_TCP_ACK_IN
(
mšÜ
, 
id
, 
ack_num
) \

203 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_TCP_ACK_IN
, 
id
, 0, 0, 
ack_num
)

	)

205 
	#SCSC_HIP4_SAMPLER_TCP_RWND
(
mšÜ
, 
id
, 
rwnd
) \

206 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_TCP_RWND
, 
id
, 0, 0, 
rwnd
)

	)

208 
	#SCSC_HIP4_SAMPLER_TCP_CWND
(
mšÜ
, 
id
, 
cwnd
) \

209 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_TCP_CWND
, 
id
, 0, 0, 
cwnd
)

	)

211 
	#SCSC_HIP4_SAMPLER_TCP_SEND_BUF
(
mšÜ
, 
id
, 
£nd_buff_size
) \

212 
	`h4_§m¶”_upd©e_»cÜd
(
mšÜ
, 
HIP4_SAMPLER_TCP_SEND_BUF
, 
id
, 0, 0, 
£nd_buff_size
)

	)

215 
	#SCSC_HIP4_SAMPLER_Q
(
mšÜ
, 
q
, 
idx_rw
, 
v®ue
, 
rw
)

	)

216 
	#SCSC_HIP4_SAMPLER_QREF
(
mšÜ
, 
»f
, 
q
)

	)

217 
	#SCSC_HIP4_SAMPLER_SIGNAL_CTRLTX
(
mšÜ
, 
by‹s16_h
, 
by‹s16_l
)

	)

218 
	#SCSC_HIP4_SAMPLER_SIGNAL_CTRLRX
(
mšÜ
, 
by‹s16_h
, 
by‹s16_l
)

	)

219 
	#SCSC_HIP4_SAMPLER_TPUT
(
mšÜ
, 
rx_tx
, 
·ylßd
)

	)

220 
	#SCSC_HIP4_SAMPLER_THROUG
(
mšÜ
, 
by‹s16_h
, 
by‹s16_l
)

	)

221 
	#SCSC_HIP4_SAMPLER_THROUG_K
(
mšÜ
, 
by‹s16_h
, 
by‹s16_l
)

	)

222 
	#SCSC_HIP4_SAMPLER_THROUG_M
(
mšÜ
, 
by‹s16_h
, 
by‹s16_l
)

	)

223 
	#SCSC_HIP4_SAMPLER_MBULK
(
mšÜ
, 
by‹s16_h
, 
by‹s16_l
, 
şas
)

	)

224 
	#SCSC_HIP4_SAMPLER_QFULL
(
mšÜ
, 
q
)

	)

225 
	#SCSC_HIP4_SAMPLER_MFULL
(
mšÜ
)

	)

226 
	#SCSC_HIP4_SAMPLER_INT
(
mšÜ
, 
id
)

	)

227 
	#SCSC_HIP4_SAMPLER_INT_BH
(
mšÜ
, 
id
)

	)

228 
	#SCSC_HIP4_SAMPLER_INT_OUT
(
mšÜ
, 
id
)

	)

229 
	#SCSC_HIP4_SAMPLER_INT_OUT_BH
(
mšÜ
, 
id
)

	)

230 
	#SCSC_HIP4_SAMPLER_RESET
(
mšÜ
)

	)

231 
	#SCSC_HIP4_SAMPLER_VIF_PEER
(
mšÜ
, 
tx
, 
vif
, 
³”_šdex
)

	)

232 
	#SCSC_HIP4_SAMPLER_BOT_RX
(
mšÜ
, 
vif
, 
³”_šdex
, 
´i
, 
smod_ªd_scod
)

	)

233 
	#SCSC_HIP4_SAMPLER_BOT_TX
(
mšÜ
, 
vif
, 
³”_šdex
, 
´i
, 
smod_ªd_scod
)

	)

234 
	#SCSC_HIP4_SAMPLER_BOT_ADD
(
mšÜ
, 
vif
, 
³”_šdex
, 
addr_0_to_3
)

	)

235 
	#SCSC_HIP4_SAMPLER_BOT_REMOVE
(
mšÜ
, 
vif
, 
³”_šdex
)

	)

236 
	#SCSC_HIP4_SAMPLER_BOT_START_Q
(
mšÜ
, 
vif
, 
³”_šdex
)

	)

237 
	#SCSC_HIP4_SAMPLER_BOT_STOP_Q
(
mšÜ
, 
vif
, 
³”_šdex
)

	)

238 
	#SCSC_HIP4_SAMPLER_BOT_QMOD_RX
(
mšÜ
, 
vif
, 
³”_šdex
, 
´i
, 
qmod_ªd_qcod
)

	)

239 
	#SCSC_HIP4_SAMPLER_BOT_QMOD_TX
(
mšÜ
, 
vif
, 
³”_šdex
, 
´i
, 
qmod_ªd_qcod
)

	)

240 
	#SCSC_HIP4_SAMPLER_BOT_QMOD_START
(
mšÜ
, 
vif
, 
³”_šdex
, 
´iÜ™y
)

	)

241 
	#SCSC_HIP4_SAMPLER_BOT_QMOD_STOP
(
mšÜ
, 
vif
, 
³”_šdex
, 
´iÜ™y
)

	)

242 
	#SCSC_HIP4_SAMPLER_PKT_TX
(
mšÜ
, 
ho¡_g
)

	)

243 
	#SCSC_HIP4_SAMPLER_PKT_TX_HIP4
(
mšÜ
, 
ho¡_g
)

	)

244 
	#SCSC_HIP4_SAMPLER_PKT_TX_FB
(
mšÜ
, 
ho¡_g
)

	)

245 
	#SCSC_HIP4_SAMPLER_SUSPEND
(
mšÜ
)

	)

246 
	#SCSC_HIP4_SAMPLER_RESUME
(
mšÜ
)

	)

247 
	#SCSC_HIP4_SAMPLER_TCP_SYN
(
mšÜ
, 
id
, 
mss
)

	)

248 
	#SCSC_HIP4_SAMPLER_TCP_FIN
(
mšÜ
, 
id
)

	)

249 
	#SCSC_HIP4_SAMPLER_TCP_DATA
(
mšÜ
, 
id
, 
£q_num
)

	)

250 
	#SCSC_HIP4_SAMPLER_TCP_ACK
(
mšÜ
, 
id
, 
ack_num
)

	)

251 
	#SCSC_HIP4_SAMPLER_TCP_DATA_IN
(
mšÜ
, 
id
, 
£q_num
)

	)

252 
	#SCSC_HIP4_SAMPLER_TCP_ACK_IN
(
mšÜ
, 
id
, 
ack_num
)

	)

253 
	#SCSC_HIP4_SAMPLER_TCP_RWND
(
mšÜ
, 
id
, 
rwnd
)

	)

254 
	#SCSC_HIP4_SAMPLER_TCP_CWND
(
mšÜ
, 
id
, 
cwnd
)

	)

255 
	#SCSC_HIP4_SAMPLER_TCP_SEND_BUF
(
mšÜ
, 
id
, 
£nd_buff_size
)

	)

256 
	#SCSC_HIP4_SAMPLER_TCP_DECODE
(
sdev
, 
dev
, 
äame
, 
äom_ba
)

	)

260 
	#SCSC_HIP4_SAMPLER_HEADER_VERSION_MAJOR
 0x01

	)

261 
	#SCSC_HIP4_SAMPLER_HEADER_VERSION_MINOR
 0x01

	)

263 
	#SCSC_HIP4_SAMPLER_RESERVED
 (1)

	)

264 
	#SCSC_HIP4_SAMPLER_RESERVED_2
 (10)

	)

266 
	#SCSC_HIP4_SAMPLER_MAGIC
 "HIP4"

	)

268 
	escsc_h4_§m¶”_ty³
 {

269 
	mSCSC_HIP4_SAMPLER_TYPE_PRE_TCP
 = 0,

270 
	mSCSC_HIP4_SAMPLER_TYPE_TCP
,

274 
	escsc_h4_§m¶”_¶©fÜm
 {

275 
	mSCSC_HIP4_SAMPLER_EXYNOS9610
 = 1,

276 
	mSCSC_HIP4_SAMPLER_EXYNOS9630
,

277 
	mSCSC_HIP4_SAMPLER_EXYNOS7885
,

279 
	mSCSC_HIP4_SAMPLER_UNDEF
 = 0xffff

283 
	sscsc_h4_§m¶”_h—d”
 {

284 
	mmagic
[4];

285 
u16
 
	moff£t_d©a
;

286 
u8
 
	mv”siÚ_majÜ
;

287 
u8
 
	mv”siÚ_mšÜ
;

288 
u16
 
	m¶©fÜm
;

289 
u8
 
	m§m¶e_ty³
;

290 
u8
 
	m»£rved
[
SCSC_HIP4_SAMPLER_RESERVED
];

291 
u16
 
	mh4_¡©us
;

292 
u64
 
	mnum_§m¶es
;

293 
u8
 
	m»£rved_2
[
SCSC_HIP4_SAMPLER_RESERVED_2
];

294 } 
	g__·cked
;

	@hip4_smapper.c

7 
	~<scsc/scsc_mx.h
>

8 
	~<scsc/scsc_miäam.h
>

9 
	~<scsc/scsc_logršg.h
>

10 
	~<lšux/¿‹lim™.h
>

12 
	~"debug.h
"

13 
	~"dev.h
"

14 
	~"h4.h
"

15 
	~"h4_sm­³r.h
"

17 
	#SMAPPER_GRANULARITY
 (4 * 1024)

	)

19 
h4_sm­³r_»fl_i¤
(
œq
, *
d©a
);

21 
	$h4_sm­³r_®loc_bªk
(
¦si_dev
 *
sdev
, 
h4_´iv
 *
´iv
, 
sm­³r_bªks
 
bªk_Çme
, 
u32
 
’Œy_size
, 
boŞ
 
is_Ïrge
)

23 
u16
 
i
;

24 
h4_sm­³r_bªk
 *
bªk
 = &(
´iv
)->
sm­³r_bªks
[
bªk_Çme
];

25 
h4_sm­³r_cÚŒŞ
 *
cÚŒŞ
 = &(
´iv
)->
sm­³r_cÚŒŞ
;

26 
”r
;

28 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "In™ bªk %dƒÁry_siz%d is_Ïrg%d\n", 
bªk_Çme
, 
’Œy_size
, 
is_Ïrge
);

29 
bªk
->
’Œy_size
 =ƒntry_size;

32 
”r
 = 
	`scsc_£rviû_mifsm­³r_®loc_bªk
(
sdev
->
£rviû
, 
is_Ïrge
, 
bªk
->
’Œy_size
, &bªk->
’Œ›s
);

33 ià(
”r
 < 0) {

34 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "E¼Ü‡Îoÿtšg bªk %d\n", 
”r
);

35  -
ENOMEM
;

38 
bªk
->bªk = (
u32
)
”r
;

39 ià(
bªk
->bªk >ğ
HIP4_SMAPPER_TOTAL_BANKS
) {

40 
	`scsc_£rviû_mifsm­³r_ä“_bªk
(
sdev
->
£rviû
, 
bªk
->bank);

41 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "IncÜ»ù bªk_num %d\n", 
bªk
->bank);

42  -
ENOMEM
;

45 
bªk
->
skbuff
 = 
	`km®loc_¬¿y
(bªk->
’Œ›s
, (
sk_buff
 *),

46 
GFP_KERNEL
);

47 
bªk
->
skbuff_dma
 = 
	`km®loc_¬¿y
(bªk->
’Œ›s
, (
dma_addr_t
),

48 
GFP_KERNEL
);

49 ià(!
bªk
->
skbuff
 || !bªk->
skbuff_dma
) {

50 
	`kä“
(
bªk
->
skbuff_dma
);

51 
	`kä“
(
bªk
->
skbuff
);

52  -
ENOMEM
;

55 
i
 = 0; i < 
bªk
->
’Œ›s
; i++)

56 
bªk
->
skbuff
[
i
] = 
NULL
;

58 
bªk
->
®ign
 = 
	`scsc_£rviû_g‘_®ignm’t
(
sdev
->
£rviû
);

59 
bªk
->
š_u£
 = 
Œue
;

62 
cÚŒŞ
->
looku±abË
[
bªk
->bªk] = 
bªk_Çme
;

65 
	}
}

67 
	$h4_sm­³r_®loÿ‹_skb_bufãr_’Œy
(
¦si_dev
 *
sdev
, 
h4_sm­³r_bªk
 *
bªk
, 
idx
)

69 
sk_buff
 *
skb
;

70 
”r
;

72 
skb
 = 
	`®loc_skb
(
bªk
->
’Œy_size
, 
GFP_ATOMIC
);

73 ià(!
skb
) {

74 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "Notƒnough memory\n");

75  -
ENOMEM
;

78 
	`¦si_skb_cb_š™
(
skb
);

79 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "SKB‡Îoÿ‹d: 0x%°© bªk %dƒÁry %d\n", 
skb
, 
bªk
->bªk, 
idx
);

80 
bªk
->
skbuff_dma
[
idx
] = 
	`dma_m­_sšgË
(
sdev
->
dev
, 
skb
->
d©a
,

81 
bªk
->
’Œy_size
, 
DMA_FROM_DEVICE
);

82 
”r
 = 
	`dma_m­pšg_”rÜ
(
sdev
->
dev
, 
bªk
->
skbuff_dma
[
idx
]);

83 ià(
”r
) {

84 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "E¼Ü m­pšg SKB: 0x%°© bªk %dƒÁry %d\n", 
skb
, 
bªk
->bªk, 
idx
);

85 
	`kä“_skb
(
skb
);

86  
”r
;

90 ià(!
	`IS_ALIGNED
(
bªk
->
skbuff_dma
[
idx
], bªk->
®ign
)) {

91 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "Phys‡ddress: 0x%x‚ot %d‡ligned. Unmap memory‡nd„eturnƒrror\n",

92 
bªk
->
skbuff_dma
[
idx
], bªk->
®ign
);

93 
	`dma_unm­_sšgË
(
sdev
->
dev
, 
bªk
->
skbuff_dma
[
idx
], bªk->
’Œy_size
, 
DMA_FROM_DEVICE
);

94 
	`kä“_skb
(
skb
);

95 
bªk
->
skbuff_dma
[
idx
] = 0;

96  -
ENOMEM
;

98 
bªk
->
skbuff
[
idx
] = 
skb
;

100 
	}
}

103 
	$h4_sm­³r_®loÿ‹_skb_bufãrs
(
¦si_dev
 *
sdev
, 
h4_sm­³r_bªk
 *
bªk
)

105 
i
;

106 
n
;

107 
»s
;

109 ià(!
bªk
)

110  -
EINVAL
;

112 
n
 = 
bªk
->
’Œ›s
;

113 
i
 = 0; i < 
n
; i++) {

114 ià(!
bªk
->
skbuff
[
i
]) {

115 
»s
 = 
	`h4_sm­³r_®loÿ‹_skb_bufãr_’Œy
(
sdev
, 
bªk
, 
i
);

116 ià(
»s
 != 0)

117  
»s
;

122 
	}
}

124 
	$h4_sm­³r_ä“_skb_bufãrs
(
¦si_dev
 *
sdev
, 
h4_sm­³r_bªk
 *
bªk
)

126 
i
;

127 
n
;

129 ià(!
bªk
)

130  -
EINVAL
;

132 
n
 = 
bªk
->
’Œ›s
;

133 
i
 = 0; i < 
n
; i++) {

134 ià(
bªk
->
skbuff
[
i
]) {

135 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "SKB f»e: 0x%°© bªk %dƒÁry %d\n", 
bªk
->
skbuff
[
i
], bank->bank, i);

136 
	`dma_unm­_sšgË
(
sdev
->
dev
, 
bªk
->
skbuff_dma
[
i
], bªk->
’Œy_size
, 
DMA_FROM_DEVICE
);

137 
bªk
->
skbuff_dma
[
i
] = 0;

138 
	`kä“_skb
(
bªk
->
skbuff
[
i
]);

139 
bªk
->
skbuff
[
i
] = 
NULL
;

144 
	}
}

146 
	$h4_sm­³r_´og¿m
(
¦si_dev
 *
sdev
, 
h4_sm­³r_bªk
 *
bªk
)

148 
n
;

150 ià(!
bªk
)

151  -
EINVAL
;

153 
n
 = 
bªk
->
’Œ›s
;

155 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "Prog¿mmšg Bªk %d\n", 
bªk
->bank);

157  
	`scsc_£rviû_mifsm­³r_wr™e_¤am
(
sdev
->
£rviû
, 
bªk
->bªk, 
n
, 0, bªk->
skbuff_dma
);

158 
	}
}

162 
	$h4_sm­³r_»fl_i¤
(
œq
, *
d©a
)

164 
¦si_h4
 *
h
 = (¦si_h4 *)
d©a
;

165 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

166 
h4_sm­³r_cÚŒŞ
 *
cÚŒŞ
;

167 
h4_sm­³r_bªk
 *
bªk
;

168 
sm­³r_bªks
 
i
;

169 
æags
;

174 
cÚŒŞ
 = &(
h
->
h_´iv
->
sm­³r_cÚŒŞ
);

175 #ifdeà
CONFIG_SCSC_QOS


177 ià(
h
->
h_´iv
->
pm_qos_¡©e
 =ğ
SCSC_QOS_DISABLED
 ||

178 
	`©omic_»ad
(&
h
->
h_´iv
->
š_su¥’d
) ||

179 *
cÚŒŞ
->
mbox_±r
 == 0x0) {

182 ià(
	`©omic_»ad
(&
h
->
h_´iv
->
š_su¥’d
) ||

183 *
cÚŒŞ
->
mbox_±r
 == 0x0) {

191 
	`scsc_£rviû_mifšŒb™_b™_ş—r
(
sdev
->
£rviû
, 
cÚŒŞ
->
th_»q
);

195 
	`¥š_lock_œq§ve
(&
cÚŒŞ
->
sm­³r_lock
, 
æags
);

197 ià(
	`HIP4_SMAPPER_BANKS_CHECK_CONFIGURE
(*
cÚŒŞ
->
mbox_±r
)) {

201 
	`scsc_£rviû_mifsm­³r_cÚfigu»
(
sdev
->
£rviû
, 
SMAPPER_GRANULARITY
);

202 
	`HIP4_SMAPPER_BANKS_CONFIGURE_DONE
(*
cÚŒŞ
->
mbox_±r
);

205 
i
 = 
RX_0
; i < 
END_RX_BANKS
; i++) {

206 
bªk
 = &
h
->
h_´iv
->
sm­³r_bªks
[
i
];

208 ià(!
bªk
->
š_u£
)

211 ià(
	`HIP4_SMAPPER_GET_BANK_OWNER
(
bªk
->bªk, *
cÚŒŞ
->
mbox_±r
è=ğ
HIP_SMAPPER_OWNER_HOST
) {

215 ià(
	`h4_sm­³r_®loÿ‹_skb_bufãrs
(
sdev
, 
bªk
)) {

219 
	`HIP4_SMAPPER_SET_BANK_OWNER
(
bªk
->bªk, *
cÚŒŞ
->
mbox_±r
, 
HIP_SMAPPER_OWNER_FW
);

222 ià(
	`h4_sm­³r_´og¿m
(
sdev
, 
bªk
)) {

226 
	`HIP4_SMAPPER_SET_BANK_OWNER
(
bªk
->bªk, *
cÚŒŞ
->
mbox_±r
, 
HIP_SMAPPER_OWNER_FW
);

229 
	`HIP4_SMAPPER_SET_BANK_STATE
(
bªk
->bªk, *
cÚŒŞ
->
mbox_±r
, 
HIP_SMAPPER_STATUS_MAPPED
);

230 
	`HIP4_SMAPPER_SET_BANK_OWNER
(
bªk
->bªk, *
cÚŒŞ
->
mbox_±r
, 
HIP_SMAPPER_OWNER_FW
);

234 
	`scsc_£rviû_mifšŒb™_b™_£t
(
sdev
->
£rviû
, 
cÚŒŞ
->
fh_šd
, 
SCSC_MIFINTR_TARGET_R4
);

237 
	`scsc_£rviû_mifšŒb™_b™_ş—r
(
sdev
->
£rviû
, 
cÚŒŞ
->
th_»q
);

239 
	`¥š_uÆock_œq»¡Üe
(&
cÚŒŞ
->
sm­³r_lock
, 
æags
);

240 
	}
}

242 
	$h4_sm­³r_cÚsume_’Œy
(
¦si_dev
 *
sdev
, 
¦si_h4
 *
h
, 
sk_buff
 *
skb_çpi
)

244 
sk_buff
 *
skb
;

245 
sk_buff
 *
skb_big
 = 
NULL
;

246 
h4_sm­³r_bªk
 *
bªk
;

247 
u8
 
i
;

248 
u8
 
bªk_num
;

249 
u8
 
’Œy
;

250 
u8
 
num_’Œ›s
;

251 
u16
 
Ën
;

252 
u16
 
h—droom
;

253 
h4_sm­³r_desütÜ
 *
desc
;

254 
h4_sm­³r_cÚŒŞ
 *
cÚŒŞ
;

255 
¦si_skb_cb
 *
cb
 = 
	`¦si_skb_cb_g‘
(
skb_çpi
);

257 
cÚŒŞ
 = &(
h
->
h_´iv
->
sm­³r_cÚŒŞ
);

259 
desc
 = (
h4_sm­³r_desütÜ
 *)
skb_çpi
->
d©a
;

261 
bªk_num
 = 
desc
->bank_num;

262 
’Œy
 = 
desc
->
’Œy_num
;

263 
Ën
 = 
desc
->
’Œy_size
;

264 
h—droom
 = 
desc
->headroom;

267 ià(
bªk_num
 >ğ
HIP4_SMAPPER_TOTAL_BANKS
) {

268 
	`SLSI_WARN_NODEV
("IncÜ»ù bªk_num %d\n", 
bªk_num
);

269 
”rÜ
;

273 
bªk_num
 = 
cÚŒŞ
->
looku±abË
[bank_num];

275 
bªk
 = &
h
->
h_´iv
->
sm­³r_bªks
[
bªk_num
];

277 ià(
’Œy
 > 
bªk
->
’Œ›s
) {

278 
	`SLSI_WARN_NODEV
("IncÜ»ùƒÁry‚umb” %d\n", 
’Œy
);

279 
”rÜ
;

282 ià(
Ën
 > 
bªk
->
’Œy_size
) {

285 
num_’Œ›s
 = 
	`DIV_ROUND_UP
(
Ën
, 
bªk
->
’Œy_size
);

287 ià((
’Œy
 + 
num_’Œ›s
è> 
bªk
->
’Œ›s
) {

288 
	`SLSI_WARN_NODEV
("IncÜ»ùƒÁry‚umb” %d‚um_’Œ› %d\n", 
’Œy
, 
num_’Œ›s
);

289 
”rÜ
;

293 
skb_big
 = 
	`®loc_skb
(
Ën
, 
GFP_ATOMIC
);

294 ià(!
skb_big
) {

295 
	`SLSI_WARN_NODEV
("big SKB‡ÎoÿtiÚ faed†’:%d\n", 
Ën
);

296 
”rÜ
;

298 
muÉi
;

301 
skb
 = 
bªk
->
skbuff
[
’Œy
];

302 ià(!
skb
) {

303 
	`SLSI_WARN_NODEV
("SKB i NULL‡ˆbªk %dƒÁry %d\n", 
bªk_num
, 
’Œy
);

304 
”rÜ
;

307 
bªk
->
skbuff
[
’Œy
] = 
NULL
;

308 
	`dma_unm­_sšgË
(
sdev
->
dev
, 
bªk
->
skbuff_dma
[
’Œy
], bªk->
’Œy_size
, 
DMA_FROM_DEVICE
);

309 
bªk
->
skbuff_dma
[
’Œy
] = 0;

311 
	`h4_sm­³r_®loÿ‹_skb_bufãr_’Œy
(
sdev
, 
bªk
, 
’Œy
);

313 
	`skb_»£rve
(
skb
, 
h—droom
);

314 
	`skb_put
(
skb
, 
Ën
);

315 
cb
->
skb_addr
 = 
skb
;

316 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "CÚsumed Bªk %d EÁry %d L’ %d SKB sm­³r: 0x%p, SKB f­˜%p\n", 
bªk_num
, 
’Œy
, 
Ën
, 
skb
, 
skb_çpi
);

318 
muÉi
:

319 
i
 = 0; i < 
num_’Œ›s
; i++, 
’Œy
++) {

320 
u16
 
by‹s
;

322 
skb
 = 
bªk
->
skbuff
[
’Œy
];

323 ià(!
skb
) {

324 
	`SLSI_WARN_NODEV
("SKB IS NULL‡ˆbªk %dƒÁry %d\n", 
bªk_num
, 
’Œy
);

325 
”rÜ
;

328 
bªk
->
skbuff
[
’Œy
] = 
NULL
;

329 
	`dma_unm­_sšgË
(
sdev
->
dev
, 
bªk
->
skbuff_dma
[
’Œy
], bªk->
’Œy_size
, 
DMA_FROM_DEVICE
);

330 
bªk
->
skbuff_dma
[
’Œy
] = 0;

332 
	`h4_sm­³r_®loÿ‹_skb_bufãr_’Œy
(
sdev
, 
bªk
, 
’Œy
);

334 ià(
Ën
 > 
bªk
->
’Œy_size
)

335 
by‹s
 = 
bªk
->
’Œy_size
 - 
h—droom
;

337 
by‹s
 = 
Ën
;

340 ià(
i
 == 0)

341 
	`skb_»£rve
(
skb
, 
h—droom
);

344 
	`memıy
(
	`skb_put
(
skb_big
, 
by‹s
), 
skb
->
d©a
, bytes);

347 
	`kä“_skb
(
skb
);

348 
Ën
 -ğ
by‹s
;

350 
cb
->
skb_addr
 = 
skb_big
;

351 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "CÚsumed Bªk %d EÁry %d L’ %d SKB sm­³r: 0x%p, SKB f­˜%p\n", 
bªk_num
, 
’Œy
, 
Ën
, 
skb
, 
skb_çpi
);

353 
”rÜ
:

355 ià(
skb_big
)

356 
	`kä“_skb
(
skb_big
);

357  -
EIO
;

358 
	}
}

360 *
	$h4_sm­³r_g‘_skb_d©a
(
¦si_dev
 *
sdev
, 
¦si_h4
 *
h
, 
sk_buff
 *
skb_çpi
)

362 
sk_buff
 *
skb
;

363 
¦si_skb_cb
 *
cb
 = 
	`¦si_skb_cb_g‘
(
skb_çpi
);

364 
h4_sm­³r_cÚŒŞ
 *
cÚŒŞ
;

366 
cÚŒŞ
 = &(
h
->
h_´iv
->
sm­³r_cÚŒŞ
);

368 
skb
 = (
sk_buff
 *)
cb
->
skb_addr
;

370 ià(!
skb
) {

371 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "NULL SKB smapper\n");

372  
NULL
;

375 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "G‘ SKB sm­³r: 0x%p, SKB f­˜0x%p\n", 
skb
, 
skb_çpi
);

376  
skb
->
d©a
;

377 
	}
}

379 
sk_buff
 *
	$h4_sm­³r_g‘_skb
(
¦si_dev
 *
sdev
, 
¦si_h4
 *
h
, 
sk_buff
 *
skb_çpi
)

381 
sk_buff
 *
skb
;

382 
¦si_skb_cb
 *
cb
 = 
	`¦si_skb_cb_g‘
(
skb_çpi
);

383 
h4_sm­³r_cÚŒŞ
 *
cÚŒŞ
;

385 
cÚŒŞ
 = &(
h
->
h_´iv
->
sm­³r_cÚŒŞ
);

387 
skb
 = (
sk_buff
 *)
cb
->
skb_addr
;

389 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "G‘ SKB sm­³r: 0x%p, SKB f­˜0x%p\n", 
skb
, 
skb_çpi
);

390 
cb
->
ä“_ma_un™d©
 = 
Œue
;

391 
	`kä“_skb
(
skb_çpi
);

393  
skb
;

394 
	}
}

396 
	$h4_sm­³r_ä“_m­³d_skb
(
sk_buff
 *
skb
)

398 
¦si_skb_cb
 *
cb
;

400 ià(!
skb
)

403 
cb
 = (
¦si_skb_cb
 *)
skb
->cb;

405 ià(
cb
 && !cb->
ä“_ma_un™d©
 && cb->
skb_addr
) {

406 
	`kä“_skb
(
cb
->
skb_addr
);

407 
cb
->
skb_addr
 = 
NULL
;

409 
	}
}

411 
	$h4_sm­³r_š™
(
¦si_dev
 *
sdev
, 
¦si_h4
 *
h
)

413 
u8
 
i
;

414 
h4_sm­³r_cÚŒŞ
 *
cÚŒŞ
;

416 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "SMAPPER init\n");

418 
cÚŒŞ
 = &(
h
->
h_´iv
->
sm­³r_cÚŒŞ
);

420 
	`¥š_lock_š™
(&
cÚŒŞ
->
sm­³r_lock
);

422 ià(
	`dma_£t_mask_ªd_coh”’t
(
sdev
->
dev
, 
	`DMA_BIT_MASK
(64)) != 0)

423  -
EIO
;

425 ià(!
	`scsc_mx_£rviû_®loc_mboxes
(
sdev
->
£rviû
, 1, &
cÚŒŞ
->
mbox_scb
)) {

426 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "Unableo‡llocate mbox\n");

427  -
ENODEV
;

431 
	`h4_sm­³r_®loc_bªk
(
sdev
, 
h
->
h_´iv
, 
RX_0
, 
SMAPPER_GRANULARITY
, 
HIP4_SMAPPER_BANK_LARGE
);

432 
	`h4_sm­³r_®loc_bªk
(
sdev
, 
h
->
h_´iv
, 
RX_1
, 
SMAPPER_GRANULARITY
, 
HIP4_SMAPPER_BANK_LARGE
);

433 
	`h4_sm­³r_®loc_bªk
(
sdev
, 
h
->
h_´iv
, 
RX_2
, 
SMAPPER_GRANULARITY
, 
HIP4_SMAPPER_BANK_LARGE
);

434 
	`h4_sm­³r_®loc_bªk
(
sdev
, 
h
->
h_´iv
, 
RX_3
, 
SMAPPER_GRANULARITY
, 
HIP4_SMAPPER_BANK_LARGE
);

436 
	`h4_sm­³r_®loÿ‹_skb_bufãrs
(
sdev
, &
h
->
h_´iv
->
sm­³r_bªks
[
RX_0
]);

437 
	`h4_sm­³r_®loÿ‹_skb_bufãrs
(
sdev
, &
h
->
h_´iv
->
sm­³r_bªks
[
RX_1
]);

438 
	`h4_sm­³r_®loÿ‹_skb_bufãrs
(
sdev
, &
h
->
h_´iv
->
sm­³r_bªks
[
RX_2
]);

439 
	`h4_sm­³r_®loÿ‹_skb_bufãrs
(
sdev
, &
h
->
h_´iv
->
sm­³r_bªks
[
RX_3
]);

442 
cÚŒŞ
->
th_»q
 =

443 
	`scsc_£rviû_mifšŒb™_»gi¡”_toho¡
(
sdev
->
£rviû
, 
h4_sm­³r_»fl_i¤
, 
h
);

444 
cÚŒŞ
->
fh_šd
 =

445 
	`scsc_£rviû_mifšŒb™_®loc_äomho¡
(
sdev
->
£rviû
, 
SCSC_MIFINTR_TARGET_R4
);

447 
cÚŒŞ
->
mbox_±r
 =

448 
	`scsc_mx_£rviû_g‘_mbox_±r
(
sdev
->
£rviû
, 
cÚŒŞ
->
mbox_scb
);

451 *
cÚŒŞ
->
mbox_±r
 = 0x0;

454 
h
->
h_cÚŒŞ
->
cÚfig_v4
.
sm­³r_th_»q
 =

455 
cÚŒŞ
->
th_»q
;

456 
h
->
h_cÚŒŞ
->
cÚfig_v4
.
sm­³r_fh_šd
 =

457 
cÚŒŞ
->
fh_šd
;

458 
h
->
h_cÚŒŞ
->
cÚfig_v4
.
sm­³r_mbox_scb
 =

459 (
u8
)
cÚŒŞ
->
mbox_scb
;

461 
i
 = 
RX_0
; i < 
END_RX_BANKS
; i++) {

462 
u8
 
has_’Œ›s
;

463 
u8
 
bªk
;

465 
has_’Œ›s
 = 
h
->
h_´iv
->
sm­³r_bªks
[
i
].
’Œ›s
;

466 ià(
has_’Œ›s
) {

468 
bªk
 = 
h
->
h_´iv
->
sm­³r_bªks
[
i
].bank;

469 
h
->
h_cÚŒŞ
->
cÚfig_v4
.
sm­³r_bªk_addr
[
bªk
] = 
	`scsc_£rviû_mifsm­³r_g‘_bªk_ba£_add»ss
(
sdev
->
£rviû
, bank);

470 
h
->
h_cÚŒŞ
->
cÚfig_v4
.
sm­³r_’Œ›s_bªks
[
bªk
] = 
has_’Œ›s
;

471 
h
->
h_cÚŒŞ
->
cÚfig_v4
.
sm­³r_pow_sz
[
bªk
] = 12;

475 
	}
}

477 
	$h4_sm­³r_deš™
(
¦si_dev
 *
sdev
, 
¦si_h4
 *
h
)

479 
h4_sm­³r_bªk
 *
bªk
;

480 
h4_sm­³r_cÚŒŞ
 *
cÚŒŞ
;

481 
æags
;

482 
u8
 
i
;

484 
	`SLSI_DBG4_NODEV
(
SLSI_SMAPPER
, "SMAPPER deinit\n");

485 
cÚŒŞ
 = &(
h
->
h_´iv
->
sm­³r_cÚŒŞ
);

487 
	`¥š_lock_œq§ve
(&
cÚŒŞ
->
sm­³r_lock
, 
æags
);

488 
i
 = 
RX_0
; i < 
END_RX_BANKS
; i++) {

489 
bªk
 = &
h
->
h_´iv
->
sm­³r_bªks
[
i
];

490 
bªk
->
š_u£
 = 
çl£
;

491 
	`h4_sm­³r_ä“_skb_bufãrs
(
sdev
, 
bªk
);

492 
	`kä“
(
bªk
->
skbuff_dma
);

493 
	`kä“
(
bªk
->
skbuff
);

494 
	`scsc_£rviû_mifsm­³r_ä“_bªk
(
sdev
->
£rviû
, 
bªk
->bank);

496 
	`¥š_uÆock_œq»¡Üe
(&
cÚŒŞ
->
sm­³r_lock
, 
æags
);

498 
	`scsc_£rviû_mifšŒb™_uÄegi¡”_toho¡
(
sdev
->
£rviû
, 
cÚŒŞ
->
th_»q
);

499 
	`scsc_£rviû_mifšŒb™_ä“_äomho¡
(
sdev
->
£rviû
, 
cÚŒŞ
->
fh_šd
, 
SCSC_MIFINTR_TARGET_R4
);

500 
	`scsc_£rviû_ä“_mboxes
(
sdev
->
£rviû
, 1, 
cÚŒŞ
->
mbox_scb
);

502 
	}
}

	@hip4_smapper.h

7 #iâdeà
__HIP4_SMAPPER_H__


8 
	#__HIP4_SMAPPER_H__


	)

10 
	g¦si_dev
;

11 
	g¦si_h4
;

13 
	esm­³r_ty³
 {

14 
	mTX_5G
,

15 
	mTX_2G
,

16 
	mRX


19 
	#HIP4_SMAPPER_TOTAL_BANKS
 10

	)

21 
	#HIP4_SMAPPER_BANK_SMALL
 
çl£


	)

22 
	#HIP4_SMAPPER_BANK_LARGE
 
Œue


	)

24 
	#HIP_SMAPPER_OWNER_FW
 0

	)

25 
	#HIP_SMAPPER_OWNER_HOST
 1

	)

27 
	#HIP_SMAPPER_STATUS_REFILL
 0

	)

28 
	#HIP_SMAPPER_STATUS_MAPPED
 1

	)

30 
	#HIP4_SMAPPER_OTHER_CPU
 0

	)

31 
	#HIP4_SMAPPER_OWN_CPU
 1

	)

33 
	#HIP4_SMAPPER_STATE_OUT
 0

	)

34 
	#HIP4_SMAPPER_STATE_WANT
 1

	)

35 
	#HIP4_SMAPPER_STATE_CLAIM
 2

	)

37 
	#HIP4_SMAPPER_BANKS_CHECK_CONFIGURE
(
»g
è((Ôegè>> 30è=ğ0 ? 1 : 0)

	)

38 
	#HIP4_SMAPPER_BANKS_CONFIGURE_DONE
(
»g
è(ÔegèğÔegè| 0xc0000000)

	)

40 
	#HIP4_SMAPPER_GET_BANK_STATE
(
b
, 
»g
è(((0x1 << ((bè* 2)è& (»g)è> 0 ? 1 : 0)

	)

41 
	#HIP4_SMAPPER_GET_BANK_OWNER
(
b
, 
»g
è(((0x2 << ((bè* 2)è& (»g)è> 0 ? 1 : 0)

	)

43 
	#HIP4_SMAPPER_SET_BANK_STATE
(
b
, 
»g
, 
v®
) ((reg) = ((reg) & ~(0x1 << ((b) * 2))) | \

44 ((
v®
è<< ((
b
è* 2)))

	)

45 
	#HIP4_SMAPPER_SET_BANK_OWNER
(
b
, 
»g
, 
v®
) ((reg) = (reg & ~(0x2 << ((b) * 2))) | \

46 (((
v®
è<< 1è<< ((
b
è* 2)))

	)

49 
	sh4_sm­³r_desütÜ
 {

50 
u8
 
	mbªk_num
;

51 
u8
 
	m’Œy_num
;

52 
u16
 
	m’Œy_size
;

53 
u16
 
	mh—droom
;

58 
	esm­³r_bªks
 {

59 
	mRX_0
,

60 
	mRX_1
,

61 
	mRX_2
,

62 
	mRX_3
,

63 
	mEND_RX_BANKS


66 
	sh4_sm­³r_cÚŒŞ
 {

67 
u32
 
	memul_loc
;

68 
u32
 
	memul_sz
;

69 
u8
 
	mth_»q
;

70 
u8
 
	mfh_šd
;

71 
u32
 
	mmbox_scb
;

72 
u32
 *
	mmbox_±r
;

73 
¥šlock_t
 
	msm­³r_lock
;

76 
u8
 
	mlooku±abË
[
HIP4_SMAPPER_TOTAL_BANKS
];

79 
	sh4_sm­³r_bªk
 {

80 
sm­³r_ty³
 
	mty³
;

81 
u16
 
	m’Œ›s
;

82 
boŞ
 
	mš_u£
;

83 
u8
 
	mbªk
;

84 
u8
 
	mcur
;

85 
u32
 
	m’Œy_size
;

86 
sk_buff
 **
	mskbuff
;

87 
dma_addr_t
 *
	mskbuff_dma
;

88 
h4_sm­³r_cÚŒŞ_’Œy
 *
	m’Œy
;

89 
u16
 
	m®ign
;

92 
h4_sm­³r_š™
(
¦si_dev
 *
sdev
, 
¦si_h4
 *
h
);

93 
h4_sm­³r_deš™
(
¦si_dev
 *
sdev
, 
¦si_h4
 *
h
);

95 
mbulk
 *
h4_sm­³r_£nd
(
¦si_h4
 *
h
, 
sk_buff
 *
skb
, *
v®
);

96 
h4_sm­³r_cÚsume_’Œy
(
¦si_dev
 *
sdev
, 
¦si_h4
 *
h
, 
sk_buff
 *
skb_çpi
);

97 *
h4_sm­³r_g‘_skb_d©a
(
¦si_dev
 *
sdev
, 
¦si_h4
 *
h
, 
sk_buff
 *
skb_çpi
);

98 
sk_buff
 *
h4_sm­³r_g‘_skb
(
¦si_dev
 *
sdev
, 
¦si_h4
 *
h
, sk_bufà*
skb_çpi
);

99 
h4_sm­³r_ä“_m­³d_skb
(
sk_buff
 *
skb
);

	@hip_bh.h

7 #iâdeà
__SLSI_HIP_BH_H__


8 
	#__SLSI_HIP_BH_H__


	)

10 
	~"wl_»suÉ.h
"

12 
C¤ResuÉ
 
¦si_sdio_func_drv_»gi¡”
();

13 
¦si_sdio_func_drv_uÄegi¡”
();

	@ioctl.c

7 
	~"ioùl.h
"

8 
	~"debug.h
"

9 
	~"mlme.h
"

10 
	~"mgt.h
"

11 
	~"ÿc.h
"

12 
	~"h.h
"

13 
	~"Ãtif.h
"

14 
	~"cfg80211_İs.h
"

15 
	~<Ãt/Ãšk.h
>

16 
	~<lšux/Ãtdeviû.h
>

17 
	~<lšux/›“80211.h
>

18 
	~<lšux/igmp.h
>

19 
	~"mib.h
"

20 
	~<scsc/scsc_mx.h
>

21 
	~<scsc/scsc_log_cŞËùÜ.h
>

22 
	~"dev.h
"

23 
	~"çpi.h
"

25 
	#CMD_RXFILTERADD
 "RXFILTER-ADD"

	)

26 
	#CMD_RXFILTERREMOVE
 "RXFILTER-REMOVE"

	)

27 
	#CMD_RXFILTERSTART
 "RXFILTER-START"

	)

28 
	#CMD_RXFILTERSTOP
 "RXFILTER-STOP"

	)

29 
	#CMD_SETCOUNTRYREV
 "SETCOUNTRYREV"

	)

30 
	#CMD_GETCOUNTRYREV
 "GETCOUNTRYREV"

	)

31 
	#CMD_SETROAMTRIGGER_LEGACY
 "SETROAMTRIGGER_LEGACY"

	)

32 
	#CMD_GETROAMTRIGGER_LEGACY
 "GETROAMTRIGGER_LEGACY"

	)

33 
	#CMD_REASSOC_LEGACY
 "REASSOC_LEGACY"

	)

34 
	#CMD_SETROAMTRIGGER
 "SETROAMTRIGGER"

	)

35 
	#CMD_GETROAMTRIGGER
 "GETROAMTRIGGER"

	)

36 
	#CMD_ADDROAMSCANCHANNELS_LEGACY
 "ADDROAMSCANCHANNELS_LEGACY"

	)

37 
	#CMD_SETSUSPENDMODE
 "SETSUSPENDMODE"

	)

38 
	#CMD_SETROAMDELTA
 "SETROAMDELTA"

	)

39 
	#CMD_GETROAMDELTA
 "GETROAMDELTA"

	)

40 
	#CMD_SETROAMSCANPERIOD
 "SETROAMSCANPERIOD"

	)

41 
	#CMD_GETROAMSCANPERIOD
 "GETROAMSCANPERIOD"

	)

42 
	#CMD_SETFULLROAMSCANPERIOD
 "SETFULLROAMSCANPERIOD"

	)

43 
	#CMD_GETFULLROAMSCANPERIOD
 "GETFULLROAMSCANPERIOD"

	)

44 
	#CMD_SETSCANCHANNELTIME
 "SETSCANCHANNELTIME"

	)

45 
	#CMD_GETSCANCHANNELTIME
 "GETSCANCHANNELTIME"

	)

46 
	#CMD_SETSCANNPROBES
 "SETSCANNPROBES"

	)

47 
	#CMD_GETSCANNPROBES
 "GETSCANNPROBES"

	)

48 
	#CMD_SETROAMMODE
 "SETROAMMODE"

	)

49 
	#CMD_GETROAMMODE
 "GETROAMMODE"

	)

50 
	#CMD_SETROAMINTRABAND
 "SETROAMINTRABAND"

	)

51 
	#CMD_GETROAMINTRABAND
 "GETROAMINTRABAND"

	)

52 
	#CMD_SETROAMBAND
 "SETROAMBAND"

	)

53 
	#CMD_GETROAMBAND
 "GETROAMBAND"

	)

54 
	#CMD_SETROAMSCANCONTROL
 "SETROAMSCANCONTROL"

	)

55 
	#CMD_GETROAMSCANCONTROL
 "GETROAMSCANCONTROL"

	)

56 
	#CMD_SETSCANHOMETIME
 "SETSCANHOMETIME"

	)

57 
	#CMD_GETSCANHOMETIME
 "GETSCANHOMETIME"

	)

58 
	#CMD_SETSCANHOMEAWAYTIME
 "SETSCANHOMEAWAYTIME"

	)

59 
	#CMD_GETSCANHOMEAWAYTIME
 "GETSCANHOMEAWAYTIME"

	)

60 
	#CMD_SETSCANHOMEAWAYTIME_LEGACY
 "SETSCANHOMEAWAYTIME_LEGACY"

	)

61 
	#CMD_SETSCANHOMETIME_LEGACY
 "SETSCANHOMETIME_LEGACY"

	)

62 
	#CMD_SETSCANCHANNELTIME_LEGACY
 "SETSCANCHANNELTIME_LEGACY"

	)

63 
	#CMD_SETSCANPASSIVETIME_LEGACY
 "SETSCANPASSIVETIME_LEGACY"

	)

64 
	#CMD_SET_TID
 "SET_TID"

	)

65 
	#CMD_SETOKCMODE
 "SETOKCMODE"

	)

66 
	#CMD_GETOKCMODE
 "GETOKCMODE"

	)

67 
	#CMD_SETWESMODE
 "SETWESMODE"

	)

68 
	#CMD_GETWESMODE
 "GETWESMODE"

	)

69 
	#CMD_SET_PMK
 "SET_PMK"

	)

70 
	#CMD_HAPD_GET_CHANNEL
 "HAPD_GET_CHANNEL"

	)

71 
	#CMD_SET_SAP_CHANNEL_LIST
 "SET_SAP_CHANNEL_LIST"

	)

72 
	#CMD_REASSOC
 "REASSOC"

	)

73 
	#CMD_SETROAMSCANCHANNELS
 "SETROAMSCANCHANNELS"

	)

74 
	#CMD_GETROAMSCANCHANNELS
 "GETROAMSCANCHANNELS"

	)

75 
	#CMD_GETROAMSCANCHANNELS_LEGACY
 "GETROAMSCANCHANNELS_LEGACY"

	)

76 
	#CMD_ADDROAMSCANCHANNELS
 "ADDROAMSCANCHANNELS"

	)

77 
	#CMD_SENDACTIONFRAME
 "SENDACTIONFRAME"

	)

78 
	#CMD_CERTSENDACTIONFRAME
 "CERTSENDACTIONFRAME"

	)

79 #ifdeà
SLSI_TEST_DEV


80 
	#CMD_GASSENDACTIONFRAME
 "GASSENDACTIONFRAME"

	)

82 
	#CMD_GETNCHOMODE
 "GETNCHOMODE"

	)

83 
	#CMD_SETNCHOMODE
 "SETNCHOMODE"

	)

84 
	#CMD_GETDFSSCANMODE
 "GETDFSSCANMODE"

	)

85 
	#CMD_SETDFSSCANMODE
 "SETDFSSCANMODE"

	)

86 
	#CMD_HAPD_MAX_NUM_STA
 "HAPD_MAX_NUM_STA"

	)

87 
	#CMD_COUNTRY
 "COUNTRY"

	)

88 
	#CMD_SEND_GK
 "SEND_GK"

	)

89 
	#CMD_SETAPP2PWPSIE
 "SET_AP_P2P_WPS_IE"

	)

90 
	#CMD_P2PSETPS
 "P2P_SET_PS"

	)

91 
	#CMD_P2PSETNOA
 "P2P_SET_NOA"

	)

92 
	#CMD_P2PECSA
 "P2P_ECSA"

	)

93 
	#CMD_P2PLOSTART
 "P2P_LO_START"

	)

94 
	#CMD_P2PLOSTOP
 "P2P_LO_STOP"

	)

95 
	#CMD_TDLSCHANNELSWITCH
 "TDLS_CHANNEL_SWITCH"

	)

96 
	#CMD_SETROAMOFFLOAD
 "SETROAMOFFLOAD"

	)

97 
	#CMD_SETROAMOFFLAPLIST
 "SETROAMOFFLAPLIST"

	)

98 #ifdeà
CONFIG_SCSC_WLAN_LOW_LATENCY_MODE


99 
	#CMD_SET_LATENCY_MODE
 "SET_LATENCY_MODE"

	)

100 
	#CMD_SET_POWER_MGMT
 "SET_POWER_MGMT"

	)

102 
	#CMD_SET_LATENCY_CRT_DATA
 "SET_LATENCY_CRT_DATA"

	)

103 
	#CMD_SET_DISCONNECT_IES
 "SET_DISCONNECT_IES"

	)

104 
	#CMD_SETBANDWIDTH
 "SETBANDWIDTH"

	)

105 
	#CMD_SET_BSS_CHANNEL_WIDTH
 "SET_BSS_CHANNEL_WIDTH"

	)

107 
	#CMD_SETBAND
 "SETBAND"

	)

108 
	#CMD_GETBAND
 "GETBAND"

	)

109 
	#CMD_FACTORY_SETBAND
 "FACTORY_SETBAND"

	)

110 
	#CMD_SET_FCC_CHANNEL
 "SET_FCC_CHANNEL"

	)

112 
	#CMD_FAKEMAC
 "FAKEMAC"

	)

114 
	#CMD_GETBSSRSSI
 "GET_BSS_RSSI"

	)

115 
	#CMD_GETBSSINFO
 "GETBSSINFO"

	)

116 
	#CMD_GETSTAINFO
 "GETSTAINFO"

	)

117 
	#CMD_GETASSOCREJECTINFO
 "GETASSOCREJECTINFO"

	)

118 
	#CMD_SET_DWELL_TIME
 "SET_DWELL_TIME"

	)

120 #ià
defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

121 
	#CMD_BEACON_RECV
 "BEACON_RECV"

	)

123 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


124 
	#CMD_SET_ENHANCED_ARP_TARGET
 "SET_ENHANCED_ARP_TARGET"

	)

125 
	#CMD_GET_ENHANCED_ARP_COUNTS
 "GET_ENHANCED_ARP_COUNTS"

	)

129 
	#CMD_AMPDU_MPDU
 "AMPDU_MPDU"

	)

130 
	#CMD_BTCOEXMODE
 "BTCOEXMODE"

	)

131 
	#CMD_BTCOEXSCAN_START
 "BTCOEXSCAN-START"

	)

132 
	#CMD_BTCOEXSCAN_STOP
 "BTCOEXSCAN-STOP"

	)

133 
	#CMD_CHANGE_RL
 "CHANGE_RL"

	)

134 
	#CMD_INTERFACE_CREATE
 "INTERFACE_CREATE"

	)

135 
	#CMD_INTERFACE_DELETE
 "INTERFACE_DELETE"

	)

136 
	#CMD_SET_INDOOR_CHANNELS
 "SET_INDOOR_CHANNELS"

	)

137 
	#CMD_GET_INDOOR_CHANNELS
 "GET_INDOOR_CHANNELS"

	)

138 
	#CMD_LTECOEX
 "LTECOEX"

	)

139 
	#CMD_MIRACAST
 "MIRACAST"

	)

140 
	#CMD_RESTORE_RL
 "RESTORE_RL"

	)

141 
	#CMD_RPSMODE
 "RPSMODE"

	)

142 
	#CMD_SETCCXMODE
 "SETCCXMODE"

	)

143 
	#CMD_SETDFSSCANMODE
 "SETDFSSCANMODE"

	)

144 
	#CMD_SETJOINPREFER
 "SETJOINPREFER"

	)

145 
	#CMD_SETSINGLEANT
 "SETSINGLEANT"

	)

146 
	#CMD_SET_TX_POWER_CALLING
 "SET_TX_POWER_CALLING"

	)

147 
	#CMD_GET_CU
 "GET_CU"

	)

149 
	#CMD_DRIVERDEBUGDUMP
 "DEBUG_DUMP"

	)

150 
	#CMD_DRIVERDEBUGCOMMAND
 "DEBUG_COMMAND"

	)

151 
	#CMD_TESTFORCEHANG
 "SLSI_TEST_FORCE_HANG"

	)

152 
	#CMD_GETREGULATORY
 "GETREGULATORY"

	)

154 
	#CMD_SET_TX_POWER_SAR
 "SET_TX_POWER_SAR"

	)

155 
	#CMD_GET_TX_POWER_SAR
 "GET_TX_POWER_SAR"

	)

156 
	#CMD_SET_TX_POWER_SUB6_BAND
 "SET_TX_POWER_SUB6_BAND"

	)

158 
	#CMD_POWER_MEASUREMENT_START
 "POWER_MEASUREMENT_START"

	)

160 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


161 
	#CMD_ENHANCED_PKT_FILTER
 "ENHANCED_PKT_FILTER"

	)

164 #ifdeà
CONFIG_SCSC_WLAN_MAX_LINK_SPEED


165 
	#CMD_GET_MAX_LINK_SPEED
 "GET_MAX_LINK_SPEED"

	)

168 #ifdeà
CONFIG_SCSC_WLAN_NUM_ANTENNAS


169 
	#CMD_SET_NUM_ANTENNAS
 "SET_NUM_ANTENNAS"

	)

170 
	#CMD_GET_NUM_ANTENNAS
 "GET_NUM_ANTENNAS"

	)

173 #ifdeà
CONFIG_SCSC_WLAN_DYNAMIC_ITO


174 
	#CMD_SET_ITO
 "SET_ITO"

	)

175 
	#CMD_ENABLE_ITO
 "ENABLE_ITO"

	)

178 
	#CMD_ELNA_BYPASS
 "ELNA_BYPASS"

	)

179 
	#CMD_ELNA_BYPASS_INT
 "ELNA_BYPASS_INT"

	)

180 
	#CMD_MAX_DTIM_IN_SUSPEND
 "MAX_DTIM_IN_SUSPEND"

	)

181 
	#CMD_SET_DTIM_IN_SUSPEND
 "SET_DTIM_IN_SUSPEND"

	)

182 
	#CMD_FORCE_ROAMING_BSSID
 "FORCE_ROAMING_BSSID"

	)

183 
	#CMD_ROAMING_BLACKLIST_ADD
 "ROAMING_BLACKLIST_ADD"

	)

184 
	#CMD_ROAMING_BLACKLIST_REMOVE
 "ROAMING_BLACKLIST_REMOVE"

	)

186 
	#ROAMOFFLAPLIST_MIN
 1

	)

187 
	#ROAMOFFLAPLIST_MAX
 100

	)

189 
¦si_ioùl_¬gs
 *
	$¦si_g‘_´iv©e_commªd_¬gs
(*
bufãr
, 
buf_Ën
, 
max_¬g_couÁ
)

191 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

192 *
pos
 = 
bufãr
;

194 
ioùl_¬gs
 = 
	`km®loc
((*ioùl_¬gsè+ (
u8
 *è* 
max_¬g_couÁ
, 
GFP_KERNEL
);

195 ià(!
ioùl_¬gs
)

196  
NULL
;

197 
	`mem£t
(
ioùl_¬gs
->
¬gs
, '\0', (
u8
 *è* 
max_¬g_couÁ
);

199 
ioùl_¬gs
->
¬g_couÁ
 = 0;

200 
buf_Ën
 > 0 && 
ioùl_¬gs
->
¬g_couÁ
 < 
max_¬g_couÁ
) {

201 
pos
 = 
	`¡rchr
(pos, ' ');

202 ià(!
pos
)

204 
buf_Ën
 = buf_ËÀ- (
pos
 - 
bufãr
 + 1);

205 ià(
buf_Ën
 <= 0)

207 *
pos
 = '\0';

208 
pos
++;

209 *
pos
 == ' ')

210 
pos
++;

211 
bufãr
 = 
pos
;

212 
ioùl_¬gs
->
¬gs
[ioùl_¬gs->
¬g_couÁ
++] = 
pos
;

214  
ioùl_¬gs
;

215 
	}
}

217 
	$¦si_·r£_hex
(
c
)

219 ià(
c
 >= '0' && c <= '9')

220  
c
 - '0';

221 ià(
c
 >= 'a' && c <= 'f')

222  
c
 - 'a' + 10;

223 ià(
c
 >= 'A' && c <= 'F')

224  
c
 - 'A' + 10;

226 
	}
}

228 
	$¦si_cÚv”t_¥aû_£³¿tiÚ
(*
buf
, 
buf_Ën
)

230 
i
 = 0;

232 
buf
[
i
] !ğ'\0' && i < 
buf_Ën
) {

233 ià(
buf
[
i
] == ',' || buf[i] == '=')

234 
buf
[
i
] = ' ';

235 
i
++;

237 
	}
}

239 
	$¦si_is_bw_v®id
(*
¡r
)

241 ià((
	`¦si_¡r_cmp
(
¡r
, "20") == 0) || (slsi_str_cmp(str, "40") == 0) ||

242 (
	`¦si_¡r_cmp
(
¡r
, "80") == 0))

246 
	}
}

248 
	$¦si_machex¡ršg_to_maÿ¼ay
(*
mac_¡r
, 
u8
 *
mac_¬r
)

250 
mac_¬r
[0] = 
	`¦si_·r£_hex
(
mac_¡r
[0]) << 4 | slsi_parse_hex(mac_str[1]);

251 
mac_¬r
[1] = 
	`¦si_·r£_hex
(
mac_¡r
[3]) << 4 | slsi_parse_hex(mac_str[4]);

252 
mac_¬r
[2] = 
	`¦si_·r£_hex
(
mac_¡r
[6]) << 4 | slsi_parse_hex(mac_str[7]);

253 
mac_¬r
[3] = 
	`¦si_·r£_hex
(
mac_¡r
[9]) << 4 | slsi_parse_hex(mac_str[10]);

254 
mac_¬r
[4] = 
	`¦si_·r£_hex
(
mac_¡r
[12]) << 4 | slsi_parse_hex(mac_str[13]);

255 
mac_¬r
[5] = 
	`¦si_·r£_hex
(
mac_¡r
[15]) << 4 | slsi_parse_hex(mac_str[16]);

256 
	}
}

258 
	$¦si_g‘_rş_chªÃl_li¡
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
, 
u16
 *
chªÃl_li¡
)

260 
u32
 
chªÃl_couÁ
 = 0;

261 
i
 = 7;

262 
›_Ën
 = 0;

263 
u8
 *
±r
;

264 
u16
 
chªÃl_v®
 = 0;

265 
__Ë16
 *
Ë16_±r
 = 
NULL
;

267 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "RCL Channel List Indication„eceived\n");

268 
±r
 = 
	`çpi_g‘_d©a
(
skb
);

269 
›_Ën
 = 
±r
[1];

270 
i
 < 
›_Ën
) {

271 
Ë16_±r
 = (
__Ë16
 *)&
±r
[
i
];

272 
chªÃl_v®
 = 
	`Ë16_to_ıu
(*
Ë16_±r
);

273 
chªÃl_li¡
[
chªÃl_couÁ
] = 
	`›“80211_äequ’cy_to_chªÃl
(
chªÃl_v®
 / 2);

274 ià(
chªÃl_li¡
[
chªÃl_couÁ
] < 1 || channel_list[channel_count] > 196) {

275 
	`SLSI_ERR
(
sdev
, "ERR: Inv®id chªÃÈ»ûived %d\n", 
chªÃl_li¡
[
chªÃl_couÁ
]);

276 
	`kä“_skb
(
skb
);

279 
i
 += 3;

280 
chªÃl_couÁ
 += 1;

281 ià(
chªÃl_couÁ
 >ğ
MAX_CHANNEL_COUNT
) {

282 
	`SLSI_ERR
(
sdev
, "ERR: ChªÃÈli¡„eûived >ğ%d\n", 
MAX_CHANNEL_COUNT
);

283 
	`kä“_skb
(
skb
);

287 
	`kä“_skb
(
skb
);

288  
chªÃl_couÁ
;

289 
	}
}

291 
	$¦si_upd©e_muÉiÿ¡_addr
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

293 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

294 
š_deviû
 *
š_dev
 = 
NULL
;

295 
_mc_li¡
 *
im
 = 
NULL
;

296 
__be32
 
muÉiÿ¡__li¡
[65] = {0};

297 
size
 = 0, 
i
 = 0, 
_found
 = 0;

299 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

300 
	`WARN_ON
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
);

301 
š_dev
 = 
	`__š_dev_g‘_¹Æ
(
dev
);

302 ià(!
š_dev
)

305 
im
 = 
	`¹Æ_d”eã»nû
(
š_dev
->
mc_li¡
); im !ğ
NULL
; im =„Šl_d”eã»nû(im->
Ãxt_rcu
)) {

306 
_found
 = 0;

307 
i
 = 0; i < 
size
; i++) {

308 ià(!
	`memcmp
(&
im
->
muÉŸddr
, &
muÉiÿ¡__li¡
[
i
], (
__be32
))) {

309 
_found
 = 1;

313 ià(!
_found
) {

314 
	`memıy
(&
muÉiÿ¡__li¡
[
size
], &
im
->
muÉŸddr
, (
__be32
));

315 
size
++;

317 ià(
size
 >= 65)

320 
	`¦si_mlme_£t_muÉiÿ¡_
(
sdev
, 
dev
, 
muÉiÿ¡__li¡
, 
size
);

321 
	}
}

323 
	$¦si_£t_su¥’d_mode
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

325 
Ãtdev_vif
 *Ãtdev_viàğ
	`Ãtdev_´iv
(
dev
);

326 
¦si_dev
 *
sdev
 = 
Ãtdev_vif
->sdev;

327 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

328 
u£r_su¥’d_mode
;

329 
´evious_su¥’d_mode
;

330 
u16
 
ho¡_¡©e
 = 0;

331 
»t
 = 0;

332 
vif
;

334 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 1);

335 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

337 
u£r_su¥’d_mode
 = *
ioùl_¬gs
->
¬gs
[0] - '0';

338 ià(
u£r_su¥’d_mode
 != 0 && user_suspend_mode != 1) {

339 
	`SLSI_ERR
(
sdev
, "Inv®id v®uoàu£r_su¥’d_mod%d\n", 
u£r_su¥’d_mode
);

340 
	`kä“
(
ioùl_¬gs
);

341  -
EINVAL
;

344 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

345 
´evious_su¥’d_mode
 = 
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
;

346 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

347 ià(
u£r_su¥’d_mode
 !ğ
´evious_su¥’d_mode
) {

348 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

349 
vif
 = 1; vià<ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; vif++) {

350 
Ãt_deviû
 *
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
vif
);

351 
Ãtdev_vif
 *
ndev_vif
;

353 ià(!
dev
)

356 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

357 ià(!
u£r_su¥’d_mode
)

358 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
upd©e_pkt_f‹r_wÜk
);

360 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

361 ià(
ndev_vif
->
aùiv©ed
 &&

362 
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

363 
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
) {

364 ià(
u£r_su¥’d_mode
) {

365 
»t
 = 
	`¦si_upd©e_·ck‘_f‹rs
(
sdev
, 
dev
);

366 ià(
sdev
->
igmp_ofæßd_aùiv©ed
)

367 
	`¦si_upd©e_muÉiÿ¡_addr
(
sdev
, 
dev
);

369 
»t
 = 
	`¦si_ş—r_·ck‘_f‹rs
(
sdev
, 
dev
);

371 ià(
»t
 != 0)

372 
	`SLSI_NET_ERR
(
dev
, "E¼Ü iÀupd©šg /ş—ršgh·ck‘ f‹rs,»t=%d", 
»t
);

375 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

377 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

379 
	`SLSI_NET_INFO
(
dev
, "Cu¼’ˆsu¥’d mod(%dèªd„eque¡ed mode(%dè¬§me\n", 
´evious_su¥’d_mode
, 
u£r_su¥’d_mode
);

382 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

383 
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
 = user_suspend_mode;

384 
ho¡_¡©e
 = 
sdev
->
deviû_cÚfig
.host_state;

386 ià(!
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
)

387 
ho¡_¡©e
 = ho¡_¡©| 
SLSI_HOSTSTATE_LCD_ACTIVE
;

389 
ho¡_¡©e
 = ho¡_¡©& ~
SLSI_HOSTSTATE_LCD_ACTIVE
;

390 
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 = host_state;

392 
»t
 = 
	`¦si_mlme_£t_ho¡_¡©e
(
sdev
, 
dev
, 
ho¡_¡©e
);

393 ià(
»t
 != 0)

394 
	`SLSI_NET_ERR
(
dev
, "E¼Ü iÀ£‰šghHo¡ S‹,„‘=%d", 
»t
);

396 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

397 
	`kä“
(
ioùl_¬gs
);

398  
»t
;

399 
	}
}

401 
	$¦si_£t_p2p_İµs
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

403 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

404 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

405 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

406 
ù_·¿m
;

407 
Ëgacy_ps
;

408 
İp_ps
;

409 
»suÉ
 = 0;

411 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 3);

412 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

414 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

416 ià(
ioùl_¬gs
->
¬g_couÁ
 < 3) {

417 
	`SLSI_ERR
(
sdev
, "Inv®id‡rgum’ˆcouÁ = %d\n", 
ioùl_¬gs
->
¬g_couÁ
);

418 
»suÉ
 = -
EINVAL
;

419 
ex™
;

423 ià(!
ndev_vif
->
aùiv©ed
 ||‚dev_vif->
iáy³
 !ğ
NL80211_IFTYPE_P2P_GO
) {

424 
	`SLSI_ERR_NODEV
("P2P GO vif‚ot‡ctivated\n");

425 
»suÉ
 = -
EINVAL
;

426 
ex™
;

429 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
Ëgacy_ps
)) {

430 
	`SLSI_ERR
(
sdev
, "Ëgacy_ps: faedØ»ad from sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

431 
»suÉ
 = -
EINVAL
;

432 
ex™
;

435 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
İp_ps
)) {

436 
	`SLSI_ERR
(
sdev
, "İp_ps: faedØ»ad from sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

437 
»suÉ
 = -
EINVAL
;

438 
ex™
;

441 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[2], &
ù_·¿m
)) {

442 
	`SLSI_ERR
(
sdev
, "ù_·¿m: faedØ»ad from sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[2]);

443 
»suÉ
 = -
EINVAL
;

444 
ex™
;

447 ià(
İp_ps
 == 0)

448 
»suÉ
 = 
	`¦si_mlme_£t_ùwšdow
(
sdev
, 
dev
, 
İp_ps
);

449 ià(
ù_·¿m
 < ()
ndev_vif
->
­
.
b—cÚ_š‹rv®
)

450 
»suÉ
 = 
	`¦si_mlme_£t_ùwšdow
(
sdev
, 
dev
, 
ù_·¿m
);

452 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "p2°ù wšdow = %d i ouˆoà¿ngfÜ b—cÚ iÁ”v®(%d)\n", 
ù_·¿m
, 
ndev_vif
->
­
.
b—cÚ_š‹rv®
);

453 
ex™
:

454 
	`kä“
(
ioùl_¬gs
);

455 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

457  
»suÉ
;

458 
	}
}

460 
	$¦si_p2p_£t_nß_·¿ms
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

462 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

463 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

464 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

465 
»suÉ
 = 0;

466 
nß_couÁ
;

467 
du¿tiÚ
;

468 
š‹rv®
;

470 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 3);

471 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

473 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

475 ià(
ioùl_¬gs
->
¬g_couÁ
 < 3) {

476 
	`SLSI_ERR
(
sdev
, "Inv®id‡rgum’ˆcouÁ = %d\n", 
ioùl_¬gs
->
¬g_couÁ
);

477 
»suÉ
 = -
EINVAL
;

478 
ex™
;

482 ià(!
ndev_vif
->
aùiv©ed
 ||‚dev_vif->
iáy³
 !ğ
NL80211_IFTYPE_P2P_GO
) {

483 
	`SLSI_ERR_NODEV
("P2P GO vif‚ot‡ctivated\n");

484 
»suÉ
 = -
EINVAL
;

485 
ex™
;

488 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
nß_couÁ
)) {

489 
	`SLSI_ERR
(
sdev
, "nß_couÁ: faedØ»ad sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

490 
»suÉ
 = -
EINVAL
;

491 
ex™
;

494 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
š‹rv®
)) {

495 
	`SLSI_ERR
(
sdev
, "š‹rv®: faedØ»ad sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

496 
»suÉ
 = -
EINVAL
;

497 
ex™
;

500 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[2], &
du¿tiÚ
)) {

501 
	`SLSI_ERR
(
sdev
, "du¿tiÚ: faedØ»ad sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[2]);

502 
»suÉ
 = -
EINVAL
;

503 
ex™
;

507 
»suÉ
 = 
	`¦si_mlme_£t_p2p_nß
(
sdev
, 
dev
, 
nß_couÁ
, 
š‹rv®
, 
du¿tiÚ
);

509 
ex™
:

510 
	`kä“
(
ioùl_¬gs
);

511 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

512  
»suÉ
;

513 
	}
}

515 
	$¦si_p2p_ec§
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

517 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

518 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

519 
Ãtdev_vif
 *
group_dev_vif
;

520 
Ãt_deviû
 *
group_dev
 = 
NULL
;

521 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

522 
»suÉ
 = 0;

523 
chªÃl
;

524 
bªdwidth
;

525 
u16
 
ûÁ”_äeq
 = 0;

526 
u16
 
chª_šfo
 = 0;

527 
cfg80211_chª_def
 
chªdef
;

528 
Æ80211_bªd
 
bªd
;

529 
Æ80211_chªÃl_ty³
 
chª_ty³
 = 
NL80211_CHAN_NO_HT
;

531 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 2);

532 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

534 ià(
ioùl_¬gs
->
¬g_couÁ
 < 2) {

535 
	`SLSI_ERR
(
sdev
, "Inv®id‡rgum’ˆcouÁ = %d\n", 
ioùl_¬gs
->
¬g_couÁ
);

536 
	`kä“
(
ioùl_¬gs
);

537  -
EINVAL
;

540 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

542 
group_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2PX_SWLAN
);

543 ià(!
group_dev
) {

544 
	`SLSI_INFO
(
sdev
, "No Group‚et_dev found\n");

545 
»suÉ
 = -
EINVAL
;

546 
ex™
;

549 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
chªÃl
)) {

550 
	`SLSI_ERR
(
sdev
, "chªÃl: faedØ»ad sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

551 
»suÉ
 = -
EINVAL
;

552 
ex™
;

555 ià(
chªÃl
 < 1 || channel > 165) {

556 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
chªÃl
);

557 
»suÉ
 = -
EINVAL
;

558 
ex™
;

561 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
bªdwidth
)) {

562 
	`SLSI_ERR
(
sdev
, "bªdwidth: faedØ»ad sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

563 
»suÉ
 = -
EINVAL
;

564 
ex™
;

567 
bªd
 = (
chªÃl
 <ğ14è? 
NL80211_BAND_2GHZ
 : 
NL80211_BAND_5GHZ
;

568 
ûÁ”_äeq
 = 
	`›“80211_chªÃl_to_äequ’cy
(
chªÃl
, 
bªd
);

569 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "p2°ec§_·¿m (ûÁ”_äeq)ğ(%d)\n", 
ûÁ”_äeq
);

570 
chªdef
.
chª
 = 
	`›“80211_g‘_chªÃl
(
sdev
->
why
, 
ûÁ”_äeq
);

571 
chªdef
.
width
 = (
bªd
 =ğ
NL80211_BAND_2GHZ
è? 
NL80211_CHAN_WIDTH_20_NOHT
 : 
NL80211_CHAN_WIDTH_80
;

573 #iâdeà
SSB_4963_FIXED


575 ià(
sdev
->
bªd_5g_suµÜ‹d
) {

576 ià(
bªdwidth
 == 80) {

577 
chªdef
.
width
 = 
NL80211_CHAN_WIDTH_40
;

578 
bªdwidth
 = 40;

579 ià(
chªÃl
 == 36 || channel == 44 || channel == 149 || channel == 157)

580 
chª_ty³
 = 
NL80211_CHAN_HT40PLUS
;

582 
chª_ty³
 = 
NL80211_CHAN_HT40MINUS
;

586 ià(
chªÃl
 =ğ165 && 
bªdwidth
 != 20) {

587 
bªdwidth
 = 20;

588 
chª_ty³
 = 
NL80211_CHAN_HT20
;

590 
	`cfg80211_chªdef_ü—‹
(&
chªdef
, chªdef.
chª
, 
chª_ty³
);

591 
chª_šfo
 = 
	`¦si_g‘_chªn_šfo
(
sdev
, &
chªdef
);

592 ià(
bªdwidth
 != 20)

593 
ûÁ”_äeq
 = 
	`¦si_g‘_ûÁ”_äeq1
(
sdev
, 
chª_šfo
, center_freq);

594 
group_dev_vif
 = 
	`Ãtdev_´iv
(
group_dev
);

595 
	`SLSI_MUTEX_LOCK
(
group_dev_vif
->
vif_mu‹x
);

596 
»suÉ
 = 
	`¦si_mlme_chªÃl_sw™ch
(
sdev
, 
group_dev
, 
ûÁ”_äeq
, 
chª_šfo
);

597 
	`SLSI_MUTEX_UNLOCK
(
group_dev_vif
->
vif_mu‹x
);

599 
ex™
:

600 
	`kä“
(
ioùl_¬gs
);

601 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

602  
»suÉ
;

603 
	}
}

605 
ssize_t
 
	$¦si_­_v’dÜ_›s_wr™e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
›
,

606 
size_t
 
›_Ën
, 
u16
 
pu½o£
)

608 
u8
 *
v’dÜ_›
 = 
NULL
;

609 
»suÉ
 = 0;

610 
Ãtdev_vif
 *
ndev_vif
;

612 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

613 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

618 ià(!
ndev_vif
->
aùiv©ed
) {

619 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "vif‚ot‡ctivated\n");

620 
»suÉ
 = 0;

621 
ex™
;

623 ià(!(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_GO
 ||‚dev_vif->iáy³ =ğ
NL80211_IFTYPE_AP
)) {

624 
	`SLSI_ERR
(
sdev
, "NÙ AP o¸P2P iÁ”çû. iÁ”çûTy³:%d\n", 
ndev_vif
->
iáy³
);

625 
»suÉ
 = -
EINVAL
;

626 
ex™
;

629 
v’dÜ_›
 = 
	`km®loc
(
›_Ën
, 
GFP_KERNEL
);

630 ià(!
v’dÜ_›
) {

631 
	`SLSI_ERR
(
sdev
, "kmalloc failed\n");

632 
»suÉ
 = -
ENOMEM
;

633 
ex™
;

635 
	`memıy
(
v’dÜ_›
, 
›
, 
›_Ën
);

637 
	`¦si_ş—r_ÿched_›s
(&
ndev_vif
->
­
.
add_šfo_›s
, &ndev_vif->­.
add_šfo_›s_Ën
);

638 
»suÉ
 = 
	`¦si_­_´•¬e_add_šfo_›s
(
ndev_vif
, 
v’dÜ_›
, 
›_Ën
);

640 ià(
»suÉ
 == 0)

641 
»suÉ
 = 
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
pu½o£
, 
ndev_vif
->
­
.
add_šfo_›s
,‚dev_vif->­.
add_šfo_›s_Ën
);

643 
	`¦si_ş—r_ÿched_›s
(&
ndev_vif
->
­
.
add_šfo_›s
, &ndev_vif->­.
add_šfo_›s_Ën
);

644 
	`kä“
(
v’dÜ_›
);

646 
ex™
:

647 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

648  
»suÉ
;

649 
	}
}

651 
	$¦si_£t_­_p2p_wps_›
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

653 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

654 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

655 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

656 
»suÉ
 = 0;

657 
u8
 *
·¿ms
;

658 
off£t
 = 0;

659 
	eif_ty³
 {

660 
IF_TYPE_NONE
,

661 
IF_TYPE_P2P_DEVICE
,

662 
IF_TYPE_AP_P2P


663 } 
iáy³
 = 
IF_TYPE_NONE
;

664 
	eäame_ty³
 {

665 
FRAME_TYPE_NONE
,

666 
FRAME_TYPE_BEACON
,

667 
FRAME_TYPE_PROBE_RESPONSE
,

668 
FRAME_TYPE_ASSOC_RESPONSE


669 } 
äam‘y³
 = 
FRAME_TYPE_NONE
;

670 
·¿ms_Ën
 = 
buf_Ën
 - 
	`¡¾’
(
CMD_SETAPP2PWPSIE
) - 1;

672 
·¿ms
 = 
commªd
 + 
	`¡¾’
(
CMD_SETAPP2PWPSIE
) + 1;

673 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 2);

674 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

676 ià(
ioùl_¬gs
->
¬g_couÁ
 < 2) {

677 
	`SLSI_ERR
(
sdev
, "Inv®id‡rgum’ˆcouÁ = %d\n", 
ioùl_¬gs
->
¬g_couÁ
);

678 
»suÉ
 = -
EINVAL
;

679 
ex™
;

682 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], (*)&
äam‘y³
)) {

683 
	`SLSI_ERR
(
sdev
, "FaedØ»ad f¿mty³ sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

684 
»suÉ
 = -
EINVAL
;

685 
ex™
;

687 
off£t
 = off£ˆ+ 
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]) + 1;

689 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], (*)&
iáy³
)) {

690 
	`SLSI_ERR
(
sdev
, "FaedØ»ad iáy³ sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

691 
»suÉ
 = -
EINVAL
;

692 
ex™
;

694 
off£t
 = off£ˆ+ 
	`¡¾’
(
ioùl_¬gs
->
¬gs
[1]) + 1;

695 
·¿ms_Ën
 =…¬ams_ËÀ- 
off£t
;

697 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_NETDEV
,

699 
commªd
, 
äam‘y³
, 
iáy³
, 
buf_Ën
, 
·¿ms_Ën
);

702 ià(
iáy³
 =ğ
IF_TYPE_P2P_DEVICE
) {

703 
u8
 *
´obe_»¥_›
 = 
NULL
;

705 ià(
äam‘y³
 !ğ
FRAME_TYPE_PROBE_RESPONSE
) {

706 
	`SLSI_NET_ERR
(
dev
, "Wrong frameype„eceived\n");

707 
»suÉ
 = -
EINVAL
;

708 
ex™
;

710 
´obe_»¥_›
 = 
	`km®loc
(
·¿ms_Ën
, 
GFP_KERNEL
);

711 ià(!
´obe_»¥_›
) {

712 
	`SLSI_ERR
(
sdev
, "Malloc for IEs failed\n");

713 
	`kä“
(
ioùl_¬gs
);

714  -
ENOMEM
;

717 
	`memıy
(
´obe_»¥_›
, 
·¿ms
 + 
off£t
, 
·¿ms_Ën
);

719 
»suÉ
 = 
	`¦si_p2p_dev_´obe_r¥_›
(
sdev
, 
dev
, 
´obe_»¥_›
, 
·¿ms_Ën
);

720 } ià(
iáy³
 =ğ
IF_TYPE_AP_P2P
) {

721 ià(
äam‘y³
 =ğ
FRAME_TYPE_BEACON
)

722 
»suÉ
 = 
	`¦si_­_v’dÜ_›s_wr™e
(
sdev
, 
dev
, 
·¿ms
 + 
off£t
, 
·¿ms_Ën
, 
FAPI_PURPOSE_BEACON
);

723 ià(
äam‘y³
 =ğ
FRAME_TYPE_PROBE_RESPONSE
)

724 
»suÉ
 = 
	`¦si_­_v’dÜ_›s_wr™e
(
sdev
, 
dev
, 
·¿ms
 + 
off£t
, 
·¿ms_Ën
, 
FAPI_PURPOSE_PROBE_RESPONSE
);

725 ià(
äam‘y³
 =ğ
FRAME_TYPE_ASSOC_RESPONSE
)

726 
»suÉ
 = 
	`¦si_­_v’dÜ_›s_wr™e
(
sdev
, 
dev
, 
·¿ms
 + 
off£t
, 
·¿ms_Ën
, 
FAPI_PURPOSE_ASSOCIATION_RESPONSE
);

728 
ex™
:

729 
	`kä“
(
ioùl_¬gs
);

730  
»suÉ
;

731 
	}
}

738 
	$¦si_p2p_lo_¡¬t
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

740 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

741 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

742 
›“80211_chªÃl
 *
chª
 = 
NULL
;

743 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

744 
chªÃl
, 
du¿tiÚ
, 
š‹rv®
, 
couÁ
;

745 
»t
 = 0;

746 
äeq
;

747 
Æ80211_bªd
 
bªd
;

749 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 4);

750 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

752 ià(
ioùl_¬gs
->
¬g_couÁ
 < 4) {

753 
	`SLSI_ERR
(
sdev
, "Inv®id‡rgum’ˆcouÁ = %d\n", 
ioùl_¬gs
->
¬g_couÁ
);

754 
	`kä“
(
ioùl_¬gs
);

755  -
EINVAL
;

758 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

764 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_SCANNING
 || sdev->p2p_¡©> 
P2P_LISTENING
 ||

765 (
sdev
->
p2p_¡©e
 =ğ
P2P_LISTENING
 && !
ndev_vif
->
unsync
.
li¡’_ofæßd
)) {

766 
	`SLSI_NET_ERR
(
dev
, "Rejeù LO dutØÚgošg P2P o³¿tiÚ (¡©e: %s)\n", 
	`¦si_p2p_¡©e_‹xt
(
sdev
->
p2p_¡©e
));

767 
»t
 = -
EINVAL
;

768 
ex™
;

771 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
chªÃl
)) {

772 
	`SLSI_ERR
(
sdev
, "chªÃl: faedØ»ad sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

773 
»t
 = -
EINVAL
;

774 
ex™
;

777 ià(
chªÃl
 < 1 || channel > 165) {

778 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
chªÃl
);

779 
»t
 = -
EINVAL
;

780 
ex™
;

783 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
du¿tiÚ
)) {

784 
	`SLSI_ERR
(
sdev
, "du¿tiÚ: faedØ»ad sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

785 
»t
 = -
EINVAL
;

786 
ex™
;

789 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[2], &
š‹rv®
)) {

790 
	`SLSI_ERR
(
sdev
, "š‹rv®: faedØ»ad sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[2]);

791 
»t
 = -
EINVAL
;

792 
ex™
;

795 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[3], &
couÁ
)) {

796 
	`SLSI_ERR
(
sdev
, "couÁ: faedØ»ad sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[3]);

797 
»t
 = -
EINVAL
;

798 
ex™
;

801 ià(!
ndev_vif
->
aùiv©ed
) {

802 
»t
 = 
	`¦si_mlme_add_vif
(
sdev
, 
dev
, dev->
dev_addr
, dev->dev_addr);

803 ià(
»t
 != 0) {

804 
	`SLSI_NET_ERR
(
dev
, "Unsync vif‡ddition failed\n");

805 
ex™
;

808 
ndev_vif
->
aùiv©ed
 = 
Œue
;

809 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

810 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_VIF_ACTIVE
);

812 
»t
 = 
	`¦si_mlme_»gi¡”_aùiÚ_äame
(
sdev
, 
dev
, 
SLSI_ACTION_FRAME_PUBLIC
, SLSI_ACTION_FRAME_PUBLIC);

813 ià(
»t
 != 0) {

814 
	`SLSI_NET_ERR
(
dev
, "Action frame„egistration for unsync vif failed\n");

815 
ex™_w™h_vif_d—ùiv©e
;

822 
bªd
 = (
chªÃl
 <ğ14è? 
NL80211_BAND_2GHZ
 : 
NL80211_BAND_5GHZ
;

823 
äeq
 = 
	`›“80211_chªÃl_to_äequ’cy
(
chªÃl
, 
bªd
);

824 
chª
 = 
	`›“80211_g‘_chªÃl
(
sdev
->
why
, 
äeq
);

825 ià(!
chª
) {

826 
	`SLSI_NET_ERR
(
dev
, "IncÜ»ù chªÃl: %u - Li¡’ Ofæßd faed\n", 
chªÃl
);

827 
»t
 = -
EINVAL
;

828 
ex™_w™h_vif_d—ùiv©e
;

831 
»t
 = 
	`¦si_mlme_£t_chªÃl
(
sdev
, 
dev
, 
chª
, 
du¿tiÚ
, 
š‹rv®
, 
couÁ
);

832 ià(
»t
 != 0) {

833 
	`SLSI_NET_ERR
(
dev
, "Set channel for unsync vif failed\n");

834 
ex™_w™h_vif_d—ùiv©e
;

836 
ndev_vif
->
chª
 = chan;

837 
ndev_vif
->
driv”_chªÃl
 = 
chª
->
hw_v®ue
;

845 
	`¦si_p2p_queue_unsync_vif_d–_wÜk
(
ndev_vif
, 
š‹rv®
 * 
couÁ
 + 1000);

846 
ndev_vif
->
unsync
.
li¡’_ofæßd
 = 
Œue
;

847 
	`SLSI_P2P_STATE_CHANGE
(
ndev_vif
->
sdev
, 
P2P_LISTENING
);

848 
ex™
;

850 
ex™_w™h_vif_d—ùiv©e
:

851 
	`¦si_p2p_vif_d—ùiv©e
(
sdev
, 
dev
, 
Œue
);

852 
ex™
:

853 
	`kä“
(
ioùl_¬gs
);

854 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

855  
»t
;

856 
	}
}

863 
	$¦si_p2p_lo_¡İ
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

865 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

867 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

869 
	`WARN_ON
((!
ndev_vif
->
unsync
.
li¡’_ofæßd
è|| (ndev_vif->
sdev
->
p2p_¡©e
 !ğ
P2P_LISTENING
));

871 
ndev_vif
->
unsync
.
li¡’_ofæßd
 = 
çl£
;

874 ià(
ndev_vif
->
sdev
->
p2p_¡©e
 =ğ
P2P_LISTENING
)

875 
	`¦si_p2p_vif_d—ùiv©e
(
ndev_vif
->
sdev
,‚dev_vif->
wdev
.
Ãtdev
, 
Œue
);

877 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

880 
	}
}

882 
	$¦si_rx_f‹r_add
(
Ãt_deviû
 *
dev
, *
bufãr
, 
buf_Ën
)

884 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

885 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

886 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

887 
»t
 = 0;

888 
f‹r_num
 = 0;

890 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
bufãr
, 
buf_Ën
, 1);

891 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

893 
f‹r_num
 = *
ioùl_¬gs
->
¬gs
[0] - '0';

894 ià(
f‹r_num
 < 0 || filter_num > 3) {

895 
	`SLSI_ERR
(
sdev
, "Inv®id v®uoàf‹r_num %d\n", 
f‹r_num
);

896 
	`kä“
(
ioùl_¬gs
);

897  -
EINVAL
;

899 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

900 
sdev
->
deviû_cÚfig
.
rx_f‹r_num
 = 
f‹r_num
;

901 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

903 
	`kä“
(
ioùl_¬gs
);

904  
»t
;

905 
	}
}

907 
	$¦si_rx_f‹r_»move
(
Ãt_deviû
 *
dev
, *
bufãr
, 
buf_Ën
)

909 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

910 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

912 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

913 
sdev
->
deviû_cÚfig
.
rx_f‹r_num
 = 0;

914 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

917 
	}
}

919 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


920 #ià!
defšed
(
CONFIG_SCSC_WLAN_MHS_STATIC_INTERFACE
è|| (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 9)

921 
	$¦si_ü—‹_š‹rçû
(
Ãt_deviû
 *
dev
, *
bufãr
, 
buf_Ën
)

923 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

924 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

925 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

926 
Ãt_deviû
 *
­_dev
;

927 *
štf_Çme
 = 
NULL
;

929 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
bufãr
, 
buf_Ën
, 1);

930 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

932 
štf_Çme
 = 
ioùl_¬gs
->
¬gs
[0];

933 ià(
	`¡rcmp
(
CONFIG_SCSC_AP_INTERFACE_NAME
, 
štf_Çme
) != 0) {

934 
	`SLSI_NET_ERR
(
dev
, "C»©iÚ oà% nÙ‡Îowed!\n", 
štf_Çme
);

935 
	`kä“
(
ioùl_¬gs
);

936  -
EINVAL
;

938 
­_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2PX_SWLAN
);

939 ià(
­_dev
 && (
	`¡rcmp
×p_dev->
Çme
, 
štf_Çme
) == 0)) {

940 
	`SLSI_NET_ERR
(
dev
, "% ®»ady c»©ed\n", 
štf_Çme
);

941 
	`kä“
(
ioùl_¬gs
);

942  -
EINVAL
;

945 
­_dev
 = 
	`¦si_dyÇmic_š‹rçû_ü—‹
(
sdev
->
why
, 
štf_Çme
, 
NL80211_IFTYPE_AP
, 
NULL
);

946 ià(
­_dev
) {

947 
sdev
->
Ãtdev_­
 = 
­_dev
;

948 
	`kä“
(
ioùl_¬gs
);

952 
	`SLSI_NET_ERR
(
dev
, "FaedØü—‹ AP iÁ”çû %s\n", 
štf_Çme
);

953 
	`kä“
(
ioùl_¬gs
);

954  -
EINVAL
;

955 
	}
}

957 
	$¦si_d–‘e_š‹rçû
(
Ãt_deviû
 *
dev
, *
bufãr
, 
buf_Ën
)

959 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

960 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

961 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

962 *
štf_Çme
 = 
NULL
;

964 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
bufãr
, 
buf_Ën
, 1);

965 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

967 
štf_Çme
 = 
ioùl_¬gs
->
¬gs
[0];

968 ià(
	`¡rcmp
(
CONFIG_SCSC_AP_INTERFACE_NAME
, 
štf_Çme
) != 0) {

969 
	`SLSI_NET_ERR
(
dev
, "D–‘iÚ oà% nÙ‡Îowed!\n", 
štf_Çme
);

970 
	`kä“
(
ioùl_¬gs
);

971  -
EINVAL
;

973 ià(
	`¡rcmp
(
štf_Çme
, 
CONFIG_SCSC_AP_INTERFACE_NAME
) == 0)

974 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2PX_SWLAN
);

976 ià(!
dev
) {

977 
	`SLSI_WARN
(
sdev
, "AP dev is NULL");

978 
	`kä“
(
ioùl_¬gs
);

979  -
EINVAL
;

981 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

983 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

984 ià(
ndev_vif
->
aùiv©ed
)

985 
	`¦si_¡İ_Ãt_dev
(
sdev
, 
dev
);

986 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

987 
	`¦si_Ãtif_»move_¹Êl_locked
(
sdev
, 
dev
);

989 
sdev
->
Ãtdev_­
 = 
NULL
;

990 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "SucûssfuÎy d–‘ed AP iÁ”çû % ", 
štf_Çme
);

992 
	`kä“
(
ioùl_¬gs
);

994 
	}
}

997 
	$¦si_g‘_šdoÜ_chªÃls
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

999 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1000 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1001 
İ
[150] = "";

1002 
št_¡ršg
[30] = "";

1003 
i
;

1004 
Ën
 = 0;

1006 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "GET_INDOOR_CHANNELS : %d\n", 
sdev
->
num_5g_»¡riùed_chªÃls
);

1008 
i
 = 0; i < 
sdev
->
num_5g_»¡riùed_chªÃls
; i++) {

1009 
	`¥rštf
(
št_¡ršg
, "%d", 
sdev
->
wifi_sh¬šg_5g_»¡riùed_chªÃls
[
i
]);

1010 
	`¡rÿt
(
İ
, 
št_¡ršg
);

1011 
	`¡rÿt
(
İ
, " ");

1014 
Ën
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "%d %s", 
sdev
->
num_5g_»¡riùed_chªÃls
, 
İ
);

1016  
Ën
;

1017 
	}
}

1020 
	$¦si_Ëgacy_rßm_Œigg”_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1022 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1023 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1024 
Œigg”_v®ue
 = 0;

1025 
»t
 = 0;

1026 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1028 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

1029 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1031 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
Œigg”_v®ue
)) {

1032 
	`SLSI_ERR
(
sdev
, "Inv®idrigg”_v®ue: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1033 
	`kä“
(
ioùl_¬gs
);

1034  -
EINVAL
;

1037 ià(
Œigg”_v®ue
 > -50 ||rigger_value < -100) {

1038 
	`SLSI_ERR
(
sdev
, "Inv®idrigg”_v®ue: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1039 
	`kä“
(
ioùl_¬gs
);

1040  -
EINVAL
;

1043 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1044 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1045 ià(
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1046 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO isƒnabled\n");

1047 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1048 
	`kä“
(
ioùl_¬gs
);

1049  -
EINVAL
;

1051 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1054 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1055 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

1056 
	`SLSI_NET_ERR
(
dev
, "sta is‚ot in connected state\n");

1057 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1058 
	`kä“
(
ioùl_¬gs
);

1059  -
EPERM
;

1061 
»t
 = 
	`¦si_mlme_£t_rßmšg_·¿m‘”s
(
sdev
, 
dev
, 
SLSI_PSID_UNIFI_ROAM_RSSI_SCAN_TRIGGER
, 
Œigg”_v®ue
, 1);

1062 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1064 
	`kä“
(
ioùl_¬gs
);

1065  
»t
;

1066 
	}
}

1068 
	$¦si_Ëgacy_rßm_sÿn_Œigg”_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1070 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1071 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1072 
mib_v®ue
 = 0;

1073 
»s
 = 0;

1075 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1076 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1077 ià(
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1078 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO isƒnabled\n");

1079 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1080  -
EINVAL
;

1082 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1085 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_RSSI_SCAN_TRIGGER
, &
mib_v®ue
);

1086 ià(
»s
)

1087  
»s
;

1088 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETROAMTRIGGER
, 
mib_v®ue
);

1089  
»s
;

1090 
	}
}

1092 
	$¦si_rßm_add_sÿn_chªÃls_Ëgacy
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1094 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1095 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1096 
»suÉ
 = 0;

1097 
i
, 
j
, 
Ãw_chªÃl_couÁ
 = 0;

1098 
Ãw_chªÃls
[
SLSI_MAX_CHANNEL_LIST
];

1099 
cu¼_chªÃl_couÁ
 = 0;

1100 
found
 = 0;

1101 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1102 cÚ¡ 
u8
 *
cÚÃùed_ssid
 = 
NULL
;

1103 
u32
 
ÃtwÜk_m­_chªÃls_couÁ
 = 0;

1104 
u8
 
ÃtwÜk_m­_chªÃls
[
SLSI_ROAMING_CHANNELS_MAX
];

1105 
u8
 
m”ged_chªÃls
[
SLSI_ROAMING_CHANNELS_MAX
 * 2];

1106 
u32
 
m”ge_chª_couÁ
 = 0;

1108 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 21);

1109 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1111 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1112 ià(!
ndev_vif
->
aùiv©ed
 ||‚dev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
 ||

1113 
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

1114 
	`SLSI_NET_ERR
(
dev
, "Not‡ STA vif or status is‚ot CONNECTED\n");

1115 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1116 
	`kä“
(
ioùl_¬gs
);

1117  -
EPERM
;

1119 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1120 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1121 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1122 ià(
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1123 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO isƒnabled\n");

1124 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1125 
	`kä“
(
ioùl_¬gs
);

1126  -
EINVAL
;

1130 ià(
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
 =ğ
SLSI_MAX_CHANNEL_LIST
) {

1131 
	`SLSI_ERR
(
sdev
, "Roam scan†ist is‡lready full\n");

1132 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1133 
	`kä“
(
ioùl_¬gs
);

1134  -
EINVAL
;

1138 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1139 ià(
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
 == 0) {

1140 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
 = 1;

1141 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
chªÃls
[0] = 
ndev_vif
->
chª
->
hw_v®ue
;

1143 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1144 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
Ãw_chªÃl_couÁ
)) {

1145 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃl_couÁ sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1146 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1147 
	`kä“
(
ioùl_¬gs
);

1148  -
EINVAL
;

1151 ià(
Ãw_chªÃl_couÁ
 < 1 ||‚ew_chªÃl_couÁ > 
SLSI_MAX_CHANNEL_LIST
 || (
ioùl_¬gs
->
¬g_couÁ
 - 1) <‚ew_channel_count) {

1152 
	`SLSI_ERR
(
sdev
, "Inv®id v®uoàchªÃl_couÁ %d\n", 
Ãw_chªÃl_couÁ
);

1153 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1154 
	`kä“
(
ioùl_¬gs
);

1155  -
EINVAL
;

1157 
cu¼_chªÃl_couÁ
 = 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
;

1159 
i
 = 0; i < 
Ãw_chªÃl_couÁ
; i++) {

1160 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[
i
 + 1], &
Ãw_chªÃls
[i])) {

1161 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1162 
	`kä“
(
ioùl_¬gs
);

1163  -
EINVAL
;

1165 ià(
Ãw_chªÃls
[
i
] < 1 ||‚ew_channels[i] > 165) {

1166 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
Ãw_chªÃls
[
i
]);

1167 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1168 
	`kä“
(
ioùl_¬gs
);

1169  -
EINVAL
;

1171 
j
 = 0; j < 
cu¼_chªÃl_couÁ
; j++) {

1172 
found
 = 0;

1173 ià(
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
chªÃls
[
j
] =ğ
Ãw_chªÃls
[
i
]) {

1174 
found
 = 1;

1178 ià(!
found
) {

1179 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
chªÃls
[
cu¼_chªÃl_couÁ
] = 
Ãw_chªÃls
[
i
];

1180 
cu¼_chªÃl_couÁ
++;

1182 ià(
cu¼_chªÃl_couÁ
 >ğ
SLSI_MAX_CHANNEL_LIST
) {

1183 
cu¼_chªÃl_couÁ
 = 
SLSI_MAX_CHANNEL_LIST
;

1188 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
 = 
cu¼_chªÃl_couÁ
;

1190 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1191 
cÚÃùed_ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,

1192 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
Ën
);

1194 
ÃtwÜk_m­_chªÃls_couÁ
 = 
	`¦si_rßmšg_sÿn_cÚfigu»_chªÃls
(
sdev
, 
dev
, 
cÚÃùed_ssid
, 
ÃtwÜk_m­_chªÃls
);

1195 
m”ge_chª_couÁ
 = 
	`¦si_m”ge_li¡s
(
ÃtwÜk_m­_chªÃls
, 
ÃtwÜk_m­_chªÃls_couÁ
,

1196 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
chªÃls
,

1197 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
,

1198 
m”ged_chªÃls
);

1200 
»suÉ
 = 
	`¦si_mlme_£t_ÿched_chªÃls
(
sdev
, 
dev
, 
m”ge_chª_couÁ
, 
m”ged_chªÃls
);

1201 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1202 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1204 
	`kä“
(
ioùl_¬gs
);

1205  
»suÉ
;

1206 
	}
}

1208 
	$¦si_rßm_sÿn_chªÃls_»ad_Ëgacy
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1210 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1211 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1212 
u16
 
chªÃl_li¡
[
MAX_CHANNEL_COUNT
] = {0};

1213 
sk_buff
 *
šd
 = 
NULL
;

1214 
pos
 = 0;

1215 
i
;

1216 
chªÃl_couÁ
 = 0;

1218 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1219 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1220 ià(
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1221 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO isƒnabled\n");

1222 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1223  -
EINVAL
;

1225 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1227 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1228 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

1229 
	`SLSI_NET_ERR
(
dev
, "STA is‚ot in connected state\n");

1230 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1231 
chªÃl_couÁ
 = 0;

1232 
ouut
;

1235 
šd
 = 
	`¦si_mlme_rßmšg_chªÃl_li¡_»q
(
sdev
, 
dev
);

1236 ià(!
šd
) {

1237 
	`SLSI_ERR
(
sdev
, "RCL ind is NULL!\n");

1238 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1239  -
EINVAL
;

1242 
chªÃl_couÁ
 = 
	`¦si_g‘_rş_chªÃl_li¡
(
sdev
, 
šd
, 
chªÃl_li¡
);

1243 ià(!
chªÃl_couÁ
) {

1244 
	`SLSI_ERR
(
sdev
, "Channel count is 0!");

1245 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1246  -
EINVAL
;

1248 
ouut
:

1249 
pos
 = 
	`sú´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETROAMSCANCHANNELS
, 
chªÃl_couÁ
);

1250 
i
 = 0; i < 
chªÃl_couÁ
; i++)

1251 
pos
 +ğ
	`sú´štf
(
commªd
 +…os, 
buf_Ën
 -…os, " %d", 
chªÃl_li¡
[
i
]);

1253 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1254  
pos
;

1255 
	}
}

1257 
	$¦si_»assoc_wr™e_Ëgacy
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1259 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1260 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1261 
u8
 
bssid
[6] = { 0 };

1262 
chªÃl
;

1263 
äeq
;

1264 
Æ80211_bªd
 
bªd
 = 
NL80211_BAND_2GHZ
;

1265 
r
 = 0;

1266 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1268 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 2);

1269 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1271 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1272 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1273 ià(
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1274 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO isƒnabled\n");

1275 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1276 
	`kä“
(
ioùl_¬gs
);

1277  -
EINVAL
;

1279 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1281 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]) != 17) {

1282 
	`SLSI_ERR
(
sdev
, "Inv®id MAC‡dd»s Ëngth :%d\n", ()
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]));

1283 
	`kä“
(
ioùl_¬gs
);

1284  -
EINVAL
;

1287 
	`¦si_machex¡ršg_to_maÿ¼ay
(
ioùl_¬gs
->
¬gs
[0], 
bssid
);

1288 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
chªÃl
)) {

1289 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ¡ršg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

1290 
	`kä“
(
ioùl_¬gs
);

1291  -
EINVAL
;

1294 ià(
chªÃl
 < 1 || channel > 165) {

1295 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
chªÃl
);

1296 
	`kä“
(
ioùl_¬gs
);

1297  -
EINVAL
;

1300 ià(
chªÃl
 > 14)

1301 
bªd
 = 
NL80211_BAND_5GHZ
;

1302 
äeq
 = (
u16
)
	`›“80211_chªÃl_to_äequ’cy
(
chªÃl
, 
bªd
);

1304 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1305 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1307 
r
 = 
	`¦si_mlme_rßm
(
sdev
, 
dev
, 
bssid
, 
äeq
);

1309 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1310 
	`kä“
(
ioùl_¬gs
);

1311  
r
;

1312 
	}
}

1314 
	$¦si_£t_couÁry_»v
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

1316 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1317 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1318 
®pha2_»v
[] = {0, 0, 0, 0};

1319 
¡©us
 = 0;

1320 *
couÁry_code
 = 
NULL
;

1321 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1323 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 1);

1324 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1326 
couÁry_code
 = 
ioùl_¬gs
->
¬gs
[0];

1327 
	`memıy
(
®pha2_»v
, 
couÁry_code
, 
	`¡¾’
(country_code) < 4 ? strlen(country_code) : 4);

1329 
¡©us
 = 
	`¦si_£t_couÁry_upd©e_»gd
(
sdev
, 
®pha2_»v
, 
	`¡¾’
(
couÁry_code
) < 4 ? strlen(country_code) : 4);

1331 
	`kä“
(
ioùl_¬gs
);

1332  
¡©us
;

1333 
	}
}

1335 
	$¦si_g‘_couÁry_»v
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1337 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1338 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1339 
u8
 
buf
[5];

1340 
Ën
 = 0;

1342 
	`mem£t
(
buf
, 0, (buf));

1344 
Ën
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %c%ø%d", 
CMD_GETCOUNTRYREV
,

1345 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->
®pha2
[0],

1346 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->
®pha2
[1],

1347 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->
dfs_»giÚ
);

1349  
Ën
;

1350 
	}
}

1352 
	$¦si_äeq_bªd_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

1354 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1355 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1356 
ušt
 
bªd
 = 0;

1357 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1358 
»t
 = 0;

1360 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1362 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 1);

1363 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1365 
bªd
 = *
ioùl_¬gs
->
¬gs
[0] - '0';

1366 ià(
bªd
 > 2) {

1367 
	`SLSI_ERR
(
sdev
, "Inv®id v®u: Bªd Mu¡ b0/1/2 bªd %d\n", 
bªd
);

1368 
	`kä“
(
ioùl_¬gs
);

1369  -
EINVAL
;

1372 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1373 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1374 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1375 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1376 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1377 
	`kä“
(
ioùl_¬gs
);

1378  -
EINVAL
;

1381 ià(
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
 =ğ
bªd
) {

1382 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "bªd i ®»ady %d\n", 
bªd
);

1383 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1384 
	`kä“
(
ioùl_¬gs
);

1385  
»t
;

1387 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1389 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1390 
»t
 = 
	`¦si_mlme_£t_bªd_»q
(
sdev
, 
dev
, 
bªd
);

1391 ià(
»t
 =ğ-
EIO
) {

1392 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1393 
	`kä“
(
ioùl_¬gs
);

1394  
»t
;

1396 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1398 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1399 
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
 = 
bªd
;

1400 
	`¦si_bªd_cfg_upd©e
(
sdev
, 
bªd
);

1401 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1403 
	`kä“
(
ioùl_¬gs
);

1404  
»t
;

1406 
	`SLSI_ERR
(
sdev
, "NCHO is‚ot supported\n");

1408 
	`kä“
(
ioùl_¬gs
);

1409  -
EINVAL
;

1411 
	}
}

1413 
	$¦si_äeq_bªd_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1415 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1416 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1417 
pos
 = 0;

1419 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1421 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1422 ià(
	`¦si_is_‹¡_mode_’abËd
(è|| 
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1424 ià(
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1426 
pos
 = 
	`sú´štf
(
commªd
, 
buf_Ën
, "Bªd %d", 
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
);

1428 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1429 
pos
 = -
EINVAL
;

1432 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1433  
pos
;

1434 
	}
}

1436 
	$¦si_çùÜy_äeq_bªd_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

1438 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1439 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1440 
ušt
 
bªd
 = 0;

1441 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1443 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 1);

1444 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1446 
bªd
 = *
ioùl_¬gs
->
¬gs
[0] - '0';

1447 ià(
bªd
 > 2) {

1448 
	`SLSI_ERR
(
sdev
, "Inv®id v®u: Bªd Mu¡ b0/1/2 bªd %d\n", 
bªd
);

1449 
	`kä“
(
ioùl_¬gs
);

1450  -
EINVAL
;

1453 
	`¦si_bªd_upd©e
(
sdev
, 
bªd
);

1455 
	`kä“
(
ioùl_¬gs
);

1456  
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_SCAN_BAND
, (
bªd
 =ğ
SLSI_FREQ_BAND_AUTO
) ? 2 : 1);

1457 
	}
}

1459 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


1460 
	$¦si_rßm_sÿn_Œigg”_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1462 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1463 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1464 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1465 
mib_v®ue
 = 0;

1466 
»t
 = 0;

1468 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

1469 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1471 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1472 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1473 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1474 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1475 
	`kä“
(
ioùl_¬gs
);

1476  -
EINVAL
;

1478 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1480 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

1481 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1482 
	`kä“
(
ioùl_¬gs
);

1483  -
EINVAL
;

1486 ià(
mib_v®ue
 > -50 || mib_value < -100) {

1487 
	`SLSI_ERR
(
sdev
, "Inv®idrigg”_v®ue: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1488 
	`kä“
(
ioùl_¬gs
);

1489  -
EINVAL
;

1492 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1493 
»t
 = 
	`¦si_mlme_£t_rßmšg_·¿m‘”s
(
sdev
, 
dev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_RSSI_TRIGGER
, 
mib_v®ue
, 1);

1494 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1495 
	`kä“
(
ioùl_¬gs
);

1496  
»t
;

1497 
	}
}

1499 
	$¦si_rßm_sÿn_Œigg”_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1501 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1502 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1503 
mib_v®ue
 = 0;

1504 
»s
;

1506 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1507 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1508 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1509 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1510  -
EINVAL
;

1512 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1514 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_RSSI_TRIGGER
, &
mib_v®ue
);

1515 ià(
»s
)

1516  
»s
;

1517 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETROAMTRIGGER
, 
mib_v®ue
);

1518  
»s
;

1519 
	}
}

1521 
	$¦si_rßm_d–_Œigg”_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1523 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1524 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1525 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1526 
mib_v®ue
 = 0;

1527 
»t
 = 0;

1529 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

1530 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1532 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1533 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1534 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1535 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1536 
	`kä“
(
ioùl_¬gs
);

1537  -
EINVAL
;

1539 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1541 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

1542 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1543 
	`kä“
(
ioùl_¬gs
);

1544  -
EINVAL
;

1547 ià(
mib_v®ue
 > 100 || mib_value < 0) {

1548 
	`SLSI_ERR
(
sdev
, "Inv®id d–rigg”_v®ue: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1549 
	`kä“
(
ioùl_¬gs
);

1550  -
EINVAL
;

1553 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1554 
»t
 = 
	`¦si_mlme_£t_rßmšg_·¿m‘”s
(
sdev
, 
dev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_RSSI_DELTA
, 
mib_v®ue
, 1);

1555 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1556 
	`kä“
(
ioùl_¬gs
);

1557  
»t
;

1558 
	}
}

1560 
	$¦si_rßm_d–_Œigg”_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1562 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1563 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1564 
mib_v®ue
 = 0;

1565 
»s
;

1567 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1568 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1569 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1570 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1571  -
EINVAL
;

1573 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1575 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_RSSI_DELTA
, &
mib_v®ue
);

1576 ià(
»s
)

1577  
»s
;

1579 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETROAMDELTA
, 
mib_v®ue
);

1580  
»s
;

1581 
	}
}

1583 
	$¦si_»assoc_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1585 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1586 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1587 
u8
 
bssid
[6] = { 0 };

1588 
chªÃl
 = 0;

1589 
äeq
 = 0;

1590 
Æ80211_bªd
 
bªd
 = 
NL80211_BAND_2GHZ
;

1591 
r
 = 0;

1592 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1594 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 2);

1595 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1597 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1598 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1599 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1600 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1601 
	`kä“
(
ioùl_¬gs
);

1602  -
EINVAL
;

1604 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1605 ià(
ioùl_¬gs
->
¬g_couÁ
 != 2) {

1606 
	`SLSI_ERR
(
sdev
, "Notƒnough‡rguments\n");

1607 
	`kä“
(
ioùl_¬gs
);

1608  -
EINVAL
;

1611 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]) != 17) {

1612 
	`SLSI_ERR
(
sdev
, "Inv®id MAC‡dd»s Ëngth :%d\n", ()
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]));

1613 
	`kä“
(
ioùl_¬gs
);

1614  -
EINVAL
;

1617 
	`¦si_machex¡ršg_to_maÿ¼ay
(
ioùl_¬gs
->
¬gs
[0], 
bssid
);

1619 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
chªÃl
)) {

1620 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ¡ršg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

1621 
	`kä“
(
ioùl_¬gs
);

1622  -
EINVAL
;

1625 ià(
chªÃl
 < 1 || channel > 165) {

1626 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
chªÃl
);

1627 
	`kä“
(
ioùl_¬gs
);

1628  -
EINVAL
;

1631 ià(
chªÃl
 > 14)

1632 
bªd
 = 
NL80211_BAND_5GHZ
;

1633 
äeq
 = (
u16
)
	`›“80211_chªÃl_to_äequ’cy
(
chªÃl
, 
bªd
);

1635 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1636 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1638 
r
 = 
	`¦si_mlme_rßm
(
sdev
, 
dev
, 
bssid
, 
äeq
);

1640 
	`kä“
(
ioùl_¬gs
);

1641 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1642  
r
;

1643 
	}
}

1645 
	$¦si_ÿched_chªÃl_sÿn_³riod_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1647 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1648 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1649 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1650 
mib_v®ue
 = 0;

1651 
»t
 = 0;

1653 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

1654 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1656 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1657 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1658 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1659 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1660 
	`kä“
(
ioùl_¬gs
);

1661  -
EINVAL
;

1663 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1665 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

1666 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1667 
	`kä“
(
ioùl_¬gs
);

1668  -
EINVAL
;

1671 ià(
mib_v®ue
 > 60 || mib_value < 0) {

1672 
	`SLSI_ERR
(
sdev
, "Inv®id„ßm sÿÀ³riod: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1673 
	`kä“
(
ioùl_¬gs
);

1674  -
EINVAL
;

1676 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1677 
»t
 = 
	`¦si_mlme_£t_rßmšg_·¿m‘”s
(
sdev
, 
dev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_CACHED_SCAN_PERIOD
, 
mib_v®ue
 * 1000000, 4);

1678 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1679 
	`kä“
(
ioùl_¬gs
);

1680  
»t
;

1681 
	}
}

1683 
	$¦si_ÿched_chªÃl_sÿn_³riod_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1685 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1686 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1687 
mib_v®ue
 = 0;

1688 
»s
;

1690 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1691 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1692 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1693 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1694  -
EINVAL
;

1696 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1698 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_CACHED_SCAN_PERIOD
, &
mib_v®ue
);

1699 ià(
»s
)

1700  
»s
;

1702 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETROAMSCANPERIOD
, 
mib_v®ue
 / 1000000);

1704  
»s
;

1705 
	}
}

1707 
	$¦si_fuÎ_rßm_sÿn_³riod_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1709 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1710 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1711 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1712 
mib_v®ue
 = 0;

1713 
»t
 = 0;

1715 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

1716 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1718 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1719 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1720 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1721 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1722 
	`kä“
(
ioùl_¬gs
);

1723  -
EINVAL
;

1725 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1727 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

1728 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1729 
	`kä“
(
ioùl_¬gs
);

1730  -
EINVAL
;

1732 ià(
mib_v®ue
 > 600 || mib_value < 0) {

1733 
	`SLSI_ERR
(
sdev
, "Inv®id fuÎ„ßm sÿÀ³riod: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1734 
	`kä“
(
ioùl_¬gs
);

1735  -
EINVAL
;

1737 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1738 
»t
 = 
	`¦si_mlme_£t_rßmšg_·¿m‘”s
(
sdev
, 
dev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_FULL_SCAN_PERIOD
, 
mib_v®ue
 * 1000000, 4);

1739 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1740 
	`kä“
(
ioùl_¬gs
);

1741  
»t
;

1742 
	}
}

1744 
	$¦si_fuÎ_rßm_sÿn_³riod_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1746 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1747 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1748 
mib_v®ue
 = 0;

1749 
»s
;

1751 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1752 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1753 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1754 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1755  -
EINVAL
;

1757 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1759 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_FULL_SCAN_PERIOD
, &
mib_v®ue
);

1760 ià(
»s
)

1761  
»s
;

1763 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETFULLROAMSCANPERIOD
, 
mib_v®ue
 / 1000000);

1765  
»s
;

1766 
	}
}

1768 
	$¦si_rßm_sÿn_max_aùive_chªÃl_time_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1770 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1771 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1772 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1773 
mib_v®ue
 = 0;

1775 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

1776 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1778 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1779 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1780 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1781 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1782 
	`kä“
(
ioùl_¬gs
);

1783  -
EINVAL
;

1785 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1787 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

1788 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1789 
	`kä“
(
ioùl_¬gs
);

1790  -
EINVAL
;

1792 ià(
mib_v®ue
 > 300 || mib_value < 3) {

1793 
	`SLSI_ERR
(
sdev
, "Inv®id sÿÀchªÃÈtime: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1794 
	`kä“
(
ioùl_¬gs
);

1795  -
EINVAL
;

1798 
	`kä“
(
ioùl_¬gs
);

1799  
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_MAX_ACTIVE_CHANNEL_TIME
, 
mib_v®ue
);

1800 
	}
}

1802 
	$¦si_rßm_sÿn_max_aùive_chªÃl_time_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1804 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1805 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1806 
mib_v®ue
 = 0;

1807 
»s
;

1809 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1810 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1811 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1812 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1813  -
EINVAL
;

1815 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1817 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_MAX_ACTIVE_CHANNEL_TIME
, &
mib_v®ue
);

1818 ià(
»s
)

1819  
»s
;

1821 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETSCANCHANNELTIME
, 
mib_v®ue
);

1823  
»s
;

1824 
	}
}

1826 
	$¦si_rßm_sÿn_´obe_š‹rv®_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1828 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1829 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1830 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1831 
mib_v®ue
 = 0;

1833 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

1834 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1836 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1837 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1838 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1839 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1840 
	`kä“
(
ioùl_¬gs
);

1841  -
EINVAL
;

1843 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1845 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

1846 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1847 
	`kä“
(
ioùl_¬gs
);

1848  -
EINVAL
;

1850 ià(
mib_v®ue
 > 10 || mib_value < 1) {

1851 
	`SLSI_ERR
(
sdev
, "Inv®id sÿÀ´obes: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1852 
	`kä“
(
ioùl_¬gs
);

1853  -
EINVAL
;

1856 
	`kä“
(
ioùl_¬gs
);

1857  
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_NPROBE
, 
mib_v®ue
);

1858 
	}
}

1860 
	$¦si_rßm_sÿn_´obe_š‹rv®_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1862 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1863 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1864 
mib_v®ue
 = 0;

1865 
»s
;

1867 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1868 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1869 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1870 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1871  -
EINVAL
;

1873 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1875 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_NPROBE
, &
mib_v®ue
);

1876 ià(
»s
)

1877  
»s
;

1879 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETSCANNPROBES
, 
mib_v®ue
);

1881  
»s
;

1882 
	}
}

1884 
	$¦si_rßm_mode_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1886 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1887 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1888 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1889 
mib_v®ue
 = 0;

1891 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

1892 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1894 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1895 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1896 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1897 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1898 
	`kä“
(
ioùl_¬gs
);

1899  -
EINVAL
;

1901 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1903 ià(
	`¦si_is_rf_‹¡_mode_’abËd
()) {

1904 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "SLSI_PSID_UNIFI_ROAM_MODE is‚ot supported because of„fest mode.\n");

1905 
	`kä“
(
ioùl_¬gs
);

1906  -
ENOTSUPP
;

1909 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

1910 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1911 
	`kä“
(
ioùl_¬gs
);

1912  -
EINVAL
;

1914 ià(
mib_v®ue
 < 0 || mib_value > 2) {

1915 
	`SLSI_ERR
(
sdev
, "Inv®id„ßm modv®ue: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1916 
	`kä“
(
ioùl_¬gs
);

1917  -
EINVAL
;

1920 
	`kä“
(
ioùl_¬gs
);

1921  
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_MODE
, 
mib_v®ue
);

1922 
	}
}

1924 
	$¦si_rßm_mode_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1926 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1927 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1928 
mib_v®ue
 = 0;

1929 
»s
;

1931 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1932 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

1933 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

1934 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1935  -
EINVAL
;

1937 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1939 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_MODE
, &
mib_v®ue
);

1940 ià(
»s
)

1941  
»s
;

1943 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETROAMMODE
, 
mib_v®ue
);

1945  
»s
;

1946 
	}
}

1948 
	$¦si_rßm_ofæßd_­_li¡
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

1950 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1951 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1952 
cfg80211_aş_d©a
 *
mac_aş
;

1953 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

1954 
­_couÁ
 = 0;

1955 
i
, 
r
;

1956 
m®loc_Ën
;

1958 
	`¦si_cÚv”t_¥aû_£³¿tiÚ
(
commªd
, 
buf_Ën
);

1959 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 101);

1960 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

1967 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
­_couÁ
)) {

1968 
	`SLSI_ERR
(
sdev
, "Inv®id‡p_couÁ sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

1969 
	`kä“
(
ioùl_¬gs
);

1970  -
EINVAL
;

1972 ià(
­_couÁ
 < 
ROAMOFFLAPLIST_MIN
 ||‡p_couÁ > 
ROAMOFFLAPLIST_MAX
) {

1973 
	`SLSI_ERR
(
sdev
, "Inv®id‡p_couÁ: %d\n", 
­_couÁ
);

1974 
	`kä“
(
ioùl_¬gs
);

1975  -
EINVAL
;

1980 ià((
ioùl_¬gs
->
¬g_couÁ
 - 1è< 
­_couÁ
) {

1981 
	`SLSI_ERR
(
sdev
, "Bufã¸dÛ¢'ˆhav’ough f›ld ­_couÁ: %d\n", 
­_couÁ
);

1982 
	`kä“
(
ioùl_¬gs
);

1983  -
EINVAL
;

1985 
m®loc_Ën
 = (
cfg80211_aş_d©a
è+ (
mac_add»ss
è* 
­_couÁ
;

1986 
mac_aş
 = 
	`km®loc
(
m®loc_Ën
, 
GFP_KERNEL
);

1987 ià(!
mac_aş
) {

1988 
	`SLSI_ERR
(
sdev
, "MEM fa fÜ size:%ld\n", (
cfg80211_aş_d©a
è+ (
mac_add»ss
è* 
­_couÁ
);

1989 
	`kä“
(
ioùl_¬gs
);

1990  -
ENOMEM
;

1993 
i
 = 1; i <ğ
­_couÁ
; i++) {

1994 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[
i
]) != 17) {

1995 
	`SLSI_ERR
(
sdev
, "Inv®id MAC‡dd»s Ëngth :%d\n", ()
	`¡¾’
(
ioùl_¬gs
->
¬gs
[
i
]));

1996 
	`kä“
(
ioùl_¬gs
);

1997 
	`kä“
(
mac_aş
);

1998  -
EINVAL
;

2000 
	`¦si_machex¡ršg_to_maÿ¼ay
(
ioùl_¬gs
->
¬gs
[
i
], 
mac_aş
->
mac_addrs
[i].
addr
);

2001 
	`SLSI_DBG3_NODEV
(
SLSI_MLME
, "[%pM]", 
mac_aş
->
mac_addrs
[
i
].
addr
);

2003 
mac_aş
->
aş_pŞicy
 = 
NL80211_ACL_POLICY_DENY_UNLESS_LISTED
;

2004 
mac_aş
->
n_aş_’Œ›s
 = 
­_couÁ
;

2006 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2007 
r
 = 
	`¦si_mlme_£t_aş
(
sdev
, 
dev
, 
ndev_vif
->
iâum
, 
mac_aş
->
aş_pŞicy
, mac_aş->
n_aş_’Œ›s
, mac_aş->
mac_addrs
);

2008 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2009 
	`kä“
(
mac_aş
);

2010 
	`kä“
(
ioùl_¬gs
);

2011  
r
;

2012 
	}
}

2014 
	$¦si_rßm_sÿn_bªd_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2016 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2017 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2018 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2019 
mib_v®ue
 = 0;

2021 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

2022 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2024 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2025 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2026 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2027 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2028 
	`kä“
(
ioùl_¬gs
);

2029  -
EINVAL
;

2031 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2033 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

2034 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2035 
	`kä“
(
ioùl_¬gs
);

2036  -
EINVAL
;

2038 ià(
mib_v®ue
 != 1 && mib_value != 2) {

2039 
	`SLSI_ERR
(
sdev
, "Inv®id„ßm sÿÀbªd v®ue: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2040 
	`kä“
(
ioùl_¬gs
);

2041  -
EINVAL
;

2044 
	`kä“
(
ioùl_¬gs
);

2045  
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_SCAN_BAND
, 
mib_v®ue
);

2046 
	}
}

2048 
	$¦si_rßm_sÿn_bªd_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2050 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2051 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2052 
mib_v®ue
 = 0;

2053 
»s
;

2055 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2056 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2057 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2058 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2059  -
EINVAL
;

2061 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2063 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_SCAN_BAND
, &
mib_v®ue
);

2064 ià(
»s
)

2065  
»s
;

2067 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETROAMINTRABAND
, 
mib_v®ue
);

2069  
»s
;

2070 
	}
}

2072 
	$¦si_rßm_sÿn_cÚŒŞ_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2074 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2075 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2076 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2077 
mode
 = 0;

2078 
»s
 = 0;

2080 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

2081 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2083 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2084 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2085 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2086 
»s
 = -
EINVAL
;

2087 
ex™
;

2090 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mode
)) {

2091 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2092 
»s
 = -
EINVAL
;

2093 
ex™
;

2096 ià(
mode
 == 0 || mode == 1) {

2097 
sdev
->
deviû_cÚfig
.
rßm_sÿn_mode
 = 
mode
;

2099 
	`SLSI_ERR
(
sdev
, "Inv®id„ßm Mode: Mu¡ b0 or, 1 NÙ '%d'\n", 
mode
);

2100 
»s
 = -
EINVAL
;

2101 
ex™
;

2104 
»s
 = 
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_CONTROL
, sdev->
deviû_cÚfig
.
rßm_sÿn_mode
);

2105 ià(
»s
)

2106 
ex™
;

2109 ià(!
mode
) {

2110 
	`mem£t
(&
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
, 0, (
¦si_rßm_sÿn_chªÃls
));

2111 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2112 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2113 
»s
 = 
	`¦si_mlme_£t_ÿched_chªÃls
(
sdev
, 
dev
, 0, 
NULL
);

2114 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2115 
	`kä“
(
ioùl_¬gs
);

2116  
»s
;

2119 
ex™
:

2120 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2121 
	`kä“
(
ioùl_¬gs
);

2122  
»s
;

2123 
	}
}

2125 
	$¦si_rßm_sÿn_cÚŒŞ_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2127 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2128 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2129 
mib_v®ue
 = 0;

2130 
»s
;

2132 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2133 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2134 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2135 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2136  -
EINVAL
;

2138 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2140 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_CONTROL
, &
mib_v®ue
);

2141 ià(
»s
)

2142  
»s
;

2144 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETROAMSCANCONTROL
, 
mib_v®ue
);

2146  
»s
;

2147 
	}
}

2149 
	$¦si_rßm_sÿn_home_time_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2151 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2152 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2153 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2154 
mib_v®ue
 = 0;

2156 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

2157 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2159 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2160 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2161 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2162 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2163 
	`kä“
(
ioùl_¬gs
);

2164  -
EINVAL
;

2166 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2168 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

2169 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2170 
	`kä“
(
ioùl_¬gs
);

2171  -
EINVAL
;

2173 ià(
mib_v®ue
 > 300 || mib_value < 3) {

2174 
	`SLSI_ERR
(
sdev
, "Inv®id sÿÀhomtime: '%d'\n", 
mib_v®ue
);

2175 
	`kä“
(
ioùl_¬gs
);

2176  -
EINVAL
;

2179 
	`kä“
(
ioùl_¬gs
);

2180  
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_HOME_TIME
, 
mib_v®ue
);

2181 
	}
}

2183 
	$¦si_rßm_sÿn_home_time_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2185 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2186 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2187 
mib_v®ue
 = 0;

2188 
»s
;

2190 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2191 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2192 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2193 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2194  -
EINVAL
;

2196 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2198 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_HOME_TIME
, &
mib_v®ue
);

2199 ià(
»s
)

2200  
»s
;

2202 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETSCANHOMETIME
, 
mib_v®ue
);

2204  
»s
;

2205 
	}
}

2207 
	$¦si_rßm_sÿn_home_away_time_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2209 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2210 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2211 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2212 
mib_v®ue
 = 0;

2214 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

2215 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2217 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2218 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2219 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2220 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2221 
	`kä“
(
ioùl_¬gs
);

2222  -
EINVAL
;

2224 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2226 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

2227 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2228 
	`kä“
(
ioùl_¬gs
);

2229  -
EINVAL
;

2231 ià(
mib_v®ue
 > 300 || mib_value < 3) {

2232 
	`SLSI_ERR
(
sdev
, "Inv®id sÿÀhomawayime: '%d'\n", 
mib_v®ue
);

2233 
	`kä“
(
ioùl_¬gs
);

2234  -
EINVAL
;

2237 
	`kä“
(
ioùl_¬gs
);

2238  
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_HOME_AWAY_TIME
, 
mib_v®ue
);

2239 
	}
}

2241 
	$¦si_rßm_sÿn_home_away_time_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2243 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2244 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2245 
mib_v®ue
 = 0;

2246 
»s
;

2248 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2249 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2250 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2251 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2252  -
EINVAL
;

2254 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2256 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_HOME_AWAY_TIME
, &
mib_v®ue
);

2257 ià(
»s
)

2258  
»s
;

2260 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETSCANHOMEAWAYTIME
, 
mib_v®ue
);

2262  
»s
;

2263 
	}
}

2265 
ssize_t
 
	$¦si_v®id©e_low_Ï‹ncy_·¿ms
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
, *
Ï‹ncy_·¿m
)

2267 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2268 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2269 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2270 
»t
 = 0;

2272 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

2273 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2275 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], 
Ï‹ncy_·¿m
)) {

2276 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg†©’cy_·¿m: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2277 
»t
 = -
EINVAL
;

2278 } ià(*
Ï‹ncy_·¿m
 < 0 || *latency_param > 0xFFFF) {

2279 
	`SLSI_ERR
(
sdev
, "Inv®id†©’cy_·¿m v®ue: '%d'\n", *
Ï‹ncy_·¿m
);

2280 
»t
 = -
EINVAL
;

2283 
	`kä“
(
ioùl_¬gs
);

2284  
»t
;

2285 
	}
}

2287 
ssize_t
 
	$¦si_£t_low_Ï‹ncy_·¿ms
(
Ãt_deviû
 *
dev
, 
Ï‹ncy_·¿m
)

2289 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2290 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2291 
»t
 = 0;

2293 ià((
sdev
->
Ï‹ncy_·¿m_mask
 & 
LATENCY_ALL_SET_MASK
) == LATENCY_ALL_SET_MASK) {

2294 
	`SLSI_INFO
(
sdev
, "Home Away Time = %d, Homeime = %d, Max Channel Time = %d Passive Time = %d\n",

2295 
sdev
->
home_away_time
, sdev->
home_time
, sdev->
max_chªÃl_time
,

2296 
sdev
->
max_chªÃl_·ssive_time
);

2297 
»t
 = 
	`¦si_mlme_£t_sÿn_mode_»q
(
sdev
, 
dev
, 
FAPI_SCANMODE_LOW_LATENCY
, sdev->
max_chªÃl_time
,

2298 
sdev
->
home_away_time
, sdev->
home_time
, sdev->
max_chªÃl_·ssive_time
);

2299 
sdev
->
Ï‹ncy_·¿m_mask
 = 0;

2300 } ià(
Ï‹ncy_·¿m
 == 0) {

2301 
»t
 = 
	`¦si_mlme_£t_sÿn_mode_»q
(
sdev
, 
dev
, 
FAPI_SCANMODE_LEGACY
, 0, 0, 0, 0);

2302 
sdev
->
Ï‹ncy_·¿m_mask
 = 0;

2305  
»t
;

2306 
	}
}

2308 
	$¦si_£t_home_away_time_Ëgacy
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2310 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2311 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2312 
home_away_time
 = 0;

2313 
»t
 = 0;

2315 
»t
 = 
	`¦si_v®id©e_low_Ï‹ncy_·¿ms
(
dev
, 
commªd
, 
buf_Ën
, &
home_away_time
);

2316 ià(
»t
 != 0)

2317  
»t
;

2319 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2320 
sdev
->
home_away_time
 = home_away_time;

2321 ià(
home_away_time
 != 0)

2322 
sdev
->
Ï‹ncy_·¿m_mask
 |ğ
HOME_AWAY_TIME_BIT
;

2323 
»t
 = 
	`¦si_£t_low_Ï‹ncy_·¿ms
(
dev
, 
home_away_time
);

2324 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2326  
»t
;

2327 
	}
}

2329 
	$¦si_£t_home_time_Ëgacy
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2331 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2332 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2333 
home_time
 = 0;

2334 
»t
 = 0;

2336 
»t
 = 
	`¦si_v®id©e_low_Ï‹ncy_·¿ms
(
dev
, 
commªd
, 
buf_Ën
, &
home_time
);

2337 ià(
»t
 != 0)

2338  
»t
;

2340 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2341 
sdev
->
home_time
 = home_time;

2342 ià(
home_time
 != 0)

2343 
sdev
->
Ï‹ncy_·¿m_mask
 |ğ
HOME_TIME_BIT
;

2344 
»t
 = 
	`¦si_£t_low_Ï‹ncy_·¿ms
(
dev
, 
home_time
);

2345 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2346  
»t
;

2347 
	}
}

2349 
	$¦si_£t_chªÃl_time_Ëgacy
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2351 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2352 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2353 
max_chªÃl_time
 = 0;

2354 
»t
 = 0;

2356 
»t
 = 
	`¦si_v®id©e_low_Ï‹ncy_·¿ms
(
dev
, 
commªd
, 
buf_Ën
, &
max_chªÃl_time
);

2357 ià(
»t
 != 0)

2358  
»t
;

2360 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2361 
sdev
->
max_chªÃl_time
 = max_channel_time;

2362 ià(
max_chªÃl_time
 != 0)

2363 
sdev
->
Ï‹ncy_·¿m_mask
 |ğ
MAX_CHANNEL_TIME_BIT
;

2364 
»t
 = 
	`¦si_£t_low_Ï‹ncy_·¿ms
(
dev
, 
max_chªÃl_time
);

2365 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2367  
»t
;

2368 
	}
}

2370 
	$¦si_£t_·ssive_time_Ëgacy
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2372 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2373 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2374 
max_chªÃl_·ssive_time
 = 0;

2375 
»t
 = 0;

2377 
»t
 = 
	`¦si_v®id©e_low_Ï‹ncy_·¿ms
(
dev
, 
commªd
, 
buf_Ën
, &
max_chªÃl_·ssive_time
);

2378 ià(
»t
 != 0)

2379  
»t
;

2381 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2382 
sdev
->
max_chªÃl_·ssive_time
 = max_channel_passive_time;

2383 ià(
max_chªÃl_·ssive_time
 != 0)

2384 
sdev
->
Ï‹ncy_·¿m_mask
 |ğ
MAX_CHANNEL_PASSIVE_TIME_BIT
;

2385 
»t
 = 
	`¦si_£t_low_Ï‹ncy_·¿ms
(
dev
, 
max_chªÃl_·ssive_time
);

2386 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2388  
»t
;

2389 
	}
}

2391 
	$¦si_£t_tid
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2393 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2394 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2395 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2396 
mode
 = 0, 
uid
 = 0, 
tid
 = 0;

2398 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 3);

2399 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2401 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mode
)) {

2402 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg mod: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2403 
	`kä“
(
ioùl_¬gs
);

2404  -
EINVAL
;

2406 ià(
mode
 < 0 || mode > 3) {

2407 
	`SLSI_ERR
(
sdev
, "Inv®id mode: '%d'\n", 
mode
);

2408 
	`kä“
(
ioùl_¬gs
);

2409  -
EINVAL
;

2411 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
uid
)) {

2412 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg uid: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

2413 
	`kä“
(
ioùl_¬gs
);

2414  -
EINVAL
;

2416 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[2], &
tid
)) {

2417 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšgid: '%s'\n", 
ioùl_¬gs
->
¬gs
[2]);

2418 
	`kä“
(
ioùl_¬gs
);

2419  -
EINVAL
;

2422 
	`kä“
(
ioùl_¬gs
);

2423  
	`¦si_Ãtif_£t_tid_cÚfig
(
sdev
, 
dev
, 
mode
, 
uid
, 
tid
);

2424 
	}
}

2426 
	$¦si_rßm_sÿn_chªÃls_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2428 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2429 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2430 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2431 
»suÉ
 = 0;

2432 
i
, 
chªÃl_couÁ
 = 0;

2433 
chªÃls
[
SLSI_NCHO_MAX_CHANNEL_LIST
];

2434 
»t
 = 0;

2436 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 21);

2437 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2439 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2441 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2442 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2443 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2444 
	`kä“
(
ioùl_¬gs
);

2445  -
EINVAL
;

2448 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
chªÃl_couÁ
)) {

2449 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃl_couÁ sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2450 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2451 
	`kä“
(
ioùl_¬gs
);

2452  -
EINVAL
;

2454 ià(
chªÃl_couÁ
 < 0) {

2455 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈcouÁ : %d\n", 
chªÃl_couÁ
);

2456 
	`kä“
(
ioùl_¬gs
);

2457 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2458  -
EINVAL
;

2460 ià(
chªÃl_couÁ
 > 
SLSI_NCHO_MAX_CHANNEL_LIST
)

2461 
chªÃl_couÁ
 = 
SLSI_NCHO_MAX_CHANNEL_LIST
;

2463 ià((
ioùl_¬gs
->
¬g_couÁ
 - 1è< 
chªÃl_couÁ
) {

2464 
	`SLSI_ERR
(
sdev
, "Bufã¸dÛ¢'ˆhav’ough f›ld chªÃl_couÁ: %d\n", 
chªÃl_couÁ
);

2465 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2466 
	`kä“
(
ioùl_¬gs
);

2467  -
EINVAL
;

2470 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
 = 
chªÃl_couÁ
;

2472 
i
 = 0; i < 
chªÃl_couÁ
; i++) {

2473 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[
i
 + 1], &
chªÃls
[i])) {

2474 
	`SLSI_ERR
(
sdev
, "failedo„ead‡‚umeric value\n");

2475 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2476 
	`kä“
(
ioùl_¬gs
);

2477  -
EINVAL
;

2479 ià(
chªÃls
[
i
] < 1 || channels[i] > 165) {

2480 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
chªÃls
[
i
]);

2481 
	`kä“
(
ioùl_¬gs
);

2482 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2483  -
EINVAL
;

2485 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
chªÃls
[
i
] = channels[i];

2488 ià(!
sdev
->
deviû_cÚfig
.
rßm_sÿn_mode
) {

2489 
»t
 = 
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_CONTROL
, 1);

2490 ià(
»t
 !ğ
SLSI_MIB_STATUS_SUCCESS
) {

2491 
	`kä“
(
ioùl_¬gs
);

2492 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2493  -
EINVAL
;

2495 
sdev
->
deviû_cÚfig
.
rßm_sÿn_mode
 = 1;

2498 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2499 
»suÉ
 = 
	`¦si_mlme_£t_ÿched_chªÃls
(
sdev
, 
dev
, 
chªÃl_couÁ
, sdev->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
chªÃls
);

2500 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2502 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2504 
	`kä“
(
ioùl_¬gs
);

2505  
»suÉ
;

2506 
	}
}

2508 
	$¦si_rßm_sÿn_chªÃls_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2510 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2511 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2512 
sk_buff
 *
šd
 = 
NULL
;

2513 
u16
 
chªÃl_li¡
[
MAX_CHANNEL_COUNT
] = {0};

2514 
pos
 = 0;

2515 
i
;

2516 
chªÃl_couÁ
 = 0;

2518 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2519 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2520 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2521 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2522  -
EINVAL
;

2524 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2526 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2527 
šd
 = 
	`¦si_mlme_rßmšg_chªÃl_li¡_»q
(
sdev
, 
dev
);

2528 ià(!
šd
) {

2529 
	`SLSI_ERR
(
sdev
, "RCL ind is NULL!\n");

2530 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2531  -
EINVAL
;

2534 
chªÃl_couÁ
 = 
	`¦si_g‘_rş_chªÃl_li¡
(
sdev
, 
šd
, 
chªÃl_li¡
);

2535 ià(!
chªÃl_couÁ
) {

2536 
	`SLSI_ERR
(
sdev
, "Channel count is 0!\n");

2537 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2538  -
EINVAL
;

2540 
pos
 = 
	`sú´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETROAMSCANCHANNELS
, 
chªÃl_couÁ
);

2541 
i
 = 0; i < 
chªÃl_couÁ
; i++)

2542 
pos
 +ğ
	`sú´štf
(
commªd
 +…os, 
buf_Ën
 -…os, " %d", 
chªÃl_li¡
[
i
]);

2544 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2545  
pos
;

2546 
	}
}

2548 
	$¦si_rßm_add_sÿn_chªÃls
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2550 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2551 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2552 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2553 
»suÉ
 = 0;

2554 
i
, 
j
, 
Ãw_chªÃl_couÁ
 = 0;

2555 
Ãw_chªÃls
[
SLSI_NCHO_MAX_CHANNEL_LIST
];

2556 
cu¼_chªÃl_couÁ
 = 0;

2557 
found
 = 0;

2559 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 21);

2560 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2562 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2564 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2565 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2566 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2567 
	`kä“
(
ioùl_¬gs
);

2568  -
EINVAL
;

2571 ià(
sdev
->
deviû_cÚfig
.
rßm_sÿn_mode
) {

2572 
	`SLSI_ERR
(
sdev
, "ROAM SÿÀCÚŒŞ mu¡ b0,„ßm modğ%d\n", sdev->
deviû_cÚfig
.
rßm_sÿn_mode
);

2573 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2574 
	`kä“
(
ioùl_¬gs
);

2575  -
EINVAL
;

2578 ià(
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
 =ğ
SLSI_NCHO_MAX_CHANNEL_LIST
) {

2579 
	`SLSI_ERR
(
sdev
, "Roam scan†ist is‡lready full\n");

2580 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2581 
	`kä“
(
ioùl_¬gs
);

2582  -
EINVAL
;

2586 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2587 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&‚dev_vif->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
 &&

2588 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
 == 0) {

2589 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
 = 1;

2590 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
chªÃls
[0] = 
ndev_vif
->
chª
->
hw_v®ue
;

2592 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2593 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
Ãw_chªÃl_couÁ
)) {

2594 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃl_couÁ sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2595 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2596 
	`kä“
(
ioùl_¬gs
);

2597  -
EINVAL
;

2599 ià(
Ãw_chªÃl_couÁ
 < 0 ||‚ew_channel_count > 20) {

2600 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈcouÁ : %d Rªge: [0,20]\n", 
Ãw_chªÃl_couÁ
);

2601 
	`kä“
(
ioùl_¬gs
);

2602 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2603  -
EINVAL
;

2606 ià((
ioùl_¬gs
->
¬g_couÁ
 - 1è< 
Ãw_chªÃl_couÁ
) {

2607 
	`SLSI_ERR
(
sdev
, "Bufã¸dÛ¢'ˆhav’ough f›ld chªÃl_couÁ: %d\n", 
Ãw_chªÃl_couÁ
);

2608 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2609 
	`kä“
(
ioùl_¬gs
);

2610  -
EINVAL
;

2612 
cu¼_chªÃl_couÁ
 = 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
;

2614 
i
 = 0; i < 
Ãw_chªÃl_couÁ
; i++) {

2615 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[
i
 + 1], &
Ãw_chªÃls
[i])) {

2616 
	`SLSI_ERR
(
sdev
, "failedo„ead‡‚umeric value\n");

2617 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2618 
	`kä“
(
ioùl_¬gs
);

2619  -
EINVAL
;

2621 ià(
Ãw_chªÃls
[
i
] < 1 ||‚ew_channels[i] > 165) {

2622 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
Ãw_chªÃls
[
i
]);

2623 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2624 
	`kä“
(
ioùl_¬gs
);

2625  -
EINVAL
;

2627 
j
 = 0; j < 
cu¼_chªÃl_couÁ
; j++) {

2628 
found
 = 0;

2629 ià(
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
chªÃls
[
j
] =ğ
Ãw_chªÃls
[
i
]) {

2630 
found
 = 1;

2634 ià(!
found
) {

2635 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
chªÃls
[
cu¼_chªÃl_couÁ
] = 
Ãw_chªÃls
[
i
];

2636 
cu¼_chªÃl_couÁ
++;

2638 ià(
cu¼_chªÃl_couÁ
 >ğ
SLSI_NCHO_MAX_CHANNEL_LIST
) {

2639 
cu¼_chªÃl_couÁ
 = 
SLSI_NCHO_MAX_CHANNEL_LIST
;

2644 
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
 = 
cu¼_chªÃl_couÁ
;

2646 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2647 
»suÉ
 = 
	`¦si_mlme_£t_ÿched_chªÃls
(
sdev
, 
dev
, 
cu¼_chªÃl_couÁ
, sdev->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
chªÃls
);

2648 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2649 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2651 
	`kä“
(
ioùl_¬gs
);

2652  
»suÉ
;

2653 
	}
}

2655 
	$¦si_okc_mode_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2657 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2658 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2659 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2660 
mode
 = 0;

2662 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

2663 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2665 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2666 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2667 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2668 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2669 
	`kä“
(
ioùl_¬gs
);

2670  -
EINVAL
;

2673 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mode
)) {

2674 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2675 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2676 
	`kä“
(
ioùl_¬gs
);

2677  -
EINVAL
;

2680 ià(
mode
 == 0 || mode == 1) {

2681 
sdev
->
deviû_cÚfig
.
okc_mode
 = 
mode
;

2683 
	`SLSI_ERR
(
sdev
, "Inv®id OKC Mode: Mu¡ b0 or, 1 NÙ '%d'\n", 
mode
);

2684 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2685 
	`kä“
(
ioùl_¬gs
);

2686  -
EINVAL
;

2689 
	`kä“
(
ioùl_¬gs
);

2690 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2692 
	}
}

2694 
	$¦si_okc_mode_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2696 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2697 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2698 
okc_mode
;

2699 
»s
;

2701 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2702 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2703 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2704 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2705  -
EINVAL
;

2708 
okc_mode
 = 
sdev
->
deviû_cÚfig
.okc_mode;

2709 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2711 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETOKCMODE
, 
okc_mode
);

2713  
»s
;

2714 
	}
}

2716 
	$¦si_wes_mode_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2718 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2719 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2720 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2721 
»suÉ
 = -
EINVAL
;

2722 
u32
 
aùiÚ_äame_bm­
 = 
SLSI_STA_ACTION_FRAME_BITMAP
;

2723 
mode
 = 0;

2725 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

2726 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2728 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2729 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2731 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2732 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2733 
ex™
;

2736 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mode
)) {

2737 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2738 
ex™
;

2741 ià(
mode
 == 0 || mode == 1) {

2742 
sdev
->
deviû_cÚfig
.
wes_mode
 = 
mode
;

2744 
	`SLSI_ERR
(
sdev
, "Inv®id WES Mode: Mu¡ b0 o¸1 NÙ '%d'\n", 
mode
);

2745 
ex™
;

2748 
»suÉ
 = 0;

2749 ià(
ndev_vif
->
aùiv©ed
 &&‚dev_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

2750 
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
) {

2751 ià(
sdev
->
deviû_cÚfig
.
wes_mode
)

2752 
aùiÚ_äame_bm­
 |ğ
SLSI_ACTION_FRAME_VENDOR_SPEC
;

2754 
»suÉ
 = 
	`¦si_mlme_»gi¡”_aùiÚ_äame
(
sdev
, 
dev
, 
aùiÚ_äame_bm­
,‡ction_frame_bmap);

2756 
ex™
:

2757 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2758 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2759 
	`kä“
(
ioùl_¬gs
);

2760  
»suÉ
;

2761 
	}
}

2763 
	$¦si_wes_mode_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2765 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2766 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2767 
wes_mode
;

2768 
»s
;

2770 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2771 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2772 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2773 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2774  -
EINVAL
;

2777 
wes_mode
 = 
sdev
->
deviû_cÚfig
.wes_mode;

2778 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2780 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETWESMODE
, 
wes_mode
);

2782  
»s
;

2783 
	}
}

2785 
	$¦si_£t_ncho_mode
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2787 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2788 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2789 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2790 
sk_buff
 *
»q
;

2791 
sk_buff
 *
cfm
;

2792 
»t
 = 0;

2793 
mode
 = 0;

2795 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

2796 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2798 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mode
)) {

2799 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2800 
	`kä“
(
ioùl_¬gs
);

2801  -
EINVAL
;

2804 ià(
mode
 != 0 && mode != 1) {

2805 
	`SLSI_ERR
(
sdev
, "Inv®id NCHO Mode: Mu¡ b0 o¸1, modğ%d\n", 
mode
);

2806 
	`kä“
(
ioùl_¬gs
);

2807  -
EINVAL
;

2810 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2812 ià(
sdev
->
deviû_cÚfig
.
ncho_mode
 =ğ
mode
) {

2813 
	`SLSI_INFO
(
sdev
, "ncho_modi ®»ady %d\n", 
mode
);

2814 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2815 
	`kä“
(
ioùl_¬gs
);

2816  
»t
;

2818 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2820 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2822 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

2823 
	`SLSI_NET_ERR
(
dev
, "sta is‚ot in connected state\n");

2824 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2825 
	`kä“
(
ioùl_¬gs
);

2826  -
EPERM
;

2829 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "mlme_£t_rßmšg_ty³_»q(vif:%u mode:%u)\n", 
ndev_vif
->
iâum
, 
mode
);

2831 
»q
 = 
	`çpi_®loc
(
mlme_£t_rßmšg_ty³_»q
, 
MLME_SET_ROAMING_TYPE_REQ
, 
ndev_vif
->
iâum
, 0);

2832 ià(!
»q
) {

2833 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2834 
	`kä“
(
ioùl_¬gs
);

2835  -
EIO
;

2837 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_rßmšg_ty³_»q
.
vif
, 
ndev_vif
->
iâum
);

2838 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_rßmšg_ty³_»q
.
rßmšg_ty³
, 
mode
);

2839 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_ROAMING_TYPE_CFM
);

2840 ià(!
cfm
) {

2841 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2842 
	`kä“
(
ioùl_¬gs
);

2843  -
EIO
;

2846 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_rßmšg_ty³_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

2847 
	`SLSI_NET_ERR
(
dev
, "mlme_set_roaming_type_cfm(result:0x%04x) ERROR\n",

2848 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_rßmšg_ty³_cfm
.
»suÉ_code
));

2849 
»t
 = -
EINVAL
;

2852 
	`kä“_skb
(
cfm
);

2854 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2856 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2857 
sdev
->
deviû_cÚfig
.
ncho_mode
 = 
mode
;

2858 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2860 
	`kä“
(
ioùl_¬gs
);

2861  
»t
;

2862 
	}
}

2864 
	$¦si_g‘_ncho_mode
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2866 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2867 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2868 
»t
;

2870 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2871 
»t
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETNCHOMODE
, 
sdev
->
deviû_cÚfig
.
ncho_mode
);

2872 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2874  
»t
;

2875 
	}
}

2877 
	$¦si_£t_dfs_sÿn_mode
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2879 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2880 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2881 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2882 
mode
 = 0;

2883 
»s
;

2885 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

2886 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2888 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mode
)) {

2889 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

2890 
	`kä“
(
ioùl_¬gs
);

2891  -
EINVAL
;

2894 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2896 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2897 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2898 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2899 
	`kä“
(
ioùl_¬gs
);

2900  -
EINVAL
;

2903 ià(
mode
 >= 0 && mode <= 2) {

2904 
sdev
->
deviû_cÚfig
.
dfs_sÿn_mode
 = 
mode
;

2906 
	`SLSI_ERR
(
sdev
, "Inv®id df sÿÀmode: Mu¡ b0/1 o¸2, NÙ '%d'\n", 
mode
);

2907 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2908 
	`kä“
(
ioùl_¬gs
);

2909  -
EINVAL
;

2912 
	`kä“
(
ioùl_¬gs
);

2913 
»s
 = 
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_NCHO_DFS_SCAN_MODE
, sdev->
deviû_cÚfig
.
dfs_sÿn_mode
);

2914 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2915  
»s
;

2916 
	}
}

2918 
	$¦si_g‘_dfs_sÿn_mode
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2920 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2921 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2922 
mib_v®ue
 = 0;

2923 
»s
;

2925 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2926 ià(!
sdev
->
deviû_cÚfig
.
ncho_mode
) {

2927 
	`SLSI_INFO
(
sdev
, "Command‚ot‡llowed, NCHO is disabled\n");

2928 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2929  -
EINVAL
;

2931 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2933 
»s
 = 
	`¦si_g‘_mib_rßm
(
sdev
, 
SLSI_PSID_UNIFI_ROAM_NCHO_DFS_SCAN_MODE
, &
mib_v®ue
);

2934 ià(
»s
)

2935  
»s
;

2937 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "% %d", 
CMD_GETDFSSCANMODE
, 
mib_v®ue
);

2939  
»s
;

2940 
	}
}

2944 
	$¦si_£t_pmk
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2946 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2947 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2948 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2949 
u8
 
pmk
[33] = {0};

2950 
»suÉ
 = 0;

2952 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

2953 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

2955 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]) < 32) {

2956 
	`kä“
(
ioùl_¬gs
);

2957  -
EINVAL
;

2960 
	`memıy
((
u8
 *)
pmk
, 
ioùl_¬gs
->
¬gs
[0], 32);

2961 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2963 
»suÉ
 = 
	`¦si_mlme_£t_pmk
(
sdev
, 
dev
, 
pmk
, 32);

2965 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2966 
	`kä“
(
ioùl_¬gs
);

2967  
»suÉ
;

2968 
	}
}

2970 
	$¦si_auto_chª_»ad
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2972 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2973 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2974 
­_auto_chª
;

2975 
»suÉ
 = 0;

2977 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2978 
­_auto_chª
 = 
sdev
->
deviû_cÚfig
.ap_auto_chan;

2979 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2981 
»suÉ
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "%d\n", 
­_auto_chª
);

2982  
»suÉ
;

2983 
	}
}

2985 
ssize_t
 
	$¦si_auto_chª_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

2987 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2988 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2989 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

2990 
n_chªÃls
 = 0;

2991 
›“80211_chªÃl
 *
chªÃls
[
SLSI_NO_OF_SCAN_CHANLS_FOR_AUTO_CHAN_MAX
] = { 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL };

2992 
couÁ_chªÃls
;

2993 
chª
;

2994 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


2995 
Ãt_deviû
 *
¡a_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

2996 
Ãtdev_vif
 *
ndev_¡a_vif
 = 
	`Ãtdev_´iv
(
¡a_dev
);

2997 
¡a_äequ’cy
;

3000 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

3001 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

3003 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
n_chªÃls
)) {

3004 
	`SLSI_ERR
(
sdev
, "channel count: failedo„ead‡‚umeric value");

3005 
	`kä“
(
ioùl_¬gs
);

3006  -
EINVAL
;

3009 ià(
n_chªÃls
 < 1 ||‚_chªÃl > 
SLSI_NO_OF_SCAN_CHANLS_FOR_AUTO_CHAN_MAX
) {

3010 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈcouÁ:%d", 
n_chªÃls
);

3011 
	`kä“
(
ioùl_¬gs
);

3012  -
EINVAL
;

3016 ià(
n_chªÃls
 == 3)

3017 
n_chªÃls
 = 14;

3018 ià(
n_chªÃls
 == 2)

3019 
n_chªÃls
 = 9;

3020 
couÁ_chªÃls
 = 0;

3021 
chª
 = 1; chª <ğ
n_chªÃls
; chan++) {

3022 
ûÁ”_äeq
;

3024 
ûÁ”_äeq
 = 
	`›“80211_chªÃl_to_äequ’cy
(
chª
, 
NL80211_BAND_2GHZ
);

3025 
chªÃls
[
couÁ_chªÃls
] = 
	`›“80211_g‘_chªÃl
(
sdev
->
why
, 
ûÁ”_äeq
);

3026 ià(!
chªÃls
[
couÁ_chªÃls
])

3027 
	`SLSI_WARN
(
sdev
, "chªÃÈnumb”:%d inv®id\n", 
chª
);

3029 
couÁ_chªÃls
++;

3032 
	`SLSI_DBG3
(
sdev
, 
SLSI_INIT_DEINIT
, "Numb” oàchªÃl fÜ‡utochªÃÈ£ËùiÚğ%d\n", 
couÁ_chªÃls
);

3034 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3035 
sdev
->
deviû_cÚfig
.
­_auto_chª
 = 0;

3036 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3038 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


3039 ià(
ndev_¡a_vif
->
aùiv©ed
 &&‚dev_¡a_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

3040 (
ndev_¡a_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTING
 ||

3041 
ndev_¡a_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
)) {

3042 
¡a_äequ’cy
 = 
ndev_¡a_vif
->
chª
->
ûÁ”_äeq
;

3043 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3044 ià((
¡a_äequ’cy
 / 1000) == 2)

3045 
sdev
->
deviû_cÚfig
.
­_auto_chª
 = 
	`›“80211_äequ’cy_to_chªÃl
(
¡a_äequ’cy
);

3047 
sdev
->
deviû_cÚfig
.
­_auto_chª
 = 1;

3048 
	`SLSI_INFO
(
sdev
, "ChªÃÈ£Ëùed = %d", sdev->
deviû_cÚfig
.
­_auto_chª
);

3049 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3050 
	`kä“
(
ioùl_¬gs
);

3054 
	`kä“
(
ioùl_¬gs
);

3055  
	`¦si_auto_chª_£Ëù_sÿn
(
sdev
, 
couÁ_chªÃls
, 
chªÃls
);

3056 
	}
}

3058 
	$¦si_£nd_aùiÚ_äame
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3060 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3061 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3062 *
‹mp
;

3063 
u8
 
bssid
[6] = { 0 };

3064 
chªÃl
 = 0;

3065 
äeq
 = 0;

3066 
Æ80211_bªd
 
bªd
 = 
NL80211_BAND_2GHZ
;

3067 
r
 = 0;

3068 
u16
 
ho¡_g
 = 
	`¦si_tx_mgmt_ho¡_g
(
sdev
);

3069 
u32
 
dw–l_time
;

3070 
›“80211_hdr
 *
hdr
;

3071 
u8
 *
buf
 = 
NULL
;

3072 
u8
 *
fš®_buf
 = 
NULL
;

3073 
u8
 
‹mp_by‹
;

3074 
Ën
 = 0;

3075 
fš®_Ëngth
 = 0;

3076 
i
 = 0, 
j
 = 0;

3077 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

3079 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3080 ià(!
ndev_vif
->
aùiv©ed
 ||‚dev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
 ||

3081 
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

3082 
	`SLSI_ERR
(
sdev
, "Not‡ STA vif or status is‚ot CONNECTED\n");

3083 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3084  -
EINVAL
;

3086 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3088 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 5);

3089 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

3091 ià(
ioùl_¬gs
->
¬g_couÁ
 < 5) {

3092 
	`SLSI_ERR
(
sdev
, "Inv®id‡rgum’ˆcouÁ = %d\n", 
ioùl_¬gs
->
¬g_couÁ
);

3093 
	`kä“
(
ioùl_¬gs
);

3094  -
EINVAL
;

3097 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]) != 17) {

3098 
	`SLSI_ERR
(
sdev
, "Inv®id maøadd»ss: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

3099 
	`kä“
(
ioùl_¬gs
);

3100  -
EINVAL
;

3103 
	`¦si_machex¡ršg_to_maÿ¼ay
(
ioùl_¬gs
->
¬gs
[0], 
bssid
);

3104 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3105 ià(!
	`SLSI_ETHER_EQUAL
(
bssid
, 
ndev_vif
->
¡a
.bssid)) {

3106 
	`SLSI_ERR
(
sdev
, "WrÚg Bssid = " 
MACSTR
 " CÚÃùed Bssid = " MACSTR "\n", 
	`MAC2STR
(
bssid
), MAC2STR(
ndev_vif
->
¡a
.bssid));

3107 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3108 
	`kä“
(
ioùl_¬gs
);

3109  -
EINVAL
;

3111 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3113 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
chªÃl
)) {

3114 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ¡ršg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

3115 
	`kä“
(
ioùl_¬gs
);

3116  -
EINVAL
;

3119 ià(
chªÃl
 < 1 || channel > 165) {

3120 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
chªÃl
);

3121 
	`kä“
(
ioùl_¬gs
);

3122  -
EINVAL
;

3125 ià(
chªÃl
 > 14)

3126 
bªd
 = 
NL80211_BAND_5GHZ
;

3127 
äeq
 = (
u16
)
	`›“80211_chªÃl_to_äequ’cy
(
chªÃl
, 
bªd
);

3128 ià(!
äeq
) {

3129 
	`kä“
(
ioùl_¬gs
);

3130  -
EINVAL
;

3133 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[2], &
dw–l_time
)) {

3134 
	`SLSI_ERR
(
sdev
, "Inv®id dw–Ètim¡ršg: '%s'\n", 
ioùl_¬gs
->
¬gs
[2]);

3135 
	`kä“
(
ioùl_¬gs
);

3136  -
EINVAL
;

3139 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[3], &
Ën
)) {

3140 
	`SLSI_ERR
(
sdev
, "Inv®id†’gth sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[3]);

3141 
	`kä“
(
ioùl_¬gs
);

3142  -
EINVAL
;

3146 ià(
Ën
 < 512 ||†en > 1024) {

3147 ià(
Ën
 < 0 ||†en > 1024) {

3148 
	`SLSI_ERR
(
sdev
, "Inv®id bufã¸Ëngth:%d\n", 
Ën
);

3149 
	`kä“
(
ioùl_¬gs
);

3150  -
EINVAL
;

3152 
	`SLSI_INFO
(
sdev
, "F¿mBody oàV’dÜ S³cifiøbufã¸Ëngth = %d sØignÜšghcommªd\n", 
Ën
);

3153 
	`kä“
(
ioùl_¬gs
);

3157 
buf
 = 
	`km®loc
((
Ën
 + 1è/ 2, 
GFP_KERNEL
);

3159 ià(!
buf
) {

3160 
	`SLSI_ERR
(
sdev
, "Malloc failed\n");

3161 
	`kä“
(
ioùl_¬gs
);

3162  -
ENOMEM
;

3166 
‹mp
 = 
ioùl_¬gs
->
¬gs
[4];

3167 
i
 = 0, 
j
 = 0; j < 
Ën
; j += 2) {

3168 ià(
j
 + 1 =ğ
Ën
)

3169 
‹mp_by‹
 = 
	`¦si_·r£_hex
(
‹mp
[
j
]);

3171 
‹mp_by‹
 = 
	`¦si_·r£_hex
(
‹mp
[
j
]) << 4 | slsi_parse_hex(temp[j + 1]);

3172 
buf
[
i
++] = 
‹mp_by‹
;

3174 
Ën
 = 
i
;

3176 
fš®_Ëngth
 = 
Ën
 + 
IEEE80211_HEADER_SIZE
;

3177 
fš®_buf
 = 
	`km®loc
(
fš®_Ëngth
, 
GFP_KERNEL
);

3178 ià(!
fš®_buf
) {

3179 
	`SLSI_ERR
(
sdev
, "Malloc failed\n");

3180 
	`kä“
(
ioùl_¬gs
);

3181 
	`kä“
(
buf
);

3182  -
ENOMEM
;

3185 
hdr
 = (
›“80211_hdr
 *)
fš®_buf
;

3186 
hdr
->
äame_cÚŒŞ
 = 
	`IEEE80211_FC
(
IEEE80211_FTYPE_MGMT
, 
IEEE80211_STYPE_ACTION
);

3187 
	`SLSI_ETHER_COPY
(
hdr
->
addr1
, 
bssid
);

3188 
	`SLSI_ETHER_COPY
(
hdr
->
addr2
, 
dev
->
dev_addr
);

3189 
	`SLSI_ETHER_COPY
(
hdr
->
addr3
, 
bssid
);

3190 
	`memıy
(
fš®_buf
 + 
IEEE80211_HEADER_SIZE
, 
buf
, 
Ën
);

3192 
	`kä“
(
buf
);

3194 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3196 
r
 = 
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
dev
, 
fš®_buf
, 
fš®_Ëngth
, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
, 
FAPI_MESSAGETYPE_IEEE80211_ACTION
, 
ho¡_g
, 
	`SLSI_FREQ_HOST_TO_FW
(
äeq
), 
dw–l_time
 * 1000, 0);

3198 
	`kä“
(
fš®_buf
);

3199 
	`kä“
(
ioùl_¬gs
);

3200 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3201  
r
;

3202 
	}
}

3204 
	$¦si_£nd_aùiÚ_äame_û¹
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3206 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3207 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3208 *
‹mp
;

3209 
r
 = 0;

3210 
u16
 
ho¡_g
 = 
	`¦si_tx_mgmt_ho¡_g
(
sdev
);

3211 
›“80211_hdr
 *
hdr
;

3212 
u8
 *
buf
 = 
NULL
;

3213 
u8
 *
fš®_buf
 = 
NULL
;

3214 
u8
 
‹mp_by‹
;

3215 
Ën
 = 0;

3216 
fš®_Ëngth
 = 0;

3217 
i
 = 0, 
j
 = 0;

3218 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

3220 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3221 ià(!
ndev_vif
->
aùiv©ed
 ||‚dev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
 ||

3222 
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

3223 
	`SLSI_ERR
(
sdev
, "Not‡ STA vif or status is‚ot CONNECTED\n");

3224 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3225  -
EINVAL
;

3227 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3229 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 2);

3230 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

3232 ià(
ioùl_¬gs
->
¬g_couÁ
 < 2) {

3233 
	`SLSI_ERR
(
sdev
, "Inv®id‡rgum’ˆcouÁ = %d\n", 
ioùl_¬gs
->
¬g_couÁ
);

3234 
	`kä“
(
ioùl_¬gs
);

3235  -
EINVAL
;

3238 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
Ën
)) {

3239 
	`SLSI_ERR
(
sdev
, "Inv®id†’gth sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

3240 
	`kä“
(
ioùl_¬gs
);

3241  -
EINVAL
;

3244 
buf
 = 
	`km®loc
((
Ën
 + 1è/ 2, 
GFP_KERNEL
);

3246 ià(!
buf
) {

3247 
	`SLSI_ERR
(
sdev
, "Malloc failed\n");

3248 
	`kä“
(
ioùl_¬gs
);

3249  -
ENOMEM
;

3253 
‹mp
 = 
ioùl_¬gs
->
¬gs
[1];

3254 
i
 = 0, 
j
 = 0; j < 
Ën
; j += 2) {

3255 ià(
j
 + 1 =ğ
Ën
)

3256 
‹mp_by‹
 = 
	`¦si_·r£_hex
(
‹mp
[
j
]);

3258 
‹mp_by‹
 = 
	`¦si_·r£_hex
(
‹mp
[
j
]) << 4 | slsi_parse_hex(temp[j + 1]);

3259 
buf
[
i
++] = 
‹mp_by‹
;

3261 
Ën
 = 
i
;

3263 
fš®_Ëngth
 = 
Ën
 + 
IEEE80211_HEADER_SIZE
;

3264 
fš®_buf
 = 
	`km®loc
(
fš®_Ëngth
, 
GFP_KERNEL
);

3265 ià(!
fš®_buf
) {

3266 
	`SLSI_ERR
(
sdev
, "Malloc failed\n");

3267 
	`kä“
(
ioùl_¬gs
);

3268 
	`kä“
(
buf
);

3269  -
ENOMEM
;

3272 
hdr
 = (
›“80211_hdr
 *)
fš®_buf
;

3273 
hdr
->
äame_cÚŒŞ
 = 
	`IEEE80211_FC
(
IEEE80211_FTYPE_MGMT
, 
IEEE80211_STYPE_ACTION
);

3274 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3275 
	`SLSI_ETHER_COPY
(
hdr
->
addr1
, 
ndev_vif
->
¡a
.
bssid
);

3276 
	`SLSI_ETHER_COPY
(
hdr
->
addr3
, 
ndev_vif
->
¡a
.
bssid
);

3277 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3278 
	`SLSI_ETHER_COPY
(
hdr
->
addr2
, 
sdev
->
hw_addr
);

3279 
	`memıy
(
fš®_buf
 + 
IEEE80211_HEADER_SIZE
, 
buf
, 
Ën
);

3281 
	`kä“
(
buf
);

3283 
r
 = 
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
dev
, 
fš®_buf
, 
fš®_Ëngth
, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
, 
FAPI_MESSAGETYPE_IEEE80211_ACTION
, 
ho¡_g
, 0, 0, 0);

3285 
	`kä“
(
fš®_buf
);

3286 
	`kä“
(
ioùl_¬gs
);

3287  
r
;

3288 
	}
}

3290 #ifdeà
SLSI_TEST_DEV


3291 
	$¦si_£nd_aùiÚ_äame_ut
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3293 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3294 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3295 *
hex_¡r
;

3296 
u8
 
bssid
[6] = { 0 };

3297 
u8
 
Œªsm™‹¿ddr
[6] = { 0 };

3298 
chªÃl
 = 0;

3299 
r
 = 0;

3300 
u32
 
dw–l_time
;

3301 
›“80211_mgmt
 *
hdr
;

3302 
u8
 *
buf
 = 
NULL
;

3303 
u8
 
‹mp_by‹
;

3304 
Ën
 = 0;

3305 
i
 = 0, 
j
 = 0;

3306 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

3307 
›“80211_chªÃl
 
chª
;

3308 
u64
 
cook›
 = 1;

3310 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 6);

3311 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

3313 ià(
ioùl_¬gs
->
¬g_couÁ
 < 6) {

3314 
	`SLSI_ERR
(
sdev
, "Inv®id‡rgum’ˆcouÁ = %d\n", 
ioùl_¬gs
->
¬g_couÁ
);

3315 
	`kä“
(
ioùl_¬gs
);

3316  -
EINVAL
;

3319 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]) != 17) {

3320 
	`SLSI_ERR
(
sdev
, "Inv®id maøadd»ss: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

3321 
	`kä“
(
ioùl_¬gs
);

3322  -
EINVAL
;

3325 
	`¦si_machex¡ršg_to_maÿ¼ay
(
ioùl_¬gs
->
¬gs
[0], 
Œªsm™‹¿ddr
);

3327 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[1]) != 17) {

3328 
	`SLSI_ERR
(
sdev
, "Inv®id maøadd»ss: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

3329 
	`kä“
(
ioùl_¬gs
);

3330  -
EINVAL
;

3333 
	`¦si_machex¡ršg_to_maÿ¼ay
(
ioùl_¬gs
->
¬gs
[1], 
bssid
);

3335 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[2], &
chªÃl
)) {

3336 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ¡ršg: '%s'\n", 
ioùl_¬gs
->
¬gs
[2]);

3337 
	`kä“
(
ioùl_¬gs
);

3338  -
EINVAL
;

3341 ià(
chªÃl
 < 1 || channel > 165) {

3342 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
chªÃl
);

3343 
	`kä“
(
ioùl_¬gs
);

3344  -
EINVAL
;

3346 
	`SLSI_INFO
(
sdev
, "chªÃl: '%d'\n", 
chªÃl
);

3348 ià(
chªÃl
 > 14)

3349 
chª
.
bªd
 = 
NL80211_BAND_5GHZ
;

3351 
chª
.
bªd
 = 
NL80211_BAND_2GHZ
;

3353 
	`SLSI_ERR
(
sdev
, "chªÃl: '%d'\n", 
chª
.
bªd
);

3355 
chª
.
ûÁ”_äeq
 = (
u16
)
	`›“80211_chªÃl_to_äequ’cy
(
chªÃl
, chª.
bªd
);

3356 ià(!
chª
.
ûÁ”_äeq
) {

3357 
	`kä“
(
ioùl_¬gs
);

3358  -
EINVAL
;

3361 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[3], &
dw–l_time
)) {

3362 
	`SLSI_ERR
(
sdev
, "Inv®id dw–Ètim¡ršg: '%s'\n", 
ioùl_¬gs
->
¬gs
[3]);

3363 
	`kä“
(
ioùl_¬gs
);

3364  -
EINVAL
;

3367 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[4], &
Ën
)) {

3368 
	`SLSI_ERR
(
sdev
, "Inv®id†’gth sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[4]);

3369 
	`kä“
(
ioùl_¬gs
);

3370  -
EINVAL
;

3374 ià(
Ën
 < 0 ||†en > 1024) {

3375 
	`SLSI_ERR
(
sdev
, "Inv®id bufã¸Ëngth:%d\n", 
Ën
);

3376 
	`kä“
(
ioùl_¬gs
);

3377  -
EINVAL
;

3380 
buf
 = 
	`km®loc
((
IEEE80211_HEADER_SIZE
 + ((
Ën
 + 1è/ 2)), 
GFP_KERNEL
);

3382 ià(!
buf
) {

3383 
	`SLSI_ERR
(
sdev
, "Malloc failed\n");

3384 
	`kä“
(
ioùl_¬gs
);

3385  -
ENOMEM
;

3387 
hdr
 = (
›“80211_mgmt
 *)
buf
;

3388 
hdr
->
äame_cÚŒŞ
 = 
	`IEEE80211_FC
(
IEEE80211_FTYPE_MGMT
, 
IEEE80211_STYPE_ACTION
);

3389 
	`SLSI_ETHER_COPY
(
hdr
->
da
, 
bssid
);

3390 
	`SLSI_ETHER_COPY
(
hdr
->
§
, 
Œªsm™‹¿ddr
);

3391 
	`SLSI_ETHER_COPY
(
hdr
->
bssid
, bssid);

3394 
hex_¡r
 = 
ioùl_¬gs
->
¬gs
[5];

3395 
i
 = 
IEEE80211_HEADER_SIZE
, 
j
 = 0; j < 
Ën
; j += 2) {

3396 ià(
j
 + 1 =ğ
Ën
)

3397 
‹mp_by‹
 = 
	`¦si_·r£_hex
(
hex_¡r
[
j
]);

3399 
‹mp_by‹
 = 
	`¦si_·r£_hex
(
hex_¡r
[
j
]) << 4 | slsi_parse_hex(hex_str[j + 1]);

3400 
buf
[
i
++] = 
‹mp_by‹
;

3402 
Ën
 = 
i
;

3403 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3404 
r
 = 
	`¦si_wÏn_mgmt_tx
(
sdev
, 
dev
, &
chª
, 
dw–l_time
, 
buf
, 
Ën
, 1, &
cook›
);

3406 
	`kä“
(
buf
);

3407 
	`kä“
(
ioùl_¬gs
);

3408 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3409  
r
;

3410 
	}
}

3413 
	$¦si_£‰šg_max_¡a_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

3415 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3416 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3417 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

3418 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

3419 
¡a_numb”
 = 0;

3420 
»suÉ
 = 0;

3422 
	`¦si_cÚv”t_¥aû_£³¿tiÚ
(
commªd
, 
cmd_Ën
);

3423 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 1);

3424 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

3426 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
¡a_numb”
)) {

3427 
	`SLSI_ERR
(
sdev
, "Inv®id max‚um s stšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

3428 
	`kä“
(
ioùl_¬gs
);

3429  -
EINVAL
;

3432 ià(
¡a_numb”
 > 10 || sta_number < 1) {

3433 
	`kä“
(
ioùl_¬gs
);

3434  -
EINVAL
;

3437 
»suÉ
 = 
	`¦si_mib_’code_ušt
(&
mib_d©a
, 
SLSI_PSID_UNIFI_MAX_CLIENT
, 
¡a_numb”
, 0);

3438 ià(
»suÉ
 !ğ
SLSI_MIB_STATUS_SUCCESS
 || 
mib_d©a
.
d©aL’gth
 == 0) {

3439 
	`kä“
(
ioùl_¬gs
);

3440  -
ENOMEM
;

3442 
»suÉ
 = 
	`¦si_mlme_£t
(
sdev
, 
dev
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

3443 ià(
»suÉ
 != 0)

3444 
	`SLSI_ERR
(
sdev
, "max_¡a: mlme_£t_»q faed: ResuÉ code: %d\n", 
»suÉ
);

3445 
	`kä“
(
ioùl_¬gs
);

3446 
	`kä“
(
mib_d©a
.
d©a
);

3448  
»suÉ
;

3449 
	}
}

3451 
	$¦si_couÁry_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3453 
Ãtdev_vif
 *Ãtdev_viàğ
	`Ãtdev_´iv
(
dev
);

3454 
¦si_dev
 *
sdev
 = 
Ãtdev_vif
->sdev;

3455 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

3456 
®pha2_code
[
SLSI_COUNTRY_CODE_LEN
];

3457 
¡©us
;

3459 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

3460 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

3462 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]) < 2) {

3463 
	`kä“
(
ioùl_¬gs
);

3464  -
EINVAL
;

3467 
	`memıy
(
®pha2_code
, 
ioùl_¬gs
->
¬gs
[0], 2);

3468 
®pha2_code
[2] = ' ';

3470 
¡©us
 = 
	`¦si_£t_couÁry_upd©e_»gd
(
sdev
, 
®pha2_code
, 
SLSI_COUNTRY_CODE_LEN
);

3472 
	`kä“
(
ioùl_¬gs
);

3473  
¡©us
;

3474 
	}
}

3476 #ià
defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

3477 
	$¦si_fÜw¬d_b—cÚ
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3479 
Ãtdev_vif
 *Ãtdev_viàğ
	`Ãtdev_´iv
(
dev
);

3480 
¦si_dev
 *
sdev
 = 
Ãtdev_vif
->sdev;

3481 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

3482 
š‹nded_aùiÚ
 = 0;

3483 
»t
 = 0;

3485 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

3486 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

3488 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]è=ğ4 && 
	`¡ºÿ£cmp
(ioctl_args->args[0], "stop", 4) == 0) {

3489 
š‹nded_aùiÚ
 = 
FAPI_ACTION_STOP
;

3490 } ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]è=ğ5 && 
	`¡ºÿ£cmp
(ioctl_args->args[0], "start", 5) == 0) {

3491 
š‹nded_aùiÚ
 = 
FAPI_ACTION_START
;

3493 
	`SLSI_NET_ERR
(
dev
, "BEACON_RECV should be used with start or stop\n");

3494 
	`kä“
(
ioùl_¬gs
);

3495  -
EINVAL
;

3498 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "BEACON_RECV %s!!\n", 
š‹nded_aùiÚ
 ? "START" : "STOP");

3499 
	`SLSI_MUTEX_LOCK
(
Ãtdev_vif
->
vif_mu‹x
);

3501 ià(!
Ãtdev_vif
->
aùiv©ed
 ||‚‘dev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
 ||

3502 
Ãtdev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

3503 
	`SLSI_ERR
(
sdev
, "Not‡ STA vif or status is‚ot CONNECTED\n");

3504 
»t
 = -
EINVAL
;

3505 
ex™_vif_mu‹x
;

3508 ià((
š‹nded_aùiÚ
 =ğ
FAPI_ACTION_START
 && 
Ãtdev_vif
->
is_ws_ruÂšg
) ||

3509 (
š‹nded_aùiÚ
 =ğ
FAPI_ACTION_STOP
 && !
Ãtdev_vif
->
is_ws_ruÂšg
)) {

3510 
	`SLSI_NET_INFO
(
dev
, "Forwarding beacon is‡lready %s!!\n",

3511 
Ãtdev_vif
->
is_ws_ruÂšg
 ? "running" : "stopped");

3512 
»t
 = 0;

3513 
ex™_vif_mu‹x
;

3516 
	`SLSI_MUTEX_LOCK
(
Ãtdev_vif
->
sÿn_mu‹x
);

3517 ià(
š‹nded_aùiÚ
 =ğ
FAPI_ACTION_START
 &&

3518 (
Ãtdev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
 ||‚‘dev_vif->
¡a
.
rßm_š_´og»ss
)) {

3519 
	`SLSI_NET_ERR
(
dev
, "Rejecting BEACON_RECV start‡s scan/roam is„unning\n");

3520 
»t
 = -
EBUSY
;

3521 
ex™_sÿn_mu‹x
;

3524 
»t
 = 
	`¦si_mlme_£t_fÜw¬d_b—cÚ
(
sdev
, 
dev
, 
š‹nded_aùiÚ
);

3525 
ex™_sÿn_mu‹x
:

3526 
	`SLSI_MUTEX_UNLOCK
(
Ãtdev_vif
->
sÿn_mu‹x
);

3527 
ex™_vif_mu‹x
:

3528 
	`kä“
(
ioùl_¬gs
);

3529 
	`SLSI_MUTEX_UNLOCK
(
Ãtdev_vif
->
vif_mu‹x
);

3530  
»t
;

3531 
	}
}

3534 
	$¦si_upd©e_rssi_boo¡
(
Ãt_deviû
 *
dev
, *
bufãr
, 
buf_Ën
)

3536 
Ãtdev_vif
 *Ãtdev_viàğ
	`Ãtdev_´iv
(
dev
);

3537 
¦si_dev
 *
sdev
 = 
Ãtdev_vif
->sdev;

3538 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

3539 
dig™1
, 
dig™2
, 
bªd
, 
Ëndig™1
, 
Ëndig™2
;

3540 
boo¡
 = 0, 
Ëngth
 = 0, 
i
 = 0;

3541 *
rssi_boo¡_¡ršg
 = 
NULL
;

3543 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
bufãr
, 
buf_Ën
, 1);

3544 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

3546 
rssi_boo¡_¡ršg
 = 
ioùl_¬gs
->
¬gs
[0];

3547 ià(
	`¡¾’
(
rssi_boo¡_¡ršg
) < 8) {

3548 
	`kä“
(
ioùl_¬gs
);

3549  -
EINVAL
;

3551 
i
 = 0; i < (
	`¡¾’
(
rssi_boo¡_¡ršg
) - 4);) {

3552 ià(
rssi_boo¡_¡ršg
[
i
] == '0' &&

3553 
rssi_boo¡_¡ršg
[
i
 + 1] == '4') {

3554 ià(
rssi_boo¡_¡ršg
[
i
 + 2] == '0' &&

3555 
rssi_boo¡_¡ršg
[
i
 + 3] == '2' &&

3556 ((
i
 + 7è< 
	`¡¾’
(
rssi_boo¡_¡ršg
))) {

3557 
i
 = i + 4;

3559 
	`kä“
(
ioùl_¬gs
);

3560  -
EINVAL
;

3562 
dig™1
 = 
	`¦si_·r£_hex
(
rssi_boo¡_¡ršg
[
i
]);

3563 
dig™2
 = 
	`¦si_·r£_hex
(
rssi_boo¡_¡ršg
[
i
 + 1]);

3564 
boo¡
 = (
dig™1
 * 16è+ 
dig™2
;

3565 
bªd
 = 
rssi_boo¡_¡ršg
[
i
 + 3] - '0';

3566 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3567 ià(
bªd
 == 0) {

3568 
sdev
->
deviû_cÚfig
.
rssi_boo¡_2g
 = 0;

3569 
sdev
->
deviû_cÚfig
.
rssi_boo¡_5g
 = 0;

3570 } ià(
bªd
 == 1) {

3571 
sdev
->
deviû_cÚfig
.
rssi_boo¡_2g
 = 0;

3572 
sdev
->
deviû_cÚfig
.
rssi_boo¡_5g
 = 
boo¡
;

3573 } ià(
bªd
 == 2) {

3574 
sdev
->
deviû_cÚfig
.
rssi_boo¡_2g
 = 
boo¡
;

3575 
sdev
->
deviû_cÚfig
.
rssi_boo¡_5g
 = 0;

3577 
	`SLSI_ERR
(
sdev
, "Inv®id bªd v®u%d\n", 
bªd
);

3578 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3579 
	`kä“
(
ioùl_¬gs
);

3580  -
EINVAL
;

3582 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3583 ià(
Ãtdev_vif
->
aùiv©ed
 &&

3584 
Ãtdev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

3585 
	`kä“
(
ioùl_¬gs
);

3586  
	`¦si_£t_boo¡
(
sdev
, 
dev
);

3588 
	`kä“
(
ioùl_¬gs
);

3591 
i
 = i + 2;

3592 
Ëndig™1
 = 
	`¦si_·r£_hex
(
rssi_boo¡_¡ršg
[
i
]);

3593 
Ëndig™2
 = 
	`¦si_·r£_hex
(
rssi_boo¡_¡ršg
[
i
 + 1]);

3594 
Ëngth
 = (
Ëndig™1
 * 16è+ 
Ëndig™2
;

3595 
i
 = i + (
Ëngth
 * 2) + 2;

3597 
	`kä“
(
ioùl_¬gs
);

3598  -
EINVAL
;

3599 
	}
}

3601 
	$¦si_£t_tx_pow”_ÿÎšg_Ëgacy
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3603 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3604 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3605 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

3606 
mode
 = 0;

3607 
”rÜ
 = 0;

3608 
u16
 
ho¡_¡©e
 = 0;

3610 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

3611 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

3613 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mode
)) {

3614 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

3615 
	`kä“
(
ioùl_¬gs
);

3616  -
EINVAL
;

3623 ià(
mode
 != 0 && mode != 1 && mode != -1) {

3624 
	`SLSI_ERR
(
sdev
, "Inv®id mode: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

3625 
	`kä“
(
ioùl_¬gs
);

3626  -
EINVAL
;

3629 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3630 
ho¡_¡©e
 = 
sdev
->
deviû_cÚfig
.host_state;

3632 ià(!
mode
)

3633 
ho¡_¡©e
 = ho¡_¡©| 
SLSI_HOSTSTATE_SAR_ACTIVE
;

3635 
ho¡_¡©e
 = ho¡_¡©& ~
SLSI_HOSTSTATE_SAR_ACTIVE
;

3637 
”rÜ
 = 
	`¦si_mlme_£t_ho¡_¡©e
(
sdev
, 
dev
, 
ho¡_¡©e
);

3638 ià(!
”rÜ
)

3639 
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 = host_state;

3641 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3643 
	`kä“
(
ioùl_¬gs
);

3644  
”rÜ
;

3645 
	}
}

3647 
	$¦si_£t_tx_pow”_ÿÎšg_nÚ_Ëgacy
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3649 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3650 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3651 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

3652 
mode
 = 0;

3653 
”rÜ
 = 0;

3654 
u16
 
ho¡_¡©e
 = 0;

3656 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

3657 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

3659 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mode
)) {

3660 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

3661 
	`kä“
(
ioùl_¬gs
);

3662  -
EINVAL
;

3665 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3666 
ho¡_¡©e
 = 
sdev
->
deviû_cÚfig
.host_state;

3668 
mode
) {

3669 
HEAD_SAR_BACKOFF_DISABLED
:

3670 
ho¡_¡©e
 &ğ~
SLSI_HOSTSTATE_HEAD_SAR_ACTIVE
;

3672 
HEAD_SAR_BACKOFF_ENABLED
:

3673 
ho¡_¡©e
 |ğ
SLSI_HOSTSTATE_HEAD_SAR_ACTIVE
;

3675 
BODY_SAR_BACKOFF_DISABLED
:

3676 
ho¡_¡©e
 &ğ~
SLSI_HOSTSTATE_GRIP_SAR_ACTIVE
;

3678 
BODY_SAR_BACKOFF_ENABLED
:

3679 
ho¡_¡©e
 |ğ
SLSI_HOSTSTATE_GRIP_SAR_ACTIVE
;

3681 
NR_MMWAVE_SAR_BACKOFF_DISABLED
:

3682 
ho¡_¡©e
 &ğ~(
SLSI_HOSTSTATE_BASE_MMW
 << 
SLSI_HOSTSTATE_BASE_POS
);

3684 
NR_MMWAVE_SAR_BACKOFF_ENABLED
:

3685 
ho¡_¡©e
 &ğ~
SLSI_HOSTSTATE_BASE_MASK
;

3686 
ho¡_¡©e
 |ğ
SLSI_HOSTSTATE_BASE_MMW
 << 
SLSI_HOSTSTATE_BASE_POS
;

3688 
NR_SUB6_SAR_BACKOFF_DISABLED
:

3689 
sdev
->
deviû_cÚfig
.
ho¡_¡©e_sub6_bªd
 = 
çl£
;

3690 
ho¡_¡©e
 &ğ~(
SLSI_HOSTSTATE_SUB6_BAND_MASK
 | 
SLSI_HOSTSTATE_BASE_MASK
);

3692 
NR_SUB6_SAR_BACKOFF_ENABLED
:

3693 
sdev
->
deviû_cÚfig
.
ho¡_¡©e_sub6_bªd
 = 
Œue
;

3694 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3695 
	`kä“
(
ioùl_¬gs
);

3696  
”rÜ
;

3697 
SAR_BACKOFF_DISABLE_ALL
:

3698 
ho¡_¡©e
 &ğ
SLSI_HOSTSTATE_SAR_INIT_MASK
;

3700 
MHS_SAR_BACKOFF_DISABLED
:

3701 
ho¡_¡©e
 &ğ~
SLSI_HOSTSTATE_MHS_SAR_ACTIVE
;

3703 
MHS_SAR_BACKOFF_ENABLED
:

3704 
ho¡_¡©e
 |ğ
SLSI_HOSTSTATE_MHS_SAR_ACTIVE
;

3707 
	`SLSI_ERR
(
sdev
, "Inv®id mode: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

3708 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3709 
	`kä“
(
ioùl_¬gs
);

3710  -
EINVAL
;

3713 
”rÜ
 = 
	`¦si_mlme_£t_ho¡_¡©e
(
sdev
, 
dev
, 
ho¡_¡©e
);

3714 ià(!
”rÜ
)

3715 
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 = host_state;

3717 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3718 
	`kä“
(
ioùl_¬gs
);

3719  
”rÜ
;

3720 
	}
}

3722 
	$¦si_£t_tx_pow”_ÿÎšg
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3724 
»t
 = 0;

3726 ià(
	`¦si_g‘_Ëgacy_§r_backoff
())

3727 
»t
 = 
	`¦si_£t_tx_pow”_ÿÎšg_Ëgacy
(
dev
, 
commªd
, 
buf_Ën
);

3729 
»t
 = 
	`¦si_£t_tx_pow”_ÿÎšg_nÚ_Ëgacy
(
dev
, 
commªd
, 
buf_Ën
);

3731  
»t
;

3732 
	}
}

3734 
	$¦si_£t_tx_pow”_§r
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3736 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3737 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3738 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

3739 
mode
 = 0;

3740 
”rÜ
 = 0;

3741 
u16
 
ho¡_¡©e
 = 0;

3743 ià(!
	`¦si_g‘_Ëgacy_§r_backoff
()) {

3744 
	`SLSI_ERR
(
sdev
, "Legacy SAR Backoff is false\n");

3745  -
EINVAL
;

3748 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

3749 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

3751 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mode
)) {

3752 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

3753 
	`kä“
(
ioùl_¬gs
);

3754  -
EINVAL
;

3757 ià(
mode
 < 0 || mode > 4) {

3758 
	`SLSI_ERR
(
sdev
, "Inv®id mode: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

3759 
	`kä“
(
ioùl_¬gs
);

3760  -
EINVAL
;

3763 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3764 
ho¡_¡©e
 = 
sdev
->
deviû_cÚfig
.host_state;

3765 
ho¡_¡©e
 &ğ~(
SLSI_HOSTSTATE_SAR_ACTIVE
 | 
	`BIT
(3) | BIT(4));

3767 ià(
mode
)

3768 
ho¡_¡©e
 |ğ((
mode
 - 1è<< 3è| 
SLSI_HOSTSTATE_SAR_ACTIVE
;

3770 
”rÜ
 = 
	`¦si_mlme_£t_ho¡_¡©e
(
sdev
, 
dev
, 
ho¡_¡©e
);

3771 ià(!
”rÜ
)

3772 
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 = host_state;

3774 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3776 
	`kä“
(
ioùl_¬gs
);

3777  
”rÜ
;

3778 
	}
}

3780 
	$¦si_g‘_tx_pow”_§r
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3782 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3783 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3784 
Ën
 = 0;

3785 
u16
 
ho¡_¡©e
 = 0, 
šdex
 = 0;

3787 ià(!
	`¦si_g‘_Ëgacy_§r_backoff
()) {

3788 
	`SLSI_ERR
(
sdev
, "Legacy SAR Backoff is false\n");

3789  -
EINVAL
;

3792 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3793 
ho¡_¡©e
 = 
sdev
->
deviû_cÚfig
.host_state;

3795 ià(
ho¡_¡©e
 & 
SLSI_HOSTSTATE_SAR_ACTIVE
)

3796 
šdex
 = ((
ho¡_¡©e
 >> 3) & 3) + 1;

3798 
šdex
 = 0;

3800 
Ën
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "%u", 
šdex
);

3801 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3803  
Ën
;

3804 
	}
}

3806 
	$¦si_£t_tx_pow”_sub6_bªd
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

3808 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3809 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3810 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

3811 
mode
 = 0;

3812 
”rÜ
 = 0;

3813 
u16
 
ho¡_¡©e
 = 0;

3815 ià(
	`¦si_g‘_Ëgacy_§r_backoff
()) {

3816 
	`SLSI_ERR
(
sdev
, "Legacy SAR Backoff is True\n");

3817  -
EINVAL
;

3820 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

3821 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

3823 ià(!
sdev
->
deviû_cÚfig
.
ho¡_¡©e_sub6_bªd
) {

3824 
	`SLSI_ERR
(
sdev
, "'SET_TX_POWER_CALLING 6' must be called first.\n");

3825 
	`kä“
(
ioùl_¬gs
);

3826  -
EINVAL
;

3829 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mode
)) {

3830 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

3831 
	`kä“
(
ioùl_¬gs
);

3832  -
EINVAL
;

3835 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3836 
ho¡_¡©e
 = 
sdev
->
deviû_cÚfig
.host_state;

3838 
ho¡_¡©e
 &ğ~(
SLSI_HOSTSTATE_SUB6_BAND_MASK
 | 
SLSI_HOSTSTATE_BASE_MASK
);

3839 
ho¡_¡©e
 |ğ
SLSI_HOSTSTATE_BASE_SUB6
 << 
SLSI_HOSTSTATE_BASE_POS
;

3841 
mode
) {

3842 
SUB6_SAR_1_BAND
:

3843 
ho¡_¡©e
 |ğ(
SUB6_SAR_1
 << 
SLSI_HOSTSTATE_SUB6_BAND_POS
);

3845 
SUB6_SAR_2_BAND
:

3846 
ho¡_¡©e
 |ğ(
SUB6_SAR_2
 << 
SLSI_HOSTSTATE_SUB6_BAND_POS
);

3848 
SUB6_SAR_3_BAND
:

3849 
ho¡_¡©e
 |ğ(
SUB6_SAR_3
 << 
SLSI_HOSTSTATE_SUB6_BAND_POS
);

3851 
SUB6_SAR_4_BAND
:

3852 
ho¡_¡©e
 |ğ(
SUB6_SAR_4
 << 
SLSI_HOSTSTATE_SUB6_BAND_POS
);

3854 
SUB6_SAR_5_BAND
:

3855 
ho¡_¡©e
 |ğ(
SUB6_SAR_5
 << 
SLSI_HOSTSTATE_SUB6_BAND_POS
);

3857 
SUB6_SAR_6_BAND
:

3858 
ho¡_¡©e
 |ğ(
SUB6_SAR_6
 << 
SLSI_HOSTSTATE_SUB6_BAND_POS
);

3861 
	`SLSI_ERR
(
sdev
, "Inv®id mode: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

3862 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3863 
	`kä“
(
ioùl_¬gs
);

3864  -
EINVAL
;

3867 
”rÜ
 = 
	`¦si_mlme_£t_ho¡_¡©e
(
sdev
, 
dev
, 
ho¡_¡©e
);

3868 ià(!
”rÜ
)

3869 
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 = host_state;

3871 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3873 
	`kä“
(
ioùl_¬gs
);

3874  
”rÜ
;

3875 
	}
}

3877 
	$¦si_´št_»guÏtÜy
(
¦si_802_11d_»g_domaš
 *
domaš_šfo
, *
buf
, 
buf_Ën
, 
¦si_suµÜ‹d_chªÃls
 *
suµÜ‹d_chªÃls
, 
suµ_chª_Ëngth
)

3879 
cur_pos
 = 0;

3880 
i
, 
j
, 
k
;

3881 *
dfs_»giÚ_¡r
[] = {"unknown", "FCC", "ETSI", "JAPAN", "GLOBAL", "CHINA"};

3882 
u8
 
dfs_»giÚ_šdex
;

3883 
›“80211_»g_ruË
 *
»g_ruË
;

3884 
chªÃl_¡¬t_äeq
 = 0;

3885 
chªÃl_’d_äeq
 = 0;

3886 
chªÃl_¡¬t_num
 = 0;

3887 
chªÃl_’d_num
 = 0;

3888 
chªÃl_couÁ
 = 0;

3889 
chªÃl_šüem’t
 = 0;

3890 
chªÃl_bªd
 = 0;

3891 
boŞ
 
di¥Ïy_·‰”n
 = 
çl£
;

3893 
cur_pos
 = 
	`¢´štf
(
buf
, 
buf_Ën
, "couÁry %c%c:", 
domaš_šfo
->
»gdomaš
->
®pha2
[0],

3894 
domaš_šfo
->
»gdomaš
->
®pha2
[1]);

3895 
dfs_»giÚ_šdex
 = 
domaš_šfo
->
»gdomaš
->
dfs_»giÚ
 <= 5 ? domain_info->regdomain->dfs_region : 0;

3896 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, "DFS-%s\n", 
dfs_»giÚ_¡r
[
dfs_»giÚ_šdex
]);

3897 
i
 = 0; i < 
domaš_šfo
->
»gdomaš
->
n_»g_ruËs
; i++) {

3898 
»g_ruË
 = &
domaš_šfo
->
»gdomaš
->
»g_ruËs
[
i
];

3899 ià(
»g_ruË
->
äeq_¿nge
.
¡¬t_äeq_khz
 / 1000 >= 57000)

3901 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, "\t(%d-%d @ %d), (N/A, %d)",

3902 
»g_ruË
->
äeq_¿nge
.
¡¬t_äeq_khz
 / 1000,

3903 
»g_ruË
->
äeq_¿nge
.
’d_äeq_khz
 / 1000,

3904 
»g_ruË
->
äeq_¿nge
.
max_bªdwidth_khz
 / 1000,

3905 
	`MBM_TO_DBM
(
»g_ruË
->
pow”_ruË
.
max_eœp
));

3906 ià(
»g_ruË
->
æags
) {

3907 ià(
»g_ruË
->
æags
 & 
NL80211_RRF_DFS
)

3908 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, ", DFS");

3909 ià(
»g_ruË
->
æags
 & 
NL80211_RRF_NO_OFDM
)

3910 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, ", NO_OFDM");

3911 ià(
»g_ruË
->
æags
 & (
NL80211_RRF_NO_IR
))

3912 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, ", NO_IR");

3913 ià(
»g_ruË
->
æags
 & 
NL80211_RRF_NO_INDOOR
)

3914 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, ", NO_INDOOR");

3915 ià(
»g_ruË
->
æags
 & 
NL80211_RRF_NO_OUTDOOR
)

3916 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, ", NO_OUTDOOR");

3918 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, "\n");

3922 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, "Channels:");

3924 
i
 = 0; i < 
suµ_chª_Ëngth
; i++) {

3925 
chªÃl_¡¬t_num
 = 
suµÜ‹d_chªÃls
[
i
].
¡¬t_chª_num
;

3926 
chªÃl_couÁ
 = 
suµÜ‹d_chªÃls
[
i
].channel_count;

3927 
chªÃl_šüem’t
 = 
suµÜ‹d_chªÃls
[
i
].
šüem’t
;

3928 
chªÃl_bªd
 = 
suµÜ‹d_chªÃls
[
i
].
bªd
;

3929 
chªÃl_’d_num
 = 
chªÃl_¡¬t_num
 + ((
chªÃl_couÁ
 - 1è* 
chªÃl_šüem’t
);

3930 
j
 = 
chªÃl_¡¬t_num
; j <ğ
chªÃl_’d_num
; j +ğ
chªÃl_šüem’t
) {

3931 
chªÃl_¡¬t_äeq
 = (
	`›“80211_chªÃl_to_äequ’cy
(
j
, 
chªÃl_bªd
) * 1000) - 10000;

3932 
chªÃl_’d_äeq
 = (
	`›“80211_chªÃl_to_äequ’cy
(
j
, 
chªÃl_bªd
) * 1000) + 10000;

3933 
k
 = 0; k < 
domaš_šfo
->
»gdomaš
->
n_»g_ruËs
; k++) {

3934 
»g_ruË
 = &
domaš_šfo
->
»gdomaš
->
»g_ruËs
[
k
];

3935 ià(
»g_ruË
->
äeq_¿nge
.
¡¬t_äeq_khz
 <ğ
chªÃl_¡¬t_äeq
 &&

3936 
»g_ruË
->
äeq_¿nge
.
’d_äeq_khz
 >ğ
chªÃl_’d_äeq
) {

3937 ià(
di¥Ïy_·‰”n
)

3938 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, ", %d", 
j
);

3940 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, " %d", 
j
);

3941 
di¥Ïy_·‰”n
 = 
Œue
;

3947 
cur_pos
 +ğ
	`¢´štf
(
buf
 + cur_pos, 
buf_Ën
 - cur_pos, "\n");

3948  
cur_pos
;

3949 
	}
}

3951 
	$¦si_g‘_suµÜ‹d_chªÃls
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_suµÜ‹d_chªÃls
 *
suµÜ‹d_chªÃls
)

3953 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

3954 
¦si_mib_d©a
 
suµÜ‹d_chª_mib
;

3955 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

3956 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = {{
SLSI_PSID_UNIFI_SUPPORTED_CHANNELS
, { 0, 0 } } };

3957 
i
, 
chª_couÁ
, 
chª_¡¬t
;

3958 
suµ_chª_Ëngth
 = 0;

3961 
mibr¥
.
d©aL’gth
 = 16;

3962 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

3963 ià(!
mibr¥
.
d©a
) {

3964 
	`SLSI_ERR
(
sdev
, "CªnÙ km®loø%d by‹s\n", 
mibr¥
.
d©aL’gth
);

3967 
v®ues
 = 
	`¦si_»ad_mibs
(
sdev
, 
dev
, 
g‘_v®ues
, 1, &
mibr¥
);

3968 ià(!
v®ues
)

3969 
ex™_w™h_mibr¥
;

3971 ià(
v®ues
[0].
ty³
 !ğ
SLSI_MIB_TYPE_OCTET
) {

3972 
	`SLSI_ERR
(
sdev
, "Supported_Chan invalidype.");

3973 
ex™_w™h_v®ues
;

3976 
suµÜ‹d_chª_mib
 = 
v®ues
[0].
u
.
où‘V®ue
;

3977 
i
 = 0; i < 
suµÜ‹d_chª_mib
.
d©aL’gth
 / 2; i++) {

3978 
chª_¡¬t
 = 
suµÜ‹d_chª_mib
.
d©a
[
i
 * 2];

3979 
chª_couÁ
 = 
suµÜ‹d_chª_mib
.
d©a
[
i
 * 2 + 1];

3980 ià(
chª_¡¬t
 == 1) {

3981 
suµÜ‹d_chªÃls
[
suµ_chª_Ëngth
].
¡¬t_chª_num
 = 1;

3982 ià(!(
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 & 
SLSI_HOSTSTATE_CELLULAR_ACTIVE
) &&

3983 
chª_couÁ
 > 11 && 
sdev
->
deviû_cÚfig
.
di§bË_ch12_ch13
) {

3984 
chª_couÁ
 = 11;

3985 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Channels 12‡nd 13 have been disabled");

3987 
suµÜ‹d_chªÃls
[
suµ_chª_Ëngth
].
chªÃl_couÁ
 = 
chª_couÁ
;

3988 
suµÜ‹d_chªÃls
[
suµ_chª_Ëngth
].
šüem’t
 = 1;

3989 
suµÜ‹d_chªÃls
[
suµ_chª_Ëngth
].
bªd
 = 
NL80211_BAND_2GHZ
;

3990 
suµ_chª_Ëngth
 = supp_chan_length + 1;

3992 
suµÜ‹d_chªÃls
[
suµ_chª_Ëngth
].
¡¬t_chª_num
 = 
chª_¡¬t
;

3993 
suµÜ‹d_chªÃls
[
suµ_chª_Ëngth
].
chªÃl_couÁ
 = 
chª_couÁ
;

3994 
suµÜ‹d_chªÃls
[
suµ_chª_Ëngth
].
šüem’t
 = 4;

3995 
suµÜ‹d_chªÃls
[
suµ_chª_Ëngth
].
bªd
 = 
NL80211_BAND_5GHZ
;

3996 
suµ_chª_Ëngth
 = supp_chan_length + 1;

3999 
ex™_w™h_v®ues
:

4000 
	`kä“
(
v®ues
);

4001 
ex™_w™h_mibr¥
:

4002 
	`kä“
(
mibr¥
.
d©a
);

4003  
suµ_chª_Ëngth
;

4004 
	}
}

4006 
	$¦si_g‘_»guÏtÜy
(
Ãt_deviû
 *
dev
, *
buf
, 
buf_Ën
)

4008 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4009 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4010 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4011 
mode
 = 0;

4012 
cur_pos
 = 0;

4013 
¡©us
;

4014 
u8
 
®pha2
[3];

4015 
¦si_suµÜ‹d_chªÃls
 
suµÜ‹d_chªÃls
[5];

4016 
suµ_chª_Ëngth
;

4018 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
buf
, 
buf_Ën
, 1);

4019 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4021 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mode
)) {

4022 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4023 
	`kä“
(
ioùl_¬gs
);

4024  -
EINVAL
;

4027 ià(
mode
 != 0 && mode != 1) {

4028 
	`SLSI_ERR
(
sdev
, "Inv®id mode: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4029 
	`kä“
(
ioùl_¬gs
);

4030  -
EINVAL
;

4033 ià(
mode
 == 1) {

4034 
¦si_802_11d_»g_domaš
 
domaš_šfo
;

4036 
	`mem£t
(&
domaš_šfo
, 0, (
¦si_802_11d_»g_domaš
));

4037 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4038 ià(!
ndev_vif
->
aùiv©ed
 ||‚dev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
 || !ndev_vif->
¡a
.
¡a_bss
) {

4039 
	`¢´štf
(
buf
, 
buf_Ën
, "Station‚ot connected");

4040 
	`SLSI_ERR
(
sdev
, "station‚ot connected. vif.activated:%d, vif.type:%d, vif.bss:%s\n",

4041 
ndev_vif
->
aùiv©ed
,‚dev_vif->
vif_ty³
,‚dev_vif->
¡a
.
¡a_bss
 ? "yes" : "no");

4042 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4043 
	`kä“
(
ioùl_¬gs
);

4044  -
EINVAL
;

4047 
¡©us
 = 
	`¦si_»ad_deçuÉ_couÁry
(
sdev
, 
®pha2
, 
ndev_vif
->
iâum
 + 1);

4048 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4049 ià(
¡©us
) {

4050 
	`kä“
(
ioùl_¬gs
);

4051  
¡©us
;

4055 
domaš_šfo
.
»gdomaš
 = 
	`km®loc
((*domaš_šfo.»gdomašè+ (
›“80211_»g_ruË
è* 20, 
GFP_KERNEL
);

4056 ià(!
domaš_šfo
.
»gdomaš
) {

4057 
	`SLSI_ERR
(
sdev
, "no memory size:%lu\n",

4058 (
›“80211_»gdomaš
è+ (
›“80211_»g_ruË
) * 20);

4059 
	`kä“
(
ioùl_¬gs
);

4060  -
ENOMEM
;

4064 
domaš_šfo
.
couÁryli¡
 = 
sdev
->
deviû_cÚfig
.domain_info.countrylist;

4065 
domaš_šfo
.
couÁry_Ën
 = 
sdev
->
deviû_cÚfig
.domain_info.country_len;

4066 
¡©us
 = 
	`¦si_»ad_»guÏtÜy_ruËs
(
sdev
, &
domaš_šfo
, 
®pha2
);

4067 ià(
¡©us
) {

4068 
	`kä“
(
domaš_šfo
.
»gdomaš
);

4069 
	`kä“
(
ioùl_¬gs
);

4070  
¡©us
;

4073 
suµ_chª_Ëngth
 = 
	`¦si_g‘_suµÜ‹d_chªÃls
(
sdev
, 
dev
, &
suµÜ‹d_chªÃls
[0]);

4074 
cur_pos
 +ğ
	`¦si_´št_»guÏtÜy
(&
domaš_šfo
, 
buf
 + cur_pos, 
buf_Ën
 - cur_pos, &
suµÜ‹d_chªÃls
[0], 
suµ_chª_Ëngth
);

4075 
	`kä“
(
domaš_šfo
.
»gdomaš
);

4076 } ià(
mode
 == 0) {

4077 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4078 
suµ_chª_Ëngth
 = 
	`¦si_g‘_suµÜ‹d_chªÃls
(
sdev
, 
dev
, &
suµÜ‹d_chªÃls
[0]);

4079 
cur_pos
 +ğ
	`¦si_´št_»guÏtÜy
(&
sdev
->
deviû_cÚfig
.
domaš_šfo
, 
buf
 + cur_pos, 
buf_Ën
 - cur_pos, &
suµÜ‹d_chªÃls
[0], 
suµ_chª_Ëngth
);

4080 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4085 
	`kä“
(
ioùl_¬gs
);

4086 ià(
buf_Ën
 - 
cur_pos
)

4087  
cur_pos
;

4089  -
ENOMEM
;

4090 
	}
}

4092 
	$¦si_di§bË_ch12_13
(
¦si_dev
 *
sdev
)

4094 
why
 *why = 
sdev
->wiphy;

4095 
›“80211_chªÃl
 *
chª
;

4097 ià(
why
->
bªds
[0]) {

4098 
chª
 = &
why
->
bªds
[0]->
chªÃls
[11];

4099 
chª
->
æags
 |ğ
IEEE80211_CHAN_DISABLED
;

4100 
chª
 = &
why
->
bªds
[0]->
chªÃls
[12];

4101 
chª
->
æags
 |ğ
IEEE80211_CHAN_DISABLED
;

4104 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Channels 12‡nd 13 have been disabled");

4105 
	}
}

4107 
	$¦si_£t_fcc_chªÃl
(
Ãt_deviû
 *
dev
, *
cmd
, 
cmd_Ën
)

4109 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4110 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4111 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4112 
¡©us
;

4113 
fcc_chªÃl_v®ue
;

4114 
u16
 
ho¡_¡©e
 = 0;

4116 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
cmd
, 
cmd_Ën
, 1);

4117 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4119 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
fcc_chªÃl_v®ue
)) {

4120 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4121 
	`kä“
(
ioùl_¬gs
);

4122  -
EINVAL
;

4125 ià(
fcc_chªÃl_v®ue
 != 0 && fcc_channel_value != -1) {

4126 
	`SLSI_ERR
(
sdev
, "Inv®id v®uoàæight_mode_’a: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4127 
	`kä“
(
ioùl_¬gs
);

4128  -
EINVAL
;

4131 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4132 
ho¡_¡©e
 = 
sdev
->
deviû_cÚfig
.host_state;

4136 ià(
fcc_chªÃl_v®ue
 == 0)

4137 
ho¡_¡©e
 = ho¡_¡©& ~
SLSI_HOSTSTATE_CELLULAR_ACTIVE
;

4139 
ho¡_¡©e
 = ho¡_¡©| 
SLSI_HOSTSTATE_CELLULAR_ACTIVE
;

4140 
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 = host_state;

4142 
¡©us
 = 
	`¦si_mlme_£t_ho¡_¡©e
(
sdev
, 
dev
, 
ho¡_¡©e
);

4143 ià(
¡©us
) {

4144 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg MMaxPow”EÇ.ƒ¼Ü = %d\n", 
¡©us
);

4146 ià(
fcc_chªÃl_v®ue
 =ğ0 && 
sdev
->
deviû_cÚfig
.
di§bË_ch12_ch13
)

4147 
	`¦si_di§bË_ch12_13
(
sdev
);

4149 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4151 
	`kä“
(
ioùl_¬gs
);

4152  
¡©us
;

4153 
	}
}

4155 
	$¦si_çke_mac_wr™e
(
Ãt_deviû
 *
dev
, *
cmd
, 
buf_Ën
)

4157 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4158 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4159 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

4160 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4161 
¡©us
;

4162 
boŞ
 
’abË
;

4164 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
cmd
, 
buf_Ën
, 1);

4165 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4167 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]è=ğ2 && 
	`¡ºcmp
(ioctl_args->args[0], "ON", strlen("ON")) == 0) {

4168 
’abË
 = 1;

4169 } ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]è=ğ3 && 
	`¡ºcmp
(ioctl_args->args[0], "OFF", strlen("OFF")) == 0) {

4170 
’abË
 = 0;

4172 
	`SLSI_ERR
(
sdev
, "Inv®id…¬am‘”: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4173 
	`kä“
(
ioùl_¬gs
);

4174  -
EINVAL
;

4177 
¡©us
 = 
	`¦si_mib_’code_boŞ
(&
mib_d©a
, 
SLSI_PSID_UNIFI_MAC_ADDRESS_RANDOMISATION
, 
’abË
, 0);

4178 ià(
¡©us
 !ğ
SLSI_MIB_STATUS_SUCCESS
) {

4179 
	`SLSI_ERR
(
sdev
, "FAKE MAC FAIL:‚o mem for MIB\n");

4180 
	`kä“
(
ioùl_¬gs
);

4181  -
ENOMEM
;

4184 
¡©us
 = 
	`¦si_mlme_£t
(
sdev
, 
NULL
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

4186 
	`kä“
(
mib_d©a
.
d©a
);

4188 ià(
¡©us
)

4189 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg unifiMacAddrRªdomi¡aiÚ MIB.ƒ¼Ü = %d\n", 
¡©us
);

4191 
	`kä“
(
ioùl_¬gs
);

4192  
¡©us
;

4193 
	}
}

4195 *
	$¦si_g‘_assoc_¡©us
(
u16
 
fw_»suÉ_code
)

4197 *
assoc_¡©us_Ïb–
 = "unspecified_failure";

4199 
fw_»suÉ_code
) {

4200 
FAPI_RESULTCODE_SUCCESS
:

4201 
assoc_¡©us_Ïb–
 = "success";

4203 
FAPI_RESULTCODE_TRANSMISSION_FAILURE
:

4204 
assoc_¡©us_Ïb–
 = "transmission_failure";

4206 
FAPI_RESULTCODE_HOST_REQUEST_SUCCESS
:

4207 
assoc_¡©us_Ïb–
 = "host_request_success";

4209 
FAPI_RESULTCODE_HOST_REQUEST_FAILED
:

4210 
assoc_¡©us_Ïb–
 = "host_request_failed";

4212 
FAPI_RESULTCODE_PROBE_TIMEOUT
:

4213 
assoc_¡©us_Ïb–
 = "probe_timeout";

4215 
FAPI_RESULTCODE_AUTH_TIMEOUT
:

4216 
assoc_¡©us_Ïb–
 = "auth_timeout";

4218 
FAPI_RESULTCODE_ASSOC_TIMEOUT
:

4219 
assoc_¡©us_Ïb–
 = "assoc_timeout";

4221 
FAPI_RESULTCODE_ASSOC_ABORT
:

4222 
assoc_¡©us_Ïb–
 = "assoc_abort";

4225  
assoc_¡©us_Ïb–
;

4226 
	}
}

4228 
	$¦si_g‘_¡a_šfo
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4230 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4231 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4232 
Ën
;

4233 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


4234 
Ãt_deviû
 *
­_dev
;

4235 
Ãtdev_vif
 *
ndev_­_vif
;

4237 
­_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2PX_SWLAN
);

4239 ià(
­_dev
) {

4240 
ndev_­_vif
 = 
	`Ãtdev_´iv
(
­_dev
);

4241 
	`SLSI_MUTEX_LOCK
(
ndev_­_vif
->
vif_mu‹x
);

4242 ià(
	`SLSI_IS_VIF_INDEX_MHS
(
sdev
, 
ndev_­_vif
))

4243 
ndev_vif
 = 
ndev_­_vif
;

4244 
	`SLSI_MUTEX_UNLOCK
(
ndev_­_vif
->
vif_mu‹x
);

4248 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4250 ià(!
ndev_vif
->
aùiv©ed
 ||‚dev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_AP
) {

4251 
	`SLSI_ERR
(
sdev
, "slsi_get_sta_info: AP is‚ot up.Command‚ot‡llowed vif.activated:%d, vif.type:%d\n",

4252 
ndev_vif
->
aùiv©ed
,‚dev_vif->
vif_ty³
);

4253 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4254  -
EINVAL
;

4257 #ià
	`defšed
(
SCSC_SEP_VERSION
) && (SCSC_SEP_VERSION >= 9)

4258 
Ën
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "GETSTAINFO %pM Rx_Retry_Pkts=%d Rx_BcMc_Pkts=%d CAP=%04x %02x:%02x:%02x ",

4259 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
add»ss
,

4260 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
rx_»Œy_·ck‘s
,

4261 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
rx_bc_mc_·ck‘s
,

4262 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
ÿ·b™›s
,

4263 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
add»ss
[0],

4264 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
add»ss
[1],

4265 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
add»ss
[2]);

4267 
Ën
 +ğ
	`¢´štf
(&
commªd
[Ën], (
buf_Ën
 -†en), "%d %d %d %d %d %d %d %u %d",

4268 
	`›“80211_äequ’cy_to_chªÃl
(
ndev_vif
->
­
.
chªÃl_äeq
),

4269 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
bªdwidth
,‚dev_vif->­.Ï¡_discÚÃùed_¡a.
rssi
,

4270 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
tx_d©a_¿‹
,‚dev_vif->­.Ï¡_discÚÃùed_¡a.
mode
,

4271 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
ª‹Âa_mode
,

4272 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
mimo_u£d
,‚dev_vif->­.Ï¡_discÚÃùed_¡a.
»asÚ
,

4273 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
suµÜt_mode
);

4275 
Ën
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "wl_get_sta_info : %02x%02x%02x %u %d %d %d %d %d %d %u ",

4276 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
add»ss
[0],‚dev_vif->ap.last_disconnected_sta.address[1],

4277 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
add»ss
[2],‚dev_vif->­.
chªÃl_äeq
,

4278 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
bªdwidth
,‚dev_vif->­.Ï¡_discÚÃùed_¡a.
rssi
,

4279 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
tx_d©a_¿‹
,‚dev_vif->­.Ï¡_discÚÃùed_¡a.
mode
,

4280 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
ª‹Âa_mode
,

4281 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
mimo_u£d
,‚dev_vif->­.Ï¡_discÚÃùed_¡a.
»asÚ
);

4284 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4286  
Ën
;

4287 
	}
}

4289 
	$¦si_g‘_bss_rssi
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4291 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4292 
Ën
 = 0;

4294 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4295 
Ën
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "%d", 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
rssi
);

4296 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4298  
Ën
;

4299 
	}
}

4301 
	$¦si_g‘_bss_šfo
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4303 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4304 
Ën
 = 0;

4306 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4308 
Ën
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "%02x:%02x:%02x %u %u %d %u %u %u %u %u %d %d %u %u %u %u",

4309 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
add»ss
[0],‚dev_vif->sta.last_connected_bss.address[1],

4310 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
add»ss
[2],

4311 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
chªÃl_äeq
,‚dev_vif->¡a.Ï¡_cÚÃùed_bss.
bªdwidth
,

4312 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
rssi
,‚dev_vif->¡a.Ï¡_cÚÃùed_bss.
tx_d©a_¿‹
,

4313 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
mode
,‚dev_vif->¡a.Ï¡_cÚÃùed_bss.
ª‹Âa_mode
,

4314 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
mimo_u£d
,

4315 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
·s¥ošt_v”siÚ
,‚dev_vif->¡a.Ï¡_cÚÃùed_bss.
¢r
,

4316 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
noi£_Ëv–
,‚dev_vif->¡a.Ï¡_cÚÃùed_bss.
rßmšg_akm
,

4317 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
rßmšg_couÁ
,‚dev_vif->¡a.Ï¡_cÚÃùed_bss.
kv
,

4318 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
);

4320 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4322  
Ën
;

4323 
	}
}

4325 
	$¦si_g‘_cu
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4327 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4328 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4329 
mib_v®ue
 = 0;

4330 
»s
 = 0;

4332 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4333 ià(!
ndev_vif
->
aùiv©ed
 ||‚dev_vif->
iáy³
 !ğ
NL80211_IFTYPE_STATION
 ||

4334 (
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
 &&‚dev_vif->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
)) {

4335 
	`SLSI_NET_ERR
(
dev
, "Not Activated or Not STA mode or STA is‚ot in Connected state\n");

4336 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4337 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "-1\n");

4338  
»s
;

4341 
»s
 = 
	`¦si_g‘_b—cÚ_cu
(
sdev
, 
dev
, &
mib_v®ue
);

4342 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4344 ià(
»s
)

4345  
»s
;

4347 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "%d\n", 
mib_v®ue
);

4348  
»s
;

4349 
	}
}

4351 #ifdeà
CONFIG_SCSC_WLAN_MAX_LINK_SPEED


4352 
	$¦si_g‘_lšk¥“d
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4354 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4355 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4356 
Ën
 = 0;

4358 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4359 ià(!
ndev_vif
->
aùiv©ed
) {

4360 
	`SLSI_ERR
(
sdev
, "Not Activated, Command‚ot‡llowed vif.activated:%d, vif.type:%d\n",

4361 
ndev_vif
->
aùiv©ed
,‚dev_vif->
vif_ty³
);

4362 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4363  -
EINVAL
;

4366 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
 &&‚dev_vif->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

4367 
	`SLSI_NET_ERR
(
dev
, "sta is‚ot in connected state\n");

4368 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4369  -
EPERM
;

4372 
Ën
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "MAX_SPEED %u CURRENT_LINK_SPEED %u",

4373 
ndev_vif
->
¡a
.
max_¿‹_mbps
,‚dev_vif->¡a.
d©a_¿‹_mbps
);

4375 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4377  
Ën
;

4378 
	}
}

4381 
	$¦si_g‘_assoc_»jeù_šfo
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4383 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4384 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4385 
Ën
 = 0;

4387 
Ën
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "assoc_»jeù.¡©u : %d %s", 
sdev
->
assoc_»suÉ_code
,

4388 
	`¦si_g‘_assoc_¡©us
(
sdev
->
assoc_»suÉ_code
));

4390  
Ën
;

4391 
	}
}

4393 #ifdeà
CONFIG_SCSC_WLAN_LOW_LATENCY_MODE


4394 
	$¦si_£t_pow”_mode
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4396 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4397 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4398 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4399 
¡©us
;

4400 
u16
 
pow”_mode
;

4401 
mode
;

4403 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

4404 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4406 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mode
)) {

4407 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4408 
	`kä“
(
ioùl_¬gs
);

4409  -
EINVAL
;

4412 ià(
mode
 != 0 && mode != 1) {

4413 
	`SLSI_ERR
(
sdev
, "Inv®id…ow”_mode: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4414 
	`kä“
(
ioùl_¬gs
);

4415  -
EINVAL
;

4418 
pow”_mode
 = (
mode
 =ğ0è? 
FAPI_POWERMANAGEMENTMODE_ACTIVE_MODE
 : 
FAPI_POWERMANAGEMENTMODE_POWER_SAVE
;

4419 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4420 ià(!
ndev_vif
->
aùiv©ed
 ||‚dev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
 ||

4421 !(
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
)) {

4422 
	`SLSI_ERR
(
sdev
, "Command‚ot‡llowed vif.activated:%d, vif.type:%d,‚dev_vif->sta.vif_status:%d\n",

4423 
ndev_vif
->
aùiv©ed
,‚dev_vif->
vif_ty³
,‚dev_vif->
¡a
.
vif_¡©us
);

4424 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4425 
	`kä“
(
ioùl_¬gs
);

4426  -
EINVAL
;

4428 
¡©us
 = 
	`¦si_mlme_pow”mgt
(
sdev
, 
dev
, 
pow”_mode
);

4429 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4431 
	`kä“
(
ioùl_¬gs
);

4432  
¡©us
;

4433 
	}
}

4436 
	$¦si_£t_bªdwidth
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

4438 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4439 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4440 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4441 
bªdwidth
 = 0;

4442 
»t
 = 0;

4444 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 1);

4445 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4447 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
bªdwidth
)) {

4448 
	`SLSI_ERR
(
sdev
, "Inv®id bªdwidth sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4449 
	`kä“
(
ioùl_¬gs
);

4450  -
EINVAL
;

4452 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Bªdwidth = %d\n", 
bªdwidth
);

4454 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4455 ià(
bªdwidth
 == 20 || bandwidth == 40 || bandwidth == 80 || bandwidth == 160) {

4456 
sdev
->
fÜûd_bªdwidth
 = 
bªdwidth
;

4458 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4459 
	`kä“
(
ioùl_¬gs
);

4460  -
EINVAL
;

4463 
»t
 = 
	`¦si_mlme_£t_couÁry
(
sdev
, sdev->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->
®pha2
);

4464 
sdev
->
fÜûd_bªdwidth
 = 0;

4465 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4467 ià(
»t
 != 0)

4468 
	`SLSI_NET_ERR
(
dev
, "E¼Ü iÀ£‰šghCouÁry,„‘=%d", 
»t
);

4470 
	`kä“
(
ioùl_¬gs
);

4471  
»t
;

4472 
	}
}

4474 
	$¦si_£t_bss_bªdwidth
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

4476 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4477 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4478 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4479 
sk_buff
 *
»q
;

4480 
sk_buff
 *
cfm
;

4481 
bªdwidth
 = 0;

4482 
´ÙeùiÚ_scİe
 = 0;

4483 
»t
 = 0;

4485 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 2);

4486 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4488 ià(!
	`¦si_is_bw_v®id
(
ioùl_¬gs
->
¬gs
[0])) {

4489 
	`SLSI_ERR
(
sdev
, "UÃx³ùed sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4490 
	`kä“
(
ioùl_¬gs
);

4491  -
EINVAL
;

4494 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
bªdwidth
)) {

4495 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4496 
	`kä“
(
ioùl_¬gs
);

4497  -
EINVAL
;

4500 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
´ÙeùiÚ_scİe
)) {

4501 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

4502 
	`kä“
(
ioùl_¬gs
);

4503  -
EINVAL
;

4506 ià(
´ÙeùiÚ_scİe
 != 0 &&…rotection_scope != 1) {

4507 
	`SLSI_ERR
(
sdev
, "Inv®id v®uoà´ÙeùiÚ_scİe: '%d'\n", 
´ÙeùiÚ_scİe
);

4508 
	`kä“
(
ioùl_¬gs
);

4509  -
EINVAL
;

4512 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4513 ià(
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_STATION
 ||

4514 (
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
 &&‚dev_vif->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
)) {

4515 
	`SLSI_NET_ERR
(
dev
, "Mu¡ bSTA iÁ”çû‡nd cÚÃùed, iáy³ = %d\n", 
ndev_vif
->
iáy³
);

4516 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4517 
	`kä“
(
ioùl_¬gs
);

4518  -
EPERM
;

4521 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_set_bss_max_channel_width_req(vif:%u, bw:%d,…rotection_scope:%x)\n",

4522 
ndev_vif
->
iâum
, 
bªdwidth
, 
´ÙeùiÚ_scİe
);

4524 
»q
 = 
	`çpi_®loc
(
mlme_£t_bss_max_chªÃl_width_»q
, 
MLME_SET_BSS_MAX_CHANNEL_WIDTH_REQ
, 
ndev_vif
->
iâum
, 0);

4525 ià(!
»q
) {

4526 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4527 
	`kä“
(
ioùl_¬gs
);

4528  -
EIO
;

4531 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_bss_max_chªÃl_width_»q
.
´ÙeùiÚ_scİe
,…rotection_scope);

4532 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_bss_max_chªÃl_width_»q
.
chªÃl_šfÜm©iÚ
, 
bªdwidth
);

4534 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_BSS_MAX_CHANNEL_WIDTH_CFM
);

4535 ià(!
cfm
) {

4536 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4537 
	`kä“
(
ioùl_¬gs
);

4538  -
EIO
;

4541 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_bss_max_chªÃl_width_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4542 
	`SLSI_NET_ERR
(
dev
, "mlme_set_bss_max_channel_width_cfm(result:0x%04x) ERROR\n",

4543 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_bss_max_chªÃl_width_cfm
.
»suÉ_code
));

4544 
»t
 = -
EINVAL
;

4547 
	`kä“_skb
(
cfm
);

4549 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4551 
	`kä“
(
ioùl_¬gs
);

4552  
»t
;

4553 
	}
}

4555 
	$¦si_£t_discÚÃù_›s
(
Ãt_deviû
 *
dev
, *
cmd
, 
cmd_Ën
)

4557 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4558 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4559 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4560 *
discÚÃù_›s
 = 
cmd
 + 
	`¡¾’
(
CMD_SET_DISCONNECT_IES
) + 1;

4561 
›_Ën
 = 0;

4562 
u8
 *
discÚÃù_›s_bš
;

4563 
u8
 
‹mp_by‹
;

4564 
i
;

4565 
j
;

4566 
Ën
;

4568 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Setting disconnect IE's\n");

4569 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
cmd
, 
cmd_Ën
, 1);

4570 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4572 
discÚÃù_›s
 = 
ioùl_¬gs
->
¬gs
[0];

4573 
›_Ën
 = 
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]);

4576 
›_Ën
 &= (~0x01);

4577 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4578 
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s_Ën
 = (
›_Ën
 / 2);

4579 
discÚÃù_›s_bš
 = 
	`km®loc
(
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s_Ën
, 
GFP_KERNEL
);

4580 ià(!
discÚÃù_›s_bš
) {

4581 
	`SLSI_ERR
(
sdev
, "Malloc failed\n");

4582 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4583 
	`kä“
(
ioùl_¬gs
);

4584  -
ENOMEM
;

4587 
i
 = 0, 
j
 = 0; j < 
›_Ën
; j += 2) {

4588 
‹mp_by‹
 = 
	`¦si_·r£_hex
(
discÚÃù_›s
[
j
]) << 4 | slsi_parse_hex(disconnect_ies[j + 1]);

4589 
discÚÃù_›s_bš
[
i
++] = 
‹mp_by‹
;

4593 
i
 = 0; i < 
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s_Ën
;) {

4594 ià(
discÚÃù_›s_bš
[
i
] == 0xdd) {

4595 
Ën
 = 
discÚÃù_›s_bš
[
i
 + 1];

4596 ià((
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s_Ën
 - (
i
 + 2)è< 
Ën
) {

4597 
	`SLSI_WARN
(
sdev
, "The†ength of disconnect IE's is‚ot…roper\n");

4598 
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s_Ën
 = 0;

4599 
	`kä“
(
discÚÃù_›s_bš
);

4600 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4601 
	`kä“
(
ioùl_¬gs
);

4602  -
EINVAL
;

4605 
i
 = i + 2 + 
Ën
;

4607 
	`SLSI_WARN
(
sdev
, "Theag of disconnect IE's is‚ot…roper\n");

4608 
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s_Ën
 = 0;

4609 
	`kä“
(
discÚÃù_›s_bš
);

4610 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4611 
	`kä“
(
ioùl_¬gs
);

4612  -
EINVAL
;

4615 
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s
 = 
discÚÃù_›s_bš
;

4616 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4618 
	`kä“
(
ioùl_¬gs
);

4620 
	}
}

4622 
	$¦si_¡¬t_pow”_m—su»m’t_d‘eùiÚ
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4624 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4625 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4626 
u8
 
deviû_add»ss
[
ETH_ALEN
] = { 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF };

4627 
r
 = 0;

4629 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4631 ià(
sdev
->
d‘eù_vif_aùive
) {

4632 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Detect vif‡lready‡ctive\n");

4633 
r
 = -
EINVAL
;

4634 
ex™_w™h_vif_mu‹x
;

4637 ià(
	`¦si_mlme_add_d‘eù_vif
(
sdev
, 
dev
, dev->
dev_addr
, 
deviû_add»ss
) != 0) {

4638 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_add_vif for detect vif failed\n");

4639 
r
 = -
EINVAL
;

4640 
ex™_w™h_vif_mu‹x
;

4643 
sdev
->
d‘eù_vif_aùive
 = 
Œue
;

4644 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Starting Power Measurement Detection\n");

4645 
r
 = 
	`¦si_mlme_¡¬t_d‘eù_»que¡
(
sdev
, 
dev
);

4646 ià(
r
) {

4647 
r
 = -
EINVAL
;

4648 ià(
	`¦si_mlme_d–_d‘eù_vif
(
sdev
, 
dev
) != 0)

4649 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed for detect vif\n");

4650 
sdev
->
d‘eù_vif_aùive
 = 
çl£
;

4653 
ex™_w™h_vif_mu‹x
:

4654 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4655  
r
;

4656 
	}
}

4658 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


4659 
	$¦si_’hªûd_¬p_¡¬t_¡İ
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4661 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4662 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4663 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4664 
»suÉ
 = 0;

4665 
»adby‹
 = 0;

4666 
»adv®ue
 = 0;

4667 
i
 = 0;

4669 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

4670 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4672 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
»adv®ue
)) {

4673 
	`SLSI_ERR
(
sdev
, "Inv®id s¹/¡İ sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4674 
	`kä“
(
ioùl_¬gs
);

4675  -
EINVAL
;

4678 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4679 ià(!
sdev
->
deviû_cÚfig
.
fw_’hªûd_¬p_d‘eù_suµÜ‹d
) {

4680 
	`SLSI_ERR
(
sdev
, "Enhanced ARP Detect Feature is‚ot supported.\n");

4681 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4682 
	`kä“
(
ioùl_¬gs
);

4683  -
ENOTSUPP
;

4685 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4687 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4688 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) {

4689 
	`SLSI_ERR
(
sdev
, "Not in STA mode\n");

4690 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4691 
	`kä“
(
ioùl_¬gs
);

4692  -
EPERM
;

4695 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Enhanced ARP Start/Stop\n");

4697 
	`mem£t
(
ndev_vif
->
rg‘__addr
, 0, (ndev_vif->target_ip_addr));

4698 ià(
»adv®ue
 != 0) {

4699 
i
 = 0; i < 4 ; i++) {

4700 
»adby‹
 = 
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
»adv®ue
);

4701 ià(!
»adby‹
) {

4702 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4703 
	`mem£t
(
ndev_vif
->
rg‘__addr
, 0, (ndev_vif->target_ip_addr));

4704 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4705 
	`kä“
(
ioùl_¬gs
);

4706  -
EINVAL
;

4708 ià(
»adv®ue
 < 0 ||„eadvalue > 255) {

4709 
	`SLSI_ERR
(
sdev
, "Invalid value of IP‡ddress byte\n");

4710 
	`mem£t
(
ndev_vif
->
rg‘__addr
, 0, (ndev_vif->target_ip_addr));

4711 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4712 
	`kä“
(
ioùl_¬gs
);

4713  -
EINVAL
;

4715 
ndev_vif
->
rg‘__addr
[
i
] = 
»adv®ue
;

4716 ià(
i
 == 3)

4718 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]è- 
»adby‹
 - 1 <= 0) {

4719 
	`SLSI_ERR
(
sdev
, "Invalid IP‡ddress\n");

4720 
	`mem£t
(
ndev_vif
->
rg‘__addr
, 0, (ndev_vif->target_ip_addr));

4721 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4722 
	`kä“
(
ioùl_¬gs
);

4723  -
EINVAL
;

4725 
ioùl_¬gs
->
¬gs
[0] = ioùl_¬gs->¬gs[0] + 
»adby‹
 + 1;

4729 ià(
ndev_vif
->
rg‘__addr
[0] != 0) {

4731 
	`¦si_»ad_’hªûd_¬p_rx_couÁ_by_low”_mac
(
sdev
, 
dev
, 
SLSI_PSID_UNIFI_ARP_DETECT_RESPONSE_COUNTER
);

4732 
	`mem£t
(&
ndev_vif
->
’hªûd_¬p_¡©s
, 0, (ndev_vif->enhanced_arp_stats));

4733 
	`mem£t
(
ndev_vif
->
’hªûd_¬p_ho¡_g
, 0, (ndev_vif->enhanced_arp_host_tag));

4734 
ndev_vif
->
’hªûd_¬p_d‘eù_’abËd
 = 
Œue
;

4735 
»suÉ
 = 
	`¦si_mlme_¬p_d‘eù_»que¡
(
sdev
, 
dev
, 
FAPI_ACTION_START
, 
ndev_vif
->
rg‘__addr
);

4737 
ndev_vif
->
’hªûd_¬p_d‘eù_’abËd
 = 
çl£
;

4738 
»suÉ
 = 
	`¦si_mlme_¬p_d‘eù_»que¡
(
sdev
, 
dev
, 
FAPI_ACTION_STOP
, 
ndev_vif
->
rg‘__addr
);

4741 
	`kä“
(
ioùl_¬gs
);

4742 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4743  
»suÉ
;

4744 
	}
}

4746 
	$¦si_’hªûd_¬p_g‘_¡©s
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4748 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4749 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4750 
r
 = 0;

4751 
Ën
 = 0;

4753 
r
 = 
	`¦si_»ad_’hªûd_¬p_rx_couÁ_by_low”_mac
(
sdev
, 
dev
, 
SLSI_PSID_UNIFI_ARP_DETECT_RESPONSE_COUNTER
);

4755 ià(
r
 == 0) {

4756 
Ën
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "%d %d %d %d %d %d %d %d %d %d",

4757 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_»q_couÁ_äom_Ãtdev
,

4758 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_»q_couÁ_to_low”_mac
,

4759 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_»q_rx_couÁ_by_low”_mac
,

4760 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_»q_couÁ_tx_sucûss
,

4761 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_r¥_rx_couÁ_by_low”_mac
,

4762 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_r¥_rx_couÁ_by_uµ”_mac
,

4763 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_r¥_couÁ_to_Ãtdev
,

4764 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_r¥_couÁ_out_of_Üd”_drİ
,

4766 
ndev_vif
->
’hªûd_¬p_¡©s
.
is_du¶iÿ‹_addr_d‘eùed
);

4767 
	`SLSI_DBG2
(
sdev
, 
SLSI_CFG80211
, "Enhªûd ARP Sts: %s\n", 
commªd
);

4771 
	`mem£t
(&
ndev_vif
->
’hªûd_¬p_¡©s
, 0, (ndev_vif->enhanced_arp_stats));

4773  
Ën
;

4774 
	}
}

4777 
	$¦si_ioùl_auto_chª_wr™e
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

4779 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4780 
»t
 = 0;

4782 
»t
 = 
	`¦si_auto_chª_wr™e
(
dev
, 
commªd
, 
cmd_Ën
);

4783 
ndev_vif
->
acs
 = 
Œue
;

4784  
»t
;

4785 
	}
}

4787 #ifdeà
CONFIG_SCSC_WLAN_HANG_TEST


4788 
	$¦si_ioùl_‹¡_fÜû_hªg
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

4790  
	`¦si_‹¡_£nd_hªged_v’dÜ_ev’t
(
dev
);

4791 
	}
}

4794 #ifdeà
CONFIG_SCSC_WLAN_LOW_LATENCY_MODE


4795 
	$¦si_ioùl_£t_Ï‹ncy_mode
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

4797 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4798 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4799 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4800 
Ï‹ncy_mode
 = 0;

4801 
»t
 = 0;

4803 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 1);

4804 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4806 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
Ï‹ncy_mode
)) {

4807 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4808 
»t
 = -
EINVAL
;

4810 ià(
Ï‹ncy_mode
 < 0 ||†atency_mode > 2) {

4811 
	`SLSI_ERR
(
sdev
, "Inv®id†©’cy_mode: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4812 
»t
 = -
EINVAL
;

4814 
»t
 = 
	`¦si_£t_Ï‹ncy_mode
(
dev
, 
Ï‹ncy_mode
, 
cmd_Ën
);

4817 
	`kä“
(
ioùl_¬gs
);

4818  
»t
;

4819 
	}
}

4822 
	$¦si_ioùl_£t_Ï‹ncy_üt_d©a
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

4824 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4825 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4826 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4827 
Ï‹ncy_mode
 = 0;

4828 
»t
 = 0;

4830 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 1);

4831 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4833 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
Ï‹ncy_mode
)) {

4834 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4835 
»t
 = -
EINVAL
;

4837 ià(
Ï‹ncy_mode
 < 0 ||†atency_mode > 3) {

4838 
	`SLSI_ERR
(
sdev
, "Inv®id†©’cy_üt_d©a: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4839 
»t
 = -
EINVAL
;

4841 
»t
 = 
	`¦si_£t_Ï‹ncy_üt_d©a
(
dev
, 
Ï‹ncy_mode
);

4844 
	`kä“
(
ioùl_¬gs
);

4845  
»t
;

4846 
	}
}

4848 #iâdeà
SLSI_TEST_DEV


4849 
	$¦si_ioùl_driv”_bug_dump
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

4851 
»t
 = 0;

4853 
	`¦si_dump_¡©s
(
dev
);

4854 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

4855 
	`scsc_log_cŞËùÜ_scheduË_cŞËùiÚ
(
SCSC_LOG_DUMPSTATE
, 
SCSC_LOG_DUMPSTATE_REASON_DRIVERDEBUGDUMP
);

4857 #iâdeà
SLSI_TEST_DEV


4858 
»t
 = 
	`mx140_log_dump
();

4861  
»t
;

4862 
	}
}

4865 #ifdeà
CONFIG_SCSC_WLAN_NUM_ANTENNAS


4866 
	$¦si_ioùl_g‘_num_ª‹Âas
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4868 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4869 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4870 
num_ª‹Âas
 = 0;

4871 
»s
 = 0;

4873 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4874 
»s
 = 
	`¦si_mlme_g‘_num_ª‹Âas
(
sdev
, 
dev
, &
num_ª‹Âas
);

4875 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4877 ià(
»s
)

4878  
»s
;

4880 
»s
 = 
	`¢´štf
(
commªd
, 
buf_Ën
, "%d\n", 
num_ª‹Âas
);

4881  
»s
;

4882 
	}
}

4884 
	$¦si_ioùl_£t_num_ª‹Âas
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

4886 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4887 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4888 
num_of_ª‹Âas
;

4889 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4890 
»t
 = 0;

4891 
äame_ty³
 = 0;

4893 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
cmd_Ën
, 2);

4894 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4896 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
num_of_ª‹Âas
)) {

4897 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4898 
»t
 = -
EINVAL
;

4903 ià(
ioùl_¬gs
->
¬g_couÁ
 == 2) {

4904 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
äame_ty³
)) {

4905 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

4906 
»t
 = -
EINVAL
;

4907 
ex™
;

4909 
äame_ty³
 += 1;

4911 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4912 
»t
 = 
	`¦si_mlme_£t_num_ª‹Âas
(
dev
, 
num_of_ª‹Âas
, 
äame_ty³
);

4913 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4915 
ex™
:

4916 
	`kä“
(
ioùl_¬gs
);

4917  
»t
;

4918 
	}
}

4921 
	$¦si_–Ç_by·ss
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4923 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4924 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4925 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4926 
mib_v®ue
 = 0;

4928 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

4929 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4931 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

4932 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4933 
	`kä“
(
ioùl_¬gs
);

4934  -
EINVAL
;

4936 
	`kä“
(
ioùl_¬gs
);

4937 ià(
mib_v®ue
 != 0 && mib_value != 1) {

4938 
	`SLSI_ERR
(
sdev
, "Inv®id LNA cÚŒŞ: '%d'\n", 
mib_v®ue
);

4939  -
EINVAL
;

4941 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4942 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
 &&‚dev_vif->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

4943 
	`SLSI_NET_ERR
(
dev
, "sta is‚ot in connected state\n");

4944 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4945  -
EPERM
;

4947 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4949  
	`¦si_£t_ušt_mib
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_LNA_CONTROL_ENABLED
, 
mib_v®ue
);

4950 
	}
}

4952 
	$¦si_–Ç_by·ss_št
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4954 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4955 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4956 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4957 
mib_v®ue
 = 0;

4959 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

4960 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4962 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

4963 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4964 
	`kä“
(
ioùl_¬gs
);

4965  -
EINVAL
;

4967 
	`kä“
(
ioùl_¬gs
);

4968 ià(
mib_v®ue
 < 0 || mib_value > 65535) {

4969 
	`SLSI_ERR
(
sdev
, "Inv®id LNA Ev® IÁ”v–: '%d'\n", 
mib_v®ue
);

4970  -
EINVAL
;

4972 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4973 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
 &&‚dev_vif->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

4974 
	`SLSI_NET_ERR
(
dev
, "sta is‚ot in connected state\n");

4975 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4976  -
EPERM
;

4978 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4980  
	`¦si_£t_ušt_mib
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_LNA_CONTROL_EVALUATION_INTERVAL
, 
mib_v®ue
);

4981 
	}
}

4983 
	$¦si_£t_dw–l_time
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4985 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4986 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4987 
·ssive_time
 = 0;

4988 
home_time
 = 0;

4989 
sÿn_chªÃl_time
 = 0;

4990 
home_away_time
 = 0;

4991 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4992 
»t
 = 0;

4993 
»£t
 = 1;

4995 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 4);

4996 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4998 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
·ssive_time
)) {

4999 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg…assive_time: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

5000 
»t
 = -
EINVAL
;

5001 } ià(
·ssive_time
 < 0 ||…assive_time > 0xFFFF) {

5002 
	`SLSI_ERR
(
sdev
, "Inv®id…assive_timv®ue: '%d'\n", 
·ssive_time
);

5003 
»t
 = -
EINVAL
;

5006 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
home_time
)) {

5007 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg home_time: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

5008 
»t
 = -
EINVAL
;

5009 } ià(
home_time
 < 0 || home_time > 0xFFFF) {

5010 
	`SLSI_ERR
(
sdev
, "Inv®id home_timv®ue: '%d'\n", 
home_time
);

5011 
»t
 = -
EINVAL
;

5014 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[2], &
sÿn_chªÃl_time
)) {

5015 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg sÿn_chªÃl_time: '%s'\n", 
ioùl_¬gs
->
¬gs
[2]);

5016 
»t
 = -
EINVAL
;

5017 } ià(
sÿn_chªÃl_time
 < 0 || scan_channel_time > 0xFFFF) {

5018 
	`SLSI_ERR
(
sdev
, "Inv®id sÿn_chªÃl_timv®ue: '%d'\n", 
sÿn_chªÃl_time
);

5019 
»t
 = -
EINVAL
;

5022 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[3], &
home_away_time
)) {

5023 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg sÿn_chªÃl_time: '%s'\n", 
ioùl_¬gs
->
¬gs
[3]);

5024 
»t
 = -
EINVAL
;

5025 } ià(
home_away_time
 < 0 || home_away_time > 0xFFFF) {

5026 
	`SLSI_ERR
(
sdev
, "Inv®id sÿn_chªÃl_timv®ue: '%d'\n", 
home_away_time
);

5027 
»t
 = -
EINVAL
;

5030 ià(
»t
 != 0)

5031 
ex™
;

5033 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5034 
sdev
->
home_away_time
 = home_away_time;

5035 
sdev
->
home_time
 = home_time;

5036 
sdev
->
max_chªÃl_time
 = 
sÿn_chªÃl_time
;

5037 
sdev
->
max_chªÃl_·ssive_time
 = 
·ssive_time
;

5039 ià(
home_away_time
 !ğ0 && 
home_time
 !ğ0 && 
sÿn_chªÃl_time
 !ğ0 && 
·ssive_time
 != 0)

5040 
sdev
->
Ï‹ncy_·¿m_mask
 = 
LATENCY_ALL_SET_MASK
;

5042 
»£t
 = 0;

5043 
»t
 = 
	`¦si_£t_low_Ï‹ncy_·¿ms
(
dev
, 
»£t
);

5044 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5045 
ex™
:

5046 
	`kä“
(
ioùl_¬gs
);

5047  
»t
;

5048 
	}
}

5050 
	$¦si_max_dtim_su¥’d
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

5052 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5053 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5054 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

5055 
mib_v®ue
 = 0;

5056 
»t
 = 0;

5058 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

5059 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

5061 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

5062 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

5063 
	`kä“
(
ioùl_¬gs
);

5064  -
EINVAL
;

5066 
	`kä“
(
ioùl_¬gs
);

5067 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5068 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
 &&‚dev_vif->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

5069 
	`SLSI_NET_ERR
(
dev
, "sta is‚ot in connected state\n");

5070 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5071  -
EPERM
;

5073 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5075 ià(
mib_v®ue
 < 0 || mib_value > 1) {

5076 
	`SLSI_ERR
(
sdev
, "Inv®id Max DTIM Su¥’d: '%d'\n", 
mib_v®ue
);

5077  -
EINVAL
;

5079 ià(
mib_v®ue
 == 0) {

5080 
sdev
->
max_dtim_»cv
 = 
Œue
;

5081 } ià(
mib_v®ue
 == 1) {

5082 
sdev
->
max_dtim_»cv
 = 
çl£
;

5083 
»t
 = 
	`¦si_£t_ušt_mib
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_USE_HOST_LISTEN_INTERVAL
, 0);

5086  
»t
;

5087 
	}
}

5089 
	$¦si_£t_dtim_su¥’d
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

5091 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5092 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5093 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

5094 
mib_v®ue
 = 0;

5095 
»t
 = 0;

5097 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

5098 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

5100 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
mib_v®ue
)) {

5101 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

5102 
	`kä“
(
ioùl_¬gs
);

5103  -
EINVAL
;

5105 
	`kä“
(
ioùl_¬gs
);

5106 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5107 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
 &&‚dev_vif->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

5108 
	`SLSI_NET_ERR
(
dev
, "sta is‚ot in connected state\n");

5109 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5110  -
EPERM
;

5112 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5114 ià(!
sdev
->
max_dtim_»cv
) {

5115 
	`SLSI_ERR
(
sdev
, "Max DTIM Suspend = 0‚ot„eceived\n");

5116  -
EPERM
;

5119 
sdev
->
max_dtim_»cv
 = 
çl£
;

5121 ià(
mib_v®ue
 < 0) {

5122 
	`SLSI_ERR
(
sdev
, "Inv®id S‘ DTIM Su¥’d v®: '%d'\n", 
mib_v®ue
);

5123  -
EINVAL
;

5126 
»t
 = 
	`¦si_£t_ušt_mib
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_USE_HOST_LISTEN_INTERVAL
, 
mib_v®ue
);

5127  
»t
;

5128 
	}
}

5130 
	$¦si_fÜû_rßmšg_bssid
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

5132 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5133 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5134 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

5135 
u8
 
bssid
[6] = { 0 };

5136 
chªÃl
;

5137 
äeq
;

5138 
Æ80211_bªd
 
bªd
 = 
NL80211_BAND_2GHZ
;

5139 
»t
 = 0;

5141 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 2);

5142 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

5144 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]) != 17) {

5145 
	`SLSI_ERR
(
sdev
, "Inv®id MAC‡dd»s Ëngth :%d\n", ()
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]));

5146 
	`kä“
(
ioùl_¬gs
);

5147  -
EINVAL
;

5150 
	`¦si_machex¡ršg_to_maÿ¼ay
(
ioùl_¬gs
->
¬gs
[0], 
bssid
);

5151 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[1], &
chªÃl
)) {

5152 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ¡ršg: '%s'\n", 
ioùl_¬gs
->
¬gs
[1]);

5153 
	`kä“
(
ioùl_¬gs
);

5154  -
EINVAL
;

5156 
	`kä“
(
ioùl_¬gs
);

5157 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "FÜû Rßm: " 
MACSTR
 " Chan: %d\n",

5158 
	`MAC2STR
(
bssid
), 
chªÃl
);

5161 ià(
	`¦si_is_bssid_š_bÏckli¡
(
sdev
, 
dev
, 
bssid
) ||

5162 
	`¦si_is_bssid_š_h®_bÏckli¡
(
dev
, 
bssid
) ||

5163 
	`¦si_is_bssid_š_ioùl_bÏckli¡
(
dev
, 
bssid
)) {

5164 
	`SLSI_ERR
(
sdev
, "Requested BSSID is in blacklist\n");

5165  -
EINVAL
;

5168 ià(
chªÃl
 < 1 || channel > 165) {

5169 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ: %d\n", 
chªÃl
);

5170  -
EINVAL
;

5173 ià(
chªÃl
 > 14)

5174 
bªd
 = 
NL80211_BAND_5GHZ
;

5175 
äeq
 = (
u16
)
	`›“80211_chªÃl_to_äequ’cy
(
chªÃl
, 
bªd
);

5177 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5178 
»t
 = 
	`¦si_mlme_rßm
(
sdev
, 
dev
, 
bssid
, 
äeq
);

5179 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5180  
»t
;

5181 
	}
}

5183 
	$¦si_rßmšg_bÏckli¡_add
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

5185 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5186 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5187 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

5188 
u8
 
bssid
[6] = { 0 };

5189 
»t
 = 0;

5191 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

5192 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

5194 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]) != 17) {

5195 
	`SLSI_ERR
(
sdev
, "Inv®id MAC‡dd»s Ëngth :%d\n", ()
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]));

5196 
	`kä“
(
ioùl_¬gs
);

5197  -
EINVAL
;

5200 
	`¦si_machex¡ršg_to_maÿ¼ay
(
ioùl_¬gs
->
¬gs
[0], 
bssid
);

5201 
	`kä“
(
ioùl_¬gs
);

5202 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5204 ià(
	`¦si_is_bssid_š_ioùl_bÏckli¡
(
dev
, 
bssid
)) {

5205 
	`SLSI_ERR
(
sdev
, "Requested BSSID‡lready in blacklist\n");

5206 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5207  
»t
;

5209 
»t
 = 
	`¦si_add_ioùl_bÏckli¡
(
sdev
, 
dev
, 
bssid
);

5210 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5211  
»t
;

5212 
	}
}

5214 
	$¦si_rßmšg_bÏckli¡_»move
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

5216 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5217 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5218 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

5219 
u8
 
bssid
[6] = { 0 };

5220 
»t
 = 0;

5222 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

5223 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

5225 ià(
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]) != 17) {

5226 
	`SLSI_ERR
(
sdev
, "Inv®id MAC‡dd»s Ëngth :%d\n", ()
	`¡¾’
(
ioùl_¬gs
->
¬gs
[0]));

5227 
	`kä“
(
ioùl_¬gs
);

5228  -
EINVAL
;

5231 
	`¦si_machex¡ršg_to_maÿ¼ay
(
ioùl_¬gs
->
¬gs
[0], 
bssid
);

5232 
	`kä“
(
ioùl_¬gs
);

5233 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5234 
»t
 = 
	`¦si_»move_bssid_bÏckli¡
(
sdev
, 
dev
, 
bssid
);

5235 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5236  
»t
;

5237 
	}
}

5239 
	$¦si_ioùl_cmd_sucûss
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

5242 
	}
}

5244 
	s¦si_ioùl_â
 {

5245 *
	mÇme
;

5246 (*
	mâ
)(
Ãt_deviû
 *
	mdev
, *
	mcommªd
, 
	mcmd_Ën
);

5249 cÚ¡ 
¦si_ioùl_â
 
	g¦si_ioùl_â_bË
[] = {

5250 { 
CMD_SETSUSPENDMODE
, 
¦si_£t_su¥’d_mode
 },

5251 { 
CMD_SETJOINPREFER
, 
¦si_upd©e_rssi_boo¡
 },

5252 { 
CMD_RXFILTERADD
, 
¦si_rx_f‹r_add
 },

5253 { 
CMD_RXFILTERREMOVE
, 
¦si_rx_f‹r_»move
 },

5254 { 
CMD_SETBANDWIDTH
, 
¦si_£t_bªdwidth
 },

5255 { 
CMD_SETSCANHOMEAWAYTIME_LEGACY
, 
¦si_£t_home_away_time_Ëgacy
 },

5256 { 
CMD_SETSCANHOMETIME_LEGACY
, 
¦si_£t_home_time_Ëgacy
 },

5257 { 
CMD_SETSCANCHANNELTIME_LEGACY
, 
¦si_£t_chªÃl_time_Ëgacy
 },

5258 { 
CMD_SETSCANPASSIVETIME_LEGACY
, 
¦si_£t_·ssive_time_Ëgacy
 },

5259 { 
CMD_SET_TID
, 
¦si_£t_tid
 },

5260 { 
CMD_SET_BSS_CHANNEL_WIDTH
, 
¦si_£t_bss_bªdwidth
 },

5261 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


5262 #ià!
defšed
(
CONFIG_SCSC_WLAN_MHS_STATIC_INTERFACE
è|| (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 9)

5263 { 
CMD_INTERFACE_CREATE
, 
¦si_ü—‹_š‹rçû
 },

5264 { 
CMD_INTERFACE_DELETE
, 
¦si_d–‘e_š‹rçû
 },

5266 { 
CMD_SET_INDOOR_CHANNELS
, 
¦si_£t_wifish¬šg_³rm™‹d_chªÃls
 },

5267 { 
CMD_GET_INDOOR_CHANNELS
, 
¦si_g‘_šdoÜ_chªÃls
 },

5269 { 
CMD_SETCOUNTRYREV
, 
¦si_£t_couÁry_»v
 },

5270 { 
CMD_GETCOUNTRYREV
, 
¦si_g‘_couÁry_»v
 },

5271 { 
CMD_SETROAMBAND
, 
¦si_äeq_bªd_wr™e
 },

5272 { 
CMD_SETBAND
, 
¦si_äeq_bªd_wr™e
 },

5273 { 
CMD_GETROAMBAND
, 
¦si_äeq_bªd_»ad
 },

5274 { 
CMD_GETBAND
, 
¦si_äeq_bªd_»ad
 },

5275 { 
CMD_FACTORY_SETBAND
, 
¦si_çùÜy_äeq_bªd_wr™e
 },

5276 { 
CMD_SETROAMTRIGGER_LEGACY
, 
¦si_Ëgacy_rßm_Œigg”_wr™e
 },

5277 { 
CMD_GETROAMTRIGGER_LEGACY
, 
¦si_Ëgacy_rßm_sÿn_Œigg”_»ad
 },

5278 { 
CMD_REASSOC_LEGACY
, 
¦si_»assoc_wr™e_Ëgacy
 },

5279 { 
CMD_ADDROAMSCANCHANNELS_LEGACY
, 
¦si_rßm_add_sÿn_chªÃls_Ëgacy
 },

5280 { 
CMD_GETROAMSCANCHANNELS_LEGACY
, 
¦si_rßm_sÿn_chªÃls_»ad_Ëgacy
 },

5281 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


5282 { 
CMD_SETROAMTRIGGER
, 
¦si_rßm_sÿn_Œigg”_wr™e
 },

5283 { 
CMD_GETROAMTRIGGER
, 
¦si_rßm_sÿn_Œigg”_»ad
 },

5284 { 
CMD_SETROAMDELTA
, 
¦si_rßm_d–_Œigg”_wr™e
 },

5285 { 
CMD_GETROAMDELTA
, 
¦si_rßm_d–_Œigg”_»ad
 },

5286 { 
CMD_SETROAMSCANPERIOD
, 
¦si_ÿched_chªÃl_sÿn_³riod_wr™e
 },

5287 { 
CMD_GETROAMSCANPERIOD
, 
¦si_ÿched_chªÃl_sÿn_³riod_»ad
 },

5288 { 
CMD_SETFULLROAMSCANPERIOD
, 
¦si_fuÎ_rßm_sÿn_³riod_wr™e
 },

5289 { 
CMD_GETFULLROAMSCANPERIOD
, 
¦si_fuÎ_rßm_sÿn_³riod_»ad
 },

5290 { 
CMD_SETSCANCHANNELTIME
, 
¦si_rßm_sÿn_max_aùive_chªÃl_time_wr™e
 },

5291 { 
CMD_GETSCANCHANNELTIME
, 
¦si_rßm_sÿn_max_aùive_chªÃl_time_»ad
 },

5292 { 
CMD_SETSCANNPROBES
, 
¦si_rßm_sÿn_´obe_š‹rv®_wr™e
 },

5293 { 
CMD_GETSCANNPROBES
, 
¦si_rßm_sÿn_´obe_š‹rv®_»ad
 },

5294 { 
CMD_SETROAMMODE
, 
¦si_rßm_mode_wr™e
 },

5295 { 
CMD_GETROAMMODE
, 
¦si_rßm_mode_»ad
 },

5296 { 
CMD_SETROAMINTRABAND
, 
¦si_rßm_sÿn_bªd_wr™e
 },

5297 { 
CMD_GETROAMINTRABAND
, 
¦si_rßm_sÿn_bªd_»ad
 },

5298 { 
CMD_SETROAMSCANCONTROL
, 
¦si_rßm_sÿn_cÚŒŞ_wr™e
 },

5299 { 
CMD_GETROAMSCANCONTROL
, 
¦si_rßm_sÿn_cÚŒŞ_»ad
 },

5300 { 
CMD_SETSCANHOMETIME
, 
¦si_rßm_sÿn_home_time_wr™e
 },

5301 { 
CMD_GETSCANHOMETIME
, 
¦si_rßm_sÿn_home_time_»ad
 },

5302 { 
CMD_SETSCANHOMEAWAYTIME
, 
¦si_rßm_sÿn_home_away_time_wr™e
 },

5303 { 
CMD_GETSCANHOMEAWAYTIME
, 
¦si_rßm_sÿn_home_away_time_»ad
 },

5304 { 
CMD_SETOKCMODE
, 
¦si_okc_mode_wr™e
 },

5305 { 
CMD_GETOKCMODE
, 
¦si_okc_mode_»ad
 },

5306 { 
CMD_SETWESMODE
, 
¦si_wes_mode_wr™e
 },

5307 { 
CMD_GETWESMODE
, 
¦si_wes_mode_»ad
 },

5308 { 
CMD_SETROAMSCANCHANNELS
, 
¦si_rßm_sÿn_chªÃls_wr™e
 },

5309 { 
CMD_GETROAMSCANCHANNELS
, 
¦si_rßm_sÿn_chªÃls_»ad
 },

5310 { 
CMD_ADDROAMSCANCHANNELS
, 
¦si_rßm_add_sÿn_chªÃls
 },

5311 { 
CMD_GETNCHOMODE
, 
¦si_g‘_ncho_mode
 },

5312 { 
CMD_SETNCHOMODE
, 
¦si_£t_ncho_mode
 },

5313 { 
CMD_SETDFSSCANMODE
, 
¦si_£t_dfs_sÿn_mode
 },

5314 { 
CMD_GETDFSSCANMODE
, 
¦si_g‘_dfs_sÿn_mode
 },

5315 { 
CMD_REASSOC
, 
¦si_»assoc_wr™e
 },

5316 { 
CMD_SETROAMOFFLOAD
, 
¦si_rßm_mode_wr™e
 },

5317 { 
CMD_SETROAMOFFLAPLIST
, 
¦si_rßm_ofæßd_­_li¡
 },

5319 { 
CMD_SET_PMK
, 
¦si_£t_pmk
 },

5320 { 
CMD_HAPD_GET_CHANNEL
, 
¦si_auto_chª_»ad
 },

5321 { 
CMD_SET_SAP_CHANNEL_LIST
, 
¦si_ioùl_auto_chª_wr™e
 },

5322 { 
CMD_SENDACTIONFRAME
, 
¦si_£nd_aùiÚ_äame
 },

5323 { 
CMD_CERTSENDACTIONFRAME
, 
¦si_£nd_aùiÚ_äame_û¹
 },

5324 #ifdeà
SLSI_TEST_DEV


5325 { 
CMD_GASSENDACTIONFRAME
, 
¦si_£nd_aùiÚ_äame_ut
 },

5327 { 
CMD_HAPD_MAX_NUM_STA
, 
¦si_£‰šg_max_¡a_wr™e
 },

5328 { 
CMD_COUNTRY
, 
¦si_couÁry_wr™e
 },

5329 #ià
defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

5330 { 
CMD_BEACON_RECV
, 
¦si_fÜw¬d_b—cÚ
 },

5332 { 
CMD_SETAPP2PWPSIE
, 
¦si_£t_­_p2p_wps_›
 },

5333 { 
CMD_P2PSETPS
, 
¦si_£t_p2p_İµs
 },

5334 { 
CMD_P2PSETNOA
, 
¦si_p2p_£t_nß_·¿ms
 },

5335 { 
CMD_P2PECSA
, 
¦si_p2p_ec§
 },

5336 { 
CMD_P2PLOSTART
, 
¦si_p2p_lo_¡¬t
 },

5337 { 
CMD_P2PLOSTOP
, 
¦si_p2p_lo_¡İ
 },

5338 { 
CMD_SET_TX_POWER_CALLING
, 
¦si_£t_tx_pow”_ÿÎšg
 },

5339 { 
CMD_SET_TX_POWER_SAR
, 
¦si_£t_tx_pow”_§r
 },

5340 { 
CMD_GET_TX_POWER_SAR
, 
¦si_g‘_tx_pow”_§r
 },

5341 { 
CMD_SET_TX_POWER_SUB6_BAND
, 
¦si_£t_tx_pow”_sub6_bªd
 },

5342 { 
CMD_POWER_MEASUREMENT_START
, 
¦si_¡¬t_pow”_m—su»m’t_d‘eùiÚ
 },

5343 { 
CMD_GETREGULATORY
, 
¦si_g‘_»guÏtÜy
 },

5344 #ifdeà
CONFIG_SCSC_WLAN_HANG_TEST


5345 { 
CMD_TESTFORCEHANG
, 
¦si_ioùl_‹¡_fÜû_hªg
 },

5347 { 
CMD_SET_FCC_CHANNEL
, 
¦si_£t_fcc_chªÃl
 },

5348 { 
CMD_FAKEMAC
, 
¦si_çke_mac_wr™e
 },

5349 { 
CMD_GETBSSRSSI
, 
¦si_g‘_bss_rssi
 },

5350 { 
CMD_GETBSSINFO
, 
¦si_g‘_bss_šfo
 },

5351 { 
CMD_GETSTAINFO
, 
¦si_g‘_¡a_šfo
 },

5352 { 
CMD_GETASSOCREJECTINFO
, 
¦si_g‘_assoc_»jeù_šfo
 },

5353 #ifdeà
CONFIG_SCSC_WLAN_LOW_LATENCY_MODE


5354 { 
CMD_SET_LATENCY_MODE
, 
¦si_ioùl_£t_Ï‹ncy_mode
 },

5355 { 
CMD_SET_POWER_MGMT
, 
¦si_£t_pow”_mode
 },

5357 { 
CMD_SET_LATENCY_CRT_DATA
, 
¦si_ioùl_£t_Ï‹ncy_üt_d©a
 },

5358 { 
CMD_SET_DISCONNECT_IES
, 
¦si_£t_discÚÃù_›s
 },

5359 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


5360 { 
CMD_SET_ENHANCED_ARP_TARGET
, 
¦si_’hªûd_¬p_¡¬t_¡İ
 },

5361 { 
CMD_GET_ENHANCED_ARP_COUNTS
, 
¦si_’hªûd_¬p_g‘_¡©s
 },

5363 { 
CMD_RXFILTERSTART
, 
¦si_ioùl_cmd_sucûss
 },

5364 { 
CMD_RXFILTERSTOP
, 
¦si_ioùl_cmd_sucûss
 },

5365 { 
CMD_BTCOEXMODE
, 
¦si_ioùl_cmd_sucûss
 },

5366 { 
CMD_BTCOEXSCAN_START
, 
¦si_ioùl_cmd_sucûss
 },

5367 { 
CMD_BTCOEXSCAN_STOP
, 
¦si_ioùl_cmd_sucûss
 },

5368 { 
CMD_MIRACAST
, 
¦si_ioùl_cmd_sucûss
 },

5369 #iâdeà
SLSI_TEST_DEV


5370 { 
CMD_DRIVERDEBUGDUMP
, 
¦si_ioùl_driv”_bug_dump
 },

5371 { 
CMD_DRIVERDEBUGCOMMAND
, 
¦si_ioùl_driv”_bug_dump
 },

5373 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


5374 { 
CMD_ENHANCED_PKT_FILTER
, 
¦si_£t_’hªûd_pkt_f‹r
 },

5376 #ifdeà
CONFIG_SCSC_WLAN_NUM_ANTENNAS


5377 { 
CMD_SET_NUM_ANTENNAS
, 
¦si_ioùl_£t_num_ª‹Âas
 },

5378 { 
CMD_GET_NUM_ANTENNAS
, 
¦si_ioùl_g‘_num_ª‹Âas
 },

5380 #ifdeà
CONFIG_SCSC_WLAN_MAX_LINK_SPEED


5381 { 
CMD_GET_MAX_LINK_SPEED
, 
¦si_g‘_lšk¥“d
 },

5384 #ifdeà
CONFIG_SCSC_WLAN_DYNAMIC_ITO


5385 { 
CMD_SET_ITO
, 
¦si_£t_™o
 },

5386 { 
CMD_ENABLE_ITO
, 
¦si_’abË_™o
 },

5388 { 
CMD_GET_CU
, 
¦si_g‘_cu
 },

5389 { 
CMD_ELNA_BYPASS_INT
, 
¦si_–Ç_by·ss_št
 },

5390 { 
CMD_ELNA_BYPASS
, 
¦si_–Ç_by·ss
 },

5391 { 
CMD_SET_DWELL_TIME
, 
¦si_£t_dw–l_time
 },

5392 { 
CMD_SET_DTIM_IN_SUSPEND
, 
¦si_£t_dtim_su¥’d
 },

5393 { 
CMD_MAX_DTIM_IN_SUSPEND
, 
¦si_max_dtim_su¥’d
 },

5394 { 
CMD_FORCE_ROAMING_BSSID
, 
¦si_fÜû_rßmšg_bssid
 },

5395 { 
CMD_ROAMING_BLACKLIST_ADD
, 
¦si_rßmšg_bÏckli¡_add
 },

5396 { 
CMD_ROAMING_BLACKLIST_REMOVE
, 
¦si_rßmšg_bÏckli¡_»move
 }

5399 
	$¦si_ioùl_â_lookup
(*
commªd
, 
Ën
)

5401 
i
 = 0;

5402 cÚ¡ 
¦si_ioùl_â
 *
p
 = 
NULL
;

5404 
i
 = 0; i < 
	`ARRAY_SIZE
(
¦si_ioùl_â_bË
); i++) {

5405 
p
 = &
¦si_ioùl_â_bË
[
i
];

5406 ià(
p
->
Çme
) {

5407 ià(
	`¡¾’
(
p
->
Çme
è< 
Ën
) {

5408 ià(!
	`¡ºÿ£cmp
(
commªd
, 
p
->
Çme
, 
Ën
))

5409  
i
;

5411 ià(!
	`¡ºÿ£cmp
(
commªd
, 
p
->
Çme
, 
	`¡¾’
(p->name)))

5412  
i
;

5417 
	}
}

5419 
	$¦si_do_ioùl
(
Ãt_deviû
 *
dev
, *
commªd
, 
cmd_Ën
)

5421 
»t
 = 0;

5422 
šdex
;

5423 
Ën
 = 0;

5424 *
pos
 = 
commªd
;

5426 
pos
 = 
	`¡rchr
(pos, ' ');

5427 ià(!
pos
) {

5428 
pos
 = 
commªd
;

5429 
pos
 = 
	`¡rchr
(pos, '\0');

5430 ià(!
pos
)

5431  -
ENOTSUPP
;

5434 
Ën
 = 
pos
 - 
commªd
;

5435 
šdex
 = 
	`¦si_ioùl_â_lookup
(
commªd
, 
Ën
);

5437 ià(
šdex
 < 0)

5438  -
ENOTSUPP
;

5440 ià(
¦si_ioùl_â_bË
[
šdex
].
â
)

5441 
»t
 = 
¦si_ioùl_â_bË
[
šdex
].
	`â
(
dev
, 
commªd
, 
cmd_Ën
);

5443 
»t
 = -
ENOTSUPP
;

5445  
»t
;

5446 
	}
}

5448 
	$¦si_ioùl
(
Ãt_deviû
 *
dev
, 
iäeq
 *
rq
, 
cmd
)

5450 
	#MAX_LEN_PRIV_COMMAND
 4096

	)

5451 
ªdroid_wifi_´iv_cmd
 
´iv_cmd
;

5452 
»t
 = 0;

5453 
u8
 *
commªd
 = 
NULL
;

5455 ià(!
dev
) {

5456 
»t
 = -
ENODEV
;

5457 
ex™
;

5460 ià(!
rq
->
iä_d©a
) {

5461 
»t
 = -
EINVAL
;

5462 
ex™
;

5464 ià(
	`cİy_äom_u£r
((*)&
´iv_cmd
, (*)
rq
->
iä_d©a
, (
ªdroid_wifi_´iv_cmd
))) {

5465 
»t
 = -
EFAULT
;

5466 
	`SLSI_NET_ERR
(
dev
, "ifr data failed\n");

5467 
ex™
;

5470 ià(
´iv_cmd
.
tÙ®_Ën
 > 
MAX_LEN_PRIV_COMMAND
 ||…riv_cmd.total_len < 0) {

5471 
»t
 = -
EINVAL
;

5472 
	`SLSI_NET_ERR
(
dev
, "L’gth mism©chÙ®_ËÀğ%d\n", 
´iv_cmd
.
tÙ®_Ën
);

5473 
ex™
;

5475 
commªd
 = 
	`km®loc
((
´iv_cmd
.
tÙ®_Ën
 + 1), 
GFP_KERNEL
);

5476 ià(!
commªd
) {

5477 
»t
 = -
ENOMEM
;

5478 
	`SLSI_NET_ERR
(
dev
, "No memory\n");

5479 
ex™
;

5481 ià(
	`cİy_äom_u£r
(
commªd
, 
´iv_cmd
.
buf
,…riv_cmd.
tÙ®_Ën
)) {

5482 
»t
 = -
EFAULT
;

5483 
	`SLSI_NET_ERR
(
dev
, "Buffer copy fail\n");

5484 
ex™
;

5486 
commªd
[
´iv_cmd
.
tÙ®_Ën
] = '\0';

5488 ià(
	`¡ºÿ£cmp
(
commªd
, 
CMD_SET_PMK
, 
	`¡¾’
(CMD_SET_PMK)) == 0)

5489 
	`SLSI_INFO_NODEV
("command: SET_PMK\n");

5491 
	`SLSI_INFO_NODEV
("commªd: %.*s\n", 
´iv_cmd
.
tÙ®_Ën
, 
commªd
);

5493 
»t
 = 
	`¦si_do_ioùl
(
dev
, 
commªd
, 
´iv_cmd
.
tÙ®_Ën
);

5495 ià(
	`¡ºÿ£cmp
(
commªd
, 
CMD_SETROAMBAND
, 
	`¡¾’
(CMD_SETROAMBAND)è!ğ0 && sŒnÿ£cmp(commªd, 
CMD_FACTORY_SETBAND
, sŒËn(CMD_FACTORY_SETBAND)è!ğ0 && sŒnÿ£cmp(commªd, 
CMD_SETBAND
, sŒËn(CMD_SETBAND)è!ğ0 && 
	`cİy_to_u£r
(
´iv_cmd
.
buf
, commªd,…riv_cmd.
tÙ®_Ën
)) {

5496 
»t
 = -
EFAULT
;

5497 
	`SLSI_NET_ERR
(
dev
, "Buffer copy fail\n");

5500 
ex™
:

5501 
	`kä“
(
commªd
);

5502  
»t
;

5503 
	}
}

	@ioctl.h

7 #iâdeà
__MX_IOCTL_H__


8 
	#__MX_IOCTL_H__


	)

10 
	~<lšux/if.h
>

11 
	~<lšux/Ãtdeviû.h
>

13 
	sªdroid_wifi_´iv_cmd
 {

14 *
	mbuf
;

15 
	mu£d_Ën
;

16 
	mtÙ®_Ën
;

19 
¦si_ioùl
(
Ãt_deviû
 *
dev
, 
iäeq
 *
rq
, 
cmd
);

20 
¦si_g‘_¡a_šfo
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
);

21 
¦si_ioùl_¬gs
 *
¦si_g‘_´iv©e_commªd_¬gs
(*
bufãr
, 
buf_Ën
, 
max_¬g_couÁ
);

22 
	#SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
) \

24 ià(!
ioùl_¬gs
) { \

25 
	`SLSI_ERR
(
sdev
, "Malloc of ioctl_args failed.\n"); \

26  -
ENOMEM
; \

29 ià(!
ioùl_¬gs
->
¬g_couÁ
) { \

30 
	`kä“
(
ioùl_¬gs
); \

31  -
EINVAL
; \

33 } 0)

	)

35 
	s¦si_suµÜ‹d_chªÃls
 {

36 
	m¡¬t_chª_num
;

37 
	mchªÃl_couÁ
;

38 
	mšüem’t
;

39 
	mbªd
;

	@kic.c

7 
	~<scsc/kic/¦si_kic_wifi.h
>

8 
	~"dev.h
"

9 
	~"debug.h
"

10 
	~"mxmª.h
"

12 
	$wifi_kic_Œigg”_»cov”y
(*
´iv
, 
¦si_kic_‹¡_»cov”y_ty³
 
ty³
)

14 
¦si_dev
 *
sdev
 = (¦si_dev *)
´iv
;

15 
»asÚ
[80];

17 ià(!
sdev
)

18  -
EINVAL
;

20 ià(
sdev
->
deviû_¡©e
 !ğ
SLSI_DEVICE_STATE_STARTED
)

21  -
EAGAIN
;

23 
ty³
) {

24 
¦si_kic_‹¡_»cov”y_ty³_subsy¡em_·nic
:

25 
	`SLSI_INFO
(
sdev
, "Trigger Wi-Fi firmware subsystem…anic\n");

26 ià(
	`scsc_£rviû_fÜû_·nic
(
sdev
->
£rviû
))

27  -
EINVAL
;

29 
¦si_kic_‹¡_»cov”y_ty³_emuÏ‹_fœmw¬e_no_»¥Ú£
:

30 
	`SLSI_INFO
(
sdev
, "Trigger Wi-Fi host…anic\n");

31 
	`¢´štf
(
»asÚ
, (reason), "slsi_kic_test_recovery_type_emulate_firmware_no_response");

32 
	`¦si_sm_£rviû_çed
(
sdev
, 
»asÚ
, 
çl£
);

34 
¦si_kic_‹¡_»cov”y_ty³_w©ch_dog
:

35 
¦si_kic_‹¡_»cov”y_ty³_ch_üash
:

37  -
EINVAL
;

39 
	}
}

41 
¦si_kic_wifi_İs
 
	gkic_İs
 = {

42 .
Œigg”_»cov”y
 = 
wifi_kic_Œigg”_»cov”y
,

45 
	$wifi_kic_»gi¡”
(
¦si_dev
 *
sdev
)

47  
	`¦si_kic_wifi_İs_»gi¡”
((*)
sdev
, &
kic_İs
);

48 
	}
}

50 
	$wifi_kic_uÄegi¡”
()

52  
	`¦si_kic_wifi_İs_uÄegi¡”
(&
kic_İs
);

53 
	}
}

	@kic.h

7 #iâdeà
__KIC_H


8 
	#__KIC_H


	)

10 
wifi_kic_»gi¡”
(
¦si_dev
 *
sdev
);

11 
wifi_kic_uÄegi¡”
();

	@log_clients.c

7 
	~"dev.h
"

8 
	~"debug.h
"

9 
	~"udi.h
"

10 
	~"log_ş›Ás.h
"

11 
	~"unifiio.h
"

19 
	$¦si_log_ş›Ás_log_sigÇl_§ã
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
, 
u32
 
dœeùiÚ
)

21 
li¡_h—d
 *
pos
, *
n
;

22 
¦si_log_ş›Á
 *
log_ş›Á
;

23 
dœ
 = (
dœeùiÚ
 =ğ
SLSI_LOG_DIRECTION_FROM_HOST
è? 
UDI_FROM_HOST
 : 
UDI_TO_HOST
;

25 
	`¥š_lock_bh
(&
sdev
->
log_ş›Ás
.
log_ş›Á_¥šlock
);

26 
	`li¡_fÜ_—ch_§ã
(
pos
, 
n
, &
sdev
->
log_ş›Ás
.
log_ş›Á_li¡
) {

27 
log_ş›Á
 = 
	`li¡_’Œy
(
pos
, 
¦si_log_ş›Á
, 
q
);

28 
log_ş›Á
->
	`log_ş›Á_cb
Öog_ş›Á, 
skb
, 
dœ
);

30 
	`¥š_uÆock_bh
(&
sdev
->
log_ş›Ás
.
log_ş›Á_¥šlock
);

31 
	}
}

33 
	$¦si_log_ş›Ás_š™
(
¦si_dev
 *
sdev
)

35 
	`INIT_LIST_HEAD
(&
sdev
->
log_ş›Ás
.
log_ş›Á_li¡
);

36 
	`¥š_lock_š™
(&
sdev
->
log_ş›Ás
.
log_ş›Á_¥šlock
);

37 
	}
}

42 
	$¦si_log_ş›Á_»gi¡”
(
¦si_dev
 *
sdev
, *
log_ş›Á_ùx
,

43 (*
log_ş›Á_cb
)(
¦si_log_ş›Á
 *, 
sk_buff
 *, ),

44 *
f‹r
, 
mš_sigÇl_id
, 
max_sigÇl_id
)

46 
¦si_log_ş›Á
 *
log_ş›Á
;

47 
fœ¡_š_li¡
 = 0;

49 
fœ¡_š_li¡
 = 
	`li¡_em±y
(&
sdev
->
log_ş›Ás
.
log_ş›Á_li¡
);

50 
log_ş›Á
 = 
	`km®loc
((*log_ş›Á), 
GFP_KERNEL
);

51 ià(
log_ş›Á
 =ğ
NULL
)

52  -
ENOMEM
;

54 
log_ş›Á
->
mš_sigÇl_id
 = min_signal_id;

55 
log_ş›Á
->
max_sigÇl_id
 = max_signal_id;

56 
log_ş›Á
->
sigÇl_f‹r
 = 
f‹r
;

57 
log_ş›Á
->
log_ş›Á_ùx
 =†og_client_ctx;

58 
log_ş›Á
->
log_ş›Á_cb
 =†og_client_cb;

61 
	`¥š_lock_bh
(&
sdev
->
log_ş›Ás
.
log_ş›Á_¥šlock
);

62 
	`li¡_add_
(&
log_ş›Á
->
q
, &
sdev
->
log_ş›Ás
.
log_ş›Á_li¡
);

63 
	`¥š_uÆock_bh
(&
sdev
->
log_ş›Ás
.
log_ş›Á_¥šlock
);

66 
	}
}

68 
	$¦si_log_ş›Ás_‹rmš©e
(
¦si_dev
 *
sdev
)

73 ià(*
sdev
->
‹rm_udi_u£rs
) {

74 
num_pŞls_Ëá
 = 50;

75 
timeout_ms
 = 4;

77 
	`¦si_log_ş›Á_msg
(
sdev
, 
UDI_DRV_UNLOAD_IND
, 0, 
NULL
);

80 
	`¦si_check_cdev_»fs
(è&& 
num_pŞls_Ëá
) {

81 
	`m¦“p
(
timeout_ms
);

82 
num_pŞls_Ëá
--;

85 
	}
}

87 
	$¦si_log_ş›Á_msg
(
¦si_dev
 *
sdev
, 
u16
 
ev’t
, 
u32
 
ev’t_d©a_Ëngth
, cÚ¡ 
u8
 *
ev’t_d©a
)

89 
li¡_h—d
 *
pos
, *
n
;

90 
¦si_log_ş›Á
 *
log_ş›Á
;

92 
	`¥š_lock_bh
(&
sdev
->
log_ş›Ás
.
log_ş›Á_¥šlock
);

93 
	`li¡_fÜ_—ch_§ã
(
pos
, 
n
, &
sdev
->
log_ş›Ás
.
log_ş›Á_li¡
) {

94 
log_ş›Á
 = 
	`li¡_’Œy
(
pos
, 
¦si_log_ş›Á
, 
q
);

95 
	`¥š_uÆock_bh
(&
sdev
->
log_ş›Ás
.
log_ş›Á_¥šlock
);

96 ià(
	`¦si_k”Ãl_to_u£r_¥aû_ev’t
(
log_ş›Á
, 
ev’t
, 
ev’t_d©a_Ëngth
, 
ev’t_d©a
))

97 
	`SLSI_WARN
(
sdev
, "FaedØ£ndƒv’t(0x%.4XètØUDI cl›Á 0x%p\n", 
ev’t
, 
log_ş›Á
);

98 
	`¥š_lock_bh
(&
sdev
->
log_ş›Ás
.
log_ş›Á_¥šlock
);

100 
	`¥š_uÆock_bh
(&
sdev
->
log_ş›Ás
.
log_ş›Á_¥šlock
);

101 
	}
}

103 
	$¦si_log_ş›Á_uÄegi¡”
(
¦si_dev
 *
sdev
, *
log_ş›Á_ùx
)

105 
li¡_h—d
 *
pos
, *
n
;

106 
¦si_log_ş›Á
 *
log_ş›Á
;

108 
	`¥š_lock_bh
(&
sdev
->
log_ş›Ás
.
log_ş›Á_¥šlock
);

109 
	`li¡_fÜ_—ch_§ã
(
pos
, 
n
, &
sdev
->
log_ş›Ás
.
log_ş›Á_li¡
) {

110 
log_ş›Á
 = 
	`li¡_’Œy
(
pos
, 
¦si_log_ş›Á
, 
q
);

111 ià(
log_ş›Á
->
log_ş›Á_ùx
 ==†og_client_ctx) {

112 
	`kä“
(
log_ş›Á
->
sigÇl_f‹r
);

113 
	`li¡_d–
(
pos
);

114 
	`kä“
(
log_ş›Á
);

117 
	`¥š_uÆock_bh
(&
sdev
->
log_ş›Ás
.
log_ş›Á_¥šlock
);

118 
	}
}

	@log_clients.h

7 #iâdeà
__SLSI_LOG_CLIENTS_H__


8 
	#__SLSI_LOG_CLIENTS_H__


	)

10 
	~<lšux/ty³s.h
>

12 
	g¦si_dev
;

14 
	s¦si_log_ş›Á
 {

15 
li¡_h—d
 
	mq
;

16 *
	mlog_ş›Á_ùx
;

17 (*
	mlog_ş›Á_cb
)(
	m¦si_log_ş›Á
 *, 
	msk_buff
 *, );

18 
	mmš_sigÇl_id
;

19 
	mmax_sigÇl_id
;

20 *
	msigÇl_f‹r
;

23 
	s¦si_log_ş›Ás
 {

25 
¥šlock_t
 
	mlog_ş›Á_¥šlock
;

26 
li¡_h—d
 
	mlog_ş›Á_li¡
;

29 
	#SLSI_LOG_DIRECTION_FROM_HOST
 0

	)

30 
	#SLSI_LOG_DIRECTION_TO_HOST
 1

	)

32 
¦si_log_ş›Ás_š™
(
¦si_dev
 *
sdev
);

33 
¦si_log_ş›Á_»gi¡”
(
¦si_dev
 *
sdev
, *
log_ş›Á_ùx
,

34 (*
log_ş›Á_cb
)(
¦si_log_ş›Á
 *, 
sk_buff
 *, ),

35 *
f‹r
, 
mš_sigÇl_id
, 
max_sigÇl_id
);

37 
	`¦si_log_ş›Á_uÄegi¡”
(
¦si_dev
 *
sdev
, *
log_ş›Á_ùx
);

38 
	`¦si_log_ş›Á_msg
(
¦si_dev
 *
sdev
, 
u16
 
ev’t
, 
u32
 
ev’t_d©a_Ëngth
, cÚ¡ 
u8
 *
ev’t_d©a
);

39 
	`¦si_log_ş›Ás_log_sigÇl_§ã
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
, 
u32
 
dœeùiÚ
);

40 
šlše
 
	$¦si_log_ş›Ás_log_sigÇl_ç¡
(
¦si_dev
 *
sdev
, 
¦si_log_ş›Ás
 *
log_ş›Ás
, 
sk_buff
 *
skb
, 
u32
 
dœeùiÚ
)

45 ià(!
	`li¡_em±y
(&
log_ş›Ás
->
log_ş›Á_li¡
))

46 
	`¦si_log_ş›Ás_log_sigÇl_§ã
(
sdev
, 
skb
, 
dœeùiÚ
);

47 
	}
}

49 
¦si_log_ş›Ás_‹rmš©e
(
¦si_dev
 *
sdev
);

	@mbulk.c

6 
	~<lšux/¡ršg.h
>

7 
	~<lšux/¥šlock.h
>

8 
	~"mbulk.h
"

9 
	~"h4_§m¶”.h
"

11 
	~"debug.h
"

16 
	#MBULK_ALIGN
 (64)

	)

17 
	#MBULK_IS_ALIGNED
(
s
è(((
ušŒ_t
)(sè& (
MBULK_ALIGN
 - 1)è=ğ0)

	)

18 
	#MBULK_SZ_ROUNDUP
(
s
è
	`round_up
(s, 
MBULK_ALIGN
)

	)

23 
	#MBULK_DAT_BUFSZ_REQ_BEST_MAGIC
 ((
u32
)(-2))

	)

25 
DEFINE_SPINLOCK
(
mbulk_poŞ_lock
);

27 
šlše
 
	$mbulk_debug
(
mbulk
 *
m
)

29 ()
m
;

30 
	`SLSI_DBG1_NODEV
(
SLSI_MBULK
, "m->Ãxt_off£ˆ%p: %d\n", &
m
->
Ãxt_off£t
, m->next_offset);

31 
	`SLSI_DBG1_NODEV
(
SLSI_MBULK
, "m->æag %p: %d\n", &
m
->
æag
, m->flag);

32 
	`SLSI_DBG1_NODEV
(
SLSI_MBULK
, "m->şa %p: %d\n", &
m
->
şas
, m->clas);

33 
	`SLSI_DBG1_NODEV
(
SLSI_MBULK
, "m->pid %p: %d\n", &
m
->
pid
, m->pid);

34 
	`SLSI_DBG1_NODEV
(
SLSI_MBULK
, "m->»fúˆ%p: %d\n", &
m
->
»fút
, m->refcnt);

35 
	`SLSI_DBG1_NODEV
(
SLSI_MBULK
, "m->d©_bufsz %p: %d\n", &
m
->
d©_bufsz
, m->dat_bufsz);

36 
	`SLSI_DBG1_NODEV
(
SLSI_MBULK
, "m->sig_bufsz %p: %d\n", &
m
->
sig_bufsz
, m->sig_bufsz);

37 
	`SLSI_DBG1_NODEV
(
SLSI_MBULK
, "m->ËÀ%p: %d\n", &
m
->
Ën
, m->len);

38 
	`SLSI_DBG1_NODEV
(
SLSI_MBULK
, "m->h—d %p: %d\n", &
m
->
h—d
, m->head);

39 
	`SLSI_DBG1_NODEV
(
SLSI_MBULK
, "m->chaš_Ãxt_off£ˆ%p: %d\n", &
m
->
chaš_Ãxt_off£t
, m->chain_next_offset);

40 
	}
}

43 
	smbulk_Œack”
 {

44 
mbulk_cŞour
 
	mcŞour
;

48 
	smbulk_poŞ
 {

49 
boŞ
 
	mv®id
;

50 
u8
 
	mpid
;

51 
mbulk
 *
	mä“_li¡
;

52 
	mä“_út
;

53 
	mu§ge
[
MBULK_CLASS_MAX
];

54 *
	mba£_addr
;

55 *
	m’d_addr
;

56 
mbulk_Ën_t
 
	m£g_size
;

57 
u8
 
	mgu¬d
;

58 
	mtÙ_£g_num
;

59 
mbulk_Œack”
 *
	mmbulk_Œack”
;

60 
	mshiá
;

61 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


62 
	mmšÜ
;

67 
šlše
 
mbulk
 *
	$mbulk_poŞ_g‘
(
mbulk_poŞ
 *
poŞ
, 
mbulk_şass
 
şas
)

69 
mbulk
 *
m
;

70 
u8
 
gu¬d
 = 
poŞ
->guard;

72 
	`¥š_lock_bh
(&
mbulk_poŞ_lock
);

73 
m
 = 
poŞ
->
ä“_li¡
;

75 ià(
m
 =ğ
NULL
 || 
poŞ
->
ä“_út
 <ğ
gu¬d
) {

76 
	`¥š_uÆock_bh
(&
mbulk_poŞ_lock
);

77  
NULL
;

80 
poŞ
->
ä“_út
--;

81 
poŞ
->
u§ge
[
şas
]++;

83 
	`SCSC_HIP4_SAMPLER_MBULK
(
poŞ
->
mšÜ
, (poŞ->
ä“_út
 & 0x100è>> 8, (poŞ->ä“_úˆ& 0xff),…oŞ->
pid
);

85 ià(
m
->
Ãxt_off£t
 == 0)

86 
poŞ
->
ä“_li¡
 = 
NULL
;

88 
poŞ
->
ä“_li¡
 = (
mbulk
 *)((
ušŒ_t
íoŞ->ä“_li¡ + 
m
->
Ãxt_off£t
);

90 
	`mem£t
(
m
, 0, (*m));

91 
m
->
pid
 = 
poŞ
->pid;

92 
m
->
şas
 = clas;

94 
	`¥š_uÆock_bh
(&
mbulk_poŞ_lock
);

95  
m
;

96 
	}
}

99 
šlše
 
	$mbulk_poŞ_put
(
mbulk_poŞ
 *
poŞ
, 
mbulk
 *
m
)

101 ià(
m
->
æag
 =ğ
MBULK_F_FREE
)

104 
	`¥š_lock_bh
(&
mbulk_poŞ_lock
);

105 
poŞ
->
u§ge
[
m
->
şas
]--;

106 
poŞ
->
ä“_út
++;

108 
	`SCSC_HIP4_SAMPLER_MBULK
(
poŞ
->
mšÜ
, (poŞ->
ä“_út
 & 0x100è>> 8, (poŞ->ä“_úˆ& 0xff),…oŞ->
pid
);

109 
m
->
æag
 = 
MBULK_F_FREE
;

110 ià(
poŞ
->
ä“_li¡
 !ğ
NULL
)

111 
m
->
Ãxt_off£t
 = (
ušŒ_t
)
poŞ
->
ä“_li¡
 - (uintptr_t)m;

113 
m
->
Ãxt_off£t
 = 0;

114 
poŞ
->
ä“_li¡
 = 
m
;

115 
	`¥š_uÆock_bh
(&
mbulk_poŞ_lock
);

116 
	}
}

119 
	smbulk_poŞ_cÚfig
 {

120 
mbulk_Ën_t
 
	m£g_sz
;

121 
	m£g_num
;

125 
mbulk_poŞ
 
	gmbulk_poŞs
[
MBULK_POOL_ID_MAX
];

136 
mbulk
 *
	$mbulk_£g_g’”ic_®loc
(
mbulk_poŞ
 *
poŞ
,

137 
mbulk_şass
 
şas
, 
size_t
 
sig_bufsz
, size_ˆ
d©_bufsz
)

139 
mbulk
 *
m
;

141 ià(
poŞ
 =ğ
NULL
)

142  
NULL
;

145 
m
 = 
	`mbulk_poŞ_g‘
(
poŞ
, 
şas
);

146 ià(
m
 =ğ
NULL
)

147  
NULL
;

150 
m
->
sig_bufsz
 = (
mbulk_Ën_t
)sig_bufsz;

151 ià(
sig_bufsz
)

152 
m
->
æag
 = 
MBULK_F_SIG
;

157 
m
->
h—d
 = m->
sig_bufsz
;

158 ià(
d©_bufsz
 == 0) {

159 
m
->
d©_bufsz
 = 0;

160 
m
->
»fút
 = 0;

161 } ià(
d©_bufsz
 =ğ
MBULK_DAT_BUFSZ_REQ_BEST_MAGIC
) {

162 
m
->
d©_bufsz
 = 
poŞ
->
£g_size
 - m->
sig_bufsz
;

163 
m
->
»fút
 = 1;

165 
m
->
d©_bufsz
 = (
mbulk_Ën_t
)dat_bufsz;

166 
m
->
»fút
 = 1;

169 
	`mbulk_debug
(
m
);

170  
m
;

171 
	}
}

173 
	$mbulk_poŞ_g‘_ä“_couÁ
(
u8
 
poŞ_id
)

175 
mbulk_poŞ
 *
poŞ
;

176 
num_ä“
;

178 ià(
poŞ_id
 >ğ
MBULK_POOL_ID_MAX
) {

179 
	`WARN_ON
(
poŞ_id
 >ğ
MBULK_POOL_ID_MAX
);

180  -
EIO
;

183 
	`¥š_lock_bh
(&
mbulk_poŞ_lock
);

184 
poŞ
 = &
mbulk_poŞs
[
poŞ_id
];

186 ià(!
poŞ
->
v®id
) {

187 
	`WARN_ON
(!
poŞ
->
v®id
);

188 
	`¥š_uÆock_bh
(&
mbulk_poŞ_lock
);

189  -
EIO
;

192 
num_ä“
 = 
poŞ
->
ä“_út
;

193 
	`¥š_uÆock_bh
(&
mbulk_poŞ_lock
);

195  
num_ä“
;

196 
	}
}

205 
mbulk
 *
	$mbulk_w™h_sigÇl_®loc_by_poŞ
(
u8
 
poŞ_id
, 
mbulk_cŞour
 
cŞour
,

206 
mbulk_şass
 
şas
, 
size_t
 
sig_bufsz_»q
, size_ˆ
d©_bufsz
)

208 
mbulk_poŞ
 *
poŞ
;

209 
size_t
 
sig_bufsz
;

210 
size_t
 
tÙ_bufsz
;

211 
mbulk
 *
m_»t
;

212 
u32
 
šdex
;

215 
sig_bufsz
 = 
	`MBULK_SIG_BUFSZ_ROUNDUP
((
mbulk
è+ 
sig_bufsz_»q
) - (mbulk);

217 ià(
poŞ_id
 >ğ
MBULK_POOL_ID_MAX
) {

218 
	`WARN_ON
(
poŞ_id
 >ğ
MBULK_POOL_ID_MAX
);

219  
NULL
;

222 
poŞ
 = &
mbulk_poŞs
[
poŞ_id
];

224 ià(!
poŞ
->
v®id
) {

225 
	`WARN_ON
(!
poŞ
->
v®id
);

226  
NULL
;

230 
tÙ_bufsz
 = 
sig_bufsz
 + 
d©_bufsz
;

231 ià(
d©_bufsz
 !ğ
MBULK_DAT_BUFSZ_REQ_BEST_MAGIC
 &&

232 
poŞ
->
£g_size
 < 
tÙ_bufsz
)

233  
NULL
;

235 
m_»t
 = 
	`mbulk_£g_g’”ic_®loc
(
poŞ
, 
şas
, 
sig_bufsz
, 
d©_bufsz
);

237 
šdex
 = (((
ušŒ_t
)
poŞ
->
’d_addr
 - (ušŒ_t)
m_»t
è>>…oŞ->
shiá
) - 1;

238 ià(
šdex
 >ğ
poŞ
->
tÙ_£g_num
)

239  
NULL
;

241 
poŞ
->
mbulk_Œack”
[
šdex
].
cŞour
 = colour;

243  
m_»t
;

244 
	}
}

246 
mbulk_cŞour
 
	$mbulk_g‘_cŞour
(
u8
 
poŞ_id
, 
mbulk
 *
m
)

248 
mbulk_poŞ
 *
poŞ
;

249 
u16
 
šdex
;

251 
poŞ
 = &
mbulk_poŞs
[
poŞ_id
];

253 ià(!
poŞ
->
v®id
) {

254 
	`WARN_ON
(1);

258 
šdex
 = (((
ušŒ_t
)
poŞ
->
’d_addr
 - (ušŒ_t)
m
è>>…oŞ->
shiá
) - 1;

259 ià(
šdex
 >ğ
poŞ
->
tÙ_£g_num
)

262  
poŞ
->
mbulk_Œack”
[
šdex
].
cŞour
;

263 
	}
}

265 #ifdeà
MBULK_SUPPORT_SG_CHAIN


270 
mbulk
 *
	$mbulk_chaš_w™h_sigÇl_®loc_by_poŞ
(
u8
 
poŞ_id
,

271 
mbulk_şass
 
şas
, 
size_t
 
sig_bufsz
, size_ˆ
d©_bufsz
)

273 
size_t
 
tÙ_Ën
;

274 
mbulk
 *
m
, *
h—d
, *
´e
;

276 
h—d
 = 
	`mbulk_w™h_sigÇl_®loc_by_poŞ
(
poŞ_id
, 
şas
, 
sig_bufsz
,

277 
MBULK_DAT_BUFSZ_REQ_BEST_MAGIC
);

278 ià(
h—d
 =ğ
NULL
 || 
	`MBULK_SEG_TAILROOM
(h—dè>ğ
d©_bufsz
)

279  
h—d
;

281 
h—d
->
æag
 |ğ(
MBULK_F_CHAIN_HEAD
 | 
MBULK_F_CHAIN
);

282 
tÙ_Ën
 = 
	`MBULK_SEG_TAILROOM
(
h—d
);

283 
´e
 = 
h—d
;

285 
tÙ_Ën
 < 
d©_bufsz
) {

286 
m
 = 
	`mbulk_w™h_sigÇl_®loc_by_poŞ
(
poŞ_id
, 
şas
, 0,

287 
MBULK_DAT_BUFSZ_REQ_BEST_MAGIC
);

288 ià(
m
 =ğ
NULL
)

291 
m
->
æag
 |ğ
MBULK_F_CHAIN
;

292 
tÙ_Ën
 +ğ
	`MBULK_SEG_TAILROOM
(
m
);

293 
´e
->
chaš_Ãxt
 = 
m
;

294 
´e
 = 
m
;

297 ià(
tÙ_Ën
 < 
d©_bufsz
) {

298 
	`mbulk_chaš_ä“
(
h—d
);

299  
NULL
;

302  
h—d
;

303 
	}
}

308 
	$mbulk_chaš_ä“
(
mbulk
 *
sg
)

310 
mbulk
 *
chaš_Ãxt
, *
m
;

313 ià(
sg
 =ğ
NULL
)

316 
m
 = 
sg
;

317 
m
 !ğ
NULL
) {

318 
chaš_Ãxt
 = 
m
->chain_next;

321 
m
->
æag
 &ğ~(
MBULK_F_CHAIN
 | 
MBULK_F_CHAIN_HEAD
);

322 
	`mbulk_£g_ä“
(
m
);

324 
m
 = 
chaš_Ãxt
;

326 
	}
}

332 
mbulk
 *
	$mbulk_chaš_
(
mbulk
 *
m
)

334 
m
->
chaš_Ãxt
 !ğ
NULL
)

335 
m
 = m->
chaš_Ãxt
;

336  
m
;

337 
	}
}

343 
size_t
 
	$mbulk_chaš_bufsz
(
mbulk
 *
m
)

345 
size_t
 
tbufsz
 = 0;

347 
m
 !ğ
NULL
) {

348 
tbufsz
 +ğ
m
->
d©_bufsz
;

349 
m
 = m->
chaš_Ãxt
;

352  
tbufsz
;

353 
	}
}

359 
size_t
 
	$mbulk_chaš_’
(
mbulk
 *
m
)

361 
size_t
 
’
 = 0;

363 
m
 !ğ
NULL
) {

364 
’
 +ğ
m
->
Ën
;

365 
m
 = m->
chaš_Ãxt
;

368  
’
;

369 
	}
}

376 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


377 
	$mbulk_poŞ_add
(
u8
 
poŞ_id
, *
ba£
, *
’d
, 
size_t
 
£g_size
, u8 
gu¬d
, 
mšÜ
)

379 
	$mbulk_poŞ_add
(
u8
 
poŞ_id
, *
ba£
, *
’d
, 
size_t
 
£g_size
, u8 
gu¬d
)

382 
mbulk_poŞ
 *
poŞ
;

383 
mbulk
 *
Ãxt
;

384 
size_t
 
by‹_³r_block
;

386 ià(
poŞ_id
 >ğ
MBULK_POOL_ID_MAX
) {

387 
	`WARN_ON
(
poŞ_id
 >ğ
MBULK_POOL_ID_MAX
);

388  -
EIO
;

391 
poŞ
 = &
mbulk_poŞs
[
poŞ_id
];

393 ià(!
	`MBULK_IS_ALIGNED
(
ba£
)) {

394 
	`WARN_ON
(!
	`MBULK_IS_ALIGNED
(
ba£
));

395  -
EIO
;

399 
by‹_³r_block
 = 
	`MBULK_SZ_ROUNDUP
((
mbulk
è+ 
£g_size
);

401 ià(
by‹_³r_block
 == 0)

402  -
EIO
;

405 
	`mem£t
(
poŞ
, 0, (*pool));

406 
poŞ
->
pid
 = 
poŞ_id
;

407 
poŞ
->
ba£_addr
 = 
ba£
;

408 
poŞ
->
’d_addr
 = 
’d
;

409 
poŞ
->
£g_size
 = (
mbulk_Ën_t
)(
by‹_³r_block
 - (
mbulk
));

410 
poŞ
->
gu¬d
 = guard;

411 
poŞ
->
shiá
 = 
	`ffs
(
by‹_³r_block
) - 1;

414 
Ãxt
 = (
mbulk
 *)
ba£
;

415 ((
ušŒ_t
)
Ãxt
 + 
by‹_³r_block
è<ğ(ušŒ_t)
’d
) {

416 
	`mem£t
(
Ãxt
, 0, (
mbulk
));

417 
Ãxt
->
pid
 = 
poŞ_id
;

420 ià(
poŞ
->
ä“_li¡
 =ğ
NULL
)

421 
Ãxt
->
Ãxt_off£t
 = 0;

423 
Ãxt
->
Ãxt_off£t
 = (
ušŒ_t
)
poŞ
->
ä“_li¡
 - (uintptr_t)next;

424 
Ãxt
->
æag
 = 
MBULK_F_FREE
;

425 
poŞ
->
ä“_li¡
 = 
Ãxt
;

426 
poŞ
->
tÙ_£g_num
++;

427 
poŞ
->
ä“_út
++;

428 
Ãxt
 = (
mbulk
 *)((
ušŒ_t
êexˆ+ 
by‹_³r_block
);

431 
poŞ
->
v®id
 = (poŞ->
ä“_út
è? 
Œue
 : 
çl£
;

432 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


433 
poŞ
->
mšÜ
 = minor;

436 
poŞ
->
mbulk_Œack”
 = (mbulk_Œack” *)
	`vm®loc
ÕoŞ->
tÙ_£g_num
 * (mbulk_tracker));

438 ià(
poŞ
->
mbulk_Œack”
 =ğ
NULL
)

439  -
EIO
;

442 
	}
}

444 
	$mbulk_poŞ_»move
(
u8
 
poŞ_id
)

446 
mbulk_poŞ
 *
poŞ
;

448 ià(
poŞ_id
 >ğ
MBULK_POOL_ID_MAX
) {

449 
	`WARN_ON
(
poŞ_id
 >ğ
MBULK_POOL_ID_MAX
);

453 
poŞ
 = &
mbulk_poŞs
[
poŞ_id
];

456 
	`vä“
(
poŞ
->
mbulk_Œack”
);

458 
poŞ
->
mbulk_Œack”
 = 
NULL
;

459 
	}
}

464 
	$mbulk_poŞ_dump
(
u8
 
poŞ_id
, 
max_út
)

466 
mbulk_poŞ
 *
poŞ
;

467 
mbulk
 *
m
;

468 
út
 = 
max_út
;

470 
poŞ
 = &
mbulk_poŞs
[
poŞ_id
];

471 
m
 = 
poŞ
->
ä“_li¡
;

472 
m
 !ğ
NULL
 && 
út
--)

473 
m
 = (m->
Ãxt_off£t
 =ğ0è? 
NULL
 :

474 (
mbulk
 *)(
poŞ
->
ba£_addr
 + 
m
->
Ãxt_off£t
);

475 
	}
}

480 
	$mbulk_ä“_vœt_ho¡
(
mbulk
 *
m
)

482 
u8
 
poŞ_id
;

483 
mbulk_poŞ
 *
poŞ
;

485 ià(
m
 =ğ
NULL
)

488 
poŞ_id
 = 
m
->
pid
 & 0x1;

490 
poŞ
 = &
mbulk_poŞs
[
poŞ_id
];

492 ià(!
poŞ
->
v®id
) {

493 
	`WARN_ON
(!
poŞ
->
v®id
);

498 
	`mbulk_poŞ_put
(
poŞ
, 
m
);

499 
	}
}

	@mbulk.h

7 #iâdeà
__MBULK_H__


8 
	#__MBULK_H__


	)

50 
	gmbulk
;

62 
u32
 
	tmbulk_cŞour
;

64 
	#SLSI_MBULK_COLOUR_SET
(
cŞour
, 
vif
, 
³”_šdex
, 
ac_q
è(cŞou¸ğ×c_q << 16è| (³”_šdex << 8è| (vif))

	)

66 
	#SLSI_MBULK_COLOUR_GET_VIF
(
cŞour
è(cŞou¸& 0xFF)

	)

67 
	#SLSI_MBULK_COLOUR_GET_PEER_IDX
(
cŞour
è((cŞou¸>> 8è& 0xFF)

	)

68 
	#SLSI_MBULK_COLOUR_GET_AC
(
cŞour
è((cŞou¸>> 16è& 0xFF)

	)

73 
	#MBULK_POOL_ID_DATA
 (0)

	)

74 
	#MBULK_POOL_ID_CTRL
 (1)

	)

75 
	#MBULK_POOL_ID_MAX
 (2)

	)

83 
	embulk_şass
 {

84 
	mMBULK_CLASS_CONTROL
 = 0,

85 
	mMBULK_CLASS_HOSTIO
 = 1,

86 
	mMBULK_CLASS_DEBUG
 = 2,

87 
	mMBULK_CLASS_DEBUG_CRIT
 = 3,

89 
	mMBULK_CLASS_FROM_HOST_DAT
 = 4,

90 
	mMBULK_CLASS_FROM_HOST_CTL
 = 5,

91 
	mMBULK_CLASS_FROM_RADIO
 = 6,

92 
	mMBULK_CLASS_DPLP
 = 7,

93 
	mMBULK_CLASS_OTHERS
 = 8,

94 
	mMBULK_CLASS_FROM_RADIO_FORWARDED
 = 9,

95 
	mMBULK_CLASS_MAX


96 } 
	g__·cked
;

106 
	~"mbulk_def.h
"

119 
šlše
 
	$mbulk_»fút
(cÚ¡ 
mbulk
 *
m
)

121  
	`MBULK_SEG_REFCNT
(
m
);

122 
	}
}

128 
šlše
 
	$mbulk_bufãr_size
(cÚ¡ 
mbulk
 *
m
)

130  
	`MBULK_SEG_DAT_BUFSIZE
(
m
);

131 
	}
}

137 
šlše
 
boŞ
 
	$mbulk_has_sigÇl
(cÚ¡ 
mbulk
 *
m
)

139  
	`MBULK_SEG_HAS_SIGNAL
(
m
);

140 
	}
}

145 
šlše
 
	$mbulk_£t_»adÚly
(
mbulk
 *
m
)

147 
	`MBULK_SEG_SET_READONLY
(
m
);

148 
	}
}

153 
šlše
 
boŞ
 
	$mbulk_is_»adÚly
(cÚ¡ 
mbulk
 *
m
)

155  
	`MBULK_SEG_IS_READONLY
(
m
);

156 
	}
}

162 
šlše
 
boŞ
 
	$mbulk_is_sg
(cÚ¡ 
mbulk
 *
m
)

164  
	`MBULK_SEG_IS_CHAIN_HEAD
(
m
);

165 
	}
}

171 
šlše
 
boŞ
 
	$mbulk_is_chašed
(cÚ¡ 
mbulk
 *
m
)

173  
	`MBULK_SEG_IS_CHAINED
(
m
);

174 
	}
}

185 
mbulk
 *
mbulk_w™h_sigÇl_®loc
(
mbulk_şass
 
şas
, 
size_t
 
sig_bufsz
,

186 
size_t
 
d©_bufsz
);

194 
mbulk
 *
mbulk_w™h_sigÇl_®loc_by_poŞ
(
u8
 
poŞ_id
, 
mbulk_cŞour
 
cŞour
,

195 
mbulk_şass
 
şas
, 
size_t
 
sig_bufsz
, size_ˆ
d©_bufsz
);

202 
mbulk_poŞ_g‘_ä“_couÁ
(
u8
 
poŞ_id
);

212 
šlše
 *
	$mbulk_g‘_£g
(cÚ¡ 
mbulk
 *
m
)

214  (*)
	`MBULK_SEG_B
(
m
);

215 
	}
}

224 
šlše
 *
	$mbulk_g‘_sigÇl
(cÚ¡ 
mbulk
 *
m
)

226 
boŞ
 
»t
 = 
çl£
;

228 
»t
 = 
	`mbulk_has_sigÇl
(
m
);

230  
»t
 ? 
	`mbulk_g‘_£g
(
m
è: 
NULL
;

231 
	}
}

242 
šlše
 
mbulk
 *
	$mbulk_®loc
(
mbulk_şass
 
şas
, 
size_t
 
d©_bufsz
)

244  
	`mbulk_w™h_sigÇl_®loc
(
şas
, 0, 
d©_bufsz
);

245 
	}
}

254 
šlše
 
	$mbulk_ä“
(
mbulk
 *
m
)

256 
	`mbulk_£g_ä“
(
m
);

257 
	}
}

268 
šlše
 *
	$mbulk_d©_rw
(cÚ¡ 
mbulk
 *
m
)

270 
	`WARN_ON
(
	`MBULK_SEG_IS_READONLY
(
m
));

271  
	`MBULK_SEG_DAT
(
m
);

272 
	}
}

283 
šlše
 cÚ¡ *
	$mbulk_d©_r
(cÚ¡ 
mbulk
 *
m
)

285  (cÚ¡ *)
	`MBULK_SEG_DAT
(
m
);

286 
	}
}

292 
šlše
 *
	$mbulk_d©_©_rw
(cÚ¡ 
mbulk
 *
m
, 
size_t
 
off
)

294 
	`WARN_ON
(
	`MBULK_SEG_IS_READONLY
(
m
));

295  
	`MBULK_SEG_DAT_AT
(
m
, 
off
);

296 
	}
}

302 
šlše
 *
	$mbulk_d©_©_r
(cÚ¡ 
mbulk
 *
m
, 
size_t
 
off
)

304  ( *)
	`MBULK_SEG_DAT_AT
(
m
, 
off
);

305 
	}
}

311 
šlše
 
size_t
 
	$mbulk_’
(cÚ¡ 
mbulk
 *
m
)

313  
	`MBULK_SEG_LEN
(
m
);

314 
	}
}

320 
šlše
 
size_t
 
	$mbulk_h—droom
(cÚ¡ 
mbulk
 *
m
)

322  
	`MBULK_SEG_HEADROOM
(
m
);

323 
	}
}

325 
šlše
 
size_t
 
	$mbulk_room
(cÚ¡ 
mbulk
 *
m
)

327  
	`MBULK_SEG_TAILROOM
(
m
);

328 
	}
}

337 
šlše
 
boŞ
 
	$mbulk_»£rve_h—d
(
mbulk
 *
m
, 
size_t
 
h—droom
)

339  
	`mbulk_£g_»£rve_h—d
(
m
, 
h—droom
);

340 
	}
}

349 
šlše
 
boŞ
 
	$mbulk_adju¡_¿nge
(
mbulk
 *
m
, 
size_t
 
h—droom
, size_ˆ
Ën
)

351  
	`mbulk_£g_adju¡_¿nge
(
m
, 
h—droom
, 
Ën
);

352 
	}
}

361 
šlše
 
boŞ
 
	$mbulk_´•’d_h—d
(
mbulk
 *
m
, 
size_t
 
mÜe
)

363  
	`mbulk_£g_´•’d_h—d
(
m
, 
mÜe
);

364 
	}
}

372 
šlše
 
boŞ
 
	$mbulk_­³nd_
(
mbulk
 *
m
, 
size_t
 
mÜe
)

374  
	`mbulk_£g_­³nd_
(
m
, 
mÜe
);

375 
	}
}

384 
šlše
 
boŞ
 
	$mbulk_Œim_h—d
(
mbulk
 *
m
, 
size_t
 
Ëss
)

386  
	`mbulk_£g_Œim_h—d
(
m
, 
Ëss
);

387 
	}
}

395 
šlše
 
boŞ
 
	$mbulk_Œim_
(
mbulk
 *
m
, 
size_t
 
Ëss
)

397  
	`mbulk_£g_Œim_
(
m
, 
Ëss
);

398 
	}
}

407 
šlše
 
mbulk
 *
	$mbulk_du¶iÿ‹
(
mbulk
 *
m
)

409  
	`mbulk_£g_du¶iÿ‹
(
m
);

410 
	}
}

419 
šlše
 
mbulk
 *
	$mbulk_şÚe
(cÚ¡ 
mbulk
 *
m
, 
mbulk_şass
 
şas
,

420 
boŞ
 
cİy_sig
)

422  
	`mbulk_£g_şÚe
(
m
, 
şas
, 
cİy_sig
);

423 
	}
}

429 *
msigÇl_®loc
(
size_t
 
sig_sz
);

435 
msigÇl_ä“
(*
sig
);

441 
mbulk
 *
msigÇl_to_mbulk
(*
sig
);

446 
šlše
 
scsc_miäam_»f
 
	$mbulk_chaš_Ãxt
(
mbulk
 *
m
)

448  
	`MBULK_SEG_CHAIN_NEXT
(
m
);

449 
	}
}

451 #ifdeà
MBULK_SUPPORT_SG_CHAIN


461 
mbulk
 *
mbulk_chaš_w™h_sigÇl_®loc_by_poŞ
(
u8
 
poŞ_id
,

462 
mbulk_şass
 
şas
, 
size_t
 
sig_bufsz
, size_ˆ
d©_bufsz
);

467 
mbulk_chaš_ä“
(
mbulk
 *
sg
);

473 
mbulk
 *
mbulk_chaš_
(mbulk *
m
);

479 
size_t
 
mbulk_chaš_bufsz
(
mbulk
 *
m
);

485 
size_t
 
mbulk_chaš_’
(
mbulk
 *
m
);

490 
šlše
 
	$mbulk_chaš_num
(cÚ¡ 
mbulk
 *
m
)

492 ià(
	`mbulk_is_sg
(
m
)) {

493 
n
 = 0;

495 
m
 !ğ
NULL
) {

496 
n
++;

497 
m
 = m->
chaš_Ãxt
;

499  
n
;

502 
	}
}

505 *
mbulk_chaš_acûss
(
mbulk
 *
m
, 
size_t
 
off
, *
loÿl_buf
, size_ˆ
loÿl_bufsz
);

506 *
mbulk_chaš_wr™eback
(
mbulk
 *
m
, 
size_t
 
off
, *
loÿl_buf
, size_ˆ
loÿl_bufsz
);

507 *
mbulk_chaš_cİy_äom
(
mbulk
 *
m
, 
size_t
 
off
, *
buf
, 
Ën
);

508 *
mbulk_chaš_cİy_to
(
mbulk
 *
m
, 
size_t
 
off
, *
buf
, 
Ën
);

515 
š™_mbulk
(*
mem
, 
size_t
 
poŞ_size
);

521 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


522 
mbulk_poŞ_add
(
u8
 
poŞ_id
, *
ba£
, *
’d
, 
size_t
 
£g_size
, u8 
gu¬d
, 
mšÜ
);

524 
mbulk_poŞ_add
(
u8
 
poŞ_id
, *
ba£
, *
’d
, 
size_t
 
buf_size
, u8 
gu¬d
);

527 
mbulk_poŞ_»move
(
u8
 
poŞ_id
);

531 
mbulk_poŞ_check_§n™y
(
u8
 
poŞ_id
);

536 
mbulk_£t_hªdËr_»tuº_ho¡_mbulk
((*
ä“_ho¡_buf
)(
mbulk
 *
m
));

541 
	`mbulk_ä“_vœt_ho¡
(
mbulk
 *
m
);

542 
	`mbulk_poŞ_dump
(
u8
 
poŞ_id
, 
max_út
);

544 
mbulk_cŞour
 
	`mbulk_g‘_cŞour
(
u8
 
poŞ_id
, 
mbulk
 *
m
);

	@mbulk_def.h

7 #iâdeà
__MBULK_DEF_H__


8 
	#__MBULK_DEF_H__


	)

10 
	~<lšux/bug.h
>

11 
	~<scsc/scsc_miäam.h
>

22 
	#MBULK_SIG_BUFSZ_ROUNDUP
(
sig_bufsz
è
	`round_up
(sig_bufsz, 4)

	)

44 
u16
 
	tmbulk_Ën_t
;

45 
	smbulk
 {

46 
scsc_miäam_»f
 
	mÃxt_off£t
;

47 
u8
 
	mæag
;

48 
mbulk_şass
 
	mşas
;

49 
u8
 
	mpid
;

50 
u8
 
	m»fút
;

51 
mbulk_Ën_t
 
	md©_bufsz
;

52 
mbulk_Ën_t
 
	msig_bufsz
;

53 
mbulk_Ën_t
 
	mËn
;

54 
mbulk_Ën_t
 
	mh—d
;

55 
scsc_miäam_»f
 
	mchaš_Ãxt_off£t
;

56 } 
	g__·cked
;

59 
	#MBULK_F_SIG
 (1 << 0è

	)

60 
	#MBULK_F_READONLY
 (1 << 1è

	)

61 
	#MBULK_F_OBOUND
 (1 << 2è

	)

62 
	#MBULK_F_WAKEUP
 (1 << 3è

	)

63 
	#MBULK_F_FREE
 (1 << 5è

	)

64 
	#MBULK_F_CHAIN_HEAD
 (1 << 6è

	)

65 
	#MBULK_F_CHAIN
 (1 << 7è

	)

68 
	#MBULK_MAX_CHAIN
 16

	)

70 
	#MBULK_SEG_B
(
m
è((
ušŒ_t
)(mè+ (
mbulk
))

	)

73 
	#MBULK_SEG_RAW_BUFSZ
(
m
è((
mbulk
è+ (m)->
sig_bufsz
 + (m)->
d©_bufsz
)

	)

76 
	#MBULK_SEG_NEXT
(
m
è((m)->
Ãxt_off£t
)

	)

77 
	#MBULK_SEG_REFCNT
(
m
è((m)->
»fút
)

	)

78 
	#MBULK_SEG_HAS_SIGNAL
(
m
è((m)->
æag
 & 
MBULK_F_SIG
)

	)

79 
	#MBULK_SEG_CHAIN_NEXT
(
m
è((m)->
chaš_Ãxt_off£t
)

	)

80 
	#MBULK_SEG_IS_CHAIN_HEAD
(
m
è((m)->
æag
 & 
MBULK_F_CHAIN_HEAD
)

	)

81 
	#MBULK_SEG_IS_CHAINED
(
m
è((m)->
æag
 & 
MBULK_F_CHAIN
)

	)

83 
	#MBULK_SEG_IS_READONLY
(
m
è((m)->
æag
 & 
MBULK_F_READONLY
)

	)

84 
	#MBULK_SEG_SET_READONLY
(
m
è((m)->
æag
 |ğ
MBULK_F_READONLY
)

	)

86 
	#MBULK_SEG_DAT
(
m
è((*)
	`MBULK_SEG_B
(mè+ (m)->
h—d
)

	)

87 
	#MBULK_SEG_DAT_AT
(
m
, 
off
è((*)
	`MBULK_SEG_B
(mè+ (m)->
h—d
 + (
mbulk_Ën_t
)(off))

	)

88 
	#MBULK_SEG_DAT_BUFSIZE
(
m
è((
size_t
)((m)->
d©_bufsz
))

	)

89 
	#MBULK_SEG_SIG_BUFSIZE
(
m
è((
size_t
)((m)->
sig_bufsz
))

	)

90 
	#MBULK_SEG_LEN
(
m
è((m)->
Ën
)

	)

91 
	#MBULK_SEG_HEADROOM
(
m
è((
size_t
)((m)->
h—d
 - (m)->
sig_bufsz
))

	)

92 
	#MBULK_SEG_TAILROOM
(
m
è((
size_t
)((m)->
d©_bufsz
 - (
	`MBULK_SEG_HEADROOM
(mè+ (m)->
Ën
)))

	)

94 
šlše
 
boŞ
 
	$mbulk_£g_»£rve_h—d
(
mbulk
 *
m
, 
size_t
 
h—droom
)

96 ià(
	`WARN_ON
(!(
m
->
d©_bufsz
 >ğ
h—droom
)))

97  
çl£
;

98 
m
->
h—d
 +ğ(
mbulk_Ën_t
)
h—droom
;

99  
Œue
;

100 
	}
}

102 
šlše
 
boŞ
 
	$mbulk_£g_adju¡_¿nge
(
mbulk
 *
m
, 
size_t
 
h—droom
,

103 
size_t
 
Ën
)

105 ià(
	`WARN_ON
(!(
m
->
d©_bufsz
 >ğ(
h—droom
 + 
Ën
))))

106  
çl£
;

107 
m
->
h—d
 = m->
sig_bufsz
 + (
mbulk_Ën_t
)
h—droom
;

108 
m
->
Ën
 = (
mbulk_Ën_t
)len;

109  
Œue
;

110 
	}
}

112 
šlše
 
boŞ
 
	$mbulk_£g_´•’d_h—d
(
mbulk
 *
m
, 
size_t
 
mÜe
)

114 ià(
	`WARN_ON
(!(
	`MBULK_SEG_HEADROOM
(
m
è>ğ
mÜe
)))

115  
çl£
;

116 
m
->
h—d
 -ğ(
mbulk_Ën_t
)
mÜe
;

117 
m
->
Ën
 +ğ(
mbulk_Ën_t
)
mÜe
;

118  
Œue
;

119 
	}
}

121 
šlše
 
boŞ
 
	$mbulk_£g_­³nd_
(
mbulk
 *
m
, 
size_t
 
mÜe
)

123 ià(
	`WARN_ON
(!(
	`MBULK_SEG_TAILROOM
(
m
è>ğ
mÜe
)))

124  
çl£
;

125 
m
->
Ën
 +ğ(
mbulk_Ën_t
)
mÜe
;

126  
Œue
;

127 
	}
}

129 
šlše
 
boŞ
 
	$mbulk_£g_Œim_h—d
(
mbulk
 *
m
, 
size_t
 
Ëss
)

131 
m
->
h—d
 +ğ(
mbulk_Ën_t
)
Ëss
;

132 
m
->
Ën
 = (m->ËÀ<ğ(
mbulk_Ën_t
)
Ëss
) ? 0 : (m->len - (mbulk_len_t)less);

133  
Œue
;

134 
	}
}

136 
šlše
 
boŞ
 
	$mbulk_£g_Œim_
(
mbulk
 *
m
, 
size_t
 
Ëss
)

138 ià(
	`WARN_ON
(!(
m
->
Ën
 >ğ(
mbulk_Ën_t
)
Ëss
)))

139  
çl£
;

140 
m
->
Ën
 -ğ(
mbulk_Ën_t
)
Ëss
;

141  
Œue
;

142 
	}
}

151 
mbulk_£g_ä“
(
mbulk
 *
m
);

160 
mbulk
 *
mbulk_£g_du¶iÿ‹
(mbulk *
m
);

169 
mbulk
 *
mbulk_£g_şÚe
(cÚ¡ mbulk *
m
, 
mbulk_şass
 
şas
, 
boŞ
 
cİy_sig
);

	@mgt.c

7 
	~<lšux/d–ay.h
>

8 
	~<lšux/fœmw¬e.h
>

9 
	~<scsc/kic/¦si_kic_lib.h
>

10 
	~<lšux/fs.h
>

11 #ià
defšed
(
CONFIG_ARCH_EXYNOS
è|| defšed(
CONFIG_ARCH_EXYNOS9
)

12 
	~<lšux/soc/§msung/exynos-soc.h
>

15 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


16 
	~<lšux/if_‘h”.h
>

17 
	~<lšux/š.h
>

20 
	~<scsc/scsc_mx.h
>

21 
	~<scsc/scsc_»Ëa£.h
>

22 
	~"mgt.h
"

23 
	~"ioùl.h
"

24 
	~"debug.h
"

25 
	~"mlme.h
"

26 
	~"Ãtif.h
"

27 
	~"uts.h
"

28 
	~"udi.h
"

29 
	~"log_ş›Ás.h
"

30 
	~"dev.h
"

31 #ifdeà
SLSI_TEST_DEV


32 
	~"un™‹¡.h
"

34 
	~"h.h
"

35 #ià
IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

36 
	~<scsc/scsc_log_cŞËùÜ.h
>

39 
	~"´ocfs.h
"

40 
	~"mib.h
"

41 
	~"unifiio.h
"

42 
	~"ba.h
"

43 
	~"scsc_wifi_fcq.h
"

44 
	~"ÿc.h
"

45 
	~"cfg80211_İs.h
"

46 
	~"Æ80211_v’dÜ.h
"

48 #ifdeà
CONFIG_SCSC_WLBTD


49 
	~"../../../misc/§msung/scsc/scsc_wlbtd.h
"

51 #ià
defšed
(
CONFIG_SCSC_WLAN_ENHANCED_BIGDATA
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

52 
	~"hªged_»cÜd.h
"

55 #ià
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

56 
	~"scsc_wÏn_mm­.h
"

59 
	#CSR_WIFI_SME_MIB2_HOST_PSID_MASK
 0x8000

	)

60 
	#MX_WLAN_FILE_PATH_LEN_MAX
 (128)

	)

61 
	#SLSI_MIB_REG_RULES_MAX
 (50)

	)

62 
	#SLSI_MIB_MAX_CLIENT
 (10)

	)

63 
	#SLSI_REG_PARAM_START_INDEX
 (1)

	)

66 
	#HOST_REASONCODE_RECOVERY_REASON
 111

	)

68 #ifdeà
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL


70 
	#SLSI_PSID_UNIFI_ARP_OUTSTANDING_MAX
 0x0A1E

	)

72 
	#SLSI_PSID_UNIFI_IGMP_OFFLOAD_ACTIVATED
 2489

	)

76 
	#FAPI_SCANMODE_LOW_LATENCY_2
 0x0002

	)

77 
	#FAPI_SCANMODE_LOW_LATENCY_3
 0x0003

	)

79 
	#SLSI_ANTENNA_NOT_SET
 (0xff)

	)

81 #ià
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 4, 0)

82 
MODULE_IMPORT_NS
(
VFS_š‹º®_I_am_»®ly_a_fesy¡em_ªd_am_NOT_a_driv”
);

85 *
	gmib_fe_t
 = "wlan_t.hcf";

86 
moduË_·¿m
(
mib_fe_t
, 
ch¬p
, 
S_IRUGO
 | 
S_IWUSR
);

87 
MODULE_PARM_DESC
(
mib_fe_t
, "mib data filename");

89 *
	gmib_fe2_t
 = "wlan_t_sw.hcf";

90 
moduË_·¿m
(
mib_fe2_t
, 
ch¬p
, 
S_IRUGO
 | 
S_IWUSR
);

91 
MODULE_PARM_DESC
(
mib_fe2_t
, "mib data filename");

97 
	gmac_addr_ov”ride
[] = "ff:ff:ff:ff:ff:ff";

98 
moduË_·¿m_¡ršg
(
mac_addr
, 
mac_addr_ov”ride
, (mac_addr_ov”ride), 
S_IRUGO
 | 
S_IWUSR
);

99 
MODULE_PARM_DESC
(
mac_addr_ov”ride
, "WLAN MAC‡ddress override");

101 
boŞ
 
	gEÇbËRfTe¡Mode
;

102 
moduË_·¿m
(
EÇbËRfTe¡Mode
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

103 
MODULE_PARM_DESC
(
EÇbËRfTe¡Mode
, "Enable RFest mode driver.");

105 
¦si_mib_İ’_fe
(
¦si_dev
 *
sdev
, 
¦si_dev_mib_šfo
 *
mib_šfo
, cÚ¡ 
fœmw¬e
 **
fw
);

106 
¦si_mib_şo£_fe
(
¦si_dev
 *
sdev
, cÚ¡ 
fœmw¬e
 *
e
);

107 
¦si_mib_dowÆßd_fe
(
¦si_dev
 *
sdev
, 
¦si_dev_mib_šfo
 *
mib_šfo
);

108 
¦si_couÁry_to_šdex
(
¦si_802_11d_»g_domaš
 *
domaš_šfo
, cÚ¡ *
®pha2
);

109 
¦si_mib_š™Ÿl_g‘
(
¦si_dev
 *
sdev
);

110 
	g¦si_hªged_ev’t_couÁ
;

111 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


112 
	#SLSI_MAX_CHAN_5G_BAND
 25

	)

113 
	#SLSI_2G_CHANNEL_ONE
 2412

	)

117 
ssize_t
 
sysfs_show_maÿddr
(
kobjeù
 *
kobj
, 
kobj_©Œibu‹
 *
©Œ
,

118 *
buf
);

119 
ssize_t
 
sysfs_¡Üe_maÿddr
(
kobjeù
 *
kobj
, 
kobj_©Œibu‹
 *
©Œ
,

120 cÚ¡ *
buf
, 
size_t
 
couÁ
);

121 
ssize_t
 
sysfs_show_v”siÚ_šfo
(
kobjeù
 *
kobj
, 
kobj_©Œibu‹
 *
©Œ
,

122 *
buf
);

123 #ià
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

125 
ssize_t
 
sysfs_show_debugdump
(
kobjeù
 *
kobj
, 
kobj_©Œibu‹
 *
©Œ
,

126 *
buf
);

127 
ssize_t
 
sysfs_¡Üe_debugdump
(
kobjeù
 *
kobj
, 
kobj_©Œibu‹
 *
©Œ
,

128 cÚ¡ *
buf
, 
size_t
 
couÁ
);

131 
ssize_t
 
sysfs_show_pm
(
kobjeù
 *
kobj
, 
kobj_©Œibu‹
 *
©Œ
, *
buf
);

132 
ssize_t
 
sysfs_¡Üe_pm
(
kobjeù
 *
kobj
, 
kobj_©Œibu‹
 *
©Œ
,

133 cÚ¡ *
buf
, 
size_t
 
couÁ
);

134 
ssize_t
 
sysfs_show_ªt
(
kobjeù
 *
kobj
, 
kobj_©Œibu‹
 *
©Œ
, *
buf
);

135 
ssize_t
 
sysfs_¡Üe_ªt
(
kobjeù
 *
kobj
, 
kobj_©Œibu‹
 *
©Œ
,

136 cÚ¡ *
buf
, 
size_t
 
couÁ
);

138 
kobjeù
 *
	gwifi_kobj_»f
;

139 
	gsysfs_mac_ov”ride
[] = "ff:ff:ff:ff:ff:ff";

140 
u16
 
	gsysfs_ª‹Âa
 = 
SLSI_ANTENNA_NOT_SET
;

141 
kobj_©Œibu‹
 
	gmac_©Œ
 = 
__ATTR
(
mac_addr
, 0660, 
sysfs_show_maÿddr
, 
sysfs_¡Üe_maÿddr
);

142 
kobj_©Œibu‹
 
	gpm_©Œ
 = 
__ATTR
(
pm
, 0660, 
sysfs_show_pm
, 
sysfs_¡Üe_pm
);

143 
kobj_©Œibu‹
 
	gªt_©Œ
 = 
__ATTR
(
ªt
, 0660, 
sysfs_show_ªt
, 
sysfs_¡Üe_ªt
);

144 
kobj_©Œibu‹
 
	gv”_©Œ
 = 
__ATTR
(
wifiv”
, 0660, 
sysfs_show_v”siÚ_šfo
, 
NULL
);

145 #ià
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

146 
	gdump_š_´og»ss
 = 0;

147 
kobj_©Œibu‹
 
	gdump_©Œ
 = 
__ATTR
(
dump_š_´og»ss
, 0660, 
sysfs_show_debugdump
, 
sysfs_¡Üe_debugdump
);

151 
ssize_t
 
	$sysfs_show_maÿddr
(
kobjeù
 *
kobj
,

152 
kobj_©Œibu‹
 *
©Œ
,

153 *
buf
)

155  
	`¢´štf
(
buf
, (
sysfs_mac_ov”ride
), "%s", sysfs_mac_override);

156 
	}
}

159 
ssize_t
 
	$sysfs_¡Üe_maÿddr
(
kobjeù
 *
kobj
,

160 
kobj_©Œibu‹
 *
©Œ
,

161 cÚ¡ *
buf
,

162 
size_t
 
couÁ
)

164 
r
;

166 
	`SLSI_INFO_NODEV
("Ov”ridWLAN MAC‡dd»s %s\n", 
buf
);

169 
r
 = 
	`ssÿnf
(
buf
, "%17s", (*)&
sysfs_mac_ov”ride
);

170  (
r
 > 0è? 
couÁ
 : 0;

171 
	}
}

174 
	$¦si_ü—‹_sysfs_maÿddr
()

176 #iâdeà
SLSI_TEST_DEV


177 
r
;

179 
wifi_kobj_»f
 = 
	`mxmª_wifi_kobjeù_»f_g‘
();

180 
	`´_šfo
("wifi_kobj_»f: 0x%p\n", 
wifi_kobj_»f
);

182 ià(
wifi_kobj_»f
) {

184 
r
 = 
	`sysfs_ü—‹_fe
(
wifi_kobj_»f
, &
mac_©Œ
.
©Œ
);

185 ià(
r
) {

187 
	`´_”r
("Can't create /sys/wifi/mac_addr\n");

191 
	`´_”r
("failedo create /sys/wifi/mac_addr\n");

194 
	}
}

197 
	$¦si_de¡roy_sysfs_maÿddr
()

199 ià(!
wifi_kobj_»f
)

203 
	`sysfs_»move_fe
(
wifi_kobj_»f
, &
mac_©Œ
.
©Œ
);

206 
	`mxmª_wifi_kobjeù_»f_put
();

207 
	}
}

210 
ssize_t
 
	$sysfs_show_v”siÚ_šfo
(
kobjeù
 *
kobj
,

211 
kobj_©Œibu‹
 *
©Œ
,

212 *
buf
)

214 
¦si_dev
 *
sdev
 = 
	`¦si_g‘_sdev
();

215 
bud_id_fw
[128] = {0};

216 
bud_id_drv
[64] = {0};

217 
buf_size
 = 256;

219 #iâdeà
SLSI_TEST_DEV


220 
	`mxmª_g‘_fw_v”siÚ
(
bud_id_fw
, 128);

221 
	`mxmª_g‘_driv”_v”siÚ
(
bud_id_drv
, 64);

224  
	`¢´štf
(
buf
, 
buf_size
,

230 
bud_id_drv
,

231 
bud_id_fw
,

232 
sdev
->
mib
[0].
¶©fÜm
,

233 
sdev
->
mib
[1].
¶©fÜm
,

234 ((
sdev
->
»g_dom_v”siÚ
 >> 8) & 0xFF), (sdev->reg_dom_version & 0xFF));

235 
	}
}

238 
	$¦si_ü—‹_sysfs_v”siÚ_šfo
()

240 #iâdeà
SLSI_TEST_DEV


241 
r
;

243 
wifi_kobj_»f
 = 
	`mxmª_wifi_kobjeù_»f_g‘
();

244 
	`´_šfo
("wifi_kobj_»f: 0x%p\n", 
wifi_kobj_»f
);

246 ià(
wifi_kobj_»f
) {

248 
r
 = 
	`sysfs_ü—‹_fe
(
wifi_kobj_»f
, &
v”_©Œ
.
©Œ
);

249 ià(
r
) {

251 
	`´_”r
("Can't create /sys/wifi/wifiver\n");

255 
	`´_”r
("failedo create /sys/wifi/wifiver\n");

258 
	}
}

261 
	$¦si_de¡roy_sysfs_v”siÚ_šfo
()

263 ià(!
wifi_kobj_»f
)

267 
	`sysfs_»move_fe
(
wifi_kobj_»f
, &
v”_©Œ
.
©Œ
);

270 
	`mxmª_wifi_kobjeù_»f_put
();

271 
	}
}

273 #ià
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

275 
ssize_t
 
	$sysfs_show_debugdump
(
kobjeù
 *
kobj
,

276 
kobj_©Œibu‹
 *
©Œ
,

277 *
buf
)

279  
	`¥rštf
(
buf
, "%d\n", 
dump_š_´og»ss
);

280 
	}
}

283 
ssize_t
 
	$sysfs_¡Üe_debugdump
(
kobjeù
 *
kobj
,

284 
kobj_©Œibu‹
 *
©Œ
,

285 cÚ¡ *
buf
,

286 
size_t
 
couÁ
)

288 
r
;

289 
¦si_dev
 *
sdev
 = 
	`¦si_g‘_sdev
();

291 
r
 = 
	`k¡¹ošt
(
buf
, 10, &
dump_š_´og»ss
);

292 ià(
r
 < 0)

293 
dump_š_´og»ss
 = 0;

295 
	`SLSI_INFO_NODEV
("dump_š_´og»ss: %d\n", 
dump_š_´og»ss
);

297 
	`queue_wÜk
(
sdev
->
deviû_wq
, &sdev->
ch£t_loggšg_wÜk
);

298  (
r
 =ğ0è? 
couÁ
 : 0;

299 
	}
}

302 
	$¦si_ü—‹_sysfs_debug_dump
()

304 
r
;

306 
wifi_kobj_»f
 = 
	`mxmª_wifi_kobjeù_»f_g‘
();

307 
	`´_šfo
("wifi_kobj_»f: 0x%p\n", 
wifi_kobj_»f
);

309 ià(
wifi_kobj_»f
) {

311 
r
 = 
	`sysfs_ü—‹_fe
(
wifi_kobj_»f
, &
dump_©Œ
.
©Œ
);

312 ià(
r
) {

314 
	`´_”r
("Can't create /sys/wifi/dump_in_progress\n");

315 
	`mxmª_wifi_kobjeù_»f_put
();

319 
	`´_”r
("failedo create /sys/wifi/dump_in_progress\n");

321 
	}
}

324 
	$¦si_de¡roy_sysfs_debug_dump
()

326 ià(!
wifi_kobj_»f
)

330 
	`sysfs_»move_fe
(
wifi_kobj_»f
, &
dump_©Œ
.
©Œ
);

333 
	`mxmª_wifi_kobjeù_»f_put
();

334 
	}
}

337 
	$¦si_purge_sÿn_»suÉs_locked
(
Ãtdev_vif
 *
ndev_vif
, 
u16
 
sÿn_id
)

339 
¦si_sÿn_»suÉ
 *
sÿn_»suÉ
;

340 
¦si_sÿn_»suÉ
 *
´ev
 = 
NULL
;

342 
sÿn_»suÉ
 = 
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»suÉs
;

343 
sÿn_»suÉ
) {

344 
	`kä“_skb
(
sÿn_»suÉ
->
b—cÚ
);

345 
	`kä“_skb
(
sÿn_»suÉ
->
´obe_»¥
);

346 
´ev
 = 
sÿn_»suÉ
;

347 
sÿn_»suÉ
 = sÿn_»suÉ->
Ãxt
;

348 
	`kä“
(
´ev
);

350 
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»suÉs
 = 
NULL
;

351 
	}
}

353 
	$¦si_purge_sÿn_»suÉs
(
Ãtdev_vif
 *
ndev_vif
, 
u16
 
sÿn_id
)

355 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

356 
	`¦si_purge_sÿn_»suÉs_locked
(
ndev_vif
, 
sÿn_id
);

357 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

358 
	}
}

360 
	$¦si_purge_bÏckli¡
(
Ãtdev_vif
 *
ndev_vif
)

362 
li¡_h—d
 *
bÏckli¡_pos
, *
bÏckli¡_q
;

364 
	`kä“
(
ndev_vif
->
aş_d©a_suµliÿÁ
);

365 
ndev_vif
->
aş_d©a_suµliÿÁ
 = 
NULL
;

367 
	`kä“
(
ndev_vif
->
aş_d©a_h®
);

368 
ndev_vif
->
aş_d©a_h®
 = 
NULL
;

370 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_fw_li¡
) {

371 
¦si_bssid_bÏckli¡_šfo
 *
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
,

372 
¦si_bssid_bÏckli¡_šfo
, 
li¡
);

374 
	`li¡_d–
(
bÏckli¡_pos
);

375 
	`kä“
(
bÏckli¡_šfo
);

377 
	`INIT_LIST_HEAD
(&
ndev_vif
->
aş_d©a_fw_li¡
);

379 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_ioùl_li¡
) {

380 
¦si_ioùl_bÏckli¡_šfo
 *
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
,

381 
¦si_ioùl_bÏckli¡_šfo
, 
li¡
);

383 
	`li¡_d–
(
bÏckli¡_pos
);

384 
	`kä“
(
bÏckli¡_šfo
);

386 
	`INIT_LIST_HEAD
(&
ndev_vif
->
aş_d©a_ioùl_li¡
);

387 
	}
}

389 
sk_buff
 *
	$¦si_dequeue_ÿched_sÿn_»suÉ
(
¦si_sÿn
 *
sÿn
, *
couÁ
)

391 
sk_buff
 *
skb
 = 
NULL
;

392 
¦si_sÿn_»suÉ
 *
sÿn_»suÉ
 = 
sÿn
->
sÿn_»suÉs
;

394 ià(
sÿn_»suÉ
) {

395 ià(
sÿn_»suÉ
->
b—cÚ
) {

396 
skb
 = 
sÿn_»suÉ
->
b—cÚ
;

397 
sÿn_»suÉ
->
b—cÚ
 = 
NULL
;

398 } ià(
sÿn_»suÉ
->
´obe_»¥
) {

399 
skb
 = 
sÿn_»suÉ
->
´obe_»¥
;

400 
sÿn_»suÉ
->
´obe_»¥
 = 
NULL
;

402 
	`SLSI_ERR_NODEV
("Scanƒntry with‚o beacon /probe„esp!!\n");

406 ià(!
sÿn_»suÉ
->
b—cÚ
 && !sÿn_»suÉ->
´obe_»¥
) {

407 
sÿn
->
sÿn_»suÉs
 = 
sÿn_»suÉ
->
Ãxt
;

408 
	`kä“
(
sÿn_»suÉ
);

409 ià(
couÁ
)

410 (*
couÁ
)++;

413  
skb
;

414 
	}
}

416 
	$¦si_g‘_hw_mac_add»ss
(
¦si_dev
 *
sdev
, 
u8
 *
addr
)

418 #iâdeà
SLSI_TEST_DEV


419 cÚ¡ 
fœmw¬e
 *
e
 = 
NULL
;

420 
i
;

421 
u32
 
u
[
ETH_ALEN
];

422 
·th_Çme
[
MX_WLAN_FILE_PATH_LEN_MAX
];

423 
r
;

424 
boŞ
 
v®id
 = 
çl£
;

427 
r
 = 
	`ssÿnf
(
mac_addr_ov”ride
, "%02X:%02X:%02X:%02X:%02X:%02X", &
u
[0], &u[1], &u[2], &u[3], &u[4], &u[5]);

428 ià(
r
 !ğ
ETH_ALEN
) {

429 
	`SLSI_ERR
(
sdev
, "mac_addr modparam set, but format is incorrect (should beƒ.g. xx:xx:xx:xx:xx:xx)\n");

430 
mac_sysfs
;

432 
i
 = 0; i < 
ETH_ALEN
; i++) {

433 ià(
u
[
i
] != 0xff)

434 
v®id
 = 
Œue
;

435 
addr
[
i
] = 
u
[i] & 0xff;

439 ià(
v®id
) {

440 
	`SLSI_INFO
(
sdev
, "MAC‡dd»s äom mod·¿m: " 
MACSTR
 "\n", 
	`MAC2STR
(
u
));

445 
mac_sysfs
:

446 
r
 = 
	`ssÿnf
(
sysfs_mac_ov”ride
, "%02X:%02X:%02X:%02X:%02X:%02X", &
u
[0], &u[1], &u[2], &u[3], &u[4], &u[5]);

447 ià(
r
 !ğ
ETH_ALEN
) {

448 
	`SLSI_ERR
(
sdev
, "mac_addr in sysfs set, but format is incorrect (should beƒ.g. xx:xx:xx:xx:xx:xx)\n");

449 
mac_fe
;

451 
i
 = 0; i < 
ETH_ALEN
; i++) {

452 ià(
u
[
i
] != 0xff)

453 
v®id
 = 
Œue
;

454 
addr
[
i
] = 
u
[i] & 0xff;

458 ià(
v®id
) {

459 
	`SLSI_INFO
(
sdev
, "MAC‡dd»s äom sysfs: " 
MACSTR
 "\n", 
	`MAC2STR
(
u
));

464 
mac_fe
:

465 ià(
sdev
->
maddr_fe_Çme
) {

466 
	`sú´štf
(
·th_Çme
, 
MX_WLAN_FILE_PATH_LEN_MAX
, "wÏn/%s", 
sdev
->
maddr_fe_Çme
);

467 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "MAC‡dd»s f: %s\n", 
·th_Çme
);

469 
r
 = 
	`mx140_fe_»que¡_deviû_cÚf
(
sdev
->
maxw–l_cÜe
, &
e
, 
·th_Çme
);

470 ià(
r
 != 0)

471 
mac_efs
;

473 ià(!
e
) {

474 
	`SLSI_ERR
(
sdev
, "mx140_file_request_device_conf()„eturned succes, but firmware was‚ull\n");

475 
mac_efs
;

477 
r
 = 
	`ssÿnf
(
e
->
d©a
, "%02X:%02X:%02X:%02X:%02X:%02X", &
u
[0], &u[1], &u[2], &u[3], &u[4], &u[5]);

478 
	`mx140_fe_»Ëa£_cÚf
(
sdev
->
maxw–l_cÜe
, 
e
);

479 ià(
r
 !ğ
ETH_ALEN
) {

480 
	`SLSI_ERR
(
sdev
, "% exi¡s, buˆfÜm© i šcÜ»ù (should be.g. xx:xx:xx:xx:xx:xx)\n", 
·th_Çme
);

481 
mac_efs
;

483 
i
 = 0; i < 
ETH_ALEN
; i++)

484 
addr
[
i
] = 
u
[i] & 0xff;

485 
	`SLSI_INFO
(
sdev
, "MAC‡dd»s lßded from %s: " 
MACSTR
 "\n", 
·th_Çme
, 
	`MAC2STR
(
u
));

488 
mac_efs
:

489 #ifdeà
CONFIG_SCSC_WLAN_MAC_ADDRESS_FILENAME


490 
	`sú´štf
(
·th_Çme
, 
MX_WLAN_FILE_PATH_LEN_MAX
,

491 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 4, 0))

496 
CONFIG_SCSC_WLAN_MAC_ADDRESS_FILENAME
);

497 
r
 = 
	`mx140_»que¡_fe
(
sdev
->
maxw–l_cÜe
, 
·th_Çme
, &
e
);

498 ià(
r
 != 0)

499 
mac_deçuÉ
;

500 ià(!
e
) {

501 
	`SLSI_ERR
(
sdev
, "mx140_request_file()„eturned succes, but firmware was‚ull\n");

502 
mac_deçuÉ
;

504 
r
 = 
	`ssÿnf
(
e
->
d©a
, "%02X:%02X:%02X:%02X:%02X:%02X", &
u
[0], &u[1], &u[2], &u[3], &u[4], &u[5]);

505 ià(
r
 !ğ
ETH_ALEN
) {

506 
	`SLSI_ERR
(
sdev
, "%sƒxists, but format is incorrect (%d) [%20s] (should beƒ.g. xx:xx:xx:xx:xx:xx)\n",

507 
CONFIG_SCSC_WLAN_MAC_ADDRESS_FILENAME
, 
r
, 
e
->
d©a
);

508 
mac_deçuÉ
;

510 
i
 = 0; i < 
ETH_ALEN
; i++) {

511 ià(
u
[
i
] != 0xff)

512 
v®id
 = 
Œue
;

513 
addr
[
i
] = 
u
[i] & 0xff;

517 ià(
v®id
) {

518 #ifdeà
CONFIG_SCSC_WLAN_MAC_ADDRESS_FILENAME


519 
	`SLSI_INFO
(
sdev
, "MAC‡dd»s lßded from %s: " 
MACSTR
 "\n",

520 
CONFIG_SCSC_WLAN_MAC_ADDRESS_FILENAME
, 
	`MAC2STR
(
u
));

523 ià(
addr
[0] & 0x01) {

524 
addr
[0] =‡ddr[0] & 0xfe;

525 
	`SLSI_INFO
(
sdev
, "MAC‡dd»s šv®id, fixed‡dd»ss: " 
MACSTR
 "\n", 
	`MAC2STR
(
addr
));

527 
	`mx140_»Ëa£_fe
(
sdev
->
maxw–l_cÜe
, 
e
);

530 
mac_deçuÉ
:

532 
	`mx140_fe_»Ëa£_cÚf
(
sdev
->
maxw–l_cÜe
, 
e
);

534 
	`SLSI_ETHER_COPY
(
addr
, 
SLSI_DEFAULT_HW_MAC_ADDR
);

535 #ià
	`defšed
(
CONFIG_ARCH_EXYNOS
è|| defšed(
CONFIG_ARCH_EXYNOS9
)

537 
addr
[3] = (
exynos_soc_šfo
.
unique_id
 & 0xFF0000000000) >> 40;

538 
addr
[4] = (
exynos_soc_šfo
.
unique_id
 & 0x00FF00000000) >> 32;

539 
addr
[5] = (
exynos_soc_šfo
.
unique_id
 & 0x0000FF000000) >> 24;

541 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
,

542 "MAC‡dd¸fNOT found, usšg deçuÉ MAC ADDR: %pM\n", 
addr
);

545 
¦si_‹¡_dev
 *
uáe¡dev
 = (¦si_‹¡_dev *)
sdev
->
maxw–l_cÜe
;

547 
	`SLSI_ETHER_COPY
(
addr
, 
uáe¡dev
->
hw_addr
);

548 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "Te¡ Deviû Add»ss: %pM\n", 
addr
);

550 
	}
}

552 
	$wr™e_wifi_v”siÚ_šfo_fe
(
¦si_dev
 *
sdev
)

554 #ià
	`defšed
(
SCSC_SEP_VERSION
) && (SCSC_SEP_VERSION >= 9)

555 *
f•©h
 = "/data/vendor/conn/.wifiver.info";

557 *
f•©h
 = "/data/misc/conn/.wifiver.info";

559 
buf
[256];

560 
bud_id_fw
[128];

561 
bud_id_drv
[64];

563 #iâdeà
SLSI_TEST_DEV


564 
	`mxmª_g‘_fw_v”siÚ
(
bud_id_fw
, 128);

565 
	`mxmª_g‘_driv”_v”siÚ
(
bud_id_drv
, 64);

576 #ià
	`defšed
(
SCSC_SEP_VERSION
) && (SCSC_SEP_VERSION >= 9)

578 
	`¢´štf
(
buf
, (buf),

584 
bud_id_drv
,

585 
bud_id_fw
,

586 
sdev
->
mib
[0].
¶©fÜm
,

587 
sdev
->
mib
[1].
¶©fÜm
,

588 ((
sdev
->
»g_dom_v”siÚ
 >> 8) & 0xFF), (sdev->reg_dom_version & 0xFF));

591 
	`¢´štf
(
buf
, (buf),

593 
bud_id_drv
,

594 
bud_id_fw
,

595 ((
sdev
->
»g_dom_v”siÚ
 >> 8) & 0xFF), (sdev->reg_dom_version & 0xFF));

601 #ifdeà
SCSC_SEP_VERSION


602 #ifdeà
CONFIG_SCSC_WLBTD


603 
	`wlbtd_wr™e_fe
(
f•©h
, 
buf
);

606 
	`SLSI_INFO
(
sdev
, "Succeedo write firmware/host informationo .wifiver.info\n");

608 
	`SLSI_UNUSED_PARAMETER
(
f•©h
);

610 
	}
}

612 
	$wr™e_m_‹¡_ch_v”siÚ_fe
(
¦si_dev
 *
sdev
)

614 #ifdeà
CONFIG_SCSC_WLBTD


615 *
f•©h
 = "/data/vendor/conn/.cid.info";

616 
buf
[256];

618 
	`¢´štf
(
buf
, (buf), "%s\n", 
SCSC_RELEASE_SOLUTION
);

620 
	`wlbtd_wr™e_fe
(
f•©h
, 
buf
);

622 
	`SLSI_WARN
(
sdev
, "Wrote chip informationo .cid.info\n");

624 
	}
}

627 
	$¦si_¡¬t_mÚ™Ü_mode
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

629 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

630 
u8
 
deviû_add»ss
[
ETH_ALEN
] = {0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF};

632 
ndev_vif
->
vif_ty³
 = 
FAPI_VIFTYPE_MONITOR
;

634 ià(
	`¦si_mlme_add_vif
(
sdev
, 
dev
, dev->
dev_addr
, 
deviû_add»ss
) != 0) {

635 
	`SLSI_NET_ERR
(
dev
, "add VIF for Monitor mode failed\n");

636 
ndev_vif
->
vif_ty³
 = 
SLSI_VIFTYPE_UNSPECIFIED
;

637  -
EINVAL
;

649 
dev
->
ty³
 = 
ARPHRD_IEEE80211_RADIOTAP
;

650 
ndev_vif
->
aùiv©ed
 = 
Œue
;

652 
	}
}

654 
	$¦si_¡İ_mÚ™Ü_mode
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

656 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

658 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

659 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_INIT_DEINIT
, "de-activate monitor VIF\n");

660 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

661 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

664 
dev
->
ty³
 = 
ARPHRD_ETHER
;

666 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

667 
	}
}

669 #ià
IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

670 
	$¦si_hcf_cŞËù
(
scsc_log_cŞËùÜ_ş›Á
 *
cŞËù_ş›Á
, 
size_t
 
size
)

672 
¦si_dev
 *
sdev
 = (¦si_dev *)
cŞËù_ş›Á
->
´v
;

673 
»t
 = 0;

674 
u8
 
šdex
 = 
sdev
->
cŞËù_mib
.
num_fes
;

675 
u8
 
i
;

676 
u8
 *
d©a
;

678 
	`SLSI_INFO_NODEV
("Collecting WLAN HCF\n");

680 ià(!
sdev
->
cŞËù_mib
.
’abËd
)

681 
	`SLSI_INFO_NODEV
("Collection‚otƒnabled\n");

683 
	`¥š_lock
(&
sdev
->
cŞËù_mib
.
š_cŞËùiÚ
);

684 
»t
 = 
	`scsc_log_cŞËùÜ_wr™e
(&
šdex
, (), 1);

685 ià(
»t
) {

686 
	`¥š_uÆock
(&
sdev
->
cŞËù_mib
.
š_cŞËùiÚ
);

687  
»t
;

690 
i
 = 0; i < 
šdex
; i++) {

691 
	`SLSI_INFO_NODEV
("CŞËùšg WLAN HCF. F%s\n", 
sdev
->
cŞËù_mib
.
fe
[
i
].
fe_Çme
);

693 
»t
 = 
	`scsc_log_cŞËùÜ_wr™e
((*)&
sdev
->
cŞËù_mib
.
fe
[
i
].
fe_Çme
, 32, 1);

694 ià(
»t
) {

695 
	`¥š_uÆock
(&
sdev
->
cŞËù_mib
.
š_cŞËùiÚ
);

696  
»t
;

699 
»t
 = 
	`scsc_log_cŞËùÜ_wr™e
((*)&
sdev
->
cŞËù_mib
.
fe
[
i
].
Ën
, (
u16
), 1);

700 ià(
»t
) {

701 
	`¥š_uÆock
(&
sdev
->
cŞËù_mib
.
š_cŞËùiÚ
);

702  
»t
;

705 
d©a
 = 
sdev
->
cŞËù_mib
.
fe
[
i
].data;

706 ià(!
d©a
)

708 
»t
 = 
	`scsc_log_cŞËùÜ_wr™e
((*)
d©a
, 
sdev
->
cŞËù_mib
.
fe
[
i
].
Ën
, 1);

709 ià(
»t
) {

710 
	`¥š_uÆock
(&
sdev
->
cŞËù_mib
.
š_cŞËùiÚ
);

711  
»t
;

714 
	`¥š_uÆock
(&
sdev
->
cŞËù_mib
.
š_cŞËùiÚ
);

716  
»t
;

717 
	}
}

720 
scsc_log_cŞËùÜ_ş›Á
 
	g¦si_hcf_ş›Á
 = {

721 .
Çme
 = "wlan_hcf",

722 .
	gty³
 = 
SCSC_LOG_CHUNK_WLAN_HCF
,

723 .
	gcŞËù_š™
 = 
NULL
,

724 .
	gcŞËù
 = 
¦si_hcf_cŞËù
,

725 .
	gcŞËù_’d
 = 
NULL
,

726 .
	g´v
 = 
NULL
,

730 
	$¦si_ş—r_sys_”rÜ_bufãr
(
¦si_dev
 *
sdev
)

732 
	`SLSI_INFO
(
sdev
, "CË¬ sy¡emƒ¼Ü bufãr, by‹ wr™‹Àğ%d\n", sdev->
sys_”rÜ_log_buf
.
pos
);

733 
	`mem£t
(
sdev
->
sys_”rÜ_log_buf
.
log_buf
, 0, sdev->sys_”rÜ_log_buf.
pos
 + 1);

734 
sdev
->
sys_”rÜ_log_buf
.
pos
 = 0;

735 
	}
}

737 
	$¦si_¡¬t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

739 #iâdeà
CONFIG_SCSC_DOWNLOAD_FILE


740 cÚ¡ 
fœmw¬e
 *
fw
[
SLSI_WLAN_MAX_MIB_FILE
] = { 
NULL
, NULL };

742 
”r
 = 0, 
r
, 
»g_”r
 = 0, 
¡İ_”r
;

743 
i
;

744 
®pha2
[3];

745 #ifdeà
CONFIG_SCSC_WLAN_AP_INFO_FILE


746 
u32
 
off£t
 = 0;

747 
fe
 *
å
 = 
NULL
;

748 #ià
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 9

749 *
f•©h
 = "/data/vendor/conn/.softap.info";

751 *
f•©h
 = "/data/misc/conn/.softap.info";

753 
buf
[512];

755 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

757 
	`SLSI_UNUSED_PARAMETER
(
dev
);

759 ià(
	`WARN_ON
(!
sdev
))

760  -
EINVAL
;

762 
	`SLSI_MUTEX_LOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

764 
	`SLSI_INFO
(
sdev
, "recovery_status:%d, device_state:%d,„equire_service_close:%d,‚etdev_up_count:%d mac_changed:%d\n",

765 
sdev
->
»cov”y_¡©us
, sdev->
deviû_¡©e
, sdev->
»quœe_£rviû_şo£
, sdev->
Ãtdev_up_couÁ
, sdev->
mac_chªged
);

767 ià(
sdev
->
deviû_¡©e
 !ğ
SLSI_DEVICE_STATE_STOPPED
) {

768 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "Device‡lready started\n");

769 
dÚe
;

772 ià(!
sdev
->
mac_chªged
) {

773 
	`¦si_»£t_chªÃl_æags
(
sdev
);

774 
	`¦si_»gd_š™
(
sdev
);

775 
	`kä“
(
sdev
->
deçuÉ_sÿn_›s
);

776 
sdev
->
deçuÉ_sÿn_›s
 = 
NULL
;

777 
sdev
->
deçuÉ_sÿn_›s_Ën
 = 0;

780 ià(
sdev
->
»cov”y_¡©us
) {

781 
r
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sdev
->
»cov”y_com¶‘ed
,

782 
	`m£cs_to_jiff›s
(
sdev
->
»cov”y_timeout
));

783 ià(
r
 == 0) {

784 
	`SLSI_INFO
(
sdev
, "recovery_completedimeout\n");

785 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s:„ecov”y_com¶‘edimedout\n", 
__func__
);

786 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

788 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s:„ecov”y_com¶‘ed\n", 
__func__
);

789 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

791 
	`»š™_com¶‘iÚ
(&
sdev
->
»cov”y_com¶‘ed
);

794 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STARTING
;

796 
	`»š™_com¶‘iÚ
(&
sdev
->
sig_wa™
.
com¶‘iÚ
);

798 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Step [1/2]: Start WLAN service\n");

799 
	`SLSI_EC_GOTO
(
	`¦si_sm_wÏn_£rviû_İ’
(
sdev
), 
”r
, 
”r_dÚe
);

803 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Step [2/3]: Send MIB configuration\n");

805 
sdev
->
loÿl_mib
.
mib_hash
 = 0;

806 #iâdeà
SLSI_TEST_DEV


807 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

808 
	`¥š_lock_š™
(&
sdev
->
cŞËù_mib
.
š_cŞËùiÚ
);

809 
sdev
->
cŞËù_mib
.
num_fes
 = 0;

810 
sdev
->
cŞËù_mib
.
’abËd
 = 
çl£
;

812 #iâdeà
CONFIG_SCSC_DOWNLOAD_FILE


814 ià(
	`¦si_is_rf_‹¡_mode_’abËd
(è|| 
	`¦si_is_‹¡_mode_’abËd
()) {

815 
sdev
->
mib
[0].
mib_fe_Çme
 = 
mib_fe_t
;

816 
sdev
->
mib
[1].
mib_fe_Çme
 = 
mib_fe2_t
;

818 
sdev
->
mib
[0].
mib_fe_Çme
 = 
¦si_mib_fe
;

819 
sdev
->
mib
[1].
mib_fe_Çme
 = 
¦si_mib_fe2
;

823 
i
 = 0; i < 
SLSI_WLAN_MAX_MIB_FILE
; i++) {

824 
”r
 = 
	`¦si_mib_İ’_fe
(
sdev
, &sdev->
mib
[
i
], &
fw
[i]);

827 ià(
i
 =ğ0 && 
”r
) {

828 
	`SLSI_ERR
(
sdev
, "mib: Mªd©Üy wÏÀhcàmissšg. WLAN wÈnÙ s¹ (”r=%d)\n", 
”r
);

829 
	`¦si_sm_wÏn_£rviû_şo£
(
sdev
);

830 
”r_dÚe
;

834 
”r
 = 
	`¦si_sm_wÏn_£rviû_¡¬t
(
sdev
);

835 ià(
”r
) {

836 
	`SLSI_ERR
(
sdev
, "¦si_sm_wÏn_£rviû_¡¬ˆçed:ƒ¼=%d\n", 
”r
);

837 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s: slsi_sm_wlan_service_start failed:ƒrr=%d\n",

838 
__func__
, 
”r
);

839 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

841 
i
 = 0; i < 
SLSI_WLAN_MAX_MIB_FILE
; i++)

842 
	`¦si_mib_şo£_fe
(
sdev
, 
fw
[
i
]);

843 ià(
”r
 !ğ-
EILSEQ
)

844 
	`¦si_sm_wÏn_£rviû_şo£
(
sdev
);

845 
”r_dÚe
;

848 
i
 = 0; i < 
SLSI_WLAN_MAX_MIB_FILE
; i++)

849 
	`¦si_mib_şo£_fe
(
sdev
, 
fw
[
i
]);

852 
”r
 = 
	`¦si_sm_wÏn_£rviû_¡¬t
(
sdev
);

853 ià(
”r
) {

854 
	`SLSI_ERR
(
sdev
, "¦si_sm_wÏn_£rviû_¡¬ˆçed:ƒ¼=%d\n", 
”r
);

855 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s: slsi_sm_wlan_service_start failed:ƒrr=%d\n",

856 
__func__
, 
”r
);

857 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

858 ià(
”r
 !ğ-
EILSEQ
)

859 
	`¦si_sm_wÏn_£rviû_şo£
(
sdev
);

860 
”r_dÚe
;

862 
	`SLSI_EC_GOTO
(
	`¦si_mib_dowÆßd_fe
(
sdev
, &sdev->
mib
), 
”r
, 
”r_h_¡¬‹d
);

865 ()
	`¦si_mib_dowÆßd_fe
(
sdev
, &sdev->
loÿl_mib
);

872 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

873 
sdev
->
deviû_cÚfig
.
rssi_boo¡_2g
 = 0;

874 
sdev
->
deviû_cÚfig
.
rssi_boo¡_5g
 = 0;

875 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

876 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Step [3/3]: Get MIB configuration\n");

877 
	`SLSI_EC_GOTO
(
	`¦si_mib_š™Ÿl_g‘
(
sdev
), 
”r
, 
”r_h_¡¬‹d
);

878 
	`SLSI_INFO
(
sdev
, "=== Version info fromhe [MIB] ===\n");

879 
	`SLSI_INFO
(
sdev
, "HW V”siÚ : 0x%.4X (%u)\n", sdev->
ch_šfo_mib
.
ch_v”siÚ
, sdev->chip_info_mib.chip_version);

880 
	`SLSI_INFO
(
sdev
, "PÏtfÜm : 0x%.4X (%u)\n", sdev->
¶©_šfo_mib
.
¶©_bud
, sdev->plat_info_mib.plat_build);

881 
	`¦si_cfg80211_upd©e_why
(
sdev
);

883 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

885 
	`¦si_mlme_£t_ho¡_¡©e
(
sdev
, 
dev
, sdev->
deviû_cÚfig
.
ho¡_¡©e
);

887 
»g_”r
 = 
	`¦si_»ad_»guÏtÜy
(
sdev
);

888 ià(
»g_”r
) {

889 
	`SLSI_INFO
(
sdev
, "Error in„eading„egulatory!\n");

891 
”r
 = 
	`¦si_»ad_unifi_couÁryli¡
(
sdev
, 
SLSI_PSID_UNIFI_COUNTRY_LIST
);

892 ià(
”r
) {

893 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

894 
”r_h_¡¬‹d
;

897 ià(
sdev
->
»gdb
.
»gdb_¡©e
 =ğ
SLSI_REG_DB_SET
) {

898 
sdev
->
»g_dom_v”siÚ
 = ((sdev->
»gdb
.
db_majÜ_v”siÚ
 & 0xFF) << 8) |

899 (
sdev
->
»gdb
.
db_mšÜ_v”siÚ
 & 0xFF);

901 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

903 ià(!
	`¦si_is_‹¡_mode_’abËd
()) {

904 
”r
 = 
	`¦si_mlme_£t_couÁry
(
sdev
, sdev->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->
®pha2
);

906 ià(
”r
 < 0)

907 
”r_h_¡¬‹d
;

910 
	`memıy
(
®pha2
, 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->alpha2, 2);

913 ià(!(
®pha2
[0] == '0' &&‡lpha2[1] == '0'))

915 ià(
	`¦si_»ad_»guÏtÜy_ruËs
(
sdev
, &sdev->
deviû_cÚfig
.
domaš_šfo
, 
®pha2
) == 0) {

916 
	`¦si_»£t_chªÃl_æags
(
sdev
);

917 
	`why_­¶y_cu¡om_»guÏtÜy
(
sdev
->
why
, sdev->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
);

920 ià(!
sdev
->
mac_chªged
) {

923 
	`wr™e_wifi_v”siÚ_šfo_fe
(
sdev
);

926 
	`wr™e_m_‹¡_ch_v”siÚ_fe
(
sdev
);

928 #ifdeà
CONFIG_SCSC_WLAN_AP_INFO_FILE


930 
off£t
 = 
	`¢´štf
(
buf
 + offset, (buf), "#softap.info\n");

931 
off£t
 +ğ
	`¢´štf
(
buf
 + off£t, (buf), "Du®BªdCÚcu¼’cy=%s\n", 
sdev
->
du®bªd_cÚcu¼’cy
 ? "yes" : "no");

932 
off£t
 +ğ
	`¢´štf
(
buf
 + offset, (buf), "DualInterface=%s\n", "yes");

933 
off£t
 +ğ
	`¢´štf
(
buf
 + off£t, (buf), "5G=%s\n", 
sdev
->
bªd_5g_suµÜ‹d
 ? "yes" : "no");

934 
off£t
 +ğ
	`¢´štf
(
buf
 + off£t, (buf), "maxCl›Á=%d\n", !
sdev
->
soá­_max_ş›Á
 ? 
SLSI_MIB_MAX_CLIENT
 : sdev->softap_max_client);

937 
off£t
 +ğ
	`¢´štf
(
buf
 + offset, (buf), "HalFn_setCountryCodeHal=yes\n");

938 
off£t
 +ğ
	`¢´štf
(
buf
 + offset, (buf), "HalFn_getValidChannels=yes\n");

940 #ifdeà
CONFIG_SCSC_WLBTD


941 
	`wlbtd_wr™e_fe
(
f•©h
, 
buf
);

943 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Succeedo write softap informationo .softap.info\n");

946 
sdev
->
mac_chªged
 = 
çl£
;

949 #ifdeà
CONFIG_SCSC_WLAN_SET_PREFERRED_ANTENNA


950 ià(
	`¦si_is_rf_‹¡_mode_’abËd
()) {

951 ià(
sysfs_ª‹Âa
 =ğ
SLSI_ANTENNA_NOT_SET
)

952 
	`SLSI_INFO
(
sdev
, "antenna‚ot set. Set /sys/wifi/anto modify‡ntenna\n");

954 
	`¦si_£t_mib_´eã¼ed_ª‹Âa
(
sdev
, 
sysfs_ª‹Âa
);

958 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

960 
¦si_hcf_ş›Á
.
´v
 = 
sdev
;

961 
	`scsc_log_cŞËùÜ_»gi¡”_ş›Á
(&
¦si_hcf_ş›Á
);

962 
sdev
->
cŞËù_mib
.
’abËd
 = 
Œue
;

964 
	`¦si_upd©e_suµÜ‹d_chªÃls_»gd_æags
(
sdev
);

965 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "---Driver started successfully---\n");

966 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STARTED
;

967 
i
 = 0; i < 
SLSI_MAX_RTT_ID
; i++)

968 
sdev
->
¹t_id_·¿ms
[
i
] = 
NULL
;

969 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STARTED
;

970 
	`¦si_ş—r_sys_”rÜ_bufãr
(
sdev
);

971 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

973 
	`¦si_kic_sy¡em_ev’t
(
¦si_kic_sy¡em_ev’t_ÿ‹gÜy_š™Ÿli§tiÚ
,

974 
¦si_kic_sy¡em_ev’ts_wifi_£rviû_driv”_¡¬‹d
, 
GFP_KERNEL
);

976  
”r
;

978 
”r_h_¡¬‹d
:

979 #iâdeà
SLSI_TEST_DEV


980 
¡İ_”r
 = 
	`¦si_sm_wÏn_£rviû_¡İ
(
sdev
);

981 
	`¦si_h_¡İ
(
sdev
);

982 ià(
¡İ_”r
 !ğ-
EUSERS
)

983 
	`¦si_sm_wÏn_£rviû_şo£
(
sdev
);

986 
”r_dÚe
:

987 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STOPPED
;

989 
	`m¦“p
(500);

990 
dÚe
:

991 
	`¦si_kic_sy¡em_ev’t
(
¦si_kic_sy¡em_ev’t_ÿ‹gÜy_š™Ÿli§tiÚ
,

992 
¦si_kic_sy¡em_ev’ts_wifi_Ú
, 
GFP_KERNEL
);

994 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

996  
”r
;

997 
	}
}

999 
Ãt_deviû
 *
	$¦si_dyÇmic_š‹rçû_ü—‹
(
why
 *wiphy,

1000 cÚ¡ *
Çme
,

1001 
Æ80211_iáy³
 
ty³
,

1002 
vif_·¿ms
 *
·¿ms
)

1004 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1005 
Ãt_deviû
 *
dev
 = 
NULL
;

1006 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

1007 
”r
 = -
EINVAL
;

1008 
içû
;

1010 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Çme:%s\n", 
Çme
);

1012 
içû
 = 
	`¦si_Ãtif_dyÇmic_içû_add
(
sdev
, 
Çme
);

1013 ià(
içû
 < 0)

1014  
NULL
;

1016 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
içû
);

1017 ià(!
dev
)

1018  
NULL
;

1020 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1022 
”r
 = 
	`¦si_Ãtif_»gi¡”_¹Êl_locked
(
sdev
, 
dev
);

1023 ià(
”r
)

1024  
NULL
;

1026 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1027 
ndev_vif
->
iáy³
 = 
ty³
;

1028 
dev
->
›“80211_±r
->
iáy³
 = 
ty³
;

1029 ià(
·¿ms
)

1030 
dev
->
›“80211_±r
->
u£_4addr
 = 
·¿ms
->use_4addr;

1031 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1033  
dev
;

1034 
	}
}

1036 
	$¦si_¡İ_ch
(
¦si_dev
 *
sdev
)

1038 #iâdeà
SLSI_TEST_DEV


1039 
¡İ_”r
;

1041 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

1042 
u8
 
šdex
 = 
sdev
->
cŞËù_mib
.
num_fes
;

1043 
u8
 
i
;

1045 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

1047 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
sdev
->
¡¬t_¡İ_mu‹x
));

1049 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "Ãtdev_up_couÁ:%d deviû_¡©e:%d\n", sdev->
Ãtdev_up_couÁ
, sdev->
deviû_¡©e
);

1050 
sdev
->
mac_chªged
 = 
çl£
;

1052 ià(
sdev
->
deviû_¡©e
 !ğ
SLSI_DEVICE_STATE_STARTED
)

1055 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s\n", 
__func__
);

1056 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

1058 ià(
sdev
->
»cov”y_ç_§ã
) {

1059 
	`SLSI_INFO
(
sdev
, "Skip‚etdev_up_count in„ecovery fail safe\n");

1062 ià(
sdev
->
Ãtdev_up_couÁ
)

1066 
	`com¶‘e_®l
(&
sdev
->
sig_wa™
.
com¶‘iÚ
);

1068 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

1069 
sdev
->
cŞËù_mib
.
’abËd
 = 
çl£
;

1070 
	`scsc_log_cŞËùÜ_uÄegi¡”_ş›Á
(&
¦si_hcf_ş›Á
);

1071 
i
 = 0; i < 
šdex
; i++)

1072 
	`kä“
(
sdev
->
cŞËù_mib
.
fe
[
i
].
d©a
);

1075 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STOPPING
;

1076 #iâdeà
SLSI_TEST_DEV


1077 
¡İ_”r
 = 
	`¦si_sm_wÏn_£rviû_¡İ
(
sdev
);

1079 
	`¦si_sm_wÏn_£rviû_¡İ
(
sdev
);

1081 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STOPPED
;

1083 
	`¦si_h_¡İ
(
sdev
);

1084 #iâdeà
SLSI_TEST_DEV


1085 ià(
¡İ_”r
 !ğ-
EUSERS
)

1086 
	`¦si_sm_wÏn_£rviû_şo£
(
sdev
);

1088 
	`¦si_kic_sy¡em_ev’t
(
¦si_kic_sy¡em_ev’t_ÿ‹gÜy_deš™Ÿli§tiÚ
,

1089 
¦si_kic_sy¡em_ev’ts_wifi_£rviû_driv”_¡İ³d
, 
GFP_KERNEL
);

1091 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1092 ià(
sdev
->
»cov”y_ç_§ã
)

1093 
	`SLSI_INFO
(
sdev
, "Skip setting mlme_blocked in„ecovery fail safe\n");

1095 
sdev
->
mlme_blocked
 = 
çl£
;

1097 
	`¦si_kic_sy¡em_ev’t
(
¦si_kic_sy¡em_ev’t_ÿ‹gÜy_deš™Ÿli§tiÚ
,

1098 
¦si_kic_sy¡em_ev’ts_wifi_off
, 
GFP_KERNEL
);

1100 #ifdeà
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL


1101 ià(
	`©omic_»ad
(&
sdev
->
¬p_tx_couÁ
è&&‡tomic_»ad(&sdev->
ù¾_·u£_¡©e
))

1102 
	`scsc_wifi_uÅau£_¬p_q_®l_vif
(
sdev
);

1103 
	`©omic_£t
(&
sdev
->
¬p_tx_couÁ
, 0);

1105 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1106 
	}
}

1108 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1109 
	$¦si_ndl_vif_ş—nup
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
boŞ
 
hw_avaabË
)

1111 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1112 
i
;

1113 
¦si_³”
 *
³”
;

1114 
u32
 
ndp_š¡ªû_id
;

1115 
Ãt_deviû
 *
Çn_mgmt_dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
SLSI_NET_INDEX_NAN
);

1117 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

1118 
	`Ãtif_ÿ¼›r_off
(
dev
);

1119 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

1120 
i
 = 0; i < 
SLSI_ADHOC_PEER_CONNECTIONS_MAX
; i++) {

1121 
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
i
];

1122 
³”
 &&…“r->
v®id
) {

1123 
ndp_š¡ªû_id
 = 
	`¦si_Çn_g‘_ndp_äom_ndl_loÿl_ndi
(
Çn_mgmt_dev
, 
³”
->
ndl_vif
, 
dev
->
dev_addr
);

1124 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DISCONNECTED
);

1125 ià(
³”
->
ndp_couÁ
 == 1)

1126 
	`¦si_³”_»move
(
sdev
, 
dev
, 
³”
);

1127 
³”
->
ndp_couÁ
--;

1128 ià(
ndev_vif
->
Çn
.
ndp_couÁ
 > 0)

1129 
ndev_vif
->
Çn
.
ndp_couÁ
--;

1130 ià(
Çn_mgmt_dev
 && 
ndp_š¡ªû_id
 < 
SLSI_NAN_MAX_NDP_INSTANCES
 + 1)

1131 
	`¦si_Çn_ndp_d–_’Œy
(
sdev
, 
Çn_mgmt_dev
, 
ndp_š¡ªû_id
, 
Œue
);

1135 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

1136 
	}
}

1138 
	$¦si_vif_ş—nup
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
boŞ
 
hw_avaabË
, boŞ 
is_»cov”y
)

1140 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1141 
i
;

1143 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_INIT_DEINIT
, "clean VIF\n");

1145 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

1146 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1147 ià(
ndev_vif
->
iâum
 >ğ
SLSI_NAN_DATA_IFINDEX_START
) {

1148 
	`¦si_ndl_vif_ş—nup
(
sdev
, 
dev
, 
hw_avaabË
);

1152 ià(
ndev_vif
->
aùiv©ed
) {

1153 
	`Ãtif_ÿ¼›r_off
(
dev
);

1154 
i
 = 0; i < 
SLSI_ADHOC_PEER_CONNECTIONS_MAX
; i++) {

1155 
¦si_³”
 *
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
i
];

1157 ià(
³”
 &&…“r->
v®id
)

1158 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DISCONNECTED
);

1161 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

1162 
boŞ
 
®»ady_discÚÃùed
 = 
çl£
;

1164 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "StiÚ‡ùive: hw_avaabË=%d\n", 
hw_avaabË
);

1165 ià(
hw_avaabË
) {

1166 ià(
ndev_vif
->
¡a
.
¡a_bss
) {

1167 
	`¦si_mlme_discÚÃù
(
sdev
, 
dev
, 
ndev_vif
->
¡a
.
¡a_bss
->
bssid
, 
FAPI_REASONCODE_UNSPECIFIED_REASON
, 
Œue
);

1168 
	`¦si_hªdË_discÚÃù
(
sdev
, 
dev
, 
ndev_vif
->
¡a
.
¡a_bss
->
bssid
, 0, 
NULL
, 0);

1169 
®»ady_discÚÃùed
 = 
Œue
;

1171 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

1172 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

1175 ià(!
®»ady_discÚÃùed
) {

1176 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Calling slsi_vif_deactivated\n");

1177 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

1178 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 2, 0))

1179 
	`cfg80211_discÚÃùed
(
dev
, 
is_»cov”y
 ? 
HOST_REASONCODE_RECOVERY_REASON
 :

1180 
FAPI_REASONCODE_UNSPECIFIED_REASON
, 
NULL
, 0, 
çl£
, 
GFP_ATOMIC
);

1182 
	`cfg80211_discÚÃùed
(
dev
, 
is_»cov”y
 ? 
HOST_REASONCODE_RECOVERY_REASON
 :

1183 
FAPI_REASONCODE_UNSPECIFIED_REASON
, 
NULL
, 0, 
GFP_ATOMIC
);

1186 } ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
) {

1187 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "AP‡ctive\n");

1188 ià(
hw_avaabË
) {

1189 
¦si_³”
 *
³”
;

1190 
j
 = 0;

1192 
j
 < 
SLSI_PEER_INDEX_MAX
) {

1193 
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
j
];

1194 ià(
³”
 &&…“r->
v®id
)

1195 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DISCONNECTED
);

1196 ++
j
;

1198 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

1199 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

1201 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Calling slsi_vif_deactivated\n");

1202 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

1204 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_GO
)

1205 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_NO_VIF
);

1206 } ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_UNSYNCHRONISED
) {

1207 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

1208 
	`¦si_wÏn_unsync_vif_d—ùiv©e
(
sdev
, 
dev
, 
hw_avaabË
);

1210 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "P2P‡ctive - Deactivate\n");

1211 
	`¦si_p2p_vif_d—ùiv©e
(
sdev
, 
dev
, 
hw_avaabË
);

1213 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1214 } ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_NAN
) {

1215 ià(
hw_avaabË
) {

1216 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

1217 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

1219 
ndev_vif
->
aùiv©ed
 = 
çl£
;

1220 
	`¦si_Çn_£nd_di§bËd_ev’t
(
sdev
, 
dev
, 
hw_avaabË
 ? 
SLSI_HAL_NAN_STATUS_SUCCESS
 :

1221 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
);

1225 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_MONITOR
)

1226 
	`¦si_¡İ_mÚ™Ü_mode
(
sdev
, 
dev
);

1228 
	}
}

1230 
	$¦si_sched_sÿn_¡İ³d
(
wÜk_¡ruù
 *
wÜk
)

1232 
Ãtdev_vif
 *
ndev_vif
 = 
	`cÚš”_of
(
wÜk
, Ãtdev_vif, 
sched_sÿn_¡İ_wk
);

1233 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1234 
why
 *wiphy;

1235 
u64
 
»qid
 = 0;

1236 
boŞ
 
sched_sÿn_»q
 = 
çl£
;

1238 
why
 = 
sdev
->wiphy;

1239 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

1240 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_SCHED_ID
].
sched_»q
) {

1241 
»qid
 = 
ndev_vif
->
sÿn
[
SLSI_SCAN_SCHED_ID
].
sched_»q
->reqid;

1242 
sched_sÿn_»q
 = 
Œue
;

1243 
ndev_vif
->
sÿn
[
SLSI_SCAN_SCHED_ID
].
sched_»q
 = 
NULL
;

1245 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

1246 ià(
sched_sÿn_»q
) {

1247 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 12, 0))

1248 
	`cfg80211_sched_sÿn_¡İ³d
(
why
, 
»qid
);

1250 
	`cfg80211_sched_sÿn_¡İ³d
(
why
);

1253 
	}
}

1255 
	$¦si_sÿn_ş—nup
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

1257 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1258 
i
;

1259 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 9, 0))

1260 
cfg80211_sÿn_šfo
 
šfo
 = {.
abÜ‹d
 = 
çl£
};

1263 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_INIT_DEINIT
, "clean scan_data\n");

1265 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

1266 
i
 = 0; i < 
SLSI_SCAN_MAX
; i++) {

1267 ià((
ndev_vif
->
sÿn
[
i
].
sÿn_»q
 ||‚dev_vif->sÿn[i].
acs_»que¡
) &&

1268 !
sdev
->
mlme_blocked
)

1269 
	`¦si_mlme_d–_sÿn
(
sdev
, 
dev
, (
ndev_vif
->
iâum
 << 8 | 
i
), 
çl£
);

1270 
	`¦si_purge_sÿn_»suÉs
(
ndev_vif
, 
i
);

1271 ià(
ndev_vif
->
sÿn
[
i
].
sÿn_»q
 && i =ğ
SLSI_SCAN_HW_ID
) {

1272 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 9, 0))

1273 
šfo
.
abÜ‹d
 = 
Œue
;

1274 
	`cfg80211_sÿn_dÚe
(
ndev_vif
->
sÿn
[
i
].
sÿn_»q
, &
šfo
);

1276 
	`cfg80211_sÿn_dÚe
(
ndev_vif
->
sÿn
[
i
].
sÿn_»q
, 
Œue
);

1280 ià(
ndev_vif
->
sÿn
[
i
].
sched_»q
 && i =ğ
SLSI_SCAN_SCHED_ID
)

1281 
	`queue_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
sched_sÿn_¡İ_wk
);

1283 
ndev_vif
->
sÿn
[
i
].
sÿn_»q
 = 
NULL
;

1284 
	`kä“
(
ndev_vif
->
sÿn
[
i
].
acs_»que¡
);

1285 
ndev_vif
->
sÿn
[
i
].
acs_»que¡
 = 
NULL
;

1287 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

1288 
	}
}

1290 
	$¦si_¡İ_Ãt_dev_locked
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
boŞ
 
hw_avaabË
)

1292 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1294 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_INIT_DEINIT
, "Stİpšg‚‘dev_up_couÁ=%d, hw_avaabË = %d\n", 
sdev
->
Ãtdev_up_couÁ
, 
hw_avaabË
);

1296 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
sdev
->
¡¬t_¡İ_mu‹x
));

1298 ià(!
ndev_vif
->
is_avaabË
) {

1299 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_INIT_DEINIT
, "Not Available\n");

1303 ià(
	`WARN_ON
(!
sdev
->
Ãtdev_up_couÁ
)) {

1304 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_INIT_DEINIT
, "sdev->Ãtdev_up_couÁ=%d\n", 
sdev
->
Ãtdev_up_couÁ
);

1308 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


1309 ià(
ndev_vif
->
Œaffic_mÚ_¡©e
 !ğ
TRAFFIC_MON_CLIENT_STATE_LOW
) {

1310 
Ãtdev_vif
 *
tmp_ndev_vif
;

1311 
u8
 
i
;

1312 
u8
 
³rf_š_u£
 = 0;

1314 
ndev_vif
->
Œaffic_mÚ_¡©e
 = 
TRAFFIC_MON_CLIENT_STATE_LOW
;

1319 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

1320 ià(
sdev
->
Ãtdev
[
i
]) {

1321 
tmp_ndev_vif
 = 
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
i
]);

1322 ià(
tmp_ndev_vif
->
is_avaabË
 && (tmp_ndev_vif->
Œaffic_mÚ_¡©e
 !ğ
TRAFFIC_MON_CLIENT_STATE_LOW
)) {

1323 
³rf_š_u£
 = 1;

1328 ià(!
³rf_š_u£
)

1329 
	`¦si_h_£t_Çpi_ıu
(
sdev
, 0, 
çl£
);

1333 
	`¦si_sÿn_ş—nup
(
sdev
, 
dev
);

1335 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
£t_muÉiÿ¡_f‹r_wÜk
);

1336 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
upd©e_pkt_f‹r_wÜk
);

1337 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1338 
	`¦si_vif_ş—nup
(
sdev
, 
dev
, 
hw_avaabË
, 0);

1339 
	`¦si_¥šlock_lock
(&
sdev
->
Ãtdev_lock
);

1340 
ndev_vif
->
is_avaabË
 = 
çl£
;

1341 
sdev
->
Ãtdev_up_couÁ
--;

1342 
	`¦si_¥šlock_uÆock
(&
sdev
->
Ãtdev_lock
);

1343 #ifdeà
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL


1344 ià(
	`©omic_»ad
(&
ndev_vif
->
¬p_tx_couÁ
è&&‡tomic_»ad(&
sdev
->
ù¾_·u£_¡©e
))

1345 
	`scsc_wifi_uÅau£_¬p_q_®l_vif
(
sdev
);

1346 
	`©omic_£t
(&
ndev_vif
->
¬p_tx_couÁ
, 0);

1348 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1350 
	`com¶‘e_®l
(&
ndev_vif
->
sig_wa™
.
com¶‘iÚ
);

1351 
	`¦si_¡İ_ch
(
sdev
);

1352 
	}
}

1355 
	$¦si_¡İ_Ãt_dev
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

1357 
	`SLSI_MUTEX_LOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

1358 
	`¦si_¡İ_Ãt_dev_locked
(
sdev
, 
dev
, sdev->
»cov”y_¡©us
 ? 
çl£
 : 
Œue
);

1359 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

1360 
	}
}

1363 
	$¦si_¡İ
(
¦si_dev
 *
sdev
)

1365 
Ãt_deviû
 *
dev
;

1366 
i
;

1368 
	`SLSI_MUTEX_LOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

1369 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "Ãtdev_up_couÁ:%d\n", sdev->
Ãtdev_up_couÁ
);

1371 
	`com¶‘e_®l
(&
sdev
->
sig_wa™
.
com¶‘iÚ
);

1373 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1374 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

1375 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
i
);

1376 ià(
dev
)

1377 
	`¦si_¡İ_Ãt_dev_locked
(
sdev
, sdev->
Ãtdev
[
i
], 
çl£
);

1379 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1381 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

1382 
	}
}

1385 
u8
 *
	$¦si_mib_¦iû
(
¦si_dev
 *
sdev
, cÚ¡ 
u8
 *
d©a
, 
u32
 
Ëngth
, u32 *
p_·r£d_Ën
,

1386 
u32
 *
p_mib_¦iû_Ën
)

1388 cÚ¡ 
u8
 *
p
 = 
d©a
;

1389 
u8
 *
mib_¦iû
;

1390 
u32
 
mib_¦iû_Ën
 = 0;

1392 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

1394 ià(!
Ëngth
)

1395  
NULL
;

1397 
mib_¦iû
 = 
	`km®loc
(
Ëngth
 + 4, 
GFP_KERNEL
);

1398 ià(!
mib_¦iû
)

1399  
NULL
;

1401 
Ëngth
 >= 4) {

1402 
u16
 
psid
 = 
	`SLSI_BUFF_LE_TO_U16
(
p
);

1403 
u16
 
p¦’
 = (u16)(4 + 
	`SLSI_BUFF_LE_TO_U16
(&
p
[2]));

1405 ià(
p¦’
 & 0x1)

1406 
p¦’
++;

1408 ià(
psid
 & 
CSR_WIFI_SME_MIB2_HOST_PSID_MASK
) {

1412 
	#CSR_WIFI_HOSTIO_MIB_SET_MAX
 (1800)

	)

1413 ià((
mib_¦iû_Ën
 + 
p¦’
è> 
CSR_WIFI_HOSTIO_MIB_SET_MAX
)

1415 ià(
p¦’
 > 
Ëngth
 + 4) {

1416 
	`SLSI_ERR
(
sdev
, "Ëngth %u„—d from MIB f> s·û %u - cÜru± fe?\n", 
p¦’
, 
Ëngth
 + 4);

1417 
mib_¦iû_Ën
 = 0;

1420 
	`memıy
(&
mib_¦iû
[
mib_¦iû_Ën
], 
p
, 
p¦’
);

1421 
mib_¦iû_Ën
 +ğ
p¦’
;

1423 
p
 +ğ
p¦’
;

1424 
Ëngth
 -ğ
p¦’
;

1427 *
p_mib_¦iû_Ën
 = 
mib_¦iû_Ën
;

1428 *
p_·r£d_Ën
 = (
p
 - 
d©a
);

1430  
mib_¦iû
;

1431 
	}
}

1434 
	$¦si_mib_g‘_¶©fÜm
(
¦si_dev_mib_šfo
 *
mib_šfo
)

1436 
size_t
 
¶©_Çme_Ën
;

1437 
pos
 = 0;

1454 
mib_šfo
->
¶©fÜm
[0] = '\0';

1457 ià(
mib_šfo
->
mib_Ën
 < 12) {

1458 
	`SLSI_INFO_NODEV
("HCF fileoo short\n");

1459  -
EINVAL
;

1462 ià(
mib_šfo
->
mib_d©a
[
pos
++] != 0xFE ||

1463 
mib_šfo
->
mib_d©a
[
pos
++] != 0xFF) {

1464 
	`SLSI_INFO_NODEV
("No HCF version ID\n");

1465  -
EINVAL
;

1467 ià(
mib_šfo
->
mib_d©a
[
pos
++] != 0x01 ||

1468 
mib_šfo
->
mib_d©a
[
pos
++] != 0x00) {

1469 
	`SLSI_INFO_NODEV
("Bad†ength\n");

1470  -
EINVAL
;

1472 ià(
mib_šfo
->
mib_d©a
[
pos
++] != 0x01 ||

1473 
mib_šfo
->
mib_d©a
[
pos
++] != 0x00) {

1474 
	`SLSI_INFO_NODEV
("Bad version ID\n");

1475  -
EINVAL
;

1477 ià(
mib_šfo
->
mib_d©a
[
pos
++] != 0xFF ||

1478 
mib_šfo
->
mib_d©a
[
pos
++] != 0xFF) {

1479 
	`SLSI_INFO_NODEV
("No HCF…latform‚ame\n");

1480  -
EINVAL
;

1484 
¶©_Çme_Ën
 = 
mib_šfo
->
mib_d©a
[
pos
++];

1485 
¶©_Çme_Ën
 |ğ(
mib_šfo
->
mib_d©a
[
pos
++] << 16);

1488 ià(
¶©_Çme_Ën
 + 
pos
 > 
mib_šfo
->
mib_Ën
 ||…lat_name_len < 2) {

1489 
	`SLSI_ERR_NODEV
("Bad HCF FFFF key†ength %zu\n",

1490 
¶©_Çme_Ën
);

1491  -
EINVAL
;

1499 
	#SLSI_VLDATA_STRING
 0xA0

	)

1500 
	#SLSI_VLDATA_LEN
 0x17

	)

1502 
u8
 
vËn_hdr
 = 
mib_šfo
->
mib_d©a
[
pos
++];

1503 
u8
 
vËn_Ën
 = 
vËn_hdr
 & 
SLSI_VLDATA_LEN
;

1506 
¶©_Çme_Ën
--;

1508 
	`SLSI_DBG1_NODEV
(
SLSI_INIT_DEINIT
, "vlhd¸0x%x,†’ %u\n", 
vËn_hdr
, 
vËn_Ën
);

1511 ià(!(
vËn_hdr
 & 
SLSI_VLDATA_STRING
)) {

1512 
	`SLSI_ERR_NODEV
("NØ¡ršg vËÀh—d” 0x%x\n", 
vËn_hdr
);

1513  -
EINVAL
;

1517 ià(
vËn_Ën
 > 2) {

1518 
	`SLSI_ERR_NODEV
("ToØlÚg où‘ sŒšg h—d” %u\n", 
vËn_Ën
);

1519  -
EINVAL
;

1525 
pos
 +ğ
vËn_Ën
;

1526 
¶©_Çme_Ën
 -ğ
vËn_Ën
;

1531 
size_t
 
Œunc_Ën
 = 
¶©_Çme_Ën
;

1533 ià(
Œunc_Ën
 >ğ(
mib_šfo
->
¶©fÜm
))

1534 
Œunc_Ën
 = (
mib_šfo
->
¶©fÜm
) - 1;

1537 
	`memıy
(
mib_šfo
->
¶©fÜm
, &mib_šfo->
mib_d©a
[
pos
], 
Œunc_Ën
);

1538 
mib_šfo
->
¶©fÜm
[
Œunc_Ën
] = '\0';

1541 
	`SLSI_INFO_NODEV
("MIB…ÏtfÜm: %.*s\n", ()
¶©_Çme_Ën
, &
mib_šfo
->
mib_d©a
[
pos
]);

1543 
	`SLSI_DBG1_NODEV
(
SLSI_INIT_DEINIT
, "plat_name_len: %zu + %u\n",

1544 
¶©_Çme_Ën
, (plat_name_len & 1));

1548 
¶©_Çme_Ën
 += (plat_name_len & 1);

1549 
pos
 +ğ
¶©_Çme_Ën
;

1552 
mib_šfo
->
mib_d©a
 +ğ
pos
;

1553 
mib_šfo
->
mib_Ën
 -ğ
pos
;

1555 
	`SLSI_DBG1_NODEV
(
SLSI_INIT_DEINIT
, "Sk %d où‘ HCF…aylßd\n", 
pos
);

1558 
	}
}

1560 
	#MGT_HASH_SIZE_BYTES
 2

	)

1561 
	#MGT_HASH_OFFSET
 4

	)

1562 
	$¦si_mib_İ’_fe
(
¦si_dev
 *
sdev
, 
¦si_dev_mib_šfo
 *
mib_šfo
, cÚ¡ 
fœmw¬e
 **
fw
)

1564 
r
 = -1;

1565 cÚ¡ 
fœmw¬e
 *
e
 = 
NULL
;

1566 cÚ¡ *
mib_fe_ext
;

1567 
·th_Çme
[
MX_WLAN_FILE_PATH_LEN_MAX
];

1568 *
mib_fe_Çme
 = 
mib_šfo
->mib_file_name;

1569 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

1570 
u8
 
šdex
 = 
sdev
->
cŞËù_mib
.
num_fes
;

1571 
u8
 *
d©a
;

1574 ià(!
mib_fe_Çme
 || !
fw
)

1575  -
EINVAL
;

1576 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

1577 ià(
šdex
 > 
SLSI_WLAN_MAX_MIB_FILE
) {

1578 
	`SLSI_ERR
(
sdev
, "cŞËù mib index i šv®id:%d\n", 
šdex
);

1579  -
EINVAL
;

1582 
mib_šfo
->
mib_d©a
 = 
NULL
;

1583 
mib_šfo
->
mib_Ën
 = 0;

1584 
mib_šfo
->
mib_hash
 = 0;

1586 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "MIB f- Nam: %s\n", 
mib_fe_Çme
);

1589 
mib_fe_ext
 = 
	`¡¼chr
(
mib_fe_Çme
, '.');

1590 ià(!
mib_fe_ext
) {

1591 
	`SLSI_ERR
(
sdev
, "cÚfigu¿tiÚ fÇm'%s' inv®id\n", 
mib_fe_Çme
);

1592  -
EINVAL
;

1596 
	`sú´štf
(
·th_Çme
, 
MX_WLAN_FILE_PATH_LEN_MAX
, "wÏn/%s", 
mib_fe_Çme
);

1597 
	`SLSI_INFO
(
sdev
, "P©hØthMIB f: %s\n", 
·th_Çme
);

1599 
r
 = 
	`mx140_fe_»que¡_cÚf
(
sdev
->
maxw–l_cÜe
, &
e
, "wÏn", 
mib_fe_Çme
);

1600 ià(
r
 || (!
e
)) {

1601 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "Sk MIB dowÆßd‡ f% i NOT found\n", 
mib_fe_Çme
);

1602 *
fw
 = 
e
;

1603  
r
;

1606 
mib_šfo
->
mib_d©a
 = (
u8
 *)
e
->
d©a
;

1607 
mib_šfo
->
mib_Ën
 = 
e
->
size
;

1609 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

1610 
	`¥š_lock
(&
sdev
->
cŞËù_mib
.
š_cŞËùiÚ
);

1611 
	`mem£t
(&
sdev
->
cŞËù_mib
.
fe
[
šdex
].
fe_Çme
, 0, 32);

1612 
	`¢´štf
(&
sdev
->
cŞËù_mib
.
fe
[
šdex
].
fe_Çme
[0], 32, "%s", 
mib_fe_Çme
);

1613 
sdev
->
cŞËù_mib
.
fe
[
šdex
].
Ën
 = 
mib_šfo
->
mib_Ën
;

1614 
d©a
 = 
	`km®loc
(
mib_šfo
->
mib_Ën
, 
GFP_ATOMIC
);

1615 ià(!
d©a
) {

1616 
	`¥š_uÆock
(&
sdev
->
cŞËù_mib
.
š_cŞËùiÚ
);

1617 
cÚt
;

1619 
	`memıy
(
d©a
, 
mib_šfo
->
mib_d©a
, mib_šfo->
mib_Ën
);

1620 
sdev
->
cŞËù_mib
.
fe
[
šdex
].
d©a
 = data;

1621 
sdev
->
cŞËù_mib
.
num_fes
 += 1;

1622 
	`¥š_uÆock
(&
sdev
->
cŞËù_mib
.
š_cŞËùiÚ
);

1623 
cÚt
:

1626 ià(
mib_šfo
->
mib_Ën
 >= 8 &&

1628 
mib_šfo
->
mib_d©a
[7] == 1) {

1629 
i
;

1631 
mib_šfo
->
mib_hash
 = 0;

1633 
i
 = 0; i < 
MGT_HASH_SIZE_BYTES
; i++)

1634 
mib_šfo
->
mib_hash
 = (mib_šfo->mib_hash << 8è| mib_šfo->
mib_d©a
[
i
 + 
MGT_HASH_OFFSET
];

1636 
	`SLSI_INFO
(
sdev
, "MIB hash: 0x%.04x\n", 
mib_šfo
->
mib_hash
);

1638 
mib_šfo
->
mib_d©a
 += 8;

1639 
mib_šfo
->
mib_Ën
 -= 8;

1642 
	`¦si_mib_g‘_¶©fÜm
(
mib_šfo
);

1645 
	`SLSI_ERR
(
sdev
, "cÚfigu¿tiÚ f'%s' ha bad h—d”\n", 
mib_šfo
->
mib_fe_Çme
);

1646 
	`mx140_fe_»Ëa£_cÚf
(
sdev
->
maxw–l_cÜe
, 
e
);

1647  -
EINVAL
;

1650 *
fw
 = 
e
;

1652 
	}
}

1654 
	$¦si_mib_şo£_fe
(
¦si_dev
 *
sdev
, cÚ¡ 
fœmw¬e
 *
e
)

1656 
	`SLSI_DBG2
(
sdev
, 
SLSI_INIT_DEINIT
, "MIB clo£ %p\n", 
e
);

1658 ià(!
e
 || !
sdev
)

1659  -
EIO
;

1661 
	`mx140_fe_»Ëa£_cÚf
(
sdev
->
maxw–l_cÜe
, 
e
);

1664 
	}
}

1666 
	$¦si_mib_dowÆßd_fe
(
¦si_dev
 *
sdev
, 
¦si_dev_mib_šfo
 *
mib_šfo
)

1668 
r
 = -1;

1669 cÚ¡ 
fœmw¬e
 *
e
 = 
NULL
;

1670 
u8
 *
mib_¦iû
;

1671 
u32
 
mib_¦iû_Ën
, 
·r£d_Ën
;

1673 
r
 = 
	`¦si_mib_İ’_fe
(
sdev
, 
mib_šfo
, &
e
);

1674 ià(
r
)

1675  
r
;

1680 
mib_šfo
->
mib_Ën
 > 0) {

1681 
mib_¦iû
 = 
	`¦si_mib_¦iû
(
sdev
, 
mib_šfo
->
mib_d©a
, mib_šfo->
mib_Ën
, &
·r£d_Ën
, &
mib_¦iû_Ën
);

1682 ià(!
mib_¦iû
)

1684 ià(
mib_¦iû_Ën
 =ğ0 || mib_¦iû_ËÀ> 
mib_šfo
->
mib_Ën
) {

1686 
	`SLSI_ERR
(
sdev
, "¦si_mib_¦iû„‘uºed im¶ausibË %d\n", 
mib_¦iû_Ën
);

1687 
r
 = -
EINVAL
;

1688 
	`kä“
(
mib_¦iû
);

1691 
r
 = 
	`¦si_mlme_£t
(
sdev
, 
NULL
, 
mib_¦iû
, 
mib_¦iû_Ën
);

1692 
	`kä“
(
mib_¦iû
);

1693 ià(
r
 != 0)

1694 
	`SLSI_ERR
(
sdev
, "mlme set failed„=0x%x during downloading:'%s'\n",

1695 
r
, 
mib_šfo
->
mib_fe_Çme
);

1697 
mib_šfo
->
mib_d©a
 +ğ
·r£d_Ën
;

1698 
mib_šfo
->
mib_Ën
 -ğ
·r£d_Ën
;

1701 
	`¦si_mib_şo£_fe
(
sdev
, 
e
);

1703  
r
;

1704 
	}
}

1706 
	$¦si_g‘_suµÜ‹d_chªÃls
(
¦si_dev
 *
sdev
, 
¦si_mib_v®ue
 *
v®ues
, 
mib_šdex
)

1708 *
bªd
 = 
sdev
->
suµÜ‹d_5g_chªÃls
;

1709 
chª_couÁ
 = 0;

1710 
chª_¡¬t
 = 0;

1711 
i
 = 0;

1712 
j
 = 0;

1713 
šdex
 = 0;

1714 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1715 
k
 = 0;

1716 
šüem’t
 = 4;

1717 
buf_Ën
 = 150;

1718 *
suµÜ‹d_chªÃls_bufãr
 = 
NULL
;

1719 
buf_pos
 = 0;

1722 ià(
v®ues
[
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

1723 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_OCTET
);

1724 ià(
v®ues
[
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_OCTET
)

1728 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1729 
suµÜ‹d_chªÃls_bufãr
 = 
	`km®loc
(
buf_Ën
, 
GFP_KERNEL
);

1730 ià(!
suµÜ‹d_chªÃls_bufãr
)

1731  -
ENOMEM
;

1734 
sdev
->
bªd_5g_suµÜ‹d
 = 0;

1735 
	`mem£t
(
sdev
->
suµÜ‹d_2g_chªÃls
, 0, (sdev->supported_2g_channels));

1736 
	`mem£t
(
sdev
->
suµÜ‹d_5g_chªÃls
, 0, (sdev->supported_5g_channels));

1738 
i
 = 0; i < 
v®ues
[
mib_šdex
].
u
.
où‘V®ue
.
d©aL’gth
 / 2; i++) {

1740 ià(
v®ues
[
mib_šdex
].
u
.
où‘V®ue
.
d©a
[
i
 * 2] > 14 &&

1741 
v®ues
[
mib_šdex
].
u
.
où‘V®ue
.
d©a
[
i
 * 2 + 1] > 0) {

1742 
sdev
->
bªd_5g_suµÜ‹d
 = 1;

1746 
i
 = 0; i < 
v®ues
[
mib_šdex
].
u
.
où‘V®ue
.
d©aL’gth
; i += 2) {

1747 
chª_¡¬t
 = 
v®ues
[
mib_šdex
].
u
.
où‘V®ue
.
d©a
[
i
];

1748 
chª_couÁ
 = 
v®ues
[
mib_šdex
].
u
.
où‘V®ue
.
d©a
[
i
 + 1];

1749 
bªd
 = 
sdev
->
suµÜ‹d_5g_chªÃls
;

1750 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1751 
k
 = 0;

1752 ià(
chª_¡¬t
 < 15)

1753 
šüem’t
 = 1;

1755 
šüem’t
 = 4;

1757 ià(
chª_¡¬t
 < 15) {

1758 
šdex
 = 
chª_¡¬t
 - 1;

1759 
bªd
 = 
sdev
->
suµÜ‹d_2g_chªÃls
;

1760 } ià(
chª_¡¬t
 >= 36 && chan_start <= 48) {

1761 
šdex
 = (
chª_¡¬t
 - 36) / 4;

1762 } ià(
chª_¡¬t
 >= 52 && chan_start <= 64) {

1763 
šdex
 = ((
chª_¡¬t
 - 52) / 4) + 4;

1764 } ià(
chª_¡¬t
 >= 100 && chan_start <= 140) {

1765 
šdex
 = ((
chª_¡¬t
 - 100) / 4) + 8;

1766 } ià(
chª_¡¬t
 >= 149 && chan_start <= 165) {

1767 
šdex
 = ((
chª_¡¬t
 - 149) / 4) + 20;

1771 
j
 = 0; j < 
chª_couÁ
; j++) {

1772 
bªd
[
šdex
 + 
j
] = 1;

1773 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1774 
buf_pos
 +ğ
	`¢´štf
(
suµÜ‹d_chªÃls_bufãr
 + buf_pos,

1775 
buf_Ën
 - 
buf_pos
, "%d ", (
chª_¡¬t
 + 
k
));

1776 
k
 = k + 
šüem’t
;

1779 
sdev
->
’abËd_chªÃl_couÁ
 +ğ
chª_couÁ
;

1781 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1782 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Value for Supported Channels mib: %s\n",

1783 
suµÜ‹d_chªÃls_bufãr
);

1784 
	`kä“
(
suµÜ‹d_chªÃls_bufãr
);

1787 
	}
}

1789 
	$¦si_g‘_ht_vht_ÿ·b™›s
(
¦si_dev
 *
sdev
, 
¦si_mib_v®ue
 *
v®ues
, *
mib_šdex
)

1791 ià(
v®ues
[++*
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
)

1792 
sdev
->
fw_ht_’abËd
 = 
v®ues
[*
mib_šdex
].
u
.
boŞV®ue
;

1794 
	`SLSI_WARN
(
sdev
, "Error„eading HTƒnabled mib\n");

1795 ià(
v®ues
[++*
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
)

1796 
sdev
->
fw_vht_’abËd
 = 
v®ues
[*
mib_šdex
].
u
.
boŞV®ue
;

1798 
	`SLSI_WARN
(
sdev
, "Error„eading VHTƒnabled mib\n");

1799 ià(
v®ues
[++*
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_OCTET
) {

1800 ià(
v®ues
[*
mib_šdex
].
u
.
où‘V®ue
.
d©aL’gth
 >= 4)

1801 
	`memıy
(&
sdev
->
fw_ht_ÿp
, 
v®ues
[*
mib_šdex
].
u
.
où‘V®ue
.
d©a
, 4);

1803 
	`SLSI_WARN
(
sdev
, "Error„eading HT capabilities\n");

1805 
	`SLSI_WARN
(
sdev
, "Error„eading HT capabilities\n");

1807 ià(
v®ues
[++*
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_OCTET
) {

1808 ià(
v®ues
[*
mib_šdex
].
u
.
où‘V®ue
.
d©aL’gth
 >= 4)

1809 
	`memıy
(&
sdev
->
fw_vht_ÿp
, 
v®ues
[*
mib_šdex
].
u
.
où‘V®ue
.
d©a
, 4);

1811 
	`SLSI_WARN
(
sdev
, "Error„eading VHT capabilities\n");

1813 
	`SLSI_WARN
(
sdev
, "Error„eading VHT capabilities\n");

1815 
	}
}

1817 
	$¦si_g‘_mib_’Œy_v®ue
(
¦si_dev
 *
sdev
, 
¦si_mib_v®ue
 *
v®ues
)

1819 
mib_šdex
 = 0;

1820 
u16
 
num_ª‹Âa
 = 0;

1821 
u16
 
ª‹Âa_lw_b™
 = 0;

1822 
u16
 
ª‹Âa_hg_b™
 = 0;

1823 
r
 = 0;

1825 ià(
v®ues
[
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

1826 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_UINT
);

1827 
sdev
->
ch_šfo_mib
.
ch_v”siÚ
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

1831 
r
 = 
	`¦si_g‘_suµÜ‹d_chªÃls
(
sdev
, 
v®ues
, ++
mib_šdex
);

1832 ià(
r
 < 0)

1833  
r
;

1835 
	`¦si_g‘_ht_vht_ÿ·b™›s
(
sdev
, 
v®ues
, &
mib_šdex
);

1837 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

1838 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_UINT
);

1839 
sdev
->
¶©_šfo_mib
.
¶©_bud
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

1841 
	`SLSI_WARN
(
sdev
, "Error„eading Hardware…latform\n");

1844 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

1845 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_UINT
);

1846 
sdev
->
»g_dom_v”siÚ
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

1848 
	`SLSI_WARN
(
sdev
, "Error„eading Reg domain version\n");

1852 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

1853 
sdev
->
Çn_’abËd
 = 
v®ues
[
mib_šdex
].
u
.
boŞV®ue
;

1855 
sdev
->
Çn_’abËd
 = 
çl£
;

1856 
	`SLSI_WARN
(
sdev
, "Error„eading NANƒnabled mib\n");

1859 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

1860 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_UINT
);

1861 
sdev
->
fw_dw–l_time
 = (
v®ues
[
mib_šdex
].
u
.
uštV®ue
) * 1024;

1863 
	`SLSI_WARN
(
sdev
, "Error„eading UnifiForcedScheduleDuration\n");

1865 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


1866 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_OCTET
 && v®ues[mib_šdex].
u
.
où‘V®ue
.
d©aL’gth
 >= 8) {

1868 
	`memıy
(&
sdev
->
wifi_sh¬šg_5ghz_chªÃl
, 
v®ues
[
mib_šdex
].
u
.
où‘V®ue
.
d©a
, 8);

1869 
	`¦si_exŒaù_v®id_wifi_sh¬šg_chªÃls
(
sdev
);

1871 
	`SLSI_WARN
(
sdev
, "Error„eading 5Ghz Allowed Channels\n");

1875 #ifdeà
CONFIG_SCSC_WLAN_AP_INFO_FILE


1876 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
)

1877 
sdev
->
du®bªd_cÚcu¼’cy
 = 
v®ues
[
mib_šdex
].
u
.
boŞV®ue
;

1879 
	`SLSI_WARN
(
sdev
, "Error„eading dual band concurrency\n");

1881 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

1882 
sdev
->
soá­_max_ş›Á
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

1884 
	`SLSI_WARN
(
sdev
, "Error„eading SoftAP max client\n");

1886 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


1887 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
)

1888 
sdev
->
fw_mac_¿ndomiz©iÚ_’abËd
 = 
v®ues
[
mib_šdex
].
u
.
boŞV®ue
;

1890 
	`SLSI_WARN
(
sdev
, "Error„eading Mac Randomization Support\n");

1892 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

1893 
sdev
->
deviû_cÚfig
.
di§bË_ch12_ch13
 = 
v®ues
[
mib_šdex
].
u
.
boŞV®ue
;

1894 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
,

1896 
sdev
->
deviû_cÚfig
.
di§bË_ch12_ch13
);

1898 
	`SLSI_WARN
(
sdev
, "Error„eading default country without ch12/13 mib\n");

1900 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


1901 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
)

1902 
sdev
->
deviû_cÚfig
.
fw_’hªûd_¬p_d‘eù_suµÜ‹d
 = 
v®ues
[
mib_šdex
].
u
.
boŞV®ue
;

1904 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "Enhanced Arp Detect is disabled!\n");

1906 #ifdeà
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL


1908 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

1909 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_UINT
);

1910 
sdev
->
fw_max_¬p_couÁ
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

1911 ià(
sdev
->
fw_max_¬p_couÁ
 <ğ
SLSI_ARP_UNPAUSE_THRESHOLD
) {

1912 
	`SLSI_INFO
(
sdev
,

1914 
sdev
->
fw_max_¬p_couÁ
);

1915 
sdev
->
fw_max_¬p_couÁ
 = 0;

1918 
sdev
->
fw_max_¬p_couÁ
 = 0;

1919 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
,

1923 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
)

1924 
sdev
->
deviû_cÚfig
.
fw_­f_suµÜ‹d
 = 
v®ues
[
mib_šdex
].
u
.
boŞV®ue
;

1926 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "APF Support is disabled!\n");

1928 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
)

1929 
sdev
->
fw_SoáAp_2g_40mhz_’abËd
 = 
v®ues
[
mib_šdex
].
u
.
boŞV®ue
;

1931 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "40MHz for Soft AP is disabled!\n");

1934 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

1935 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_UINT
);

1936 
num_ª‹Âa
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

1937 
ª‹Âa_lw_b™
 = 
num_ª‹Âa
 & 0xff;

1938 
ª‹Âa_hg_b™
 = ((
num_ª‹Âa
 >> 8) & 0xff);

1939 
sdev
->
Îs_num_¿dio
 = (
ª‹Âa_lw_b™
 > 
ª‹Âa_hg_b™
) ?‡ntenna_lw_bit :‡ntenna_hg_bit;

1940 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "sdev->Îs_num_¿diØğ%d\n", sdev->
Îs_num_¿dio
);

1942 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "Failedo„ead‚umber of‡ntennas\n");

1945 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

1946 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_OCTET
);

1947 
sdev
->
fw_ext_ÿp_›_Ën
 = 
v®ues
[
mib_šdex
].
u
.
où‘V®ue
.
d©aL’gth
;

1948 
	`mem£t
(
sdev
->
fw_ext_ÿp_›
, 0, (sdev->fw_ext_cap_ie));

1949 
	`memıy
(
sdev
->
fw_ext_ÿp_›
, 
v®ues
[
mib_šdex
].
u
.
où‘V®ue
.
d©a
,

1950 
sdev
->
fw_ext_ÿp_›_Ën
);

1952 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "Failedo„ead Extended capabilities\n");

1955 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

1956 
sdev
->
igmp_ofæßd_aùiv©ed
 = 
v®ues
[
mib_šdex
].
u
.
boŞV®ue
;

1957 
	`SLSI_INFO
(
sdev
, "IGMP ofæßdšg i ’abËd:%d\n", sdev->
igmp_ofæßd_aùiv©ed
);

1959 
	`SLSI_INFO
(
sdev
, "IGMP offloading is disabled!\n");

1962  
r
;

1963 
	}
}

1965 
	$¦si_mib_š™Ÿl_g‘
(
¦si_dev
 *
sdev
)

1967 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

1968 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

1969 
rx_Ën
 = 0;

1970 
r
;

1971 
¦si_mib_v®ue
 *
v®ues
;

1973 cÚ¡ 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = {{ 
SLSI_PSID_UNIFI_CHIP_VERSION
, { 0, 0 } },

1974 { 
SLSI_PSID_UNIFI_SUPPORTED_CHANNELS
, { 0, 0 } },

1975 { 
SLSI_PSID_UNIFI_HT_ACTIVATED
, {0, 0} },

1976 { 
SLSI_PSID_UNIFI_VHT_ACTIVATED
, {0, 0} },

1977 { 
SLSI_PSID_UNIFI_HT_CAPABILITIES
, {0, 0} },

1978 { 
SLSI_PSID_UNIFI_VHT_CAPABILITIES
, {0, 0} },

1979 { 
SLSI_PSID_UNIFI_HARDWARE_PLATFORM
, {0, 0} },

1980 { 
SLSI_PSID_UNIFI_REG_DOM_VERSION
, {0, 0} },

1981 { 
SLSI_PSID_UNIFI_NAN_ACTIVATED
, {0, 0} },

1982 { 
SLSI_PSID_UNIFI_DEFAULT_DWELL_TIME
, {0, 0} },

1983 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


1984 { 
SLSI_PSID_UNIFI_WI_FI_SHARING5_GHZ_CHANNEL
, {0, 0} },

1986 #ifdeà
CONFIG_SCSC_WLAN_AP_INFO_FILE


1987 { 
SLSI_PSID_UNIFI_DUAL_BAND_CONCURRENCY
, {0, 0} },

1988 { 
SLSI_PSID_UNIFI_MAX_CLIENT
, {0, 0} },

1990 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


1991 { 
SLSI_PSID_UNIFI_MAC_ADDRESS_RANDOMISATION
, {0, 0} },

1993 { 
SLSI_PSID_UNIFI_DEFAULT_COUNTRY_WITHOUT_CH12_CH13
, {0, 0} },

1994 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


1995 { 
SLSI_PSID_UNIFI_ARP_DETECT_ACTIVATED
, {0, 0} },

1997 #ifdeà
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL


1998 { 
SLSI_PSID_UNIFI_ARP_OUTSTANDING_MAX
, {0, 0} },

2000 { 
SLSI_PSID_UNIFI_APF_ACTIVATED
, {0, 0} },

2001 { 
SLSI_PSID_UNIFI_SOFT_AP40_MHZ_ON24G
, {0, 0} },

2002 { 
SLSI_PSID_UNIFI_MAX_NUM_ANTENNA_TO_USE
, {0, 0} },

2003 { 
SLSI_PSID_UNIFI_EXTENDED_CAPABILITIES
, {0, 0} },

2004 { 
SLSI_PSID_UNIFI_IGMP_OFFLOAD_ACTIVATED
, {0, 0} },

2007 
r
 = 
	`¦si_mib_’code_g‘_li¡
(&
mib»q
, (
g‘_v®ues
è/ (
¦si_mib_g‘_’Œy
), get_values);

2008 ià(
r
 !ğ
SLSI_MIB_STATUS_SUCCESS
)

2009  -
ENOMEM
;

2011 
mibr¥
.
d©aL’gth
 = 250;

2012 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

2013 ià(!
mibr¥
.
d©a
) {

2014 
	`kä“
(
mib»q
.
d©a
);

2015  -
ENOMEM
;

2018 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
NULL
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
.d©a, mibr¥.d©aL’gth, &
rx_Ën
);

2019 
	`kä“
(
mib»q
.
d©a
);

2020 ià(
r
 == 0) {

2021 
mibr¥
.
d©aL’gth
 = (
u32
)
rx_Ën
;

2023 
v®ues
 = 
	`¦si_mib_decode_g‘_li¡
(&
mibr¥
, (
g‘_v®ues
è/ (
¦si_mib_g‘_’Œy
), get_values);

2025 ià(!
v®ues
) {

2026 
	`kä“
(
mibr¥
.
d©a
);

2027  -
EINVAL
;

2029 
r
 = 
	`¦si_g‘_mib_’Œy_v®ue
(
sdev
, 
v®ues
);

2030 
	`kä“
(
v®ues
);

2032 
	`kä“
(
mibr¥
.
d©a
);

2034  
r
;

2035 
	}
}

2037 
	$¦si_£t_mib_rßm
(
¦si_dev
 *
dev
, 
Ãt_deviû
 *
ndev
, 
u16
 
psid
, 
v®ue
)

2039 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

2040 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

2042 ià(
	`¦si_mib_’code_št
(&
mib_d©a
, 
psid
, 
v®ue
, 0è=ğ
SLSI_MIB_STATUS_SUCCESS
)

2043 ià(
mib_d©a
.
d©aL’gth
) {

2044 
”rÜ
 = 
	`¦si_mlme_£t
(
dev
, 
ndev
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

2045 ià(
”rÜ
)

2046 
	`SLSI_ERR
(
dev
, "E¼ S‘tšg MIB faed.ƒ¼Ü = %d\n", 
”rÜ
);

2047 
	`kä“
(
mib_d©a
.
d©a
);

2050  
”rÜ
;

2051 
	}
}

2053 #ifdeà
CONFIG_SCSC_WLAN_SET_PREFERRED_ANTENNA


2054 
	$¦si_£t_mib_´eã¼ed_ª‹Âa
(
¦si_dev
 *
dev
, 
u16
 
v®ue
)

2056 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

2057 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

2059 ià(
	`¦si_mib_’code_ušt
(&
mib_d©a
, 
SLSI_PSID_UNIFI_PREFERRED_ANTENNA_BITMAP
,

2060 
v®ue
, 0è=ğ
SLSI_MIB_STATUS_SUCCESS
)

2061 ià(
mib_d©a
.
d©aL’gth
) {

2062 
”rÜ
 = 
	`¦si_mlme_£t
(
dev
, 
NULL
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

2063 ià(
”rÜ
)

2064 
	`SLSI_ERR
(
dev
, "E¼ S‘tšg MIB faed.ƒ¼Ü = %d\n", 
”rÜ
);

2065 
	`kä“
(
mib_d©a
.
d©a
);

2068  
”rÜ
;

2069 
	}
}

2072 
	$¦si_»£t_throughput_¡©s
(
Ãt_deviû
 *
dev
)

2074 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2075 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

2076 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

2077 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

2079 ià(
	`¦si_mib_’code_št
(&
mib_d©a
, 
SLSI_PSID_UNIFI_THROUGHPUT_DEBUG
, 0, 0è=ğ
SLSI_MIB_STATUS_SUCCESS
)

2080 ià(
mib_d©a
.
d©aL’gth
) {

2081 
”rÜ
 = 
	`¦si_mlme_£t
(
sdev
, 
dev
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

2082 ià(
”rÜ
)

2083 
	`SLSI_ERR
(
sdev
, "E¼ S‘tšg MIB faed.ƒ¼Ü = %d\n", 
”rÜ
);

2084 
	`kä“
(
mib_d©a
.
d©a
);

2086 
	}
}

2088 
	$¦si_g‘_mib_rßm
(
¦si_dev
 *
sdev
, 
u16
 
psid
, *
mib_v®ue
)

2090 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

2091 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

2092 
rx_Ën
 = 0;

2093 
r
;

2094 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = { { 
psid
, { 0, 0 } } };

2096 
r
 = 
	`¦si_mib_’code_g‘_li¡
(&
mib»q
, (
g‘_v®ues
è/ (
¦si_mib_g‘_’Œy
), get_values);

2097 ià(
r
 !ğ
SLSI_MIB_STATUS_SUCCESS
)

2098  -
ENOMEM
;

2100 
mibr¥
.
d©aL’gth
 = 64;

2101 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

2102 ià(!
mibr¥
.
d©a
) {

2103 
	`kä“
(
mib»q
.
d©a
);

2104  -
ENOMEM
;

2107 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
NULL
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
.d©a, mibr¥.d©aL’gth, &
rx_Ën
);

2108 
	`kä“
(
mib»q
.
d©a
);

2110 ià(
r
 == 0) {

2111 
¦si_mib_v®ue
 *
v®ues
;

2113 
mibr¥
.
d©aL’gth
 = (
u32
)
rx_Ën
;

2115 
v®ues
 = 
	`¦si_mib_decode_g‘_li¡
(&
mibr¥
, (
g‘_v®ues
è/ (
¦si_mib_g‘_’Œy
), get_values);

2117 ià(!
v®ues
) {

2118 
	`kä“
(
mibr¥
.
d©a
);

2119  -
EINVAL
;

2122 
	`WARN_ON
(
v®ues
[0].
ty³
 =ğ
SLSI_MIB_TYPE_OCTET
 ||

2123 
v®ues
[0].
ty³
 =ğ
SLSI_MIB_TYPE_NONE
);

2125 ià(
v®ues
[0].
ty³
 =ğ
SLSI_MIB_TYPE_INT
)

2126 *
mib_v®ue
 = ()(
v®ues
->
u
.
štV®ue
);

2127 ià(
v®ues
[0].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

2128 *
mib_v®ue
 = ()(
v®ues
->
u
.
uštV®ue
);

2129 ià(
v®ues
[0].
ty³
 =ğ
SLSI_MIB_TYPE_BOOL
)

2130 *
mib_v®ue
 = ()(
v®ues
->
u
.
boŞV®ue
);

2132 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "MIB v®uğ%d\n", *
mib_v®ue
);

2133 
	`kä“
(
v®ues
);

2135 
	`SLSI_ERR
(
sdev
, "Mib„—d faed (”rÜ: %d)\n", 
r
);

2138 
	`kä“
(
mibr¥
.
d©a
);

2139  
r
;

2140 
	}
}

2142 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


2143 
	$¦si_mib_g‘_gsÿn_ÿp
(
¦si_dev
 *
sdev
, 
¦si_Æ_gsÿn_ÿ·b™›s
 *
ÿp
)

2145 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

2146 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

2147 
rx_Ën
 = 0;

2148 
r
;

2149 cÚ¡ 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = { { 
SLSI_PSID_UNIFI_GOOGLE_MAX_NUMBER_OF_PERIODIC_SCANS
, { 0, 0 } },

2150 { 
SLSI_PSID_UNIFI_GOOGLE_MAX_RSSI_SAMPLE_SIZE
, { 0, 0 } },

2151 { 
SLSI_PSID_UNIFI_GOOGLE_MAX_HOTLIST_APS
, { 0, 0 } },

2152 { 
SLSI_PSID_UNIFI_GOOGLE_MAX_SIGNIFICANT_WIFI_CHANGE_APS
, { 0, 0 } },

2153 { 
SLSI_PSID_UNIFI_GOOGLE_MAX_BSSID_HISTORY_ENTRIES
, { 0, 0 } },};

2155 
r
 = 
	`¦si_mib_’code_g‘_li¡
(&
mib»q
, (
g‘_v®ues
è/ (
¦si_mib_g‘_’Œy
), get_values);

2156 ià(
r
 !ğ
SLSI_MIB_STATUS_SUCCESS
)

2157  -
ENOMEM
;

2159 
mibr¥
.
d©aL’gth
 = 64;

2160 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

2161 ià(!
mibr¥
.
d©a
) {

2162 
	`kä“
(
mib»q
.
d©a
);

2163  -
ENOMEM
;

2166 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
NULL
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
.d©a, mibr¥.d©aL’gth, &
rx_Ën
);

2167 
	`kä“
(
mib»q
.
d©a
);

2169 ià(
r
 == 0) {

2170 
¦si_mib_v®ue
 *
v®ues
;

2172 
mibr¥
.
d©aL’gth
 = (
u32
)
rx_Ën
;

2174 
v®ues
 = 
	`¦si_mib_decode_g‘_li¡
(&
mibr¥
, (
g‘_v®ues
è/ (
¦si_mib_g‘_’Œy
), get_values);

2176 ià(!
v®ues
) {

2177 
	`kä“
(
mibr¥
.
d©a
);

2178  -
EINVAL
;

2181 ià(
v®ues
[0].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

2182 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[0].
ty³
, 
SLSI_MIB_TYPE_UINT
);

2183 
ÿp
->
max_sÿn_buck‘s
 = 
v®ues
[0].
u
.
uštV®ue
;

2186 ià(
v®ues
[1].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

2187 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[1].
ty³
, 
SLSI_MIB_TYPE_UINT
);

2188 
ÿp
->
max_rssi_§m¶e_size
 = 
v®ues
[1].
u
.
uštV®ue
;

2191 ià(
v®ues
[2].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

2192 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[2].
ty³
, 
SLSI_MIB_TYPE_UINT
);

2193 
ÿp
->
max_hÙli¡_­s
 = 
v®ues
[2].
u
.
uštV®ue
;

2196 ià(
v®ues
[3].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

2197 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[3].
ty³
, 
SLSI_MIB_TYPE_UINT
);

2198 
ÿp
->
max_signifiÿÁ_wifi_chªge_­s
 = 
v®ues
[3].
u
.
uštV®ue
;

2201 ià(
v®ues
[4].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

2202 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[4].
ty³
, 
SLSI_MIB_TYPE_UINT
);

2203 
ÿp
->
max_bssid_hi¡Üy_’Œ›s
 = 
v®ues
[4].
u
.
uštV®ue
;

2206 
	`kä“
(
v®ues
);

2208 
	`kä“
(
mibr¥
.
d©a
);

2209  
r
;

2210 
	}
}

2213 
	$¦si_mib_g‘_­f_ÿp
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

2215 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

2216 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

2217 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

2218 
d©a_Ëngth
 = 0;

2219 
r
 = 0;

2220 cÚ¡ 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = {

2221 { 
SLSI_PSID_UNIFI_APF_VERSION
, { 0, 0 } },

2222 { 
SLSI_PSID_UNIFI_APF_MAX_SIZE
, { 0, 0 } }

2225 
r
 = 
	`¦si_mib_’code_g‘_li¡
(&
mib»q
, ((
g‘_v®ues
è/ (
¦si_mib_g‘_’Œy
)),

2226 
g‘_v®ues
);

2227 ià(
r
 !ğ
SLSI_MIB_STATUS_SUCCESS
)

2228  -
ENOMEM
;

2231 
mibr¥
.
d©aL’gth
 = 30;

2232 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

2234 ià(!
mibr¥
.
d©a
) {

2235 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "failedo‡llocate memory\n");

2236 
	`kä“
(
mib»q
.
d©a
);

2237  -
ENOMEM
;

2240 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
dev
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
.data,

2241 
mibr¥
.
d©aL’gth
, &
d©a_Ëngth
);

2242 
	`kä“
(
mib»q
.
d©a
);

2244 ià(
r
 == 0) {

2245 
mibr¥
.
d©aL’gth
 = (
u32
)
d©a_Ëngth
;

2246 
v®ues
 = 
	`¦si_mib_decode_g‘_li¡
(&
mibr¥
,

2247 ((
g‘_v®ues
è/ (
¦si_mib_g‘_’Œy
)), get_values);

2248 ià(!
v®ues
) {

2249 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mib decode†ist failed\n");

2250 
	`kä“
(
mibr¥
.
d©a
);

2251  -
ENOMEM
;

2254 ià(
v®ues
[0].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

2255 
sdev
->
deviû_cÚfig
.
­f_ÿp
.
v”siÚ
 = 
v®ues
[0].
u
.
uštV®ue
;

2257 
	`SLSI_ERR
(
sdev
, "invalidype. index:%d\n", 0);

2258 ià(
v®ues
[1].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

2259 
sdev
->
deviû_cÚfig
.
­f_ÿp
.
max_Ëngth
 = 
v®ues
[1].
u
.
uštV®ue
;

2261 
	`SLSI_ERR
(
sdev
, "invalidype. index:%d\n", 1);

2263 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_g‘_»q faedÔesuÉ:0x%4x)\n", 
r
);

2266 
	`kä“
(
mibr¥
.
d©a
);

2267 
	`kä“
(
v®ues
);

2268  
r
;

2269 
	}
}

2271 
	$¦si_mib_g‘_¹t_ÿp
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_¹t_ÿ·b™›s
 *
ÿp
)

2273 
¦si_mib_d©a
 
suµÜ‹d_¹t_ÿ·b
 = { 0, 
NULL
 };

2274 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

2275 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

2276 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = { { 
SLSI_PSID_UNIFI_RTT_CAPABILITIES
, { 0, 0 } } };

2278 
mibr¥
.
d©aL’gth
 = 64;

2279 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

2280 ià(!
mibr¥
.
d©a
) {

2281 
	`SLSI_ERR
(
sdev
, "CªnÙ km®loø%d by‹s\n", 
mibr¥
.
d©aL’gth
);

2282 
	`kä“
(
mibr¥
.
d©a
);

2283  -
ENOMEM
;

2286 
v®ues
 = 
	`¦si_»ad_mibs
(
sdev
, 
dev
, 
g‘_v®ues
, 1, &
mibr¥
);

2287 ià(!
v®ues
) {

2288 
	`kä“
(
mibr¥
.
d©a
);

2289  -
EINVAL
;

2292 ià(
v®ues
[0].
ty³
 !ğ
SLSI_MIB_TYPE_OCTET
) {

2293 
	`SLSI_ERR
(
sdev
, "Inv®idy³ (%dèfÜ SLSI_PSID_UNIFI_RTT_CAPABILITIES", 
v®ues
[0].
ty³
);

2294 
	`kä“
(
mibr¥
.
d©a
);

2295 
	`kä“
(
v®ues
);

2296  -
EINVAL
;

2298 
suµÜ‹d_¹t_ÿ·b
 = 
v®ues
[0].
u
.
où‘V®ue
;

2299 ià(!
suµÜ‹d_¹t_ÿ·b
.
d©a
) {

2300 
	`kä“
(
mibr¥
.
d©a
);

2301 
	`kä“
(
v®ues
);

2302  -
EINVAL
;

2304 
ÿp
->
¹t_Úe_sided_suµÜ‹d
 = 
suµÜ‹d_¹t_ÿ·b
.
d©a
[0];

2305 
ÿp
->
¹t_ám_suµÜ‹d
 = 
suµÜ‹d_¹t_ÿ·b
.
d©a
[1];

2306 
ÿp
->
lci_suµÜt
 = 
suµÜ‹d_¹t_ÿ·b
.
d©a
[2];

2307 
ÿp
->
lü_suµÜt
 = 
suµÜ‹d_¹t_ÿ·b
.
d©a
[3];

2308 
ÿp
->
»¥Úd”_suµÜ‹d
 = 
suµÜ‹d_¹t_ÿ·b
.
d©a
[4];

2309 
ÿp
->
´—mbË_suµÜt
 = 
suµÜ‹d_¹t_ÿ·b
.
d©a
[5];

2310 
ÿp
->
bw_suµÜt
 = 
suµÜ‹d_¹t_ÿ·b
.
d©a
[6];

2311 
ÿp
->
mc_v”siÚ
 = 
suµÜ‹d_¹t_ÿ·b
.
d©a
[7];

2313 
	`kä“
(
v®ues
);

2314 
	`kä“
(
mibr¥
.
d©a
);

2316 
	}
}

2318 
¦si_³”
 *
	$¦si_³”_add
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
³”_add»ss
, 
u16
 
aid
)

2320 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2321 
¦si_³”
 *
³”
 = 
NULL
;

2322 
u16
 
queue£t
 = 0;

2324 ià(
	`WARN_ON
(!
aid
)) {

2325 
	`SLSI_NET_ERR
(
dev
, "Invalid‡id(0)„eceived\n");

2326  
NULL
;

2328 
queue£t
 = 
	`MAP_AID_TO_QS
(
aid
);

2331 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2333 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

2334  
NULL
;

2336 ià(!
³”_add»ss
) {

2337 
	`SLSI_NET_WARN
(
dev
, "Peer without‡ddress\n");

2338  
NULL
;

2341 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
³”_add»ss
);

2342 ià(
³”
) {

2343 ià(
ndev_vif
->
¡a
.
tdls_’abËd
 && (
³”
->
queue£t
 == 0)) {

2344 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "TDLSƒnabled‡nd its station queueset\n");

2346 
	`SLSI_NET_WARN
(
dev
, "P“¸(MAC:" 
MACSTR
 "è®»adyƒxi¡s\n", 
	`MAC2STR
(
³”_add»ss
));

2347  
NULL
;

2351 ià(
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
queue£t
)) {

2352 
	`SLSI_NET_WARN
(
dev
, "P“¸(queue£t:%dè®»adyƒxi¡s\n", 
queue£t
);

2353  
NULL
;

2356 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "%pM,‡id:%d\n", 
³”_add»ss
, 
aid
);

2358 
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
queue£t
];

2359 ià(!
³”
) {

2361 
	`SLSI_NET_ERR
(
dev
, "P“¸(queue£t:%dèi NULL\n", 
queue£t
);

2362  
NULL
;

2365 
³”
->
aid
 =‡id;

2366 
³”
->
queue£t
 = queueset;

2367 
	`SLSI_ETHER_COPY
(
³”
->
add»ss
, 
³”_add»ss
);

2368 
³”
->
assoc_›
 = 
NULL
;

2369 
³”
->
assoc_»¥_›
 = 
NULL
;

2370 
³”
->
is_wps
 = 
çl£
;

2371 
³”
->
cÚÃùed_¡©e
 = 
SLSI_STA_CONN_STATE_DISCONNECTED
;

2373 
	`¦si_³”_»£t_¡©s
(
sdev
, 
dev
, 
³”
);

2374 
³”
->
ndp_couÁ
 = 1;

2375 
	`¿‹lim™_¡©e_š™
(&
³”
->
sšfo_mib_g‘_rs
, 
SLSI_SINFO_MIB_ACCESS_TIMEOUT
, 0);

2377 ià(
	`scsc_wifi_fcq_ù¾_q_š™
(&
³”
->
ù¾_q
) < 0) {

2378 
	`SLSI_NET_ERR
(
dev
, "scsc_wifi_fcq_ctrl_q_init failed\n");

2379  
NULL
;

2382 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


2383 ià(
	`scsc_wifi_fcq_uniÿ¡_q£t_š™
(
dev
, &
³”
->
d©a_qs
,…“r->
queue£t
, 
sdev
, 
ndev_vif
->
iâum
,…eer) < 0) {

2385 ià(
	`scsc_wifi_fcq_uniÿ¡_q£t_š™
(
dev
, &
³”
->
d©a_qs
,…“r->
queue£t
, 
sdev
, 
ndev_vif
->
iâum
,…eer) < 0) {

2387 
	`SLSI_NET_ERR
(
dev
, "scsc_wifi_fcq_unicast_qset_init failed\n");

2388 
	`scsc_wifi_fcq_ù¾_q_deš™
(&
³”
->
ù¾_q
);

2389  
NULL
;

2397 ià(
ndev_vif
->
¡a
.
tdls_’abËd
)

2398 
ndev_vif
->
¡a
.
tdls_³”_¡a_»cÜds
++;

2400 
ndev_vif
->
³”_¡a_»cÜds
++;

2402 
ndev_vif
->
cfg80211_sšfo_g’”©iÚ
++;

2403 
	`skb_queue_h—d_š™
(&
³”
->
bufã»d_äames
);

2410 
³”
->
v®id
 = 
Œue
;

2412 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "ü—‹d stiÚ…“¸%pM AID:%d\n", 
³”
->
add»ss
, 
aid
);

2413  
³”
;

2414 
	}
}

2416 
	$¦si_³”_»£t_¡©s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
)

2418 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2420 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

2422 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "P“r:%pM\n", 
³”
->
add»ss
);

2424 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2426 
	`mem£t
(&
³”
->
sšfo
, 0x00, (peer->sinfo));

2427 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 0, 0))

2428 
³”
->
sšfo
.
fËd
 = 
	`BIT
(
NL80211_STA_INFO_RX_BYTES
) |

2429 
	`BIT
(
NL80211_STA_INFO_TX_BYTES
) |

2430 
	`BIT
(
NL80211_STA_INFO_RX_PACKETS
) |

2431 
	`BIT
(
NL80211_STA_INFO_TX_PACKETS
) |

2432 
	`BIT
(
NL80211_STA_INFO_RX_DROP_MISC
) |

2433 
	`BIT
(
NL80211_STA_INFO_TX_FAILED
) |

2434 
	`BIT
(
NL80211_STA_INFO_SIGNAL
) |

2435 
	`BIT
(
NL80211_STA_INFO_BSS_PARAM
);

2437 
³”
->
sšfo
.
fËd
 = 
STATION_INFO_RX_BYTES
 |

2438 
STATION_INFO_TX_BYTES
 |

2439 
STATION_INFO_RX_PACKETS
 |

2440 
STATION_INFO_TX_PACKETS
 |

2441 
STATION_INFO_RX_DROP_MISC
 |

2442 
STATION_INFO_TX_FAILED
 |

2443 
STATION_INFO_SIGNAL
 |

2444 
STATION_INFO_BSS_PARAM
;

2446 
	}
}

2448 
	$¦si_dump_¡©s
(
Ãt_deviû
 *
dev
)

2450 
	`SLSI_UNUSED_PARAMETER
(
dev
);

2452 
	`SLSI_INFO_NODEV
("¦si_hªged_ev’t_couÁ: %d\n", 
¦si_hªged_ev’t_couÁ
);

2453 
	}
}

2455 
	e¦si_wÏn_v’dÜ_©Œ_hªged_ev’t
 {

2456 
	mSLSI_WLAN_VENDOR_ATTR_HANGED_EVENT_PANIC_CODE
 = 1,

2457 
	mSLSI_WLAN_VENDOR_ATTR_HANGED_EVENT_MAX


2460 
	e¦si_wÏn_v’dÜ_©Œ_pow”_m—su»m’t_ev’t
 {

2461 
	mSLSI_WLAN_VENDOR_ATTR_POWER_MEASUREMENT_RESULT
 = 0,

2462 
	mSLSI_WLAN_VENDOR_ATTR_POWER_MEASUREMENT_RESULT_MAX
,

2465 #ià
defšed
(
CONFIG_SCSC_WLAN_ENHANCED_BIGDATA
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

2469 
	$¦si_sub¡™u‹_nuÎ
(*
s
, cÚ¡ 
c
, 
size_t
 
Ëngth
)

2471 
i
;

2473 
i
 = 0; i < 
Ëngth
; i++)

2474 ià(
s
[
i
] == '\0' || s[i] == ' ')

2475 
s
[
i
] = 
c
;

2476 
	}
}

2478 
	$¦si_fl_bigd©a_»cÜd
(
¦si_dev
 *
sdev
, 
scsc_hªged_»cÜd
 *
hr
, *
»suÉ
, 
u16
 
scsc_·nic_code
, cÚ¡ 
size_t
 
»suÉsz
)

2480 
Ëngth
 = (
scsc_hªged_»cÜd
);

2481 
i
 = 0;

2482 
v”siÚ_fw
[
HANGED_FW_VERSION_SIZE
] = {0};

2483 
num_»cÜds
;

2485 
to_hex_¡ršg
[
HANGED_PANIC_RECORD_HEX_SZ
 + 1];

2486 
scsc_fw_»cÜd_t
 
·nic_»cÜd_buf
[
HANGED_PANIC_RECORD_COUNT
];

2489 
	`SLSI_INFO
(
sdev
, "G’”©šg Hªged„ecÜd infÜm©iÚ [%d] [%d]\n", 
Ëngth
, 
»suÉsz
);

2490 
	`mem£t
(
»suÉ
, '\0', 
»suÉsz
);

2491 
	`mem£t
(
hr
, ' ', 
Ëngth
);

2492 
	`memıy
(
hr
->
v”siÚ
, 
HANGED_PANIC_VERSION
, (hr->version));

2493 
	`mxmª_g‘_fw_v”siÚ
(
v”siÚ_fw
, 
HANGED_FW_VERSION_SIZE
);

2494 
	`¢´štf
(
hr
->
fw_v”siÚ
, (hr->fw_v”siÚ), "%s", 
v”siÚ_fw
);

2497 
	`¦si_sub¡™u‹_nuÎ
(
hr
->
fw_v”siÚ
, '_', (hr->fw_version));

2499 
	`¢´štf
(
hr
->
ho¡_v”siÚ
, (hr->ho¡_v”siÚ), "%u.%u.%u.%u.%u", 
SCSC_RELEASE_PRODUCT
, 
SCSC_RELEASE_ITERATION
, 
SCSC_RELEASE_CANDIDATE
, 
SCSC_RELEASE_POINT
, 
SCSC_RELEASE_CUSTOMER
);

2503 
	`memıy
(
hr
->
off£t_d©a
, 
HANGED_OFFSET_DATA
, (HANGED_OFFSET_DATA));

2504 
	`¢´štf
(
hr
->
hªg_ty³
, (hr->hªg_ty³), "%2x", 
scsc_·nic_code
);

2507 
num_»cÜds
 = 
	`scsc_£rviû_g‘_·nic_»cÜd
(
sdev
->
£rviû
, (*)&
·nic_»cÜd_buf
[0], 
HANGED_PANIC_RECORD_SIZE
);

2508 ià(
num_»cÜds
 == 0) {

2509 
	`SLSI_INFO
(
sdev
, "scsc_service_get_panic_record failed -‚um_records = 0\n");

2510 
	`mem£t
(&
hr
->
·nic_»cÜd
, '0', 
HANGED_PANIC_RECORD_SIZE
);

2512 
i
 = 0; i < 
num_»cÜds
; i++) {

2514 
	`¢´štf
(
to_hex_¡ršg
, 
HANGED_PANIC_RECORD_HEX_SZ
 + 1, 
HANGED_PANIC_REC_FORMATTING
, 
·nic_»cÜd_buf
[
i
]);

2515 
	`memıy
(&
hr
->
·nic_»cÜd
[
i
 * 
HANGED_PANIC_RECORD_HEX_SZ
], 
to_hex_¡ršg
, (to_hex_string));

2518 
	`¢´štf
(
»suÉ
, 
»suÉsz
, "% 0 0 0 0 0 0 0 0 %s|%s|%s|%s", 
hr
->
hªg_ty³
, hr->
ho¡_v”siÚ
, hr->
fw_v”siÚ
, hr->
off£t_d©a
, hr->
·nic_»cÜd
);

2520 
	`SLSI_INFO
(
sdev
, "Hªged„ecÜd infÜm©iÚ sŒšg: %s\n", 
»suÉ
);

2521 
	}
}

2524 
	$¦si_£nd_hªged_v’dÜ_ev’t
(
¦si_dev
 *
sdev
, 
u16
 
scsc_·nic_code
)

2526 
sk_buff
 *
skb
;

2527 #ià
	`defšed
(
CONFIG_SCSC_WLAN_ENHANCED_BIGDATA
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

2528 
scsc_hªged_»cÜd
 
hr
;

2529 *
»suÉ
;

2530 
Ëngth
 = (
scsc_hªged_»cÜd
);

2532 
»suÉ
 = 
	`km®loc
(
Ëngth
, 
GFP_KERNEL
);

2533 ià(!
»suÉ
) {

2534 
	`SLSI_ERR_NODEV
("Failedo‡llocate„esult for vendor hangedƒvent");

2535  -
ENOMEM
;

2537 
	`¦si_fl_bigd©a_»cÜd
(
sdev
, &
hr
, 
»suÉ
, 
scsc_·nic_code
, 
Ëngth
);

2539 
Ëngth
 = (
scsc_·nic_code
);

2542 
¦si_hªged_ev’t_couÁ
++;

2543 
	`SLSI_INFO
(
sdev
, "S’dšg SLSI_NL80211_VENDOR_HANGED_EVENT , couÁ: %d,„—sÚ =0x%2x\n", 
¦si_hªged_ev’t_couÁ
, 
scsc_·nic_code
);

2545 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

2546 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
Ëngth
, 
SLSI_NL80211_VENDOR_HANGED_EVENT
, 
GFP_KERNEL
);

2548 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
Ëngth
, 
SLSI_NL80211_VENDOR_HANGED_EVENT
, 
GFP_KERNEL
);

2550 ià(!
skb
) {

2551 
	`SLSI_ERR_NODEV
("Failedo‡llocate SKB for vendor hangedƒvent");

2552 #ià
	`defšed
(
CONFIG_SCSC_WLAN_ENHANCED_BIGDATA
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

2554 
	`kä“
(
»suÉ
);

2556  -
ENOMEM
;

2559 #ià
	`defšed
(
CONFIG_SCSC_WLAN_ENHANCED_BIGDATA
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

2560 ià(
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_HANGED_EVENT_PANIC_CODE
, 
Ëngth
, 
»suÉ
)) {

2561 
	`kä“
(
»suÉ
);

2563 ià(
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_HANGED_EVENT_PANIC_CODE
, 
Ëngth
, &
scsc_·nic_code
)) {

2565 
	`SLSI_ERR_NODEV
("Failed‚la_put for…anic code\n");

2566 
	`kä“_skb
(
skb
);

2567  -
EINVAL
;

2569 
	`cfg80211_v’dÜ_ev’t
(
skb
, 
GFP_KERNEL
);

2571 #ià
	`defšed
(
CONFIG_SCSC_WLAN_ENHANCED_BIGDATA
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

2572 
	`kä“
(
»suÉ
);

2576 
	}
}

2578 
	$¦si_£nd_pow”_m—su»m’t_v’dÜ_ev’t
(
¦si_dev
 *
sdev
, 
s16
 
pow”_š_db
)

2580 
sk_buff
 *
skb
;

2581 
u8
 
”r
 = 0;

2583 
	`SLSI_INFO
(
sdev
, "S’dšg SLSI_NL80211_VENDOR_POWER_MEASUREMENT_EVENT…ow” = %d dB\n", 
pow”_š_db
);

2585 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

2586 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, (
pow”_š_db
),

2587 
SLSI_NL80211_VENDOR_POWER_MEASUREMENT_EVENT
, 
GFP_KERNEL
);

2589 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, (
pow”_š_db
),

2590 
SLSI_NL80211_VENDOR_POWER_MEASUREMENT_EVENT
, 
GFP_KERNEL
);

2592 ià(!
skb
) {

2593 
	`SLSI_ERR_NODEV
("Failedo‡llocate SKB for…ower measurementƒvent");

2594  -
ENOMEM
;

2596 
”r
 = 
	`Æa_put_s16
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_POWER_MEASUREMENT_RESULT
, 
pow”_š_db
);

2598 ià(
”r
) {

2599 
	`SLSI_ERR_NODEV
("Faed‚Ï_puˆfÜ…ow” m—su»m’ˆ»suÉ w™hƒ¼Ü: %d\n", 
”r
);

2600 
	`kä“_skb
(
skb
);

2601  -
EINVAL
;

2603 
	`cfg80211_v’dÜ_ev’t
(
skb
, 
GFP_KERNEL
);

2605 
	}
}

2607 #ià
defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

2608 
	$¦si_£nd_fÜw¬d_b—cÚ_v’dÜ_ev’t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

2609 cÚ¡ 
u8
 *
ssid
, cÚ¡ 
ssid_Ën
, cÚ¡ u8 *
bssid
, u8 
chªÃl
,

2610 cÚ¡ 
u16
 
b—cÚ_št
, cÚ¡ 
u64
 
time¡amp
, cÚ¡ u64 
sys_time
)

2612 
sk_buff
 *
skb
;

2613 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2614 
u8
 
”r
 = 0;

2616 
	`SLSI_DBG2
(
sdev
, 
SLSI_CFG80211
, "Sending SLSI_NL80211_VENDOR_FORWARD_BEACON\n");

2618 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

2619 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, &
ndev_vif
->
wdev
, 
NLMSG_DEFAULT_SIZE
,

2620 
SLSI_NL80211_VENDOR_FORWARD_BEACON
, 
GFP_KERNEL
);

2622 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
,

2623 
SLSI_NL80211_VENDOR_FORWARD_BEACON
, 
GFP_KERNEL
);

2625 ià(!
skb
) {

2626 
	`SLSI_ERR_NODEV
("Failedo‡llocate SKB for vendor forward_beaconƒvent\n");

2627  -
ENOMEM
;

2630 
”r
 |ğ
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_SSID
, 
ssid_Ën
, 
ssid
);

2631 
”r
 |ğ
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_BSSID
, 
ETH_ALEN
, 
bssid
);

2632 
”r
 |ğ
	`Æa_put_u8
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_CHANNEL
, 
chªÃl
);

2633 
”r
 |ğ
	`Æa_put_u16
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_BCN_INTERVAL
, 
b—cÚ_št
);

2634 
”r
 |ğ
	`Æa_put_u32
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_TIME_STAMP1
, (
time¡amp
 & 0x00000000FFFFFFFF));

2635 
”r
 |ğ
	`Æa_put_u32
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_TIME_STAMP2
,

2636 ((
time¡amp
 >> 32) & 0x00000000FFFFFFFF));

2637 
”r
 |ğ
	`Æa_put_u64_64b™
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_SYS_TIME
, 
sys_time
, 0);

2639 ià(
”r
) {

2640 
	`SLSI_ERR_NODEV
("Failed‚la_put for forward_beacon\n");

2641 
	`kä“_skb
(
skb
);

2642  -
EINVAL
;

2644 
	`cfg80211_v’dÜ_ev’t
(
skb
, 
GFP_KERNEL
);

2646 
	}
}

2648 
	$¦si_£nd_fÜw¬d_b—cÚ_abÜt_v’dÜ_ev’t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
»asÚ_code
)

2650 
sk_buff
 *
skb
;

2651 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2652 
u8
 
”r
 = 0;

2654 
	`SLSI_INFO
(
sdev
, "Sending SLSI_NL80211_VENDOR_FORWARD_BEACON_ABORT\n");

2656 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

2657 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, &
ndev_vif
->
wdev
, (
»asÚ_code
),

2658 
SLSI_NL80211_VENDOR_FORWARD_BEACON_ABORT
, 
GFP_KERNEL
);

2660 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, (
»asÚ_code
),

2661 
SLSI_NL80211_VENDOR_FORWARD_BEACON_ABORT
, 
GFP_KERNEL
);

2663 ià(!
skb
) {

2664 
	`SLSI_ERR_NODEV
("Failedo‡llocate SKB for vendor forward_beacon_abortƒvent\n");

2665  -
ENOMEM
;

2668 
”r
 = 
	`Æa_put_u16
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_ABORT
, 
»asÚ_code
);

2670 ià(
”r
) {

2671 
	`SLSI_ERR_NODEV
("Failed‚la_put for beacon_recv_abort\n");

2672 
	`kä“_skb
(
skb
);

2673  -
EINVAL
;

2675 
	`cfg80211_v’dÜ_ev’t
(
skb
, 
GFP_KERNEL
);

2677 
	}
}

2680 #ifdeà
CONFIG_SCSC_WLAN_HANG_TEST


2681 
	$¦si_‹¡_£nd_hªged_v’dÜ_ev’t
(
Ãt_deviû
 *
dev
)

2683 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2685 
	`SLSI_INFO
(
ndev_vif
->
sdev
, "Test FORCE HANG\n");

2686  
	`¦si_£nd_hªged_v’dÜ_ev’t
(
ndev_vif
->
sdev
, 
SCSC_PANIC_CODE_HOST
 << 15);

2687 
	}
}

2690 
	$¦si_£t_ext_ÿp
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
›s
, 
›_Ën
, cÚ¡ u8 *
ext_ÿp_mask
)

2692 cÚ¡ 
u8
 *
ext_ÿ·b_›
;

2693 
r
 = 0;

2695 
ext_ÿ·b_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_EXT_CAPABILITY
, 
›s
, 
›_Ën
);

2696 ià(
ext_ÿ·b_›
) {

2697 
u8
 
ext_ÿp_›_Ën
;

2698 
i
 = 0;

2699 
boŞ
 
£t_ext_ÿp
 = 
çl£
;

2701 ià(
›_Ën
 - (
ext_ÿ·b_›
 - 
›s
) < 2) {

2702 
	`SLSI_WARN
(
sdev
,

2703 "ERR: ibufã¸ov”æow.†’:%d, ie_pos:%d\n", 
›_Ën
, 
ext_ÿ·b_›
 - 
›s
);

2704  -
EINVAL
;

2707 
ext_ÿp_›_Ën
 = 
ext_ÿ·b_›
[1];

2708 ià(
ext_ÿ·b_›
 - 
›s
 + 
ext_ÿp_›_Ën
 > 
›_Ën
) {

2709 
	`SLSI_WARN
(
sdev
, "ERR: IeL’(%dè< bufæ’(%d)\n", 
›_Ën
, 
ext_ÿ·b_›
 - 
›s
 + 
ext_ÿp_›_Ën
);

2710  -
EINVAL
;

2712 
ext_ÿ·b_›
 += 2;

2713 
i
 = 0; i < 
ext_ÿp_›_Ën
 && i < 
	`ARRAY_SIZE
(
sdev
->
fw_ext_ÿp_›
); i++) {

2717 ià((~
ext_ÿp_mask
[
i
] & 
ext_ÿ·b_›
[i]è&& !(~ext_ÿp_mask[i] & 
sdev
->
fw_ext_ÿp_›
[i])) {

2718 
£t_ext_ÿp
 = 
Œue
;

2719 
sdev
->
fw_ext_ÿp_›
[
i
] = sdev->fw_ext_ÿp_›[i] | 
ext_ÿ·b_›
[i];

2722 ià(
£t_ext_ÿp
)

2723 
r
 = 
	`¦si_mlme_£t_ext_ÿ·b
(
sdev
, 
dev
, sdev->
fw_ext_ÿp_›
, sdev->
fw_ext_ÿp_›_Ën
);

2725  
r
;

2726 
	}
}

2728 
boŞ
 
	$¦si_£¬ch_›s_fÜ_qos_šdiÿtÜs
(
¦si_dev
 *
sdev
, 
u8
 *
›s
, 
›s_Ën
)

2730 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

2732 ià(
	`cfg80211_fšd_›
(
WLAN_EID_HT_CAPABILITY
, 
›s
, 
›s_Ën
)) {

2733 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "QOSƒnabled dueo WLAN_EID_HT_CAPABILITY\n");

2734  
Œue
;

2736 ià(
	`cfg80211_fšd_›
(
WLAN_EID_VHT_CAPABILITY
, 
›s
, 
›s_Ën
)) {

2737 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "QOSƒnabled dueo WLAN_EID_VHT_CAPABILITY\n");

2738  
Œue
;

2740 ià(
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WMM
, 
›s
, 
›s_Ën
)) {

2741 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "QOSƒnabled dueo WLAN_OUI_TYPE_MICROSOFT_WMM\n");

2742  
Œue
;

2744  
çl£
;

2745 
	}
}

2747 
	$¦si_³”_upd©e_assoc_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
, 
sk_buff
 *
skb
)

2749 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2750 
u16
 
id
 = 
	`çpi_g‘_u16
(
skb
, id);

2753 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2755 
id
) {

2756 
MLME_CONNECTED_IND
:

2757 
MLME_PROCEDURE_STARTED_IND
:

2758 ià(
	`WARN_ON
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_AP
 &&

2759 
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
)) {

2760 
	`kä“_skb
(
skb
);

2765 
	`kä“_skb
(
skb
);

2766 
	`WARN_ON
(1);

2770 
	`kä“_skb
(
³”
->
assoc_›
);

2771 
³”
->
assoc_›
 = 
NULL
;

2772 
³”
->
ÿ·b™›s
 = 0;

2773 
³”
->
sšfo
.
assoc_»q_›s
 = 
NULL
;

2774 
³”
->
sšfo
.
assoc_»q_›s_Ën
 = 0;

2776 ià(
	`çpi_g‘_d©®’
(
skb
)) {

2777 
mgmt_hdr_Ën
;

2778 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

2779 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2782 
	`skb_puÎ
(
skb
, 
	`çpi_g‘_sigËn
(skb));

2784 ià(
	`›“80211_is_assoc_»q
(
mgmt
->
äame_cÚŒŞ
)) {

2785 
mgmt_hdr_Ën
 = (
mgmt
->
u
.
assoc_»q
.
v¬ŸbË
 - (
u8
 *)mgmt);

2786 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
)

2787 
³”
->
ÿ·b™›s
 = 
	`Ë16_to_ıu
(
mgmt
->
u
.
assoc_»q
.
ÿ·b_šfo
);

2788 } ià(
	`›“80211_is_»assoc_»q
(
mgmt
->
äame_cÚŒŞ
)) {

2789 
mgmt_hdr_Ën
 = (
mgmt
->
u
.
»assoc_»q
.
v¬ŸbË
 - (
u8
 *)mgmt);

2790 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
)

2791 
³”
->
ÿ·b™›s
 = 
	`Ë16_to_ıu
(
mgmt
->
u
.
»assoc_»q
.
ÿ·b_šfo
);

2793 
	`WARN_ON
(1);

2794 
	`kä“_skb
(
skb
);

2798 
	`skb_puÎ
(
skb
, 
mgmt_hdr_Ën
);

2800 
³”
->
assoc_›
 = 
skb
;

2801 
³”
->
sšfo
.
assoc_»q_›s
 = 
skb
->
d©a
;

2802 
³”
->
sšfo
.
assoc_»q_›s_Ën
 = 
skb
->
Ën
;

2803 #ià(
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(4, 0, 0))

2804 
³”
->
sšfo
.
fËd
 |ğ
STATION_INFO_ASSOC_REQ_IES
;

2806 
³”
->
qos_’abËd
 = 
	`¦si_£¬ch_›s_fÜ_qos_šdiÿtÜs
(
sdev
, 
skb
->
d©a
, skb->
Ën
);

2808 
	}
}

2810 
	$¦si_³”_upd©e_assoc_r¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
, 
sk_buff
 *
skb
)

2812 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2813 
u16
 
id
 = 
	`çpi_g‘_u16
(
skb
, id);

2815 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

2818 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2820 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
)

2821 
ex™_w™h_w¬nÚ
;

2823 ià(
id
 !ğ
MLME_CONNECT_IND
 && id !ğ
MLME_ROAMED_IND
 && id !ğ
MLME_REASSOCIATE_IND
) {

2824 
	`SLSI_NET_ERR
(
dev
, "UÃx³ùed id =0x%4x\n", 
id
);

2825 
ex™_w™h_w¬nÚ
;

2828 
	`kä“_skb
(
³”
->
assoc_»¥_›
);

2829 
³”
->
assoc_»¥_›
 = 
NULL
;

2830 
³”
->
ÿ·b™›s
 = 0;

2831 ià(
	`çpi_g‘_d©®’
(
skb
)) {

2832 
mgmt_hdr_Ën
;

2833 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

2836 
	`skb_puÎ
(
skb
, 
	`çpi_g‘_sigËn
(skb));

2838 ià(
	`›“80211_is_assoc_»¥
(
mgmt
->
äame_cÚŒŞ
)) {

2839 
mgmt_hdr_Ën
 = (
mgmt
->
u
.
assoc_»¥
.
v¬ŸbË
 - (
u8
 *)mgmt);

2840 
³”
->
ÿ·b™›s
 = 
	`Ë16_to_ıu
(
mgmt
->
u
.
assoc_»¥
.
ÿ·b_šfo
);

2841 } ià(
	`›“80211_is_»assoc_»¥
(
mgmt
->
äame_cÚŒŞ
)) {

2842 
mgmt_hdr_Ën
 = (
mgmt
->
u
.
»assoc_»¥
.
v¬ŸbË
 - (
u8
 *)mgmt);

2843 
³”
->
ÿ·b™›s
 = 
	`Ë16_to_ıu
(
mgmt
->
u
.
»assoc_»¥
.
ÿ·b_šfo
);

2845 
ex™_w™h_w¬nÚ
;

2848 
	`skb_puÎ
(
skb
, 
mgmt_hdr_Ën
);

2849 
³”
->
assoc_»¥_›
 = 
skb
;

2853 
ex™_w™h_w¬nÚ
:

2854 
	`WARN_ON
(1);

2855 
	`kä“_skb
(
skb
);

2856 
	}
}

2858 
	$¦si_³”_»move
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
)

2860 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2861 
sk_buff
 *
buff_äame
;

2863 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

2866 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2868 ià(!
³”
) {

2869 
	`SLSI_NET_WARN
(
dev
, "peer=NULL");

2870  -
EINVAL
;

2873 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "%pM\n", 
³”
->
add»ss
);

2875 
buff_äame
 = 
	`skb_dequeue
(&
³”
->
bufã»d_äames
);

2876 
buff_äame
) {

2877 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "FLUSHING BUFFERED FRAMES\n");

2878 
	`kä“_skb
(
buff_äame
);

2879 
buff_äame
 = 
	`skb_dequeue
(&
³”
->
bufã»d_äames
);

2886 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

2887 
	`¦si_rx_ba_¡İ_®l
(
dev
, 
³”
);

2888 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

2893 
³”
->
v®id
 = 
çl£
;

2894 
³”
->
is_wps
 = 
çl£
;

2895 
³”
->
cÚÃùed_¡©e
 = 
SLSI_STA_CONN_STATE_DISCONNECTED
;

2897 ià(
	`¦si_is_tdls_³”
(
dev
, 
³”
))

2898 
ndev_vif
->
¡a
.
tdls_³”_¡a_»cÜds
--;

2900 
ndev_vif
->
³”_¡a_»cÜds
--;

2902 
ndev_vif
->
cfg80211_sšfo_g’”©iÚ
++;

2904 
	`scsc_wifi_fcq_q£t_deš™
(
dev
, &
³”
->
d©a_qs
, 
sdev
, 
ndev_vif
->
iâum
,…eer);

2905 
	`scsc_wifi_fcq_ù¾_q_deš™
(&
³”
->
ù¾_q
);

2907 
	`kä“_skb
(
³”
->
assoc_›
);

2908 
	`kä“_skb
(
³”
->
assoc_»¥_›
);

2909 
	`mem£t
(
³”
, 0x00, (*peer));

2912 
	}
}

2914 
	$¦si_vif_aùiv©ed
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

2916 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2918 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

2921 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2924 
	`WARN_ON
(
ndev_vif
->
³”_¡a_»cÜds
);

2926 ià(
	`WARN_ON
(
ndev_vif
->
aùiv©ed
))

2927  -
EALREADY
;

2929 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
) {

2931 ià(
	`scsc_wifi_fcq_muÉiÿ¡_q£t_š™
(
dev
, &
ndev_vif
->
­
.
group_d©a_qs
, 
sdev
,‚dev_vif->
iâum
) < 0)

2932  -
EFAULT
;

2934 #ifdeà
CONFIG_SCSC_WLAN_MAC_ACL_PER_MAC


2935 
	`kä“
(
ndev_vif
->
­
.
aş_d©a_bÏckli¡
);

2936 
ndev_vif
->
­
.
aş_d©a_bÏckli¡
 = 
NULL
;

2940 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

2942 
	`WARN_ON
(
ndev_vif
->
¡a
.
tdls_³”_¡a_»cÜds
);

2944 
ndev_vif
->
¡a
.
tdls_³”_¡a_»cÜds
 = 0;

2945 
ndev_vif
->
¡a
.
tdls_’abËd
 = 
çl£
;

2946 
ndev_vif
->
¡a
.
rßm_š_´og»ss
 = 
çl£
;

2947 
ndev_vif
->
¡a
.
nd_ofæßd_’abËd
 = 
Œue
;

2949 
	`mem£t
(
ndev_vif
->
¡a
.
k“·live_ho¡_g
, 0, (ndev_vif->sta.keepalive_host_tag));

2952 
ndev_vif
->
cfg80211_sšfo_g’”©iÚ
 = 0;

2953 
ndev_vif
->
³”_¡a_»cÜds
 = 0;

2954 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

2955 
ndev_vif
->
£t_tid_©Œ
.
mode
 = 
SLSI_NETIF_SET_TID_OFF
;

2956 
ndev_vif
->
£t_tid_©Œ
.
uid
 = 0;

2957 
ndev_vif
->
£t_tid_©Œ
.
tid
 = 0;

2958 
ndev_vif
->
aùiv©ed
 = 
Œue
;

2960 
	}
}

2962 
	$¦si_vif_d—ùiv©ed
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

2964 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2965 
i
 = 0;

2968 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2971 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

2972 
ndev_vif
->
¡a
.
group_key_£t
 = 
çl£
;

2973 
ndev_vif
->
¡a
.
w•_key_£t
 = 
çl£
;

2974 
ndev_vif
->
¡a
.
vif_¡©us
 = 
SLSI_VIF_STATUS_UNSPECIFIED
;

2975 
	`mem£t
(
ndev_vif
->
¡a
.
k“·live_ho¡_g
, 0, (ndev_vif->sta.keepalive_host_tag));

2978 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
)

2979 
	`ÿc_d–‘e_t¥ec_li¡
(
sdev
);

2981 ià(
ndev_vif
->
¡a
.
tdls_’abËd
)

2982 
	`WARN
(
ndev_vif
->
¡a
.
tdls_³”_¡a_»cÜds
, "vif:%d,dls_³”_¡a_»cÜds:%d",‚dev_vif->
iâum
,‚dev_vif->sta.tdls_peer_sta_records);

2984 ià(
ndev_vif
->
¡a
.
¡a_bss
) {

2985 
	`¦si_cfg80211_put_bss
(
sdev
->
why
, 
ndev_vif
->
¡a
.
¡a_bss
);

2986 
ndev_vif
->
¡a
.
¡a_bss
 = 
NULL
;

2988 
ndev_vif
->
¡a
.
tdls_’abËd
 = 
çl£
;

2989 #ià
	`defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

2990 
ndev_vif
->
is_ws_ruÂšg
 = 
çl£
;

2992 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


2993 ià(
ndev_vif
->
¡a
.
r¢_›
) {

2994 
	`kä“
(
ndev_vif
->
¡a
.
r¢_›
);

2995 
ndev_vif
->
¡a
.
r¢_›
 = 
NULL
;

3001 
ndev_vif
->
aùiv©ed
 = 
çl£
;

3002 #iâdeà
CONFIG_SCSC_WLAN_RX_NAPI


3003 
	`skb_queue_purge
(&
ndev_vif
->
rx_d©a
.
queue
);

3005 
i
 = 0; i < (
SLSI_ADHOC_PEER_CONNECTIONS_MAX
); i++) {

3006 
¦si_³”
 *
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
i
];

3008 ià(
³”
 &&…“r->
v®id
) {

3009 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && 
³”
->
assoc_›
)

3010 
	`cfg80211_d–_¡a
(
dev
, 
³”
->
add»ss
, 
GFP_KERNEL
);

3012 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

3013 
	`¦si_³”_»move
(
sdev
, 
dev
, 
³”
);

3014 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

3018 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
) {

3019 
	`mem£t
(&
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
, 0, (ndev_vif->ap.last_disconnected_sta));

3020 
	`scsc_wifi_fcq_q£t_deš™
(
dev
, &
ndev_vif
->
­
.
group_d©a_qs
, 
sdev
,‚dev_vif->
iâum
, 
NULL
);

3021 #ifdeà
CONFIG_SCSC_WLAN_MAC_ACL_PER_MAC


3022 
	`kä“
(
ndev_vif
->
­
.
aş_d©a_bÏckli¡
);

3023 
ndev_vif
->
­
.
aş_d©a_bÏckli¡
 = 
NULL
;

3027 ià((
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_CLIENT
è|| (ndev_vif->iáy³ =ğ
NL80211_IFTYPE_P2P_GO
)) {

3028 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_NO_VIF
);

3029 
sdev
->
p2p_group_exp_äame
 = 
SLSI_PA_INVALID
;

3033 
ndev_vif
->
vif_ty³
 = 
SLSI_VIFTYPE_UNSPECIFIED
;

3034 
ndev_vif
->
£t_pow”_mode
 = 
FAPI_POWERMANAGEMENTMODE_POWER_SAVE
;

3035 ià(
	`¦si_is_rf_‹¡_mode_’abËd
()) {

3036 
	`SLSI_NET_ERR
(
dev
, "*#rf#„fest mode set isƒnabled.\n");

3037 
ndev_vif
->
£t_pow”_mode
 = 
FAPI_POWERMANAGEMENTMODE_ACTIVE_MODE
;

3039 
ndev_vif
->
£t_pow”_mode
 = 
FAPI_POWERMANAGEMENTMODE_POWER_SAVE
;

3041 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

3044 
	`WARN
(
ndev_vif
->
³”_¡a_»cÜds
, "vif:%d,…“r_¡a_»cÜds:%d",‚dev_vif->
iâum
,‚dev_vif->peer_sta_records);

3046 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

3047 ià(
ndev_vif
->
¡a
.
tdls_’abËd
)

3048 
	`WARN
(
ndev_vif
->
¡a
.
tdls_³”_¡a_»cÜds
, "vif:%d,dls_peer_sta_records:%d",

3049 
ndev_vif
->
iâum
,‚dev_vif->
¡a
.
tdls_³”_¡a_»cÜds
);

3051 ià(
ndev_vif
->
¡a
.
¡a_bss
) {

3052 
	`¦si_cfg80211_put_bss
(
sdev
->
why
, 
ndev_vif
->
¡a
.
¡a_bss
);

3053 
ndev_vif
->
¡a
.
¡a_bss
 = 
NULL
;

3055 
ndev_vif
->
¡a
.
tdls_’abËd
 = 
çl£
;

3057 
	}
}

3059 
	$¦si_¡a_›“80211_mode
(
Ãt_deviû
 *
dev
, 
u16
 
cu¼’t_bss_chªÃl_äequ’cy
)

3061 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3062 cÚ¡ 
u8
 *
›
;

3064 
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_VHT_OPERATION
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,

3065 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
Ën
);

3066 ià(
›
)

3067  
SLSI_80211_MODE_11AC
;

3069 
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_HT_OPERATION
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,‚dev_vif->¡a.¡a_bss->›s->
Ën
);

3070 ià(
›
)

3071  
SLSI_80211_MODE_11N
;

3073 ià(
cu¼’t_bss_chªÃl_äequ’cy
 > 5000)

3074  
SLSI_80211_MODE_11A
;

3076 
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SUPP_RATES
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,‚dev_vif->¡a.¡a_bss->›s->
Ën
);

3077 ià(
›
)

3078  
	`¦si_g‘_suµÜ‹d_mode
(
›
);

3079  -
EINVAL
;

3080 
	}
}

3082 
	$¦si_g‘_¡a_mode
(
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
Ï¡_³”_mac
)

3084 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3085 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3086 
¦si_³”
 *
Ï¡_³”
;

3087 cÚ¡ 
u8
 *
³”_›
;

3089 
Ï¡_³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
Ï¡_³”_mac
);

3091 ià(!
Ï¡_³”
) {

3092 
	`SLSI_NET_ERR
(
dev
, "Peer‚ot found\n");

3093  -
EINVAL
;

3096 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
suµÜt_mode
 = 0;

3097 ià(
	`cfg80211_fšd_›
(
WLAN_EID_VHT_CAPABILITY
, 
Ï¡_³”
->
assoc_›
->
d©a
,

3098 
Ï¡_³”
->
assoc_›
->
Ën
))

3099 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
suµÜt_mode
 = 3;

3100 ià(
	`cfg80211_fšd_›
(
WLAN_EID_HT_CAPABILITY
, 
Ï¡_³”
->
assoc_›
->
d©a
,

3101 
Ï¡_³”
->
assoc_›
->
Ën
))

3102 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
suµÜt_mode
 = 1;

3104 ià(
ndev_vif
->
­
.
mode
 =ğ
SLSI_80211_MODE_11AC
) {

3105 
³”_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_VHT_CAPABILITY
, 
Ï¡_³”
->
assoc_›
->
d©a
,

3106 
Ï¡_³”
->
assoc_›
->
Ën
);

3107 ià(
³”_›
)

3108  
SLSI_80211_MODE_11AC
;

3110 
³”_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_HT_CAPABILITY
, 
Ï¡_³”
->
assoc_›
->
d©a
,

3111 
Ï¡_³”
->
assoc_›
->
Ën
);

3112 ià(
³”_›
)

3113  
SLSI_80211_MODE_11N
;

3114  
SLSI_80211_MODE_11A
;

3116 ià(
ndev_vif
->
­
.
mode
 =ğ
SLSI_80211_MODE_11N
) {

3117 
³”_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_HT_CAPABILITY
, 
Ï¡_³”
->
assoc_›
->
d©a
,

3118 
Ï¡_³”
->
assoc_›
->
Ën
);

3119 ià(
³”_›
)

3120  
SLSI_80211_MODE_11N
;

3121 ià(
ndev_vif
->
­
.
chªÃl_äeq
 > 5000)

3122  
SLSI_80211_MODE_11A
;

3123 
³”_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SUPP_RATES
, 
Ï¡_³”
->
assoc_›
->
d©a
,

3124 
Ï¡_³”
->
assoc_›
->
Ën
);

3125 ià(
³”_›
)

3126  
	`¦si_g‘_suµÜ‹d_mode
(
³”_›
);

3129 ià(
ndev_vif
->
­
.
chªÃl_äeq
 > 5000)

3130  
SLSI_80211_MODE_11A
;

3132 ià(
ndev_vif
->
­
.
mode
 =ğ
SLSI_80211_MODE_11G
) {

3133 
³”_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SUPP_RATES
, 
Ï¡_³”
->
assoc_›
->
d©a
,

3134 
Ï¡_³”
->
assoc_›
->
Ën
);

3135 ià(
³”_›
)

3136  
	`¦si_g‘_suµÜ‹d_mode
(
³”_›
);

3139  
SLSI_80211_MODE_11B
;

3140 
	}
}

3142 
	$¦si_pİuÏ‹_bss_»cÜd
(
Ãt_deviû
 *
dev
)

3144 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3145 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

3146 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

3147 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

3148 cÚ¡ 
u8
 *
›
, *
ext_ÿ·b
, *
rm_ÿ·b
, *
ext_d©a
, *
rm_d©a
, *
bss_lßd
;

3149 
ext_ÿ·b_›_Ën
, 
rm_ÿ·b_›_Ën
;

3150 
boŞ
 
ÃighbÜ_»pÜt_b™
 = 0, 
btm
 = 0;

3151 
u16
 
fw_tx_¿‹
;

3152 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = { { 
SLSI_PSID_UNIFI_CURRENT_BSS_CHANNEL_FREQUENCY
, { 0, 0 } },

3153 { 
SLSI_PSID_UNIFI_CURRENT_BSS_BANDWIDTH
, { 0, 0 } },

3154 { 
SLSI_PSID_UNIFI_CURRENT_BSS_NSS
, {0, 0} },

3155 { 
SLSI_PSID_UNIFI_AP_MIMO_USED
, {0, 0} },

3156 { 
SLSI_PSID_UNIFI_LAST_BSS_SNR
, {0, 0} },

3157 { 
SLSI_PSID_UNIFI_LAST_BSS_RSSI
, { 0, 0 } },

3158 { 
SLSI_PSID_UNIFI_ROAMING_COUNT
, {0, 0} },

3159 { 
SLSI_PSID_UNIFI_LAST_BSS_TX_DATA_RATE
, { 0, 0 } },

3160 { 
SLSI_PSID_UNIFI_ROAMING_AKM
, {0, 0} } };

3162 
mibr¥
.
d©aL’gth
 = 10 * 
	`ARRAY_SIZE
(
g‘_v®ues
);

3163 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

3164 ià(!
mibr¥
.
d©a
) {

3165 
	`SLSI_ERR
(
sdev
, "CªnÙ km®loø%d by‹ fÜ iÁ”çû MIBs\n", 
mibr¥
.
d©aL’gth
);

3166  -
ENOMEM
;

3169 
v®ues
 = 
	`¦si_»ad_mibs
(
sdev
, 
dev
, 
g‘_v®ues
, 
	`ARRAY_SIZE
(g‘_v®ues), &
mibr¥
);

3171 
	`mem£t
(&
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
, 0, (ndev_vif->sta.last_connected_bss));

3173 ià(!
v®ues
) {

3174 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mib decode†ist failed\n");

3175 
	`kä“
(
v®ues
);

3176 
	`kä“
(
mibr¥
.
d©a
);

3177  -
EINVAL
;

3181 ià(
v®ues
[0].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3182 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[0].
ty³
, 
SLSI_MIB_TYPE_UINT
);

3183 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
chªÃl_äeq
 = ((
v®ues
[0].
u
.
uštV®ue
) / 2);

3186 ià(
v®ues
[1].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3187 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[1].
ty³
, 
SLSI_MIB_TYPE_UINT
);

3188 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
bªdwidth
 = 
v®ues
[1].
u
.
uštV®ue
;

3191 ià(
v®ues
[2].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3192 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[2].
ty³
, 
SLSI_MIB_TYPE_UINT
);

3193 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
ª‹Âa_mode
 = 
v®ues
[2].
u
.
uštV®ue
;

3196 ià(
v®ues
[3].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3197 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[3].
ty³
, 
SLSI_MIB_TYPE_UINT
);

3198 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
mimo_u£d
 = 
v®ues
[3].
u
.
uštV®ue
;

3201 ià(
v®ues
[4].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3202 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[4].
ty³
, 
SLSI_MIB_TYPE_UINT
);

3203 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
¢r
 = 
v®ues
[4].
u
.
uštV®ue
;

3206 ià(
v®ues
[5].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3207 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[5].
ty³
, 
SLSI_MIB_TYPE_INT
);

3208 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
rssi
 = 
v®ues
[5].
u
.
štV®ue
;

3211 ià(
v®ues
[6].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3212 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[6].
ty³
, 
SLSI_MIB_TYPE_UINT
);

3213 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
rßmšg_couÁ
 = 
v®ues
[6].
u
.
uštV®ue
;

3216 ià(
v®ues
[7].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3217 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[7].
ty³
, 
SLSI_MIB_TYPE_UINT
);

3218 
fw_tx_¿‹
 = 
v®ues
[7].
u
.
uštV®ue
;

3219 
	`¦si_decode_fw_¿‹
((
u32
)
fw_tx_¿‹
, 
NULL
,

3220 (*)(&
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
tx_d©a_¿‹
));

3223 ià(
v®ues
[8].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3224 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[8].
ty³
, 
SLSI_MIB_TYPE_UINT
);

3225 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
rßmšg_akm
 = 
v®ues
[8].
u
.
uštV®ue
;

3228 
	`kä“
(
v®ues
);

3229 
	`kä“
(
mibr¥
.
d©a
);

3231 ià(!
ndev_vif
->
¡a
.
¡a_bss
) {

3232 
	`SLSI_WARN
(
sdev
, "Bss missing dueo out of order msg from firmware!! Cannot collect Big Data\n");

3233  -
EINVAL
;

3236 
	`SLSI_ETHER_COPY
(
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
add»ss
,‚dev_vif->¡a.
¡a_bss
->
bssid
);

3238 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
mode
 = 
	`¦si_¡a_›“80211_mode
(
dev
,

3239 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
chªÃl_äeq
);

3240 ià(
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
mode
 =ğ-
EINVAL
) {

3241 
	`SLSI_ERR
(
sdev
, "slsi_get_bss_info : Supported Rates IE is‚ull");

3242  -
EINVAL
;

3245 
›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_WFA
, 
SLSI_WLAN_OUI_TYPE_WFA_HS20_IND
,

3246 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,‚dev_vif->¡a.¡a_bss->›s->
Ën
);

3247 ià(
›
) {

3248 ià((
›
[6] >> 4) == 0)

3249 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
·s¥ošt_v”siÚ
 = 1;

3251 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
·s¥ošt_v”siÚ
 = 2;

3254 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
noi£_Ëv–
 = (ndev_vif->¡a.Ï¡_cÚÃùed_bss.
rssi
 -

3255 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
¢r
);

3257 
ext_ÿ·b
 = 
	`cfg80211_fšd_›
(
WLAN_EID_EXT_CAPABILITY
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,

3258 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
Ën
);

3259 
rm_ÿ·b
 = 
	`cfg80211_fšd_›
(
WLAN_EID_RRM_ENABLED_CAPABILITIES
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,

3260 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
Ën
);

3261 
bss_lßd
 = 
	`cfg80211_fšd_›
(
WLAN_EID_QBSS_LOAD
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,

3262 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
Ën
);

3264 ià(
ext_ÿ·b
) {

3265 
ext_ÿ·b_›_Ën
 = 
ext_ÿ·b
[1];

3266 
ext_d©a
 = &
ext_ÿ·b
[2];

3267 ià((
ext_ÿ·b_›_Ën
 >ğ2è&& (
ext_d©a
[1] &

3268 
SLSI_WLAN_EXT_CAPA1_PROXY_ARP_ENABLED
))

3269 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1 << 1;

3270 ià(
ext_ÿ·b_›_Ën
 >= 3) {

3271 ià(
ext_d©a
[2] & 
SLSI_WLAN_EXT_CAPA2_TFS_ENABLED
)

3272 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1 << 2;

3273 ià(
ext_d©a
[2] & 
SLSI_WLAN_EXT_CAPA2_WNM_SLEEP_ENABLED
)

3274 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1 << 3;

3275 ià(
ext_d©a
[2] & 
SLSI_WLAN_EXT_CAPA2_TIM_ENABLED
)

3276 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1 << 4;

3278 ià(
ext_d©a
[2] & 
SLSI_WLAN_EXT_CAPA2_BSS_TRANSISITION_ENABLED
) {

3279 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1 << 5;

3280 
btm
 = 1;

3282 ià(
ext_d©a
[2] & 
SLSI_WLAN_EXT_CAPA2_DMS_ENABLED
)

3283 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1 << 6;

3286 ià(
bss_lßd
)

3287 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1;

3288 ià(
rm_ÿ·b
) {

3289 
rm_ÿ·b_›_Ën
 = 
rm_ÿ·b
[1];

3290 
rm_d©a
 = &
rm_ÿ·b
[2];

3291 ià(
rm_ÿ·b_›_Ën
 >= 1) {

3292 
ÃighbÜ_»pÜt_b™
 = 
SLSI_WLAN_RM_CAPA0_NEIGHBOR_REPORT_ENABLED
 & 
rm_d©a
[0];

3293 ià(
SLSI_WLAN_RM_CAPA0_LINK_MEASUREMENT_ENABLED
 & 
rm_d©a
[0])

3294 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1 << 7;

3295 ià(
ÃighbÜ_»pÜt_b™
)

3296 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1 << 8;

3297 ià(
SLSI_WLAN_RM_CAPA0_PASSIVE_MODE_ENABLED
 & 
rm_d©a
[0])

3298 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1 << 9;

3299 ià(
SLSI_WLAN_RM_CAPA0_ACTIVE_MODE_ENABLED
 & 
rm_d©a
[0])

3300 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1 << 10;

3301 ià(
SLSI_WLAN_RM_CAPA0_TABLE_MODE_ENABLED
 & 
rm_d©a
[0])

3302 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv›
 |= 1 << 11;

3305 ià(!
ÃighbÜ_»pÜt_b™
 && !
btm
 && !
bss_lßd
)

3306 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv
 = 0;

3307 ià(
ÃighbÜ_»pÜt_b™
 !ğ0 && (!
btm
 && !
bss_lßd
))

3308 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv
 = 1;

3309 ià(!
ÃighbÜ_»pÜt_b™
 && (
btm
 || 
bss_lßd
))

3310 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv
 = 2;

3312 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
kv
 = 3;

3314 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
ssid_Ën
 =‚dev_vif->sta.ssid_len;

3315 
	`memıy
(
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
ssid
,‚dev_vif->¡a.ssid,‚dev_vif->¡a.
ssid_Ën
);

3318 
	}
}

3320 
	$¦si_fl_Ï¡_discÚÃùed_¡a_šfo
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

3321 cÚ¡ 
u8
 *
Ï¡_³”_mac
, cÚ¡ 
u16
 
»asÚ_code
)

3323 
i
;

3324 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3325 
¦si_³”
 *
Ï¡_³”
;

3326 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

3327 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

3328 
u16
 
fw_tx_¿‹
;

3329 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = { { 
SLSI_PSID_UNIFI_PEER_BANDWIDTH
, { 0, 0 } },

3330 { 
SLSI_PSID_UNIFI_CURRENT_PEER_NSS
, {0, 0} },

3331 { 
SLSI_PSID_UNIFI_PEER_RSSI
, { 0, 0 } },

3332 { 
SLSI_PSID_UNIFI_PEER_TX_DATA_RATE
, { 0, 0 } } };

3334 
	`SLSI_ETHER_COPY
(
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
add»ss
,

3335 
Ï¡_³”_mac
);

3336 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
»asÚ
 = 
»asÚ_code
;

3337 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
mode
 = 
	`¦si_g‘_¡a_mode
(
dev
, 
Ï¡_³”_mac
);

3338 
Ï¡_³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
Ï¡_³”_mac
);

3339 ià(!
Ï¡_³”
) {

3340 
	`SLSI_NET_ERR
(
dev
, "Peer‚ot found\n");

3341  -
EINVAL
;

3343 
i
 = 0; i < 
	`ARRAY_SIZE
(
g‘_v®ues
); i++)

3344 
g‘_v®ues
[
i
].
šdex
[0] = 
Ï¡_³”
->
aid
;

3346 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
rx_»Œy_·ck‘s
 = 
SLSI_DEFAULT_UNIFI_PEER_RX_RETRY_PACKETS
;

3347 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
rx_bc_mc_·ck‘s
 = 
SLSI_DEFAULT_UNIFI_PEER_RX_BC_MC_PACKETS
;

3348 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
ÿ·b™›s
 = 
Ï¡_³”
->capabilities;

3349 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
bªdwidth
 = 
SLSI_DEFAULT_UNIFI_PEER_BANDWIDTH
;

3350 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
ª‹Âa_mode
 = 
SLSI_DEFAULT_UNIFI_PEER_NSS
;

3351 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
rssi
 = 
SLSI_DEFAULT_UNIFI_PEER_RSSI
;

3352 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
tx_d©a_¿‹
 = 
SLSI_DEFAULT_UNIFI_PEER_TX_DATA_RATE
;

3354 
mibr¥
.
d©aL’gth
 = 15 * 
	`ARRAY_SIZE
(
g‘_v®ues
);

3355 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

3357 ià(!
mibr¥
.
d©a
) {

3358 
	`SLSI_ERR
(
sdev
, "CªnÙ km®loø%d by‹ fÜ iÁ”çû MIBs\n", 
mibr¥
.
d©aL’gth
);

3359  -
ENOMEM
;

3362 
v®ues
 = 
	`¦si_»ad_mibs
(
sdev
, 
dev
, 
g‘_v®ues
, 
	`ARRAY_SIZE
(g‘_v®ues), &
mibr¥
);

3364 ià(!
v®ues
) {

3365 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mib decode†ist failed\n");

3366 
	`kä“
(
v®ues
);

3367 
	`kä“
(
mibr¥
.
d©a
);

3368  -
EINVAL
;

3370 ià(
v®ues
[0].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3371 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[0].
ty³
, 
SLSI_MIB_TYPE_INT
);

3372 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
bªdwidth
 = 
v®ues
[0].
u
.
štV®ue
;

3375 ià(
v®ues
[1].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3376 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[1].
ty³
, 
SLSI_MIB_TYPE_INT
);

3377 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
ª‹Âa_mode
 = 
v®ues
[1].
u
.
štV®ue
;

3380 ià(
v®ues
[2].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3381 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[2].
ty³
, 
SLSI_MIB_TYPE_INT
);

3382 
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
rssi
 = 
v®ues
[2].
u
.
štV®ue
;

3385 ià(
v®ues
[3].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3386 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[3].
ty³
, 
SLSI_MIB_TYPE_UINT
);

3387 
fw_tx_¿‹
 = 
v®ues
[3].
u
.
uštV®ue
;

3388 
	`¦si_decode_fw_¿‹
((
u32
)
fw_tx_¿‹
, 
NULL
,

3389 (*)&
ndev_vif
->
­
.
Ï¡_discÚÃùed_¡a
.
tx_d©a_¿‹
);

3392 
	`kä“
(
v®ues
);

3393 
	`kä“
(
mibr¥
.
d©a
);

3396 
	}
}

3398 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

3399 
	$¦si_»Œy_cÚÃùiÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

3402 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3403 
¦si_³”
 *
³”
;

3404 
r
 = 0;

3405 
boŞ
 
­_found
 = 
çl£
;

3406 
u8
 
deviû_add»ss
[
ETH_ALEN
] = { 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF };

3407 cÚ¡ 
u8
 
¦si_ex‹nded_ÿp_mask
[] = { 0xFF, 0xFF, 0xFF, 0x7F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF };

3408 
u8
 *
´obe_»q_›s
;

3409 
size_t
 
´obe_»q_›_Ën
;

3411 
­_found
 = 
	`¦si_£Ëù_­_fÜ_cÚÃùiÚ
(
sdev
, 
dev
, 
NULL
, NULL, 
Œue
);

3412 ià(!
­_found
) {

3413 
	`SLSI_NET_ERR
(
dev
, "Could‚ot find BSSID for„econnection\n");

3416 
´obe_»q_›_Ën
 = 
ndev_vif
->probe_req_ie_len;

3417 
´obe_»q_›s
 = 
	`km®loc
(
´obe_»q_›_Ën
, 
GFP_KERNEL
);

3418 ià(
´obe_»q_›s
 && 
´obe_»q_›_Ën
)

3419 
	`memıy
(
´obe_»q_›s
, 
ndev_vif
->´obe_»q_›s,‚dev_vif->
´obe_»q_›_Ën
);

3420 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0) {

3421 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

3422 
ex™_w™h_´obe_»q_›s
;

3424 ià(
	`¦si_mlme_add_vif
(
sdev
, 
dev
, dev->
dev_addr
, 
deviû_add»ss
) != 0) {

3425 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_add_vif failed\n");

3426 
ex™_w™h_´obe_»q_›s
;

3428 ià(
	`¦si_mlme_»gi¡”_aùiÚ_äame
(
sdev
, 
dev
, 
ndev_vif
->
¡a
.
aùiÚ_äame_bm­
,

3429 
ndev_vif
->
¡a
.
aùiÚ_äame_su¥’d_bm­
) != 0) {

3430 
	`SLSI_NET_ERR
(
dev
, "Action frame„eg fail bitmap 0x%x 0x%x\n",

3431 
ndev_vif
->
¡a
.
aùiÚ_äame_bm­
,‚dev_vif->sta.action_frame_bmap);

3432 
ex™_w™h_´obe_»q_›s
;

3435 
r
 = 
	`¦si_£t_boo¡
(
sdev
, 
dev
);

3436 ià(
r
 != 0)

3437 
	`SLSI_NET_ERR
(
dev
, "Rss˜Boo¡ s‘ faed: %d\n", 
r
);

3438 ià(
´obe_»q_›s
 && 
´obe_»q_›_Ën
) {

3439 ()
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_PROBE_REQUEST
, 
´obe_»q_›s
,

3440 
´obe_»q_›_Ën
);

3442 
r
 = 
	`¦si_£t_ext_ÿp
(
sdev
, 
dev
, 
ndev_vif
->
¡a
.
sme
.
›
,‚dev_vif->¡a.sme.
›_Ën
, 
¦si_ex‹nded_ÿp_mask
);

3443 ià(
r
 != 0)

3444 
	`SLSI_NET_ERR
(
dev
, "FaedØ£ˆex‹nded c­ab™y MIB: %d\n", 
r
);

3445 
r
 = 
	`¦si_mlme_cÚÃù
(
sdev
, 
dev
, &
ndev_vif
->
¡a
.
sme
,‚dev_vif->¡a.sme.
chªÃl
,‚dev_vif->¡a.sme.
bssid
);

3446 ià(
r
 != 0) {

3447 
	`SLSI_NET_ERR
(
dev
, "RecÚÃù faed: %d\n", 
r
);

3448 
r
 = 0;

3449 
ex™_w™h_´obe_»q_›s
;

3451 
ndev_vif
->
¡a
.
vif_¡©us
 = 
SLSI_VIF_STATUS_CONNECTING
;

3452 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

3453 ià(!
³”
) {

3454 
	`SLSI_NET_ERR
(
dev
, "peer‚ot found!\n");

3455 
r
 = 0;

3456 
ex™_w™h_´obe_»q_›s
;

3458 
ndev_vif
->
¡a
.
vif_¡©us
 = 
SLSI_VIF_STATUS_CONNECTING
;

3459 
	`SLSI_ETHER_COPY
(
³”
->
add»ss
, 
ndev_vif
->
¡a
.
sme
.
bssid
);

3460 
ndev_vif
->
chª
 =‚dev_vif->
¡a
.
sme
.
chªÃl
;

3461 
r
 = 1;

3462 
ex™_w™h_´obe_»q_›s
:

3463 
	`kä“
(
´obe_»q_›s
);

3464  
r
;

3465 
	}
}

3467 
	$¦si_ä“_cÚÃùiÚ_·¿ms
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

3469 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3471 
	`kä“
(
ndev_vif
->
¡a
.
sme
.
ssid
);

3472 
ndev_vif
->
¡a
.
sme
.
ssid
 = 
NULL
;

3473 
ndev_vif
->
¡a
.
sme
.
ssid_Ën
 = 0;

3474 
	`kä“
(
ndev_vif
->
¡a
.
cÚÃùed_bssid
);

3475 
ndev_vif
->
¡a
.
cÚÃùed_bssid
 = 
NULL
;

3476 
	`kä“
(
ndev_vif
->
¡a
.
sme
.
key
);

3477 
ndev_vif
->
¡a
.
sme
.
key
 = 
NULL
;

3478 
	`kä“
(
ndev_vif
->
¡a
.
sme
.
›
);

3479 
ndev_vif
->
¡a
.
sme
.
›
 = 
NULL
;

3480 
ndev_vif
->
¡a
.
sme
.
›_Ën
 = 0;

3481 
	}
}

3484 
	$¦si_hªdË_discÚÃù
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
³”_add»ss
, 
u16
 
»asÚ
,

3485 
u8
 *
di§ssoc_r¥_›
, 
u32
 
di§ssoc_r¥_›_Ën
)

3487 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3489 ià(
	`WARN_ON
(!
dev
))

3490 
ex™
;

3492 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "DiscÚÃù(vif:%d)\n", 
ndev_vif
->
iâum
);

3495 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3497 ià(!
ndev_vif
->
aùiv©ed
) {

3498 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

3499 
ex™
;

3502 
ndev_vif
->
vif_ty³
) {

3503 
FAPI_VIFTYPE_STATION
:

3505 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

3506 ià(!(
»asÚ
 =ğ
FAPI_REASONCODE_DEAUTHENTICATED_NO_MORE_STATIONS
))

3508 
	`Ãtif_ÿ¼›r_off
(
dev
);

3514 ià(
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTING
) {

3515 ià(!
³”_add»ss
)

3516 
	`SLSI_NET_WARN
(
dev
, "Connection failure\n");

3517 } ià(
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
) {

3518 ià(
»asÚ
 =ğ
FAPI_REASONCODE_SYNCHRONISATION_LOSS
)

3519 
»asÚ
 = 0;

3521 ià(
»asÚ
 =ğ
FAPI_REASONCODE_KEEP_ALIVE_FAILURE
)

3522 
»asÚ
 = 
WLAN_REASON_DEAUTH_LEAVING
;

3524 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

3525 ià(
»asÚ
 =ğ
FAPI_REASONCODE_DEAUTHENTICATED_NO_MORE_STATIONS
) {

3526 ià(
ndev_vif
->
¡a
.
drv_cÚÃù_»q_Úgošg
) {

3527 ià(
ndev_vif
->
¡a
.
drv_bss_£ËùiÚ
 && 
	`¦si_»Œy_cÚÃùiÚ
(
sdev
, 
dev
)) {

3528 
	`SLSI_INFO
(
sdev
, "Re-connecting\n");

3529 
ndev_vif
->
¡a
.
rßm_Ú_discÚÃù
 = 
Œue
;

3533 
ndev_vif
->
¡a
.
drv_cÚÃù_»q_Úgošg
 = 
çl£
;

3534 
	`¦si_ä“_cÚÃùiÚ_·¿ms
(
sdev
, 
dev
);

3535 
	`Ãtif_ÿ¼›r_off
(
dev
);

3536 
»asÚ
 =„eason & 0x00FF;

3539 ià(
»asÚ
 >= 0x8200 &&„eason <= 0x82FF)

3540 
»asÚ
 =„eason & 0x00FF;

3543 ià(
ndev_vif
->
¡a
.
is_wps
)

3544 
	`SLSI_NET_INFO
(
dev
, "Ignoring Deauth during WPS…rocedure\n");

3546 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 2, 0))

3547 
	`cfg80211_discÚÃùed
(
dev
, 
»asÚ
, 
di§ssoc_r¥_›
, 
di§ssoc_r¥_›_Ën
,

3548 
çl£
, 
GFP_KERNEL
);

3550 
	`cfg80211_discÚÃùed
(
dev
, 
»asÚ
, 
di§ssoc_r¥_›
, 
di§ssoc_r¥_›_Ën
,

3551 
GFP_KERNEL
);

3553 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "Reûived discÚÃù from AP,„—sÚ = %d\n", 
»asÚ
);

3555 } ià(
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_DISCONNECTING
) {

3557 ià(
»asÚ
 =ğ
FAPI_REASONCODE_KEEP_ALIVE_FAILURE
 ||

3558 
»asÚ
 =ğ
FAPI_REASONCODE_SYNCHRONISATION_LOSS
)

3559 
»asÚ
 = 
WLAN_REASON_DEAUTH_LEAVING
;

3560 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 2, 0))

3561 
	`cfg80211_discÚÃùed
(
dev
, 
»asÚ
, 
di§ssoc_r¥_›
, 
di§ssoc_r¥_›_Ën
, 
Œue
, 
GFP_KERNEL
);

3563 
	`cfg80211_discÚÃùed
(
dev
, 
»asÚ
, 
di§ssoc_r¥_›
, 
di§ssoc_r¥_›_Ën
, 
GFP_KERNEL
);

3565 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "Completion of disconnect from AP\n");

3568 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 2, 0))

3569 
	`cfg80211_discÚÃùed
(
dev
, 
»asÚ
, 
di§ssoc_r¥_›
, 
di§ssoc_r¥_›_Ën
, 
çl£
, 
GFP_KERNEL
);

3571 
	`cfg80211_discÚÃùed
(
dev
, 
»asÚ
, 
di§ssoc_r¥_›
, 
di§ssoc_r¥_›_Ën
, 
GFP_KERNEL
);

3573 
	`SLSI_NET_WARN
(
dev
, "discÚÃù iÀwrÚg s‹ vif_¡©us(%d)\n", 
ndev_vif
->
¡a
.
vif_¡©us
);

3576 
ndev_vif
->
¡a
.
is_wps
 = 
çl£
;

3580 ià(!(
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTING
 ||

3581 
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_UNSPECIFIED
))

3582 
	`¦si_pİuÏ‹_bss_»cÜd
(
dev
);

3584 
	`kä“
(
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
);

3585 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
 = 
NULL
;

3586 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
 = 0;

3588 
	`mem£t
(
ndev_vif
->
¡a
.
ssid
, 0,‚dev_vif->¡a.
ssid_Ën
);

3589 
	`mem£t
(
ndev_vif
->
¡a
.
bssid
, 0, 
ETH_ALEN
);

3590 
ndev_vif
->
¡a
.
ssid_Ën
 = 0;

3591 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


3592 
	`mem£t
(&
ndev_vif
->
’hªûd_¬p_¡©s
, 0, (ndev_vif->enhanced_arp_stats));

3593 
	`mem£t
(
ndev_vif
->
’hªûd_¬p_ho¡_g
, 0, (ndev_vif->enhanced_arp_host_tag));

3594 
ndev_vif
->
’hªûd_¬p_d‘eù_’abËd
 = 
çl£
;

3597 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3598 ià(
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
) {

3599 
	`mem£t
(&
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
, 0,

3600 (
¦si_rßm_sÿn_chªÃls
));

3602 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


3603 
sdev
->
deviû_cÚfig
.
ncho_mode
 = 0;

3604 
sdev
->
deviû_cÚfig
.
rßm_sÿn_mode
 = 0;

3605 
sdev
->
deviû_cÚfig
.
dfs_sÿn_mode
 = 0;

3606 
sdev
->
deviû_cÚfig
.
dfs_sÿn_mode
 = 0;

3607 ià(
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
.
n
) {

3608 
	`mem£t
(&
sdev
->
deviû_cÚfig
.
wes_rßm_sÿn_li¡
, 0, (
¦si_rßm_sÿn_chªÃls
));

3611 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3612 
	`¦si_rßm_chªÃl_ÿche_´uÃ
(
dev
, 0, 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
ssid
);

3614 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

3615 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

3616 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

3619 
FAPI_VIFTYPE_AP
:

3621 
¦si_³”
 *
³”
 = 
NULL
;

3623 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
³”_add»ss
);

3624 ià(!
³”
) {

3625 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "peer NOT found by MAC‡ddress\n");

3626 
ex™
;

3629 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "MAC:%pM is_wps:%d P“¸S‹ = %d\n", 
³”_add»ss
, 
³”
->
is_wps
,…“r->
cÚÃùed_¡©e
);

3630 
	`¦si_fl_Ï¡_discÚÃùed_¡a_šfo
(
sdev
, 
dev
, 
³”_add»ss
, 
»asÚ
);

3631 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DISCONNECTED
);

3632 ià(((
³”
->
cÚÃùed_¡©e
 =ğ
SLSI_STA_CONN_STATE_CONNECTED
) ||

3633 (
³”
->
cÚÃùed_¡©e
 =ğ
SLSI_STA_CONN_STATE_DOING_KEY_CONFIG
)) &&

3634 !(
³”
->
is_wps
))

3635 
	`cfg80211_d–_¡a
(
dev
, 
³”
->
add»ss
, 
GFP_KERNEL
);

3637 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

3638 
	`¦si_³”_»move
(
sdev
, 
dev
, 
³”
);

3639 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

3644 ià(
ndev_vif
->
­
.
p2p_gc_keys_£t
 && (ndev_vif->
³”_¡a_»cÜds
 == 0)) {

3645 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "P2PGO - Acquire wakelock‡fter†ast client disconnection\n");

3646 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

3651 
	`SLSI_NET_WARN
(
dev
, "mlme_discÚÃù_šd(vif:%d, uÃx³ùed viàty³:%d)\n", 
ndev_vif
->
iâum
,‚dev_vif->
vif_ty³
);

3654 
ex™
:

3656 
	}
}

3658 
	$¦si_ps_pÜt_cÚŒŞ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
, 
¦si_¡a_cÚn_¡©e
 
s
)

3660 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3662 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

3664 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3666 
s
) {

3667 
SLSI_STA_CONN_STATE_DISCONNECTED
:

3668 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "STA disconnected, SET : FCQ - Disabled\n");

3669 
³”
->
authÜized
 = 
çl£
;

3670 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && !ndev_vif->
³”_¡a_»cÜds
)

3671 ()
	`scsc_wifi_fcq_8021x_pÜt_¡©e
(
dev
, &
ndev_vif
->
­
.
group_d©a_qs
, 
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
);

3672  
	`scsc_wifi_fcq_8021x_pÜt_¡©e
(
dev
, &
³”
->
d©a_qs
, 
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
);

3674 
SLSI_STA_CONN_STATE_DOING_KEY_CONFIG
:

3675 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "STA doing KEY config, SET : FCQ - Disabled\n");

3676 
³”
->
authÜized
 = 
çl£
;

3677 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && !ndev_vif->
³”_¡a_»cÜds
)

3678 ()
	`scsc_wifi_fcq_8021x_pÜt_¡©e
(
dev
, &
ndev_vif
->
­
.
group_d©a_qs
, 
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
);

3679  
	`scsc_wifi_fcq_8021x_pÜt_¡©e
(
dev
, &
³”
->
d©a_qs
, 
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
);

3681 
SLSI_STA_CONN_STATE_CONNECTED
:

3682 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "STA connected, SET : FCQ - Enabled\n");

3683 
³”
->
authÜized
 = 
Œue
;

3684 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
)

3685 ()
	`scsc_wifi_fcq_8021x_pÜt_¡©e
(
dev
, &
ndev_vif
->
­
.
group_d©a_qs
, 
SCSC_WIFI_FCQ_8021x_STATE_OPEN
);

3686  
	`scsc_wifi_fcq_8021x_pÜt_¡©e
(
dev
, &
³”
->
d©a_qs
, 
SCSC_WIFI_FCQ_8021x_STATE_OPEN
);

3689 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "SET : FCQ - Disabled\n");

3690 
³”
->
authÜized
 = 
çl£
;

3691 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && !ndev_vif->
³”_¡a_»cÜds
)

3692 ()
	`scsc_wifi_fcq_8021x_pÜt_¡©e
(
dev
, &
ndev_vif
->
­
.
group_d©a_qs
, 
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
);

3693  
	`scsc_wifi_fcq_8021x_pÜt_¡©e
(
dev
, &
³”
->
d©a_qs
, 
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
);

3697 
	}
}

3699 
	$¦si_£t_ušt_mib
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
psid
, 
v®ue
)

3701 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

3702 
r
 = 0;

3704 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "UINT MIB S‘ Reque¡ (PSID = 0x%04X, V®uğ%d)\n", 
psid
, 
v®ue
);

3706 
r
 = 
	`¦si_mib_’code_ušt
(&
mib_d©a
, 
psid
, 
v®ue
, 0);

3707 ià(
r
 =ğ
SLSI_MIB_STATUS_SUCCESS
) {

3708 ià(
mib_d©a
.
d©aL’gth
) {

3709 
r
 = 
	`¦si_mlme_£t
(
sdev
, 
dev
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

3710 ià(
r
 != 0)

3711 
	`SLSI_ERR
(
sdev
, "MIB (PSID = 0x%04Xè£ˆ”rÜ = %d\n", 
psid
, 
r
);

3712 
	`kä“
(
mib_d©a
.
d©a
);

3715  
r
;

3716 
	}
}

3718 
	$¦si_£nd_max_Œªsm™_msdu_liãtime
(
¦si_dev
 *
dev
, 
Ãt_deviû
 *
ndev
, 
u32
 
msdu_liãtime
)

3720 #ifdeà
CCX_MSDU_LIFETIME_MIB_NA


3721 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

3722 
”rÜ
 = 0;

3724 ià(
	`¦si_mib_’code_ušt
(&
mib_d©a
, 
SLSI_PSID_DOT11_MAX_TRANSMIT_MSDU_LIFETIME
, 
msdu_liãtime
, 0è=ğ
SLSI_MIB_STATUS_SUCCESS
)

3725 ià(
mib_d©a
.
d©aL’gth
) {

3726 
”rÜ
 = 
	`¦si_mlme_£t
(
dev
, 
ndev
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

3727 ià(
”rÜ
)

3728 
	`SLSI_ERR
(
dev
, "E¼ S’dšg max msdu†iãtimçed.ƒ¼Ü = %d\n", 
”rÜ
);

3729 
	`kä“
(
mib_d©a
.
d©a
);

3731  
”rÜ
;

3735 
	}
}

3737 
	$¦si_»ad_max_Œªsm™_msdu_liãtime
(
¦si_dev
 *
dev
, 
Ãt_deviû
 *
ndev
, 
u32
 *
msdu_liãtime
)

3739 #ifdeà
CCX_MSDU_LIFETIME_MIB_NA


3740 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

3741 
¦si_mib_d©a
 
mib_»s
 = { 0, 
NULL
 };

3742 
¦si_mib_’Œy
 
mib_v®
;

3743 
”rÜ
 = 0;

3744 
mib_rx_Ën
 = 0;

3745 
size_t
 
Ën
;

3747 
	`SLSI_UNUSED_PARAMETER
(
ndev
);

3749 
mib_»s
.
d©aL’gth
 = 10;

3750 
mib_»s
.
d©a
 = 
	`km®loc
(mib_»s.
d©aL’gth
, 
GFP_KERNEL
);

3752 ià(!
mib_»s
.
d©a
)

3753  -
ENOMEM
;

3755 
	`¦si_mib_’code_g‘
(&
mib_d©a
, 
SLSI_PSID_DOT11_MAX_TRANSMIT_MSDU_LIFETIME
, 0);

3756 
”rÜ
 = 
	`¦si_mlme_g‘
(
dev
, 
NULL
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
,

3757 
mib_»s
.
d©a
, mib_»s.
d©aL’gth
, &
mib_rx_Ën
);

3758 
	`kä“
(
mib_d©a
.
d©a
);

3760 ià(
”rÜ
) {

3761 
	`SLSI_ERR
(
dev
, "E¼ R—dšg max msdu†iãtimçed.ƒ¼Ü = %d\n", 
”rÜ
);

3762 
	`kä“
(
mib_»s
.
d©a
);

3763  
”rÜ
;

3766 
Ën
 = 
	`¦si_mib_decode
(&
mib_»s
, &
mib_v®
);

3768 ià(
Ën
 != 8) {

3769 
	`kä“
(
mib_»s
.
d©a
);

3770  -
EINVAL
;

3772 *
msdu_liãtime
 = 
mib_v®
.
v®ue
.
u
.
uštV®ue
;

3774 
	`kä“
(
mib_»s
.
d©a
);

3776  
”rÜ
;

3780 
	}
}

3782 
	$¦si_bªd_cfg_upd©e
(
¦si_dev
 *
sdev
, 
bªd
)

3785 
bªd
) {

3786 
SLSI_FREQ_BAND_AUTO
:

3787 
sdev
->
why
->
bªds
[0] = sdev->
deviû_cÚfig
.
bªd_2G
;

3788 
sdev
->
why
->
bªds
[1] = sdev->
deviû_cÚfig
.
bªd_5G
;

3790 
SLSI_FREQ_BAND_5GHZ
:

3791 
sdev
->
why
->
bªds
[0] = 
NULL
;

3792 
sdev
->
why
->
bªds
[1] = sdev->
deviû_cÚfig
.
bªd_5G
;

3794 
SLSI_FREQ_BAND_2GHZ
:

3795 
sdev
->
why
->
bªds
[0] = sdev->
deviû_cÚfig
.
bªd_2G
;

3796 
sdev
->
why
->
bªds
[1] = 
NULL
;

3801 
	`why_­¶y_cu¡om_»guÏtÜy
(
sdev
->
why
, sdev->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
);

3802 
	`¦si_upd©e_suµÜ‹d_chªÃls_»gd_æags
(
sdev
);

3803 
	}
}

3805 
	$¦si_bªd_upd©e
(
¦si_dev
 *
sdev
, 
bªd
)

3807 
i
;

3808 
Ãt_deviû
 *
dev
;

3809 
Ãtdev_vif
 *
ndev_vif
;

3811 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3813 
	`SLSI_DBG3
(
sdev
, 
SLSI_CFG80211
, "suµÜ‹d_bªd:%d\n", 
bªd
);

3815 ià(
bªd
 =ğ
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
) {

3816 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3820 
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
 = 
bªd
;

3822 
	`¦si_bªd_cfg_upd©e
(
sdev
, 
bªd
);

3824 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3827 ià(
bªd
 == 0)

3831 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

3832 
i
 = 1; i < (
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1); i++) {

3833 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
i
);

3834 ià(!
dev
)

3836 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3837 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
£t_muÉiÿ¡_f‹r_wÜk
);

3838 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
upd©e_pkt_f‹r_wÜk
);

3839 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3847 ià((
ndev_vif
->
aùiv©ed
è&& (ndev_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) &&

3848 (
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTING
 ||‚dev_vif->¡a.vif_¡©u =ğ
SLSI_VIF_STATUS_CONNECTED
) &&

3849 (
ndev_vif
->
chª
->
hw_v®ue
 <ğ14 ? 
bªd
 =ğ
SLSI_FREQ_BAND_5GHZ
 : bªd =ğ
SLSI_FREQ_BAND_2GHZ
)) {

3850 
r
;

3852 ià(!
ndev_vif
->
¡a
.
¡a_bss
) {

3853 
	`SLSI_ERR
(
sdev
, "slsi_mlme_disconnect failed, sta_bss is‚ot‡vailable\n");

3854 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3855 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

3856  -
EINVAL
;

3859 
r
 = 
	`¦si_mlme_discÚÃù
(
sdev
, 
dev
, 
ndev_vif
->
¡a
.
¡a_bss
->
bssid
, 
WLAN_REASON_DEAUTH_LEAVING
, 
Œue
);

3860 
	`LOG_CONDITIONALLY
(
r
 !ğ0, 
	`SLSI_ERR
(
sdev
, "¦si_mlme_discÚÃù(" 
MACSTR
 "èçed w™h %d\n", 
	`MAC2STR
(
ndev_vif
->
¡a
.
¡a_bss
->
bssid
),„));

3862 
r
 = 
	`¦si_hªdË_discÚÃù
(
sdev
, 
dev
, 
ndev_vif
->
¡a
.
¡a_bss
->
bssid
, 0, 
NULL
, 0);

3863 
	`LOG_CONDITIONALLY
(
r
 !ğ0, 
	`SLSI_ERR
(
sdev
, "¦si_hªdË_discÚÃù(" 
MACSTR
 "èçed w™h %d\n", 
	`MAC2STR
(
ndev_vif
->
¡a
.
¡a_bss
->
bssid
),„));

3865 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3867 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

3870 
	}
}

3873 
	$¦si_£nd_g¿tu™ous_¬p
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

3875 
»t
 = 0;

3876 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3877 
sk_buff
 *
¬p
;

3878 
‘hhdr
 *
ehdr
;

3879 cÚ¡ 
u8
 
¬p_hdr
[] = { 0x00, 0x01, 0x08, 0x00, 0x06, 0x04, 0x00, 0x01 };

3880 
¬p_size
 = (
¬p_hdr
è+ 
ETH_ALEN
 + (
ndev_vif
->
add»ss
) + ETH_ALEN + (ndev_vif->ipaddress);

3882 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "\n");

3884 ià(!
ndev_vif
->
add»ss
)

3887 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3889 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

3890  -
EINVAL
;

3891 ià(
	`WARN_ON
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
))

3892  -
EINVAL
;

3893 ià(
	`WARN_ON
(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
))

3894  -
EINVAL
;

3896 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "IP:%pI4\n", &
ndev_vif
->
add»ss
);

3898 
¬p
 = 
	`®loc_skb
(
SLSI_NETIF_SKB_HEADROOM
 + 
SLSI_NETIF_SKB_TAILROOM
 + (
‘hhdr
è+ 
¬p_size
, 
GFP_KERNEL
);

3899 ià(!
¬p
) {

3900 
	`SLSI_WARN_NODEV
("”rÜ‡Îoÿtšg skb (Ën: %d)\n", 
SLSI_NETIF_SKB_HEADROOM
 + 
SLSI_NETIF_SKB_TAILROOM
 + (
‘hhdr
è+ 
¬p_size
);

3901  -
ENOMEM
;

3904 
	`skb_»£rve
(
¬p
, 
SLSI_NETIF_SKB_HEADROOM
 - 
	`SLSI_SKB_GET_ALIGNMENT_OFFSET
(arp));

3906 
	`skb_»£t_mac_h—d”
(
¬p
);

3909 
ehdr
 = (
‘hhdr
 *)
	`skb_put
(
¬p
, (ethhdr));

3910 
	`mem£t
(
ehdr
->
h_de¡
, 0xFF, 
ETH_ALEN
);

3911 
	`SLSI_ETHER_COPY
(
ehdr
->
h_sourû
, 
dev
->
dev_addr
);

3912 
ehdr
->
h_´Ùo
 = 
	`ıu_to_be16
(
ETH_P_ARP
);

3915 
	`memıy
(
	`skb_put
(
¬p
, (
¬p_hdr
)),‡rp_hdr, (arp_hdr));

3916 
	`SLSI_ETHER_COPY
(
	`skb_put
(
¬p
, 
ETH_ALEN
), 
dev
->
dev_addr
);

3917 
	`memıy
(
	`skb_put
(
¬p
, (
ndev_vif
->
add»ss
)), &ndev_vif->ipaddress, (ndev_vif->ipaddress));

3918 
	`mem£t
(
	`skb_put
(
¬p
, 
ETH_ALEN
), 0xFF, ETH_ALEN);

3919 
	`memıy
(
	`skb_put
(
¬p
, (
ndev_vif
->
add»ss
)), &ndev_vif->ipaddress, (ndev_vif->ipaddress));

3921 
¬p
->
dev
 = dev;

3922 
¬p
->
´ÙocŞ
 = 
ETH_P_ARP
;

3923 
¬p
->
_summed
 = 
CHECKSUM_UNNECESSARY
;

3924 
¬p
->
queue_m­pšg
 = 
	`¦si_Ãtif_g‘_³”_queue
(0, 0);

3926 
»t
 = 
	`¦si_tx_d©a
(
sdev
, 
dev
, 
¬p
);

3927 ià(
»t
)

3928 
	`kä“_skb
(
¬p
);

3930  
»t
;

3931 
	}
}

3933 cÚ¡ 
u8
 
	gaddr_mask
[6] = { 0xff, 0xff, 0xff, 0xff, 0xff, 0xff };

3934 cÚ¡ 
u8
 
	gsŞic™ed_node_addr_mask
[6] = { 0x33, 0x33, 0xff, 0x00, 0x00, 0x01 };

3936 
	$¦si_ü—‹_·ck‘_f‹r_–em’t
(
u8
 
f‹rid
,

3937 
u8
 
pkt_f‹r_mode
,

3938 
u8
 
num_·‰”n_desc
,

3939 
¦si_mlme_·‰”n_desc
 *
·‰”n_desc
,

3940 
¦si_mlme_pkt_f‹r_–em
 *
pkt_f‹r_–em
,

3941 *
pkt_f‹rs_Ën
)

3943 
u8
 
pkt_f‹r_hdr
[
SLSI_PKT_FILTER_ELEM_HDR_LEN
] = { 0xdd,

3947 
f‹rid
,

3948 
pkt_f‹r_mode


3950 
u8
 
i
;

3951 
·‰”n_desc_Ën
 = 0;

3953 
	`WARN_ON
(
num_·‰”n_desc
 > 
SLSI_MAX_PATTERN_DESC
);

3955 
	`memıy
(
pkt_f‹r_–em
->
h—d”
, 
pkt_f‹r_hdr
, 
SLSI_PKT_FILTER_ELEM_HDR_LEN
);

3956 
pkt_f‹r_–em
->
num_·‰”n_desc
 =‚um_pattern_desc;

3958 
i
 = 0; i < 
num_·‰”n_desc
; i++) {

3959 
	`memıy
(&
pkt_f‹r_–em
->
·‰”n_desc
[
i
], &·‰”n_desc[i], (
¦si_mlme_·‰”n_desc
));

3960 
·‰”n_desc_Ën
 +ğ
SLSI_PKT_DESC_FIXED_LEN
 + (2 * 
·‰”n_desc
[
i
].
mask_Ëngth
);

3964 
pkt_f‹r_–em
->
h—d”
[1] = 
SLSI_PKT_FILTER_ELEM_FIXED_LEN
 + 
·‰”n_desc_Ën
;

3965 *
pkt_f‹rs_Ën
 +ğ(
SLSI_PKT_FILTER_ELEM_HDR_LEN
 + 
·‰”n_desc_Ën
);

3967 
	`SLSI_DBG3_NODEV
(
SLSI_MLME
, "filterid=0x%x,pkt_filter_mode=0x%x,num_pattern_desc=0x%x\n",

3968 
f‹rid
, 
pkt_f‹r_mode
, 
num_·‰”n_desc
);

3969 
	}
}

3971 
	#SLSI_SCREEN_OFF_FILTERS_COUNT
 1

	)

3973 
	$¦si_£t_commÚ_·ck‘_f‹rs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

3975 
¦si_mlme_·‰”n_desc
 
·‰”n_desc
;

3976 
¦si_mlme_pkt_f‹r_–em
 
pkt_f‹r_–em
[1];

3977 
pkt_f‹rs_Ën
 = 0;

3978 
u8
 
num_f‹rs
 = 0;

3981 
·‰”n_desc
.
off£t
 = 0;

3982 
·‰”n_desc
.
mask_Ëngth
 = 1;

3983 
·‰”n_desc
.
mask
[0] = 0x01;

3984 
·‰”n_desc
.
·‰”n
[0] = 0x01;

3986 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_ALL_BC_MC_FILTER_ID
,

3987 
FAPI_PACKETFILTERMODE_OPT_OUT_SLEEP
 | 
FAPI_PACKETFILTERMODE_OPT_OUT
,

3988 1, &
·‰”n_desc
, &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

3989 
num_f‹rs
++;

3990  
	`¦si_mlme_£t_·ck‘_f‹r
(
sdev
, 
dev
, 
pkt_f‹rs_Ën
, 
num_f‹rs
, 
pkt_f‹r_–em
);

3991 
	}
}

3993 
	$¦si_£t_¬p_·ck‘_f‹r
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

3995 
¦si_mlme_·‰”n_desc
 
·‰”n_desc
[
SLSI_MAX_PATTERN_DESC
];

3996 
num_·‰”n_desc
 = 0;

3997 
pkt_f‹rs_Ën
 = 0;

3998 
u8
 
num_f‹rs
 = 0;

3999 
¦si_mlme_pkt_f‹r_–em
 
pkt_f‹r_–em
[2];

4000 
»t
;

4001 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4002 
¦si_³”
 *
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

4004 ià(
	`WARN_ON
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
))

4005  -
EINVAL
;

4007 ià(
	`WARN_ON
(!
³”
))

4008  -
EINVAL
;

4010 ià(
	`¦si_is_´oxy_¬p_suµÜ‹d_Ú_­
(
³”
->
assoc_»¥_›
))

4013 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "Set ARP filter\n");

4016 
num_·‰”n_desc
 = 0;

4017 
	`SET_ETHERTYPE_PATTERN_DESC
(
·‰”n_desc
[
num_·‰”n_desc
], 
ETH_P_ARP
);

4018 
num_·‰”n_desc
++;

4021 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 0x14;

4022 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 2;

4023 
·‰”n_desc
[
num_·‰”n_desc
].
mask
[0] = 0xff;

4024 
·‰”n_desc
[
num_·‰”n_desc
].
mask
[1] = 0xff;

4025 
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
[0] = 0x00;

4026 
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
[1] = 0x01;

4027 
num_·‰”n_desc
++;

4029 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_ALL_ARP_FILTER_ID
,

4030 
FAPI_PACKETFILTERMODE_OPT_OUT
 | 
FAPI_PACKETFILTERMODE_OPT_OUT_SLEEP
,

4031 
num_·‰”n_desc
, 
·‰”n_desc
,

4032 &
pkt_f‹r_–em
[
num_f‹rs
],

4033 &
pkt_f‹rs_Ën
);

4034 
num_f‹rs
++;

4037 
num_·‰”n_desc
 = 0;

4038 
	`SET_ETHERTYPE_PATTERN_DESC
(
·‰”n_desc
[
num_·‰”n_desc
], 
ETH_P_ARP
);

4039 
num_·‰”n_desc
++;

4041 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 0x26;

4042 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 4;

4043 
	`memıy
(
·‰”n_desc
[
num_·‰”n_desc
].
mask
, 
addr_mask
,…©‹º_desc[num_·‰”n_desc].
mask_Ëngth
);

4044 
	`memıy
(
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
, &
ndev_vif
->
add»ss
,…©‹º_desc[num_·‰”n_desc].
mask_Ëngth
);

4045 
num_·‰”n_desc
++;

4047 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_LOCAL_ARP_FILTER_ID
,

4048 
FAPI_PACKETFILTERMODE_OPT_IN
 | 
FAPI_PACKETFILTERMODE_OPT_IN_SLEEP
,

4049 
num_·‰”n_desc
, 
·‰”n_desc
,

4050 &
pkt_f‹r_–em
[
num_f‹rs
],

4051 &
pkt_f‹rs_Ën
);

4052 
num_f‹rs
++;

4054 
»t
 = 
	`¦si_mlme_£t_·ck‘_f‹r
(
sdev
, 
dev
, 
pkt_f‹rs_Ën
, 
num_f‹rs
, 
pkt_f‹r_–em
);

4055 ià(
»t
)

4056  
»t
;

4058 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

4059 
pkt_f‹rs_Ën
 = 0;

4060 
num_f‹rs
 = 0;

4062 
num_·‰”n_desc
 = 0;

4063 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 0;

4064 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 
ETH_ALEN
;

4065 
	`SLSI_ETHER_COPY
(
·‰”n_desc
[
num_·‰”n_desc
].
mask
, 
addr_mask
);

4066 
	`memıy
(
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
, 
sŞic™ed_node_addr_mask
, 3);

4067 
	`memıy
(&
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
[3], &
ndev_vif
->
v6add»ss
.
s6_addr
[13], 3);

4068 
num_·‰”n_desc
++;

4071 
	`SET_ETHERTYPE_PATTERN_DESC
(
·‰”n_desc
[
num_·‰”n_desc
], 0x86DD);

4072 
num_·‰”n_desc
++;

4074 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 0x14;

4075 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 1;

4076 
·‰”n_desc
[
num_·‰”n_desc
].
mask
[0] = 0xff;

4077 
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
[0] = 0x3a;

4078 
num_·‰”n_desc
++;

4080 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 0x36;

4081 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 1;

4082 
·‰”n_desc
[
num_·‰”n_desc
].
mask
[0] = 0xff;

4083 
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
[0] = 0x87;

4084 
num_·‰”n_desc
++;

4086 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_LOCAL_NS_FILTER_ID
, 
FAPI_PACKETFILTERMODE_OPT_IN
,

4087 
num_·‰”n_desc
, 
·‰”n_desc
, &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4088 
num_f‹rs
++;

4090 
»t
 = 
	`¦si_mlme_£t_·ck‘_f‹r
(
sdev
, 
dev
, 
pkt_f‹rs_Ën
, 
num_f‹rs
, 
pkt_f‹r_–em
);

4091 ià(
»t
)

4092  
»t
;

4095  
»t
;

4096 
	}
}

4098 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


4099 
	$¦si_£t_’hªûd_pkt_f‹r
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

4101 
Ãtdev_vif
 *Ãtdev_viàğ
	`Ãtdev_´iv
(
dev
);

4102 
¦si_dev
 *
sdev
 = 
Ãtdev_vif
->sdev;

4103 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

4104 
»t
 = 0;

4105 
is_su¥’d
 = 0;

4106 
pkt_f‹r_’abË
;

4108 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

4109 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

4111 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
pkt_f‹r_’abË
)) {

4112 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4113 
	`kä“
(
ioùl_¬gs
);

4114  -
EINVAL
;

4117 ià(
pkt_f‹r_’abË
 != 0 &&…kt_filter_enable != 1) {

4118 
	`SLSI_ERR
(
sdev
, "Inv®id…kt_f‹r_’abË v®ue: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

4119 
	`kä“
(
ioùl_¬gs
);

4120  -
EINVAL
;

4123 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4124 
is_su¥’d
 = 
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
;

4125 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4127 ià(
is_su¥’d
) {

4128 
	`SLSI_ERR
(
sdev
, "Host is inƒarly suspend state.\n");

4129 
	`kä“
(
ioùl_¬gs
);

4130  -
EPERM
;

4133 
sdev
->
’hªûd_pkt_f‹r_’abËd
 = 
pkt_f‹r_’abË
;

4134 
	`SLSI_INFO
(
sdev
, "Enhªûd…ack‘ f‹¸i %s", (
pkt_f‹r_’abË
 ? "enabled" : "disabled"));

4135 
	`kä“
(
ioùl_¬gs
);

4136  
»t
;

4137 
	}
}

4139 
	$¦si_£t_İt_out_uniÿ¡_·ck‘_f‹r
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4141 
¦si_mlme_·‰”n_desc
 
·‰”n_desc
;

4142 
pkt_f‹rs_Ën
 = 0;

4143 
»t
 = 0;

4144 
¦si_mlme_pkt_f‹r_–em
 
pkt_f‹r_–em
;

4147 
·‰”n_desc
.
off£t
 = 0;

4148 
·‰”n_desc
.
mask_Ëngth
 = 
ETH_ALEN
;

4149 
	`mem£t
(
·‰”n_desc
.
mask
, 0xff, 
ETH_ALEN
);

4150 
	`memıy
(
·‰”n_desc
.
·‰”n
, 
dev
->
dev_addr
, 
ETH_ALEN
);

4152 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_OPT_OUT_ALL_FILTER_ID
,

4153 
FAPI_PACKETFILTERMODE_OPT_OUT_SLEEP
,

4154 1, &
·‰”n_desc
,

4155 &
pkt_f‹r_–em
, &
pkt_f‹rs_Ën
);

4157 
»t
 = 
	`¦si_mlme_£t_·ck‘_f‹r
(
sdev
, 
dev
, 
pkt_f‹rs_Ën
, 1, &
pkt_f‹r_–em
);

4159  
»t
;

4160 
	}
}

4162 
	$¦si_£t_İt_š_tı4_·ck‘_f‹r
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4164 
¦si_mlme_·‰”n_desc
 
·‰”n_desc
[2];

4165 
pkt_f‹rs_Ën
 = 0;

4166 
»t
 = 0;

4167 
¦si_mlme_pkt_f‹r_–em
 
pkt_f‹r_–em
;

4170 
·‰”n_desc
[0].
off£t
 = 
ETH_ALEN
 + ETH_ALEN;

4171 
·‰”n_desc
[0].
mask_Ëngth
 = 2;

4172 
·‰”n_desc
[0].
mask
[0] = 0xff;

4173 
·‰”n_desc
[0].
mask
[1] = 0xff;

4174 
·‰”n_desc
[0].
·‰”n
[0] = 0x08;

4175 
·‰”n_desc
[0].
·‰”n
[1] = 0x00;

4179 
·‰”n_desc
[1].
off£t
 = 23;

4180 
·‰”n_desc
[1].
mask_Ëngth
 = 1;

4181 
·‰”n_desc
[1].
mask
[0] = 0xff;

4182 
·‰”n_desc
[1].
·‰”n
[0] = 
IPPROTO_TCP
;

4183 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_OPT_IN_TCP4_FILTER_ID
,

4184 
FAPI_PACKETFILTERMODE_OPT_IN_SLEEP
,

4186 
·‰”n_desc
,

4187 &
pkt_f‹r_–em
,

4188 &
pkt_f‹rs_Ën
);

4190 
»t
 = 
	`¦si_mlme_£t_·ck‘_f‹r
(
sdev
, 
dev
, 
pkt_f‹rs_Ën
, 1, &
pkt_f‹r_–em
);

4192  
»t
;

4193 
	}
}

4195 
	$¦si_£t_İt_š_tı6_·ck‘_f‹r
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4197 
¦si_mlme_·‰”n_desc
 
·‰”n_desc
[2];

4198 
pkt_f‹rs_Ën
 = 0;

4199 
»t
 = 0;

4200 
¦si_mlme_pkt_f‹r_–em
 
pkt_f‹r_–em
;

4203 
·‰”n_desc
[0].
off£t
 = 
ETH_ALEN
 + ETH_ALEN;

4204 
·‰”n_desc
[0].
mask_Ëngth
 = 2;

4205 
·‰”n_desc
[0].
mask
[0] = 0xff;

4206 
·‰”n_desc
[0].
mask
[1] = 0xff;

4207 
·‰”n_desc
[0].
·‰”n
[0] = 0x86;

4208 
·‰”n_desc
[0].
·‰”n
[1] = 0xdd;

4210 
·‰”n_desc
[1].
off£t
 = (
‘hhdr
) + 6;

4211 
·‰”n_desc
[1].
mask_Ëngth
 = 1;

4212 
·‰”n_desc
[1].
mask
[0] = 0xff;

4213 
·‰”n_desc
[1].
·‰”n
[0] = 
IPPROTO_TCP
;

4215 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_OPT_IN_TCP6_FILTER_ID
,

4216 
FAPI_PACKETFILTERMODE_OPT_IN_SLEEP
,

4218 
·‰”n_desc
,

4219 &
pkt_f‹r_–em
,

4220 &
pkt_f‹rs_Ën
);

4222 
»t
 = 
	`¦si_mlme_£t_·ck‘_f‹r
(
sdev
, 
dev
, 
pkt_f‹rs_Ën
, 1, &
pkt_f‹r_–em
);

4224  
»t
;

4225 
	}
}

4228 
	$¦si_£t_muÉiÿ¡_·ck‘_f‹rs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4230 
¦si_mlme_·‰”n_desc
 
·‰”n_desc
[3];

4231 
pkt_f‹rs_Ën
 = 0;

4232 
u8
 
i
, 
num_f‹rs
 = 0;

4233 
u8
 
num_·‰”n_desc
 = 0;

4234 
»t
 = 0;

4235 
¦si_mlme_pkt_f‹r_–em
 *
pkt_f‹r_–em
 = 
NULL
;

4236 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4237 
u8
 
mc_f‹r_id
, 
mc_f‹r_couÁ
;

4240 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "S‘ møf‹r ,»gd møadd¸couÁ =%d\n", 
ndev_vif
->
¡a
.
»gd_mc_addr_couÁ
);

4242 
mc_f‹r_couÁ
 = 
ndev_vif
->
¡a
.
»gd_mc_addr_couÁ
;

4243 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

4244 
pkt_f‹r_–em
 = 
	`km®loc
(((
SLSI_MC_ADDR_ENTRY_MAX
 + 2è* (
¦si_mlme_pkt_f‹r_–em
)), 
GFP_KERNEL
);

4246 
pkt_f‹r_–em
 = 
	`km®loc
(((
SLSI_MC_ADDR_ENTRY_MAX
 + 1è* (
¦si_mlme_pkt_f‹r_–em
)), 
GFP_KERNEL
);

4248 ià(!
pkt_f‹r_–em
) {

4249 
	`SLSI_NET_ERR
(
dev
, "ERROR Memory‡llocation failure\n");

4250  -
ENOMEM
;

4254 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 0;

4255 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 
ETH_ALEN
;

4256 
	`mem£t
(
·‰”n_desc
[
num_·‰”n_desc
].
mask
, 0xff, 
ETH_ALEN
);

4257 
	`memıy
(
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
, 
dev
->
dev_addr
, 
ETH_ALEN
);

4258 
num_·‰”n_desc
++;

4260 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 
ETH_ALEN
 + ETH_ALEN;

4261 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 2;

4262 
·‰”n_desc
[
num_·‰”n_desc
].
mask
[0] = 0xff;

4263 
·‰”n_desc
[
num_·‰”n_desc
].
mask
[1] = 0xff;

4264 
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
[0] = 0x08;

4265 
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
[1] = 0x00;

4266 
num_·‰”n_desc
++;

4268 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = (
‘hhdr
è+ 
	`off£tof
(
hdr
, 
daddr
);

4269 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 1;

4270 
·‰”n_desc
[
num_·‰”n_desc
].
mask
[0] = 0xf0;

4271 
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
[0] = 0xe0;

4272 
num_·‰”n_desc
++;

4274 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_MULTI_TO_UNICAST_IPV4_ID
,

4275 
FAPI_PACKETFILTERMODE_OPT_OUT_SLEEP
,

4276 
num_·‰”n_desc
, 
·‰”n_desc
,

4277 &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4278 
num_f‹rs
++;

4280 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

4281 
num_·‰”n_desc
 = 0;

4284 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 0;

4285 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 
ETH_ALEN
;

4286 
	`SLSI_ETHER_COPY
(
·‰”n_desc
[
num_·‰”n_desc
].
mask
, 
addr_mask
);

4287 
	`SLSI_ETHER_COPY
(
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
, 
dev
->
dev_addr
);

4288 
num_·‰”n_desc
++;

4290 
	`SET_ETHERTYPE_PATTERN_DESC
(
·‰”n_desc
[
num_·‰”n_desc
], 
ETH_P_IPV6
);

4291 
num_·‰”n_desc
++;

4293 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = (
‘hhdr
è+ 
	`off£tof
(
v6hdr
, 
daddr
);

4294 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 1;

4295 
·‰”n_desc
[
num_·‰”n_desc
].
mask
[0] = 0xff;

4296 
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
[0] = 0xff;

4297 
num_·‰”n_desc
++;

4299 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_MULTI_TO_UNICAST_IPv6_ID
,

4300 
FAPI_PACKETFILTERMODE_OPT_OUT_SLEEP
,

4301 
num_·‰”n_desc
, 
·‰”n_desc
,

4302 &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4303 
num_f‹rs
++;

4307 
·‰”n_desc
[0].
off£t
 = 0;

4308 
·‰”n_desc
[0].
mask_Ëngth
 = 
ETH_ALEN
;

4309 
	`SLSI_ETHER_COPY
(
·‰”n_desc
[0].
mask
, 
addr_mask
);

4311 
i
 = 0; i < 
mc_f‹r_couÁ
; i++) {

4312 
	`SLSI_ETHER_COPY
(
·‰”n_desc
[0].
·‰”n
, 
ndev_vif
->
¡a
.
»gd_mc_addr
[
i
]);

4313 
mc_f‹r_id
 = 
SLSI_REGD_MC_FILTER_ID
 + 
i
;

4314 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


4315 ià(
sdev
->
’hªûd_pkt_f‹r_’abËd
)

4316 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
mc_f‹r_id
,

4317 
FAPI_PACKETFILTERMODE_OPT_IN
,

4318 1, &
·‰”n_desc
[0],

4319 &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4322 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
mc_f‹r_id
,

4323 
FAPI_PACKETFILTERMODE_OPT_IN
 |

4324 
FAPI_PACKETFILTERMODE_OPT_IN_SLEEP
,

4325 1, &
·‰”n_desc
[0],

4326 &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4327 
num_f‹rs
++;

4330 
i
 = 
mc_f‹r_couÁ
; i < 
SLSI_MC_ADDR_ENTRY_MAX
; i++) {

4331 
mc_f‹r_id
 = 
SLSI_REGD_MC_FILTER_ID
 + 
i
;

4332 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
mc_f‹r_id
, 0, 0, 
NULL
, &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4333 
num_f‹rs
++;

4336 
»t
 = 
	`¦si_mlme_£t_·ck‘_f‹r
(
sdev
, 
dev
, 
pkt_f‹rs_Ën
, 
num_f‹rs
, 
pkt_f‹r_–em
);

4337 
	`kä“
(
pkt_f‹r_–em
);

4339  
»t
;

4340 
	}
}

4342 
	$¦si_ş—r_·ck‘_f‹rs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4344 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4345 
¦si_³”
 *
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

4347 
u8
 
i
;

4348 
pkt_f‹rs_Ën
 = 0;

4349 
num_f‹rs
 = 0;

4350 
»t
 = 0;

4351 
¦si_mlme_pkt_f‹r_–em
 *
pkt_f‹r_–em
;

4352 
u8
 
mc_f‹r_id
;

4354 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4356 ià(
	`WARN_ON
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
))

4357  -
EINVAL
;

4359 ià(
	`WARN_ON
(!
³”
))

4360  -
EINVAL
;

4362 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "Clear filters on Screen on");

4365 
num_f‹rs
 = 
ndev_vif
->
¡a
.
»gd_mc_addr_couÁ
 + 1 + 
SLSI_SCREEN_OFF_FILTERS_COUNT
;

4366 ià((
	`¦si_is_´oxy_¬p_suµÜ‹d_Ú_­
(
³”
->
assoc_»¥_›
)è=ğ
çl£
) {

4367 
num_f‹rs
++;

4368 
num_f‹rs
++;

4369 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

4370 
num_f‹rs
++;

4374 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


4375 ià(
sdev
->
’hªûd_pkt_f‹r_’abËd
) {

4376 
num_f‹rs
++;

4377 
num_f‹rs
++;

4378 
num_f‹rs
++;

4381 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

4382 
num_f‹rs
++;

4384 
pkt_f‹r_–em
 = 
	`km®loc
((
num_f‹rs
 * (
¦si_mlme_pkt_f‹r_–em
)), 
GFP_KERNEL
);

4385 ià(!
pkt_f‹r_–em
) {

4386 
	`SLSI_NET_ERR
(
dev
, "ERROR Memory‡llocation failure");

4387  -
ENOMEM
;

4390 
num_f‹rs
 = 0;

4391 
i
 = 0; i < 
ndev_vif
->
¡a
.
»gd_mc_addr_couÁ
; i++) {

4392 
mc_f‹r_id
 = 
SLSI_REGD_MC_FILTER_ID
 + 
i
;

4393 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
mc_f‹r_id
, 0, 0, 
NULL
, &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4394 
num_f‹rs
++;

4396 ià((
	`¦si_is_´oxy_¬p_suµÜ‹d_Ú_­
(
³”
->
assoc_»¥_›
)è=ğ
çl£
) {

4397 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_LOCAL_ARP_FILTER_ID
, 0, 0, 
NULL
, &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4398 
num_f‹rs
++;

4399 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_ALL_ARP_FILTER_ID
, 0, 0, 
NULL
, &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4400 
num_f‹rs
++;

4401 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

4402 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_LOCAL_NS_FILTER_ID
, 0, 0, 
NULL
, &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4403 
num_f‹rs
++;

4407 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_ALL_BC_MC_FILTER_ID
, 0, 0, 
NULL
, &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4408 
num_f‹rs
++;

4410 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


4411 ià(
sdev
->
’hªûd_pkt_f‹r_’abËd
) {

4412 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_OPT_OUT_ALL_FILTER_ID
, 0, 0, 
NULL
,

4413 &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4414 
num_f‹rs
++;

4415 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_OPT_IN_TCP4_FILTER_ID
, 0, 0, 
NULL
,

4416 &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4417 
num_f‹rs
++;

4418 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_OPT_IN_TCP6_FILTER_ID
, 0, 0, 
NULL
,

4419 &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4420 
num_f‹rs
++;

4423 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_MULTI_TO_UNICAST_IPV4_ID
, 0, 0, 
NULL
,

4424 &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4425 
num_f‹rs
++;

4426 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

4427 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_MULTI_TO_UNICAST_IPv6_ID
, 0, 0, 
NULL
,

4428 &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4429 
num_f‹rs
++;

4431 
»t
 = 
	`¦si_mlme_£t_·ck‘_f‹r
(
sdev
, 
dev
, 
pkt_f‹rs_Ën
, 
num_f‹rs
, 
pkt_f‹r_–em
);

4432 
	`kä“
(
pkt_f‹r_–em
);

4433  
»t
;

4434 
	}
}

4436 
	$¦si_upd©e_·ck‘_f‹rs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4438 
»t
 = 0;

4440 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4442 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4443 
	`WARN_ON
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
);

4445 
»t
 = 
	`¦si_£t_muÉiÿ¡_·ck‘_f‹rs
(
sdev
, 
dev
);

4446 ià(
»t
)

4447  
»t
;

4449 
»t
 = 
	`¦si_£t_¬p_·ck‘_f‹r
(
sdev
, 
dev
);

4450 ià(
»t
)

4451  
»t
;

4453 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


4454 ià(
sdev
->
’hªûd_pkt_f‹r_’abËd
) {

4455 
»t
 = 
	`¦si_£t_İt_out_uniÿ¡_·ck‘_f‹r
(
sdev
, 
dev
);

4456 ià(
»t
)

4457  
»t
;

4458 
»t
 = 
	`¦si_£t_İt_š_tı4_·ck‘_f‹r
(
sdev
, 
dev
);

4459 ià(
»t
)

4460  
»t
;

4461 
»t
 = 
	`¦si_£t_İt_š_tı6_·ck‘_f‹r
(
sdev
, 
dev
);

4462 ià(
»t
)

4463  
»t
;

4466  
	`¦si_£t_commÚ_·ck‘_f‹rs
(
sdev
, 
dev
);

4467 
	}
}

4469 
	#IPV6_PF_PATTERN_MASK
 0xf0

	)

4470 
	#IPV6_PF_PATTERN
 0x60

	)

4472 #ifdeà
CONFIG_SCSC_WLAN_DISABLE_NAT_KA


4473 
	#SLSI_ON_CONNECT_FILTERS_COUNT
 2

	)

4475 
	#SLSI_ON_CONNECT_FILTERS_COUNT
 3

	)

4478 
	$¦si_£t_·ck‘_f‹rs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4480 
¦si_mlme_·‰”n_desc
 
·‰”n_desc
[
SLSI_MAX_PATTERN_DESC
];

4481 
num_·‰”n_desc
 = 0;

4482 
pkt_f‹rs_Ën
 = 0;

4483 
num_f‹rs
 = 0;

4485 
¦si_mlme_pkt_f‹r_–em
 
pkt_f‹r_–em
[
SLSI_ON_CONNECT_FILTERS_COUNT
];

4486 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4487 
¦si_³”
 *
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

4488 cÚ¡ 
u8
 *
›
;

4490 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

4493 ià(
	`WARN_ON
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
))

4496 ià(
	`WARN_ON
(!
³”
))

4499 ià(
	`WARN_ON
(!
³”
->
assoc_»¥_›
))

4502 #ià!(
	`IS_ENABLED
(
CONFIG_IPV6
))

4504 
num_·‰”n_desc
 = 0;

4505 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 0x0E;

4506 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 1;

4507 
·‰”n_desc
[
num_·‰”n_desc
].
mask
[0] = 
IPV6_PF_PATTERN_MASK
;

4508 
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
[0] = 
IPV6_PF_PATTERN
;

4509 
num_·‰”n_desc
++;

4511 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_ALL_IPV6_PKTS_FILTER_ID
,

4512 
FAPI_PACKETFILTERMODE_OPT_OUT
 | 
FAPI_PACKETFILTERMODE_OPT_OUT_SLEEP
,

4513 
num_·‰”n_desc
, 
·‰”n_desc
, &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4514 
num_f‹rs
++;

4517 
›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_WFA
, 
SLSI_WLAN_OUI_TYPE_WFA_HS20_IND
,

4518 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,‚dev_vif->¡a.¡a_bss->›s->
Ën
);

4520 ià(
›
) {

4521 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "Connectedo HS2 AP ");

4523 ià(
	`¦si_is_´oxy_¬p_suµÜ‹d_Ú_­
(
³”
->
assoc_»¥_›
)) {

4524 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "Proxy ARP service supported on HS2 AP ");

4530 
num_·‰”n_desc
 = 0;

4531 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 0;

4532 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 
ETH_ALEN
;

4533 
	`SLSI_ETHER_COPY
(
·‰”n_desc
[
num_·‰”n_desc
].
mask
, 
addr_mask
);

4534 
	`SLSI_ETHER_COPY
(
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
, 
addr_mask
);

4535 
num_·‰”n_desc
++;

4537 
	`SET_ETHERTYPE_PATTERN_DESC
(
·‰”n_desc
[
num_·‰”n_desc
], 
ETH_P_ARP
);

4538 
num_·‰”n_desc
++;

4540 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_PROXY_ARP_FILTER_ID
, 
FAPI_PACKETFILTERMODE_OPT_OUT
,

4541 
num_·‰”n_desc
, 
·‰”n_desc
, &
pkt_f‹r_–em
[
num_f‹rs
],

4542 &
pkt_f‹rs_Ën
);

4543 
num_f‹rs
++;

4545 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

4550 
num_·‰”n_desc
 = 0;

4552 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 0;

4553 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 
ETH_ALEN
;

4554 
	`SLSI_ETHER_COPY
(
·‰”n_desc
[
num_·‰”n_desc
].
mask
, 
addr_mask
);

4555 
	`SLSI_ETHER_COPY
(
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
, 
sŞic™ed_node_addr_mask
);

4556 
num_·‰”n_desc
++;

4558 
	`SET_ETHERTYPE_PATTERN_DESC
(
·‰”n_desc
[
num_·‰”n_desc
], 0x86DD);

4559 
num_·‰”n_desc
++;

4561 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 0x14;

4562 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 1;

4563 
·‰”n_desc
[
num_·‰”n_desc
].
mask
[0] = 0xff;

4564 
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
[0] = 0x3a;

4565 
num_·‰”n_desc
++;

4567 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 0x36;

4568 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 1;

4569 
·‰”n_desc
[
num_·‰”n_desc
].
mask
[0] = 0xff;

4570 
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
[0] = 0x88;

4571 
num_·‰”n_desc
++;

4573 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_PROXY_ARP_NA_FILTER_ID
, 
FAPI_PACKETFILTERMODE_OPT_OUT
,

4574 
num_·‰”n_desc
, 
·‰”n_desc
, &
pkt_f‹r_–em
[
num_f‹rs
],

4575 &
pkt_f‹rs_Ën
);

4576 
num_f‹rs
++;

4581 #iâdeà
CONFIG_SCSC_WLAN_DISABLE_NAT_KA


4583 cÚ¡ 
u8
 
Çt_ka_·‰”n
[4] = { 0x11, 0x94, 0x00, 0x09 };

4585 
num_·‰”n_desc
 = 0;

4586 
·‰”n_desc
[
num_·‰”n_desc
].
off£t
 = 0x24;

4587 
·‰”n_desc
[
num_·‰”n_desc
].
mask_Ëngth
 = 4;

4588 
	`memıy
(
·‰”n_desc
[
num_·‰”n_desc
].
mask
, 
addr_mask
, 4);

4589 
	`memıy
(
·‰”n_desc
[
num_·‰”n_desc
].
·‰”n
, 
Çt_ka_·‰”n
, 4);

4590 
num_·‰”n_desc
++;

4592 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_NAT_IPSEC_FILTER_ID
, 
FAPI_PACKETFILTERMODE_OPT_OUT_SLEEP
,

4593 
num_·‰”n_desc
, 
·‰”n_desc
, &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4594 
num_f‹rs
++;

4598 ià(
num_f‹rs
)

4599 
	`¦si_mlme_£t_·ck‘_f‹r
(
sdev
, 
dev
, 
pkt_f‹rs_Ën
, 
num_f‹rs
, 
pkt_f‹r_–em
);

4600 
	}
}

4602 
	$¦si__add»ss_chªged
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
__be32
 
add»ss
)

4604 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4605 
»t
 = 0;

4610 ià(
ndev_vif
->
add»ss
 != ipaddress)

4611 
ndev_vif
->
add»ss
 = ipaddress;

4613 ià(
ndev_vif
->
aùiv©ed
 && (ndev_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
)) {

4614 #ià!(
	`IS_ENABLED
(
CONFIG_IPV6
))

4615 
¦si_mlme_·‰”n_desc
 
·‰”n_desc
[1];

4616 
u8
 
num_·‰”ns
 = 0;

4617 
¦si_mlme_pkt_f‹r_–em
 
pkt_f‹r_–em
[1];

4618 
pkt_f‹rs_Ën
 = 0;

4619 
u8
 
num_f‹rs
 = 0;

4622 
ndev_vif
->
add»ss
 = ipaddress;

4623 
»t
 = 
	`¦si_mlme_£t__add»ss
(
sdev
, 
dev
);

4624 ià(
»t
 != 0)

4625 
	`SLSI_NET_ERR
(
dev
, "¦si_mlme_£t__add»s ERROR.„‘=%d", 
»t
);

4627 #ià!(
	`IS_ENABLED
(
CONFIG_IPV6
))

4629 
·‰”n_desc
[
num_·‰”ns
].
off£t
 = 0x0E;

4630 
·‰”n_desc
[
num_·‰”ns
].
mask_Ëngth
 = 0x01;

4631 
·‰”n_desc
[
num_·‰”ns
].
mask
[0] = 
IPV6_PF_PATTERN_MASK
;

4632 
·‰”n_desc
[
num_·‰”ns
++].
·‰”n
[0] = 
IPV6_PF_PATTERN
;

4634 
	`¦si_ü—‹_·ck‘_f‹r_–em’t
(
SLSI_AP_ALL_IPV6_PKTS_FILTER_ID
, 
FAPI_PACKETFILTERMODE_OPT_OUT_SLEEP
,

4635 
num_·‰”ns
, 
·‰”n_desc
, &
pkt_f‹r_–em
[
num_f‹rs
], &
pkt_f‹rs_Ën
);

4636 
num_f‹rs
++;

4637 
»t
 = 
	`¦si_mlme_£t_·ck‘_f‹r
(
sdev
, 
dev
, 
pkt_f‹rs_Ën
, 
num_f‹rs
, 
pkt_f‹r_–em
);

4638 ià(
»t
 != 0)

4639 
	`SLSI_NET_ERR
(
dev
, "¦si_mlme_£t_·ck‘_f‹¸Ô‘uº :%dèERROR\n", 
»t
);

4641 } ià((
ndev_vif
->
aùiv©ed
) &&

4642 (
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) &&

4643 (
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
)) {

4644 
¦si_³”
 *
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

4646 ià(
	`WARN_ON
(!
³”
))

4647  -
EINVAL
;

4649 
ndev_vif
->
add»ss
 = ipaddress;

4650 
»t
 = 
	`¦si_mlme_£t__add»ss
(
sdev
, 
dev
);

4651 ià(
»t
 != 0)

4652 
	`SLSI_NET_ERR
(
dev
, "¦si_mlme_£t__add»s ERROR.„‘=%d", 
»t
);

4654 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

4655 
»t
 = 
	`¦si_mlme_£t_v6_add»ss
(
sdev
, 
dev
);

4656 ià(
»t
 != 0)

4657 
	`SLSI_NET_ERR
(
dev
, "¦si_mlme_£t_v6_add»s ERROR.„‘=%d", 
»t
);

4659 ià(!(
³”
->
ÿ·b™›s
 & 
WLAN_CAPABILITY_PRIVACY
) ||

4660 (
ndev_vif
->
¡a
.
group_key_£t
 && 
³”
->
·œwi£_key_£t
) ||

4661 
ndev_vif
->
¡a
.
w•_key_£t
)

4662 
	`¦si_£nd_g¿tu™ous_¬p
(
sdev
, 
dev
);

4664 
ndev_vif
->
¡a
.
g¿tu™ous_¬p_Ãeded
 = 
Œue
;

4666 
	`¦si_mlme_pow”mgt
(
sdev
, 
dev
, 
ndev_vif
->
£t_pow”_mode
);

4668  
»t
;

4669 
	}
}

4671 
	#SLSI_AP_AUTO_CHANLS_LIST_FROM_HOSTAPD_MAX
 3

	)

4673 
	$¦si_auto_chª_£Ëù_sÿn
(
¦si_dev
 *
sdev
, 
n_chªÃls
, 
›“80211_chªÃl
 *
chªÃls
[])

4675 
Ãt_deviû
 *
dev
;

4676 
Ãtdev_vif
 *
ndev_vif
;

4677 
sk_buff_h—d
 
unique_sÿn_»suÉs
;

4678 
sÿn_»suÉ_couÁ
[
SLSI_AP_AUTO_CHANLS_LIST_FROM_HOSTAPD_MAX
] = { 0, 0, 0 };

4679 
i
, 
j
;

4680 
r
 = 0;

4681 
£Ëùed_šdex
 = 0;

4682 
mš_šdex
 = 0;

4683 
u32
 
äeqdiff
 = 0;

4685 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

4686 
	`SLSI_WARN
(
sdev
, "not supported in WlanLite mode\n");

4687  -
EOPNOTSUPP
;

4690 
	`skb_queue_h—d_š™
(&
unique_sÿn_»suÉs
);

4692 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

4693 ià(!
dev
) {

4694 
r
 = -
EINVAL
;

4695  
r
;

4698 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4699 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

4701 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
) {

4702 
r
 = -
EBUSY
;

4703 
ex™_w™h_vif
;

4705 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
 = 
Œue
;

4706 
r
 = 
	`¦si_mlme_add_sÿn
(
sdev
,

4707 
dev
,

4708 
FAPI_SCANTYPE_AP_AUTO_CHANNEL_SELECTION
,

4709 
FAPI_REPORTMODE_REAL_TIME
,

4711 
NULL
,

4712 
n_chªÃls
,

4713 
chªÃls
,

4714 
NULL
,

4715 
NULL
,

4717 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
);

4719 ià(
r
 == 0) {

4720 
sk_buff
 *
unique_sÿn
;

4721 
sk_buff
 *
sÿn
;

4723 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

4724 
sÿn
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->sÿn[
SLSI_SCAN_HW_ID
], 
NULL
);

4725 
sÿn
) {

4726 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
sÿn
);

4727 
›“80211_chªÃl
 *
chªÃl
;

4730 
	`skb_queue_w®k
(&
unique_sÿn_»suÉs
, 
unique_sÿn
) {

4731 
›“80211_mgmt
 *
unique_mgmt
 = 
	`çpi_g‘_mgmt
(
unique_sÿn
);

4733 ià(
	`com·»_‘h”_addr
(
mgmt
->
bssid
, 
unique_mgmt
->bssid) == 0) {

4734 
	`kä“_skb
(
sÿn
);

4735 
Ãxt_sÿn
;

4739 
	`skb_queue_h—d
(&
unique_sÿn_»suÉs
, 
sÿn
);

4741 
chªÃl
 = 
	`¦si_fšd_sÿn_chªÃl
(
sdev
, 
mgmt
, 
	`çpi_g‘_mgm’
(
sÿn
), 
	`çpi_g‘_u16
(sÿn, 
u
.
mlme_sÿn_šd
.
chªÃl_äequ’cy
) / 2);

4742 ià(!
chªÃl
)

4743 
Ãxt_sÿn
;

4746 
i
 = 0, 
j
 = 0; i < 
SLSI_AP_AUTO_CHANLS_LIST_FROM_HOSTAPD_MAX
 && 
chªÃls
[j]; i++, j = j + 5) {

4747 ià(
chªÃl
->
ûÁ”_äeq
 =ğ
chªÃls
[
j
]->center_freq) {

4748 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "exaù m©ch:%d\n", 
i
);

4749 
sÿn_»suÉ_couÁ
[
i
] += 5;

4750 
Ãxt_sÿn
;

4752 
äeqdiff
 = 
	`abs
(()
chªÃl
->
ûÁ”_äeq
 - (
chªÃls
[
j
]->center_freq));

4753 ià(
äeqdiff
 <= 20) {

4754 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "ov”Ïµšg:%d, f»qdiff:%d\n", 
i
, 
äeqdiff
);

4755 
sÿn_»suÉ_couÁ
[
i
] +ğ(5 - (
äeqdiff
 / 5));

4759 
Ãxt_sÿn
:

4760 
sÿn
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->sÿn[
SLSI_SCAN_HW_ID
], 
NULL
);

4762 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

4765 
i
 = 0, 
j
 = 0; i < 
SLSI_AP_AUTO_CHANLS_LIST_FROM_HOSTAPD_MAX
; i++, j = j + 5) {

4766 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "scÜe[%d]:%d\n", 
i
, 
sÿn_»suÉ_couÁ
[i]);

4767 ià(
sÿn_»suÉ_couÁ
[
i
] <ğsÿn_»suÉ_couÁ[
mš_šdex
]) {

4768 
mš_šdex
 = 
i
;

4769 
£Ëùed_šdex
 = 
j
;

4772 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "£Ëùed:%d w™h scÜe:%d\n", 
£Ëùed_šdex
, 
sÿn_»suÉ_couÁ
[
mš_šdex
]);

4774 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4775 
sdev
->
deviû_cÚfig
.
­_auto_chª
 = 
chªÃls
[
£Ëùed_šdex
]->
hw_v®ue
 & 0xFF;

4776 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4778 
	`SLSI_INFO
(
sdev
, "ChªÃÈ£Ëùed = %d", sdev->
deviû_cÚfig
.
­_auto_chª
);

4780 
	`skb_queue_purge
(&
unique_sÿn_»suÉs
);

4781 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
 = 
çl£
;

4783 
ex™_w™h_vif
:

4784 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

4785  
r
;

4786 
	}
}

4788 
	$¦si_£t_boo¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4790 
”rÜ
 = 0;

4792 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4793 
”rÜ
 = 
	`¦si_£t_mib_rssi_boo¡
(
sdev
, 
dev
, 
SLSI_PSID_UNIFI_ROAM_RSSI_BOOST
, 1,

4794 
sdev
->
deviû_cÚfig
.
rssi_boo¡_2g
);

4795 ià(
”rÜ
)

4796 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg boo¡ v®uFÜ 2g‡á”‡ddšg vif.ƒ¼Ü = %d\n", 
”rÜ
);

4797 
”rÜ
 = 
	`¦si_£t_mib_rssi_boo¡
(
sdev
, 
dev
, 
SLSI_PSID_UNIFI_ROAM_RSSI_BOOST
, 2,

4798 
sdev
->
deviû_cÚfig
.
rssi_boo¡_5g
);

4799 ià(
”rÜ
)

4800 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg boo¡ v®ufÜ 5g‡á”‡ddšg vià.ƒ¼Ü = %d\n", 
”rÜ
);

4801 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

4802  
”rÜ
;

4803 
	}
}

4809 
	$¦si_p2p_roc_du¿tiÚ_expœy_wÜk
(
wÜk_¡ruù
 *
wÜk
)

4811 
Ãtdev_vif
 *
ndev_vif
 = 
	`cÚš”_of
((
d–ayed_wÜk
 *)
wÜk
, Ãtdev_vif, 
unsync
.
roc_expœy_wÜk
);

4813 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4818 ià(
ndev_vif
->
sdev
->
p2p_¡©e
 =ğ
P2P_IDLE_NO_VIF
) {

4819 
	`SLSI_NET_DBG1
(
ndev_vif
->
wdev
.
Ãtdev
, 
SLSI_CFG80211
, "P2P unsync vif is‚ot…resent\n");

4820 
ex™
;

4823 
	`SLSI_NET_DBG3
(
ndev_vif
->
wdev
.
Ãtdev
, 
SLSI_CFG80211
, "Send ROCƒxpiredƒvent\n");

4826 ià(
ndev_vif
->
sdev
->
p2p_¡©e
 !ğ
P2P_ACTION_FRAME_TX_RX
) {

4830 ià(!
ndev_vif
->
drv_š_p2p_´oûdu»
) {

4831 ià(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
))

4832 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
);

4833 
	`queue_d–ayed_wÜk
(
ndev_vif
->
sdev
->
deviû_wq
, &ndev_vif->
unsync
.
un£t_chªÃl_expœy_wÜk
,

4834 
	`m£cs_to_jiff›s
(
SLSI_P2P_UNSET_CHANNEL_EXTRA_MSEC
));

4836 
	`¦si_p2p_queue_unsync_vif_d–_wÜk
(
ndev_vif
, 
SLSI_P2P_UNSYNC_VIF_EXTRA_MSEC
);

4837 
	`SLSI_P2P_STATE_CHANGE
(
ndev_vif
->
sdev
, 
P2P_IDLE_VIF_ACTIVE
);

4840 
	`cfg80211_»maš_Ú_chªÃl_expœed
(&
ndev_vif
->
wdev
,‚dev_vif->
unsync
.
roc_cook›
,‚dev_vif->
chª
, 
GFP_KERNEL
);

4841 
ex™
:

4842 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4843 
	}
}

4849 
	$¦si_p2p_unsync_vif_d–‘e_wÜk
(
wÜk_¡ruù
 *
wÜk
)

4851 
Ãtdev_vif
 *
ndev_vif
 = 
	`cÚš”_of
((
d–ayed_wÜk
 *)
wÜk
, Ãtdev_vif, 
unsync
.
d–_vif_wÜk
);

4853 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4854 
	`SLSI_NET_DBG1
(
ndev_vif
->
wdev
.
Ãtdev
, 
SLSI_CFG80211
, "Delete vif durationƒxpired - Deactivate unsync vif\n");

4855 
	`¦si_p2p_vif_d—ùiv©e
(
ndev_vif
->
sdev
,‚dev_vif->
wdev
.
Ãtdev
, 
Œue
);

4856 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4857 
	}
}

4863 
	$¦si_p2p_un£t_chªÃl_expœy_wÜk
(
wÜk_¡ruù
 *
wÜk
)

4865 
Ãtdev_vif
 *
ndev_vif
 = 
	`cÚš”_of
((
d–ayed_wÜk
 *)
wÜk
, netdev_vif,

4866 
unsync
.
un£t_chªÃl_expœy_wÜk
);

4867 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

4868 
Ãt_deviû
 *
dev
 = 
ndev_vif
->
wdev
.
Ãtdev
;

4870 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4871 ià(
ndev_vif
->
aùiv©ed
) {

4872 ià(!
ndev_vif
->
drv_š_p2p_´oûdu»
) {

4874 ià(
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_PROBE_RESPONSE
, 
NULL
, 0) != 0)

4875 
	`SLSI_NET_ERR
(
dev
, "Clearing Probe Response IEs failed for unsync vif\n");

4876 
	`¦si_unsync_vif_£t_´obe_r¥_›
(
ndev_vif
, 
NULL
, 0);

4879 ià(
ndev_vif
->
driv”_chªÃl
 != 0) {

4880 
	`SLSI_NET_DBG1
(
ndev_vif
->
wdev
.
Ãtdev
, 
SLSI_CFG80211
,

4882 
	`¦si_mlme_un£t_chªÃl_»q
(
sdev
, 
dev
);

4883 
ndev_vif
->
driv”_chªÃl
 = 0;

4887 
	`SLSI_NET_ERR
(
dev
, "P2P vif is‚ot‡ctivated\n");

4889 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4890 
	}
}

4893 
	$¦si_p2p_š™
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
)

4895 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "Initialize P2P - Init P2P stateo P2P_IDLE_NO_VIF\n");

4896 
sdev
->
p2p_¡©e
 = 
P2P_IDLE_NO_VIF
;

4897 
sdev
->
p2p_group_exp_äame
 = 
SLSI_PA_INVALID
;

4899 
ndev_vif
->
vif_ty³
 = 
FAPI_VIFTYPE_UNSYNCHRONISED
;

4900 
ndev_vif
->
unsync
.
¦si_p2p_cÚtšuous_fuÎsÿn
 = 
çl£
;

4903 
	`INIT_DELAYED_WORK
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
, 
¦si_p2p_roc_du¿tiÚ_expœy_wÜk
);

4904 
	`INIT_DELAYED_WORK
(&
ndev_vif
->
unsync
.
d–_vif_wÜk
, 
¦si_p2p_unsync_vif_d–‘e_wÜk
);

4905 
	`INIT_DELAYED_WORK
(&
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
, 
¦si_p2p_un£t_chªÃl_expœy_wÜk
);

4907 
	}
}

4910 
	$¦si_p2p_deš™
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
)

4912 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "De-initialize P2P\n");

4914 
ndev_vif
->
vif_ty³
 = 
SLSI_VIFTYPE_UNSPECIFIED
;

4917 ià(
	`WARN_ON
(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
d–_vif_wÜk
)))

4918 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
d–_vif_wÜk
);

4920 ià(
	`WARN_ON
(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
)))

4921 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
);

4922 
	}
}

4928 
	$¦si_p2p_vif_aùiv©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
›“80211_chªÃl
 *
chª
, 
u16
 
du¿tiÚ
, 
boŞ
 
£t_´obe_r¥_›s
)

4930 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4931 
u32
 
af_bm­_aùive
 = 
SLSI_ACTION_FRAME_PUBLIC
;

4932 
u32
 
af_bm­_su¥’ded
 = 
SLSI_ACTION_FRAME_PUBLIC
;

4933 
r
 = 0;

4935 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "Activate P2P unsync vif\n");

4937 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4940 ià(
	`¦si_mlme_add_vif
(
sdev
, 
dev
, dev->
dev_addr
, dev->dev_addr) != 0) {

4941 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_add_vif failed for unsync vif\n");

4942 
ex™_w™h_”rÜ
;

4945 
ndev_vif
->
aùiv©ed
 = 
Œue
;

4946 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_VIF_ACTIVE
);

4948 ià(
	`¦si_mlme_»gi¡”_aùiÚ_äame
(
sdev
, 
dev
, 
af_bm­_aùive
, 
af_bm­_su¥’ded
) != 0) {

4949 
	`SLSI_NET_ERR
(
dev
, "Action frame„egistration failed for unsync vif\n");

4950 
ex™_w™h_vif
;

4953 ià(
£t_´obe_r¥_›s
) {

4954 
u16
 
pu½o£
 = 
FAPI_PURPOSE_PROBE_RESPONSE
;

4956 ià(!
ndev_vif
->
unsync
.
´obe_r¥_›s
) {

4957 
	`SLSI_NET_ERR
(
dev
, "Probe Response IEs‚ot‡vailable for ROC\n");

4958 
ex™_w™h_vif
;

4961 ià(
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
pu½o£
, 
ndev_vif
->
unsync
.
´obe_r¥_›s
,‚dev_vif->unsync.
´obe_r¥_›s_Ën
) != 0) {

4962 
	`SLSI_NET_ERR
(
dev
, "Setting Probe Response IEs for unsync vif failed\n");

4963 
ex™_w™h_vif
;

4965 
ndev_vif
->
unsync
.
›s_chªged
 = 
çl£
;

4968 ià(
	`¦si_mlme_£t_chªÃl
(
sdev
, 
dev
, 
chª
, 
SLSI_FW_CHANNEL_DURATION_UNSPECIFIED
, 0, 0) != 0) {

4969 
	`SLSI_NET_ERR
(
dev
, "Set channel failed for unsync vif\n");

4970 
ex™_w™h_vif
;

4972 
ndev_vif
->
chª
 = chan;

4973 
ndev_vif
->
driv”_chªÃl
 = 
chª
->
hw_v®ue
;

4976 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

4977 
ex™
;

4979 
ex™_w™h_vif
:

4980 
	`¦si_p2p_vif_d—ùiv©e
(
sdev
, 
dev
, 
Œue
);

4981 
ex™_w™h_”rÜ
:

4982 
r
 = -
EINVAL
;

4983 
ex™
:

4984  
r
;

4985 
	}
}

4988 
	$¦si_p2p_vif_d—ùiv©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
boŞ
 
hw_avaabË
)

4990 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4992 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_INIT_DEINIT
, "De-activate P2P unsync vif\n");

4994 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4996 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_IDLE_NO_VIF
) {

4997 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_INIT_DEINIT
, "P2P unsync vif‡lready deactivated\n");

5002 ià(
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 !ğ
SLSI_PA_INVALID
)

5003 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

5004 ià(
ndev_vif
->
mgmt_tx_d©a
.
ho¡_g
)

5005 
	`cfg80211_mgmt_tx_¡©us
(&
ndev_vif
->
wdev
,‚dev_vif->
mgmt_tx_d©a
.
cook›
,‚dev_vif->mgmt_tx_d©a.
buf
,‚dev_vif->mgmt_tx_d©a.
buf_Ën
, 
çl£
, 
GFP_KERNEL
);

5006 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
d–_vif_wÜk
);

5007 ià(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
è&& 
sdev
->
»cov”y_¡©us
) {

5008 
	`cfg80211_»maš_Ú_chªÃl_expœed
(&
ndev_vif
->
wdev
,‚dev_vif->
unsync
.
roc_cook›
,‚dev_vif->
chª
,

5009 
GFP_KERNEL
);

5011 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
);

5013 ià(
hw_avaabË
)

5014 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

5015 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

5017 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_NO_VIF
);

5021 
ndev_vif
->
aùiv©ed
 = 
çl£
;

5022 
ndev_vif
->
chª
 = 
NULL
;

5024 ià(
	`WARN_ON
(
ndev_vif
->
unsync
.
li¡’_ofæßd
))

5025 
ndev_vif
->
unsync
.
li¡’_ofæßd
 = 
çl£
;

5027 
	`¦si_unsync_vif_£t_´obe_r¥_›
(
ndev_vif
, 
NULL
, 0);

5028 ()
	`¦si_£t_mgmt_tx_d©a
(
ndev_vif
, 0, 0, 
NULL
, 0);

5030 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_INIT_DEINIT
, "P2P unsync vif deactivated\n");

5031 
	}
}

5038 
	$¦si_p2p_group_¡¬t_»move_unsync_vif
(
¦si_dev
 *
sdev
)

5040 
Ãt_deviû
 *
dev
 = 
NULL
;

5041 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

5043 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "Starting P2P Group - Remove unsync vif\n");

5045 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2P
);

5046 ià(!
dev
) {

5047 
	`SLSI_ERR
(
sdev
, "Failedo deactivate…2p vif‡s dev is‚ot found\n");

5051 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5053 ià(
	`WARN_ON
(!(
	`SLSI_IS_P2P_UNSYNC_VIF
(
ndev_vif
))))

5056 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5057 
	`¦si_p2p_vif_d—ùiv©e
(
sdev
, 
dev
, 
Œue
);

5058 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5059 
	}
}

5066 
	$¦si_p2p_dev_´obe_r¥_›
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
´obe_r¥_›
, 
size_t
 
´obe_r¥_›_Ën
)

5068 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5069 
»t
 = 0;

5071 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

5073 ià(!
	`SLSI_IS_P2P_UNSYNC_VIF
(
ndev_vif
)) {

5074 
	`SLSI_NET_ERR
(
dev
, "Incorrect vifype - Not unsync vif\n");

5075 
	`kä“
(
´obe_r¥_›
);

5076  -
EINVAL
;

5079 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5081 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "Reûived ProbR¥ IE†’ = %zu, Cu¼’ˆIE†’ = %zu\n", 
´obe_r¥_›_Ën
, 
ndev_vif
->
unsync
.
´obe_r¥_›s_Ën
);

5083 ià(!
ndev_vif
->
unsync
.
li¡’_ofæßd
) {

5085 ià(
ndev_vif
->
unsync
.
´obe_r¥_›s_Ën
 !ğ
´obe_r¥_›_Ën
)

5086 
ndev_vif
->
unsync
.
›s_chªged
 = 
Œue
;

5087 ià(
	`memcmp
(
ndev_vif
->
unsync
.
´obe_r¥_›s
, 
´obe_r¥_›
, 
´obe_r¥_›_Ën
) != 0)

5088 
ndev_vif
->
unsync
.
›s_chªged
 = 
Œue
;

5090 
	`kä“
(
´obe_r¥_›
);

5091 
ex™
;

5094 
	`¦si_unsync_vif_£t_´obe_r¥_›
(
ndev_vif
, 
´obe_r¥_›
, 
´obe_r¥_›_Ën
);

5096 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_LISTENING
) {

5097 
»t
 = 
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_PROBE_RESPONSE
, 
´obe_r¥_›
, 
´obe_r¥_›_Ën
);

5098 ià(
»t
 != 0) {

5099 
	`SLSI_NET_ERR
(
dev
, "Listen Offloading: Setting Probe Response IEs for unsync vif failed\n");

5100 
ndev_vif
->
unsync
.
li¡’_ofæßd
 = 
çl£
;

5101 
	`¦si_p2p_vif_d—ùiv©e
(
sdev
, 
dev
, 
Œue
);

5104 
	`kä“
(
´obe_r¥_›
);

5107 
ex™
:

5108 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5109  
»t
;

5110 
	}
}

5118 
	$¦si_p2p_dev_nuÎ_›s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

5120 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5121 
cfg80211_sÿn_šfo
 
šfo
 = {.
abÜ‹d
 = 
Œue
};

5123 ià(!
	`SLSI_IS_P2P_UNSYNC_VIF
(
ndev_vif
)) {

5124 
	`SLSI_NET_ERR
(
dev
, "Incorrect vifype - Not unsync vif\n");

5125  -
EINVAL
;

5128 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5130 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "Probe Rsp NULL IEs\n");

5132 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_SCANNING
) {

5133 
sk_buff
 *
sÿn_»suÉ
;

5135 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

5137 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "Stop Find - Abort ongoing P2P scan\n");

5139 ()
	`¦si_mlme_d–_sÿn
(
sdev
, 
dev
, ((
ndev_vif
->
iâum
 << 8è| 
SLSI_SCAN_HW_ID
), 
çl£
);

5141 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

5142 
sÿn_»suÉ
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
], 
NULL
);

5143 
sÿn_»suÉ
) {

5144 
	`¦si_rx_sÿn_·ss_to_cfg80211
(
sdev
, 
dev
, 
sÿn_»suÉ
);

5145 
sÿn_»suÉ
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
], 
NULL
);

5147 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

5149 
	`WARN_ON
(!
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
);

5151 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
)

5152 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 9, 0))

5153 
	`cfg80211_sÿn_dÚe
(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
, &
šfo
);

5155 
	`cfg80211_sÿn_dÚe
(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
, 
Œue
);

5158 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
 = 
NULL
;

5160 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

5162 ià(
ndev_vif
->
aùiv©ed
) {

5166 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "Stop Find - Clear Probe Response IEs in firmware\n");

5167 ià(
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_PROBE_RESPONSE
, 
NULL
, 0) != 0)

5168 
	`SLSI_NET_ERR
(
dev
, "Clearing Probe Response IEs failed for unsync vif\n");

5169 
	`¦si_unsync_vif_£t_´obe_r¥_›
(
ndev_vif
, 
NULL
, 0);

5171 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_VIF_ACTIVE
);

5173 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_NO_VIF
);

5177 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5179 
	}
}

5185 
	$¦si_g‘_public_aùiÚ_subty³
(cÚ¡ 
›“80211_mgmt
 *
mgmt
)

5187 
subty³
 = 
SLSI_PA_INVALID
;

5189 
u8
 
p2p_·_äame
[5] = { 0x09, 0x50, 0x6f, 0x9a, 0x09 };

5190 
u8
 *
aùiÚ
 = (u8 *)&
mgmt
->
u
.action.u;

5192 ià(
	`memcmp
(&
aùiÚ
[0], 
p2p_·_äame
, 5) == 0) {

5193 
subty³
 = 
aùiÚ
[5];

5196 
aùiÚ
[0]) {

5197 
SLSI_PA_GAS_INITIAL_REQ
:

5198 
SLSI_PA_GAS_INITIAL_RSP
:

5199 
SLSI_PA_GAS_COMEBACK_REQ
:

5200 
SLSI_PA_GAS_COMEBACK_RSP
:

5201 
subty³
 = (
aùiÚ
[0] | 
SLSI_PA_GAS_DUMMY_SUBTYPE_MASK
);

5206  
subty³
;

5207 
	}
}

5213 
	$¦si_p2p_g‘_go_Ãg_r¥_¡©us
(
Ãt_deviû
 *
dev
, cÚ¡ 
›“80211_mgmt
 *
mgmt
)

5215 
¡©us
 = -1;

5216 
u8
 
p2p_oui_ty³
[4] = { 0x50, 0x6f, 0x9a, 0x09 };

5217 
u8
 *
aùiÚ
 = (u8 *)&
mgmt
->
u
.action.u;

5218 
u8
 *
v’dÜ_›
 = &
aùiÚ
[7];

5219 
u8
 
›_Ëngth
, 
–em_idx
;

5220 
u16
 
©Œ_Ëngth
;

5222 
v’dÜ_›
 && (*v’dÜ_› =ğ
SLSI_WLAN_EID_VENDOR_SPECIFIC
)) {

5223 
›_Ëngth
 = 
v’dÜ_›
[1];

5225 ià(
	`memcmp
(&
v’dÜ_›
[2], 
p2p_oui_ty³
, 4) == 0) {

5226 
–em_idx
 = 6;

5228 
›_Ëngth
 > 
–em_idx
) {

5229 
©Œ_Ëngth
 = ((
v’dÜ_›
[
–em_idx
 + 1]) | (vendor_ie[elem_idx + 2] << 8));

5231 ià(
v’dÜ_›
[
–em_idx
] =ğ
SLSI_P2P_STATUS_ATTR_ID
) {

5232 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "Status Attribute Found,‡ttr_length = %d, value (%u %u %u %u)\n",

5233 
©Œ_Ëngth
, 
v’dÜ_›
[
–em_idx
], vendor_ie[elem_idx + 1], vendor_ie[elem_idx + 2], vendor_ie[elem_idx + 3]);

5234 
¡©us
 = 
v’dÜ_›
[
–em_idx
 + 3];

5237 
–em_idx
 +ğ3 + 
©Œ_Ëngth
;

5242 
v’dÜ_›
 +ğ2 + 
›_Ëngth
;

5245 
	`SLSI_UNUSED_PARAMETER
(
dev
);

5247  
¡©us
;

5248 
	}
}

5254 
u8
 
	$¦si_g‘_exp_³”_äame_subty³
(
u8
 
subty³
)

5256 
subty³
) {

5258 
SLSI_P2P_PA_GO_NEG_REQ
:

5259 
SLSI_P2P_PA_GO_NEG_RSP
:

5260 
SLSI_P2P_PA_INV_REQ
:

5261 
SLSI_P2P_PA_DEV_DISC_REQ
:

5262 
SLSI_P2P_PA_PROV_DISC_REQ
:

5263 
SLSI_PA_GAS_INITIAL_REQ_SUBTYPE
:

5264 
SLSI_PA_GAS_COMEBACK_REQ_SUBTYPE
:

5265  
subty³
 + 1;

5267  
SLSI_PA_INVALID
;

5269 
	}
}

5271 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

5272 
u8
 
	$¦si_bss_cÚÃù_ty³_g‘
(
¦si_dev
 *
sdev
, cÚ¡ 
u8
 *
›
, 
size_t
 
›_Ën
)

5274 cÚ¡ 
u8
 *
r¢
;

5275 cÚ¡ 
u8
 *
w·_›
;

5276 
u8
 
akm_ty³
 = 0;

5278 
r¢
 = 
	`cfg80211_fšd_›
(
WLAN_EID_RSN
, 
›
, 
›_Ën
);

5279 
w·_›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPA
, 
›
, 
›_Ën
);

5280 ià(
r¢
) {

5281 
pos
 = 0;

5282 
›_Ën
 = 
r¢
[1] + 2;

5283 
akm_couÁ
 = 0;

5284 
i
 = 0;

5291 ià(
›_Ën
 < 9)

5292  
akm_ty³
;

5293 
pos
 = 7 + 2 + (
r¢
[8] * 4);

5294 
akm_couÁ
 = 
r¢
[
pos
 + 1];

5295 
pos
 += 2;

5296 ià(
›_Ën
 < (
pos
 + 1))

5297  
akm_ty³
;

5298 
i
 = 0; i < 
akm_couÁ
; i++) {

5299 ià(
›_Ën
 < (
pos
 + 1))

5300  
akm_ty³
;

5301 ià(
r¢
[
pos
 + 1] == 0x00 &&„sn[pos + 2] == 0x0f &&„sn[pos + 3] == 0xac) {

5302 ià(
r¢
[
pos
 + 4] == 0x08 ||„sn[pos + 4] == 0x09)

5303 
akm_ty³
 |ğ
SLSI_BSS_SECURED_SAE
;

5304 ià(
r¢
[
pos
 + 4] == 0x02 ||„sn[pos + 4] == 0x04 ||„sn[pos + 4] == 0x06)

5305 
akm_ty³
 |ğ
SLSI_BSS_SECURED_PSK
;

5306 ià(
r¢
[
pos
 + 4] == 0x01 ||„sn[pos + 4] == 0x03)

5307 
akm_ty³
 |ğ
SLSI_BSS_SECURED_1x
;

5309 
pos
 += 4;

5311 } ià(
w·_›
) {

5312 
pos
 = 0;

5313 
›_Ën
 = 
w·_›
[1] + 2;

5314 
akm_couÁ
 = 0;

5315 
i
 = 0;

5323 ià(
›_Ën
 < 13)

5324  
akm_ty³
;

5325 
pos
 = 13 + (
w·_›
[12] * 4);

5326 
akm_couÁ
 = 
w·_›
[
pos
 + 1];

5327 
pos
 += 2;

5328 ià(
›_Ën
 < (
pos
 + 1))

5329  
akm_ty³
;

5330 
i
 = 0; i < 
akm_couÁ
; i++) {

5331 ià(
›_Ën
 < (
pos
 + 1))

5332  
akm_ty³
;

5333 ià(
w·_›
[
pos
 + 1] == 0x00 && wpa_ie[pos + 2] == 0x50 && wpa_ie[pos + 3] == 0xf2) {

5334 ià(
w·_›
[
pos
 + 4] == 0x02)

5335 
akm_ty³
 |ğ
SLSI_BSS_SECURED_PSK
;

5336 ià(
w·_›
[
pos
 + 4] == 0x01)

5337 
akm_ty³
 |ğ
SLSI_BSS_SECURED_1x
;

5338 ià(
w·_›
[
pos
 + 4] == 0x00)

5339 
akm_ty³
 |ğ
SLSI_BSS_SECURED_NO
;

5341 
pos
 += 4;

5344 
akm_ty³
 = 
SLSI_BSS_SECURED_NO
;

5347  
akm_ty³
;

5348 
	}
}

5352 
	$¦si_wÏn_dump_public_aùiÚ_subty³
(
¦si_dev
 *
sdev
, 
›“80211_mgmt
 *
mgmt
, 
boŞ
 
tx
)

5354 
u8
 
aùiÚ_code
 = ((u8 *)&
mgmt
->
u
.
aùiÚ
.u)[0];

5355 
u8
 
aùiÚ_ÿ‹gÜy
 = 
mgmt
->
u
.
aùiÚ
.
ÿ‹gÜy
;

5356 *
tx_rx_¡ršg
 = "Received";

5357 
wnm_aùiÚ_f›lds
[28][35] = { "Event Request", "Event Report", "Diagnostic Request",

5370 ià(
tx
)

5371 
tx_rx_¡ršg
 = "Send";

5373 
aùiÚ_ÿ‹gÜy
) {

5374 
WLAN_CATEGORY_RADIO_MEASUREMENT
:

5375 
aùiÚ_code
) {

5376 
SLSI_RM_RADIO_MEASUREMENT_REQ
:

5377 
	`SLSI_INFO
(
sdev
, "% RadiØM—su»m’ˆF¿m(RadiØM—su»m’ˆReq)\n", 
tx_rx_¡ršg
);

5379 
SLSI_RM_RADIO_MEASUREMENT_REP
:

5380 
	`SLSI_INFO
(
sdev
, "% RadiØM—su»m’ˆF¿m(RadiØM—su»m’ˆR•)\n", 
tx_rx_¡ršg
);

5382 
SLSI_RM_LINK_MEASUREMENT_REQ
:

5383 
	`SLSI_INFO
(
sdev
, "% RadiØM—su»m’ˆF¿m(Lšk M—su»m’ˆReq)\n", 
tx_rx_¡ršg
);

5385 
SLSI_RM_LINK_MEASUREMENT_REP
:

5386 
	`SLSI_INFO
(
sdev
, "% RadiØM—su»m’ˆF¿m(Lšk M—su»m’ˆR•)\n", 
tx_rx_¡ršg
);

5388 
SLSI_RM_NEIGH_REP_REQ
:

5389 
	`SLSI_INFO
(
sdev
, "% RadiØM—su»m’ˆF¿m(NeighbÜ R•ÜˆReq)\n", 
tx_rx_¡ršg
);

5391 
SLSI_RM_NEIGH_REP_RSP
:

5392 
	`SLSI_INFO
(
sdev
, "% RadiØM—su»m’ˆF¿m(NeighbÜ R•ÜˆRe¥)\n", 
tx_rx_¡ršg
);

5395 
	`SLSI_INFO
(
sdev
, "% RadiØM—su»m’ˆF¿m(Re£rved)\n", 
tx_rx_¡ršg
);

5398 
WLAN_CATEGORY_PUBLIC
:

5399 
aùiÚ_code
) {

5400 
SLSI_PA_GAS_INITIAL_REQ
:

5401 
	`SLSI_DBG1_NODEV
(
SLSI_CFG80211
, "%s: GAS In™ŸÈReque¡\n", 
tx
 ? "TX" : "RX");

5403 
SLSI_PA_GAS_INITIAL_RSP
:

5404 
	`SLSI_DBG1_NODEV
(
SLSI_CFG80211
, "%s: GAS In™ŸÈRe¥Ú£\n", 
tx
 ? "TX" : "RX");

5406 
SLSI_PA_GAS_COMEBACK_REQ
:

5407 
	`SLSI_DBG1_NODEV
(
SLSI_CFG80211
, "%s: GAS Comeback Reque¡\n", 
tx
 ? "TX" : "RX");

5409 
SLSI_PA_GAS_COMEBACK_RSP
:

5410 
	`SLSI_DBG1_NODEV
(
SLSI_CFG80211
, "%s: GAS Comeback Re¥Ú£\n", 
tx
 ? "TX" : "RX");

5413 
	`SLSI_DBG1_NODEV
(
SLSI_CFG80211
, "UnknowÀPubliøAùiÚ F¿m: %d\n", 
aùiÚ_code
);

5416 
WLAN_CATEGORY_WNM
:

5417 ià(
aùiÚ_code
 <ğ
SLSI_WNM_ACTION_FIELD_MAX
)

5418 
	`SLSI_INFO
(
sdev
, "% WNM F¿m(%s)\n", 
tx_rx_¡ršg
, 
wnm_aùiÚ_f›lds
[
aùiÚ_code
]);

5420 
	`SLSI_INFO
(
sdev
, "% WNM F¿m(Re£rved)\n", 
tx_rx_¡ršg
);

5423 
	}
}

5425 
	$¦si_abÜt_¡a_sÿn
(
¦si_dev
 *
sdev
)

5427 
Ãt_deviû
 *
wÏn_Ãt_dev
 = 
NULL
;

5428 
Ãtdev_vif
 *
ndev_vif
;

5429 
cfg80211_sÿn_šfo
 
šfo
 = {.
abÜ‹d
 = 
Œue
};

5431 
wÏn_Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

5433 ià(!
wÏn_Ãt_dev
) {

5434 
	`SLSI_ERR
(
sdev
, "Dev‚ot found\n");

5438 
ndev_vif
 = 
	`Ãtdev_´iv
(
wÏn_Ãt_dev
);

5439 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

5440 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

5442 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
) {

5443 
sk_buff
 *
sÿn_»suÉ
;

5445 
	`SLSI_DBG2
(
sdev
, 
SLSI_CFG80211
, "Abort ongoing WLAN scan\n");

5446 ()
	`¦si_mlme_d–_sÿn
(
sdev
, 
wÏn_Ãt_dev
, ((
ndev_vif
->
iâum
 << 8è| 
SLSI_SCAN_HW_ID
), 
çl£
);

5447 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

5448 
sÿn_»suÉ
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
], 
NULL
);

5449 
sÿn_»suÉ
) {

5450 
	`¦si_rx_sÿn_·ss_to_cfg80211
(
sdev
, 
wÏn_Ãt_dev
, 
sÿn_»suÉ
);

5451 
sÿn_»suÉ
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
], 
NULL
);

5453 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

5454 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 9, 0))

5455 
	`cfg80211_sÿn_dÚe
(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
, &
šfo
);

5457 
	`cfg80211_sÿn_dÚe
(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
, 
Œue
);

5460 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
 = 
NULL
;

5461 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
»queue_timeout_wÜk
 = 
çl£
;

5463 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

5464 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

5465 
	}
}

5471 
	$¦si_is_dhı_·ck‘
(
u8
 *
d©a
)

5473 
u8
 *
p
;

5474 
»t
 = 
SLSI_TX_IS_NOT_DHCP
;

5476 
p
 = 
d©a
 + 
SLSI_IP_TYPE_OFFSET
;

5478 ià(*
p
 =ğ
SLSI_IP_TYPE_UDP
) {

5479 
u16
 
sourû_pÜt
, 
de¡_pÜt
;

5481 
p
 = 
d©a
 + 
SLSI_IP_SOURCE_PORT_OFFSET
;

5482 
sourû_pÜt
 = 
p
[0] << 8 |…[1];

5483 
p
 = 
d©a
 + 
SLSI_IP_DEST_PORT_OFFSET
;

5484 
de¡_pÜt
 = 
p
[0] << 8 |…[1];

5485 ià((
sourû_pÜt
 =ğ
SLSI_DHCP_CLIENT_PORT
è&& (
de¡_pÜt
 =ğ
SLSI_DHCP_SERVER_PORT
))

5486 
»t
 = 
SLSI_TX_IS_DHCP_CLIENT
;

5487 ià((
sourû_pÜt
 =ğ
SLSI_DHCP_SERVER_PORT
è&& (
de¡_pÜt
 =ğ
SLSI_DHCP_CLIENT_PORT
))

5488 
»t
 = 
SLSI_TX_IS_DHCP_SERVER
;

5491  
»t
;

5492 
	}
}

5494 #ifdeà
CONFIG_SCSC_WLAN_PRIORITISE_IMP_FRAMES


5495 
	$¦si_is_tı_sync_·ck‘
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

5497 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5502 ià((
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
è&& (
	`com·»_‘h”_addr
(
	`‘h_hdr
(
skb
)->
h_sourû
, 
dev
->
dev_addr
) != 0))

5504 ià(
	`be16_to_ıu
(
	`‘h_hdr
(
skb
)->
h_´Ùo
è!ğ
ETH_P_IP
)

5506 ià(
	`_hdr
(
skb
)->
´ÙocŞ
 !ğ
IPPROTO_TCP
)

5508 ià(!
	`skb_Œª¥Üt_h—d”_was_£t
(
skb
))

5510 ià(
	`tı_hdr
(
skb
)->
syn
)

5514 
	}
}

5516 
	$¦si_is_dns_·ck‘
(
u8
 *
d©a
)

5518 
u8
 *
p
;

5520 
p
 = 
d©a
 + 
SLSI_IP_TYPE_OFFSET
;

5522 ià(*
p
 =ğ
SLSI_IP_TYPE_UDP
) {

5523 
u16
 
de¡_pÜt
;

5525 
p
 = 
d©a
 + 
SLSI_IP_DEST_PORT_OFFSET
;

5526 
de¡_pÜt
 = 
p
[0] << 8 |…[1];

5527 ià(
de¡_pÜt
 =ğ
SLSI_DNS_DEST_PORT
)

5532 
	}
}

5534 
	$¦si_is_mdns_·ck‘
(
u8
 *
d©a
)

5536 
u8
 *
p
;

5538 
p
 = 
d©a
 + 
SLSI_IP_TYPE_OFFSET
;

5540 ià(*
p
 =ğ
SLSI_IP_TYPE_UDP
) {

5541 
u16
 
de¡_pÜt
;

5543 
p
 = 
d©a
 + 
SLSI_IP_DEST_PORT_OFFSET
;

5544 
de¡_pÜt
 = 
p
[0] << 8 |…[1];

5545 ià(
de¡_pÜt
 =ğ
SLSI_MDNS_DEST_PORT
)

5549 
	}
}

5552 
	$¦si_­_´•¬e_add_šfo_›s
(
Ãtdev_vif
 *
ndev_vif
, cÚ¡ 
u8
 *
›s
, 
size_t
 
›s_Ën
)

5554 cÚ¡ 
u8
 *
wps_p2p_›s
 = 
NULL
;

5555 
size_t
 
wps_p2p_›_Ën
 = 0;

5558 
wps_p2p_›s
 = 
	`cfg80211_fšd_›
(
SLSI_WLAN_EID_VENDOR_SPECIFIC
, 
›s
, 
›s_Ën
);

5559 ià(
wps_p2p_›s
) {

5560 
size_t
 
‹mp_Ën
 = 
wps_p2p_›s
 - 
›s
;

5562 
wps_p2p_›_Ën
 = 
›s_Ën
 - 
‹mp_Ën
;

5565 
	`SLSI_NET_DBG2
(
ndev_vif
->
wdev
.
Ãtdev
, 
SLSI_MLME
, "WPA IE†en = %zu, WMM IE†en = %zu, IEs†en = %zu, WPS_P2P IEs†en = %zu\n",

5566 
ndev_vif
->
­
.
w·_›_Ën
,‚dev_vif->­.
wmm_›_Ën
, 
›s_Ën
, 
wps_p2p_›_Ën
);

5568 
ndev_vif
->
­
.
add_šfo_›s_Ën
 =‚dev_vif->­.
w·_›_Ën
 +‚dev_vif->­.
wmm_›_Ën
 + 
wps_p2p_›_Ën
;

5569 
ndev_vif
->
­
.
add_šfo_›s
 = 
	`km®loc
Òdev_vif->­.
add_šfo_›s_Ën
, 
GFP_KERNEL
);

5571 ià(!
ndev_vif
->
­
.
add_šfo_›s
) {

5572 
	`SLSI_NET_DBG1
(
ndev_vif
->
wdev
.
Ãtdev
, 
SLSI_MLME
, "Failedo‡llocate memory for IEs\n");

5573 
ndev_vif
->
­
.
add_šfo_›s_Ën
 = 0;

5574  -
ENOMEM
;

5577 ià(
ndev_vif
->
­
.
ÿche_w·_›
) {

5578 
	`memıy
(
ndev_vif
->
­
.
add_šfo_›s
,‚dev_vif->­.
ÿche_w·_›
,‚dev_vif->­.
w·_›_Ën
);

5579 
ndev_vif
->
­
.
add_šfo_›s
 +ğndev_vif->­.
w·_›_Ën
;

5582 ià(
ndev_vif
->
­
.
ÿche_wmm_›
) {

5583 
	`memıy
(
ndev_vif
->
­
.
add_šfo_›s
,‚dev_vif->­.
ÿche_wmm_›
,‚dev_vif->­.
wmm_›_Ën
);

5584 
ndev_vif
->
­
.
add_šfo_›s
 +ğndev_vif->­.
wmm_›_Ën
;

5587 ià(
wps_p2p_›s
) {

5588 
	`memıy
(
ndev_vif
->
­
.
add_šfo_›s
, 
wps_p2p_›s
, 
wps_p2p_›_Ën
);

5589 
ndev_vif
->
­
.
add_šfo_›s
 +ğ
wps_p2p_›_Ën
;

5592 
ndev_vif
->
­
.
add_šfo_›s
 -ğndev_vif->­.
add_šfo_›s_Ën
;

5595 
	}
}

5596 
	$¦si_šdex_fÜ_chª
(
chªÃl
)

5598 
idx
 = 0;

5599 ià(
chªÃl
 <= 14)

5600 
idx
 = 
chªÃl
;

5601 ià(
chªÃl
 >= 36 && channel <= 64)

5602 
idx
 = ((
chªÃl
 - 36) / 4);

5603 ià(
chªÃl
 >= 100 && channel <= 140)

5604 
idx
 = (8 + ((
chªÃl
 - 100) / 4));

5605 ià(
chªÃl
 >= 149 && channel <= 165)

5606 
idx
 = (19 + ((
chªÃl
 - 149) / 4));

5607 ià(
chªÃl
 <= 14)

5608  
idx
;

5610  15 + 
idx
;

5611 
	}
}

5614 
	$¦si_rßm_chªÃl_ÿche_add_chªÃl
(
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
ÃtwÜk_m­
, 
u8
 
chªÃl
)

5616 ià(
chªÃl
 <= 14)

5617 
ÃtwÜk_m­
->
chªÃls_24_ghz
 |ğ(1 << 
chªÃl
);

5618 ià(
chªÃl
 >= 36 && channel <= 64)

5619 
ÃtwÜk_m­
->
chªÃls_5_ghz
 |ğ(1 << ((
chªÃl
 - 36) / 4));

5620 ià(
chªÃl
 >= 100 && channel <= 140)

5621 
ÃtwÜk_m­
->
chªÃls_5_ghz
 |ğ(1 << (8 + ((
chªÃl
 - 100) / 4)));

5622 ià(
chªÃl
 >= 149 && channel <= 165)

5623 
ÃtwÜk_m­
->
chªÃls_5_ghz
 |ğ(1 << (24 + ((
chªÃl
 - 149) / 4)));

5624 
	}
}

5626 
	$¦si_rßm_chªÃl_ÿche_add_’Œy
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
ssid
, cÚ¡ u8 *
bssid
, u8 
chªÃl
)

5628 
li¡_h—d
 *
pos
;

5629 
found
 = 0;

5630 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5631 
idx
;

5633 
	`li¡_fÜ_—ch
(
pos
, &
ndev_vif
->
¡a
.
ÃtwÜk_m­
) {

5634 
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
ÃtwÜk_m­
 = 
	`li¡_’Œy
(
pos
, ¦si_rßmšg_ÃtwÜk_m­_’Œy, 
li¡
);

5636 ià(
ÃtwÜk_m­
->
ssid
.
ssid_Ën
 == ssid[1] &&

5637 
	`memcmp
(
ÃtwÜk_m­
->
ssid
.ssid, &ssid[2], ssid[1]) == 0) {

5638 
found
 = 1;

5639 
ÃtwÜk_m­
->
Ï¡_£’_jiff›s
 = 
jiff›s
;

5640 
idx
 = 
	`¦si_šdex_fÜ_chª
(
chªÃl
);

5641 
ÃtwÜk_m­
->
chªÃl_jiff›s
[
idx
] = 
jiff›s
;

5642 ià(
ÃtwÜk_m­
->
Úly_Úe_­_£’
 && 
	`memcmp
Ò‘wÜk_m­->
š™Ÿl_bssid
, 
bssid
, 
ETH_ALEN
) != 0)

5643 
ÃtwÜk_m­
->
Úly_Úe_­_£’
 = 
çl£
;

5644 
	`¦si_rßm_chªÃl_ÿche_add_chªÃl
(
ÃtwÜk_m­
, 
chªÃl
);

5648 ià(!
found
) {

5649 
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
ÃtwÜk_m­
;

5651 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "New EÁry : ChªÃl: %d : %.*s\n", 
chªÃl
, 
ssid
[1], &ssid[2]);

5652 
ÃtwÜk_m­
 = 
	`km®loc
((*ÃtwÜk_m­), 
GFP_ATOMIC
);

5653 ià(
ÃtwÜk_m­
) {

5654 
ÃtwÜk_m­
->
ssid
.
ssid_Ën
 = ssid[1];

5655 
	`memıy
(
ÃtwÜk_m­
->
ssid
.ssid, &ssid[2], ssid[1]);

5656 
ÃtwÜk_m­
->
chªÃls_24_ghz
 = 0;

5657 
ÃtwÜk_m­
->
chªÃls_5_ghz
 = 0;

5658 
ÃtwÜk_m­
->
Ï¡_£’_jiff›s
 = 
jiff›s
;

5659 
idx
 = 
	`¦si_šdex_fÜ_chª
(
chªÃl
);

5660 
ÃtwÜk_m­
->
chªÃl_jiff›s
[
idx
] = 
jiff›s
;

5661 
	`SLSI_ETHER_COPY
(
ÃtwÜk_m­
->
š™Ÿl_bssid
, 
bssid
);

5662 
ÃtwÜk_m­
->
Úly_Úe_­_£’
 = 
Œue
;

5663 
	`¦si_rßm_chªÃl_ÿche_add_chªÃl
(
ÃtwÜk_m­
, 
chªÃl
);

5664 
	`li¡_add
(&
ÃtwÜk_m­
->
li¡
, &
ndev_vif
->
¡a
.network_map);

5666 
	`SLSI_ERR
(
sdev
, "New EÁry : %.* km®loc(èçed\n", 
ssid
[1], &ssid[2]);

5669 
	}
}

5671 
	$¦si_rßm_chªÃl_ÿche_add
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

5673 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

5674 
size_t
 
mgmt_Ën
 = 
	`çpi_g‘_mgm’
(
skb
);

5675 
›Ën
 = 
mgmt_Ën
 - (
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
 - (
u8
 *)mgmt);

5676 
u32
 
äeq
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_sÿn_šd
.
chªÃl_äequ’cy
) / 2;

5677 cÚ¡ 
u8
 *
sÿn_ds
 = 
	`cfg80211_fšd_›
(
WLAN_EID_DS_PARAMS
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
, 
›Ën
);

5678 cÚ¡ 
u8
 *
sÿn_ht
 = 
	`cfg80211_fšd_›
(
WLAN_EID_HT_OPERATION
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
, 
›Ën
);

5679 cÚ¡ 
u8
 *
sÿn_ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
, 
›Ën
);

5680 
u8
 
chª
 = 0;

5683 ià(
sÿn_ds
)

5684 
chª
 = 
sÿn_ds
[2];

5685 ià(
sÿn_ht
)

5686 
chª
 = 
sÿn_ht
[2];

5688 
chª
 = 
	`›“80211_äequ’cy_to_chªÃl
(
äeq
);

5690 ià(
chª
) {

5691 
Æ80211_bªd
 
bªd
 = 
NL80211_BAND_2GHZ
;

5693 ià(
chª
 > 14)

5694 
bªd
 = 
NL80211_BAND_5GHZ
;

5696 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


5697 ià(
äeq
 !ğ(
u32
)
	`›“80211_chªÃl_to_äequ’cy
(
chª
, 
bªd
)) {

5698 ià(
bªd
 =ğ
NL80211_BAND_5GHZ
 && 
äeq
 < 3000)

5699 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "OfàBªd ResuÉ : mlme_sÿn_šd(äeq:%dè!ğDS(äeq:%d)\n", 
äeq
, 
	`›“80211_chªÃl_to_äequ’cy
(
chª
, 
bªd
));

5701 ià(
bªd
 =ğ
NL80211_BAND_2GHZ
 && 
äeq
 > 3000)

5702 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "OfàBªd ResuÉ : mlme_sÿn_šd(äeq:%dè!ğDS(äeq:%d)\n", 
äeq
, 
	`›“80211_chªÃl_to_äequ’cy
(
chª
, 
bªd
));

5707 ià(!
sÿn_ssid
 || !scan_ssid[1] || scan_ssid[1] > 32) {

5708 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "SSID‚ot defined : Could‚ot find SSID ie or Hidden\n");

5712 
	`¦si_rßm_chªÃl_ÿche_add_’Œy
(
sdev
, 
dev
, 
sÿn_ssid
, 
mgmt
->
bssid
, 
chª
);

5713 
	}
}

5715 
	$¦si_rßm_chªÃl_ÿche_´uÃ
(
Ãt_deviû
 *
dev
, 
£cÚds
, *
ssid
)

5717 
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
ÃtwÜk_m­
;

5718 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5719 
li¡_h—d
 *
pos
, *
q
;

5720 
now
 = 
jiff›s
;

5721 
age
;

5722 
i
 = 0;

5724 ià(
ssid
) {

5725 
	`li¡_fÜ_—ch_§ã
(
pos
, 
q
, &
ndev_vif
->
¡a
.
ÃtwÜk_m­
) {

5726 
ÃtwÜk_m­
 = 
	`li¡_’Œy
(
pos
, 
¦si_rßmšg_ÃtwÜk_m­_’Œy
, 
li¡
);

5727 ià(
ssid
 && (
	`memcmp
(
ÃtwÜk_m­
->ssid.ssid, ssid,‚‘wÜk_m­->ssid.
ssid_Ën
) == 0)) {

5728 
	`SLSI_ERR_NODEV
("Prunšg‚‘wÜk m­ƒÁry fÜ ssid %s\n", 
ssid
);

5729 
	`li¡_d–
(
pos
);

5730 
	`kä“
(
ÃtwÜk_m­
);

5735 
	`li¡_fÜ_—ch_§ã
(
pos
, 
q
, &
ndev_vif
->
¡a
.
ÃtwÜk_m­
) {

5736 
ÃtwÜk_m­
 = 
	`li¡_’Œy
(
pos
, 
¦si_rßmšg_ÃtwÜk_m­_’Œy
, 
li¡
);

5737 
age
 = (
now
 - 
ÃtwÜk_m­
->
Ï¡_£’_jiff›s
è/ 
HZ
;

5738 
i
 = 1; i <= 38; i++) {

5739 ià(
	`time_aá”_eq
(
now
, 
ÃtwÜk_m­
->
chªÃl_jiff›s
[
i
] + (
£cÚds
 * 
HZ
))) {

5740 ià(
i
 <= 14)

5741 
ÃtwÜk_m­
->
chªÃls_24_ghz
 &ğ~(1 << (
i
));

5742 ià(
i
 > 14 && i < 34)

5743 
ÃtwÜk_m­
->
chªÃls_5_ghz
 &ğ~(1 << (
i
 - 15));

5745 
ÃtwÜk_m­
->
chªÃls_5_ghz
 &ğ~(1 << (
i
 - 10));

5748 ià(!
ÃtwÜk_m­
->
chªÃls_24_ghz
 && !ÃtwÜk_m­->
chªÃls_5_ghz
) {

5749 
	`li¡_d–
(
pos
);

5750 
	`kä“
(
ÃtwÜk_m­
);

5754 
	}
}

5756 
	$¦si_rßm_chªÃl_ÿche_g‘_chªÃls_št
(
Ãt_deviû
 *
dev
, 
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
ÃtwÜk_m­
, 
u8
 *
chªÃls
)

5758 
šdex
 = 0;

5759 
i
;

5761 
	`SLSI_UNUSED_PARAMETER
(
dev
);

5764 
i
 = 1; i <= 14; i++)

5765 ià(
ÃtwÜk_m­
->
chªÃls_24_ghz
 & (1 << 
i
)) {

5766 
chªÃls
[
šdex
] = 
i
;

5767 
šdex
++;

5771 
i
 = 36; i <= 64; i += 4)

5772 ià(
ÃtwÜk_m­
->
chªÃls_5_ghz
 & (1 << ((
i
 - 36) / 4))) {

5773 
chªÃls
[
šdex
] = 
i
;

5774 
šdex
++;

5778 
i
 = 100; i <= 140; i += 4)

5779 ià(
ÃtwÜk_m­
->
chªÃls_5_ghz
 & (1 << (8 + ((
i
 - 100) / 4)))) {

5780 
chªÃls
[
šdex
] = 
i
;

5781 
šdex
++;

5785 
i
 = 149; i <= 165; i += 4)

5786 ià(
ÃtwÜk_m­
->
chªÃls_5_ghz
 & (1 << (24 + ((
i
 - 149) / 4)))) {

5787 
chªÃls
[
šdex
] = 
i
;

5788 
šdex
++;

5790  
šdex
;

5791 
	}
}

5793 
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
	$¦si_rßm_chªÃl_ÿche_g‘
(
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
ssid
)

5795 
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
ÃtwÜk_m­
 = 
NULL
;

5796 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5797 
li¡_h—d
 *
pos
;

5799 ià(
	`WARN_ON
(!
ssid
))

5800  
NULL
;

5802 
	`li¡_fÜ_—ch
(
pos
, &
ndev_vif
->
¡a
.
ÃtwÜk_m­
) {

5803 
ÃtwÜk_m­
 = 
	`li¡_’Œy
(
pos
, 
¦si_rßmšg_ÃtwÜk_m­_’Œy
, 
li¡
);

5804 ià(
ÃtwÜk_m­
->
ssid
.
ssid_Ën
 == ssid[1] &&

5805 
	`memcmp
(
ÃtwÜk_m­
->
ssid
.ssid, &ssid[2], ssid[1]) == 0)

5808  
ÃtwÜk_m­
;

5809 
	}
}

5811 
u32
 
	$¦si_rßm_chªÃl_ÿche_g‘_chªÃls
(
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
ssid
, u8 *
chªÃls
)

5813 
u32
 
chªÃls_couÁ
 = 0;

5814 
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
ÃtwÜk_m­
;

5816 
ÃtwÜk_m­
 = 
	`¦si_rßm_chªÃl_ÿche_g‘
(
dev
, 
ssid
);

5817 ià(
ÃtwÜk_m­
)

5818 
chªÃls_couÁ
 = 
	`¦si_rßm_chªÃl_ÿche_g‘_chªÃls_št
(
dev
, 
ÃtwÜk_m­
, 
chªÃls
);

5820  
chªÃls_couÁ
;

5821 
	}
}

5823 
	$¦si_rßmšg_sÿn_cÚfigu»_chªÃls
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
ssid
, u8 *
chªÃls
)

5825 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5826 
u32
 
ÿched_chªÃls_couÁ
;

5828 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

5830 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

5831 
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
);

5832 
	`WARN_ON
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
);

5834 
ÿched_chªÃls_couÁ
 = 
	`¦si_rßm_chªÃl_ÿche_g‘_chªÃls
(
dev
, 
ssid
, 
chªÃls
);

5835 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "Rßmšg SÿÀChªÃls. %d cached\n", 
ÿched_chªÃls_couÁ
);

5837  
ÿched_chªÃls_couÁ
;

5838 
	}
}

5840 
	$¦si_£nd_rş_chªÃl_li¡_ev’t
(
¦si_dev
 *
sdev
, 
u32
 
chªÃl_couÁ
, 
u16
 *
chªÃl_li¡
, 
u8
 *
ssid
, u8 
ssid_Ën
)

5842 
sk_buff
 *
skb
 = 
NULL
;

5843 
u8
 
”r
 = 0;

5845 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

5846 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
,

5847 
SLSI_NL80211_VENDOR_RCL_CHANNEL_LIST_EVENT
, 
GFP_KERNEL
);

5849 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
,

5850 
SLSI_NL80211_VENDOR_RCL_CHANNEL_LIST_EVENT
, 
GFP_KERNEL
);

5852 ià(!
skb
) {

5853 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb for VENDOR RCL channel†ist\n");

5854  -
ENOMEM
;

5857 
”r
 |ğ
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_SSID
, 
ssid_Ën
, 
ssid
);

5858 
”r
 |ğ
	`Æa_put_u32
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_RCL_CHANNEL_COUNT
, 
chªÃl_couÁ
);

5859 
”r
 |ğ
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_RCL_CHANNEL_LIST
, 
chªÃl_couÁ
 * (
u16
), 
chªÃl_li¡
);

5861 ià(
”r
) {

5862 
	`SLSI_ERR_NODEV
("Faed‚Ï_puˆ”r=%d\n", 
”r
);

5863 
	`kä“_skb
(
skb
);

5864  -
EINVAL
;

5866 
	`SLSI_INFO
(
sdev
, "Event: SLSI_NL80211_VENDOR_RCL_CHANNEL_LIST_EVENT(%d)\n",

5867 
SLSI_NL80211_VENDOR_RCL_CHANNEL_LIST_EVENT
);

5868 
	`cfg80211_v’dÜ_ev’t
(
skb
, 
GFP_KERNEL
);

5870 
	}
}

5872 
	$¦si_£nd_acs_ev’t
(
¦si_dev
 *
sdev
, 
¦si_acs_£Ëùed_chªÃls
 
acs_£Ëùed_chªÃls
)

5874 
sk_buff
 *
skb
 = 
NULL
;

5875 
u8
 
”r
 = 0;

5877 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

5878 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
,

5879 
SLSI_NL80211_VENDOR_ACS_EVENT
, 
GFP_KERNEL
);

5881 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
,

5882 
SLSI_NL80211_VENDOR_ACS_EVENT
, 
GFP_KERNEL
);

5884 ià(!
skb
) {

5885 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb for VENDOR ACSƒvent\n");

5886  -
ENOMEM
;

5888 
”r
 |ğ
	`Æa_put_u8
(
skb
, 
SLSI_ACS_ATTR_PRIMARY_CHANNEL
, 
acs_£Ëùed_chªÃls
.
´i_chªÃl
);

5889 
”r
 |ğ
	`Æa_put_u8
(
skb
, 
SLSI_ACS_ATTR_SECONDARY_CHANNEL
, 
acs_£Ëùed_chªÃls
.
£c_chªÃl
);

5890 
”r
 |ğ
	`Æa_put_u8
(
skb
, 
SLSI_ACS_ATTR_VHT_SEG0_CENTER_CHANNEL
, 
acs_£Ëùed_chªÃls
.
vht_£g0_ûÁ”_ch
);

5891 
”r
 |ğ
	`Æa_put_u8
(
skb
, 
SLSI_ACS_ATTR_VHT_SEG1_CENTER_CHANNEL
, 
acs_£Ëùed_chªÃls
.
vht_£g1_ûÁ”_ch
);

5892 
”r
 |ğ
	`Æa_put_u16
(
skb
, 
SLSI_ACS_ATTR_CHWIDTH
, 
acs_£Ëùed_chªÃls
.
ch_width
);

5893 
”r
 |ğ
	`Æa_put_u8
(
skb
, 
SLSI_ACS_ATTR_HW_MODE
, 
acs_£Ëùed_chªÃls
.
hw_mode
);

5894 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "pri_channel=%d,sec_channel=%d,vht_seg0_center_ch=%d,"

5896 
acs_£Ëùed_chªÃls
.
´i_chªÃl
,‡cs_£Ëùed_chªÃls.
£c_chªÃl
,

5897 
acs_£Ëùed_chªÃls
.
vht_£g0_ûÁ”_ch
,‡cs_£Ëùed_chªÃls.
vht_£g1_ûÁ”_ch
,

5898 
acs_£Ëùed_chªÃls
.
ch_width
,‡cs_£Ëùed_chªÃls.
hw_mode
);

5899 ià(
”r
) {

5900 
	`SLSI_ERR_NODEV
("Faed‚Ï_puˆ”r=%d\n", 
”r
);

5901 
	`kä“_skb
(
skb
);

5902  -
EINVAL
;

5904 
	`SLSI_INFO
(
sdev
, "Ev’t: SLSI_NL80211_VENDOR_ACS_EVENT(%d)\n", 
SLSI_NL80211_VENDOR_ACS_EVENT
);

5905 
	`cfg80211_v’dÜ_ev’t
(
skb
, 
GFP_KERNEL
);

5907 
	}
}

5909 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


5910 
	$¦si_is_wes_aùiÚ_äame
(cÚ¡ 
›“80211_mgmt
 *
mgmt
)

5912 
r
 = 0;

5914 
u8
 
wes_vs_aùiÚ_äame
[4] = { 0x7f, 0x00, 0x00, 0xf0 };

5915 
u8
 *
aùiÚ
 = (u8 *)&
mgmt
->
u
.action;

5917 ià(
	`memcmp
(
aùiÚ
, 
wes_vs_aùiÚ_äame
, 4) == 0)

5918 
r
 = 1;

5920  
r
;

5921 
	}
}

5924 
u32
 
	$¦si_»m­_»g_ruË_æags
(
u8
 
æags
)

5926 
u32
 
»m­³d_æags
 = 0;

5928 ià(
æags
 & 
SLSI_REGULATORY_DFS
)

5929 
»m­³d_æags
 |ğ
NL80211_RRF_DFS
;

5930 ià(
æags
 & 
SLSI_REGULATORY_NO_OFDM
)

5931 
»m­³d_æags
 |ğ
NL80211_RRF_NO_OFDM
;

5932 ià(
æags
 & 
SLSI_REGULATORY_NO_INDOOR
)

5933 
»m­³d_æags
 |ğ
NL80211_RRF_NO_INDOOR
;

5934 ià(
æags
 & 
SLSI_REGULATORY_NO_OUTDOOR
)

5935 
»m­³d_æags
 |ğ
NL80211_RRF_NO_OUTDOOR
;

5937  
»m­³d_æags
;

5938 
	}
}

5940 
	$¦si_»g_mib_to_»gd
(
¦si_mib_d©a
 *
mib
, 
¦si_802_11d_»g_domaš
 *
domaš_šfo
)

5942 
i
 = 0;

5943 
num_ruËs
 = 0;

5944 
u16
 
äeq
;

5945 
u8
 
by‹_v®
;

5946 
›“80211_»g_ruË
 *
»g_ruË
;

5948 
domaš_šfo
->
»gdomaš
->
®pha2
[0] = *(
u8
 *)(&
mib
->
d©a
[
i
]);

5949 
i
++;

5951 
domaš_šfo
->
»gdomaš
->
®pha2
[1] = *(
u8
 *)(&
mib
->
d©a
[
i
]);

5952 
i
++;

5954 
domaš_šfo
->
»gdomaš
->
dfs_»giÚ
 = *(
u8
 *)(&
mib
->
d©a
[
i
]);

5955 
i
++;

5957 
i
 < 
mib
->
d©aL’gth
) {

5958 
»g_ruË
 = &
domaš_šfo
->
»gdomaš
->
»g_ruËs
[
num_ruËs
];

5961 
äeq
 = 
	`__Ë16_to_ıu
(*(
u16
 *)(&
mib
->
d©a
[
i
]));

5962 
»g_ruË
->
äeq_¿nge
.
¡¬t_äeq_khz
 = 
	`MHZ_TO_KHZ
(
äeq
);

5965 
äeq
 = 
	`__Ë16_to_ıu
(*(
u16
 *)(&
mib
->
d©a
[
i
 + 2]));

5966 
»g_ruË
->
äeq_¿nge
.
’d_äeq_khz
 = 
	`MHZ_TO_KHZ
(
äeq
);

5969 
by‹_v®
 = *(
u8
 *)(&
mib
->
d©a
[
i
 + 4]);

5970 
»g_ruË
->
äeq_¿nge
.
max_bªdwidth_khz
 = 
	`MHZ_TO_KHZ
(
by‹_v®
);

5973 
»g_ruË
->
pow”_ruË
.
max_ª‹Âa_gaš
 = 0;

5976 
by‹_v®
 = *(
u8
 *)(&
mib
->
d©a
[
i
 + 5]);

5977 
»g_ruË
->
pow”_ruË
.
max_eœp
 = 
	`DBM_TO_MBM
(
by‹_v®
);

5980 
»g_ruË
->
æags
 = 
	`¦si_»m­_»g_ruË_æags
(*(
u8
 *)(&
mib
->
d©a
[
i
 + 6]));

5982 
i
 += 7;

5984 
num_ruËs
++;

5987 
domaš_šfo
->
»gdomaš
->
n_»g_ruËs
 = 
num_ruËs
;

5988 
	}
}

5990 
	$¦si_»£t_chªÃl_æags
(
¦si_dev
 *
sdev
)

5992 
Æ80211_bªd
 
bªd
;

5993 
›“80211_chªÃl
 *
chª
;

5994 
i
;

5995 
why
 *why = 
sdev
->wiphy;

5997 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 9, 0))

5998 
bªd
 = 0; bªd < 
NUM_NL80211_BANDS
; band++) {

6000 
bªd
 = 0; bªd < 
IEEE80211_NUM_BANDS
; band++) {

6002 ià(!
why
->
bªds
[
bªd
])

6004 
i
 = 0; i < 
why
->
bªds
[
bªd
]->
n_chªÃls
; i++) {

6005 
chª
 = &
why
->
bªds
[
bªd
]->
chªÃls
[
i
];

6006 
chª
->
æags
 = 0;

6009 
	}
}

6011 
	$¦si_»ad_»guÏtÜy_ruËs
(
¦si_dev
 *
sdev
, 
¦si_802_11d_»g_domaš
 *
domaš_šfo
, cÚ¡ *
®pha2
)

6013 
i
 = 0;

6014 
couÁry_šdex
 = 0;

6015 
›“80211_»g_ruË
 *
»g_ruË
 = 
NULL
;

6017 ià((
sdev
->
»gdb
.
»gdb_¡©e
 =ğ
SLSI_REG_DB_NOT_SET
è|| (sdev->»gdb.»gdb_¡©=ğ
SLSI_REG_DB_ERROR
)) {

6018 
	`SLSI_ERR
(
sdev
, "Regulatory is‚ot set!\n");

6019  
	`¦si_»ad_»guÏtÜy_ruËs_fw
(
sdev
, 
domaš_šfo
, 
®pha2
);

6022 
i
 = 0; i < 
sdev
->
»gdb
.
num_couÁr›s
; i++) {

6023 ià((
sdev
->
»gdb
.
couÁry
[
i
].
®pha2
[0] ==‡lpha2[0]) && (sdev->regdb.country[i].alpha2[1] ==‡lpha2[1])) {

6024 
couÁry_šdex
 = 
i
;

6029 
domaš_šfo
->
»gdomaš
->
®pha2
[0] = 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].alpha2[0];

6030 
domaš_šfo
->
»gdomaš
->
®pha2
[1] = 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].alpha2[1];

6031 
domaš_šfo
->
»gdomaš
->
dfs_»giÚ
 = 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].dfs_region;

6033 
i
 = 0; i < 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË_num
; i++) {

6034 
»g_ruË
 = &
domaš_šfo
->
»gdomaš
->
»g_ruËs
[
i
];

6037 
»g_ruË
->
äeq_¿nge
.
¡¬t_äeq_khz
 = (
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->»g_ruË[
i
]->äeq_¿nge->
¡¬t_äeq
 * 1000);

6040 
»g_ruË
->
äeq_¿nge
.
’d_äeq_khz
 = (
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->»g_ruË[
i
]->äeq_¿nge->
’d_äeq
 * 1000);

6043 
»g_ruË
->
äeq_¿nge
.
max_bªdwidth_khz
 = (
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->»g_ruË[
i
]->äeq_¿nge->
max_bªdwidth
 * 1000);

6046 
»g_ruË
->
pow”_ruË
.
max_ª‹Âa_gaš
 = 0;

6049 
»g_ruË
->
pow”_ruË
.
max_eœp
 = (
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->»g_ruË[
i
]->max_eirp * 100);

6052 
»g_ruË
->
æags
 = 
	`¦si_»m­_»g_ruË_æags
(
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->»g_ruË[
i
]->flags);

6055 
domaš_šfo
->
»gdomaš
->
n_»g_ruËs
 = 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË_num
;

6058 
	}
}

6060 
	$¦si_»ad_»guÏtÜy_ruËs_fw
(
¦si_dev
 *
sdev
, 
¦si_802_11d_»g_domaš
 *
domaš_šfo
, cÚ¡ *
®pha2
)

6062 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

6063 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

6064 
¦si_mib_’Œy
 
mib_v®
;

6065 
r
 = 0;

6066 
rx_Ën
 = 0;

6067 
Ën
 = 0;

6068 
šdex
;

6070 
šdex
 = 
	`¦si_couÁry_to_šdex
(
domaš_šfo
, 
®pha2
);

6072 ià(
šdex
 == -1) {

6073 
	`SLSI_ERR
(
sdev
, "Unsupported index\n");

6074  -
EINVAL
;

6077 
	`¦si_mib_’code_g‘
(&
mib»q
, 
SLSI_PSID_UNIFI_REGULATORY_PARAMETERS
, 
šdex
);

6085 
mibr¥
.
d©aL’gth
 = 5 + 3 + (
SLSI_MIB_REG_RULES_MAX
 * 7) + 1;

6086 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

6088 ià(!
mibr¥
.
d©a
) {

6089 
	`SLSI_ERR
(
sdev
, "Failedo‡lloc for Mib„esponse\n");

6090 
	`kä“
(
mib»q
.
d©a
);

6091  -
ENOMEM
;

6094 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
NULL
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
,

6095 
mibr¥
.
d©a
, mibr¥.
d©aL’gth
, &
rx_Ën
);

6096 
	`kä“
(
mib»q
.
d©a
);

6098 ià(
r
 == 0) {

6099 
mibr¥
.
d©aL’gth
 = 
rx_Ën
;

6101 
Ën
 = 
	`¦si_mib_decode
(&
mibr¥
, &
mib_v®
);

6103 ià(
Ën
 == 0) {

6104 
	`kä“
(
mibr¥
.
d©a
);

6105 
	`SLSI_ERR
(
sdev
, "Mib decodeƒrror\n");

6106  -
EINVAL
;

6108 
	`¦si_»g_mib_to_»gd
(&
mib_v®
.
v®ue
.
u
.
où‘V®ue
, 
domaš_šfo
);

6110 
	`SLSI_ERR
(
sdev
, "Mib„—d faed (”rÜ: %d)\n", 
r
);

6113 
	`kä“
(
mibr¥
.
d©a
);

6114  
r
;

6115 
	}
}

6117 
	$¦si_couÁry_to_šdex
(
¦si_802_11d_»g_domaš
 *
domaš_šfo
, cÚ¡ *
®pha2
)

6119 
šdex
 = 0;

6120 
boŞ
 
šdex_found
 = 
çl£
;

6122 
	`SLSI_DBG3_NODEV
(
SLSI_MLME
, "\n");

6123 ià(
domaš_šfo
->
couÁryli¡
) {

6124 
šdex
 = 0; index < 
domaš_šfo
->
couÁry_Ën
; index += 2) {

6125 ià(
	`memcmp
(&
domaš_šfo
->
couÁryli¡
[
šdex
], 
®pha2
, 2) == 0) {

6126 
šdex_found
 = 
Œue
;

6134 ià(
šdex_found
)

6135  (
šdex
 / 2) + 1;

6141 
	}
}

6144 
	$¦si_£t_mib_rssi_boo¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
psid
, 
šdex
, 
boo¡
)

6146 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

6147 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

6149 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "S‘„ss˜boo¡: %d\n", 
boo¡
);

6150 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
sdev
->
deviû_cÚfig_mu‹x
));

6151 ià(
	`¦si_mib_’code_št
(&
mib_d©a
, 
psid
, 
boo¡
, 
šdex
è=ğ
SLSI_MIB_STATUS_SUCCESS
)

6152 ià(
mib_d©a
.
d©aL’gth
) {

6153 
”rÜ
 = 
	`¦si_mlme_£t
(
sdev
, 
NULL
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

6154 ià(
”rÜ
)

6155 
	`SLSI_ERR
(
sdev
, "E¼ S‘tšg MIB faed.ƒ¼Ü = %d\n", 
”rÜ
);

6156 
	`kä“
(
mib_d©a
.
d©a
);

6159  
”rÜ
;

6160 
	}
}

6162 #ifdeà
CONFIG_SCSC_WLAN_LOW_LATENCY_MODE


6163 
	$¦si_£t_mib_soá_rßmšg_’abËd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
boŞ
 
’abË
)

6165 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

6166 
”rÜ
 = 
SLSI_MIB_STATUS_FAILURE
;

6168 ià(
	`¦si_mib_’code_boŞ
(&
mib_d©a
, 
SLSI_PSID_UNIFI_ROAM_SOFT_ROAMING_ENABLED
,

6169 
’abË
, 0è=ğ
SLSI_MIB_STATUS_SUCCESS
)

6170 ià(
mib_d©a
.
d©aL’gth
) {

6171 
”rÜ
 = 
	`¦si_mlme_£t
(
sdev
, 
dev
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

6172 ià(
”rÜ
)

6173 
	`SLSI_ERR
(
sdev
, "E¼ S‘tšg MIB faed.ƒ¼Ü = %d\n", 
”rÜ
);

6174 
	`kä“
(
mib_d©a
.
d©a
);

6177  
”rÜ
;

6178 
	}
}

6181 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


6182 
	$¦si_»ad_’hªûd_¬p_rx_couÁ_by_low”_mac
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
psid
)

6184 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

6185 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

6186 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

6187 
¦si_mib_’Œy
 
mib_v®
;

6188 
r
 = 0;

6189 
rx_Ën
 = 0;

6190 
Ën
 = 0;

6192 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "\n");

6194 
	`¦si_mib_’code_g‘
(&
mib»q
, 
psid
, 0);

6196 
mibr¥
.
d©aL’gth
 = 10;

6197 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

6199 ià(!
mibr¥
.
d©a
) {

6200 
	`SLSI_ERR
(
sdev
, "Failedo‡lloc for Mib„esponse\n");

6201 
	`kä“
(
mib»q
.
d©a
);

6202  -
ENOMEM
;

6205 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
dev
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
.data,

6206 
mibr¥
.
d©aL’gth
, &
rx_Ën
);

6207 
	`kä“
(
mib»q
.
d©a
);

6209 ià(
r
 == 0) {

6210 
mibr¥
.
d©aL’gth
 = 
rx_Ën
;

6211 
Ën
 = 
	`¦si_mib_decode
(&
mibr¥
, &
mib_v®
);

6213 ià(
Ën
 == 0) {

6214 
	`kä“
(
mibr¥
.
d©a
);

6215 
	`SLSI_ERR
(
sdev
, "Mib decodeƒrror\n");

6216  -
EINVAL
;

6218 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_r¥_rx_couÁ_by_low”_mac
 = 
mib_v®
.
v®ue
.
u
.
uštV®ue
;

6220 
	`SLSI_ERR
(
sdev
, "Mib„—d faed (”rÜ: %d)\n", 
r
);

6223 
	`kä“
(
mibr¥
.
d©a
);

6224  
r
;

6225 
	}
}

6227 
	$¦si_fl_’hªûd_¬p_out_of_Üd”_drİ_couÁ”
(
Ãtdev_vif
 *
ndev_vif
,

6228 
sk_buff
 *
skb
)

6230 
‘hhdr
 *
‘h_hdr
;

6231 
u8
 *
äame
;

6232 
u16
 
¬p_İcode
;

6234 #ifdeà
CONFIG_SCSC_SMAPPER


6236 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
bulk_d©a_desütÜ
è=ğ
FAPI_BULKDATADESCRIPTOR_SMAPPER
) {

6237 
äame
 = 
	`¦si_h_g‘_skb_d©a_äom_sm­³r
(
ndev_vif
->
sdev
, 
skb
);

6238 
‘h_hdr
 = (
‘hhdr
 *)
äame
;

6239 ià(!(
‘h_hdr
)) {

6240 
	`SLSI_DBG2
(
ndev_vif
->
sdev
, 
SLSI_RX
, "SKB from SMAPPER is NULL\n");

6243 
äame
 = f¿m+ (
‘hhdr
);

6245 
äame
 = 
	`çpi_g‘_d©a
(
skb
è+ (
‘hhdr
);

6246 
‘h_hdr
 = (
‘hhdr
 *)
	`çpi_g‘_d©a
(
skb
);

6249 
äame
 = 
	`çpi_g‘_d©a
(
skb
è+ (
‘hhdr
);

6250 
‘h_hdr
 = (
‘hhdr
 *)
	`çpi_g‘_d©a
(
skb
);

6253 
¬p_İcode
 = 
äame
[
SLSI_ARP_OPCODE_OFFSET
] << 8 | frame[SLSI_ARP_OPCODE_OFFSET + 1];

6255 ià((
	`Áohs
(
‘h_hdr
->
h_´Ùo
è=ğ
ETH_P_ARP
) &&

6256 (
¬p_İcode
 =ğ
SLSI_ARP_REPLY_OPCODE
) &&

6257 !
	`SLSI_IS_GRATUITOUS_ARP
(
äame
) &&

6258 !
	`memcmp
(&
äame
[
SLSI_ARP_SRC_IP_ADDR_OFFSET
], &
ndev_vif
->
rg‘__addr
, 4))

6259 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_r¥_couÁ_out_of_Üd”_drİ
++;

6260 
	}
}

6263 
	$¦si_modify_›s_Ú_chªÃl_sw™ch
(
Ãt_deviû
 *
dev
, 
cfg80211_­_£‰šgs
 *
£‰šgs
,

6264 
u8
 *
ds_·¿ms_›
, u8 *
ht_İ”©iÚ_›
, 
›“80211_mgmt
 *
mgmt
,

6265 
u16
 
b—cÚ_›_h—d_Ën
)

6267 
	`¦si_modify_›s
(
dev
, 
WLAN_EID_DS_PARAMS
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
,

6268 
b—cÚ_›_h—d_Ën
, 2, 
	`›“80211_äequ’cy_to_chªÃl
(
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
));

6270 
	`¦si_modify_›s
(
dev
, 
WLAN_EID_HT_OPERATION
, (
u8
 *)
£‰šgs
->
b—cÚ
.

,

6271 
£‰šgs
->
b—cÚ
.
_Ën
, 2,

6272 
	`›“80211_äequ’cy_to_chªÃl
(
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
));

6273 
	}
}

6275 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


6276 
	$¦si_exŒaù_v®id_wifi_sh¬šg_chªÃls
(
¦si_dev
 *
sdev
)

6278 
i
, 
j
;

6279 
p
 = 0;

6280 
k
 = (
SLSI_MAX_CHAN_5G_BAND
 - 1);

6281 
æag
 = 0;

6283 
i
 = 4; i >= 0 ; i--) {

6284 
j
 = 0; j <= 7 ; j++) {

6285 ià((
i
 =ğ4è&& (
j
 == 0))

6286 
j
 = 1;

6287 ià(
sdev
->
wifi_sh¬šg_5ghz_chªÃl
[
i
] & (
u8
)(1 << (7 - 
j
)))

6288 
sdev
->
v®id_5g_chª
[
p
] = 
¦si_5ghz_®l_chªs
[
k
];

6290 
sdev
->
v®id_5g_chª
[
p
] = 0;

6291 
p
++;

6292 
k
--;

6293 ià(
p
 =ğ
SLSI_MAX_CHAN_5G_BAND
) {

6294 
æag
 = 1;

6298 ià(
æag
 == 1)

6301 
	}
}

6303 
boŞ
 
	$¦si_if_v®id_wifi_sh¬šg_chªÃl
(
¦si_dev
 *
sdev
, 
äeq
)

6305 
i
;

6307 
i
 = 0; i <ğ(
SLSI_MAX_CHAN_5G_BAND
 - 1) ; i++) {

6308 ià(
sdev
->
v®id_5g_chª
[
i
] =ğ
	`›“80211_g‘_chªÃl
(sdev->
why
, 
äeq
)->
hw_v®ue
)

6312 
	}
}

6314 
	$¦si_check_if_nÚ_šdoÜ_nÚ_dfs_chªÃl
(
¦si_dev
 *
sdev
, 
äeq
)

6316 
›“80211_chªÃl
 *
chªÃl
 = 
NULL
;

6317 
u32
 
chª_æags
 = 0;

6319 
chªÃl
 = 
	`›“80211_g‘_chªÃl
(
sdev
->
why
, 
äeq
);

6320 ià(!
chªÃl
) {

6321 
	`SLSI_ERR
(
sdev
, "Inv®id f»qu’cy %d u£dØ¡¬ˆAP. ChªÃÈnÙ found\n", 
äeq
);

6325 
chª_æags
 = (
IEEE80211_CHAN_INDOOR_ONLY
 | 
IEEE80211_CHAN_RADAR
 |

6326 
IEEE80211_CHAN_DISABLED
 | 
IEEE80211_CHAN_NO_IR
);

6328 ià((
chªÃl
->
æags
è& 
chª_æags
)

6332 
	}
}

6334 
	$¦si_g‘_mhs_ws_chª_vsdb
(
why
 *why, 
Ãt_deviû
 *
dev
,

6335 
cfg80211_­_£‰šgs
 *
£‰šgs
,

6336 
¦si_dev
 *
sdev
, *
wifi_sh¬šg_chªÃl_sw™ched
)

6338 
Ãt_deviû
 *
¡a_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

6339 
Ãtdev_vif
 *
ndev_¡a_vif
 = 
	`Ãtdev_´iv
(
¡a_dev
);

6340 
¡a_äequ’cy
 = 
ndev_¡a_vif
->
chª
->
ûÁ”_äeq
;

6342 ià(!
	`¦si_check_if_nÚ_šdoÜ_nÚ_dfs_chªÃl
(
sdev
, 
¡a_äequ’cy
))

6345 ià((
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
è!ğ(
¡a_äequ’cy
)) {

6346 *
wifi_sh¬šg_chªÃl_sw™ched
 = 1;

6347 
£‰šgs
->
chªdef
.
chª
 = 
	`›“80211_g‘_chªÃl
(
why
, 
¡a_äequ’cy
);

6348 
£‰šgs
->
chªdef
.
ûÁ”_äeq1
 = 
¡a_äequ’cy
;

6349 
£‰šgs
->
chªdef
.
width
 = 
NL80211_CHAN_WIDTH_20
;

6353 
	}
}

6355 
	$¦si_g‘_mhs_ws_chª_rsdb
(
why
 *why, 
Ãt_deviû
 *
dev
,

6356 
cfg80211_­_£‰šgs
 *
£‰šgs
,

6357 
¦si_dev
 *
sdev
, *
wifi_sh¬šg_chªÃl_sw™ched
)

6359 
Ãt_deviû
 *
¡a_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

6360 
Ãtdev_vif
 *
ndev_¡a_vif
 = 
	`Ãtdev_´iv
(
¡a_dev
);

6361 
¡a_äequ’cy
 = 
ndev_¡a_vif
->
chª
->
ûÁ”_äeq
;

6363 ià(((
¡a_äequ’cy
) / 1000) == 2) {

6364 ià((((
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
) / 1000) == 5) &&

6365 !(
	`¦si_check_if_chªÃl_»¡riùed_®»ady
(
sdev
,

6366 
	`›“80211_äequ’cy_to_chªÃl
(
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
))) &&

6367 
	`¦si_if_v®id_wifi_sh¬šg_chªÃl
(
sdev
, 
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
) &&

6368 
	`¦si_check_if_nÚ_šdoÜ_nÚ_dfs_chªÃl
(
sdev
, 
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
)) {

6369 
£‰šgs
->
chªdef
.
chª
 = 
	`›“80211_g‘_chªÃl
(
why
, s‘tšgs->chªdef.chª->
ûÁ”_äeq
);

6370 
£‰šgs
->
chªdef
.
ûÁ”_äeq1
 = s‘tšgs->chªdef.
chª
->
ûÁ”_äeq
;

6372 ià((
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
è!ğ(
¡a_äequ’cy
)) {

6373 *
wifi_sh¬šg_chªÃl_sw™ched
 = 1;

6374 
£‰šgs
->
chªdef
.
chª
 = 
	`›“80211_g‘_chªÃl
(
why
, 
¡a_äequ’cy
);

6375 
£‰šgs
->
chªdef
.
ûÁ”_äeq1
 = 
¡a_äequ’cy
;

6376 
£‰šgs
->
chªdef
.
width
 = 
NL80211_CHAN_WIDTH_20
;

6380 ià(((
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
) / 1000) == 5) {

6381 ià(!(
	`¦si_check_if_chªÃl_»¡riùed_®»ady
(
sdev
,

6382 
	`›“80211_äequ’cy_to_chªÃl
(
¡a_äequ’cy
))) &&

6383 
	`¦si_if_v®id_wifi_sh¬šg_chªÃl
(
sdev
, 
¡a_äequ’cy
) &&

6384 
	`¦si_check_if_nÚ_šdoÜ_nÚ_dfs_chªÃl
(
sdev
, 
¡a_äequ’cy
)) {

6385 ià((
£‰šgs
->
chªdef
.
chª
->
ûÁ”_äeq
è!ğ(
¡a_äequ’cy
)) {

6386 *
wifi_sh¬šg_chªÃl_sw™ched
 = 1;

6387 
£‰šgs
->
chªdef
.
chª
 = 
	`›“80211_g‘_chªÃl
(
why
, 
¡a_äequ’cy
);

6388 
£‰šgs
->
chªdef
.
ûÁ”_äeq1
 = 
¡a_äequ’cy
;

6389 
£‰šgs
->
chªdef
.
width
 = 
NL80211_CHAN_WIDTH_20
;

6392 *
wifi_sh¬šg_chªÃl_sw™ched
 = 1;

6393 
£‰šgs
->
chªdef
.
chª
 = 
	`›“80211_g‘_chªÃl
(
why
, 
SLSI_2G_CHANNEL_ONE
);

6394 
£‰šgs
->
chªdef
.
ûÁ”_äeq1
 = 
SLSI_2G_CHANNEL_ONE
;

6395 
£‰šgs
->
chªdef
.
width
 = 
NL80211_CHAN_WIDTH_20
;

6401 
	}
}

6403 
	$¦si_check_if_chªÃl_»¡riùed_®»ady
(
¦si_dev
 *
sdev
, 
chªÃl
)

6405 
i
;

6407 
i
 = 0; i < 
sdev
->
num_5g_»¡riùed_chªÃls
; i++)

6408 ià(
sdev
->
wifi_sh¬šg_5g_»¡riùed_chªÃls
[
i
] =ğ
chªÃl
)

6412 
	}
}

6414 
	$¦si_£t_wifish¬šg_³rm™‹d_chªÃls
(
Ãt_deviû
 *
dev
, *
bufãr
, 
buf_Ën
)

6416 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

6417 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

6418 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

6419 
”rÜ
 = 0;

6420 
i
 = 0;

6421 
b™
 = 0;

6422 
j
 = 0;

6423 
b™_mask
 = 0;

6424 
num_chªÃls
 = 0;

6425 
šdoÜ_chª_¬g
 = 0;

6426 
u8
 *
³rm™‹d_chªÃls
 = 
NULL
;

6428 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
bufãr
, 
buf_Ën
, 26);

6429 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

6431 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
šdoÜ_chª_¬g
)) {

6432 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃl_couÁ sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

6433 
	`kä“
(
ioùl_¬gs
);

6434  -
EINVAL
;

6436 
³rm™‹d_chªÃls
 = 
	`km®loc
(8, 
GFP_KERNEL
);

6438 ià(!
³rm™‹d_chªÃls
) {

6439 
”rÜ
 = -
ENOMEM
;

6440 
ex™
;

6446 ià(
šdoÜ_chª_¬g
 == 0) {

6447 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "All 5G channels…ermitted\n");

6448 
sdev
->
num_5g_»¡riùed_chªÃls
 = 0;

6449 
i
 = 0; i < 25 ; i++)

6450 
sdev
->
wifi_sh¬šg_5g_»¡riùed_chªÃls
[
i
] = 0;

6451 
³rm™‹d_chªÃls
[0] = 0xFF;

6452 
³rm™‹d_chªÃls
[1] = 0xDF;

6453 
³rm™‹d_chªÃls
[2] = 0xFF;

6454 
³rm™‹d_chªÃls
[3] = 0xFF;

6455 
³rm™‹d_chªÃls
[4] = 0x7F;

6456 
³rm™‹d_chªÃls
[5] = 0x00;

6457 
³rm™‹d_chªÃls
[6] = 0x00;

6458 
³rm™‹d_chªÃls
[7] = 0x00;

6459 } ià(
šdoÜ_chª_¬g
 == -1) {

6460 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "No 5G channel…ermitted\n");

6461 
³rm™‹d_chªÃls
[0] = 0xFF;

6462 
³rm™‹d_chªÃls
[1] = 0x1F;

6463 
i
 = 2; i < 8; i++)

6464 
³rm™‹d_chªÃls
[
i
] = 0x00;

6466 
i
 = 0; i < 25; i++) {

6467 
sdev
->
wifi_sh¬šg_5g_»¡riùed_chªÃls
[
i
] = 
¦si_5ghz_®l_chªs
[i];

6469 
sdev
->
num_5g_»¡riùed_chªÃls
 = 25;

6470 } ià(
šdoÜ_chª_¬g
 >= 1 && indoor_chan_arg <= 25) {

6471 ià((
ioùl_¬gs
->
¬g_couÁ
 - 1è< 
šdoÜ_chª_¬g
) {

6472 
	`SLSI_ERR
(
sdev
, "No. oà¬g aùu®ly…»£Á‡»†es£¸thªƒx³ùed %d\n", 
šdoÜ_chª_¬g
);

6473 
”rÜ
 = -
EINVAL
;

6474 
ex™
;

6476 
sdev
->
num_5g_»¡riùed_chªÃls
 = 0;

6477 
i
 = 0; i < 25 ; i++)

6478 
sdev
->
wifi_sh¬šg_5g_»¡riùed_chªÃls
[
i
] = 0;

6479 
³rm™‹d_chªÃls
[0] = 0xFF;

6480 
³rm™‹d_chªÃls
[1] = 0xDF;

6481 
³rm™‹d_chªÃls
[2] = 0xFF;

6482 
³rm™‹d_chªÃls
[3] = 0xFF;

6483 
³rm™‹d_chªÃls
[4] = 0x7F;

6484 
³rm™‹d_chªÃls
[5] = 0x00;

6485 
³rm™‹d_chªÃls
[6] = 0x00;

6486 
³rm™‹d_chªÃls
[7] = 0x00;

6487 
num_chªÃls
 = 
šdoÜ_chª_¬g
;

6489 
i
 = 0; i < 
num_chªÃls
; i++) {

6490 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[
i
 + 1], &
šdoÜ_chª_¬g
)) {

6491 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ¡ršg: '%s'\n", 
ioùl_¬gs
->
¬gs
[
i
 + 1]);

6492 
”rÜ
 = -
EINVAL
;

6493 
ex™
;

6495 ià(
šdoÜ_chª_¬g
 < 36 || indoor_chan_arg > 165) {

6496 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ%d\n", 
šdoÜ_chª_¬g
);

6497 
”rÜ
 = -
EINVAL
;

6498 
ex™
;

6500 
sdev
->
wifi_sh¬šg_5g_»¡riùed_chªÃls
[(sdev->
num_5g_»¡riùed_chªÃls
)++] = 
šdoÜ_chª_¬g
;

6502 
j
 = 0; j < 25; j++) {

6503 ià(
¦si_5ghz_®l_chªs
[
j
] =ğ
sdev
->
wifi_sh¬šg_5g_»¡riùed_chªÃls
[
i
]) {

6504 
b™
 = 
j
 + 14;

6508 ià((
b™
 < 14) || (bit > 38)) {

6509 
”rÜ
 = -
EINVAL
;

6510 
	`SLSI_ERR
(
sdev
, "IncÜ»ù b™…os™iÚ = %d\n", 
b™
);

6511 
ex™
;

6514 
b™_mask
 = (
b™
 % 8);

6515 
³rm™‹d_chªÃls
[
b™
 / 8] &ğ(
u8
)(~(1 << (
b™_mask
)));

6518 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈcouÁ %d\n", 
šdoÜ_chª_¬g
);

6519 
”rÜ
 = -
EINVAL
;

6520 
ex™
;

6523 
”rÜ
 = 
	`¦si_mlme_wifish¬šg_³rm™‹d_chªÃls
(
sdev
, 
dev
, 
³rm™‹d_chªÃls
);

6525 
ex™
:

6526 ià(
”rÜ
)

6527 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀ£‰šg wif˜sh¬šg…”m™‹d chªÃls.ƒ¼Ü = %d\n", 
”rÜ
);

6528 
	`kä“
(
ioùl_¬gs
);

6529 
	`kä“
(
³rm™‹d_chªÃls
);

6530  
”rÜ
;

6531 
	}
}

6533 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


6534 
	$¦si_£t_mac_¿ndomi§tiÚ_mask
(
¦si_dev
 *
sdev
, 
u8
 *
mac_add»ss_mask
)

6536 
r
 = 0;

6537 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

6539 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Mask i :%pM\n", 
mac_add»ss_mask
);

6540 
r
 = 
	`¦si_mib_’code_où‘
(&
mib_d©a
, 
SLSI_PSID_UNIFI_MAC_ADDRESS_RANDOMISATION_MASK
, 
ETH_ALEN
,

6541 
mac_add»ss_mask
, 0);

6542 ià(
r
 !ğ
SLSI_MIB_STATUS_SUCCESS
) {

6543  -
ENOMEM
;

6546 
r
 = 
	`¦si_mlme_£t
(
sdev
, 
NULL
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

6547 
	`kä“
(
mib_d©a
.
d©a
);

6549 ià(
r
 !ğ
SLSI_MIB_STATUS_SUCCESS
) {

6550 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg unifiMacAddrRªdomi¡aiÚMask MIB.ƒ¼Ü = %d\n", 
r
);

6551 ià(
sdev
->
sÿn_addr_£t
) {

6552 
¦si_mib_d©a
 
mib_d©a_¿ndomiz©iÚ_aùiv©ed
 = { 0, 
NULL
 };

6554 
r
 = 
	`¦si_mib_’code_boŞ
(&
mib_d©a_¿ndomiz©iÚ_aùiv©ed
,

6555 
SLSI_PSID_UNIFI_MAC_ADDRESS_RANDOMISATION
, 1, 0);

6556 ià(
r
 !ğ
SLSI_MIB_STATUS_SUCCESS
)

6557  -
ENOMEM
;

6559 
r
 = 
	`¦si_mlme_£t
(
sdev
, 
NULL
, 
mib_d©a_¿ndomiz©iÚ_aùiv©ed
.
d©a
,

6560 
mib_d©a_¿ndomiz©iÚ_aùiv©ed
.
d©aL’gth
);

6562 
	`kä“
(
mib_d©a_¿ndomiz©iÚ_aùiv©ed
.
d©a
);

6564 ià(
r
) {

6565 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg unifiMacAddrRªdomi¡aiÚAùiv©ed MIB.ƒ¼Ü = %d\n", 
r
);

6566  
r
;

6570  
r
;

6571 
	}
}

6574 
	$¦si_£t_couÁry_upd©e_»gd
(
¦si_dev
 *
sdev
, cÚ¡ *
®pha2_code
, 
size
)

6576 
®pha2
[4];

6577 
”rÜ
 = 0;

6579 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "S‘ couÁry code: %c%c\n", 
®pha2_code
[0],‡lpha2_code[1]);

6581 ià(
size
 == 4) {

6582 
	`memıy
(
®pha2
, 
®pha2_code
, 4);

6584 
	`memıy
(
®pha2
, 
®pha2_code
, 3);

6585 
®pha2
[3] = '\0';

6588 ià(
	`memcmp
(
®pha2
, 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->alpha2, 2) == 0) {

6589 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "Country is‡lready setohe„equested country code\n");

6593 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

6594 
”rÜ
 = 
	`¦si_mlme_£t_couÁry
(
sdev
, 
®pha2
);

6596 ià(
”rÜ
) {

6597 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg couÁryƒ¼Ü = %d\n", 
”rÜ
);

6598 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

6603 ià(
	`¦si_»ad_»guÏtÜy_ruËs
(
sdev
, &sdev->
deviû_cÚfig
.
domaš_šfo
, 
®pha2
) == 0) {

6604 
	`¦si_»£t_chªÃl_æags
(
sdev
);

6605 
	`why_­¶y_cu¡om_»guÏtÜy
(
sdev
->
why
, sdev->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
);

6606 
	`¦si_upd©e_suµÜ‹d_chªÃls_»gd_æags
(
sdev
);

6609 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

6610  
”rÜ
;

6611 
	}
}

6614 
	$¦si_»ad_discÚÃù_šd_timeout
(
¦si_dev
 *
sdev
, 
u16
 
psid
)

6616 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

6617 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

6618 
¦si_mib_’Œy
 
mib_v®
;

6619 
r
 = 0;

6620 
rx_Ën
 = 0;

6621 
Ën
 = 0;

6623 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "\n");

6625 
	`¦si_mib_’code_g‘
(&
mib»q
, 
psid
, 0);

6627 
mibr¥
.
d©aL’gth
 = 10;

6628 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

6630 ià(!
mibr¥
.
d©a
) {

6631 
	`SLSI_ERR
(
sdev
, "Failedo‡lloc for Mib„esponse\n");

6632 
	`kä“
(
mib»q
.
d©a
);

6633  -
ENOMEM
;

6636 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
NULL
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
.data,

6637 
mibr¥
.
d©aL’gth
, &
rx_Ën
);

6638 
	`kä“
(
mib»q
.
d©a
);

6640 ià(
r
 == 0) {

6641 
mibr¥
.
d©aL’gth
 = 
rx_Ën
;

6642 
Ën
 = 
	`¦si_mib_decode
(&
mibr¥
, &
mib_v®
);

6644 ià(
Ën
 == 0) {

6645 
	`kä“
(
mibr¥
.
d©a
);

6646 
	`SLSI_ERR
(
sdev
, "Mib decodeƒrror\n");

6647  -
EINVAL
;

6650 
sdev
->
deviû_cÚfig
.
­_discÚÃù_šd_timeout
 = ((
mib_v®
.
v®ue
.
u
.
uštV®ue
 + 1) * 1000);

6652 
	`SLSI_ERR
(
sdev
, "Mib„—d faed (”rÜ: %d)\n", 
r
);

6655 
	`kä“
(
mibr¥
.
d©a
);

6656  
r
;

6657 
	}
}

6659 
	$¦si_g‘_b—cÚ_cu
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, *
mib_v®ue
)

6661 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

6662 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

6663 
¦si_mib_’Œy
 
mib_v®
;

6664 
r
 = 0;

6665 
rx_Ën
 = 0;

6666 
Ën
 = 0;

6668 
	`¦si_mib_’code_g‘
(&
mib»q
, 
SLSI_PSID_UNIFI_BEACON_CU
, 0);

6670 
mibr¥
.
d©aL’gth
 = 6;

6671 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

6673 ià(!
mibr¥
.
d©a
) {

6674 
	`SLSI_ERR
(
sdev
, "Failedo‡lloc for Mib„esponse\n");

6675 
	`kä“
(
mib»q
.
d©a
);

6676  -
ENOMEM
;

6679 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
dev
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
.data,

6680 
mibr¥
.
d©aL’gth
, &
rx_Ën
);

6681 
	`kä“
(
mib»q
.
d©a
);

6683 ià(
r
 == 0) {

6684 
mibr¥
.
d©aL’gth
 = 
rx_Ën
;

6685 
Ën
 = 
	`¦si_mib_decode
(&
mibr¥
, &
mib_v®
);

6687 ià(
Ën
 == 0) {

6688 
	`kä“
(
mibr¥
.
d©a
);

6689 
	`SLSI_ERR
(
sdev
, "Mib decodeƒrror\n");

6690  -
EINVAL
;

6692 *
mib_v®ue
 = 
mib_v®
.
v®ue
.
u
.
štV®ue
;

6693 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "MIB v®uğ%d\n", *
mib_v®ue
);

6695 
	`SLSI_ERR
(
sdev
, "Mib„—d faed (”rÜ: %d)\n", 
r
);

6698 
	`kä“
(
mibr¥
.
d©a
);

6699  
r
;

6700 
	}
}

6703 
	$¦si_»ad_deçuÉ_couÁry
(
¦si_dev
 *
sdev
, 
u8
 *
®pha2
, 
u16
 
šdex
)

6705 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

6706 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

6707 
¦si_mib_’Œy
 
mib_v®
;

6708 
r
 = 0;

6709 
rx_Ën
 = 0;

6710 
Ën
 = 0;

6712 
	`¦si_mib_’code_g‘
(&
mib»q
, 
SLSI_PSID_UNIFI_DEFAULT_COUNTRY
, 
šdex
);

6714 
mibr¥
.
d©aL’gth
 = 11;

6715 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

6717 ià(!
mibr¥
.
d©a
) {

6718 
	`SLSI_ERR
(
sdev
, "Failedo‡lloc for Mib„esponse\n");

6719 
	`kä“
(
mib»q
.
d©a
);

6720  -
ENOMEM
;

6723 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
NULL
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
.data,

6724 
mibr¥
.
d©aL’gth
, &
rx_Ën
);

6726 
	`kä“
(
mib»q
.
d©a
);

6728 ià(
r
 == 0) {

6729 
mibr¥
.
d©aL’gth
 = 
rx_Ën
;

6730 
Ën
 = 
	`¦si_mib_decode
(&
mibr¥
, &
mib_v®
);

6732 ià(
Ën
 == 0) {

6733 
	`kä“
(
mibr¥
.
d©a
);

6734 
	`SLSI_ERR
(
sdev
, "Mib decodeƒrror\n");

6735  -
EINVAL
;

6737 
	`memıy
(
®pha2
, 
mib_v®
.
v®ue
.
u
.
où‘V®ue
.
d©a
, 2);

6739 
	`SLSI_ERR
(
sdev
, "Mib„—d faed (”rÜ: %d)\n", 
r
);

6742 
	`kä“
(
mibr¥
.
d©a
);

6743  
r
;

6744 
	}
}

6746 
	$¦si_cİy_couÁry_bË
(
¦si_dev
 *
sdev
, 
¦si_mib_d©a
 *
mib
, 
Ën
)

6748 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "\n");

6750 
	`kä“
(
sdev
->
deviû_cÚfig
.
domaš_šfo
.
couÁryli¡
);

6751 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
couÁryli¡
 = 
	`km®loc
(
Ën
, 
GFP_KERNEL
);

6753 ià(!
sdev
->
deviû_cÚfig
.
domaš_šfo
.
couÁryli¡
) {

6754 
	`SLSI_ERR
(
sdev
, "kmalloc failed\n");

6755  -
EINVAL
;

6758 ià(!
mib
 || !mib->
d©a
) {

6759 
	`SLSI_ERR
(
sdev
, "Invalid MIB countryable\n");

6760  -
EINVAL
;

6763 
	`memıy
(
sdev
->
deviû_cÚfig
.
domaš_šfo
.
couÁryli¡
, 
mib
->
d©a
, 
Ën
);

6764 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
couÁry_Ën
 = 
Ën
;

6767 
	}
}

6770 
	$¦si_»ad_unifi_couÁryli¡
(
¦si_dev
 *
sdev
, 
u16
 
psid
)

6772 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

6773 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

6774 
¦si_mib_’Œy
 
mib_v®
;

6775 
r
 = 0;

6776 
rx_Ën
 = 0;

6777 
Ën
 = 0;

6778 
»t
;

6780 
	`¦si_mib_’code_g‘
(&
mib»q
, 
psid
, 0);

6785 
mibr¥
.
d©aL’gth
 = 5 + (
NUM_COUNTRY
 * 2);

6786 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

6788 ià(!
mibr¥
.
d©a
) {

6789 
	`SLSI_ERR
(
sdev
, "Failedo‡lloc for Mib„esponse\n");

6790 
	`kä“
(
mib»q
.
d©a
);

6791  -
ENOMEM
;

6794 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
NULL
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
.data,

6795 
mibr¥
.
d©aL’gth
, &
rx_Ën
);

6797 
	`kä“
(
mib»q
.
d©a
);

6799 ià(
r
 == 0) {

6800 
mibr¥
.
d©aL’gth
 = 
rx_Ën
;

6801 
Ën
 = 
	`¦si_mib_decode
(&
mibr¥
, &
mib_v®
);

6803 ià(
Ën
 == 0) {

6804 
	`kä“
(
mibr¥
.
d©a
);

6805  -
EINVAL
;

6807 
»t
 = 
	`¦si_cİy_couÁry_bË
(
sdev
, &
mib_v®
.
v®ue
.
u
.
où‘V®ue
, 
Ën
);

6808 ià(
»t
 < 0) {

6809 
	`kä“
(
mibr¥
.
d©a
);

6810  
»t
;

6813 
	`SLSI_ERR
(
sdev
, "Mib„—d faed (”rÜ: %d)\n", 
r
);

6816 
	`kä“
(
mibr¥
.
d©a
);

6817  
r
;

6818 
	}
}

6820 
	$¦si_ş—r_offchªÃl_d©a
(
¦si_dev
 *
sdev
, 
boŞ
 
acquœe_lock
)

6822 
Ãt_deviû
 *
dev
 = 
NULL
;

6823 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

6825 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2PX_SWLAN
);

6826 ià(
	`WARN_ON
(!
dev
)) {

6827 
	`SLSI_ERR
(
sdev
, "No Group‚et dev found\n");

6830 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

6832 ià(
acquœe_lock
)

6833 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

6836 ()
	`¦si_mlme_»£t_dw–l_time
(
sdev
, 
dev
);

6838 ià(
acquœe_lock
)

6839 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

6841 
sdev
->
p2p_group_exp_äame
 = 
SLSI_PA_INVALID
;

6842 
	}
}

6844 
	$¦si_hs2_unsync_vif_d–‘e_wÜk
(
wÜk_¡ruù
 *
wÜk
)

6846 
Ãtdev_vif
 *
ndev_vif
 = 
	`cÚš”_of
((
d–ayed_wÜk
 *)
wÜk
, Ãtdev_vif, 
unsync
.
hs2_d–_vif_wÜk
);

6848 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

6849 
	`SLSI_NET_DBG1
(
ndev_vif
->
wdev
.
Ãtdev
, 
SLSI_CFG80211
, "Delete HS vif durationƒxpired - Deactivate unsync vif\n");

6850 
	`¦si_wÏn_unsync_vif_d—ùiv©e
(
ndev_vif
->
sdev
,‚dev_vif->
wdev
.
Ãtdev
, 
Œue
);

6851 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

6852 
	}
}

6854 
	$¦si_wÏn_unsync_vif_aùiv©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

6855 
›“80211_chªÃl
 *
chª
, 
u16
 
wa™
)

6857 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

6858 
r
 = 0;

6859 
u8
 
deviû_add»ss
[
ETH_ALEN
] = { 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF };

6860 
u32
 
aùiÚ_äame_bm­
;

6862 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "Activate wlan unsync vif\n");

6864 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

6866 
ndev_vif
->
vif_ty³
 = 
FAPI_VIFTYPE_UNSYNCHRONISED
;

6869 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

6871 ià(
ndev_vif
->
mgmt_tx_gas_äame
) {

6872 ià(
	`¦si_mlme_add_vif
(
sdev
, 
dev
, 
ndev_vif
->
gas_äame_mac_addr
, 
deviû_add»ss
) != 0) {

6873 
	`SLSI_NET_ERR
(
dev
, "add vif failed for wlan unsync vif\n");

6874 
ex™_w™h_”rÜ
;

6877 ià(
	`¦si_mlme_add_vif
(
sdev
, 
dev
, dev->
dev_addr
, 
deviû_add»ss
) != 0) {

6878 
	`SLSI_NET_ERR
(
dev
, "add vif failed for wlan unsync vif\n");

6879 
ex™_w™h_”rÜ
;

6883 ià(
	`¦si_vif_aùiv©ed
(
sdev
, 
dev
) != 0) {

6884 
	`SLSI_NET_ERR
(
dev
, "vif‡ctivate failed for wlan unsync vif\n");

6885 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

6886 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

6887 
ex™_w™h_”rÜ
;

6889 
sdev
->
wÏn_unsync_vif_¡©e
 = 
WLAN_UNSYNC_VIF_ACTIVE
;

6890 
aùiÚ_äame_bm­
 = 
SLSI_ACTION_FRAME_PUBLIC
 | 
SLSI_ACTION_FRAME_RADIO_MEASUREMENT
;

6892 
r
 = 
	`¦si_mlme_»gi¡”_aùiÚ_äame
(
sdev
, 
dev
, 
aùiÚ_äame_bm­
,‡ction_frame_bmap);

6893 ià(
r
 != 0) {

6894 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_register_action_frame failed:„esultcode = %d,‡ction_frame_bmap:%d\n",

6895 
r
, 
aùiÚ_äame_bm­
);

6896 
ex™_w™h_vif
;

6899 ià(
	`¦si_mlme_£t_chªÃl
(
sdev
, 
dev
, 
chª
, 
SLSI_FW_CHANNEL_DURATION_UNSPECIFIED
, 0, 0) != 0) {

6900 
	`SLSI_NET_ERR
(
dev
, "Set channel failed for wlan unsync vif\n");

6901 
ex™_w™h_vif
;

6903 
ndev_vif
->
chª
 = chan;

6904 
ndev_vif
->
driv”_chªÃl
 = 
chª
->
hw_v®ue
;

6905  
r
;

6907 
ex™_w™h_vif
:

6908 
	`¦si_wÏn_unsync_vif_d—ùiv©e
(
sdev
, 
dev
, 
Œue
);

6909 
ex™_w™h_”rÜ
:

6910 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

6911  -
EINVAL
;

6912 
	}
}

6914 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

6915 
boŞ
 
	$¦si_£Ëù_­_fÜ_cÚÃùiÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 **
bssid
,

6916 
›“80211_chªÃl
 **
chªÃl
, 
boŞ
 
»Œy
)

6918 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

6919 
li¡_h—d
 *
pos
;

6921 
	`li¡_fÜ_—ch
(
pos
, &
ndev_vif
->
¡a
.
ssid_šfo
) {

6922 
¦si_ssid_šfo
 *
ssid_šfo
 = 
	`li¡_’Œy
(
pos
, ¦si_ssid_šfo, 
li¡
);

6923 
li¡_h—d
 *
pos_bssid
;

6925 ià(
ssid_šfo
->
ssid
.
ssid_Ën
 !ğ
ndev_vif
->
¡a
.ssid_len ||

6926 
	`memcmp
(
ssid_šfo
->
ssid
.ssid, &
ndev_vif
->
¡a
.ssid,‚dev_vif->¡a.
ssid_Ën
) != 0 ||

6927 !(
ssid_šfo
->
akm_ty³
 & 
ndev_vif
->
¡a
.akm_type))

6930 
	`li¡_fÜ_—ch
(
pos_bssid
, &
ssid_šfo
->
bssid_li¡
) {

6931 
¦si_bssid_šfo
 *
bssid_šfo
 = 
	`li¡_’Œy
(
pos_bssid
, ¦si_bssid_šfo, 
li¡
);

6933 ià(
	`¦si_is_bssid_š_bÏckli¡
(
sdev
, 
dev
, 
bssid_šfo
->
bssid
) ||

6934 
bssid_šfo
->
cÚÃù_©‹m±ed
)

6936 ià(
»Œy
) {

6937 ià(
ndev_vif
->
¡a
.
sme
.
ssid
) {

6938 
	`kä“
(
ndev_vif
->
¡a
.
sme
.
ssid
);

6939 
ndev_vif
->
¡a
.
sme
.
ssid_Ën
 = 0;

6941 
ndev_vif
->
¡a
.
sme
.
ssid
 = 
	`¦si_mem_dup
((
u8
 *)
ssid_šfo
->ssid.ssid,

6942 
ssid_šfo
->
ssid
.
ssid_Ën
);

6943 
ndev_vif
->
¡a
.
sme
.
ssid_Ën
 = 
ssid_šfo
->
ssid
.ssid_len;

6945 ià(
ndev_vif
->
¡a
.
sme
.
bssid
)

6946 
	`kä“
(
ndev_vif
->
¡a
.
sme
.
bssid
);

6947 
ndev_vif
->
¡a
.
sme
.
bssid
 = 
	`¦si_mem_dup
((
u8
 *)
bssid_šfo
->bssid,

6948 
ETH_ALEN
);

6949 
ndev_vif
->
¡a
.
sme
.
chªÃl
 =

6950 (
›“80211_chªÃl
 *)
	`¦si_mem_dup
((
u8
 *)
	`›“80211_g‘_chªÃl
(
sdev
->
why
,

6951 (
bssid_šfo
->
äeq
 / 2)),

6952 (
›“80211_chªÃl
));

6953 ià(
ndev_vif
->
¡a
.
¡a_bss
) {

6954 
	`cfg80211_put_bss
(
sdev
->
why
, 
ndev_vif
->
¡a
.
¡a_bss
);

6955 
ndev_vif
->
¡a
.
¡a_bss
 = 
NULL
;

6958 *
bssid
 = 
bssid_šfo
->bssid;

6959 *
chªÃl
 = 
	`›“80211_g‘_chªÃl
(
sdev
->
why
, (
bssid_šfo
->
äeq
 / 2));

6961 
bssid_šfo
->
cÚÃù_©‹m±ed
 = 
Œue
;

6962 
	`SLSI_INFO
(
sdev
, "S–eùšg AP %pM fÜ cÚÃùiÚ\n", 
bssid_šfo
->
bssid
);

6963  
Œue
;

6967  
çl£
;

6968 
	}
}

6970 
	$¦si_£t_»£t_cÚÃù_©‹m±ed_æag
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
bssid
)

6972 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

6973 
li¡_h—d
 *
pos
;

6975 
	`li¡_fÜ_—ch
(
pos
, &
ndev_vif
->
¡a
.
ssid_šfo
) {

6976 
¦si_ssid_šfo
 *
ssid_šfo
 = 
	`li¡_’Œy
(
pos
, ¦si_ssid_šfo, 
li¡
);

6977 
li¡_h—d
 *
pos_bssid
;

6979 ià(
ssid_šfo
->
ssid
.
ssid_Ën
 =ğ
ndev_vif
->
¡a
.ssid_len &&

6980 
	`memcmp
(
ssid_šfo
->
ssid
.ssid, &
ndev_vif
->
¡a
.ssid,‚dev_vif->¡a.
ssid_Ën
) == 0 &&

6981 (
ssid_šfo
->
akm_ty³
 & 
ndev_vif
->
¡a
.akm_type)) {

6982 
	`li¡_fÜ_—ch
(
pos_bssid
, &
ssid_šfo
->
bssid_li¡
) {

6983 
¦si_bssid_šfo
 *
bssid_šfo
 = 
	`li¡_’Œy
(
pos_bssid
, ¦si_bssid_šfo, 
li¡
);

6985 ià(
bssid
 && !
	`memcmp
(
ndev_vif
->
¡a
.
cÚÃùed_bssid
, 
bssid_šfo
->bssid, 
ETH_ALEN
)) {

6986 
bssid_šfo
->
cÚÃù_©‹m±ed
 = 
Œue
;

6988 } ià(!
bssid
) {

6989 
bssid_šfo
->
cÚÃù_©‹m±ed
 = 
çl£
;

6994 
	}
}

6997 
boŞ
 
	$¦si_is_bssid_š_bÏckli¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
bssid
)

6999 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7000 
i
, 
imax
;

7001 
li¡_h—d
 *
bÏckli¡_pos
, *
bÏckli¡_q
;

7004 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_fw_li¡
) {

7005 
¦si_bssid_bÏckli¡_šfo
 *
bÏckli¡_šfo
;

7007 
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
, 
¦si_bssid_bÏckli¡_šfo
, 
li¡
);

7008 ià(
bÏckli¡_šfo
 && 
	`SLSI_ETHER_EQUAL
(bÏckli¡_šfo->
bssid
, bssid) &&

7009 (
	`jiff›s_to_m£cs
(
jiff›s
è< 
bÏckli¡_šfo
->
’d_time
)) {

7010  
Œue
;

7014 ià(
ndev_vif
->
aş_d©a_suµliÿÁ
)

7015 
imax
 = 
ndev_vif
->
aş_d©a_suµliÿÁ
->
n_aş_’Œ›s
;

7017 
imax
 = 0;

7018 
i
 = 0; i < 
imax
; i++) {

7019 ià(
	`SLSI_ETHER_EQUAL
(
ndev_vif
->
aş_d©a_suµliÿÁ
->
mac_addrs
[
i
].
addr
, 
bssid
))

7020  
Œue
;

7023  
çl£
;

7024 
	}
}

7026 
boŞ
 
	$¦si_is_bssid_š_h®_bÏckli¡
(
Ãt_deviû
 *
dev
, 
u8
 *
bssid
)

7028 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7029 
i
, 
imax
;

7031 ià(
ndev_vif
->
aş_d©a_h®
)

7032 
imax
 = 
ndev_vif
->
aş_d©a_h®
->
n_aş_’Œ›s
;

7034 
imax
 = 0;

7035 
i
 = 0; i < 
imax
; i++) {

7036 ià(
	`SLSI_ETHER_EQUAL
(
ndev_vif
->
aş_d©a_h®
->
mac_addrs
[
i
].
addr
, 
bssid
))

7037  
Œue
;

7039  
çl£
;

7040 
	}
}

7042 
boŞ
 
	$¦si_is_bssid_š_ioùl_bÏckli¡
(
Ãt_deviû
 *
dev
, 
u8
 *
bssid
)

7044 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7045 
li¡_h—d
 *
bÏckli¡_pos
, *
bÏckli¡_q
;

7048 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_ioùl_li¡
) {

7049 
¦si_ioùl_bÏckli¡_šfo
 *
bÏckli¡_šfo
;

7051 
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
, 
¦si_ioùl_bÏckli¡_šfo
, 
li¡
);

7052 ià(
bÏckli¡_šfo
 && 
	`SLSI_ETHER_EQUAL
(bÏckli¡_šfo->
bssid
, bssid))

7053  
Œue
;

7055  
çl£
;

7056 
	}
}

7058 
	$¦si_add_ioùl_bÏckli¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
addr
)

7060 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7061 
¦si_ioùl_bÏckli¡_šfo
 *
d©a
;

7062 
»t
 = 0;

7064 
d©a
 = 
	`kz®loc
((*d©a), 
GFP_KERNEL
);

7066 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "ADD BÏckli¡ BSSID = " 
MACSTR
 "\n",

7067 
	`MAC2STR
(
addr
));

7068 ià(!
d©a
) {

7069 
	`SLSI_ERR
(
sdev
, "Blacklist: Unableo‡llocate mem\n");

7070  -
ENOMEM
;

7072 
	`‘h”_addr_cİy
(
d©a
->
bssid
, 
addr
);

7073 
	`li¡_add
(&
d©a
->
li¡
, &
ndev_vif
->
aş_d©a_ioùl_li¡
);

7076 
»t
 = 
	`¦si_£t_aş
(
sdev
, 
dev
);

7077  
»t
;

7078 
	}
}

7080 
	$¦si_»move_bssid_bÏckli¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
addr
)

7082 
li¡_h—d
 *
bÏckli¡_pos
, *
bÏckli¡_q
;

7083 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7084 
»t
 = 0;

7085 
i
, 
imax
;

7087 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "RemovBÏckli¡ BSSID = " 
MACSTR
 "\n",

7088 
	`MAC2STR
(
addr
));

7091 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_ioùl_li¡
) {

7092 
¦si_ioùl_bÏckli¡_šfo
 *
bÏckli¡_šfo
;

7094 
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
, 
¦si_ioùl_bÏckli¡_šfo
, 
li¡
);

7096 ià(
bÏckli¡_šfo
 && 
	`SLSI_ETHER_EQUAL
(bÏckli¡_šfo->
bssid
, 
addr
)) {

7097 
	`li¡_d–
(
bÏckli¡_pos
);

7098 
	`kä“
(
bÏckli¡_šfo
);

7099 
»t
 = 1;

7104 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_fw_li¡
) {

7105 
¦si_bssid_bÏckli¡_šfo
 *
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
,

7106 
¦si_bssid_bÏckli¡_šfo
, 
li¡
);

7107 ià(
bÏckli¡_šfo
 && 
	`SLSI_ETHER_EQUAL
(bÏckli¡_šfo->
bssid
, 
addr
)) {

7108 
	`li¡_d–
(
bÏckli¡_pos
);

7109 
	`kä“
(
bÏckli¡_šfo
);

7110 
»t
 = 1;

7115 ià(
ndev_vif
->
aş_d©a_h®
)

7116 
imax
 = 
ndev_vif
->
aş_d©a_h®
->
n_aş_’Œ›s
;

7118 
imax
 = 0;

7119 
i
 = 0; i < 
imax
; i++) {

7120 ià(
	`SLSI_ETHER_EQUAL
(
ndev_vif
->
aş_d©a_h®
->
mac_addrs
[
i
].
addr
,‡ddr)) {

7121 ià(
i
 !ğ
imax
 - 1) {

7122 
	`memıy
(
ndev_vif
->
aş_d©a_h®
->
mac_addrs
[
i
].
addr
,

7123 
ndev_vif
->
aş_d©a_h®
->
mac_addrs
[
i
 + 1].
addr
,

7124 (
imax
 - 
i
 - 1è* 
ETH_ALEN
);

7126 
	`mem£t
(
ndev_vif
->
aş_d©a_h®
->
mac_addrs
[
imax
 - 1].
addr
,

7128 (
mac_add»ss
));

7129 
ndev_vif
->
aş_d©a_h®
->
n_aş_’Œ›s
 -= 1;

7130 
»t
 = 1;

7135 ià(
ndev_vif
->
aş_d©a_suµliÿÁ
)

7136 
imax
 = 
ndev_vif
->
aş_d©a_suµliÿÁ
->
n_aş_’Œ›s
;

7138 
imax
 = 0;

7139 
i
 = 0; i < 
imax
; i++) {

7140 ià(
	`SLSI_ETHER_EQUAL
(
ndev_vif
->
aş_d©a_suµliÿÁ
->
mac_addrs
[
i
].
addr
,‡ddr)) {

7141 ià(
i
 !ğ
imax
 - 1) {

7142 
	`memıy
(
ndev_vif
->
aş_d©a_suµliÿÁ
->
mac_addrs
[
i
].
addr
,

7143 
ndev_vif
->
aş_d©a_suµliÿÁ
->
mac_addrs
[
i
 + 1].
addr
,

7144 (
imax
 - 
i
 - 1è* 
ETH_ALEN
);

7146 
	`mem£t
(
ndev_vif
->
aş_d©a_suµliÿÁ
->
mac_addrs
[
imax
 - 1].
addr
,

7148 (
mac_add»ss
));

7149 
»t
 = 1;

7150 
ndev_vif
->
aş_d©a_suµliÿÁ
->
n_aş_’Œ›s
 -= 1;

7155 ià(!
»t
) {

7156 
	`SLSI_NET_INFO
(
dev
, "BÏckli¡ BSSID:" 
MACSTR
 " NÙ…»£Á\n", 
	`MAC2STR
(
addr
));

7157  
»t
;

7160 
»t
 = 
	`¦si_£t_aş
(
sdev
, 
dev
);

7161  
»t
;

7162 
	}
}

7165 
	$¦si_wÏn_unsync_vif_d—ùiv©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
boŞ
 
hw_avaabË
)

7167 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7169 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_INIT_DEINIT
, "De-activate wlan unsync vif\n");

7171 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

7173 ià(
sdev
->
wÏn_unsync_vif_¡©e
 =ğ
WLAN_UNSYNC_NO_VIF
) {

7174 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_INIT_DEINIT
, "wlan unsync vif‡lready deactivated\n");

7178 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
hs2_d–_vif_wÜk
);

7180 ià(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
è&& 
sdev
->
»cov”y_¡©us
) {

7181 
	`cfg80211_»maš_Ú_chªÃl_expœed
(&
ndev_vif
->
wdev
,‚dev_vif->
unsync
.
roc_cook›
,‚dev_vif->
chª
,

7182 
GFP_KERNEL
);

7183 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
);

7188 ià(
hw_avaabË
)

7189 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

7190 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

7192 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

7194 
sdev
->
wÏn_unsync_vif_¡©e
 = 
WLAN_UNSYNC_NO_VIF
;

7195 
ndev_vif
->
aùiv©ed
 = 
çl£
;

7196 
ndev_vif
->
chª
 = 
NULL
;

7198 ()
	`¦si_£t_mgmt_tx_d©a
(
ndev_vif
, 0, 0, 
NULL
, 0);

7199 
	}
}

7201 
	$¦si_sÿn_šd_timeout_hªdË
(
wÜk_¡ruù
 *
wÜk
)

7203 
Ãtdev_vif
 *
ndev_vif
 = 
	`cÚš”_of
((
d–ayed_wÜk
 *)
wÜk
, Ãtdev_vif, 
sÿn_timeout_wÜk
);

7204 
Ãt_deviû
 *
dev
 = 
	`¦si_g‘_Ãtdev
(
ndev_vif
->
sdev
,‚dev_vif->
iâum
);

7206 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

7207 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

7208 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
) {

7209 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
»queue_timeout_wÜk
) {

7210 
	`queue_d–ayed_wÜk
(
ndev_vif
->
sdev
->
deviû_wq
, &ndev_vif->
sÿn_timeout_wÜk
,

7211 
	`m£cs_to_jiff›s
(
SLSI_FW_SCAN_DONE_TIMEOUT_MSEC
));

7212 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
»queue_timeout_wÜk
 = 
çl£
;

7214 
	`SLSI_WARN
(
ndev_vif
->
sdev
, "Mlme_scan_done_ind‚ot„eceived\n");

7215 ()
	`¦si_mlme_d–_sÿn
(
ndev_vif
->
sdev
, 
dev
,‚dev_vif->
iâum
 << 8 | 
SLSI_SCAN_HW_ID
, 
Œue
);

7216 
	`¦si_sÿn_com¶‘e
(
ndev_vif
->
sdev
, 
dev
, 
SLSI_SCAN_HW_ID
, 
çl£
, false);

7219 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

7220 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

7221 
	}
}

7223 
	$¦si_bÏckli¡_d–_wÜk_hªdË
(
wÜk_¡ruù
 *
wÜk
)

7225 
Ãtdev_vif
 *
ndev_vif
 = 
	`cÚš”_of
((
d–ayed_wÜk
 *)
wÜk
, Ãtdev_vif, 
bÏckli¡_d–_wÜk
);

7226 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

7227 
Ãt_deviû
 *
dev
;

7228 
li¡_h—d
 *
bÏckli¡_pos
, *
bÏckli¡_q
;

7229 
u32
 
»‹ÁiÚ_time
 = 0;

7230 
d–‘ed
 = 0;

7232 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

7233 
dev
 = 
	`¦si_ndev_vif_2_Ãt_deviû
(
ndev_vif
);

7234 ià(!
dev
) {

7235 
	`SLSI_WARN
(
sdev
, "Inv®id‚dev_vià:%p\n", 
ndev_vif
);

7236 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

7239 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_fw_li¡
) {

7240 
¦si_bssid_bÏckli¡_šfo
 *
bÏckli¡_šfo
;

7242 
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
, 
¦si_bssid_bÏckli¡_šfo
, 
li¡
);

7243 ià(
	`jiff›s_to_m£cs
(
jiff›s
è> 
bÏckli¡_šfo
->
’d_time
) {

7244 
	`li¡_d–
(
bÏckli¡_pos
);

7245 
	`kä“
(
bÏckli¡_šfo
);

7246 
d–‘ed
 = 1;

7249 ià(!
»‹ÁiÚ_time
)

7250 
»‹ÁiÚ_time
 = 
bÏckli¡_šfo
->
’d_time
 - 
	`jiff›s_to_m£cs
(
jiff›s
);

7251 ià((
bÏckli¡_šfo
->
’d_time
 - 
	`jiff›s_to_m£cs
(
jiff›s
)è< 
»‹ÁiÚ_time
)

7252 
»‹ÁiÚ_time
 = 
bÏckli¡_šfo
->
’d_time
 - 
	`jiff›s_to_m£cs
(
jiff›s
);

7254 ià(
d–‘ed
)

7255 
	`¦si_£t_aş
(
sdev
, 
dev
);

7256 ià(
»‹ÁiÚ_time
)

7257 
	`queue_d–ayed_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
bÏckli¡_d–_wÜk
,

7258 
	`m£cs_to_jiff›s
(
»‹ÁiÚ_time
));

7259 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

7260 
	}
}

7262 
	$¦si_upd©e_suµÜ‹d_chªÃls_»gd_æags
(
¦si_dev
 *
sdev
)

7264 
i
 = 0;

7265 
why
 *why = 
sdev
->wiphy;

7266 
›“80211_chªÃl
 *
chª
;

7271 ià(
sdev
->
’abËd_chªÃl_couÁ
 == 39)

7273 ià(
why
->
bªds
[0]) {

7274 
i
 = 0; i < 
	`ARRAY_SIZE
(
sdev
->
suµÜ‹d_2g_chªÃls
); i++) {

7275 ià(
sdev
->
suµÜ‹d_2g_chªÃls
[
i
] == 0) {

7276 
chª
 = &
why
->
bªds
[0]->
chªÃls
[
i
];

7277 
chª
->
æags
 |ğ
IEEE80211_CHAN_DISABLED
;

7281 ià(
sdev
->
bªd_5g_suµÜ‹d
 && 
why
->
bªds
[1]) {

7282 
i
 = 0; i < 
	`ARRAY_SIZE
(
sdev
->
suµÜ‹d_5g_chªÃls
); i++) {

7283 ià(
sdev
->
suµÜ‹d_5g_chªÃls
[
i
] == 0) {

7284 
chª
 = &
why
->
bªds
[1]->
chªÃls
[
i
];

7285 
chª
->
æags
 |ğ
IEEE80211_CHAN_DISABLED
;

7289 
	}
}

7291 
	$¦si_fšd_chª_idx
(
u16
 
chª
, 
u8
 
hw_mode
)

7293 
idx
 = -1, 
i
 = 0;

7294 
u16
 
¦si_5ghz_chªÃls_li¡
[25] = {36, 40, 44, 48, 52, 56, 60, 64, 100, 104, 108, 112, 116, 120, 124, 128, 132,

7297 ià(
hw_mode
 =ğ
SLSI_ACS_MODE_IEEE80211B
 || hw_mod=ğ
SLSI_ACS_MODE_IEEE80211G
) {

7298 ià(
chª
 <ğ
MAX_24G_CHANNELS
)

7299 
idx
 = 
chª
 - 1;

7300 } ià(
hw_mode
 =ğ
SLSI_ACS_MODE_IEEE80211A
) {

7301 
i
 = 0; i < 
MAX_5G_CHANNELS
; i++) {

7302 ià(
chª
 =ğ
¦si_5ghz_chªÃls_li¡
[
i
]) {

7303 
idx
 = 
i
;

7308 ià(
chª
 <ğ
MAX_24G_CHANNELS
) {

7309 
idx
 = 
chª
 - 1;

7311 
i
 = 0; i < 
MAX_5G_CHANNELS
; i++) {

7312 ià(
chª
 =ğ
¦si_5ghz_chªÃls_li¡
[
i
]) {

7313 
idx
 = 
i
 + 
MAX_24G_CHANNELS
;

7319  
idx
;

7320 
	}
}

7322 
	$¦si_£t_Ï‹ncy_mode
(
Ãt_deviû
 *
dev
, 
Ï‹ncy_mode
, 
cmd_Ën
)

7324 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7325 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

7326 
»t
 = 0;

7327 
u16
 
ho¡_¡©e
 = 0;

7329 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Ï‹ncy_modğ%d\n", 
Ï‹ncy_mode
);

7331 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

7332 
ho¡_¡©e
 = 
sdev
->
deviû_cÚfig
.host_state;

7335 ià(
Ï‹ncy_mode
)

7336 
ho¡_¡©e
 = ho¡_¡©| 
SLSI_HOSTSTATE_LOW_LATENCY_ACTIVE
;

7338 
ho¡_¡©e
 = ho¡_¡©& ~
SLSI_HOSTSTATE_LOW_LATENCY_ACTIVE
;

7340 
»t
 = 
	`¦si_mlme_£t_ho¡_¡©e
(
sdev
, 
dev
, 
ho¡_¡©e
);

7341 ià(
»t
 != 0)

7342 
	`SLSI_NET_ERR
(
dev
, "E¼Ü iÀ£‰šghHo¡ S‹,„‘=%d", 
»t
);

7344 
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 = host_state;

7346 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

7348  
»t
;

7349 
	}
}

7351 
	$¦si_£t_Ï‹ncy_üt_d©a
(
Ãt_deviû
 *
dev
, 
Ï‹ncy_mode
)

7353 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7354 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

7355 
»t
 = 0;

7356 
u16
 
ho¡_¡©e
 = 0;

7357 
·ssive_time
 = 
sdev
->
max_chªÃl_·ssive_time
;

7358 
home_time
 = 
sdev
->home_time;

7359 
sÿn_chªÃl_time
 = 
sdev
->
max_chªÃl_time
;

7360 
home_away_time
 = 
sdev
->home_away_time;

7361 
sÿn_mode
 = 0;

7363 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "Ï‹ncy_üt_d©¨ğ%d\n", 
Ï‹ncy_mode
);

7365 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

7366 
ho¡_¡©e
 = 
sdev
->
deviû_cÚfig
.host_state;

7369 ià(
Ï‹ncy_mode
 == 0)

7370 
ho¡_¡©e
 &ğ~
SLSI_HOSTSTATE_LOW_LATENCY_ACTIVE
;

7372 
ho¡_¡©e
 |ğ
SLSI_HOSTSTATE_LOW_LATENCY_ACTIVE
;

7374 
»t
 = 
	`¦si_mlme_£t_ho¡_¡©e
(
sdev
, 
dev
, 
ho¡_¡©e
);

7375 ià(
»t
 != 0) {

7376 
	`SLSI_NET_ERR
(
dev
, "E¼Ü iÀ£‰šghHo¡ S‹,„‘=%d\n", 
»t
);

7377 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

7378  
»t
;

7380 
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 = host_state;

7381 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

7382 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

7383 ià(
Ï‹ncy_mode
 != 1) {

7384 ià(
Ï‹ncy_mode
 == 2) {

7385 
sÿn_mode
 = 
FAPI_SCANMODE_LOW_LATENCY_2
;

7386 
·ssive_time
 = 60;

7387 } ià(
Ï‹ncy_mode
 == 3) {

7388 
sÿn_mode
 = 
FAPI_SCANMODE_LOW_LATENCY_3
;

7389 
home_away_time
 = 40;

7390 
home_time
 = 40;

7392 
»t
 = 
	`¦si_mlme_£t_sÿn_mode_»q
(
sdev
, 
dev
, 
sÿn_mode
, 
sÿn_chªÃl_time
,

7393 
home_away_time
, 
home_time
, 
·ssive_time
);

7395 ià(
»t
 != 0)

7396 
	`SLSI_NET_ERR
(
dev
, "E¼Ü iÀ£‰šghSÿÀMode,„‘=%d", 
»t
);

7398 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

7399  
»t
;

7400 
	}
}

7402 #ifdeà
CONFIG_SCSC_WLAN_SAR_SUPPORTED


7403 
	$¦si_cÚfigu»_tx_pow”_§r_sûÇrio
(
Ãt_deviû
 *
dev
, 
mode
)

7405 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7406 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

7407 
u16
 
ho¡_¡©e
 = 0;

7408 
”rÜ
 = 0;

7410 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

7411 
ho¡_¡©e
 = 
sdev
->
deviû_cÚfig
.host_state;

7414 
ho¡_¡©e
 &ğ~(
SLSI_HOSTSTATE_SAR_ACTIVE
 | 
	`BIT
(3) | BIT(4));

7416 ià(
mode
 > 0)

7417 
ho¡_¡©e
 |ğ((
mode
 - 1è<< 3è| 
SLSI_HOSTSTATE_SAR_ACTIVE
;

7419 
”rÜ
 = 
	`¦si_mlme_£t_ho¡_¡©e
(
sdev
, 
dev
, 
ho¡_¡©e
);

7420 ià(!
”rÜ
)

7421 
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 = host_state;

7422 
	`SLSI_INFO_NODEV
("CÚfigu» Tx Pow” sûÇrio: %d\n", 
mode
);

7423 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

7424  
”rÜ
;

7425 
	}
}

7428 
	$¦si_wÏn_»cov”y_š™
(
¦si_dev
 *
sdev
)

7430 
i
;

7431 
Ãtdev_vif
 *
ndev_vif
;

7432 
Ãt_deviû
 *
dev
;

7434 
	`¦si_mlme_£t_couÁry_fÜ_»cov”y
(
sdev
);

7435 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

7436 ià(
sdev
->
Ãtdev
[
i
]) {

7437 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
i
);

7438 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7439 ià(
ndev_vif
->
is_avaabË
) {

7440 
	`Ãtif_tx_¡¬t_®l_queues
(
dev
);

7441 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
)

7442 
	`¦si_¡¬t_­
(
sdev
->
why
, sdev->
Ãtdev
[
i
], &
ndev_vif
->
backup_£‰šgs
);

7446 
	}
}

7448 
	$¦si_subsy¡em_»£t
(
wÜk_¡ruù
 *
wÜk
)

7450 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
wÜk
, ¦si_dev, 
»cov”y_wÜk
);

7451 
”r
 = 0, 
i
;

7452 
Ëv–
;

7453 
Ãtdev_vif
 *
ndev_vif
;

7454 #iâdeà
CONFIG_SCSC_DOWNLOAD_FILE


7455 cÚ¡ 
fœmw¬e
 *
fw
[
SLSI_WLAN_MAX_MIB_FILE
] = { 
NULL
, NULL };

7458 
Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

7459 
	`SLSI_INFO_NODEV
("Inside subsytem_reset\n");

7460 ià(
Ëv–
 < 
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
) {

7461 
”r
 = 
	`¦si_sm_»cov”y_£rviû_¡İ
(
sdev
);

7462 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STOPPED
;

7463 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STOPPED
;

7464 
	`¦si_h_¡İ
(
sdev
);

7465 
Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

7466 ià(
”r
 !ğ0 || 
Ëv–
 =ğ
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
)

7468 
”r
 = 
	`¦si_sm_»cov”y_£rviû_şo£
(
sdev
);

7469 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_CLOSED
;

7470 
Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

7471 ià(
”r
 !ğ0 || 
Ëv–
 =ğ
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
 || 
sdev
->
Ãtdev_up_couÁ
 == 0) {

7472 ià(
sdev
->
Ãtdev_up_couÁ
 == 0)

7473 
sdev
->
mlme_blocked
 = 
çl£
;

7476 
	`SLSI_MUTEX_LOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7477 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STARTING
;

7478 #iâdeà
SLSI_TEST_DEV


7479 
”r
 = 
	`¦si_sm_»cov”y_£rviû_İ’
(
sdev
);

7481 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_OPENED
;

7482 
Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

7483 ià(
”r
 !ğ0 || 
Ëv–
 =ğ
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
) {

7484 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7487 
	`»š™_com¶‘iÚ
(&
sdev
->
sig_wa™
.
com¶‘iÚ
);

7488 #iâdeà
SLSI_TEST_DEV


7489 #iâdeà
CONFIG_SCSC_DOWNLOAD_FILE


7491 ià(
	`¦si_is_rf_‹¡_mode_’abËd
(è|| 
	`¦si_is_‹¡_mode_’abËd
()) {

7492 
sdev
->
mib
[0].
mib_fe_Çme
 = 
mib_fe_t
;

7493 
sdev
->
mib
[1].
mib_fe_Çme
 = 
mib_fe2_t
;

7495 
sdev
->
mib
[0].
mib_fe_Çme
 = 
¦si_mib_fe
;

7496 
sdev
->
mib
[1].
mib_fe_Çme
 = 
¦si_mib_fe2
;

7498 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

7499 
sdev
->
cŞËù_mib
.
num_fes
 = 0;

7502 
i
 = 0; i < 
SLSI_WLAN_MAX_MIB_FILE
; i++) {

7503 
”r
 = 
	`¦si_mib_İ’_fe
(
sdev
, &sdev->
mib
[
i
], &
fw
[i]);

7506 ià(
i
 =ğ0 && 
”r
) {

7507 
	`SLSI_ERR
(
sdev
, "mib: Mªd©Üy wÏÀhcàmissšg. WLAN wÈnÙ s¹ (”r=%d)\n", 
”r
);

7508 
”r_dÚe
;

7511 
”r
 = 
	`¦si_sm_»cov”y_£rviû_¡¬t
(
sdev
);

7512 ià(
”r
) {

7513 
	`SLSI_ERR
(
sdev
, "¦si_sm_wÏn_£rviû_¡¬ˆçed:ƒ¼=%d\n", 
”r
);

7514 
i
 = 0; i < 
SLSI_WLAN_MAX_MIB_FILE
; i++)

7515 
	`¦si_mib_şo£_fe
(
sdev
, 
fw
[
i
]);

7516 
”r_dÚe
;

7519 
i
 = 0; i < 
SLSI_WLAN_MAX_MIB_FILE
; i++)

7520 
	`¦si_mib_şo£_fe
(
sdev
, 
fw
[
i
]);

7523 
”r
 = 
	`¦si_sm_»cov”y_£rviû_¡¬t
(
sdev
);

7524 ià(
”r
) {

7525 
	`SLSI_ERR
(
sdev
, "¦si_sm_wÏn_£rviû_¡¬ˆçed:ƒ¼=%d\n", 
”r
);

7526 
”r_dÚe
;

7528 
	`SLSI_EC_GOTO
(
	`¦si_mib_dowÆßd_fe
(
sdev
, &sdev->
mib
), 
”r
, 
”r_h_¡¬‹d
);

7531 
Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

7532 ià(
Ëv–
 =ğ
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
) {

7533 
	`SLSI_INFO_NODEV
("¦si_sm_»cov”y_£rviû_¡¬ˆçed subsy‹mƒ¼Ü†ev– chªged:%d\n", 
Ëv–
);

7534 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7537 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STARTED
;

7538 
sdev
->
mlme_blocked
 = 
çl£
;

7539 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STARTED
;

7540 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

7541 ià(
sdev
->
Ãtdev
[
i
]) {

7542 
ndev_vif
 = 
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
i
]);

7543 
	`»š™_com¶‘iÚ
(&
ndev_vif
->
sig_wa™
.
com¶‘iÚ
);

7548 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7549 
	`¦si_wÏn_»cov”y_š™
(
sdev
);

7554 #ifdeà
CONFIG_SCSC_DOWNLOAD_FILE


7555 
”r_h_¡¬‹d
:

7556 
	`¦si_sm_»cov”y_£rviû_¡İ
(
sdev
);

7557 
	`¦si_h_¡İ
(
sdev
);

7558 
	`¦si_sm_»cov”y_£rviû_şo£
(
sdev
);

7559 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7562 
”r_dÚe
:

7563 
	`¦si_sm_»cov”y_£rviû_şo£
(
sdev
);

7564 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STOPPED
;

7565 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7567 
	}
}

7569 
	$¦si_Œigg”_£rviû_çu»
(
wÜk_¡ruù
 *
wÜk
)

7571 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
wÜk
, ¦si_dev, 
Œigg”_wÏn_ç_wÜk
);

7572 
»asÚ
[80];

7574 
	`¢´štf
(
»asÚ
, (reason), "Service fail -‚o MLME cfm/ind„eceived");

7575 
	`¦si_sm_£rviû_çed
(
sdev
, 
»asÚ
, 
Œue
);

7576 
	}
}

7578 
	$¦si_çu»_»£t
(
wÜk_¡ruù
 *
wÜk
)

7580 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
wÜk
, ¦si_dev, 
»cov”y_wÜk_Ú_¡İ
);

7581 
Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

7582 
r
 = 0;

7583 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

7585 ià(
sdev
->
cm_if
.
»cov”y_¡©e
 =ğ
SLSI_RECOVERY_SERVICE_STARTED
) {

7586 
r
 = 
	`¦si_sm_»cov”y_£rviû_¡İ
(
sdev
);

7587 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STOPPED
;

7588 
	`¦si_h_¡İ
(
sdev
);

7589 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STOPPED
;

7591 ià(
sdev
->
cm_if
.
»cov”y_¡©e
 =ğ
SLSI_RECOVERY_SERVICE_STOPPED
) {

7592 
r
 = 
	`¦si_sm_»cov”y_£rviû_şo£
(
sdev
);

7593 ià(!
r
) {

7594 
sdev
->
»quœe_£rviû_şo£
 = 
çl£
;

7595 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_CLOSED
;

7596 ià(
Ëv–
 =ğ
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
)

7597 
	`com¶‘e_®l
(&
sdev
->
»cov”y_¡İ_com¶‘iÚ
);

7600 ià(
sdev
->
Ãtdev_up_couÁ
 == 0) {

7601 
sdev
->
mlme_blocked
 = 
çl£
;

7602 ià(
	`wÜk_³ndšg
(&
sdev
->
»cov”y_wÜk_Ú_¡¬t
)) {

7603 
	`SLSI_INFO
(
sdev
, "Cancel work for chip„ecovery!!\n");

7604 
	`ÿnûl_wÜk_sync
(&
sdev
->
»cov”y_wÜk_Ú_¡¬t
);

7607 
	`SLSI_INFO_NODEV
("»cov”y_wÜk_Ú_¡İ com¶‘ed„:%d\n", 
r
);

7608 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s:„ecovery_work_on_stop completed„:%d\n",

7609 
__func__
, 
r
);

7610 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

7611 
	}
}

7613 
	$¦si_ch_»cov”y
(
wÜk_¡ruù
 *
wÜk
)

7615 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
wÜk
, ¦si_dev, 
»cov”y_wÜk_Ú_¡¬t
);

7616 
r
 = 0, 
”r
 = 0, 
i
;

7617 
Ãtdev_vif
 *
ndev_vif
;

7618 #iâdeà
CONFIG_SCSC_DOWNLOAD_FILE


7619 cÚ¡ 
fœmw¬e
 *
fw
[
SLSI_WLAN_MAX_MIB_FILE
] = { 
NULL
, NULL };

7621 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

7623 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

7624 
	`SLSI_MUTEX_LOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7625 ià(
sdev
->
cm_if
.
»cov”y_¡©e
 =ğ
SLSI_RECOVERY_SERVICE_CLOSED
 && sdev->
Ãtdev_up_couÁ
 > 0) {

7626 ià(
sdev
->
»cov”y_¡©us
) {

7627 
r
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sdev
->
»cov”y_com¶‘ed
,

7628 
	`m£cs_to_jiff›s
(
sdev
->
»cov”y_timeout
));

7629 ià(
r
 == 0) {

7630 
	`SLSI_INFO
(
sdev
, "recovery_completedimeout\n");

7631 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s:„ecov”y_com¶‘edimedout\n", 
__func__
);

7632 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

7634 
	`»š™_com¶‘iÚ
(&
sdev
->
»cov”y_com¶‘ed
);

7636 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STARTING
;

7637 
	`»š™_com¶‘iÚ
(&
sdev
->
sig_wa™
.
com¶‘iÚ
);

7638 
	`SLSI_EC_GOTO
(
	`¦si_sm_wÏn_£rviû_İ’
(
sdev
), 
”r
, 
”r_dÚe
);

7639 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_OPENED
;

7640 } ià(
sdev
->
Ãtdev_up_couÁ
 == 0) {

7641 
sdev
->
mlme_blocked
 = 
çl£
;

7642 
”r_dÚe
;

7644 ià(
sdev
->
cm_if
.
»cov”y_¡©e
 =ğ
SLSI_RECOVERY_SERVICE_OPENED
 && sdev->
Ãtdev_up_couÁ
 > 0) {

7645 #iâdeà
SLSI_TEST_DEV


7646 #iâdeà
CONFIG_SCSC_DOWNLOAD_FILE


7648 ià(
	`¦si_is_rf_‹¡_mode_’abËd
(è|| 
	`¦si_is_‹¡_mode_’abËd
()) {

7649 
sdev
->
mib
[0].
mib_fe_Çme
 = 
mib_fe_t
;

7650 
sdev
->
mib
[1].
mib_fe_Çme
 = 
mib_fe2_t
;

7652 
sdev
->
mib
[0].
mib_fe_Çme
 = 
¦si_mib_fe
;

7653 
sdev
->
mib
[1].
mib_fe_Çme
 = 
¦si_mib_fe2
;

7655 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

7656 
sdev
->
cŞËù_mib
.
num_fes
 = 0;

7659 
i
 = 0; i < 
SLSI_WLAN_MAX_MIB_FILE
; i++) {

7660 
”r
 = 
	`¦si_mib_İ’_fe
(
sdev
, &sdev->
mib
[
i
], &
fw
[i]);

7663 ià(
i
 =ğ0 && 
”r
) {

7664 
	`SLSI_ERR
(
sdev
, "mib: Mªd©Üy wÏÀhcàmissšg. WLAN wÈnÙ s¹ (”r=%d)\n", 
”r
);

7665 
	`¦si_sm_»cov”y_£rviû_şo£
(
sdev
);

7666 
”r_dÚe
;

7669 
”r
 = 
	`¦si_sm_»cov”y_£rviû_¡¬t
(
sdev
);

7670 ià(
”r
) {

7671 
	`SLSI_ERR
(
sdev
, "¦si_sm_wÏn_£rviû_¡¬ˆçed:ƒ¼=%d\n", 
”r
);

7672 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s: slsi_sm_wlan_service_start failed:ƒrr=%d\n",

7673 
__func__
, 
”r
);

7674 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

7676 
i
 = 0; i < 
SLSI_WLAN_MAX_MIB_FILE
; i++)

7677 
	`¦si_mib_şo£_fe
(
sdev
, 
fw
[
i
]);

7678 
	`¦si_sm_»cov”y_£rviû_şo£
(
sdev
);

7679 
”r_dÚe
;

7682 
i
 = 0; i < 
SLSI_WLAN_MAX_MIB_FILE
; i++)

7683 
	`¦si_mib_şo£_fe
(
sdev
, 
fw
[
i
]);

7686 
”r
 = 
	`¦si_sm_»cov”y_£rviû_¡¬t
(
sdev
);

7687 ià(
”r
) {

7688 
	`SLSI_ERR
(
sdev
, "¦si_sm_wÏn_£rviû_¡¬ˆçed:ƒ¼=%d\n", 
”r
);

7689 
	`¦si_sm_»cov”y_£rviû_şo£
(
sdev
);

7690 
”r_dÚe
;

7692 
	`SLSI_EC_GOTO
(
	`¦si_mib_dowÆßd_fe
(
sdev
, &sdev->
mib
), 
”r
, 
”r_h_¡¬‹d
);

7695 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STARTED
;

7698 
sdev
->
mlme_blocked
 = 
çl£
;

7699 
sdev
->
cm_if
.
»cov”y_¡©e
 = 
SLSI_RECOVERY_SERVICE_STARTED
;

7701 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "%s: mlme_blocked[0],„ecov”y_¡©e[0]\n", 
__func__
);

7702 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

7704 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

7705 ià(
sdev
->
Ãtdev
[
i
]) {

7706 
ndev_vif
 = 
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
i
]);

7707 
	`»š™_com¶‘iÚ
(&
ndev_vif
->
sig_wa™
.
com¶‘iÚ
);

7710 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7711 
	`¦si_wÏn_»cov”y_š™
(
sdev
);

7712 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

7715 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7716 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

7719 #ifdeà
CONFIG_SCSC_DOWNLOAD_FILE


7720 
”r_h_¡¬‹d
:

7721 
	`¦si_sm_»cov”y_£rviû_¡İ
(
sdev
);

7722 
	`¦si_h_¡İ
(
sdev
);

7723 
	`¦si_sm_»cov”y_£rviû_şo£
(
sdev
);

7724 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

7725 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7728 
”r_dÚe
:

7729 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STOPPED
;

7730 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7731 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

7732 
	}
}

7734 
	$¦si_sy¡em_”rÜ_»cov”y
(
wÜk_¡ruù
 *
wÜk
)

7736 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
wÜk
, ¦si_dev, 
sy¡em_”rÜ_u£r_ç_wÜk
);

7737 
Ãt_deviû
 *
dev
 = 
NULL
;

7738 
r
 = 0;

7739 
”r
 = 0;

7741 ià(
sdev
->
»cov”y_¡©us
) {

7742 
r
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sdev
->
»cov”y_com¶‘ed
,

7743 
	`m£cs_to_jiff›s
(
sdev
->
»cov”y_timeout
));

7744 ià(
r
 == 0)

7745 
	`SLSI_INFO
(
sdev
, "recovery_completedimeout\n");

7747 
sdev
->
mlme_blocked
 = 
çl£
;

7749 
	`»š™_com¶‘iÚ
(&
sdev
->
»cov”y_com¶‘ed
);

7751 
sdev
->
mlme_blocked
 = 
çl£
;

7754 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl_š™
);

7755 
	`SLSI_INFO
(
sdev
, "Calling slsi_start\n");

7756 
”r
 = 
	`¦si_¡¬t
(
sdev
, 
dev
);

7757 ià(
”r
)

7758 
	`SLSI_INFO
(
sdev
, "¦si_¡¬ˆçed,ƒ¼ = %d\n", 
”r
);

7760 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl_š™
);

7761 
sdev
->
»cov”y_ç_§ã
 = 
çl£
;

7762 
	`com¶‘e_®l
(&
sdev
->
»cov”y_ç_§ã_com¶‘e
);

7763 
	}
}

7765 #ià
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

7767 
	#MAX_LOG_SIZE
 500*1024

	)

7769 
	$¦si_cŞËù_ch£t_logs
(
wÜk_¡ruù
 *
wÜk
)

7771 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
wÜk
, ¦si_dev, 
ch£t_loggšg_wÜk
);

7772 
scsc_£rviû
 *
£rviû
;

7773 *
bufãr
 = 
NULL
;

7774 
size_t
 
size
;

7775 
size_t
 
by‹s
 = 0;

7776 
»t
 = 0;

7777 
bud_id_fw
[128];

7778 
bud_id_drv
[64];

7779 
size_t
 
tÙ®_h—d”
;

7781 
tÙ®_h—d”
 = (
bud_id_fw
è+ (
bud_id_drv
);

7783 ià(!
sdev
 || !sdev->
£rviû
) {

7784 
	`SLSI_ERR
(
sdev
, "sdev/service is NULL\n");

7785 
dump_š_´og»ss
 = 0;

7789 
£rviû
 = 
sdev
->service;

7791 
size
 = 
	`scsc_£rviû_mxlogg”_buff_size
(
£rviû
, 
SCSC_LOG_CHUNK_UDI
);

7793 ià(
size
 < 
tÙ®_h—d”
) {

7794 
	`SLSI_INFO
(
sdev
, "NÙƒnough s·û, siz%zu h—d” %zu\n", 
size
, 
tÙ®_h—d”
);

7798 ià(
size
 > 
MAX_LOG_SIZE
)

7799 
size
 = 
MAX_LOG_SIZE
;

7801 
	`SLSI_INFO
(
sdev
, "SCSC_LOG_CHUNK_UDI chunk siz%zu\n", 
size
);

7803 
	`SLSI_MUTEX_LOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7804 ià(
sdev
->
deviû_¡©e
 !ğ
SLSI_DEVICE_STATE_STARTED
) {

7805 
	`SLSI_INFO
(
sdev
, "Skip chipset_log in off state\n");

7806 
dÚe
;

7809 
bufãr
 = 
	`vm®loc
(
size
);

7810 ià(!
bufãr
) {

7811 
	`SLSI_ERR
(
sdev
, "Memory‡llocation failed\n");

7812 
dÚe
;

7815 
	`mxmª_g‘_fw_v”siÚ
(
bud_id_fw
, (build_id_fw));

7816 
	`memıy
(
bufãr
, 
bud_id_fw
, (build_id_fw));

7817 
	`mxmª_g‘_driv”_v”siÚ
(
bud_id_drv
, (build_id_drv));

7818 
	`memıy
(
bufãr
 + (
bud_id_fw
), 
bud_id_drv
, (build_id_drv));

7820 
by‹s
 = 
	`scsc_£rviû_cŞËù_bufãr
(
£rviû
, 
SCSC_LOG_CHUNK_UDI
,

7821 
bufãr
 + 
tÙ®_h—d”
, 
size
 -otal_header);

7822 
	`SLSI_INFO
(
sdev
, "SCSC_LOG_CHUNK_UDI by‹ cŞËùed %zu\n", 
by‹s
);

7824 ià(
by‹s
) {

7825 #ifdeà
CONFIG_SCSC_WLBTD


7827 
»t
 = 
	`scsc_wÏn_mm­_£t_bufãr
(
bufãr
, 
by‹s
 + 
tÙ®_h—d”
);

7828 ià(
»t
) {

7829 
	`SLSI_ERR
(
sdev
, "scsc_wÏn_mm­_£t_bufã¸”¸ğ%d\n", 
»t
);

7830 
dÚe
;

7833 
»t
 = 
	`wlbtd_ch£t_loggšg
(
bufãr
, 
by‹s
 + 
tÙ®_h—d”
, 
Œue
);

7834 ià(
»t
)

7835 
	`SLSI_ERR
(
sdev
, "wlbtd ch£ˆloggšg faedƒ¼ = %d\n", 
»t
);

7837 
	`scsc_wÏn_mm­_£t_bufãr
(
NULL
, 0);

7839 
	`SLSI_INFO
(
sdev
, "wlbtd support is‚otƒnabled\n");

7842 
	`SLSI_ERR
(
sdev
, "byte writteno buffer is NULL\n");

7844 
dÚe
:

7845 
dump_š_´og»ss
 = 0;

7846 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
¡¬t_¡İ_mu‹x
);

7847 
	`vä“
(
bufãr
);

7848 
	}
}

7851 #ifdeà
CONFIG_SCSC_WLAN_DYNAMIC_ITO


7852 
	$¦si_£t_™o
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

7854 
»t
 = 0;

7855 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7856 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

7857 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

7858 
™o
;

7860 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

7861 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

7863 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
™o
)) {

7864 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

7865 
	`kä“
(
ioùl_¬gs
);

7866  -
EINVAL
;

7869 ià(!(
™o
 >= 100)) {

7870 
	`SLSI_ERR
(
sdev
, "Inv®id ITO v®ue: %u\n", 
™o
);

7871 
	`kä“
(
ioùl_¬gs
);

7872  -
EINVAL
;

7874 
»t
 = 
	`¦si_£t_ušt_mib
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_FAST_POWER_SAVE_TIMEOUT
, 
™o
);

7875 
	`kä“
(
ioùl_¬gs
);

7876  
»t
;

7877 
	}
}

7891 
	#SLSI_PSID_UNIFI_DYNAMIC_ITO_ENABLE
 0x087F

	)

7892 
	$¦si_’abË_™o
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
)

7894 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

7895 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

7896 
¦si_ioùl_¬gs
 *
ioùl_¬gs
 = 
NULL
;

7897 
™o_v®ue
 = 0;

7899 
ioùl_¬gs
 = 
	`¦si_g‘_´iv©e_commªd_¬gs
(
commªd
, 
buf_Ën
, 1);

7900 
	`SLSI_VERIFY_IOCTL_ARGS
(
sdev
, 
ioùl_¬gs
);

7902 ià(!
	`¦si_¡r_to_št
(
ioùl_¬gs
->
¬gs
[0], &
™o_v®ue
)) {

7903 
	`SLSI_ERR
(
sdev
, "Inv®id sŒšg: '%s'\n", 
ioùl_¬gs
->
¬gs
[0]);

7904 
	`kä“
(
ioùl_¬gs
);

7905  -
EINVAL
;

7908 ià(
™o_v®ue
 != 0 && ito_value != 1) {

7909 
	`SLSI_ERR
(
sdev
, "Inv®id ITO modv®ue: '%d'\n", 
™o_v®ue
);

7910 
	`kä“
(
ioùl_¬gs
);

7911  -
EINVAL
;

7913 
	`kä“
(
ioùl_¬gs
);

7914  
	`¦si_£t_ušt_mib
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_DYNAMIC_ITO_ENABLE
, 
™o_v®ue
);

7915 
	}
}

7919 
	$¦si_sÜt_¬¿y
(
u8
 
¬r
[], 
n
)

7921 
i
, 
j
;

7922 
u8
 
‹mp
;

7923 
boŞ
 
sw­³d
;

7925 
i
 = 0; i < 
n
 - 1; i++) {

7926 
sw­³d
 = 
çl£
;

7927 
j
 = 0; j < 
n
 - 
i
 - 1; j++) {

7928 ià(
¬r
[
j
] >‡rr[j + 1]) {

7929 
‹mp
 = 
¬r
[
j
];

7930 
¬r
[
j
] =‡rr[j + 1];

7931 
¬r
[
j
 + 1] = 
‹mp
;

7932 
sw­³d
 = 
Œue
;

7936 ià(
sw­³d
 =ğ
çl£
)

7939 
	}
}

7942 
	$¦si_»move_du¶iÿ‹s
(
u8
 
¬r
[], 
n
)

7944 
j
 = 0, 
i
 = 0;

7946 ià(
n
 == 0 ||‚ == 1)

7947  
n
;

7949 
i
 = 0; i < 
n
 - 1; i++)

7950 ià(
¬r
[
i
] !=‡rr[i + 1])

7951 
¬r
[
j
++] =‡¼[
i
];

7953 
¬r
[
j
++] =‡¼[
n
 - 1];

7954  
j
;

7955 
	}
}

7958 
	$¦si_m”ge_li¡s
(
u8
 
¬1
[], 
Ën1
, u8 
¬2
[], 
Ën2
, u8 
»suÉ
[])

7960 
k
 = 0, 
i
 = 0, 
Ãw_Ën
 = 0;

7962 
i
 = 0; i < 
Ën1
; i++)

7963 
»suÉ
[
k
++] = 
¬1
[
i
];

7965 
i
 = 0; i < 
Ën2
; i++)

7966 
»suÉ
[
k
++] = 
¬2
[
i
];

7968 
	`¦si_sÜt_¬¿y
(
»suÉ
, 
k
);

7969 
Ãw_Ën
 = 
	`¦si_»move_du¶iÿ‹s
(
»suÉ
, 
k
);

7970 ià(
Ãw_Ën
 > 
SLSI_ROAMING_CHANNELS_MAX
)

7971 
Ãw_Ën
 = 
SLSI_ROAMING_CHANNELS_MAX
;

7973  
Ãw_Ën
;

7974 
	}
}

7976 
	$¦si_rx_upd©e_wake_¡©s
(
¦si_dev
 *
sdev
, 
‘hhdr
 *
ehdr
, 
buff_Ën
)

7978 
¦si_wÏn_driv”_wake_»asÚ_út
 *
wake_»asÚ_couÁ
 = &
sdev
->
wake_»asÚ_¡©s
;

7980 
	`¦si_¥šlock_lock
(&
sdev
->
wake_¡©s_lock
);

7981 
wake_»asÚ_couÁ
->
tÙ®_rx_d©a_wake
++;

7982 ià(
buff_Ën
 < (
‘hhdr
))

7983 
ex™
;

7984 ià(
	`is_brßdÿ¡_‘h”_addr
(
ehdr
->
h_de¡
)) {

7985 
wake_»asÚ_couÁ
->
rx_wake_d‘as
.
rx_brßdÿ¡_út
++;

7986 
	`SLSI_DBG3
(
sdev
, 
SLSI_RX
, "Wakeu°by brßdÿ¡„x d©¨·ck‘:%d\n", 
wake_»asÚ_couÁ
->
rx_wake_d‘as
.
rx_brßdÿ¡_út
);

7987 } ià(
	`is_muÉiÿ¡_‘h”_addr
(
ehdr
->
h_de¡
)) {

7988 
wake_»asÚ_couÁ
->
rx_wake_d‘as
.
rx_muÉiÿ¡_út
++;

7989 
	`SLSI_DBG3
(
sdev
, 
SLSI_RX
, "Wakeu°by muÉiÿ¡„x d©¨·ck‘:%d\n", 
wake_»asÚ_couÁ
->
rx_wake_d‘as
.
rx_muÉiÿ¡_út
);

7990 ià(
	`be16_to_ıu
(
ehdr
->
h_´Ùo
è=ğ
ETH_P_IP
)

7991 
wake_»asÚ_couÁ
->
rx_muÉiÿ¡_wake_pkt_šfo
.
v4_rx_muÉiÿ¡_addr_út
++;

7992 ià(
	`be16_to_ıu
(
ehdr
->
h_´Ùo
è=ğ
ETH_P_IPV6
)

7993 
wake_»asÚ_couÁ
->
rx_muÉiÿ¡_wake_pkt_šfo
.
v6_rx_muÉiÿ¡_addr_út
++;

7995 
wake_»asÚ_couÁ
->
rx_muÉiÿ¡_wake_pkt_šfo
.
Ùh”_rx_muÉiÿ¡_addr_út
++;

7997 
wake_»asÚ_couÁ
->
rx_wake_d‘as
.
rx_uniÿ¡_út
++;

7999 ià(
	`be16_to_ıu
(
ehdr
->
h_´Ùo
è=ğ
ETH_P_IP
 && 
buff_Ën
 - (
‘hhdr
è>ğ(
hdr
)) {

8000 
hdr
 *

 = (hd¸*)(
ehdr
 + 1);

8002 
	`SLSI_DBG3
(
sdev
, 
SLSI_RX
, "Wakeu°by i°rx d©¨·ck‘…rÙocŞ :%d\n", 

->
´ÙocŞ
);

8003 ià(

->
´ÙocŞ
 =ğ
IPPROTO_ICMP
)

8004 
wake_»asÚ_couÁ
->
rx_wake_pkt_şassifiÿtiÚ_šfo
.
icmp_pkt
++;

8005 } ià(
	`be16_to_ıu
(
ehdr
->
h_´Ùo
è=ğ
ETH_P_IPV6
 && 
buff_Ën
 - (
‘hhdr
è>ğ(
v6hdr
)) {

8006 
v6hdr
 *

 = (v6hd¸*)(
ehdr
 + 1);

8008 
	`SLSI_DBG3
(
sdev
, 
SLSI_RX
, "Wakeu°by ipv6„x d©¨·ck‘‚exˆhdr:%d\n", 

->
Ãxthdr
);

8009 ià(

->
Ãxthdr
 =ğ
SLSI_ICMP6_PACKET
) {

8010 
icmp6hdr
 *
icmp6
 = (icmp6hd¸*)(

 + 1);

8012 
	`SLSI_DBG3
(
sdev
, 
SLSI_RX
, "Wakeu°by icmpv6„x d©¨·ck‘y³:%d\n", 
icmp6
->
icmp6_ty³
);

8013 
wake_»asÚ_couÁ
->
rx_wake_pkt_şassifiÿtiÚ_šfo
.
icmp6_pkt
++;

8014 ià(
buff_Ën
 - (
‘hhdr
è- (
v6hdr
è< (
icmp6hdr
))

8015 
ex™
;

8016 ià(
icmp6
->
icmp6_ty³
 =ğ
SLSI_ICMP6_PACKET_TYPE_RA
)

8017 
wake_»asÚ_couÁ
->
rx_wake_pkt_şassifiÿtiÚ_šfo
.
icmp6_¿
++;

8018 ià(
icmp6
->
icmp6_ty³
 =ğ
SLSI_ICMP6_PACKET_TYPE_NS
)

8019 
wake_»asÚ_couÁ
->
rx_wake_pkt_şassifiÿtiÚ_šfo
.
icmp6_ns
++;

8020 ià(
icmp6
->
icmp6_ty³
 =ğ
SLSI_ICMP6_PACKET_TYPE_NA
)

8021 
wake_»asÚ_couÁ
->
rx_wake_pkt_şassifiÿtiÚ_šfo
.
icmp6_Ç
++;

8024 
ex™
:

8025 
	`¦si_¥šlock_uÆock
(&
sdev
->
wake_¡©s_lock
);

8026 
	}
}

8028 
u8
 *
	$¦si_g‘_sÿn_exŒa_›s
(
¦si_dev
 *
sdev
, cÚ¡ 
u8
 *
›s
, 
tÙ®_Ën
, *
exŒa_Ën
)

8030 
u8
 *
deçuÉ_›s
 = 
sdev
->
deçuÉ_sÿn_›s
;

8031 
deçuÉ_›_Ën
 = 
sdev
->
deçuÉ_sÿn_›s_Ën
;

8032 
i
 = 0;

8033 
u8
 
id
, 
›_Ën
;

8034 
u8
 *
Ãw_›s
 = 
NULL
;

8035 
cur_Ën
 = 0;

8037 *
exŒa_Ën
 = 0;

8038 ià(
deçuÉ_›_Ën
 <ğ0 || !
deçuÉ_›s
)

8039  
NULL
;

8041 
Ãw_›s
 = 
	`km®loc
(
deçuÉ_›_Ën
, 
GFP_KERNEL
);

8042 ià(!
Ãw_›s
) {

8043 
	`SLSI_ERR
(
sdev
, "Memory‡lloc failed\n");

8044  
NULL
;

8046 
i
 < 
deçuÉ_›_Ën
 - 2) {

8047 
id
 = *(
deçuÉ_›s
 + 
i
);

8048 
›_Ën
 = *(
deçuÉ_›s
 + 
i
 + 1);

8049 ià(!
	`cfg80211_fšd_›
(
id
, 
›s
, 
tÙ®_Ën
)) {

8050 
	`memıy
(
Ãw_›s
 + 
cur_Ën
, 
deçuÉ_›s
 + 
i
, 
›_Ën
 + 2);

8051 
cur_Ën
 +ğ(
›_Ën
 + 2);

8053 
i
 +ğ(
›_Ën
 + 2);

8055 *
exŒa_Ën
 = 
cur_Ën
;

8056 ià(*
exŒa_Ën
 == 0) {

8057 
	`kä“
(
Ãw_›s
);

8058  
NULL
;

8060  
Ãw_›s
;

8061 
	}
}

8063 
	$¦si_add_´obe_›s_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

8065 
u8
 *
deçuÉ_›s
, *
add_šfo_›s
;

8066 
deçuÉ_›_Ën
 = 0;

8067 
add_šfo_›_Ën
 = 0;

8068 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

8069 
r
 = 0;

8071 
deçuÉ_›s
 = 
NULL
;

8072 
add_šfo_›s
 = 
NULL
;

8073 ià(
sdev
->
deçuÉ_sÿn_›s_Ën
 > 0)

8074 
deçuÉ_›s
 = 
	`¦si_g‘_sÿn_exŒa_›s
(
sdev
, 
ndev_vif
->
´obe_»q_›s
,‚dev_vif->
´obe_»q_›_Ën
, &
deçuÉ_›_Ën
);

8076 
add_šfo_›_Ën
 = 
deçuÉ_›_Ën
 + 
ndev_vif
->
´obe_»q_›_Ën
;

8078 ià(
add_šfo_›_Ën
 > 0) {

8079 
add_šfo_›s
 = 
	`km®loc
(
add_šfo_›_Ën
, 
GFP_KERNEL
);

8080 ià(!
add_šfo_›s
) {

8081 
	`SLSI_ERR
(
sdev
, "Memory‡lloc failed\n");

8082 
	`kä“
(
deçuÉ_›s
);

8083  -
ENOMEM
;

8085 
	`memıy
(
add_šfo_›s
, 
ndev_vif
->
´obe_»q_›s
,‚dev_vif->
´obe_»q_›_Ën
);

8086 
	`memıy
(
add_šfo_›s
 + 
ndev_vif
->
´obe_»q_›_Ën
, 
deçuÉ_›s
, 
deçuÉ_›_Ën
);

8087 
r
 = 
	`¦si_mlme_add_šfo_–em’ts
(
sdev
, 
dev
, 
FAPI_PURPOSE_PROBE_REQUEST
, 
add_šfo_›s
,

8088 
add_šfo_›_Ën
);

8090 
	`kä“
(
deçuÉ_›s
);

8091 
	`kä“
(
add_šfo_›s
);

8093  
r
;

8094 
	}
}

8097 
boŞ
 
	$¦si_is_rf_‹¡_mode_’abËd
()

8099  
EÇbËRfTe¡Mode
;

8100 
	}
}

8103 
ssize_t
 
	$sysfs_show_pm
(
kobjeù
 *
kobj
,

8104 
kobj_©Œibu‹
 *
©Œ
,

8105 *
buf
)

8107  
	`¥rštf
(
buf
, "%d\n", !
EÇbËRfTe¡Mode
);

8108 
	}
}

8111 
ssize_t
 
	$sysfs_¡Üe_pm
(
kobjeù
 *
kobj
,

8112 
kobj_©Œibu‹
 *
©Œ
,

8113 cÚ¡ *
buf
,

8114 
size_t
 
couÁ
)

8116 
r
;

8117 
sysfs_pm
;

8119 
r
 = 
	`k¡¹ošt
(
buf
, 10, &
sysfs_pm
);

8120 ià(
r
 =ğ0 && (
sysfs_pm
 == 0 || sysfs_pm == 1))

8121 
EÇbËRfTe¡Mode
 = (!(
boŞ
)
sysfs_pm
);

8123 
	`´_”r
("Invalid…m value. Must be 0 or 1\n");

8125 
	`SLSI_INFO_NODEV
("pm: %d\n", !
EÇbËRfTe¡Mode
);

8127  (
r
 =ğ0è? 
couÁ
 : 0;

8128 
	}
}

8131 
	$¦si_ü—‹_sysfs_pm
()

8133 
r
;

8135 
wifi_kobj_»f
 = 
	`mxmª_wifi_kobjeù_»f_g‘
();

8136 
	`´_šfo
("wifi_kobj_»f: 0x%p\n", 
wifi_kobj_»f
);

8138 ià(
wifi_kobj_»f
) {

8140 
r
 = 
	`sysfs_ü—‹_fe
(
wifi_kobj_»f
, &
pm_©Œ
.
©Œ
);

8141 ià(
r
) {

8143 
	`´_”r
("Can't create /sys/wifi/pm\n");

8147 
	`´_”r
("failedo create /sys/wifi/pm\n");

8149 
	}
}

8152 
	$¦si_de¡roy_sysfs_pm
()

8154 ià(!
wifi_kobj_»f
)

8158 
	`sysfs_»move_fe
(
wifi_kobj_»f
, &
pm_©Œ
.
©Œ
);

8161 
	`mxmª_wifi_kobjeù_»f_put
();

8162 
	}
}

8165 
ssize_t
 
	$sysfs_show_ªt
(
kobjeù
 *
kobj
,

8166 
kobj_©Œibu‹
 *
©Œ
,

8167 *
buf
)

8169  
	`¥rštf
(
buf
, "%d\n", 
sysfs_ª‹Âa
);

8170 
	}
}

8173 
ssize_t
 
	$sysfs_¡Üe_ªt
(
kobjeù
 *
kobj
,

8174 
kobj_©Œibu‹
 *
©Œ
,

8175 cÚ¡ *
buf
,

8176 
size_t
 
couÁ
)

8178 
r
;

8179 
ª‹Âa
;

8181 
r
 = 
	`k¡¹ošt
(
buf
, 10, &
ª‹Âa
);

8182 ià(
r
 < 0 || 
ª‹Âa
 < 0 ||‡ntenna > 3)

8183 
	`´_”r
("Invalid‡nt value. Min:0 Max:3\n");

8185 
sysfs_ª‹Âa
 = (
u16
)
ª‹Âa
;

8187 
	`SLSI_INFO_NODEV
("ª‹Âa: %d\n", 
sysfs_ª‹Âa
);

8189  (
r
 =ğ0è? 
couÁ
 : 0;

8190 
	}
}

8193 
	$¦si_ü—‹_sysfs_ªt
()

8195 
r
;

8197 
wifi_kobj_»f
 = 
	`mxmª_wifi_kobjeù_»f_g‘
();

8198 
	`´_šfo
("wifi_kobj_»f: 0x%p\n", 
wifi_kobj_»f
);

8200 ià(
wifi_kobj_»f
) {

8202 
r
 = 
	`sysfs_ü—‹_fe
(
wifi_kobj_»f
, &
ªt_©Œ
.
©Œ
);

8203 ià(
r
) {

8205 
	`´_”r
("Can't create /sys/wifi/ant\n");

8209 
	`´_”r
("failedo create /sys/wifi/ant\n");

8211 
	}
}

8214 
	$¦si_de¡roy_sysfs_ªt
()

8216 ià(!
wifi_kobj_»f
)

8220 
	`sysfs_»move_fe
(
wifi_kobj_»f
, &
ªt_©Œ
.
©Œ
);

8223 
	`mxmª_wifi_kobjeù_»f_put
();

8224 
	}
}

	@mgt.h

7 #iâdeà
__SLSI_MGT_H__


8 
	#__SLSI_MGT_H__


	)

10 
	~<lšux/mu‹x.h
>

12 
	~"dev.h
"

13 
	~"»g_šfo.h
"

14 
	~"debug.h
"

17 #iâdeà
WLAN_OUI_MICROSOFT


18 
	#WLAN_OUI_MICROSOFT
 0x0050f2

	)

19 
	#WLAN_OUI_TYPE_MICROSOFT_WPA
 1

	)

20 
	#WLAN_OUI_TYPE_MICROSOFT_WMM
 2

	)

21 
	#WLAN_OUI_TYPE_MICROSOFT_WPS
 4

	)

24 
	#WLAN_OUI_SAMSUNG
 0x0000f0

	)

25 
	#WLAN_OUI_TYPE_SAMSUNG_KEO
 0x22

	)

27 
	#SLSI_COUNTRY_CODE_LEN
 3

	)

29 
	#SLSI_EAPOL_TYPE_RSN_KEY
 (2)

	)

30 
	#SLSI_EAPOL_TYPE_WPA_KEY
 (254)

	)

32 
	#SLSI_IEEE8021X_TYPE_EAPOL_KEY
 3

	)

33 
	#SLSI_IEEE8021X_TYPE_EAP_PACKET
 0

	)

35 
	#SLSI_EAPOL_KEY_INFO_KEY_TYPE_BIT_IN_LOWER_BYTE
 
	`BIT
(3è

	)

36 
	#SLSI_EAPOL_KEY_INFO_ACK_BIT_IN_LOWER_BYTE
 
	`BIT
(7)

	)

37 
	#SLSI_EAPOL_KEY_INFO_MIC_BIT_IN_HIGHER_BYTE
 
	`BIT
(0)

	)

38 
	#SLSI_EAPOL_KEY_INFO_SECURE_BIT_IN_HIGHER_BYTE
 
	`BIT
(1)

	)

46 
	#SLSI_EAPOL_IEEE8021X_TYPE_POS
 (1)

	)

47 
	#SLSI_EAPOL_TYPE_POS
 (4)

	)

48 
	#SLSI_EAPOL_KEY_INFO_HIGHER_BYTE_POS
 (5)

	)

49 
	#SLSI_EAPOL_KEY_INFO_LOWER_BYTE_POS
 (6)

	)

50 
	#SLSI_EAPOL_KEY_DATA_LENGTH_HIGHER_BYTE_POS
 (97)

	)

51 
	#SLSI_EAPOL_KEY_DATA_LENGTH_LOWER_BYTE_POS
 (98)

	)

53 
	#SLSI_EAP_CODE_POS
 (4)

	)

54 
	#SLSI_EAP_PACKET_REQUEST
 (1)

	)

55 
	#SLSI_EAP_PACKET_RESPONSE
 (2)

	)

56 
	#SLSI_EAP_PACKET_SUCCESS
 (3)

	)

57 
	#SLSI_EAP_PACKET_FAILURE
 (4)

	)

58 
	#SLSI_EAP_TYPE_POS
 (8)

	)

59 
	#SLSI_EAP_TYPE_EXPANDED
 (254)

	)

60 
	#SLSI_EAP_OPCODE_POS
 (16)

	)

61 
	#SLSI_EAP_OPCODE_WSC_MSG
 (4)

	)

62 
	#SLSI_EAP_OPCODE_WSC_START
 (1)

	)

63 
	#SLSI_EAP_MSGTYPE_POS
 (27)

	)

64 
	#SLSI_EAP_MSGTYPE_M8
 (12)

	)

65 
	#SLSI_EAP_WPS_DWELL_TIME
 (100000è

	)

66 
	#SLSI_EAP_TYPE_IDENTITY
 (1)

	)

68 
	#SLSI_80211_AC_VO
 0

	)

69 
	#SLSI_80211_AC_VI
 1

	)

70 
	#SLSI_80211_AC_BE
 2

	)

71 
	#SLSI_80211_AC_BK
 3

	)

74 #ifdeà
CONFIG_SCSC_WLAN_DUAL_STATION


75 
	#SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
è((Òdev_vif)->
iâum
 =ğ
SLSI_NET_INDEX_WLAN
) ||\

76 (((
ndev_vif
)->
iâum
 =ğ
SLSI_NET_INDEX_P2PX_SWLAN
è&& (Òdev_vif)->
iáy³
 =ğ
NL80211_IFTYPE_STATION
)))

	)

78 
	#SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
èÒdev_vif->
iâum
 =ğ
SLSI_NET_INDEX_WLAN
)

	)

80 
	#SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
èÒdev_vif->
iâum
 =ğ
SLSI_NET_INDEX_P2P
)

	)

81 #ià
defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

82 
	#SLSI_IS_VIF_INDEX_P2P_GROUP
(
sdev
, 
ndev_vif
è(Òdev_vif->
iâum
 =ğ
SLSI_NET_INDEX_P2PX_SWLAN
) &&\

83 (
sdev
->
Ãtdev_­
 !ğsdev->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
]))

	)

84 
	#SLSI_IS_VIF_INDEX_MHS_DUALSTA
(
sdev
, 
ndev_vif
è(Òdev_vif->
iâum
 =ğ
SLSI_NET_INDEX_P2PX_SWLAN
) &&\

85 (
sdev
->
Ãtdev_­
 =ğsdev->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
]))

	)

87 
	#SLSI_IS_VIF_INDEX_P2P_GROUP
(
sdev
, 
ndev_vif
èÒdev_vif->
iâum
 =ğ
SLSI_NET_INDEX_P2PX_SWLAN
)

	)

89 #ià
defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
)

90 
	#SLSI_IS_VIF_INDEX_MHS
(
sdev
, 
ndev_vif
è(Òdev_vif->
iâum
 =ğ
SLSI_NET_INDEX_P2PX_SWLAN
) &&\

91 (
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_AP
) &&\

92 (
sdev
->
Ãtdev_­
 =ğsdev->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
]))

	)

94 
	#SLSI_IS_VIF_INDEX_NAN
(
ndev_vif
è(Òdev_vif)->
iâum
 =ğ
SLSI_NET_INDEX_NAN
)

	)

97 
	#SLSI_IS_P2P_UNSYNC_VIF
(
ndev_vif
è(Òdev_vif->
iâum
 =ğ
SLSI_NET_INDEX_P2P
è&& (ndev_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_UNSYNCHRONISED
))

	)

100 
	#SLSI_IS_HS2_UNSYNC_VIF
(
ndev_vif
è(Òdev_vif->
iâum
 =ğ
SLSI_NET_INDEX_WLAN
è&& (ndev_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_UNSYNCHRONISED
))

	)

103 
	#SLSI_IS_P2P_GROUP_STATE
(
sdev
è((sdev->
p2p_¡©e
 =ğ
P2P_GROUP_FORMED_GO
è|| (sdev->p2p_¡©=ğ
P2P_GROUP_FORMED_CLI
))

	)

106 
	#SLSI_STA_ROAM_REPORT_EXTRA_DELAY_MSEC
 50

	)

109 
	#SLSI_P2P_ROC_EXTRA_MSEC
 10

	)

112 
	#SLSI_P2P_UNSYNC_VIF_EXTRA_MSEC
 2000

	)

114 
	#SLSI_HS2_UNSYNC_VIF_EXTRA_MSEC
 1000

	)

119 
	#SLSI_P2P_NEG_PROC_UNSYNC_VIF_RETAIN_DURATION
 3000

	)

124 
	#SLSI_P2P_UNSET_CHANNEL_EXTRA_MSEC
 600

	)

125 
	#SLSI_P2P_DELAY_UNSET_CHANNEL_AFTER_P2P_PROCEDURE
 30

	)

127 
	#SLSI_P2P_MGMT_TX_EXTRA_MSEC
 100

	)

129 
	#SLSI_FORCE_SCHD_ACT_FRAME_MSEC
 100

	)

130 
	#SLSI_P2PGO_KEEP_ALIVE_PERIOD_SEC
 10

	)

131 
	#SLSI_P2PGC_CONN_TIMEOUT_MSEC
 10000

	)

134 
	#SLSI_FW_MAX_OFFCHANNEL_DWELL_TIME
 100

	)

137 
	#SLSI_P2P_PA_GO_NEG_REQ
 0

	)

138 
	#SLSI_P2P_PA_GO_NEG_RSP
 1

	)

139 
	#SLSI_P2P_PA_GO_NEG_CFM
 2

	)

140 
	#SLSI_P2P_PA_INV_REQ
 3

	)

141 
	#SLSI_P2P_PA_INV_RSP
 4

	)

142 
	#SLSI_P2P_PA_DEV_DISC_REQ
 5

	)

143 
	#SLSI_P2P_PA_DEV_DISC_RSP
 6

	)

144 
	#SLSI_P2P_PA_PROV_DISC_REQ
 7

	)

145 
	#SLSI_P2P_PA_PROV_DISC_RSP
 8

	)

147 
	#SLSI_PA_INVALID
 0xFF

	)

150 
	#SLSI_PA_GAS_INITIAL_REQ
 (10)

	)

151 
	#SLSI_PA_GAS_INITIAL_RSP
 (11)

	)

152 
	#SLSI_PA_GAS_COMEBACK_REQ
 (12)

	)

153 
	#SLSI_PA_GAS_COMEBACK_RSP
 (13)

	)

156 
	#SLSI_RM_RADIO_MEASUREMENT_REQ
 (0)

	)

157 
	#SLSI_RM_RADIO_MEASUREMENT_REP
 (1)

	)

158 
	#SLSI_RM_LINK_MEASUREMENT_REQ
 (2)

	)

159 
	#SLSI_RM_LINK_MEASUREMENT_REP
 (3)

	)

160 
	#SLSI_RM_NEIGH_REP_REQ
 (4)

	)

161 
	#SLSI_RM_NEIGH_REP_RSP
 (5)

	)

163 
	#SLSI_WNM_ACTION_FIELD_MIN
 (0)

	)

164 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

165 
	#SLSI_WNM_BSS_TM_REQ_PREF_CAND_LIST_INCLUDED
 
	`BIT
(0)

	)

166 
	#SLSI_WNM_BSS_TM_REQ_BSS_TERMINATION_INCLUDED
 
	`BIT
(3)

	)

167 
	#SLSI_WNM_BSS_TM_REQ_ESS_DISASSOC_IMMINENT
 
	`BIT
(4)

	)

169 
	#SLSI_WNM_ACTION_FIELD_MAX
 (27)

	)

172 
	#SLSI_PA_GAS_DUMMY_SUBTYPE_MASK
 0x80

	)

173 
	#SLSI_PA_GAS_INITIAL_REQ_SUBTYPE
 (
SLSI_PA_GAS_INITIAL_REQ
 | 
SLSI_PA_GAS_DUMMY_SUBTYPE_MASK
)

	)

174 
	#SLSI_PA_GAS_INITIAL_RSP_SUBTYPE
 (
SLSI_PA_GAS_INITIAL_RSP
 | 
SLSI_PA_GAS_DUMMY_SUBTYPE_MASK
)

	)

175 
	#SLSI_PA_GAS_COMEBACK_REQ_SUBTYPE
 (
SLSI_PA_GAS_COMEBACK_REQ
 | 
SLSI_PA_GAS_DUMMY_SUBTYPE_MASK
)

	)

176 
	#SLSI_PA_GAS_COMEBACK_RSP_SUBTYPE
 (
SLSI_PA_GAS_COMEBACK_RSP
 | 
SLSI_PA_GAS_DUMMY_SUBTYPE_MASK
)

	)

178 
	#SLSI_P2P_STATUS_ATTR_ID
 0

	)

179 
	#SLSI_P2P_STATUS_CODE_SUCCESS
 0

	)

181 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

182 
	#SLSI_MBO_ASSOC_DISALLOWED_ATTR_ID
 0x04

	)

183 
	#SLSI_MBO_ASSOC_RETRY_DELAY_ATTR_ID
 0x08

	)

186 
	#SLSI_ROAMING_CHANNEL_CACHE_TIMEOUT
 (5 * 60)

	)

188 
	#SLSI_RX_SEQ_NUM_MASK
 0xFFF

	)

189 
	#SLSI_RX_VIA_TDLS_LINK
 0x8000

	)

191 
	#SET_ETHERTYPE_PATTERN_DESC
(
pd
, 
‘h”ty³
) \

192 
pd
.
off£t
 = 0x0C; \

193 
pd
.
mask_Ëngth
 = 2; \

194 
pd
.
mask
[0] = 0xff; \

195 
pd
.
mask
[1] = 0xff; \

196 
pd
.
·‰”n
[0] = 
‘h”ty³
 >> 8; \

197 
pd
.
·‰”n
[1] = 
‘h”ty³
 & 0xFF

	)

200 
	#SLSI_IP_TYPE_UDP
 0x11

	)

201 
	#SLSI_IP_TYPE_OFFSET
 23

	)

202 
	#SLSI_IP_SOURCE_PORT_OFFSET
 34

	)

203 
	#SLSI_IP_DEST_PORT_OFFSET
 36

	)

204 
	#SLSI_DHCP_SERVER_PORT
 67

	)

205 
	#SLSI_DHCP_CLIENT_PORT
 68

	)

206 
	#SLSI_DNS_DEST_PORT
 53

	)

207 
	#SLSI_MDNS_DEST_PORT
 5353

	)

209 
	#SLSI_DHCP_MSG_MAGIC_OFFSET
 278

	)

210 
	#SLSI_DHCP_OPTION
 53

	)

211 
	#SLSI_DHCP_MESSAGE_TYPE_DISCOVER
 0x01

	)

212 
	#SLSI_DHCP_MESSAGE_TYPE_OFFER
 0x02

	)

213 
	#SLSI_DHCP_MESSAGE_TYPE_REQUEST
 0x03

	)

214 
	#SLSI_DHCP_MESSAGE_TYPE_DECLINE
 0x04

	)

215 
	#SLSI_DHCP_MESSAGE_TYPE_ACK
 0x05

	)

216 
	#SLSI_DHCP_MESSAGE_TYPE_NAK
 0x06

	)

217 
	#SLSI_DHCP_MESSAGE_TYPE_RELEASE
 0x07

	)

218 
	#SLSI_DHCP_MESSAGE_TYPE_INFORM
 0x08

	)

219 
	#SLSI_DHCP_MESSAGE_TYPE_FORCERENEW
 0x09

	)

220 
	#SLSI_DHCP_MESSAGE_TYPE_INVALID
 0x0A

	)

222 
	#SLSI_ARP_SRC_IP_ADDR_OFFSET
 14

	)

223 
	#SLSI_ARP_DEST_IP_ADDR_OFFSET
 24

	)

224 
	#SLSI_IS_GRATUITOUS_ARP
(
äame
è(!
	`memcmp
(&äame[
SLSI_ARP_SRC_IP_ADDR_OFFSET
],\

225 &
äame
[
SLSI_ARP_DEST_IP_ADDR_OFFSET
], 4))

	)

226 
	#SLSI_ARP_REPLY_OPCODE
 2

	)

227 
	#SLSI_ARP_REQUEST_OPCODE
 1

	)

228 
	#SLSI_ARP_OPCODE_OFFSET
 6

	)

230 
	#SLSI_ICMP6_PACKET
 58

	)

231 
	#SLSI_ICMP6_PACKET_TYPE_RA
 134

	)

232 
	#SLSI_ICMP6_PACKET_TYPE_NS
 135

	)

233 
	#SLSI_ICMP6_PACKET_TYPE_NA
 136

	)

235 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(4, 4, 0))

236 
	#WLAN_CATEGORY_WNM
 10

	)

239 #ifdeà
SCSC_SEP_VERSION


240 
	#SLSI_CONNECT_NO_NETWORK_FOUND
 0x0401

	)

241 
	#SLSI_CONNECT_AUTH_NO_ACK
 0x0402

	)

242 
	#SLSI_CONNECT_AUTH_NO_RESP
 0x0403

	)

243 
	#SLSI_CONNECT_AUTH_TX_FAIL
 0x0404

	)

244 
	#SLSI_CONNECT_AUTH_SAE_NO_ACK
 0x0405

	)

245 
	#SLSI_CONNECT_AUTH_SAE_NO_RESP
 0x0406

	)

246 
	#SLSI_CONNECT_AUTH_SAE_TX_FAIL
 0x0407

	)

247 
	#SLSI_CONNECT_ASSOC_NO_ACK
 0x0408

	)

248 
	#SLSI_CONNECT_ASSOC_NO_RESP
 0x0409

	)

249 
	#SLSI_CONNECT_ASSOC_TX_FAIL
 0x040a

	)

252 
	#SLSI_RECOVERY_SERVICE_STARTED
 0

	)

253 
	#SLSI_RECOVERY_SERVICE_STOPPED
 1

	)

254 
	#SLSI_RECOVERY_SERVICE_CLOSED
 2

	)

255 
	#SLSI_RECOVERY_SERVICE_OPENED
 3

	)

256 
	#SLSI_DEFAULT_HW_MAC_ADDR
 "\x00\x00\x0F\x11\x22\x33"

	)

258 
	e¦si_dhı_tx
 {

259 
	mSLSI_TX_IS_NOT_DHCP
,

260 
	mSLSI_TX_IS_DHCP_SERVER
,

261 
	mSLSI_TX_IS_DHCP_CLIENT


264 
	e¦si_fw_»guÏtÜy_ruË_æags
 {

265 
	mSLSI_REGULATORY_NO_IR
 = 1 << 0,

266 
	mSLSI_REGULATORY_DFS
 = 1 << 1,

267 
	mSLSI_REGULATORY_NO_OFDM
 = 1 << 2,

268 
	mSLSI_REGULATORY_NO_INDOOR
 = 1 << 3,

269 
	mSLSI_REGULATORY_NO_OUTDOOR
 = 1 << 4

272 
	e¦si_¡a_cÚn_¡©e
 {

273 
	mSLSI_STA_CONN_STATE_DISCONNECTED
 = 0,

274 
	mSLSI_STA_CONN_STATE_CONNECTING
 = 1,

275 
	mSLSI_STA_CONN_STATE_DOING_KEY_CONFIG
 = 2,

276 
	mSLSI_STA_CONN_STATE_CONNECTED
 = 3

279 
	e¦si_wÏn_v’dÜ_©Œ_rş_chªÃl_li¡
 {

280 
	mSLSI_WLAN_VENDOR_ATTR_SSID
 = 1,

281 
	mSLSI_WLAN_VENDOR_ATTR_RCL_CHANNEL_COUNT
,

282 
	mSLSI_WLAN_VENDOR_ATTR_RCL_CHANNEL_LIST
,

283 
	mSLSI_WLAN_VENDOR_ATTR_RCL_CHANNEL_LIST_EVENT_MAX


286 
šlše
 
	$com·»_‘h”_addr
(cÚ¡ 
u8
 *
addr1
, cÚ¡ u8 *
addr2
)

288  !
	`‘h”_addr_equ®
(
addr1
, 
addr2
);

289 
	}
}

291 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


292 
	g¦si_5ghz_®l_chªs
[] = {36, 40, 44, 48, 52, 56, 60, 64, 100, 104, 108, 112, 116, 120, 124,

309 
šlše
 
¦si_³”
 *
	$¦si_g‘_³”_äom_mac
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
mac
)

311 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

313 ()
sdev
;

321 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

322 ià(
ndev_vif
->
¡a
.
tdls_’abËd
) {

323 
i
;

325 
i
 = 1; i < 
SLSI_TDLS_PEER_INDEX_MAX
; i++)

326 ià(
ndev_vif
->
³”_¡a_»cÜd
[
i
] &&‚dev_vif->³”_¡a_»cÜd[i]->
v®id
 &&

327 
	`com·»_‘h”_addr
(
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
add»ss
, 
mac
) == 0)

328  
ndev_vif
->
³”_¡a_»cÜd
[
i
];

330 ià(
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
] &&‚dev_vif->³”_¡a_»cÜd[SLSI_STA_PEER_QUEUESET]->
v®id
)

331  
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
];

332 } ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
) {

333 
i
 = 0;

335 
i
 = 0; i < 
SLSI_PEER_INDEX_MAX
; i++)

336 ià(
ndev_vif
->
³”_¡a_»cÜd
[
i
] &&‚dev_vif->³”_¡a_»cÜd[i]->
v®id
 &&

337 
	`com·»_‘h”_addr
(
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
add»ss
, 
mac
) == 0)

338  
ndev_vif
->
³”_¡a_»cÜd
[
i
];

339 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


340 } ià(
ndev_vif
->
iâum
 >ğ
SLSI_NAN_DATA_IFINDEX_START
) {

341 
i
 = 0;

343 
i
 = 0; i < 
SLSI_PEER_INDEX_MAX
; i++) {

344 ià(
ndev_vif
->
³”_¡a_»cÜd
[
i
] &&‚dev_vif->³”_¡a_»cÜd[i]->
v®id
 &&

345 
	`com·»_‘h”_addr
(
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
add»ss
, 
mac
) == 0)

346  
ndev_vif
->
³”_¡a_»cÜd
[
i
];

349 ià(
	`is_muÉiÿ¡_‘h”_addr
(
mac
)) {

350 
i
 = 0; i < 
SLSI_PEER_INDEX_MAX
; i++)

351 ià(
ndev_vif
->
³”_¡a_»cÜd
[
i
] &&‚dev_vif->³”_¡a_»cÜd[i]->
v®id
) {

352 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "muÉiÿ¡/brßdÿ¡…ack‘ oÀNAN‚‘ià(de¡:%pM, chªgtØ³”: %pM)\n", 
mac
, 
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
add»ss
);

353  
ndev_vif
->
³”_¡a_»cÜd
[
i
];

360  
NULL
;

361 
	}
}

363 
šlše
 
¦si_³”
 *
	$¦si_g‘_³”_äom_qs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
queue£t
)

365 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

367 ()
sdev
;

369 ià(!
ndev_vif
->
³”_¡a_»cÜd
[
queue£t
] || !ndev_vif->³”_¡a_»cÜd[queue£t]->
v®id
)

370  
NULL
;

372  
ndev_vif
->
³”_¡a_»cÜd
[
queue£t
];

373 
	}
}

375 
šlše
 
boŞ
 
	$¦si_is_tdls_³”
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
)

377 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

379  (
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
è&& (
³”
->
aid
 >ğ
SLSI_TDLS_PEER_INDEX_MIN
);

380 
	}
}

382 
šlše
 
boŞ
 
	$¦si_is_´oxy_¬p_suµÜ‹d_Ú_­
(
sk_buff
 *
assoc_»¥_›
)

384 cÚ¡ 
u8
 *
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_EXT_CAPABILITY
, 
assoc_»¥_›
->
d©a
,‡ssoc_»¥_›->
Ën
);

386 ià((
›
) && (ie[1] > 1))

387  
›
[3] & 0x10;

390 
	}
}

392 
šlše
 
	$¦si_ÿche_›s
(cÚ¡ 
u8
 *
¤c_›
, 
size_t
 
¤c_›_Ën
, u8 **
de¡_›
, size_ˆ*
de¡_›_Ën
)

394 *
de¡_›
 = 
	`km®loc
(
¤c_›_Ën
, 
GFP_KERNEL
);

395 ià(*
de¡_›
 =ğ
NULL
)

396  -
ENOMEM
;

398 
	`memıy
(*
de¡_›
, 
¤c_›
, 
¤c_›_Ën
);

399 *
de¡_›_Ën
 = 
¤c_›_Ën
;

402 
	}
}

404 
šlše
 
	$¦si_ş—r_ÿched_›s
(
u8
 **
›
, 
size_t
 *
›_Ën
)

406 ià(*
›_Ën
 != 0)

407 
	`kä“
(*
›
);

408 *
›
 = 
NULL
;

409 *
›_Ën
 = 0;

410 
	}
}

413 
šlše
 *
	$¦si_·_subty³_‹xt
(
subty³
)

415 
subty³
) {

416 
SLSI_P2P_PA_GO_NEG_REQ
:

418 
SLSI_P2P_PA_GO_NEG_RSP
:

420 
SLSI_P2P_PA_GO_NEG_CFM
:

422 
SLSI_P2P_PA_INV_REQ
:

424 
SLSI_P2P_PA_INV_RSP
:

426 
SLSI_P2P_PA_DEV_DISC_REQ
:

428 
SLSI_P2P_PA_DEV_DISC_RSP
:

430 
SLSI_P2P_PA_PROV_DISC_REQ
:

432 
SLSI_P2P_PA_PROV_DISC_RSP
:

434 
SLSI_PA_GAS_INITIAL_REQ_SUBTYPE
:

436 
SLSI_PA_GAS_INITIAL_RSP_SUBTYPE
:

438 
SLSI_PA_GAS_COMEBACK_REQ_SUBTYPE
:

440 
SLSI_PA_GAS_COMEBACK_RSP_SUBTYPE
:

442 
SLSI_PA_INVALID
:

447 
	}
}

450 
šlše
 
	$¦si_assign_cook›_id
(
u64
 *
cook›
, u64 *
couÁ”
)

452 (*
cook›
èğ++(*
couÁ”
);

453 ià((*
cook›
) == 0)

454 (*
cook›
èğ++(*
couÁ”
);

455 
	}
}

458 
šlše
 
	$¦si_unsync_vif_£t_´obe_r¥_›
(
Ãtdev_vif
 *
ndev_vif
, 
u8
 *
›s
, 
size_t
 
›s_Ën
)

460 ià(
ndev_vif
->
unsync
.
´obe_r¥_›s_Ën
)

461 
	`kä“
(
ndev_vif
->
unsync
.
´obe_r¥_›s
);

462 
ndev_vif
->
unsync
.
´obe_r¥_›s
 = 
›s
;

463 
ndev_vif
->
unsync
.
´obe_r¥_›s_Ën
 = 
›s_Ën
;

464 
	}
}

467 
šlše
 
	$¦si_£t_mgmt_tx_d©a
(
Ãtdev_vif
 *
ndev_vif
, 
u64
 
cook›
, 
u16
 
ho¡_g
, cÚ¡ 
u8
 *
buf
, 
size_t
 
buf_Ën
)

469 
u8
 *
tx_äame
 = 
NULL
;

471 ià(
buf_Ën
 != 0) {

472 
tx_äame
 = 
	`km®loc
(
buf_Ën
, 
GFP_KERNEL
);

473 ià(!
tx_äame
) {

474 
	`SLSI_NET_ERR
(
ndev_vif
->
wdev
.
Ãtdev
, "FAILEDo‡llocate memory for Tx frame\n");

475  -
ENOMEM
;

477 
	`SLSI_NET_DBG3
(
ndev_vif
->
wdev
.
Ãtdev
, 
SLSI_CFG80211
, "Copy buffer forx_status\n");

478 
	`memıy
(
tx_äame
, 
buf
, 
buf_Ën
);

479 } ià(
ndev_vif
->
mgmt_tx_d©a
.
buf
) {

480 
	`SLSI_NET_DBG3
(
ndev_vif
->
wdev
.
Ãtdev
, 
SLSI_CFG80211
, "Free buffer ofx_status\n");

481 
	`kä“
(
ndev_vif
->
mgmt_tx_d©a
.
buf
);

484 
ndev_vif
->
mgmt_tx_d©a
.
cook›
 = cookie;

485 
ndev_vif
->
mgmt_tx_d©a
.
ho¡_g
 = host_tag;

486 
ndev_vif
->
mgmt_tx_d©a
.
buf
 = 
tx_äame
;

487 
ndev_vif
->
mgmt_tx_d©a
.
buf_Ën
 = buf_len;

490 
	}
}

495 
šlše
 
	$¦si_p2p_queue_unsync_vif_d–_wÜk
(
Ãtdev_vif
 *
ndev_vif
, 
d–ay
)

497 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
d–_vif_wÜk
);

498 
	`queue_d–ayed_wÜk
(
ndev_vif
->
sdev
->
deviû_wq
, &ndev_vif->
unsync
.
d–_vif_wÜk
, 
	`m£cs_to_jiff›s
(
d–ay
));

499 
	}
}

502 
	#SLSI_P2P_STATE_CHANGE
(
sdev
, 
Ãxt_¡©e
) \

504 
	`SLSI_DBG1
(
sdev
, 
SLSI_CFG80211
, "P2P s‹ chªge: % -> %s\n", 
	`¦si_p2p_¡©e_‹xt
(sdev->
p2p_¡©e
), slsi_p2p_¡©e_‹xt(
Ãxt_¡©e
)); \

505 
sdev
->
p2p_¡©e
 = 
Ãxt_¡©e
; \

506 } 0)

	)

508 
¦si_purge_sÿn_»suÉs
(
Ãtdev_vif
 *
ndev_vif
, 
u16
 
sÿn_id
);

509 
¦si_purge_sÿn_»suÉs_locked
(
Ãtdev_vif
 *
ndev_vif
, 
u16
 
sÿn_id
);

510 
sk_buff
 *
¦si_dequeue_ÿched_sÿn_»suÉ
(
¦si_sÿn
 *
sÿn
, *
couÁ
);

511 
¦si_g‘_hw_mac_add»ss
(
¦si_dev
 *
sdev
, 
u8
 *
addr
);

512 
¦si_¡¬t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

513 
¦si_¡¬t_mÚ™Ü_mode
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

514 
¦si_¡İ_Ãt_dev
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

515 
¦si_¡İ
(
¦si_dev
 *
sdev
);

516 
¦si_¡İ_locked
(
¦si_dev
 *
sdev
);

517 
¦si_³”
 *
¦si_³”_add
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
³”_add»ss
, 
u16
 
aid
);

518 
¦si_³”_upd©e_assoc_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
, 
sk_buff
 *
skb
);

519 
¦si_³”_upd©e_assoc_r¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
, 
sk_buff
 *
skb
);

520 
¦si_³”_»£t_¡©s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
);

521 
¦si_³”_»move
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
);

522 
¦si_ps_pÜt_cÚŒŞ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
, 
¦si_¡a_cÚn_¡©e
 
s
);

523 
¦si_d–_¡©iÚ
(
why
 *why, 
Ãt_deviû
 *
dev
,

524 
¡©iÚ_d–_·¿m‘”s
 *
d–_·¿ms
);

525 
¦si_¡a_›“80211_mode
(
Ãt_deviû
 *
dev
, 
u16
 
cu¼’t_bss_chªÃl_äequ’cy
);

526 
¦si_vif_aùiv©ed
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

527 
¦si_vif_d—ùiv©ed
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

528 
¦si_hªdË_discÚÃù
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
³”_add»ss
, 
u16
 
»asÚ
,

529 
u8
 *
di§ssoc_r¥_›
, 
u32
 
di§ssoc_r¥_›_Ën
);

530 
¦si_bªd_upd©e
(
¦si_dev
 *
sdev
, 
bªd
);

531 
¦si_bªd_cfg_upd©e
(
¦si_dev
 *
sdev
, 
bªd
);

532 
¦si__add»ss_chªged
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
__be32
 
add»ss
);

533 
¦si_£nd_g¿tu™ous_¬p
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

534 
›“80211_chªÃl
 *
¦si_fšd_sÿn_chªÃl
(
¦si_dev
 *
sdev
, 
›“80211_mgmt
 *
mgmt
, 
size_t
 
mgmt_Ën
, 
u16
 
äeq
);

535 
¦si_auto_chª_£Ëù_sÿn
(
¦si_dev
 *
sdev
, 
chª_couÁ
, 
›“80211_chªÃl
 *
chªÃls
[]);

536 
¦si_£t_ušt_mib
(
¦si_dev
 *
dev
, 
Ãt_deviû
 *
ndev
, 
u16
 
psid
, 
v®ue
);

537 
¦si_upd©e_»gd_ruËs
(
¦si_dev
 *
sdev
, 
boŞ
 
couÁry_check
);

538 
¦si_£t_boo¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

539 
¦si_p2p_š™
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
);

540 
¦si_p2p_deš™
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
);

541 
¦si_p2p_vif_aùiv©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
›“80211_chªÃl
 *
chª
, 
u16
 
du¿tiÚ
, 
boŞ
 
£t_´obe_r¥_›s
);

542 
¦si_p2p_vif_d—ùiv©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
boŞ
 
hw_avaabË
);

543 
¦si_p2p_group_¡¬t_»move_unsync_vif
(
¦si_dev
 *
sdev
);

544 
¦si_p2p_dev_´obe_r¥_›
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
´obe_r¥_›
, 
size_t
 
´obe_r¥_›_Ën
);

545 
¦si_p2p_dev_nuÎ_›s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

546 
¦si_g‘_public_aùiÚ_subty³
(cÚ¡ 
›“80211_mgmt
 *
mgmt
);

547 
¦si_p2p_g‘_go_Ãg_r¥_¡©us
(
Ãt_deviû
 *
dev
, cÚ¡ 
›“80211_mgmt
 *
mgmt
);

548 
u8
 
¦si_g‘_exp_³”_äame_subty³
(u8 
subty³
);

549 
¦si_£nd_txq_·¿ms
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
ndev
);

550 
¦si_abÜt_¡a_sÿn
(
¦si_dev
 *
sdev
);

551 
¦si_is_dhı_·ck‘
(
u8
 *
d©a
);

552 
¦si_£t_muÉiÿ¡_·ck‘_f‹rs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

553 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

554 
¦si_£t_»£t_cÚÃù_©‹m±ed_æag
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
bssid
);

555 
boŞ
 
¦si_£Ëù_­_fÜ_cÚÃùiÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 **
bssid
,

556 
›“80211_chªÃl
 **
chªÃl
, 
boŞ
 
»Œy
);

558 #ifdeà
CONFIG_SCSC_WLAN_PRIORITISE_IMP_FRAMES


559 
¦si_is_dns_·ck‘
(
u8
 *
d©a
);

560 
¦si_is_mdns_·ck‘
(
u8
 *
d©a
);

561 
¦si_is_tı_sync_·ck‘
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

564 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


565 
¦si_£t_’hªûd_pkt_f‹r
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
);

567 
¦si_£t_·ck‘_f‹rs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

568 
¦si_upd©e_·ck‘_f‹rs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

569 
¦si_ş—r_·ck‘_f‹rs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

570 
¦si_­_´•¬e_add_šfo_›s
(
Ãtdev_vif
 *
ndev_vif
, cÚ¡ 
u8
 *
›s
, 
size_t
 
›s_Ën
);

571 
¦si_£t_mib_rßm
(
¦si_dev
 *
dev
, 
Ãt_deviû
 *
ndev
, 
u16
 
psid
, 
v®ue
);

572 #ifdeà
CONFIG_SCSC_WLAN_SET_PREFERRED_ANTENNA


573 
¦si_£t_mib_´eã¼ed_ª‹Âa
(
¦si_dev
 *
dev
, 
u16
 
v®ue
);

575 
¦si_»£t_throughput_¡©s
(
Ãt_deviû
 *
dev
);

576 
¦si_£t_mib_rssi_boo¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
psid
, 
šdex
, 
boo¡
);

577 #ifdeà
CONFIG_SCSC_WLAN_LOW_LATENCY_MODE


578 
¦si_£t_mib_soá_rßmšg_’abËd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
boŞ
 
’abË
);

580 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


581 
¦si_»ad_’hªûd_¬p_rx_couÁ_by_low”_mac
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
psid
);

582 
¦si_fl_’hªûd_¬p_out_of_Üd”_drİ_couÁ”
(
Ãtdev_vif
 *
ndev_vif
,

583 
sk_buff
 *
skb
);

585 
¦si_modify_›s_Ú_chªÃl_sw™ch
(
Ãt_deviû
 *
dev
, 
cfg80211_­_£‰šgs
 *
£‰šgs
,

586 
u8
 *
ds_·¿ms_›
, u8 *
ht_İ”©iÚ_›
, 
›“80211_mgmt
 *
mgmt
,

587 
u16
 
b—cÚ_›_h—d_Ën
);

588 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


589 
¦si_exŒaù_v®id_wifi_sh¬šg_chªÃls
(
¦si_dev
 *
sdev
);

590 
boŞ
 
¦si_if_v®id_wifi_sh¬šg_chªÃl
(
¦si_dev
 *
sdev
, 
äeq
);

591 
¦si_check_if_nÚ_šdoÜ_nÚ_dfs_chªÃl
(
¦si_dev
 *
sdev
, 
äeq
);

592 
¦si_g‘_mhs_ws_chª_vsdb
(
why
 *why, 
Ãt_deviû
 *
dev
,

593 
cfg80211_­_£‰šgs
 *
£‰šgs
,

594 
¦si_dev
 *
sdev
, *
wifi_sh¬šg_chªÃl_sw™ched
);

595 
¦si_g‘_mhs_ws_chª_rsdb
(
why
 *why, 
Ãt_deviû
 *
dev
,

596 
cfg80211_­_£‰šgs
 *
£‰šgs
,

597 
¦si_dev
 *
sdev
, *
wifi_sh¬šg_chªÃl_sw™ched
);

598 
¦si_£t_wifish¬šg_³rm™‹d_chªÃls
(
Ãt_deviû
 *
dev
, *
bufãr
, 
buf_Ën
);

599 
¦si_check_if_chªÃl_»¡riùed_®»ady
(
¦si_dev
 *
sdev
, 
chªÃl
);

601 
Ãt_deviû
 *
¦si_dyÇmic_š‹rçû_ü—‹
(
why
 *wiphy,

602 cÚ¡ *
Çme
,

603 
Æ80211_iáy³
 
ty³
,

604 
vif_·¿ms
 *
·¿ms
);

605 
¦si_¡İ_ch
(
¦si_dev
 *
sdev
);

606 
¦si_g‘_b—cÚ_cu
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, *
mib_v®ue
);

607 
¦si_g‘_mib_rßm
(
¦si_dev
 *
sdev
, 
u16
 
psid
, *
mib_v®ue
);

608 
¦si_rßm_chªÃl_ÿche_add
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

609 
¦si_rßm_chªÃl_ÿche_´uÃ
(
Ãt_deviû
 *
dev
, 
£cÚds
, *
ssid
);

610 
¦si_rßmšg_sÿn_cÚfigu»_chªÃls
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
ssid
, u8 *
chªÃls
);

611 
¦si_£nd_max_Œªsm™_msdu_liãtime
(
¦si_dev
 *
dev
, 
Ãt_deviû
 *
ndev
, 
u32
 
msdu_liãtime
);

612 
¦si_»ad_max_Œªsm™_msdu_liãtime
(
¦si_dev
 *
dev
, 
Ãt_deviû
 *
ndev
, 
u32
 *
msdu_liãtime
);

613 
¦si_»ad_unifi_couÁryli¡
(
¦si_dev
 *
sdev
, 
u16
 
psid
);

614 
¦si_»ad_deçuÉ_couÁry
(
¦si_dev
 *
sdev
, 
u8
 *
®pha2
, 
u16
 
šdex
);

615 
¦si_»ad_discÚÃù_šd_timeout
(
¦si_dev
 *
sdev
, 
u16
 
psid
);

616 
¦si_»ad_»guÏtÜy_ruËs
(
¦si_dev
 *
sdev
, 
¦si_802_11d_»g_domaš
 *
domaš_šfo
, cÚ¡ *
®pha2
);

617 
¦si_»ad_»guÏtÜy_ruËs_fw
(
¦si_dev
 *
sdev
, 
¦si_802_11d_»g_domaš
 *
domaš_šfo
, cÚ¡ *
®pha2
);

618 
¦si_£nd_acs_ev’t
(
¦si_dev
 *
sdev
, 
¦si_acs_£Ëùed_chªÃls
 
acs_£Ëùed_chªÃls
);

619 
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
¦si_rßm_chªÃl_ÿche_g‘
(
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
ssid
);

620 
¦si_rßm_chªÃl_ÿche_g‘_chªÃls_št
(
Ãt_deviû
 *
dev
, 
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
ÃtwÜk_m­
, 
u8
 *
chªÃls
);

621 
¦si_£nd_rş_chªÃl_li¡_ev’t
(
¦si_dev
 *
sdev
, 
u32
 
chªÃl_couÁ
, 
u16
 *
chªÃl_li¡
, 
u8
 *
ssid
, u8 
ssid_Ën
);

622 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


623 
¦si_£t_mac_¿ndomi§tiÚ_mask
(
¦si_dev
 *
sdev
, 
u8
 *
mac_add»ss_mask
);

625 
¦si_£t_couÁry_upd©e_»gd
(
¦si_dev
 *
sdev
, cÚ¡ *
®pha2_code
, 
size
);

626 
¦si_ş—r_offchªÃl_d©a
(
¦si_dev
 *
sdev
, 
boŞ
 
acquœe_lock
);

627 
¦si_wÏn_unsync_vif_aùiv©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

628 
›“80211_chªÃl
 *
chª
, 
u16
 
du¿tiÚ
);

629 
¦si_wÏn_unsync_vif_d—ùiv©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
devboŞ
, 
boŞ
 
hw_avaabË
);

630 
boŞ
 
¦si_is_bssid_š_bÏckli¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
bssid
);

631 
¦si_hs2_unsync_vif_d–‘e_wÜk
(
wÜk_¡ruù
 *
wÜk
);

632 
¦si_is_wes_aùiÚ_äame
(cÚ¡ 
›“80211_mgmt
 *
mgmt
);

633 
¦si_sÿn_šd_timeout_hªdË
(
wÜk_¡ruù
 *
wÜk
);

634 
¦si_bÏckli¡_d–_wÜk_hªdË
(
wÜk_¡ruù
 *
wÜk
);

635 
¦si_vif_ş—nup
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
boŞ
 
hw_avaabË
, boŞ 
is_»cov”y
);

636 
¦si_sÿn_ş—nup
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

637 
¦si_dump_¡©s
(
Ãt_deviû
 *
dev
);

638 
¦si_£nd_hªged_v’dÜ_ev’t
(
¦si_dev
 *
sdev
, 
u16
 
scsc_·nic_code
);

639 
¦si_£t_ext_ÿp
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
›s
, 
›_Ën
, cÚ¡ u8 *
ext_ÿp_mask
);

640 
¦si_upd©e_suµÜ‹d_chªÃls_»gd_æags
(
¦si_dev
 *
sdev
);

641 #ifdeà
CONFIG_SCSC_WLAN_HANG_TEST


642 
¦si_‹¡_£nd_hªged_v’dÜ_ev’t
(
Ãt_deviû
 *
dev
);

644 
¦si_£nd_pow”_m—su»m’t_v’dÜ_ev’t
(
¦si_dev
 *
sdev
, 
s16
 
pow”_š_db
);

645 #ià
defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

646 
¦si_£nd_fÜw¬d_b—cÚ_v’dÜ_ev’t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

647 cÚ¡ 
u8
 *
ssid
, cÚ¡ 
ssid_Ën
, cÚ¡ u8 *
bssid
, u8 
chªÃl
,

648 cÚ¡ 
u16
 
b—cÚ_št
, cÚ¡ 
u64
 
time¡amp
, cÚ¡ u64 
sys_time
);

649 
¦si_£nd_fÜw¬d_b—cÚ_abÜt_v’dÜ_ev’t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
»asÚ_code
);

651 
¦si_wÏn_dump_public_aùiÚ_subty³
(
¦si_dev
 *
sdev
, 
›“80211_mgmt
 *
mgmt
, 
boŞ
 
tx
);

652 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

653 
u8
 
¦si_bss_cÚÃù_ty³_g‘
(
¦si_dev
 *
sdev
, cÚ¡ u8 *
›
, 
size_t
 
›_Ën
);

655 
¦si_»£t_chªÃl_æags
(
¦si_dev
 *
sdev
);

656 
¦si_m”ge_li¡s
(
u8
 
¬1
[], 
Ën1
, u8 
¬2
[], 
Ën2
, u8 
»suÉ
[]);

657 
¦si_»move_du¶iÿ‹s
(
u8
 
¬r
[], 
n
);

658 
¦si_sÜt_¬¿y
(
u8
 
¬r
[], 
n
);

659 #ifdeà
CONFIG_SCSC_WLAN_SAR_SUPPORTED


660 
¦si_cÚfigu»_tx_pow”_§r_sûÇrio
(
Ãt_deviû
 *
dev
, 
mode
);

663 
¦si_ü—‹_sysfs_maÿddr
();

664 
¦si_de¡roy_sysfs_maÿddr
();

666 
¦si_ü—‹_sysfs_v”siÚ_šfo
();

667 
¦si_de¡roy_sysfs_v”siÚ_šfo
();

668 #ià
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

669 
¦si_ü—‹_sysfs_debug_dump
();

670 
¦si_de¡roy_sysfs_debug_dump
();

671 
¦si_cŞËù_ch£t_logs
(
wÜk_¡ruù
 *
wÜk
);

673 
¦si_ü—‹_sysfs_pm
();

674 
¦si_de¡roy_sysfs_pm
();

675 
¦si_ü—‹_sysfs_ªt
();

676 
¦si_de¡roy_sysfs_ªt
();

677 
¦si_fšd_chª_idx
(
u16
 
chª
, 
u8
 
hw_mode
);

678 
¦si_£t_Ï‹ncy_mode
(
Ãt_deviû
 *
dev
, 
Ï‹ncy_mode
, 
cmd_Ën
);

679 
¦si_Œigg”_£rviû_çu»
(
wÜk_¡ruù
 *
wÜk
);

680 
¦si_çu»_»£t
(
wÜk_¡ruù
 *
wÜk
);

681 
¦si_¡¬t_­
(
why
 *why, 
Ãt_deviû
 *
dev
,

682 
cfg80211_­_£‰šgs
 *
£‰šgs
);

683 
¦si_subsy¡em_»£t
(
wÜk_¡ruù
 *
wÜk
);

684 
¦si_ch_»cov”y
(
wÜk_¡ruù
 *
wÜk
);

685 
¦si_sy¡em_”rÜ_»cov”y
(
wÜk_¡ruù
 *
wÜk
);

686 
¦si_£t_aş
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

687 
¦si_purge_bÏckli¡
(
Ãtdev_vif
 *
ndev_vif
);

688 
¦si_rx_upd©e_wake_¡©s
(
¦si_dev
 *
sdev
, 
‘hhdr
 *
ehdr
, 
buff_Ën
);

689 
¦si_£t_Ï‹ncy_üt_d©a
(
Ãt_deviû
 *
dev
, 
Ï‹ncy_mode
);

690 
boŞ
 
¦si_is_bssid_š_h®_bÏckli¡
(
Ãt_deviû
 *
dev
, 
u8
 *
bssid
);

691 
boŞ
 
¦si_is_bssid_š_ioùl_bÏckli¡
(
Ãt_deviû
 *
dev
, 
u8
 *
bssid
);

692 
¦si_»move_bssid_bÏckli¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
addr
);

693 
¦si_add_ioùl_bÏckli¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
addr
);

694 
u8
 *
¦si_g‘_sÿn_exŒa_›s
(
¦si_dev
 *
sdev
, cÚ¡ u8 *
›s
,

695 
tÙ®_Ën
, *
exŒa_Ën
);

697 #ifdeà
CONFIG_SCSC_WLAN_DYNAMIC_ITO


698 
¦si_£t_™o
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
);

699 
¦si_’abË_™o
(
Ãt_deviû
 *
dev
, *
commªd
, 
buf_Ën
);

701 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

702 
¦si_»Œy_cÚÃùiÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

703 
¦si_ä“_cÚÃùiÚ_·¿ms
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

705 
¦si_add_´obe_›s_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

	@mib.c

8 
	~"cÚ¡.h
"

9 
	~"mib.h
"

10 
	~"debug.h
"

12 
	#SLSI_MIB_MORE_MASK
 0x80

	)

13 
	#SLSI_MIB_SIGN_MASK
 0x40

	)

14 
	#SLSI_MIB_TYPE_MASK
 0x20

	)

15 
	#SLSI_MIB_LENGTH_MASK
 0x1FU

	)

21 
	$¦si_mib_buf_­³nd
(
¦si_mib_d©a
 *
d¡
, 
size_t
 
bufãr_Ëngth
, 
u8
 *
bufãr
)

23 
u8
 *
Ãw_bufãr
 = 
	`km®loc
(
d¡
->
d©aL’gth
 + 
bufãr_Ëngth
, 
GFP_KERNEL
);

25 ià(!
Ãw_bufãr
) {

26 
	`SLSI_ERR_NODEV
("km®loc(%dèçed\n", ()(
d¡
->
d©aL’gth
 + 
bufãr_Ëngth
));

30 
	`memıy
(
Ãw_bufãr
, 
d¡
->
d©a
, d¡->
d©aL’gth
);

31 
	`memıy
(&
Ãw_bufãr
[
d¡
->
d©aL’gth
], 
bufãr
, 
bufãr_Ëngth
);

33 
d¡
->
d©aL’gth
 +ğ(
u16
)
bufãr_Ëngth
;

34 
	`kä“
(
d¡
->
d©a
);

35 
d¡
->
d©a
 = 
Ãw_bufãr
;

36 
	}
}

38 
size_t
 
	$¦si_mib_’code_ušt32
(
u8
 *
bufãr
, 
u32
 
v®ue
)

40 
u8
 
i
;

41 
u8
 
wr™e_couÁ
 = 0;

43 ià(
v®ue
 < 64) {

44 
bufãr
[0] = (
u8
)
v®ue
;

54 
i
 = 0; i < 4; i++) {

55 
u8
 
by‹_v®ue
 = (
v®ue
 & 0xFF000000) >> 24;

57 ià(
by‹_v®ue
 || 
wr™e_couÁ
) {

58 
bufãr
[1 + 
wr™e_couÁ
] = 
by‹_v®ue
;

59 
wr™e_couÁ
++;

61 
v®ue
 = value << 8;

65 
bufãr
[0] = 
wr™e_couÁ
 | 
SLSI_MIB_MORE_MASK
;

67  1 + 
wr™e_couÁ
;

68 
	}
}

70 
size_t
 
	$¦si_mib_’code_št32
(
u8
 *
bufãr
, 
s32
 
sigÃd_v®ue
)

72 
u8
 
i
;

73 
u8
 
wr™e_couÁ
 = 0;

74 
u32
 
v®ue
 = (u32)
sigÃd_v®ue
;

76 ià(!(
v®ue
 & 0x10000000))

78  
	`¦si_mib_’code_ušt32
(
bufãr
, 
v®ue
);

80 ià(
sigÃd_v®ue
 >= -64) {

81 
bufãr
[0] = (
u8
)
v®ue
 & 0x7F;

86 
i
 = 0; i < 4; i++) {

87 
u8
 
by‹_v®ue
 = (
v®ue
 & 0xFF000000) >> 24;

89 ià(!((
by‹_v®ue
 =ğ0xFFè&& (
v®ue
 & 0x800000)è|| 
wr™e_couÁ
) {

90 
bufãr
[1 + 
wr™e_couÁ
] = 
by‹_v®ue
;

91 
wr™e_couÁ
++;

93 
v®ue
 = value << 8;

96 
bufãr
[0] = 
wr™e_couÁ
 | 
SLSI_MIB_MORE_MASK
 | 
SLSI_MIB_SIGN_MASK
;

98  1 + 
wr™e_couÁ
;

99 
	}
}

101 
size_t
 
	$¦si_mib_’code_où‘_¡r
(
u8
 *
bufãr
, 
¦si_mib_d©a
 *
où‘_v®ue
)

103 
u8
 
i
;

104 
u8
 
wr™e_couÁ
 = 0;

105 
size_t
 
Ëngth
 = 
où‘_v®ue
->
d©aL’gth
;

106 
size_t
 
»t_Ëngth
 = 0;

114 
i
 = 0; i < 3; i++) {

115 
u8
 
by‹_v®ue
 = (
Ëngth
 & 0xFF000000) >> 24;

117 ià(
by‹_v®ue
 || 
wr™e_couÁ
) {

118 
bufãr
[1 + 
wr™e_couÁ
] = 
by‹_v®ue
;

119 
wr™e_couÁ
++;

121 
Ëngth
 =†ength << 8;

124 
bufãr
[0] = (1 + 
wr™e_couÁ
è| 
SLSI_MIB_MORE_MASK
 | 
SLSI_MIB_TYPE_MASK
;

125 
bufãr
[1 + 
wr™e_couÁ
] = 
où‘_v®ue
->
d©aL’gth
 & 0xFF;

126 
	`memıy
(&
bufãr
[2 + 
wr™e_couÁ
], 
où‘_v®ue
->
d©a
, où‘_v®ue->
d©aL’gth
);

128 
»t_Ëngth
 = (
size_t
)(2U + 
wr™e_couÁ
 + 
où‘_v®ue
->
d©aL’gth
);

129  
»t_Ëngth
;

130 
	}
}

132 
size_t
 
	$¦si_mib_decode_ušt32
(
u8
 *
bufãr
, 
u32
 *
v®ue
)

134 
size_t
 
i
;

135 
u32
 
v
 = 0;

136 
size_t
 
Ëngth
 = 
bufãr
[0] & 
SLSI_MIB_LENGTH_MASK
;

138 ià(!(
bufãr
[0] & 
SLSI_MIB_MORE_MASK
)) {

139 *
v®ue
 = 
bufãr
[0] & 0x7F;

143 
i
 = 0; i < 
Ëngth
; i++) {

144 
v
 = (v << 8);

145 
v
 |ğ
bufãr
[1 + 
i
];

148 *
v®ue
 = 
v
;

150  1 + 
Ëngth
;

151 
	}
}

153 
size_t
 
	$¦si_mib_decodeUšt64
(
u8
 *
bufãr
, 
u64
 *
v®ue
)

155 
size_t
 
i
;

156 
u64
 
v
 = 0;

157 
size_t
 
Ëngth
 = 
bufãr
[0] & 
SLSI_MIB_LENGTH_MASK
;

159 ià(!(
bufãr
[0] & 
SLSI_MIB_MORE_MASK
)) {

160 *
v®ue
 = 
bufãr
[0] & 0x7F;

164 
i
 = 0; i < 
Ëngth
; i++) {

165 
v
 = (v << 8);

166 
v
 |ğ
bufãr
[1 + 
i
];

169 *
v®ue
 = 
v
;

171  1 + 
Ëngth
;

172 
	}
}

174 
size_t
 
	$¦si_mib_decodeIÁ32
(
u8
 *
bufãr
, 
s32
 *
v®ue
)

176 
size_t
 
i
;

177 
u32
 
v
 = 0xFFFFFFFF;

178 
size_t
 
Ëngth
 = 
bufãr
[0] & 
SLSI_MIB_LENGTH_MASK
;

180 ià(!(
bufãr
[0] & 
SLSI_MIB_SIGN_MASK
))

182  
	`¦si_mib_decode_ušt32
(
bufãr
, (
u32
 *)
v®ue
);

184 ià(!(
bufãr
[0] & 
SLSI_MIB_MORE_MASK
)) {

185 *
v®ue
 = (
s32
)(0xFFFFFF80 | 
bufãr
[0]);

189 
i
 = 0; i < 
Ëngth
; i++) {

190 
v
 = (v << 8);

191 
v
 |ğ
bufãr
[1 + 
i
];

194 *
v®ue
 = (
s32
)
v
;

196  1 + 
Ëngth
;

197 
	}
}

199 
size_t
 
	$¦si_mib_decodeIÁ64
(
u8
 *
bufãr
, 
s64
 *
v®ue
)

201 
size_t
 
i
;

202 
u64
 
v
 = 0xFFFFFFFFFFFFFFFFULL;

203 
size_t
 
Ëngth
 = 
bufãr
[0] & 
SLSI_MIB_LENGTH_MASK
;

205 ià(!(
bufãr
[0] & 
SLSI_MIB_SIGN_MASK
))

207  
	`¦si_mib_decodeUšt64
(
bufãr
, (
u64
 *)
v®ue
);

209 ià(!(
bufãr
[0] & 
SLSI_MIB_MORE_MASK
)) {

210 *
v®ue
 = (
s64
)(0xFFFFFFFFFFFFFF80ULL | 
bufãr
[0]);

214 
i
 = 0; i < 
Ëngth
; i++) {

215 
v
 = (v << 8);

216 
v
 |ğ
bufãr
[1 + 
i
];

219 *
v®ue
 = (
s64
)
v
;

221  1 + 
Ëngth
;

222 
	}
}

225 
size_t
 
	$¦si_mib_decode_où‘_¡r
(
u8
 *
bufãr
, 
¦si_mib_d©a
 *
où‘_v®ue
)

227 
size_t
 
i
;

228 
u32
 
oid_Ëngth_v®ue
 = 0;

229 
size_t
 
Ëngth
 = 
bufãr
[0] & 
SLSI_MIB_LENGTH_MASK
;

231 
i
 = 0; i < 
Ëngth
; i++) {

232 
oid_Ëngth_v®ue
 = (oid_length_value << 8);

233 
oid_Ëngth_v®ue
 |ğ
bufãr
[1 + 
i
];

236 
où‘_v®ue
->
d©aL’gth
 = 
oid_Ëngth_v®ue
;

237 
où‘_v®ue
->
d©a
 = 
NULL
;

238 ià(
oid_Ëngth_v®ue
)

239 
où‘_v®ue
->
d©a
 = &
bufãr
[1 + 
Ëngth
];

241  1 + 
Ëngth
 + 
oid_Ëngth_v®ue
;

242 
	}
}

244 
u8
 
	$¦si_mib_decode_ty³_Ëngth
(
u8
 *
bufãr
, 
size_t
 *
Ëngth
)

246 *
Ëngth
 = 1;

247 ià(
bufãr
[0] & 
SLSI_MIB_MORE_MASK
)

248 *
Ëngth
 = 
bufãr
[0] & 
SLSI_MIB_LENGTH_MASK
;

250 ià(
bufãr
[0] & 
SLSI_MIB_SIGN_MASK
)

251  
SLSI_MIB_TYPE_INT
;

253 ià((
bufãr
[0] & 
SLSI_MIB_MORE_MASK
) &&

254 (
bufãr
[0] & 
SLSI_MIB_TYPE_MASK
)) {

255 
size_t
 
i
;

256 
size_t
 
oid_Ëngth_v®ue
 = 0;

258 
i
 = 0; i < *
Ëngth
; i++) {

259 
oid_Ëngth_v®ue
 = (oid_length_value << 8);

260 
oid_Ëngth_v®ue
 |ğ
bufãr
[1 + 
i
];

262 *
Ëngth
 +ğ
oid_Ëngth_v®ue
;

263  
SLSI_MIB_TYPE_OCTET
;

265  
SLSI_MIB_TYPE_UINT
;

266 
	}
}

268 
size_t
 
	$¦si_mib_’code_psid_šdexs
(
u8
 *
bufãr
, cÚ¡ 
¦si_mib_g‘_’Œy
 *
v®ue
)

270 
size_t
 
i
;

271 
šdex
 = 0;

273 
	`SLSI_U16_TO_BUFF_LE
(
v®ue
->
psid
, &
bufãr
[0]);

274 
bufãr
[2] = 0;

275 
bufãr
[3] = 0;

276 
i
 = 0; i < 
SLSI_MIB_MAX_INDEXES
 && 
v®ue
->
šdex
[i] != 0; i++) {

278 
šdex
 = 4 + 
bufãr
[2];

279 ià(
šdex
 < 13)

280 
bufãr
[2] +ğ(
u8
)
	`¦si_mib_’code_ušt32
(&bufãr[
šdex
], 
v®ue
->šdex[
i
]);

283 ià(
bufãr
[2] % 2 == 1) {

289 
šdex
 = 4 + 
bufãr
[2];

291 ià(
šdex
 < 13) {

292 
bufãr
[
šdex
] = 0x00;

293  5 + 
bufãr
[2];

297  4 + 
bufãr
[2];

298 
	}
}

300 
u16
 
	$¦si_mib_’code
(
¦si_mib_d©a
 *
bufãr
, 
¦si_mib_’Œy
 *
v®ue
)

302 
size_t
 
i
;

303 
size_t
 
»quœed_size
 = (size_t)(5U + (5U * 
SLSI_MIB_MAX_INDEXES
) +

304 (
v®ue
->v®ue.
ty³
 =ğ
SLSI_MIB_TYPE_OCTET
 ? v®ue->v®ue.
u
.
où‘V®ue
.
d©aL’gth
 : 5U));

305 
size_t
 
’coded_Ëngth
 = 4;

307 
u8
 *
tmp_bufãr
 = 
	`km®loc
(
»quœed_size
, 
GFP_KERNEL
);

309 ià(!
tmp_bufãr
) {

310 
	`SLSI_ERR_NODEV
("km®loc(%dèçed\n", ()
»quœed_size
);

311  
SLSI_MIB_STATUS_FAILURE
;

314 
	`SLSI_U16_TO_BUFF_LE
(
v®ue
->
psid
, &
tmp_bufãr
[0]);

315 
tmp_bufãr
[2] = 0;

316 
tmp_bufãr
[3] = 0;

317 
i
 = 0; i < 
SLSI_MIB_MAX_INDEXES
 && 
v®ue
->
šdex
[i] != 0; i++)

318 
tmp_bufãr
[2] +ğ(
u8
)
	`¦si_mib_’code_ušt32
(&tmp_bufãr[4 +mp_bufãr[2]], 
v®ue
->
šdex
[
i
]);

319 
’coded_Ëngth
 +ğ
tmp_bufãr
[2];

321 
v®ue
->v®ue.
ty³
) {

322 
SLSI_MIB_TYPE_UINT
:

323 
’coded_Ëngth
 +ğ
	`¦si_mib_’code_ušt32
(&
tmp_bufãr
[’coded_Ëngth], 
v®ue
->v®ue.
u
.
uštV®ue
);

325 
SLSI_MIB_TYPE_INT
:

326 
’coded_Ëngth
 +ğ
	`¦si_mib_’code_št32
(&
tmp_bufãr
[’coded_Ëngth], 
v®ue
->v®ue.
u
.
štV®ue
);

328 
SLSI_MIB_TYPE_OCTET
:

329 
’coded_Ëngth
 +ğ
	`¦si_mib_’code_où‘_¡r
(&
tmp_bufãr
[’coded_Ëngth], &
v®ue
->v®ue.
u
.
où‘V®ue
);

331 
SLSI_MIB_TYPE_BOOL
:

332 
’coded_Ëngth
 +ğ
	`¦si_mib_’code_ušt32
(&
tmp_bufãr
[’coded_Ëngth], 
v®ue
->v®ue.
u
.
boŞV®ue
 ? 
Œue
 : 
çl£
);

334 
SLSI_MIB_TYPE_NONE
:

337 
	`SLSI_WARN_NODEV
("Inv®id Ty³:%d„eque¡ed\n", 
v®ue
->v®ue.
ty³
);

338 
	`kä“
(
tmp_bufãr
);

339  
SLSI_MIB_STATUS_FAILURE
;

342 
	`SLSI_U16_TO_BUFF_LE
(
’coded_Ëngth
 - 4, &
tmp_bufãr
[2]);

344 ià(
’coded_Ëngth
 % 2 == 1) {

350 
tmp_bufãr
[
’coded_Ëngth
] = 0x00;

351 
’coded_Ëngth
++;

354 
	`¦si_mib_buf_­³nd
(
bufãr
, 
’coded_Ëngth
, 
tmp_bufãr
);

355 
	`kä“
(
tmp_bufãr
);

357  
SLSI_MIB_STATUS_SUCCESS
;

358 
	}
}

360 
size_t
 
	$¦si_mib_decode
(
¦si_mib_d©a
 *
d©a
, 
¦si_mib_’Œy
 *
v®ue
)

362 
u8
 *
bufãr
 = 
d©a
->data;

363 
u32
 
bufãr_Ëngth
 = 
d©a
->
d©aL’gth
;

364 
size_t
 
šdex_couÁ
 = 0;

365 
u32
 
Ëngth
;

366 
size_t
 
decoded_Ëngth
 = 4;

368 
	`mem£t
(
v®ue
, 0x00, (
¦si_mib_’Œy
));

370 ià(
bufãr_Ëngth
 < 4) {

371 
	`SLSI_WARN_NODEV
("Mib DecodL’gth:%d Mu¡ bg»©”hª 4\n", 
bufãr_Ëngth
);

375 ià(!
bufãr
)

378 
Ëngth
 = 
	`SLSI_BUFF_LE_TO_U16
(&
bufãr
[2]);

380 ià(
bufãr_Ëngth
 < 
decoded_Ëngth
 + 
Ëngth
) {

381 
	`SLSI_ERR_NODEV
("Mib Bufã¸L’gth:%d Mu¡ b>ğthª decoded†’gth:%d\n", 
bufãr_Ëngth
, ()(
decoded_Ëngth
 + 
Ëngth
));

385 
v®ue
->
psid
 = 
	`SLSI_BUFF_LE_TO_U16
(
bufãr
);

386 
v®ue
->v®ue.
ty³
 = 
SLSI_MIB_TYPE_NONE
;

388 
decoded_Ëngth
 < 4 + 
Ëngth
) {

389 
size_t
 
Ãxt_v®ue_Ëngth
;

390 
u8
 
ty³
 = 
	`¦si_mib_decode_ty³_Ëngth
(&
bufãr
[
decoded_Ëngth
], &
Ãxt_v®ue_Ëngth
);

392 ià(
bufãr_Ëngth
 < 
decoded_Ëngth
 + 
Ãxt_v®ue_Ëngth
) {

393 
	`SLSI_ERR_NODEV
("Mib Bufã¸L’gth:%d Mu¡ b>ğthª decoded†’gth:%d\n", 
bufãr_Ëngth
, ()(
decoded_Ëngth
 + 
Ãxt_v®ue_Ëngth
));

394 
	`mem£t
(
v®ue
, 0x00, (
¦si_mib_’Œy
));

398 
ty³
) {

399 
SLSI_MIB_TYPE_UINT
:

401 
u32
 
v
;

403 
decoded_Ëngth
 +ğ
	`¦si_mib_decode_ušt32
(&
bufãr
[decoded_Ëngth], &
v
);

407 ià((
decoded_Ëngth
 < 4 + 
Ëngth
) &&

408 (
šdex_couÁ
 !ğ
SLSI_MIB_MAX_INDEXES
)) {

409 
v®ue
->
šdex
[
šdex_couÁ
] = (
u16
)
v
;

410 
šdex_couÁ
++;

412 
v®ue
->v®ue.
ty³
 =ype;

413 
v®ue
->v®ue.
u
.
uštV®ue
 = 
v
;

414 ià(
decoded_Ëngth
 !ğ4 + 
Ëngth
)

415 
	`SLSI_WARN_NODEV
("UšˆDecodËngth:%d !ğex³ùed:%d\n", (
u32
)
decoded_Ëngth
, (u32)(4 + 
Ëngth
));

419 
SLSI_MIB_TYPE_INT
:

420 
v®ue
->v®ue.
ty³
 =ype;

421 
decoded_Ëngth
 +ğ
	`¦si_mib_decodeIÁ32
(&
bufãr
[decoded_Ëngth], &
v®ue
->v®ue.
u
.
štV®ue
);

422 ià(
decoded_Ëngth
 !ğ4 + 
Ëngth
)

423 
	`SLSI_WARN_NODEV
("IÁ DecodËngth:%d !ğex³ùed:%d\n", (
u32
)
decoded_Ëngth
, (u32)(4 + 
Ëngth
));

425 
SLSI_MIB_TYPE_OCTET
:

426 
v®ue
->v®ue.
ty³
 =ype;

427 
decoded_Ëngth
 +ğ
	`¦si_mib_decode_où‘_¡r
(&
bufãr
[decoded_Ëngth], &
v®ue
->v®ue.
u
.
où‘V®ue
);

428 ià(
decoded_Ëngth
 !ğ4 + 
Ëngth
)

429 
	`SLSI_WARN_NODEV
("Où‘ DecodËngth:%d !ğex³ùed:%d\n", (
u32
)
decoded_Ëngth
, (u32)(4 + 
Ëngth
));

432 
	`SLSI_ERR_NODEV
("Inv®id MIB d©¨ty³(%d). PossibË mbulk cÜru±iÚ\n", 
ty³
);

433 
	`mem£t
(
v®ue
, 0x00, (
¦si_mib_’Œy
));

434 
v®ue
->v®ue.
ty³
 = 
SLSI_MIB_TYPE_NONE
;

438 ià(
Ëngth
 % 2 == 1) {

444 ià(
bufãr
[
decoded_Ëngth
] != 0x00)

445 
	`SLSI_WARN_NODEV
("psid:0x%.4X Paddšg NÙ D‘eùed\n", 
v®ue
->
psid
);

446 
Ëngth
++;

448  4 + 
Ëngth
;

449 
	}
}

451 
	$¦si_mib_’code_g‘_li¡
(
¦si_mib_d©a
 *
bufãr
, 
u16
 
psids_Ëngth
, cÚ¡ 
¦si_mib_g‘_’Œy
 *
psids
)

453 
size_t
 
i
;

455 
bufãr
->
d©aL’gth
 = 0;

457 
bufãr
->
d©a
 = 
	`km®loc
((
u32
)(
psids_Ëngth
 * 13), 
GFP_KERNEL
);

458 ià(!
bufãr
->
d©a
) {

459 
	`SLSI_ERR_NODEV
("km®loc(%dèçed\n", 
psids_Ëngth
 * 13);

460  
SLSI_MIB_STATUS_OUT_OF_MEMORY
;

462 
i
 = 0; i < 
psids_Ëngth
; i++)

463 
bufãr
->
d©aL’gth
 +ğ(
u16
)
	`¦si_mib_’code_psid_šdexs
(&bufãr->
d©a
[bufãr->d©aL’gth], &
psids
[
i
]);

465  
SLSI_MIB_STATUS_SUCCESS
;

466 
	}
}

468 
	$¦si_mib_’code_g‘
(
¦si_mib_d©a
 *
bufãr
, 
u16
 
psid
, u16 
idx
)

471 
size_t
 
size
;

472 
u8
 
tmp_bufãr
[13];

473 
¦si_mib_g‘_’Œy
 
’Œy
;

475 
	`mem£t
(&
’Œy
, 0x00, (
¦si_mib_g‘_’Œy
));

476 
’Œy
.
psid
 =…sid;

477 
’Œy
.
šdex
[0] = 
idx
;

478 
size
 = 
	`¦si_mib_’code_psid_šdexs
(
tmp_bufãr
, &
’Œy
);

479 
	`¦si_mib_buf_­³nd
(
bufãr
, 
size
, 
tmp_bufãr
);

480 
	}
}

482 
u8
 *
	$¦si_mib_fšd
(
¦si_mib_d©a
 *
bufãr
, cÚ¡ 
¦si_mib_g‘_’Œy
 *
’Œy
)

484 
size_t
 
bufãr_Ëngth
 = 
bufãr
->
d©aL’gth
;

485 
u8
 *
buff
 = 
bufãr
->
d©a
;

487 ià(
bufãr_Ëngth
 % 2 == 1) {

488 
	`SLSI_WARN_NODEV
("bufãr_Ëngth(%dè%% 2 !ğ0 (Inv®id Mib d©¨D‘eùed)\n", ()
bufãr_Ëngth
);

489  
NULL
;

491 
bufãr_Ëngth
 >= 4) {

492 
u16
 
psid
 = 
	`SLSI_BUFF_LE_TO_U16
(
buff
);

493 
size_t
 
Ëngth
 = 4U + 
	`SLSI_BUFF_LE_TO_U16
(&
buff
[2]);

495 ià(
’Œy
->
psid
 ==…sid) {

496 
size_t
 
i
;

497 
u32
 
idx
;

498 
size_t
 
by‹s_»ad
 = 0;

500 
i
 = 0; i < 
SLSI_MIB_MAX_INDEXES
; i++) {

501 ià(!
’Œy
->
šdex
[
i
])

502  
buff
;

503 
by‹s_»ad
 = 
	`¦si_mib_decode_ušt32
(&
buff
[4 + by‹s_»ad], &
idx
);

504 ià(
’Œy
->
šdex
[
i
] !ğ
idx
)

507 ià(
i
 =ğ
SLSI_MIB_MAX_INDEXES
)

508  
buff
;

510 ià(
Ëngth
 % 2 == 1)

516 
Ëngth
++;

518 
buff
 +ğ
Ëngth
;

519 
bufãr_Ëngth
 -ğ
Ëngth
;

522  
NULL
;

523 
	}
}

525 
¦si_mib_v®ue
 *
	$¦si_mib_decode_g‘_li¡
(
¦si_mib_d©a
 *
bufãr
, 
u16
 
psids_Ëngth
, cÚ¡ 
¦si_mib_g‘_’Œy
 *
psids
)

527 
¦si_mib_v®ue
 *
»suÉs
 = 
	`km®loc_¬¿y
((
size_t
)
psids_Ëngth
, (¦si_mib_v®ue), 
GFP_KERNEL
);

528 
size_t
 
i
, 
mib_decode_Ën
 = 0;

529 
Ën
 = 0;

530 
psids_nÙ_found
[150] = "";

532 ià(!
»suÉs
) {

533 
	`SLSI_ERR_NODEV
("km®loc(%dèçed\n", ()((
¦si_mib_v®ue
è* 
psids_Ëngth
));

534  
»suÉs
;

537 
i
 = 0; i < 
psids_Ëngth
; i++) {

538 
¦si_mib_’Œy
 
v®ue
;

539 
¦si_mib_d©a
 
d©a
;

541 
d©a
.d©¨ğ
	`¦si_mib_fšd
(
bufãr
, &
psids
[
i
]);

542 ià(
d©a
.data) {

543 
d©a
.
d©aL’gth
 = 
bufãr
->dataLength - (data.data - buffer->data);

544 
v®ue
.
psid
 = 
psids
[
i
].psid;

545 
	`memıy
(
v®ue
.
šdex
, 
psids
[
i
].index, (value.index));

546 
mib_decode_Ën
 = 
	`¦si_mib_decode
(&
d©a
, &
v®ue
);

547 ià(
mib_decode_Ën
 == 0)

548 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "Mib decod”rÜ fÜ…sid %d\n", 
v®ue
.
psid
);

550 
»suÉs
[
i
] = 
v®ue
.value;

552 
Ën
 +ğ
	`¢´štf
(&
psids_nÙ_found
[0] +†’, 150 -†’, "%d ", 
psids
[
i
].
psid
);

553 
»suÉs
[
i
].
ty³
 = 
SLSI_MIB_TYPE_NONE
;

557 ià(
Ën
)

558 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "Could‚Ù fšd…sid's: %s\n", 
psids_nÙ_found
);

560  
»suÉs
;

561 
	}
}

563 
u16
 
	$¦si_mib_’code_boŞ
(
¦si_mib_d©a
 *
bufãr
, 
u16
 
psid
, 
boŞ
 
v®ue
, u16 
idx
)

565 
¦si_mib_’Œy
 
v
;

567 
	`mem£t
(&
v
, 0x00, (
¦si_mib_’Œy
));

568 
v
.
psid
 =…sid;

569 
v
.
šdex
[0] = 
idx
;

570 
v
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_BOOL
;

571 
v
.
v®ue
.
u
.
boŞV®ue
 = value;

572  
	`¦si_mib_’code
(
bufãr
, &
v
);

573 
	}
}

575 
u16
 
	$¦si_mib_’code_št
(
¦si_mib_d©a
 *
bufãr
, 
u16
 
psid
, 
s32
 
v®ue
, u16 
idx
)

577 
¦si_mib_’Œy
 
v
;

579 
	`mem£t
(&
v
, 0x00, (
¦si_mib_’Œy
));

580 
v
.
psid
 =…sid;

581 
v
.
šdex
[0] = 
idx
;

582 
v
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_INT
;

583 
v
.
v®ue
.
u
.
štV®ue
 = value;

584  
	`¦si_mib_’code
(
bufãr
, &
v
);

585 
	}
}

587 
u16
 
	$¦si_mib_’code_ušt
(
¦si_mib_d©a
 *
bufãr
, 
u16
 
psid
, 
u32
 
v®ue
, u16 
idx
)

589 
¦si_mib_’Œy
 
v
;

591 
	`mem£t
(&
v
, 0x00, (
¦si_mib_’Œy
));

592 
v
.
psid
 =…sid;

593 
v
.
šdex
[0] = 
idx
;

594 
v
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_UINT
;

595 
v
.
v®ue
.
u
.
uštV®ue
 = value;

596  
	`¦si_mib_’code
(
bufãr
, &
v
);

597 
	}
}

599 
u16
 
	$¦si_mib_’code_où‘
(
¦si_mib_d©a
 *
bufãr
, 
u16
 
psid
, 
size_t
 
d©aL’gth
, cÚ¡ 
u8
 *
d©a
, u16 
idx
)

601 
¦si_mib_’Œy
 
v
;

603 
	`mem£t
(&
v
, 0x00, (
¦si_mib_’Œy
));

604 
v
.
psid
 =…sid;

605 
v
.
šdex
[0] = 
idx
;

606 
v
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_OCTET
;

607 
v
.
v®ue
.
u
.
où‘V®ue
.
d©aL’gth
 = (
u32
)dataLength;

608 
v
.
v®ue
.
u
.
où‘V®ue
.
d©a
 = (
u8
 *)data;

609  
	`¦si_mib_’code
(
bufãr
, &
v
);

610 
	}
}

	@mib.h

9 #iâdeà
SLSI_MIB_H__


10 
	#SLSI_MIB_H__


	)

12 #ifdeà
__ılu¥lus


16 
	s¦si_mib_d©a
 {

17 
u32
 
d©aL’gth
;

18 
u8
 *
d©a
;

21 
	#SLSI_MIB_MAX_INDEXES
 2U

	)

23 
	#SLSI_MIB_TYPE_BOOL
 0

	)

24 
	#SLSI_MIB_TYPE_UINT
 1

	)

25 
	#SLSI_MIB_TYPE_INT
 2

	)

26 
	#SLSI_MIB_TYPE_OCTET
 3U

	)

27 
	#SLSI_MIB_TYPE_NONE
 4

	)

29 
	s¦si_mib_v®ue
 {

30 
u8
 
ty³
;

32 
boŞ
 
boŞV®ue
;

33 
s32
 
štV®ue
;

34 
u32
 
uštV®ue
;

35 
¦si_mib_d©a
 
où‘V®ue
;

36 } 
u
;

39 
	s¦si_mib_’Œy
 {

40 
u16
 
psid
;

41 
u16
 
šdex
[
SLSI_MIB_MAX_INDEXES
];

42 
¦si_mib_v®ue
 
v®ue
;

45 
	s¦si_mib_g‘_’Œy
 {

46 
u16
 
psid
;

47 
u16
 
šdex
[
SLSI_MIB_MAX_INDEXES
];

50 
	#SLSI_MIB_STATUS_SUCCESS
 0x0000

	)

51 
	#SLSI_MIB_STATUS_UNKNOWN_PSID
 0x0001

	)

52 
	#SLSI_MIB_STATUS_INVALID_INDEX
 0x0002

	)

53 
	#SLSI_MIB_STATUS_OUT_OF_RANGE
 0x0003

	)

54 
	#SLSI_MIB_STATUS_WRITE_ONLY
 0x0004

	)

55 
	#SLSI_MIB_STATUS_READ_ONLY
 0x0005

	)

56 
	#SLSI_MIB_STATUS_UNKNOWN_INTERFACE_TAG
 0x0006

	)

57 
	#SLSI_MIB_STATUS_INVALID_NUMBER_OF_INDICES
 0x0007

	)

58 
	#SLSI_MIB_STATUS_ERROR
 0x0008

	)

59 
	#SLSI_MIB_STATUS_UNSUPPORTED_ON_INTERFACE
 0x0009

	)

60 
	#SLSI_MIB_STATUS_UNAVAILABLE
 0x000A

	)

61 
	#SLSI_MIB_STATUS_NOT_FOUND
 0x000B

	)

62 
	#SLSI_MIB_STATUS_INCOMPATIBLE
 0x000C

	)

63 
	#SLSI_MIB_STATUS_OUT_OF_MEMORY
 0x000D

	)

64 
	#SLSI_MIB_STATUS_TO_MANY_REQUESTED_VARIABLES
 0x000E

	)

65 
	#SLSI_MIB_STATUS_NOT_TRIED
 0x000F

	)

66 
	#SLSI_MIB_STATUS_FAILURE
 0xFFFF

	)

100 
¦si_mib_’code_g‘
(
¦si_mib_d©a
 *
bufãr
, 
u16
 
psid
, u16 
šdex
);

101 
¦si_mib_’code_g‘_li¡
(
¦si_mib_d©a
 *
bufãr
, 
u16
 
psidsL’gth
, cÚ¡ 
¦si_mib_g‘_’Œy
 *
psids
);

146 
size_t
 
¦si_mib_decode
(
¦si_mib_d©a
 *
bufãr
, 
¦si_mib_’Œy
 *
v®ue
);

147 
¦si_mib_v®ue
 *
¦si_mib_decode_g‘_li¡
(
¦si_mib_d©a
 *
bufãr
, 
u16
 
psidsL’gth
, cÚ¡ 
¦si_mib_g‘_’Œy
 *
psids
);

185 
u16
 
¦si_mib_’code
(
¦si_mib_d©a
 *
bufãr
, 
¦si_mib_’Œy
 *
v®ue
);

186 
u16
 
¦si_mib_’code_boŞ
(
¦si_mib_d©a
 *
bufãr
, u16 
psid
, 
boŞ
 
v®ue
, u16 
šdex
);

187 
u16
 
¦si_mib_’code_št
(
¦si_mib_d©a
 *
bufãr
, u16 
psid
, 
s32
 
v®ue
, u16 
šdex
);

188 
u16
 
¦si_mib_’code_ušt
(
¦si_mib_d©a
 *
bufãr
, u16 
psid
, 
u32
 
v®ue
, u16 
šdex
);

189 
u16
 
¦si_mib_’code_où‘
(
¦si_mib_d©a
 *
bufãr
, u16 
psid
, 
size_t
 
d©aL’gth
, cÚ¡ 
u8
 *
d©a
, u16 
šdex
);

197 
size_t
 
¦si_mib_’code_ušt32
(
u8
 *
bufãr
, 
u32
 
v®ue
);

198 
size_t
 
¦si_mib_’code_št32
(
u8
 *
bufãr
, 
s32
 
sigÃdV®ue
);

199 
size_t
 
¦si_mib_’code_où‘_¡r
(
u8
 *
bufãr
, 
¦si_mib_d©a
 *
où‘V®ue
);

201 
size_t
 
¦si_mib_decodeUšt32
(
u8
 *
bufãr
, 
u32
 *
v®ue
);

202 
size_t
 
¦si_mib_decodeIÁ32
(
u8
 *
bufãr
, 
s32
 *
v®ue
);

203 
size_t
 
¦si_mib_decodeUšt64
(
u8
 *
bufãr
, 
u64
 *
v®ue
);

204 
size_t
 
¦si_mib_decodeIÁ64
(
u8
 *
bufãr
, 
s64
 *
v®ue
);

205 
size_t
 
¦si_mib_decode_où‘_¡r
(
u8
 *
bufãr
, 
¦si_mib_d©a
 *
où‘V®ue
);

222 
u8
 *
¦si_mib_fšd
(
¦si_mib_d©a
 *
bufãr
, cÚ¡ 
¦si_mib_g‘_’Œy
 *
’Œy
);

225 
¦si_mib_buf_­³nd
(
¦si_mib_d©a
 *
d¡
, 
size_t
 
bufãrL’gth
, 
u8
 *
bufãr
);

246 
	#SLSI_PSID_DOT11_TDLS_PEER_UAPSD_INDICATION_WINDOW
 0x0035

	)

260 
	#SLSI_PSID_DOT11_ASSOCIATION_SA_QUERY_MAXIMUM_TIMEOUT
 0x0064

	)

273 
	#SLSI_PSID_DOT11_ASSOCIATION_SA_QUERY_RETRY_TIMEOUT
 0x0065

	)

287 
	#SLSI_PSID_DOT11_MIN_POWER_CAPABILITY_OVERRIDE
 0x0071

	)

301 
	#SLSI_PSID_DOT11_MAX_NETWORK_POWER_CAPABILITY_OVERRIDE
 0x0072

	)

325 
	#SLSI_PSID_DOT11_RTS_THRESHOLD
 0x0079

	)

340 
	#SLSI_PSID_DOT11_SHORT_RETRY_LIMIT
 0x007A

	)

355 
	#SLSI_PSID_DOT11_LONG_RETRY_LIMIT
 0x007B

	)

379 
	#SLSI_PSID_DOT11_FRAGMENTATION_THRESHOLD
 0x007C

	)

396 
	#SLSI_PSID_DOT11_TXOP_DURATION_RTS_THRESHOLD
 0x007D

	)

410 
	#SLSI_PSID_DOT11_RTS_SUCCESS_COUNT
 0x0092

	)

423 
	#SLSI_PSID_DOT11_ACK_FAILURE_COUNT
 0x0094

	)

437 
	#SLSI_PSID_DOT11_MULTICAST_RECEIVED_FRAME_COUNT
 0x0096

	)

451 
	#SLSI_PSID_DOT11_FCS_ERROR_COUNT
 0x0097

	)

468 
	#SLSI_PSID_DOT11_WEP_UNDECRYPTABLE_COUNT
 0x0099

	)

482 
	#SLSI_PSID_DOT11_MANUFACTURER_PRODUCT_VERSION
 0x00B7

	)

496 
	#SLSI_PSID_DOT11_RSNA_STATS_STA_ADDRESS
 0x01AE

	)

510 
	#SLSI_PSID_DOT11_RSNA_STATS_TKIPICV_ERRORS
 0x01B1

	)

524 
	#SLSI_PSID_DOT11_RSNA_STATS_TKIP_LOCAL_MIC_FAILURES
 0x01B2

	)

538 
	#SLSI_PSID_DOT11_RSNA_STATS_TKIP_REMOTE_MIC_FAILURES
 0x01B3

	)

551 
	#SLSI_PSID_DOT11_RSNA_STATS_CCMP_REPLAYS
 0x01B4

	)

564 
	#SLSI_PSID_DOT11_RSNA_STATS_CCMP_DECRYPT_ERRORS
 0x01B5

	)

577 
	#SLSI_PSID_DOT11_RSNA_STATS_TKIP_REPLAYS
 0x01B6

	)

591 
	#SLSI_PSID_DOT11_RSNA_STATS_ROBUST_MGMT_CCMP_REPLAYS
 0x01B9

	)

604 
	#SLSI_PSID_UNIFI_MLME_CONNECTION_TIMEOUT
 0x07D0

	)

617 
	#SLSI_PSID_UNIFI_MLME_SCAN_CHANNEL_MAX_SCAN_TIME
 0x07D1

	)

630 
	#SLSI_PSID_UNIFI_MLME_SCAN_CHANNEL_PROBE_INTERVAL
 0x07D2

	)

643 
	#SLSI_PSID_UNIFI_MLME_SCAN_CHANNEL_RULE
 0x07D3

	)

658 
	#SLSI_PSID_UNIFI_MLME_DATA_REFERENCE_TIMEOUT
 0x07D5

	)

671 
	#SLSI_PSID_UNIFI_MLME_SCAN_PROBE_INTERVAL
 0x07D7

	)

684 
	#SLSI_PSID_UNIFI_MLME_SCAN_HIGH_RSSI_THRESHOLD
 0x07D8

	)

698 
	#SLSI_PSID_UNIFI_MLME_SCAN_DELTA_RSSI_THRESHOLD
 0x07DA

	)

711 
	#SLSI_PSID_UNIFI_MLME_SCAN_MAXIMUM_AGE
 0x07DE

	)

726 
	#SLSI_PSID_UNIFI_MLME_SCAN_MAXIMUM_RESULTS
 0x07DF

	)

739 
	#SLSI_PSID_UNIFI_MLME_AUTONOMOUS_SCAN_NOISY
 0x07E0

	)

753 
	#SLSI_PSID_UNIFI_CHANNEL_BUSY_THRESHOLD
 0x07E2

	)

768 
	#SLSI_PSID_UNIFI_MAC_SEQUENCE_NUMBER_RANDOMISATION_ACTIVATED
 0x07E4

	)

783 
	#SLSI_PSID_UNIFI_FIRMWARE_BUILD_ID
 0x07E5

	)

799 
	#SLSI_PSID_UNIFI_CHIP_VERSION
 0x07E6

	)

816 
	#SLSI_PSID_UNIFI_FIRMWARE_PATCH_BUILD_ID
 0x07E7

	)

831 
	#SLSI_PSID_UNIFI_EXTENDED_CAPABILITIES_SOFT_AP
 0x07E8

	)

848 
	#SLSI_PSID_UNIFI_MAX_NUM_ANTENNA_TO_USE
 0x07E9

	)

861 
	#SLSI_PSID_UNIFI_HT_CAPABILITIES5G
 0x07EA

	)

874 
	#SLSI_PSID_UNIFI_VHT_CAPABILITIES5G
 0x07EB

	)

890 
	#SLSI_PSID_UNIFI_HT_CAPABILITIES_SOFT_AP
 0x07EC

	)

903 
	#SLSI_PSID_UNIFI_SOFT_AP40_MHZ_ON24G
 0x07ED

	)

917 
	#SLSI_PSID_UNIFI_BASIC_CAPABILITIES
 0x07EE

	)

932 
	#SLSI_PSID_UNIFI_EXTENDED_CAPABILITIES
 0x07EF

	)

947 
	#SLSI_PSID_UNIFI_HT_CAPABILITIES
 0x07F0

	)

960 
	#SLSI_PSID_UNIFI_RSN_CAPABILITIES
 0x07F2

	)

973 
	#SLSI_PSID_UNIFI24_G40_MHZ_CHANNELS
 0x07F3

	)

988 
	#SLSI_PSID_UNIFI_EXTENDED_CAPABILITIES_DISABLED
 0x07F4

	)

1005 
	#SLSI_PSID_UNIFI_SUPPORTED_DATA_RATES
 0x07F9

	)

1018 
	#SLSI_PSID_UNIFI_RADIO_MEASUREMENT_ACTIVATED
 0x07FB

	)

1032 
	#SLSI_PSID_UNIFI_RADIO_MEASUREMENT_CAPABILITIES
 0x07FC

	)

1045 
	#SLSI_PSID_UNIFI_VHT_ACTIVATED
 0x07FD

	)

1058 
	#SLSI_PSID_UNIFI_HT_ACTIVATED
 0x07FE

	)

1072 
	#SLSI_PSID_UNIFI_ENABLE_TWO_SIMULTANEOUS_PASSIVE_SCANS_SAME_BAND
 0x07FF

	)

1085 
	#SLSI_PSID_UNIFI_PL_M689_WORKAROUND_TRIGGER_ARP_COUNT
 0x0800

	)

1098 
	#SLSI_PSID_UNIFI_ROAMING_ACTIVATED
 0x0801

	)

1112 
	#SLSI_PSID_UNIFI_ROAM_RSSI_SCAN_TRIGGER
 0x0802

	)

1127 
	#SLSI_PSID_UNIFI_ROAM_CU_SCAN_TRIGGER_HYSTERESIS
 0x0803

	)

1141 
	#SLSI_PSID_UNIFI_ROAM_BACKGROUND_SCAN_PERIOD
 0x0804

	)

1156 
	#SLSI_PSID_UNIFI_ROAM_NCHO_FULL_SCAN_PERIOD
 0x0805

	)

1169 
	#SLSI_PSID_UNIFI_ROAM_SOFT_ROAMING_ENABLED
 0x0806

	)

1183 
	#SLSI_PSID_UNIFI_ROAM_SCAN_BAND
 0x0807

	)

1199 
	#SLSI_PSID_UNIFI_ROAM_CU_RSSI_SCAN_TRIGGER_HYSTERESIS
 0x0808

	)

1213 
	#SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_MAX_ACTIVE_CHANNEL_TIME
 0x0809

	)

1227 
	#SLSI_PSID_UNIFI_ROAM_RE_SCAN_PERIOD
 0x080A

	)

1241 
	#SLSI_PSID_UNIFI_ROAM_INACTIVE_SCAN_PERIOD
 0x080B

	)

1256 
	#SLSI_PSID_UNIFI_ROAM_MODE
 0x080C

	)

1272 
	#SLSI_PSID_UNIFI_ROAM_RSSI_SCAN_TRIGGER_RESET
 0x080D

	)

1287 
	#SLSI_PSID_UNIFI_ROAM_RSSI_SCAN_TRIGGER_STEP
 0x080E

	)

1302 
	#SLSI_PSID_UNIFI_ROAM_IDLE_VARIATION_RSSI
 0x080F

	)

1317 
	#SLSI_PSID_UNIFI_ROAM_IDLE_MIN_RSSI
 0x0810

	)

1331 
	#SLSI_PSID_UNIFI_ROAM_EAP_TIMEOUT
 0x0811

	)

1346 
	#SLSI_PSID_UNIFI_ROAM_IDLE_INACTIVE_TIME
 0x0812

	)

1360 
	#SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_CONTROL
 0x0813

	)

1374 
	#SLSI_PSID_UNIFI_ROAM_NCHO_DFS_SCAN_MODE
 0x0814

	)

1388 
	#SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_HOME_TIME
 0x0815

	)

1402 
	#SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_HOME_AWAY_TIME
 0x0816

	)

1416 
	#SLSI_PSID_UNIFI_ROAM_IDLE_INACTIVE_COUNT
 0x0817

	)

1429 
	#SLSI_PSID_UNIFI_ROAM_NCHO_SCAN_NPROBE
 0x0818

	)

1443 
	#SLSI_PSID_UNIFI_ROAM_IDLE_BAND
 0x0819

	)

1458 
	#SLSI_PSID_UNIFI_ROAM_IDLE_AP_SELECT_DELTA_FACTOR
 0x081A

	)

1473 
	#SLSI_PSID_UNIFI_ROAM_NCHO_RSSI_DELTA
 0x081B

	)

1488 
	#SLSI_PSID_UNIFI_AP_OLBC_DURATION
 0x081C

	)

1504 
	#SLSI_PSID_UNIFI_AP_OLBC_INTERVAL
 0x081D

	)

1517 
	#SLSI_PSID_UNIFI_DNS_SUPPORT_ACTIVATED
 0x081E

	)

1531 
	#SLSI_PSID_UNIFI_OFFCHANNEL_PROCEDURE_TIMEOUT
 0x081F

	)

1545 
	#SLSI_PSID_UNIFI_FRAME_RESPONSE_TIMEOUT
 0x0820

	)

1558 
	#SLSI_PSID_UNIFI_CONNECTION_FAILURE_TIMEOUT
 0x0821

	)

1572 
	#SLSI_PSID_UNIFI_CONNECTING_PROBE_TIMEOUT
 0x0822

	)

1590 
	#SLSI_PSID_UNIFI_DISCONNECT_TIMEOUT
 0x0823

	)

1603 
	#SLSI_PSID_UNIFI_FRAME_RESPONSE_CFM_TX_LIFETIME_TIMEOUT
 0x0824

	)

1617 
	#SLSI_PSID_UNIFI_FRAME_RESPONSE_CFM_FAILURE_TIMEOUT
 0x0825

	)

1631 
	#SLSI_PSID_UNIFI_FORCE_ACTIVE_DURATION
 0x0826

	)

1644 
	#SLSI_PSID_UNIFI_MLME_SCAN_MAX_NUMBER_OF_PROBE_SETS
 0x0827

	)

1658 
	#SLSI_PSID_UNIFI_MLME_SCAN_STOP_IF_LESS_THAN_XFRAMES
 0x0828

	)

1672 
	#SLSI_PSID_UNIFI_AP_ASSOCIATION_TIMEOUT
 0x0829

	)

1685 
	#SLSI_PSID_UNIFI_ROAMING_IN_P2P_ACTIVATED
 0x082A

	)

1698 
	#SLSI_PSID_UNIFI_HOST_NUM_ANTENNA_CONTROL_ACTIVATED
 0x082B

	)

1713 
	#SLSI_PSID_UNIFI_ROAM_NCHO_RSSI_TRIGGER
 0x082C

	)

1728 
	#SLSI_PSID_UNIFI_ROAM_NCHO_RSSI_TRIGGER_HYSTERESIS
 0x082D

	)

1741 
	#SLSI_PSID_UNIFI_PEER_BANDWIDTH
 0x082E

	)

1755 
	#SLSI_PSID_UNIFI_CURRENT_PEER_NSS
 0x082F

	)

1768 
	#SLSI_PSID_UNIFI_PEER_TX_DATA_RATE
 0x0830

	)

1781 
	#SLSI_PSID_UNIFI_PEER_RSSI
 0x0831

	)

1798 
	#SLSI_PSID_UNIFI_MLME_STATION_INACTIVITY_TIMEOUT
 0x0832

	)

1814 
	#SLSI_PSID_UNIFI_MLME_CLI_INACTIVITY_TIMEOUT
 0x0833

	)

1829 
	#SLSI_PSID_UNIFI_MLME_STATION_INITIAL_KICK_TIMEOUT
 0x0834

	)

1843 
	#SLSI_PSID_UNIFI_FRAME_RESPONSE_LONG_TIMEOUT
 0x0835

	)

1857 
	#SLSI_PSID_UNIFI_INITIAL_CONNECTION_FAILURE_TIMEOUT
 0x0836

	)

1871 
	#SLSI_PSID_UNIF_RETRY_AUTH_FOR_SPECIAL_APS
 0x0837

	)

1884 
	#SLSI_PSID_UNIFI_ASSOC_COMEBACK_TIMEOUT
 0x0838

	)

1898 
	#SLSI_PSID_UNIFI_UART_CONFIGURE
 0x083E

	)

1915 
	#SLSI_PSID_UNIFI_UART_PIOS
 0x083F

	)

1933 
	#SLSI_PSID_UNIFI_CRYSTAL_FREQUENCY_TRIM
 0x085D

	)

1950 
	#SLSI_PSID_UNIFI_ENABLE_DORM
 0x085E

	)

1970 
	#SLSI_PSID_UNIFI_EXTERNAL_CLOCK_DETECT
 0x0862

	)

1991 
	#SLSI_PSID_UNIFI_EXTERNAL_FAST_CLOCK_REQUEST
 0x0865

	)

2007 
	#SLSI_PSID_UNIFI_WATCHDOG_TIMEOUT
 0x0868

	)

2033 
	#SLSI_PSID_UNIFI_SCAN_PARAMETERS_PUBLIC
 0x0869

	)

2048 
	#SLSI_PSID_UNIFI_OVERRIDE_EDCA_PARAM_ACTIVATED
 0x086B

	)

2064 
	#SLSI_PSID_UNIFI_OVERRIDE_EDCA_PARAM
 0x086C

	)

2086 
	#SLSI_PSID_UNIFI_SCAN_PARAMETERS_PRIVATE
 0x086D

	)

2103 
	#SLSI_PSID_UNIFI_EXTERNAL_FAST_CLOCK_REQUEST_PIO
 0x086E

	)

2117 
	#SLSI_PSID_UNIFI_MODEM_DESENSE_ENABLED
 0x0870

	)

2134 
	#SLSI_PSID_UNIFI_MODEM_DESENSE_OFFSET
 0x0874

	)

2150 
	#SLSI_PSID_UNIFI_MODEM_DESENSE_CAP
 0x0875

	)

2167 
	#SLSI_PSID_UNIFI_MODEM_DESENSE_OFFSET5G
 0x0879

	)

2183 
	#SLSI_PSID_UNIFI_MODEM_DESENSE_CAP5G
 0x087A

	)

2199 
	#SLSI_PSID_UNIFI_MODEM_DESENSE_OPTION
 0x087B

	)

2214 
	#SLSI_PSID_UNIFI_RSSI_THRESHOLD_FOR_BBB_SYNC
 0x087C

	)

2233 
	#SLSI_PSID_UNIFI_RSSI_TYPE_TO_USE
 0x0891

	)

2247 
	#SLSI_PSID_UNIFI_NUM_RSSI_AVERAGE_SAMPLE
 0x0892

	)

2260 
	#SLSI_PSID_UNIFI_RX_DATA_RATE
 0x0894

	)

2273 
	#SLSI_PSID_UNIFI_PEER_RX_RETRY_COUNT
 0x0896

	)

2286 
	#SLSI_PSID_UNIFI_PEER_RX_MULTICAST_COUNT
 0x0897

	)

2307 
	#SLSI_PSID_UNIFI_RSSI
 0x0898

	)

2320 
	#SLSI_PSID_UNIFI_LAST_BSS_RSSI
 0x0899

	)

2334 
	#SLSI_PSID_UNIFI_SNR
 0x089A

	)

2347 
	#SLSI_PSID_UNIFI_LAST_BSS_SNR
 0x089B

	)

2362 
	#SLSI_PSID_UNIFI_SW_TX_TIMEOUT
 0x089C

	)

2377 
	#SLSI_PSID_UNIFI_HW_TX_TIMEOUT
 0x089D

	)

2392 
	#SLSI_PSID_UNIFI_RATE_STATS_RX_SUCCESS_COUNT
 0x089E

	)

2407 
	#SLSI_PSID_UNIFI_RATE_STATS_TX_SUCCESS_COUNT
 0x089F

	)

2422 
	#SLSI_PSID_UNIFI_TX_DATA_RATE
 0x08A0

	)

2439 
	#SLSI_PSID_UNIFI_SNR_EXTRA_OFFSET_CCK
 0x08A1

	)

2458 
	#SLSI_PSID_UNIFI_RSSI_MAX_AVERAGING_PERIOD
 0x08A2

	)

2472 
	#SLSI_PSID_UNIFI_RSSI_MIN_RECEIVED_FRAMES
 0x08A3

	)

2491 
	#SLSI_PSID_UNIFI_RATE_STATS_RATE
 0x08A4

	)

2504 
	#SLSI_PSID_UNIFI_LAST_BSS_TX_DATA_RATE
 0x08A5

	)

2528 
	#SLSI_PSID_UNIFI_DISCARDED_FRAME_COUNT
 0x08A6

	)

2542 
	#SLSI_PSID_UNIFI_MACRAME_DEBUG_STATS
 0x08A7

	)

2559 
	#SLSI_PSID_UNIFI_CURRENT_TSF_TIME
 0x08AA

	)

2573 
	#SLSI_PSID_UNIFI_BA_RX_ENABLE_TID
 0x08AB

	)

2588 
	#SLSI_PSID_UNIFI_BA_TX_ENABLE_TID
 0x08AD

	)

2602 
	#SLSI_PSID_UNIFI_TRAFFIC_THRESHOLD_TO_SETUP_BA
 0x08AE

	)

2616 
	#SLSI_PSID_UNIFI_DPLANE_TX_AMSDU_HW_CAPABILITY
 0x08AF

	)

2630 
	#SLSI_PSID_UNIFI_DPLANE_TX_AMSDU_SUBFRAME_COUNT_MAX
 0x08B0

	)

2645 
	#SLSI_PSID_UNIFI_BA_CONFIG
 0x08B1

	)

2658 
	#SLSI_PSID_UNIFI_BA_TX_MAX_NUMBER
 0x08B2

	)

2671 
	#SLSI_PSID_UNIFI_MOVE_BKTO_BE
 0x08B3

	)

2684 
	#SLSI_PSID_UNIFI_BEACON_RECEIVED
 0x08B4

	)

2699 
	#SLSI_PSID_UNIFI_AC_RETRIES
 0x08B5

	)

2713 
	#SLSI_PSID_UNIFI_RADIO_ON_TIME
 0x08B6

	)

2727 
	#SLSI_PSID_UNIFI_RADIO_TX_TIME
 0x08B7

	)

2741 
	#SLSI_PSID_UNIFI_RADIO_RX_TIME
 0x08B8

	)

2756 
	#SLSI_PSID_UNIFI_RADIO_SCAN_TIME
 0x08B9

	)

2770 
	#SLSI_PSID_UNIFI_PS_LEAKY_AP
 0x08BA

	)

2783 
	#SLSI_PSID_UNIFI_TQAM_ACTIVATED
 0x08BB

	)

2798 
	#SLSI_PSID_UNIFI_RADIO_ON_TIME_NAN
 0x08BC

	)

2811 
	#SLSI_PSID_UNIFI_PHY_EVENT_LOG_ENABLE
 0x08BE

	)

2825 
	#SLSI_PSID_UNIFI_OUTPUT_RADIO_INFO_TO_KERNEL_LOG
 0x08BF

	)

2839 
	#SLSI_PSID_UNIFI_NO_ACK_ACTIVATION_COUNT
 0x08C0

	)

2853 
	#SLSI_PSID_UNIFI_RX_FCS_ERROR_COUNT
 0x08C1

	)

2867 
	#SLSI_PSID_UNIFI_BEACONS_RECEIVED_PERCENTAGE
 0x08C5

	)

2881 
	#SLSI_PSID_UNIFI_ARP_DETECT_ACTIVATED
 0x08C6

	)

2895 
	#SLSI_PSID_UNIFI_ARP_DETECT_RESPONSE_COUNTER
 0x08C7

	)

2909 
	#SLSI_PSID_UNIFI_READ_TX_PACKET_STATS_FROM_STA_VIF
 0x08C8

	)

2922 
	#SLSI_PSID_UNIFI_ENABLE_MGMT_TX_PACKET_STATS
 0x08C9

	)

2935 
	#SLSI_PSID_UNIFI_SW_TO_HW_QUEUE_STATS
 0x08CA

	)

2948 
	#SLSI_PSID_UNIFI_HOST_TO_SW_QUEUE_STATS
 0x08CB

	)

2962 
	#SLSI_PSID_UNIFI_QUEUE_STATS_ENABLE
 0x08CC

	)

2977 
	#SLSI_PSID_UNIFI_TX_DATA_CONFIRM
 0x08CD

	)

2995 
	#SLSI_PSID_UNIFI_THROUGHPUT_DEBUG
 0x08CE

	)

3008 
	#SLSI_PSID_UNIFI_LOAD_DPD_LUT
 0x08CF

	)

3021 
	#SLSI_PSID_UNIFI_DPD_MASTER_SWITCH
 0x08D0

	)

3038 
	#SLSI_PSID_UNIFI_DPD_PREDISTORT_GAINS
 0x08D1

	)

3051 
	#SLSI_PSID_UNIFI_OVERRIDE_DPD_LUT
 0x08D2

	)

3064 
	#SLSI_PSID_UNIFI_GOOGLE_MAX_NUMBER_OF_PERIODIC_SCANS
 0x08D4

	)

3077 
	#SLSI_PSID_UNIFI_GOOGLE_MAX_RSSI_SAMPLE_SIZE
 0x08D5

	)

3090 
	#SLSI_PSID_UNIFI_GOOGLE_MAX_HOTLIST_APS
 0x08D6

	)

3103 
	#SLSI_PSID_UNIFI_GOOGLE_MAX_SIGNIFICANT_WIFI_CHANGE_APS
 0x08D7

	)

3116 
	#SLSI_PSID_UNIFI_GOOGLE_MAX_BSSID_HISTORY_ENTRIES
 0x08D8

	)

3130 
	#SLSI_PSID_UNIFI_RESTRICT_SCO_TXOP_SIZE
 0x08D9

	)

3147 
	#SLSI_PSID_UNIFI_USPBO_TX_AGGREGATE_BUFFER_SIZE
 0x08DA

	)

3165 
	#SLSI_PSID_UNIFI_NON_LTE_USPBO_CONFIG
 0x08DB

	)

3187 
	#SLSI_PSID_UNIFI_SET_RESPONSE_RATE
 0x08DC

	)

3202 
	#SLSI_PSID_UNIFI_MAC_BEACON_TIMEOUT
 0x08DE

	)

3217 
	#SLSI_PSID_UNIFI_MIF_OFF_ALLOWED
 0x08DF

	)

3231 
	#SLSI_PSID_UNIFI_BLOCK_SCAN_AFTER_NUM_SCHED_VIF
 0x08E0

	)

3246 
	#SLSI_PSID_UNIFI_MIFLESS_STA_ENABLE
 0x08E1

	)

3260 
	#SLSI_PSID_UNIFI_STA_USES_ONE_ANTENNA_WHEN_IDLE
 0x08E2

	)

3274 
	#SLSI_PSID_UNIFI_STA_USES_MULTI_ANTENNAS_DURING_CONNECT
 0x08E3

	)

3288 
	#SLSI_PSID_UNIFI_AP_USES_ONE_ANTENNA_WHEN_PEERS_IDLE
 0x08E4

	)

3303 
	#SLSI_PSID_DEPRECATED_UNIFI_UPDATE_ANTENNA_CAPABILITIES_WHEN_SCANNING
 0x08E5

	)

3318 
	#SLSI_PSID_UNIFI_PREFERRED_ANTENNA_BITMAP
 0x08E6

	)

3334 
	#SLSI_PSID_UNIFI_MAX_CONCURRENT_MA_CS
 0x08E7

	)

3348 
	#SLSI_PSID_UNIFI_LOAD_DPD_LUT_PER_RADIO
 0x08E8

	)

3362 
	#SLSI_PSID_UNIFI_OVERRIDE_DPD_LUT_PER_RADIO
 0x08E9

	)

3376 
	#SLSI_PSID_UNIFI_ROAMING_LOW_LATENCY_SOFT_ROAMING_ALLOWED
 0x08EA

	)

3389 
	#SLSI_PSID_UNIFI_ROAMING_SOFT_ROAMING_ACTIVATED_WHEN_LCD_IS_OFF
 0x08EC

	)

3403 
	#SLSI_PSID_UNIFI_ROAMING_SEND_DEAUTH_WHEN_ROAMING_BACK
 0x08ED

	)

3416 
	#SLSI_PSID_UNIFI_ROAM_BTM_DISREGARD_SELECTION_FACTOR
 0x08EE

	)

3432 
	#SLSI_PSID_UNIFI_TEST_SET_MAX_BANDWIDTH
 0x08EF

	)

3445 
	#SLSI_PSID_UNIFI_LOW_LATENCY_SCAN_NPROBE
 0x08F0

	)

3459 
	#SLSI_PSID_UNIFI_ROAM_ETE_ACTIVATED
 0x08F1

	)

3472 
	#SLSI_PSID_UNIFI_ROAM_MPDUSS
 0x08F2

	)

3486 
	#SLSI_PSID_UNIFI_ROAM_BA_WIN_SIZE
 0x08F3

	)

3501 
	#SLSI_PSID_UNIFI_ROAM_NCHO_CACHED_SCAN_PERIOD
 0x08F4

	)

3517 
	#SLSI_PSID_UNIFI_ROAM_CU_FACTOR
 0x08F7

	)

3531 
	#SLSI_PSID_UNIFI_BEACON_CU
 0x08F8

	)

3544 
	#SLSI_PSID_UNIFI_ROAM_BTM_FORCE_ABRIDGED
 0x08F9

	)

3557 
	#SLSI_PSID_UNIFI_ROAM_RSSI_BOOST
 0x08FA

	)

3571 
	#SLSI_PSID_UNIFI_ROAM_TARGET_RSSI_BEACON_LOST
 0x08FB

	)

3585 
	#SLSI_PSID_UNIFI_ROAM_CU_LOCAL
 0x08FC

	)

3599 
	#SLSI_PSID_UNIFI_ROAM_TARGET_RSSI_EMERGENCY
 0x08FD

	)

3614 
	#SLSI_PSID_UNIFI_ROAM_AP_SELECT_DELTA_FACTOR
 0x08FE

	)

3627 
	#SLSI_PSID_UNIFI_ROAM_CU_WEIGHT
 0x08FF

	)

3642 
	#SLSI_PSID_UNIFI_ROAM_BTM_AP_SELECT_DELTA_FACTOR
 0x0900

	)

3655 
	#SLSI_PSID_UNIFI_ROAM_RSSIWEIGHT
 0x0901

	)

3668 
	#SLSI_PSID_UNIFI_ROAM_RSSI_FACTOR
 0x0902

	)

3683 
	#SLSI_PSID_UNIFI_ROAM_CU_RSSI_SCAN_TRIGGER
 0x0903

	)

3697 
	#SLSI_PSID_UNIFI_ROAM_CU_SCAN_TRIGGER
 0x0904

	)

3711 
	#SLSI_PSID_UNIFI_ROAM_BSS_LOAD_MONITORING_FREQUENCY
 0x0905

	)

3725 
	#SLSI_PSID_UNIFI_ROAM_BLACKLIST_SIZE
 0x0906

	)

3738 
	#SLSI_PSID_UNIFI_CU_MEASUREMENT_INTERVAL
 0x0907

	)

3752 
	#SLSI_PSID_UNIFI_CURRENT_BSS_NSS
 0x0908

	)

3765 
	#SLSI_PSID_UNIFI_AP_MIMO_USED
 0x0909

	)

3779 
	#SLSI_PSID_UNIFI_ROAM_EAPOL_TIMEOUT
 0x090A

	)

3792 
	#SLSI_PSID_UNIFI_ROAMING_COUNT
 0x090B

	)

3806 
	#SLSI_PSID_UNIFI_ROAMING_AKM
 0x090C

	)

3820 
	#SLSI_PSID_UNIFI_CURRENT_BSS_BANDWIDTH
 0x090D

	)

3833 
	#SLSI_PSID_UNIFI_CURRENT_BSS_CHANNEL_FREQUENCY
 0x090E

	)

3847 
	#SLSI_PSID_UNIFI_ROAM_INACTIVE_COUNT
 0x090F

	)

3866 
	#SLSI_PSID_UNIFI_LOGGER_ENABLED
 0x0910

	)

3879 
	#SLSI_PSID_UNIFI_MA_PACKET_FATE_ENABLED
 0x0911

	)

3894 
	#SLSI_PSID_UNIFI_ROAM_AP_SELECT_MIN_DELTA_FACTOR
 0x0912

	)

3909 
	#SLSI_PSID_UNIFI_STA_VIF_LINK_NSS
 0x0914

	)

3922 
	#SLSI_PSID_UNIFI_FRAME_RX_COUNTERS
 0x0916

	)

3935 
	#SLSI_PSID_UNIFI_FRAME_TX_COUNTERS
 0x0917

	)

3950 
	#SLSI_PSID_UNIFI_LAA_NSS_SPECULATION_INTERVAL_SLOT_TIME
 0x091A

	)

3964 
	#SLSI_PSID_UNIFI_LAA_NSS_SPECULATION_INTERVAL_SLOT_MAX_NUM
 0x091B

	)

3978 
	#SLSI_PSID_UNIFI_LAA_BW_SPECULATION_INTERVAL_SLOT_TIME
 0x091C

	)

3992 
	#SLSI_PSID_UNIFI_LAA_BW_SPECULATION_INTERVAL_SLOT_MAX_NUM
 0x091D

	)

4007 
	#SLSI_PSID_UNIFI_LAA_MCS_SPECULATION_INTERVAL_SLOT_TIME
 0x091E

	)

4021 
	#SLSI_PSID_UNIFI_LAA_MCS_SPECULATION_INTERVAL_SLOT_MAX_NUM
 0x091F

	)

4036 
	#SLSI_PSID_UNIFI_LAA_GI_SPECULATION_INTERVAL_SLOT_TIME
 0x0920

	)

4050 
	#SLSI_PSID_UNIFI_LAA_GI_SPECULATION_INTERVAL_SLOT_MAX_NUM
 0x0921

	)

4067 
	#SLSI_PSID_UNIFI_LAA_TX_NSS_ALLOWED_MODE
 0x0922

	)

4081 
	#SLSI_PSID_UNIFI_LAA_TX_DIVERSITY_BEAMFORM_ENABLED
 0x092E

	)

4095 
	#SLSI_PSID_UNIFI_LAA_TX_DIVERSITY_BEAMFORM_MIN_MCS
 0x092F

	)

4112 
	#SLSI_PSID_UNIFI_LAA_TX_DIVERSITY_FIX_MODE
 0x0930

	)

4130 
	#SLSI_PSID_UNIFI_LAA_AMPDU_INHIBIT_TIMEOUT
 0x0931

	)

4144 
	#SLSI_PSID_UNIFI_LAA_INHIBIT_RTS_COUNT
 0x0932

	)

4161 
	#SLSI_PSID_UNIFI_LAA_RTS_INHIBIT_TIMEOUT
 0x0933

	)

4180 
	#SLSI_PSID_UNIFI_LAA_PROTECTION_CONFIG_OVERRIDE
 0x0934

	)

4196 
	#SLSI_PSID_UNIFI_LAA_SPECULATION_MAX_TIME
 0x0935

	)

4209 
	#SLSI_PSID_UNIFI_RATE_STATS_RTS_ERROR_COUNT
 0x0936

	)

4224 
	#SLSI_PSID_UNIFI_RTS_DURATION_PROTECTS_FULL_TXOP
 0x0937

	)

4237 
	#SLSI_PSID_UNIFI_LAA_AMPDU_INHIBIT_RTS_ALSO
 0x0938

	)

4252 
	#SLSI_PSID_UNIFI_CSR_ONLY_EIFS_DURATION
 0x093A

	)

4266 
	#SLSI_PSID_UNIFI_OVERRIDE_DEFAULT_BETXOP_FOR_HT
 0x093C

	)

4281 
	#SLSI_PSID_UNIFI_OVERRIDE_DEFAULT_BETXOP
 0x093D

	)

4294 
	#SLSI_PSID_UNIFI_RXABB_TRIM_SETTINGS
 0x093E

	)

4308 
	#SLSI_PSID_UNIFI_RADIO_TRIMS_ENABLE
 0x093F

	)

4322 
	#SLSI_PSID_UNIFI_RADIO_CCA_THRESHOLDS
 0x0940

	)

4338 
	#SLSI_PSID_UNIFI_HARDWARE_PLATFORM
 0x0941

	)

4356 
	#SLSI_PSID_UNIFI_FORCE_CHANNEL_BW
 0x0942

	)

4369 
	#SLSI_PSID_UNIFI_DPD_TRAINING_DURATION
 0x0943

	)

4382 
	#SLSI_PSID_UNIFI_TX_FTRIM_SETTINGS
 0x0944

	)

4405 
	#SLSI_PSID_UNIFI_DPD_TRAIN_PACKET_CONFIG
 0x0945

	)

4418 
	#SLSI_PSID_UNIFI_TX_POWER_TRIM_COMMON_CONFIG
 0x0946

	)

4431 
	#SLSI_PSID_UNIFI_IQ_DEBUG_ENABLED
 0x0947

	)

4444 
	#SLSI_PSID_UNIFI_FTM_ONE_CROSS_TWO_SUPPORT
 0x0948

	)

4457 
	#SLSI_PSID_UNIFI_ROAM_FT_OVER_DS_ENABLED
 0x094A

	)

4471 
	#SLSI_PSID_UNIFI_ROAM_FT_OVER_DS_MIN_RSSI
 0x094B

	)

4488 
	#SLSI_PSID_UNIFI_ENABLE_COEX_LOW_LATENCY
 0x0961

	)

4501 
	#SLSI_PSID_UNIFI_COEX_DEBUG_OVERRIDE_BT
 0x0979

	)

4516 
	#SLSI_PSID_UNIFI_LTE_MAILBOX
 0x097E

	)

4531 
	#SLSI_PSID_UNIFI_LTE_MWS_SIGNAL
 0x097F

	)

4544 
	#SLSI_PSID_UNIFI_LTE_ENABLE_CHANNEL_AVOIDANCE
 0x0980

	)

4557 
	#SLSI_PSID_UNIFI_LTE_ENABLE_POWER_BACKOFF
 0x0981

	)

4570 
	#SLSI_PSID_UNIFI_LTE_ENABLE_TIME_DOMAIN
 0x0982

	)

4583 
	#SLSI_PSID_UNIFI_LTE_ENABLE_LTE_COEX
 0x0983

	)

4597 
	#SLSI_PSID_UNIFI_LTE_BAND40_POWER_BACKOFF_CHANNELS
 0x0984

	)

4612 
	#SLSI_PSID_UNIFI_LTE_BAND40_POWER_BACKOFF_RSRP_LOW
 0x0985

	)

4627 
	#SLSI_PSID_UNIFI_LTE_BAND40_POWER_BACKOFF_RSRP_HIGH
 0x0986

	)

4644 
	#SLSI_PSID_UNIFI_LTE_BAND40_POWER_BACKOFF_RSRP_AVERAGING_ALPHA
 0x0987

	)

4657 
	#SLSI_PSID_UNIFI_LTE_SET_CHANNEL
 0x0988

	)

4670 
	#SLSI_PSID_UNIFI_LTE_SET_POWER_BACKOFF
 0x0989

	)

4683 
	#SLSI_PSID_UNIFI_LTE_SET_TDD_DEBUG_MODE
 0x098A

	)

4696 
	#SLSI_PSID_UNIFI_LTE_BAND40_AVOID_CHANNELS
 0x098B

	)

4709 
	#SLSI_PSID_UNIFI_LTE_BAND41_AVOID_CHANNELS
 0x098C

	)

4722 
	#SLSI_PSID_UNIFI_LTE_BAND7_AVOID_CHANNELS
 0x098D

	)

4735 
	#SLSI_PSID_UNIFI_LTE_BAND40_FREQ_THRESHOLD
 0x098E

	)

4748 
	#SLSI_PSID_UNIFI_LTE_BAND41_FREQ_THRESHOLD
 0x098F

	)

4761 
	#SLSI_PSID_UNIFI_LTE_BAND79_FREQ_THRESHOLD
 0x0990

	)

4775 
	#SLSI_PSID_UNIFI_LTE_BAND41_POWER_BACKOFF_CHANNELS
 0x0991

	)

4789 
	#SLSI_PSID_UNIFI_LTE_BAND4041_AVOID_CHANNELS_FALLBACK
 0x0992

	)

4802 
	#SLSI_PSID_UNIFI_LTE_BAND79_ENABLE
 0x0993

	)

4816 
	#SLSI_PSID_UNIFI_LTE_BAND79_POWER_BACKOFF_CHANNELS
 0x0994

	)

4829 
	#SLSI_PSID_UNIFI_LTE_BAND79_AVOID_CHANNELS
 0x0995

	)

4843 
	#SLSI_PSID_UNIFI_LEAKY_AP_CONFIG
 0x0996

	)

4859 
	#SLSI_PSID_UNIFI_USE_CTS_FOR_LEAKY_AP
 0x0997

	)

4876 
	#SLSI_PSID_UNIFI_USPBO_RX_AGGREGATE_BUFFER_SIZE
 0x0998

	)

4890 
	#SLSI_PSID_UNIFI_MIFLESS_AP_BITMAP
 0x099A

	)

4909 
	#SLSI_PSID_UNIFI_ANTENNA_SELECTION_OPTION
 0x099B

	)

4922 
	#SLSI_PSID_UNIFI_BEACON_RX_PERIOD_UPDATE
 0x09A1

	)

4938 
	#SLSI_PSID_UNIFI_BLACKOUT_SIMULATION
 0x09A6

	)

4955 
	#SLSI_PSID_UNIFI_BLACKOUT_FORCE_TX_ONLY
 0x09A7

	)

4969 
	#SLSI_PSID_UNIFI_USE_HOST_LISTEN_INTERVAL
 0x09AC

	)

4984 
	#SLSI_PSID_UNIFI_MAX_BEACON_LISTEN_WINDOW_TIME
 0x09AF

	)

4999 
	#SLSI_PSID_UNIFI_AP_SCAN_ABSENCE_DURATION
 0x09B0

	)

5014 
	#SLSI_PSID_UNIFI_AP_SCAN_ABSENCE_PERIOD
 0x09B1

	)

5029 
	#SLSI_PSID_UNIFI_MLMESTA_KEEP_ALIVE_TIMEOUT_CHECK
 0x09B5

	)

5044 
	#SLSI_PSID_UNIFI_MLMEAP_KEEP_ALIVE_TIMEOUT_CHECK
 0x09B6

	)

5059 
	#SLSI_PSID_UNIFI_MLMEGO_KEEP_ALIVE_TIMEOUT_CHECK
 0x09B7

	)

5074 
	#SLSI_PSID_UNIFI_BSS_MAX_IDLE_PERIOD
 0x09B8

	)

5088 
	#SLSI_PSID_UNIFI_DUAL_STA_IDLE_MODE_ENABLED
 0x09BA

	)

5102 
	#SLSI_PSID_UNIFI_STA_IDLE_MODE_CONTROL
 0x09BB

	)

5117 
	#SLSI_PSID_UNIFI_GOCT_WINDOW_DELAY
 0x09BC

	)

5131 
	#SLSI_PSID_UNIFI_STA_IDLE_MODE_ENABLED
 0x09BD

	)

5153 
	#SLSI_PSID_UNIFI_FAST_POWER_SAVE_TIMEOUT_AGGRESSIVE
 0x09BE

	)

5174 
	#SLSI_PSID_UNIFI_IDLEMODE_LISTEN_INTERVAL_SKIPPING_DTIM
 0x09BF

	)

5195 
	#SLSI_PSID_UNIFI_IDLEMODE_P2_PLISTEN_INTERVAL_SKIPPING_DTIM
 0x09C0

	)

5211 
	#SLSI_PSID_UNIFI_AP_IDLE_MODE_ENABLED
 0x09C1

	)

5229 
	#SLSI_PSID_UNIFI_FAST_POWER_SAVE_TIMEOUT
 0x09C4

	)

5250 
	#SLSI_PSID_UNIFI_FAST_POWER_SAVE_TIMEOUT_SMALL
 0x09C5

	)

5265 
	#SLSI_PSID_UNIFI_MLMESTA_KEEP_ALIVE_TIMEOUT
 0x09C6

	)

5279 
	#SLSI_PSID_UNIFI_MLMEAP_KEEP_ALIVE_TIMEOUT
 0x09C7

	)

5293 
	#SLSI_PSID_UNIFI_MLMEGO_KEEP_ALIVE_TIMEOUT
 0x09C8

	)

5307 
	#SLSI_PSID_UNIFI_STA_ROUTER_ADVERTISEMENT_MINIMUM_INTERVAL_TO_FORWARD
 0x09C9

	)

5322 
	#SLSI_PSID_UNIFI_ROAM_CONNECTION_QUALITY_CHECK_WAIT_AFTER_CONNECT
 0x09CA

	)

5344 
	#SLSI_PSID_UNIFI_AP_BEACON_MAX_DRIFT
 0x09CB

	)

5358 
	#SLSI_PSID_UNIFI_BSS_MAX_IDLE_PERIOD_ACTIVATED
 0x09CC

	)

5376 
	#SLSI_PSID_UNIFI_VIF_IDLE_MONITOR_TIME
 0x09CD

	)

5393 
	#SLSI_PSID_UNIFI_DISABLE_LEGACY_POWER_SAVE
 0x09CE

	)

5410 
	#SLSI_PSID_UNIFI_DEBUG_FORCE_ACTIVE
 0x09CF

	)

5426 
	#SLSI_PSID_UNIFI_STATION_ACTIVITY_IDLE_TIME
 0x09D0

	)

5439 
	#SLSI_PSID_UNIFI_DMS_ACTIVATED
 0x09D1

	)

5462 
	#SLSI_PSID_UNIFI_POWER_MANAGEMENT_DELAY_TIMEOUT
 0x09D2

	)

5486 
	#SLSI_PSID_UNIFI_APSD_SERVICE_PERIOD_TIMEOUT
 0x09D3

	)

5512 
	#SLSI_PSID_UNIFI_CONCURRENT_POWER_MANAGEMENT_DELAY_TIMEOUT
 0x09D4

	)

5526 
	#SLSI_PSID_UNIFI_STATION_QOS_INFO
 0x09D5

	)

5547 
	#SLSI_PSID_UNIFI_LISTEN_INTERVAL_SKIPPING_DTIM
 0x09D6

	)

5561 
	#SLSI_PSID_UNIFI_LISTEN_INTERVAL
 0x09D7

	)

5575 
	#SLSI_PSID_UNIFI_LEGACY_PS_POLL_TIMEOUT
 0x09D8

	)

5602 
	#SLSI_PSID_UNIFI_BEACON_SKIPPING_CONTROL
 0x09D9

	)

5619 
	#SLSI_PSID_UNIFI_TOGGLE_POWER_DOMAIN
 0x09DA

	)

5640 
	#SLSI_PSID_UNIFI_P2_PLISTEN_INTERVAL_SKIPPING_DTIM
 0x09DB

	)

5664 
	#SLSI_PSID_UNIFI_FRAGMENTATION_DURATION
 0x09DC

	)

5680 
	#SLSI_PSID_UNIFI_ROAM_SEND_INIT_FRAME_TO_GET_NEIGHBORS
 0x09DD

	)

5693 
	#SLSI_PSID_UNIFI_IDLE_MODE_LITE_ENABLED
 0x09DE

	)

5716 
	#SLSI_PSID_UNIFI_DTIM_WAIT_TIMEOUT
 0x09E1

	)

5734 
	#SLSI_PSID_UNIFI_LISTEN_INTERVAL_MAX_TIME
 0x09E2

	)

5749 
	#SLSI_PSID_UNIFI_SCAN_MAX_PROBE_TRANSMIT_LIFETIME
 0x09E3

	)

5768 
	#SLSI_PSID_UNIFI_POWER_SAVE_TRANSITION_PACKET_THRESHOLD
 0x09E4

	)

5781 
	#SLSI_PSID_UNIFI_PROBE_RESPONSE_LIFETIME
 0x09E5

	)

5794 
	#SLSI_PSID_UNIFI_PROBE_RESPONSE_MAX_RETRY
 0x09E6

	)

5815 
	#SLSI_PSID_UNIFI_TRAFFIC_ANALYSIS_PERIOD
 0x09E7

	)

5835 
	#SLSI_PSID_UNIFI_AGGRESSIVE_POWER_SAVE_TRANSITION_PERIOD
 0x09E8

	)

5854 
	#SLSI_PSID_UNIFI_ACTIVE_TIME_AFTER_MORE_BIT
 0x09E9

	)

5868 
	#SLSI_PSID_UNIFI_DEFAULT_DWELL_TIME
 0x09EA

	)

5882 
	#SLSI_PSID_UNIFI_VHT_CAPABILITIES
 0x09EC

	)

5898 
	#SLSI_PSID_UNIFI_MAX_VIF_SCHEDULE_DURATION
 0x09ED

	)

5914 
	#SLSI_PSID_UNIFI_VIF_LONG_INTERVAL_TIME
 0x09EE

	)

5928 
	#SLSI_PSID_UNIFI_DISALLOW_SCHED_RELINQUISH
 0x09EF

	)

5943 
	#SLSI_PSID_UNIFI_RAME_DPLANE_OPERATION_TIMEOUT
 0x09F0

	)

5959 
	#SLSI_PSID_UNIFI_DEBUG_KEEP_RADIO_ON
 0x09F1

	)

5974 
	#SLSI_PSID_UNIFI_FORCE_FIXED_DURATION_SCHEDULE
 0x09F2

	)

5987 
	#SLSI_PSID_UNIFI_RAME_UPDATE_MIBS
 0x09F3

	)

6002 
	#SLSI_PSID_UNIFI_GO_SCAN_ABSENCE_DURATION
 0x09F4

	)

6017 
	#SLSI_PSID_UNIFI_GO_SCAN_ABSENCE_PERIOD
 0x09F5

	)

6030 
	#SLSI_PSID_UNIFI_MAX_CLIENT
 0x09F6

	)

6046 
	#SLSI_PSID_UNIFI_GOCT_WINDOW_DURATION
 0x09F7

	)

6060 
	#SLSI_PSID_UNIFI_SUPPRESS_SCAN_GO_NOA_ANNOUNCE
 0x09F8

	)

6073 
	#SLSI_PSID_UNIFI_TDLS_IN_P2P_ACTIVATED
 0x09FC

	)

6087 
	#SLSI_PSID_UNIFI_TDLS_ACTIVATED
 0x09FE

	)

6101 
	#SLSI_PSID_UNIFI_TDLS_TP_THRESHOLD_PKT_SECS
 0x09FF

	)

6116 
	#SLSI_PSID_UNIFI_TDLS_RSSI_THRESHOLD
 0x0A00

	)

6129 
	#SLSI_PSID_UNIFI_TDLS_MAXIMUM_RETRY
 0x0A01

	)

6143 
	#SLSI_PSID_UNIFI_TDLS_TP_MONITOR_SECS
 0x0A02

	)

6156 
	#SLSI_PSID_UNIFI_TDLS_BASIC_HT_MCS_SET
 0x0A03

	)

6169 
	#SLSI_PSID_UNIFI_TDLS_BASIC_VHT_MCS_SET
 0x0A04

	)

6183 
	#SLSI_PSID_DOT11_TDLS_DISCOVERY_REQUEST_WINDOW
 0x0A05

	)

6198 
	#SLSI_PSID_DOT11_TDLS_RESPONSE_TIMEOUT
 0x0A06

	)

6211 
	#SLSI_PSID_DOT11_TDLS_CHANNEL_SWITCH_ACTIVATED
 0x0A07

	)

6224 
	#SLSI_PSID_UNIFI_TDLS_DESIGN_FOR_TEST_MODE
 0x0A08

	)

6237 
	#SLSI_PSID_UNIFI_TDLS_WIDER_BANDWIDTH_PROHIBITED
 0x0A09

	)

6250 
	#SLSI_PSID_UNIFI_TDLS_KEY_LIFE_TIME_INTERVAL
 0x0A11

	)

6263 
	#SLSI_PSID_UNIFI_TDLS_TEARDOWN_FRAME_TX_TIMEOUT
 0x0A12

	)

6276 
	#SLSI_PSID_UNIFI_WIFI_SHARING_ACTIVATED
 0x0A14

	)

6292 
	#SLSI_PSID_UNIFI_WI_FI_SHARING_CHANNELS
 0x0A15

	)

6308 
	#SLSI_PSID_UNIFI_WI_FI_SHARING5_GHZ_CHANNEL
 0x0A16

	)

6322 
	#SLSI_PSID_UNIFI_WIFI_SHARING_CHANNEL_SWITCH_COUNT
 0x0A17

	)

6336 
	#SLSI_PSID_UNIFI_CHANNEL_ANNOUNCEMENT_COUNT
 0x0A18

	)

6351 
	#SLSI_PSID_UNIFI_RA_TEST_STORED_SA
 0x0A19

	)

6365 
	#SLSI_PSID_UNIFI_RA_TEST_STORE_FRAME
 0x0A1A

	)

6378 
	#SLSI_PSID_DOT11_TDLS_PEER_UAPSD_BUFFER_STA_ACTIVATED
 0x0A1B

	)

6391 
	#SLSI_PSID_UNIFI_WP_A3_ACTIVATED
 0x0A1C

	)

6404 
	#SLSI_PSID_UNIFI_ARP_OUTSTANDING_MAX
 0x0A1E

	)

6418 
	#SLSI_PSID_UNIFI_P2_PLEGACY_PROBE_RESPONSE_ACTIVATED
 0x0A27

	)

6431 
	#SLSI_PSID_UNIFI_PROBE_RESPONSE_LIFETIME_P2P
 0x0A28

	)

6445 
	#SLSI_PSID_UNIFI_STA_CHANNEL_SWITCH_SLOW_AP_ACTIVATED
 0x0A29

	)

6458 
	#SLSI_PSID_UNIFI_STA_CHANNEL_SWITCH_SLOW_AP_MAX_TIME
 0x0A2C

	)

6471 
	#SLSI_PSID_UNIFI_STA_CHANNEL_SWITCH_SLOW_AP_POLL_INTERVAL
 0x0A2D

	)

6484 
	#SLSI_PSID_UNIFI_STA_CHANNEL_SWITCH_SLOW_AP_PROCEDURE_TIMEOUT_INCREMENT
 0x0A2E

	)

6498 
	#SLSI_PSID_UNIFI_MLME_SCAN_MAX_AERIALS
 0x0A2F

	)

6511 
	#SLSI_PSID_UNIFI_INCLUDE_PMKID_FOR_PSK
 0x0A32

	)

6525 
	#SLSI_PSID_UNIFI_AMSDU_SUBFRAME_REALTEK_OVERRIDE_ACTIVATED
 0x0A37

	)

6539 
	#SLSI_PSID_UNIFI_SUPPRESS_STS_UPDATE_BASED_ON_PEER
 0x0A38

	)

6554 
	#SLSI_PSID_UNIFI_BA_RX_INTERNAL_DELETE_DISABLED
 0x0A3A

	)

6567 
	#SLSI_PSID_UNIFI_HT_AP_DOWNGRADE_BY_NSS_ACTIVATED
 0x0A3B

	)

6581 
	#SLSI_PSID_UNIFI_BTM_DISASSOCIATION_SCAN_DELAY
 0x0A4F

	)

6595 
	#SLSI_PSID_UNIFI_ROAM_BTM_QUERY_TIMEOUT
 0x0A50

	)

6609 
	#SLSI_PSID_UNIFI_ROAM_BSSCU_TRIGGER_FREQUENCY
 0x0A51

	)

6622 
	#SLSI_PSID_UNIFI_APF_ACTIVATED
 0x0A5A

	)

6635 
	#SLSI_PSID_UNIFI_APF_VERSION
 0x0A5B

	)

6649 
	#SLSI_PSID_UNIFI_APF_MAX_SIZE
 0x0A5C

	)

6663 
	#SLSI_PSID_UNIFI_APF_ACTIVE_MODE_ENABLED
 0x0A5D

	)

6677 
	#SLSI_PSID_UNIFI_FRAME_RESPONSE_NDM_TIMEOUT
 0x0A5E

	)

6690 
	#SLSI_PSID_UNIFI_HE_ACTIVATED
 0x0A8C

	)

6705 
	#SLSI_PSID_UNIFI_HE_CAPABILITIES
 0x0A8D

	)

6718 
	#SLSI_PSID_UNIFI_RAA_TX_GI_VALUE
 0x0A8E

	)

6731 
	#SLSI_PSID_UNIFI_RAA_TX_LTF_VALUE
 0x0A8F

	)

6744 
	#SLSI_PSID_UNIFI256_MSDU_CONFIG
 0x0A90

	)

6757 
	#SLSI_PSID_UNIFI_MBSSID_ACTIVATED
 0x0A91

	)

6770 
	#SLSI_PSID_UNIFI_TX_AMSDU_SUPPORT_OVERRIDE
 0x0A92

	)

6783 
	#SLSI_PSID_UNIFI_MBSSID_ROAMING_ACTIVATED
 0x0A93

	)

6796 
	#SLSI_PSID_UNIFI_DL_MUMIMO_NC_WAR
 0x0A94

	)

6818 
	#SLSI_PSID_UNIFI_HE1XLTF08GI_WORKAROUND
 0x0A95

	)

6845 
	#SLSI_PSID_UNIFI_OVERRIDE_MUEDCA_PARAM_AC_ENABLE
 0x0A96

	)

6864 
	#SLSI_PSID_UNIFI_OVERRIDE_MUEDCA_PARAM_AC
 0x0A97

	)

6877 
	#SLSI_PSID_UNIFI_MUEDCA_TIMER_UNIT
 0x0A98

	)

6893 
	#SLSI_PSID_UNIFI_ULMU_DISABLE_BIT_MAP
 0x0A99

	)

6906 
	#SLSI_PSID_UNIFI_OM_TX_NSTS_VALUE
 0x0A9B

	)

6919 
	#SLSI_PSID_UNIFI_OM_RX_NSS_VALUE
 0x0A9C

	)

6932 
	#SLSI_PSID_UNIFI_OM_CHAN_BANDWIDTH_VALUE
 0x0A9D

	)

6945 
	#SLSI_PSID_UNIFI_OM_UL_MU_ENABLE
 0x0A9E

	)

6958 
	#SLSI_PSID_UNIFI_OP_MODE_VALUE
 0x0A9F

	)

6972 
	#SLSI_PSID_UNIFI_OFDMA_NARROW_BW_RU_DISABLE_TIME
 0x0AA0

	)

6985 
	#SLSI_PSID_UNIFI_UL_MU_MIMO_SUPPORT_OVERRIDE
 0x0AA1

	)

6998 
	#SLSI_PSID_UNIFI_TWT_ACTIVATED
 0x0AAB

	)

7013 
	#SLSI_PSID_UNIFI_TWT_CONTROL_FLAGS
 0x0AAC

	)

7027 
	#SLSI_PSID_UNIFI_TWT_IND_DEF_SESS_IDX
 0x0AAD

	)

7041 
	#SLSI_PSID_UNIFI_TWT_START_SESSION
 0x0AAE

	)

7054 
	#SLSI_PSID_UNIFI_TWT_TEARDOWN_SESSION
 0x0AAF

	)

7077 
	#SLSI_PSID_UNIFI_TWT_IND_SESS_PARAM
 0x0AB0

	)

7094 
	#SLSI_PSID_UNIFI_TWT_MODE_SUPPORT_BIT_MAP
 0x0AB1

	)

7107 
	#SLSI_PSID_UNIFI_TWT_HOST_SUSP_TWT_TEARDOWN_DELAY
 0x0AB2

	)

7120 
	#SLSI_PSID_UNIFI_TWTSP_INACTIVITY_TIME
 0x0AB3

	)

7134 
	#SLSI_PSID_UNIFI_TWT_RESUME_DURATION
 0x0AB4

	)

7147 
	#SLSI_PSID_UNIFI_TWT_OPERATION
 0x0AB5

	)

7160 
	#SLSI_PSID_UNIFI_TWT_INFO_FRAME_TX
 0x0AB6

	)

7183 
	#SLSI_PSID_UNIFI_USER_CONTROL_BA_SESSION
 0x0AEF

	)

7197 
	#SLSI_PSID_UNIFI_MLMESTA_KEEP_ALIVE_FAILURE
 0x0B1A

	)

7224 
	#SLSI_PSID_UNIFI_CSR_ONLY_MIB_SHIELD
 0x0FA1

	)

7240 
	#SLSI_PSID_UNIFI_PRIVATE_BBB_TX_FILTER_CONFIG
 0x0FE7

	)

7253 
	#SLSI_PSID_UNIFI_PRIVATE_SWAGC_FRONT_END_GAIN
 0x0FEB

	)

7266 
	#SLSI_PSID_UNIFI_PRIVATE_SWAGC_FRONT_END_LOSS
 0x0FEC

	)

7279 
	#SLSI_PSID_UNIFI_PRIVATE_SWAGC_EXT_THRESH
 0x0FED

	)

7294 
	#SLSI_PSID_UNIFI_CSR_ONLY_POWER_CAL_DELAY
 0x0FEE

	)

7325 
	#SLSI_PSID_UNIFI_RX_AGC_CONTROL
 0x0FEF

	)

7338 
	#SLSI_PSID_DEPRECATED_UNIFI_WAPI_QOS_MASK
 0x1022

	)

7353 
	#SLSI_PSID_UNIFI_WMM_STALL_ENABLE
 0x102B

	)

7367 
	#SLSI_PSID_UNIFI_DEACTIVATE_INESSENTIAL_DEBUG
 0x102C

	)

7381 
	#SLSI_PSID_UNIFI_RAA_TX_HOST_RATE
 0x1034

	)

7404 
	#SLSI_PSID_UNIFI_FALLBACK_SHORT_FRAME_RETRY_DISTRIBUTION
 0x1035

	)

7418 
	#SLSI_PSID_UNIFI_THROUGHPUT_LOW
 0x1036

	)

7432 
	#SLSI_PSID_UNIFI_THROUGHPUT_HIGH
 0x1037

	)

7446 
	#SLSI_PSID_UNIFI_SET_FIXED_AMPDU_AGGREGATION_SIZE
 0x1038

	)

7460 
	#SLSI_PSID_UNIFI_THROUGHPUT_DEBUG_REPORT_INTERVAL
 0x1039

	)

7473 
	#SLSI_PSID_UNIFI_DPLANE_TEST1
 0x103A

	)

7486 
	#SLSI_PSID_UNIFI_DPLANE_TEST2
 0x103B

	)

7499 
	#SLSI_PSID_UNIFI_DPLANE_TEST3
 0x103C

	)

7512 
	#SLSI_PSID_UNIFI_DPLANE_TEST4
 0x103D

	)

7525 
	#SLSI_PSID_UNIFI_ENABLE_COPY_PHY_LOG_TO_DRAM
 0x103E

	)

7540 
	#SLSI_PSID_UNIFI_LAA_FIXED_MAX_BANDWIDTH
 0x103F

	)

7557 
	#SLSI_PSID_UNIFI_DPLANE_DEAF_DETECTION
 0x1040

	)

7572 
	#SLSI_PSID_UNIFI_LAA_LOCAL_BW_CONTROL_ENABLE
 0x1041

	)

7586 
	#SLSI_PSID_UNIFI_LAA_LOCAL_BW_BUSY_WEIGH
 0x1042

	)

7600 
	#SLSI_PSID_UNIFI_LAA_LOCAL_BW_BUSY_LEVEL_THRES
 0x1043

	)

7614 
	#SLSI_PSID_UNIFI_LAA_MIN_MCS_FOR_BW_CHANGE
 0x1044

	)

7627 
	#SLSI_PSID_UNIFI_DPHP_HW_MONITOR_LOG_ENABLE
 0x1045

	)

7643 
	#SLSI_PSID_UNIFI_PHY_EVENT_TO_UDI_MIN_INTERVAL
 0x1046

	)

7656 
	#SLSI_PSID_UNIFI_PHY_EVENT_TO_UDI_MIN_BEACON_MISS_IN_ROW
 0x1047

	)

7672 
	#SLSI_PSID_UNIFI_PHY_EVENT_TO_UDI_CONFIG
 0x1048

	)

7688 
	#SLSI_PSID_UNIFI_PHY_EVENT_TO_UDI_INTERVAL
 0x1049

	)

7707 
	#SLSI_PSID_UNIFI_MONITOR_STA_ADDRESS
 0x104A

	)

7726 
	#SLSI_PSID_UNIFI_PRE_EBRT_WINDOW
 0x104B

	)

7745 
	#SLSI_PSID_UNIFI_POST_EBRT_WINDOW
 0x104D

	)

7762 
	#SLSI_PSID_UNIFI_LIVE_RESTART_RSSI_THRESHOLD
 0x104E

	)

7780 
	#SLSI_PSID_UNIFI_LIVE_RESTART_MIN_INTERVAL
 0x104F

	)

7797 
	#SLSI_PSID_UNIFI_PS_POLL_THRESHOLD
 0x1053

	)

7816 
	#SLSI_PSID_UNIFI_POST_EBRT_WINDOW_IDLE
 0x1054

	)

7835 
	#SLSI_PSID_UNIFI_PRE_EBRT_WINDOW_IDLE
 0x1055

	)

7861 
	#SLSI_PSID_UNIFI_SABLE_CONTAINER_SIZE_CONFIGURATION
 0x1388

	)

7877 
	#SLSI_PSID_UNIFI_SABLE_FRAME_LOG_MODE
 0x1389

	)

7893 
	#SLSI_PSID_UNIFI_SABLE_FRAME_LOG_CPU_THRES_PERCENT
 0x138A

	)

7906 
	#SLSI_PSID_UNIFI_SABLE_FRAME_LOG_CPU_OVERHEAD_PERCENT
 0x138B

	)

7919 
	#SLSI_PSID_UNIFI_DPLANE_SABLE_TX_DELAY_THRES_MS
 0x138C

	)

7934 
	#SLSI_PSID_UNIFI_DPLANE_SABLE_TX_DELAY_ACTION
 0x138D

	)

7947 
	#SLSI_PSID_UNIFI_DEBUG_SVC_MODE_STACK_HIGH_WATER_MARK
 0x1392

	)

7960 
	#SLSI_PSID_UNIFI_OVERRIDE_EDCA_PARAM_BE
 0x139F

	)

7973 
	#SLSI_PSID_UNIFI_OVERRIDE_EDCA_PARAM_BE_ENABLE
 0x13A0

	)

7995 
	#SLSI_PSID_UNIFI_PANIC_SUB_SYSTEM_CONTROL
 0x13A2

	)

8008 
	#SLSI_PSID_UNIFI_FAULT_ENABLE
 0x13A3

	)

8032 
	#SLSI_PSID_UNIFI_FAULT_SUB_SYSTEM_CONTROL
 0x13A4

	)

8056 
	#SLSI_PSID_UNIFI_DEBUG_MODULE_CONTROL
 0x13A5

	)

8072 
	#SLSI_PSID_UNIFI_TX_USING_LDPC_ACTIVATED
 0x13A6

	)

8085 
	#SLSI_PSID_UNIFI_TX_SETTINGS
 0x13A7

	)

8098 
	#SLSI_PSID_UNIFI_TX_GAIN_SETTINGS
 0x13A8

	)

8112 
	#SLSI_PSID_UNIFI_TX_ANTENNA_CONNECTION_LOSS_FREQUENCY
 0x13A9

	)

8126 
	#SLSI_PSID_UNIFI_TX_ANTENNA_CONNECTION_LOSS
 0x13AA

	)

8139 
	#SLSI_PSID_UNIFI_TX_ANTENNA_MAX_GAIN_FREQUENCY
 0x13AB

	)

8153 
	#SLSI_PSID_UNIFI_TX_ANTENNA_MAX_GAIN
 0x13AC

	)

8166 
	#SLSI_PSID_UNIFI_RX_EXTERNAL_GAIN_FREQUENCY
 0x13AD

	)

8179 
	#SLSI_PSID_UNIFI_RX_EXTERNAL_GAIN
 0x13AE

	)

8195 
	#SLSI_PSID_UNIFI_TX_SG_I20_ACTIVATED
 0x13B0

	)

8211 
	#SLSI_PSID_UNIFI_TX_SG_I40_ACTIVATED
 0x13B1

	)

8227 
	#SLSI_PSID_UNIFI_TX_SG_I80_ACTIVATED
 0x13B2

	)

8243 
	#SLSI_PSID_UNIFI_TX_SG_I160_ACTIVATED
 0x13B3

	)

8257 
	#SLSI_PSID_UNIFI_MAC_ADDRESS_RANDOMISATION
 0x13B4

	)

8272 
	#SLSI_PSID_UNIFI_MAC_ADDRESS_RANDOMISATION_MASK
 0x13B7

	)

8285 
	#SLSI_PSID_UNIFI_WIPS_ACTIVATED
 0x13BA

	)

8299 
	#SLSI_PSID_UNIFI_RF_TEST_MODE_ACTIVATED
 0x13BE

	)

8313 
	#SLSI_PSID_UNIFI_TX_POWER_DETECTOR_RESPONSE
 0x13BF

	)

8326 
	#SLSI_PSID_UNIFI_TX_DETECTOR_TEMPERATURE_COMPENSATION
 0x13C0

	)

8339 
	#SLSI_PSID_UNIFI_TX_DETECTOR_FREQUENCY_COMPENSATION
 0x13C1

	)

8353 
	#SLSI_PSID_UNIFI_TX_OPEN_LOOP_TEMPERATURE_COMPENSATION
 0x13C2

	)

8367 
	#SLSI_PSID_UNIFI_TX_OPEN_LOOP_FREQUENCY_COMPENSATION
 0x13C3

	)

8380 
	#SLSI_PSID_UNIFI_TX_OFDM_SELECT
 0x13C4

	)

8393 
	#SLSI_PSID_UNIFI_TX_DIG_GAIN
 0x13C5

	)

8407 
	#SLSI_PSID_UNIFI_CHIP_TEMPERATURE
 0x13C6

	)

8421 
	#SLSI_PSID_UNIFI_BATTERY_VOLTAGE
 0x13C7

	)

8435 
	#SLSI_PSID_UNIFI_TX_OOB_CONSTRAINTS
 0x13C8

	)

8448 
	#SLSI_PSID_UNIFI_TX_PA_GAIN_DPD_TEMPERATURE_COMPENSATION
 0x13CA

	)

8461 
	#SLSI_PSID_UNIFI_TX_PA_GAIN_DPD_FREQUENCY_COMPENSATION
 0x13CB

	)

8474 
	#SLSI_PSID_UNIFI_TX_POWER_TRIM_CONFIG
 0x13D0

	)

8487 
	#SLSI_PSID_UNIFI_FORCE_SHORT_SLOT_TIME
 0x13D8

	)

8501 
	#SLSI_PSID_UNIFI_TX_GAIN_STEP_SETTINGS
 0x13D9

	)

8514 
	#SLSI_PSID_UNIFI_DEBUG_DISABLE_RADIO_NANNY_ACTIONS
 0x13DA

	)

8528 
	#SLSI_PSID_UNIFI_RX_CCK_MODEM_SENSITIVITY
 0x13DB

	)

8541 
	#SLSI_PSID_UNIFI_DPD_PER_BANDWIDTH
 0x13DC

	)

8554 
	#SLSI_PSID_UNIFI_BB_VERSION
 0x13DD

	)

8567 
	#SLSI_PSID_UNIFI_RF_VERSION
 0x13DE

	)

8582 
	#SLSI_PSID_UNIFI_READ_HARDWARE_COUNTER
 0x13DF

	)

8595 
	#SLSI_PSID_UNIFI_CLEAR_RADIO_TRIM_CACHE
 0x13E0

	)

8608 
	#SLSI_PSID_UNIFI_RADIO_TX_SETTINGS_READ
 0x13E1

	)

8622 
	#SLSI_PSID_UNIFI_MODEM_SGI_OFFSET
 0x13E2

	)

8635 
	#SLSI_PSID_UNIFI_RADIO_TX_POWER_OVERRIDE
 0x13E3

	)

8648 
	#SLSI_PSID_UNIFI_RX_RADIO_CS_MODE
 0x13E4

	)

8661 
	#SLSI_PSID_UNIFI_RX_PRI_ENERGY_DET_THRESHOLD
 0x13E5

	)

8674 
	#SLSI_PSID_UNIFI_RX_SEC_ENERGY_DET_THRESHOLD
 0x13E6

	)

8687 
	#SLSI_PSID_UNIFI_AGC_THRESHOLDS
 0x13E7

	)

8700 
	#SLSI_PSID_UNIFI_RADIO_RX_SETTINGS_READ
 0x13E8

	)

8713 
	#SLSI_PSID_UNIFI_STATIC_DPD_GAIN
 0x13E9

	)

8726 
	#SLSI_PSID_UNIFI_IQ_BUFFER_SIZE
 0x13EA

	)

8740 
	#SLSI_PSID_UNIFI_NARROWBAND_CCA_THRESHOLDS
 0x13EB

	)

8753 
	#SLSI_PSID_UNIFI_RADIO_CCA_DEBUG
 0x13EC

	)

8766 
	#SLSI_PSID_UNIFI_CCACS_THRESH
 0x13ED

	)

8779 
	#SLSI_PSID_UNIFI_CCA_MASTER_SWITCH
 0x13EE

	)

8792 
	#SLSI_PSID_UNIFI_RX_SYNC_CCA_CFG
 0x13EF

	)

8805 
	#SLSI_PSID_UNIFI_MAC_CCA_BUSY_TIME
 0x13F0

	)

8818 
	#SLSI_PSID_UNIFI_MAC_SEC_CHAN_CLEAR_TIME
 0x13F1

	)

8831 
	#SLSI_PSID_UNIFI_DPD_DEBUG
 0x13F2

	)

8844 
	#SLSI_PSID_UNIFI_NARROWBAND_CCA_DEBUG
 0x13F3

	)

8858 
	#SLSI_PSID_UNIFI_NANNY_TEMPERATURE_REPORT_DELTA
 0x13F5

	)

8871 
	#SLSI_PSID_UNIFI_NANNY_TEMPERATURE_REPORT_INTERVAL
 0x13F6

	)

8886 
	#SLSI_PSID_UNIFI_RADIO_RX_DCOC_DEBUG_IQ_VALUE
 0x13F7

	)

8901 
	#SLSI_PSID_UNIFI_RADIO_RX_DCOC_DEBUG
 0x13F8

	)

8915 
	#SLSI_PSID_UNIFI_NANNY_RETRIM_DPD_MOD
 0x13F9

	)

8928 
	#SLSI_PSID_UNIFI_DISABLE_DPD_SUB_ITERATION
 0x13FA

	)

8947 
	#SLSI_PSID_UNIFI_RX_RSSI_ADJUSTMENTS
 0x13FB

	)

8960 
	#SLSI_PSID_UNIFI_FLEXIMAC_CCA_ED_ENABLE
 0x13FC

	)

8973 
	#SLSI_PSID_UNIFI_RADIO_TX_IQ_DELAY
 0x13FD

	)

8990 
	#SLSI_PSID_UNIFI_DISABLE_LNA_BYPASS
 0x13FE

	)

9007 
	#SLSI_PSID_UNIFI_INITIAL_FREQUENCY_OFFSET
 0x13FF

	)

9021 
	#SLSI_PSID_UNIFI_RX_RSSI_NB_HW_GAIN
 0x1400

	)

9035 
	#SLSI_PSID_UNIFI_RX_RSSI_NB_FM_OFFSET
 0x1401

	)

9048 
	#SLSI_PSID_UNIFI_RADIO_TX_SETTINGS_READ_V2
 0x1402

	)

9061 
	#SLSI_PSID_UNIFI_RX_CCK_MODEM_DESENSE
 0x1403

	)

9074 
	#SLSI_PSID_UNIFI_RX_CCK_MODEM_DESENSE_OFFSET
 0x1404

	)

9087 
	#SLSI_PSID_UNIFI_RX_OFDM_MODEM_DESENSE
 0x1405

	)

9100 
	#SLSI_PSID_UNIFI_RX_OFDM_MODEM_DESENSE_OFFSET
 0x1406

	)

9113 
	#SLSI_PSID_UNIFI_RADIO_FEC_CONFIG
 0x1407

	)

9127 
	#SLSI_PSID_UNIFI_TX_POWER_DETECTOR_RESPONSE_FREQUENCY
 0x1408

	)

9143 
	#SLSI_PSID_UNIFI_RADIO_MISC_PER_BAND
 0x1409

	)

9156 
	#SLSI_PSID_UNIFI_NANNY_TRIM_NOW
 0x140A

	)

9169 
	#SLSI_PSID_UNIFI_MAP_RADIO_ID_TO_MAC_ID
 0x140B

	)

9182 
	#SLSI_PSID_UNIFI_REPORT_NARROWBAND_RSSI
 0x140C

	)

9195 
	#SLSI_PSID_UNIFI_ENABLE_FEM_RF_LOOPBACK
 0x140D

	)

9208 
	#SLSI_PSID_UNIFI_RADIO_TRIM_COUNT
 0x140E

	)

9222 
	#SLSI_PSID_UNIFI_RX_RSSI_BAND_COMPENSATION
 0x140F

	)

9235 
	#SLSI_PSID_UNIFI_ENABLE_FREQUENCY_TRACKING
 0x1410

	)

9249 
	#SLSI_PSID_UNIFI_ENABLE_FLEXI_MAC_WATCHDOG
 0x1450

	)

9262 
	#SLSI_PSID_UNIFI_RTT_CAPABILITIES
 0x14B4

	)

9275 
	#SLSI_PSID_UNIFI_FTM_MIN_DELTA_FRAMES
 0x14B5

	)

9288 
	#SLSI_PSID_UNIFI_FTM_PER_BURST
 0x14B6

	)

9303 
	#SLSI_PSID_UNIFI_FTM_BURST_DURATION
 0x14B7

	)

9317 
	#SLSI_PSID_UNIFI_FTM_NUM_OF_BURSTS_EXPONENT
 0x14B8

	)

9330 
	#SLSI_PSID_UNIFI_FTM_ASAP_MODE_ACTIVATED
 0x14B9

	)

9343 
	#SLSI_PSID_UNIFI_FTM_RESPONDER_ACTIVATED
 0x14BA

	)

9356 
	#SLSI_PSID_UNIFI_FTM_DEFAULT_SESSION_ESTABLISHMENT_TIMEOUT
 0x14BB

	)

9369 
	#SLSI_PSID_UNIFI_FTM_DEFAULT_GAP_BEFORE_FIRST_BURST_PER_RESPONDER
 0x14BC

	)

9382 
	#SLSI_PSID_UNIFI_FTM_DEFAULT_GAP_BETWEEN_BURSTS
 0x14BD

	)

9396 
	#SLSI_PSID_UNIFI_FTM_DEFAULT_TRIGGER_DELAY
 0x14BE

	)

9410 
	#SLSI_PSID_UNIFI_FTM_DEFAULT_END_BURST_DELAY
 0x14BF

	)

9423 
	#SLSI_PSID_UNIFI_FTM_REQUEST_VALIDATION_ENABLED
 0x14C0

	)

9436 
	#SLSI_PSID_UNIFI_FTM_RESPONSE_VALIDATION_ENABLED
 0x14C1

	)

9449 
	#SLSI_PSID_UNIFI_FTM_USE_RESPONSE_PARAMETERS
 0x14C2

	)

9462 
	#SLSI_PSID_UNIFI_FTM_INITIAL_RESPONSE_TIMEOUT
 0x14C3

	)

9475 
	#SLSI_PSID_UNIFI_FTM_MAC_ADDRESS_RANDOMISATION
 0x14C4

	)

9488 
	#SLSI_PSID_UNIFI_FTM_USE_REQUEST_PARAMETERS
 0x14C9

	)

9501 
	#SLSI_PSID_UNIFI_FTM_MEAN_AROUND_CLUSTER
 0x14CA

	)

9514 
	#SLSI_PSID_UNIFI_FTM_LEGACY_CALIBRATION
 0x14D5

	)

9527 
	#SLSI_PSID_UNIFI_FTM_HT_VHT_CALIBRATION
 0x14D6

	)

9541 
	#SLSI_PSID_UNIFI_SCAN_MAX_CACHE_COUNT
 0x1513

	)

9555 
	#SLSI_PSID_UNIFI_SCAN_MAX_CACHE_TIME
 0x1514

	)

9569 
	#SLSI_PSID_UNIFI_RM_MAX_MEASUREMENT_DURATION
 0x1518

	)

9584 
	#SLSI_PSID_UNIFI_RM_MAX_SCAN_CACHE_TIME
 0x1519

	)

9598 
	#SLSI_PSID_UNIFI_RM_MAX_SCAN_CACHE_COUNT
 0x151A

	)

9611 
	#SLSI_PSID_UNIFI_OBSS_SCAN_START_WAIT
 0x151D

	)

9625 
	#SLSI_PSID_UNIFI_MLME_SCAN_DEFAULT_SHORT_FULL_SCAN_TIME
 0x151E

	)

9638 
	#SLSI_PSID_UNIFI_MLME_SCAN_SHORT_FULL_SCAN_NUM_OF_PROBES
 0x151F

	)

9651 
	#SLSI_PSID_UNIFI_MLME_SCAN_CONTINUE_IF_MORE_THAN_XAPS
 0x1522

	)

9665 
	#SLSI_PSID_UNIFI_MLME_SCAN_STOP_IF_LESS_THAN_XNEW_APS
 0x1523

	)

9678 
	#SLSI_PSID_UNIFI_SCAN_MULTI_VIF_ACTIVATED
 0x1524

	)

9691 
	#SLSI_PSID_UNIFI_SCAN_NEW_ALGORITHM_ACTIVATED
 0x1525

	)

9705 
	#SLSI_PSID_UNIFI_SCAN_REGISTERED_VIF_INFRASTRUCTURE_STA
 0x1526

	)

9719 
	#SLSI_PSID_UNIFI_LNA_CONTROL_EVALUATION_INTERVAL
 0x1778

	)

9734 
	#SLSI_PSID_UNIFI_LNA_CONTROL_RSSI_THRESHOLDS
 0x1779

	)

9747 
	#SLSI_PSID_UNIFI_UNSYNC_VIF_LNA_ENABLED
 0x177A

	)

9763 
	#SLSI_PSID_UNIFI_TPC_MAX_POWER2_GMIMO
 0x177B

	)

9779 
	#SLSI_PSID_UNIFI_TPC_MAX_POWER5_GMIMO
 0x177C

	)

9792 
	#SLSI_PSID_UNIFI_LNA_CONTROL_ENABLED
 0x177D

	)

9805 
	#SLSI_PSID_UNIFI_POWER_IS_GRIP
 0x1780

	)

9820 
	#SLSI_PSID_UNIFI_LOW_POWER_RX_CONFIG
 0x1782

	)

9833 
	#SLSI_PSID_UNIFI_TPC_ENABLED
 0x1783

	)

9847 
	#SLSI_PSID_UNIFI_CURRENT_TXPOWER_LEVEL
 0x1784

	)

9861 
	#SLSI_PSID_UNIFI_USER_SET_TXPOWER_LEVEL
 0x1785

	)

9876 
	#SLSI_PSID_UNIFI_TPC_MAX_POWER_RSSI_THRESHOLD
 0x1786

	)

9891 
	#SLSI_PSID_UNIFI_TPC_MIN_POWER_RSSI_THRESHOLD
 0x1787

	)

9907 
	#SLSI_PSID_UNIFI_TPC_MAX_POWER2G
 0x1788

	)

9923 
	#SLSI_PSID_UNIFI_TPC_MAX_POWER5G
 0x1789

	)

9936 
	#SLSI_PSID_UNIFI_SAR_BACKOFF
 0x178A

	)

9952 
	#SLSI_PSID_UNIFI_TPC_USE_AFTER_CONNECT_RSP
 0x178B

	)

9969 
	#SLSI_PSID_UNIFI_RADIO_LP_RX_RSSI_THRESHOLD_LOWER
 0x178C

	)

9986 
	#SLSI_PSID_UNIFI_RADIO_LP_RX_RSSI_THRESHOLD_UPPER
 0x178D

	)

9999 
	#SLSI_PSID_UNIFI_TEST_TX_POWER_ENABLE
 0x1790

	)

10014 
	#SLSI_PSID_UNIFI_LTE_COEX_MAX_POWER_RSSI_THRESHOLD
 0x1791

	)

10029 
	#SLSI_PSID_UNIFI_LTE_COEX_MIN_POWER_RSSI_THRESHOLD
 0x1792

	)

10044 
	#SLSI_PSID_UNIFI_LTE_COEX_POWER_REDUCTION
 0x1793

	)

10058 
	#SLSI_PSID_UNIFI_PMF_ASSOCIATION_COMEBACK_TIME_DELTA
 0x17A2

	)

10071 
	#SLSI_PSID_UNIFI_TEST_TSPEC_HACK
 0x17AC

	)

10085 
	#SLSI_PSID_UNIFI_TEST_TSPEC_HACK_VALUE
 0x17AD

	)

10099 
	#SLSI_PSID_UNIFI_DEBUG_INSTANT_DELIVERY
 0x17B5

	)

10112 
	#SLSI_PSID_UNIFI_DEBUG_ENABLE
 0x17B7

	)

10128 
	#SLSI_PSID_UNIFI_DPLANE_DEBUG
 0x17B9

	)

10144 
	#SLSI_PSID_UNIFI_NAN_DEFAULT_EDCA_PARAM
 0x17BB

	)

10159 
	#SLSI_PSID_UNIFI_NAN_ALLOW_CIPHER_SUITE_DOWNGRADE
 0x17BC

	)

10172 
	#SLSI_PSID_UNIFI_NAN_MAX_QUEUED_FOLLOWUPS
 0x17BD

	)

10185 
	#SLSI_PSID_UNIFI_NAN_MAX_SDA_TX_RETRY_COUNT
 0x17BE

	)

10198 
	#SLSI_PSID_UNIFI_NAN_SUPPORTED_CIPHER_SUITES
 0x17BF

	)

10211 
	#SLSI_PSID_UNIFI_NAN_ACTIVATED
 0x17C0

	)

10225 
	#SLSI_PSID_UNIFI_NAN_BEACON_CAPABILITIES
 0x17C1

	)

10238 
	#SLSI_PSID_UNIFI_NAN_MAX_CONCURRENT_CLUSTERS
 0x17C2

	)

10251 
	#SLSI_PSID_UNIFI_NAN_MAX_CONCURRENT_PUBLISHES
 0x17C3

	)

10264 
	#SLSI_PSID_UNIFI_NAN_MAX_CONCURRENT_SUBSCRIBES
 0x17C4

	)

10277 
	#SLSI_PSID_UNIFI_NAN_MAX_SERVICE_NAME_LENGTH
 0x17C5

	)

10290 
	#SLSI_PSID_UNIFI_NAN_MAX_MATCH_FILTER_LENGTH
 0x17C6

	)

10303 
	#SLSI_PSID_UNIFI_NAN_MAX_TOTAL_MATCH_FILTER_LENGTH
 0x17C7

	)

10316 
	#SLSI_PSID_UNIFI_NAN_MAX_SERVICE_SPECIFIC_INFO_LENGTH
 0x17C8

	)

10329 
	#SLSI_PSID_UNIFI_NAN_MAX_EXTENDED_SERVICE_SPECIFIC_INFO_LEN
 0x17C9

	)

10343 
	#SLSI_PSID_UNIFI_NAN_MAX_SUBSCRIBE_INTERFACE_ADDRESSES
 0x17CA

	)

10357 
	#SLSI_PSID_UNIFI_NAN_MAX_NDI_INTERFACES
 0x17CB

	)

10371 
	#SLSI_PSID_UNIFI_NAN_MAX_NDP_SESSIONS
 0x17CC

	)

10384 
	#SLSI_PSID_UNIFI_NAN_MAX_APP_INFO_LENGTH
 0x17CD

	)

10399 
	#SLSI_PSID_UNIFI_NAN_MATCH_EXPIRATION_TIME
 0x17CE

	)

10414 
	#SLSI_PSID_UNIFI_NAN_PERMITTED_CHANNELS
 0x17CF

	)

10428 
	#SLSI_PSID_UNIFI_NAN_DEFAULT_SCAN_PERIOD
 0x17D0

	)

10442 
	#SLSI_PSID_UNIFI_NAN_MAX_CHANNEL_SWITCH_TIME
 0x17D1

	)

10455 
	#SLSI_PSID_UNIFI_NAN_MAC_RANDOMISATION_ACTIVATED
 0x17D2

	)

10473 
	#SLSI_PSID_UNIFI_NAN_DEFAULT_SCHEDULE
 0x17D3

	)

10486 
	#SLSI_PSID_HUTS_READ_WRITE_DATA_ELEMENT_INT32
 0x17D4

	)

10499 
	#SLSI_PSID_HUTS_READ_WRITE_DATA_ELEMENT_BOOLEAN
 0x17D5

	)

10513 
	#SLSI_PSID_HUTS_READ_WRITE_DATA_ELEMENT_OCTET_STRING
 0x17D6

	)

10527 
	#SLSI_PSID_HUTS_READ_WRITE_TABLE_INT16_ROW
 0x17D7

	)

10541 
	#SLSI_PSID_HUTS_READ_WRITE_TABLE_OCTET_STRING_ROW
 0x17D8

	)

10555 
	#SLSI_PSID_HUTS_READ_WRITE_REMOTE_PROCEDURE_CALL_INT32
 0x17D9

	)

10569 
	#SLSI_PSID_HUTS_READ_WRITE_REMOTE_PROCEDURE_CALL_OCTET_STRING
 0x17DB

	)

10583 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_INT16
 0x17DC

	)

10597 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_UINT16
 0x17DD

	)

10612 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_UINT32
 0x17DE

	)

10626 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_INT64
 0x17DF

	)

10640 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_BOOLEAN
 0x17E0

	)

10654 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_OCTET_STRING
 0x17E1

	)

10668 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_FIXED_SIZE_TABLE_ROW
 0x17E2

	)

10682 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_VAR_SIZE_TABLE_ROW
 0x17E3

	)

10696 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_FIX_SIZE_TABLE_KEY1_ROW
 0x17E4

	)

10710 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_FIX_SIZE_TABLE_KEY2_ROW
 0x17E5

	)

10723 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_FIX_VAR_SIZE_TABLE_KEY1_ROW
 0x17E6

	)

10736 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_FIX_VAR_SIZE_TABLE_KEY2_ROW
 0x17E7

	)

10749 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_FIX_SIZE_TABLE_KEY_ROW
 0x17E8

	)

10762 
	#SLSI_PSID_HUTS_READ_WRITE_INTERNAL_API_VAR_SIZE_TABLE_KEY_ROW
 0x17E9

	)

10775 
	#SLSI_PSID_UNIFI_TEST_SCAN_NO_MEDIUM
 0x17EA

	)

10790 
	#SLSI_PSID_UNIFI_DUAL_BAND_CONCURRENCY
 0x17EB

	)

10803 
	#SLSI_PSID_UNIFI_LOGGER_MAX_DELAYED_EVENTS
 0x17EC

	)

10816 
	#SLSI_PSID_UNIFI_NAN_SKIP_NAN_CHANNELS_IF_NDL_EXISTS
 0x17ED

	)

10832 
	#SLSI_PSID_UNIFI_NAN_KEEP_ALIVE_TIMEOUT
 0x17FC

	)

10848 
	#SLSI_PSID_UNIFI_NAN_KEEP_ALIVE_TIMEOUT_CHECK
 0x17FD

	)

10863 
	#SLSI_PSID_UNIFI_NAN_DATA_PATH_TRAFFIC_TIMEOUT
 0x17FE

	)

10877 
	#SLSI_PSID_UNIFI_NAN_DATA_PATH_SETUP_TIMEOUT
 0x17FF

	)

10892 
	#SLSI_PSID_UNIFI_NAN_WARMUP_TIMEOUT
 0x1800

	)

10908 
	#SLSI_PSID_UNIFI_NAN_MULTI_VIF_SHARED_SLOTS
 0x1802

	)

10921 
	#SLSI_PSID_UNIFI_ROAMING_IN_NDL_ACTIVATED
 0x1803

	)

10935 
	#SLSI_PSID_UNIFI_NAN_MULTI_BAND_NDL_PERMITTED
 0x1804

	)

10949 
	#SLSI_PSID_UNIFI_LOGGER_NAN_TRAFFIC_REPORT_PERIOD
 0x1805

	)

10962 
	#SLSI_PSID_UNIFI_NAN_ULW_TEST
 0x1806

	)

10979 
	#SLSI_PSID_UNIFI_NAN_DISCOVERY_BEACON_CONFIG
 0x1807

	)

10993 
	#SLSI_PSID_UNIFI_NAN_FORCE_WIDEST_BANDWIDTH
 0x1808

	)

11007 
	#SLSI_PSID_UNIFI_NAN_SCAN_BO_REPEAT_COUNT
 0x1809

	)

11021 
	#SLSI_PSID_UNIFI_NAN_BLACKOUT_FAW_REDUCTION_ACTIVATED
 0x180A

	)

11034 
	#SLSI_PSID_UNIFI_NAN_RANGING_ACTIVATED
 0x180B

	)

11047 
	#SLSI_PSID_UNIFI_NAN_MAX_CONCURRENT_RANGING_AS_INITIATOR
 0x180C

	)

11060 
	#SLSI_PSID_UNIFI_NAN_MAX_CONCURRENT_RANGING_AS_RESPONDER
 0x180D

	)

11074 
	#SLSI_PSID_UNIFI_NAN_RANGING_SETUP_TIMEOUT
 0x180E

	)

11088 
	#SLSI_PSID_UNIFI_NAN_MAX_RANGING_RETRY_COUNT
 0x180F

	)

11103 
	#SLSI_PSID_UNIFI_NAN_TEST_RANGING_DISTANCE
 0x1810

	)

11118 
	#SLSI_PSID_UNIFI_NANSDF_TRANSMISSION_OUTSIDE_DW_PERMITTED
 0x1811

	)

11133 
	#SLSI_PSID_UNIFI_NAN_TEST_MASTER_PREFERENCE
 0x181A

	)

11153 
	#SLSI_PSID_UNIFI_REGULATORY_PARAMETERS
 0x1F4B

	)

11168 
	#SLSI_PSID_UNIFI_SUPPORTED_CHANNELS
 0x1F4C

	)

11181 
	#SLSI_PSID_UNIFI_DEFAULT_COUNTRY
 0x1F4D

	)

11197 
	#SLSI_PSID_UNIFI_COUNTRY_LIST
 0x1F4E

	)

11210 
	#SLSI_PSID_UNIFI_OPERATING_CLASS_PARAMTERS
 0x1F4F

	)

11223 
	#SLSI_PSID_UNIFI_VIF_COUNTRY
 0x1F50

	)

11236 
	#SLSI_PSID_UNIFI_NO_CELL_MAX_POWER
 0x1F51

	)

11251 
	#SLSI_PSID_UNIFI_NO_CELL_INCLUDED_CHANNELS
 0x1F52

	)

11265 
	#SLSI_PSID_UNIFI_REG_DOM_VERSION
 0x1F53

	)

11278 
	#SLSI_PSID_UNIFI_DEFAULT_COUNTRY_WITHOUT_CH12_CH13
 0x1F54

	)

11291 
	#SLSI_PSID_UNIFI_READ_REG
 0x1F73

	)

11293 #ifdeà
__ılu¥lus


	@mib_text_convert.c

8 
	~"debug.h
"

9 
	~"mib_‹xt_cÚv”t.h
"

11 
	#CSR_TOUPPER
(
ch¬aù”
è(((ch¬aù”è>ğ'a'è&& ((ch¬aù”è<ğ'z'è? ((ch¬aù”è- 0x20è: (ch¬aù”))

	)

13 
šlše
 
boŞ
 
	$C¤IsS·û
(
u8
 
c
)

15 
c
) {

21  
Œue
;

23  
çl£
;

25 
	}
}

27 
šlše
 *
	$C¤SŒDup
(cÚ¡ *
¡ršg
)

29 ià(
¡ršg
) {

30 
u32
 
Ën
 = 
	`¡¾’
(
¡ršg
) + 1;

31 *
»suÉ
 = 
	`km®loc
(
Ën
, 
GFP_KERNEL
);

33 ià(
»suÉ
)

34  
	`memıy
(
»suÉ
, 
¡ršg
, 
Ën
);

36  
NULL
;

37 
	}
}

39 
	$C¤SŒNICmp
(cÚ¡ *
¡ršg1
,

40 cÚ¡ *
¡ršg2
,

41 
size_t
 
couÁ
)

43 
u32
 
šdex
;

44 
»tuºV®ue
 = 0;

46 
šdex
 = 0; index < 
couÁ
; index++) {

47 ià(
	`CSR_TOUPPER
(
¡ršg1
[
šdex
]è!ğCSR_TOUPPER(
¡ršg2
[index])) {

48 ià(
	`CSR_TOUPPER
(
¡ršg1
[
šdex
]è> CSR_TOUPPER(
¡ršg2
[index]))

49 
»tuºV®ue
 = 1;

51 
»tuºV®ue
 = -1;

54 ià(
¡ršg1
[
šdex
] == '\0')

57  
»tuºV®ue
;

58 
	}
}

60 
boŞ
 
	$C¤HexSŒToUšt8
(cÚ¡ *
¡ršg
, 
u8
 *
»tuºV®ue
)

62 
u16
 
cu¼’tIndex
 = 0;

64 *
»tuºV®ue
 = 0;

65 ià((
¡ršg
[
cu¼’tIndex
] =ğ'0'è&& (
	`CSR_TOUPPER
(string[currentIndex + 1]) == 'X'))

66 
¡ršg
 += 2;

67 ià(((
¡ršg
[
cu¼’tIndex
] >ğ'0'è&& (¡ršg[cu¼’tIndex] <ğ'9')è|| ((
	`CSR_TOUPPER
(string[currentIndex]) >= 'A') && (CSR_TOUPPER(string[currentIndex]) <= 'F'))) {

68 ((
¡ršg
[
cu¼’tIndex
] >ğ'0'è&& (¡ršg[cu¼’tIndex] <ğ'9')è|| ((
	`CSR_TOUPPER
(string[currentIndex]) >= 'A') && (CSR_TOUPPER(string[currentIndex]) <= 'F'))) {

69 *
»tuºV®ue
 = (
u8
)(*»tuºV®u* 16 + (((
¡ršg
[
cu¼’tIndex
] >ğ'0'è&& (¡ršg[cu¼’tIndex] <ğ'9')è? sŒšg[cu¼’tIndex] - '0' : 
	`CSR_TOUPPER
(string[currentIndex]) - 'A' + 10));

70 
cu¼’tIndex
++;

71 ià(
cu¼’tIndex
 >= 2)

74  
Œue
;

76  
çl£
;

77 
	}
}

79 
boŞ
 
	$C¤HexSŒToUšt16
(cÚ¡ *
¡ršg
, 
u16
 *
»tuºV®ue
)

81 
u16
 
cu¼’tIndex
 = 0;

83 *
»tuºV®ue
 = 0;

84 ià((
¡ršg
[
cu¼’tIndex
] =ğ'0'è&& (
	`CSR_TOUPPER
(string[currentIndex + 1]) == 'X'))

85 
¡ršg
 += 2;

86 ià(((
¡ršg
[
cu¼’tIndex
] >ğ'0'è&& (¡ršg[cu¼’tIndex] <ğ'9')è|| ((
	`CSR_TOUPPER
(string[currentIndex]) >= 'A') && (CSR_TOUPPER(string[currentIndex]) <= 'F'))) {

87 ((
¡ršg
[
cu¼’tIndex
] >ğ'0'è&& (¡ršg[cu¼’tIndex] <ğ'9')è|| ((
	`CSR_TOUPPER
(string[currentIndex]) >= 'A') && (CSR_TOUPPER(string[currentIndex]) <= 'F'))) {

88 *
»tuºV®ue
 = (
u16
)(*»tuºV®u* 16 + (((
¡ršg
[
cu¼’tIndex
] >ğ'0'è&& (¡ršg[cu¼’tIndex] <ğ'9')è? sŒšg[cu¼’tIndex] - '0' : 
	`CSR_TOUPPER
(string[currentIndex]) - 'A' + 10));

89 
cu¼’tIndex
++;

90 ià(
cu¼’tIndex
 >= 4)

93  
Œue
;

95  
çl£
;

96 
	}
}

98 
boŞ
 
	$C¤HexSŒToUšt32
(cÚ¡ *
¡ršg
, 
u32
 *
»tuºV®ue
)

100 
u16
 
cu¼’tIndex
 = 0;

102 *
»tuºV®ue
 = 0;

103 ià((
¡ršg
[
cu¼’tIndex
] =ğ'0'è&& (
	`CSR_TOUPPER
(string[currentIndex + 1]) == 'X'))

104 
¡ršg
 += 2;

105 ià(((
¡ršg
[
cu¼’tIndex
] >ğ'0'è&& (¡ršg[cu¼’tIndex] <ğ'9')è|| ((
	`CSR_TOUPPER
(string[currentIndex]) >= 'A') && (CSR_TOUPPER(string[currentIndex]) <= 'F'))) {

106 ((
¡ršg
[
cu¼’tIndex
] >ğ'0'è&& (¡ršg[cu¼’tIndex] <ğ'9')è|| ((
	`CSR_TOUPPER
(string[currentIndex]) >= 'A') && (CSR_TOUPPER(string[currentIndex]) <= 'F'))) {

107 *
»tuºV®ue
 = *»tuºV®u* 16 + (((
¡ršg
[
cu¼’tIndex
] >ğ'0'è&& (¡ršg[cu¼’tIndex] <ğ'9')è? sŒšg[cu¼’tIndex] - '0' : 
	`CSR_TOUPPER
(string[currentIndex]) - 'A' + 10);

108 
cu¼’tIndex
++;

109 ià(
cu¼’tIndex
 >= 8)

112  
Œue
;

114  
çl£
;

115 
	}
}

117 
boŞ
 
	$C¤WifiMibCÚv”tSŒToUšt16
(cÚ¡ *
¡r
, 
u16
 *
»tuºV®ue
)

119 
u16
 
cu¼’tIndex
 = 0;

121 ià(
¡r
[1] == 'x')

122  
	`C¤HexSŒToUšt16
(
¡r
, 
»tuºV®ue
);

124 *
»tuºV®ue
 = 0;

125 ià((
¡r
[
cu¼’tIndex
] >= '0') && (str[currentIndex] <= '9')) {

126 
¡r
[
cu¼’tIndex
] >= '0' && str[currentIndex] <= '9') {

127 *
»tuºV®ue
 *= 10;

128 *
»tuºV®ue
 +ğ(
u8
)
¡r
[
cu¼’tIndex
++] - '0';

130  
Œue
;

132  
çl£
;

133 
	}
}

135 
boŞ
 
	$C¤WifiMibCÚv”tSŒToUšt32
(cÚ¡ *
¡r
, 
u32
 *
»tuºV®ue
)

137 
u16
 
cu¼’tIndex
 = 0;

139 ià(
¡r
[1] == 'x')

140  
	`C¤HexSŒToUšt32
(
¡r
, 
»tuºV®ue
);

142 *
»tuºV®ue
 = 0;

143 ià((
¡r
[
cu¼’tIndex
] >= '0') && (str[currentIndex] <= '9')) {

144 
¡r
[
cu¼’tIndex
] >= '0' && str[currentIndex] <= '9') {

145 *
»tuºV®ue
 *= 10;

146 *
»tuºV®ue
 +ğ(
u8
)
¡r
[
cu¼’tIndex
++] - '0';

148  
Œue
;

150  
çl£
;

151 
	}
}

153 
boŞ
 
	$C¤WifiMibCÚv”tTextP¬£Lše
(cÚ¡ *
lše¡r
, 
¦si_mib_d©a
 *
mibD©aS‘
, ¦si_mib_d©¨*
mibD©aG‘
)

155 
¦si_mib_’Œy
 
’Œy
;

156 
boŞ
 
»suÉ
 = 
Œue
;

157 
size_t
 
equ®s
 = 0;

158 
size_t
 
dÙ1
 = 0;

159 
size_t
 
dÙ2
 = 0;

160 
size_t
 
ŒimmedIndex
 = 0;

161 *
Œimmed
 = 
	`km®loc
(
	`¡¾’
(
lše¡r
è+ 1, 
GFP_KERNEL
);

162 cÚ¡ *
cu¼’t_ch¬
 = 
lše¡r
;

163 
boŞ
 
´oûssšgSŒ
 = 
çl£
;

165 ià(!
Œimmed
) {

166 
	`SLSI_ERR_NODEV
("Memory‡llocation failed!\n");

167  
çl£
;

169 
	`mem£t
(&
’Œy
, 0x00, (entry));

170 
cu¼’t_ch¬
[0] != '\0') {

171 ià(
cu¼’t_ch¬
[0] == '"')

172 
´oûssšgSŒ
 = !processingStr;

173 ià(!
´oûssšgSŒ
) {

174 ià(
cu¼’t_ch¬
[0] == '#')

176 ià(
	`C¤IsS·û
((
u8
)
cu¼’t_ch¬
[0])) {

177 
cu¼’t_ch¬
++;

180 ià(!
equ®s
 && (
cu¼’t_ch¬
[0] == '.')) {

181 ià(!
dÙ1
) {

182 
dÙ1
 = 
ŒimmedIndex
;

183 } ià(!
dÙ2
) {

184 
dÙ2
 = 
ŒimmedIndex
;

186 
	`SLSI_ERR_NODEV
("C¤WifiMibCÚv”tTextP¬£Lše('%s'èÚly 2 indexe suµÜ‹d", 
Œimmed
);

187 
»suÉ
 = 
çl£
;

190 ià(!
equ®s
 && (
cu¼’t_ch¬
[0] == '='))

191 
equ®s
 = 
ŒimmedIndex
;

193 
Œimmed
[
ŒimmedIndex
++] = 
cu¼’t_ch¬
[0];

195 
cu¼’t_ch¬
++;

197 
Œimmed
[
ŒimmedIndex
] = '\0';

199 ià(
	`¡¾’
(
Œimmed
) == 0) {

200 
	`kä“
(
Œimmed
);

201  
»suÉ
;

204 ià(
»suÉ
) {

205 
£p
 = 
Œimmed
[
dÙ1
 ? dÙ1 : 
equ®s
];

207 ià(
dÙ1
 || 
equ®s
)

208 
Œimmed
[
dÙ1
 ? dÙ1 : 
equ®s
] = '\0';

209 
Œimmed
[
dÙ1
 ? dÙ1 : 
equ®s
] = 
£p
;

211 ià(!
	`C¤WifiMibCÚv”tSŒToUšt16
(
Œimmed
, &
’Œy
.
psid
)) {

212 
	`SLSI_ERR_NODEV
("C¤WifiMibCÚv”tTextP¬£Lše('%s'èCÚv”ˆ<psid> faed", 
Œimmed
);

213 
»suÉ
 = 
çl£
;

215 ià(
dÙ1
 && !
	`C¤WifiMibCÚv”tSŒToUšt16
(&
Œimmed
[dÙ1 + 1], &
’Œy
.
šdex
[0])) {

216 
	`SLSI_ERR_NODEV
("C¤WifiMibCÚv”tTextP¬£Lše('%s'èCÚv”ˆ<šdex 1> faed", 
Œimmed
);

217 
»suÉ
 = 
çl£
;

219 ià(
dÙ2
 && !
	`C¤WifiMibCÚv”tSŒToUšt16
(&
Œimmed
[dÙ2 + 1], &
’Œy
.
šdex
[1])) {

220 
	`SLSI_ERR_NODEV
("C¤WifiMibCÚv”tTextP¬£Lše('%s'èCÚv”ˆ<šdex 2> faed", 
Œimmed
);

221 
»suÉ
 = 
çl£
;

224 ià(
»suÉ
 && !
equ®s
 && 
mibD©aG‘
) {

225 
’Œy
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_NONE
;

226 ()
	`¦si_mib_’code
(
mibD©aG‘
, &
’Œy
);

229 ià(
»suÉ
 && 
equ®s
 && 
mibD©aS‘
) {

230 *
d©a
 = &
Œimmed
[
equ®s
 + 1];

232 ià(
	`C¤SŒNICmp
(
d©a
, "true", 4) == 0) {

233 
’Œy
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_BOOL
;

234 
’Œy
.
v®ue
.
u
.
boŞV®ue
 = 1;

235 } ià(
	`C¤SŒNICmp
(
d©a
, "false", 5) == 0) {

236 
’Œy
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_BOOL
;

237 
’Œy
.
v®ue
.
u
.
boŞV®ue
 = 0;

238 } ià(
d©a
[0] == '"') {

240 
’Œy
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_OCTET
;

241 
’Œy
.
v®ue
.
u
.
où‘V®ue
.
d©aL’gth
 = (
u32
)
	`¡¾’
(&
d©a
[1]);

242 
’Œy
.
v®ue
.
u
.
où‘V®ue
.
d©a
 = (
u8
 *)
	`C¤SŒDup
(&data[1]);

243 
’Œy
.
v®ue
.
u
.
où‘V®ue
.
d©a
[’Œy.v®ue.u.où‘V®ue.
d©aL’gth
 - 1] = '\0';

244 } ià(
d©a
[0] == '[') {

246 
size_t
 
i
;

247 
u16
 
où‘L’
 = ((u16)
	`¡¾’
(&
d©a
[1]) - 1) / 2;

249 
’Œy
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_OCTET
;

250 
’Œy
.
v®ue
.
u
.
où‘V®ue
.
d©aL’gth
 = 
où‘L’
;

251 
’Œy
.
v®ue
.
u
.
où‘V®ue
.
d©a
 = 
	`km®loc
ÓÁry.v®ue.u.où‘V®ue.
d©aL’gth
 + 1, 
GFP_KERNEL
);

252 ià(!
’Œy
.
v®ue
.
u
.
où‘V®ue
.
d©a
) {

253 
	`SLSI_ERR_NODEV
("Memory‡llocation failed!\n");

254 
	`kä“
(
Œimmed
);

255  
çl£
;

257 
i
 = 0; i < 
où‘L’
; i++)

258 ià(!
	`C¤HexSŒToUšt8
(&
d©a
[1 + (
i
 * 2)], &
’Œy
.
v®ue
.
u
.
où‘V®ue
.data[i])) {

259 
	`SLSI_ERR_NODEV
("C¤WifiMibCÚv”tTextP¬£Lše('%s'èCÚv”ˆHex By‹ <d©a> faed", 
Œimmed
);

260 
»suÉ
 = 
çl£
;

263 
’Œy
.
v®ue
.
u
.
où‘V®ue
.
d©a
[
où‘L’
] = '\0';

264 } ià(
d©a
[0] == '-') {

266 
’Œy
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_INT
;

267 ià(!
	`C¤WifiMibCÚv”tSŒToUšt32
(&
d©a
[1], &
’Œy
.
v®ue
.
u
.
uštV®ue
)) {

268 
	`SLSI_ERR_NODEV
("C¤WifiMibCÚv”tTextP¬£Lše('%s'èCÚv”ˆIÁeg” <d©a> faed", 
Œimmed
);

269 
»suÉ
 = 
çl£
;

271 
’Œy
.
v®ue
.
u
.
štV®ue
 = (
s32
)(0 - (
u32
ëÁry.v®ue.u.
uštV®ue
);

273 } ià(!
	`C¤WifiMibCÚv”tSŒToUšt32
(
d©a
, &
’Œy
.
v®ue
.
u
.
uštV®ue
)) {

274 
	`SLSI_ERR_NODEV
("C¤WifiMibCÚv”tTextP¬£Lše('%s'èCÚv”ˆUnsigÃd IÁeg” <d©a> faed", 
Œimmed
);

275 
»suÉ
 = 
çl£
;

277 
’Œy
.
v®ue
.
ty³
 = 
SLSI_MIB_TYPE_UINT
;

279 ià(
»suÉ
)

280 ()
	`¦si_mib_’code
(
mibD©aS‘
, &
’Œy
);

281 ià(
’Œy
.
v®ue
.
ty³
 =ğ
SLSI_MIB_TYPE_OCTET
)

282 
	`kä“
(
’Œy
.
v®ue
.
u
.
où‘V®ue
.
d©a
);

286 
	`kä“
(
Œimmed
);

288  
»suÉ
;

289 
	}
}

291 
boŞ
 
	$C¤WifiMibCÚv”tTextAµ’d
(cÚ¡ *
mibText
, 
¦si_mib_d©a
 *
mibD©aS‘
, ¦si_mib_d©¨*
mibD©aG‘
)

293 
boŞ
 
»suÉ
 = 
Œue
;

294 cÚ¡ *
lšeS¹
 = 
mibText
;

295 cÚ¡ *
lšeEnd
 = 
mibText
;

297 ià(!
mibText
)

298  
çl£
;

300 
lšeEnd
[0] != '\0') {

301 ià((
lšeEnd
[0] == '\n') || (lineEnd[0] == '\r') || (lineEnd[1] == '\0')) {

302 
size_t
 
¡rSize
 = (size_t)(
lšeEnd
 - 
lšeS¹
);

304 ià((
lšeEnd
[1] == '\0'))

305 
¡rSize
++;

306 ià(
¡rSize
 > 2) {

307 *
lše
 = 
	`km®loc
(
¡rSize
 + 1, 
GFP_KERNEL
);

309 ià(!
lše
) {

310 
	`SLSI_ERR_NODEV
("MemÜy‡ÎoÿtiÚ faed!\n", 
lše
);

311  
çl£
;

313 ()
	`¡ºıy
(
lše
, 
lšeS¹
, 
¡rSize
);

314 
lše
[
¡rSize
] = '\0';

315 ià(!
	`C¤WifiMibCÚv”tTextP¬£Lše
(
lše
, 
mibD©aS‘
, 
mibD©aG‘
)) {

316 
	`SLSI_ERR_NODEV
("C¤WifiMibCÚv”tTextP¬£Lše(èFaed fÜ†š'%s'", 
lše
);

317 
»suÉ
 = 
çl£
;

319 
	`kä“
(
lše
);

321 
lšeEnd
++;

322 
lšeS¹
 = 
lšeEnd
;

325 
lšeEnd
++;

328  
»suÉ
;

329 
	}
}

331 
boŞ
 
	$C¤WifiMibCÚv”tText
(cÚ¡ *
mibText
, 
¦si_mib_d©a
 *
mibD©aS‘
, ¦si_mib_d©¨*
mibD©aG‘
)

333 ià(
mibD©aS‘
) {

334 
mibD©aS‘
->
d©a
 = 
NULL
;

335 
mibD©aS‘
->
d©aL’gth
 = 0;

337 ià(
mibD©aG‘
) {

338 
mibD©aG‘
->
d©a
 = 
NULL
;

339 
mibD©aG‘
->
d©aL’gth
 = 0;

342  
	`C¤WifiMibCÚv”tTextAµ’d
(
mibText
, 
mibD©aS‘
, 
mibD©aG‘
);

343 
	}
}

	@mib_text_convert.h

8 #iâdeà
MIB_TEXT_CONVERT_H__


9 
	#MIB_TEXT_CONVERT_H__


	)

11 
	~"mib.h
"

44 
boŞ
 
C¤WifiMibCÚv”tText
(cÚ¡ *
mibText
, 
¦si_mib_d©a
 *
mibD©aS‘
, ¦si_mib_d©¨*
mibD©aG‘
);

	@mlme.c

7 
	~<lšux/d–ay.h
>

8 
	~<Ãt/cfg80211.h
>

9 
	~<lšux/moduË.h
>

10 
	~<lšux/moduË·¿m.h
>

11 
	~<scsc/scsc_log_cŞËùÜ.h
>

13 
	~"dev.h
"

14 
	~"debug.h
"

15 
	~"mlme.h
"

16 
	~"mib.h
"

17 
	~"mgt.h
"

18 
	~"ÿc.h
"

20 
	#SLSI_SCAN_PRIVATE_IE_CHANNEL_LIST_HEADER_LEN
 7

	)

21 
	#SLSI_SCAN_PRIVATE_IE_SSID_FILTER_HEADER_LEN
 7

	)

22 
	#SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
 3

	)

23 
	#SLSI_CHANN_INFO_HT_SCB
 0x0100

	)

25 
	#SLSI_NOA_CONFIG_REQUEST_ID
 (1)

	)

26 
	#SLSI_MLME_ARP_DROP_FREE_SLOTS_COUNT
 16

	)

28 
boŞ
 
	gmissšg_cfm_šd_·nic
 = 
Œue
;

29 
moduË_·¿m
(
missšg_cfm_šd_·nic
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

30 
MODULE_PARM_DESC
(
missšg_cfm_šd_·nic
, "Panic on missing confirm or indication fromhe chip");

32 
	s¦si_mlme_rs£
 {

33 
u8
 
	mgroup_cs_couÁ
;

34 cÚ¡ 
u8
 *
	mgroup_cs
;

35 
u8
 
	m·œwi£_cs_couÁ
;

36 cÚ¡ 
u8
 *
	m·œwi£_cs
;

37 
u8
 
	makm_su™e_couÁ
;

38 cÚ¡ 
u8
 *
	makm_su™e
;

39 
u8
 
	mpmkid_couÁ
;

40 cÚ¡ 
u8
 *
	mpmkid
;

41 cÚ¡ 
u8
 *
	mgroup_mgmt_cs
;

44 
sk_buff
 *
	$¦si_mlme_wa™_fÜ_cfm
(
¦si_dev
 *
sdev
, 
¦si_sig_£nd
 *
sig_wa™
)

46 
sk_buff
 *
cfm
 = 
NULL
;

47 
tm
;

48 
r
;

49 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

51 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


52 
tm
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sig_wa™
->
com¶‘iÚ
, 
	`m£cs_to_jiff›s
(*
sdev
->
sig_wa™_cfm_timeout
 - (*sdev->sig_wait_cfm_timeout >> 2)));

53 ià(
tm
 == 0) {

54 
	`SLSI_ERR
(
sdev
, "Wa™šg cfm(0x%.4XèfÜ„eq(0x%04Xè£nd”id=0x%x,ryšgØscheduË wq mªu®ly\n", 
sig_wa™
->
cfm_id
, sig_wa™->
»q_id
, sig_wa™->
´oûss_id
);

55 
	`¦si_h_»´oûss_sk³d_ù¾_bh
(
sdev
);

56 
tm
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sig_wa™
->
com¶‘iÚ
, 
	`m£cs_to_jiff›s
(*
sdev
->
sig_wa™_cfm_timeout
 >> 2));

59 
tm
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sig_wa™
->
com¶‘iÚ
, 
	`m£cs_to_jiff›s
(*
sdev
->
sig_wa™_cfm_timeout
));

62 
	`¥š_lock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

65 ià(!
sig_wa™
->
cfm
) {

66 
	`SLSI_ERR
(
sdev
, "NØcfm(0x%.4XèfÜ„eq(0x%04Xè£nd”id=0x%x\n", 
sig_wa™
->
cfm_id
, sig_wa™->
»q_id
, sig_wa™->
´oûss_id
);

67 ià(
tm
 == 0) {

68 
»asÚ
[80];

70 
	`WARN
(1, "Timeouˆ- cÚfœm 0x%04x‚Ù„eûived from ch\n", 
sig_wa™
->
cfm_id
);

71 ià(
missšg_cfm_šd_·nic
) {

72 
	`¢´štf
(
»asÚ
, (reason), "Timed out while waiting forhe cfm(0x%.4x) for„eq(0x%04x)",

73 
sig_wa™
->
cfm_id
, sig_wa™->
»q_id
);

75 
	`¥š_uÆock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

77 
sdev
->
mlme_blocked
 = 
Œue
;

78 
	`queue_wÜk
(
sdev
->
deviû_wq
, &sdev->
Œigg”_wÏn_ç_wÜk
);

79 
r
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sdev
->
£rviû_ç_¡¬‹d_šdiÿtiÚ
,

80 
	`m£cs_to_jiff›s
(
SLSI_WLAN_FAIL_WORK_TIMEOUT
));

81 ià(
r
 == 0) {

82 
	`SLSI_INFO
(
sdev
, "service_fail_started_indicationimeout\n");

83 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "service_fail_started_indicationimeout in cfm\n");

84 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

87 
	`¥š_lock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

90 
	`WARN
(1, "CÚfœm 0x%04x†o¡\n", 
sig_wa™
->
cfm_id
);

93 
	`WARN_ON
(
	`çpi_g‘_u16
(
sig_wa™
->
cfm
, 
»ûiv”_pid
è!ğsig_wa™->
´oûss_id
);

94 
	`WARN_ON
(
	`çpi_g‘_u16
(
sig_wa™
->
cfm
, 
id
è!ğsig_wa™->
cfm_id
);

97 
sig_wa™
->
cfm_id
 = 0;

98 
cfm
 = 
sig_wa™
->cfm;

99 
sig_wa™
->
cfm
 = 
NULL
;

100 ià(!
cfm
)

101 
sig_wa™
->
šd_id
 = 0;

103 
	`¥š_uÆock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

105  
cfm
;

106 
	}
}

108 
	$·nic_Ú_lo¡_šd
(
u16
 
šd_id
)

110 ià(
šd_id
 =ğ
MLME_SCAN_DONE_IND
)

113 
	}
}

115 
sk_buff
 *
	$¦si_mlme_wa™_fÜ_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_sig_£nd
 *
sig_wa™
, 
u16
 
šd_id
)

117 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

118 
sk_buff
 *
šd
 = 
NULL
;

119 
tm
 = 0;

120 
r
 = 0;

121 
log_to_sys_”rÜ_bufãr
[128] = { 0 };

129 ià(
šd_id
 =ğ
MLME_SCAN_DONE_IND
)

131 
tm
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sig_wa™
->
com¶‘iÚ
, 
	`m£cs_to_jiff›s
(
SLSI_SCAN_DONE_IND_WAIT_TIMEOUT
));

132 ià((
šd_id
 =ğ
MLME_DISCONNECT_IND
è&& (
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
))

133 
tm
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sig_wa™
->
com¶‘iÚ
, 
	`m£cs_to_jiff›s
(
sdev
->
deviû_cÚfig
.
­_discÚÃù_šd_timeout
));

135 
tm
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sig_wa™
->
com¶‘iÚ
, 
	`m£cs_to_jiff›s
(*
sdev
->
sig_wa™_cfm_timeout
));

137 
	`¥š_lock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

140 ià(!
sig_wa™
->
šd
) {

141 
	`SLSI_ERR
(
sdev
, "NØšd(0x%.4XèfÜ„eq(0x%04Xè£nd”id=0x%x\n", 
sig_wa™
->
šd_id
, sig_wa™->
»q_id
, sig_wa™->
´oûss_id
);

142 ià(
tm
 == 0) {

143 
»asÚ
[80];

145 
	`WARN
(1, "Timeouˆ- indiÿtiÚ 0x%04x‚Ù„eûived from ch\n", 
sig_wa™
->
šd_id
);

146 ià(
missšg_cfm_šd_·nic
 && 
	`·nic_Ú_lo¡_šd
(
šd_id
)) {

147 
	`¢´štf
(
»asÚ
, (reason), "Timed out while waiting forhe ind(0x%.4x) for„eq(0x%04x)",

148 
sig_wa™
->
šd_id
, sig_wa™->
»q_id
);

150 
	`¥š_uÆock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

152 
sdev
->
mlme_blocked
 = 
Œue
;

153 
	`queue_wÜk
(
sdev
->
deviû_wq
, &sdev->
Œigg”_wÏn_ç_wÜk
);

154 
r
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sdev
->
£rviû_ç_¡¬‹d_šdiÿtiÚ
,

155 
	`m£cs_to_jiff›s
(
SLSI_WLAN_FAIL_WORK_TIMEOUT
));

156 ià(
r
 == 0) {

157 
	`SLSI_INFO
(
sdev
, "service_fail_started_indicationimeout\n");

158 
	`¥rštf
(
log_to_sys_”rÜ_bufãr
, "service_fail_started_indicationimeout in ind\n");

159 
	`¦si_add_log_to_sy¡em_”rÜ_bufãr
(
sdev
, 
log_to_sys_”rÜ_bufãr
);

161 
	`¥š_lock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

164 
	`WARN
(1, "IndiÿtiÚ 0x%04x†o¡\n", 
sig_wa™
->
šd_id
);

167 
	`WARN_ON
(
	`çpi_g‘_u16
(
sig_wa™
->
šd
, 
»ûiv”_pid
è!ğsig_wa™->
´oûss_id
);

168 ià(!(
sig_wa™
->
šd_id
 =ğ
MLME_DISCONNECT_IND
 && 
	`çpi_g‘_u16
(sig_wa™->
šd
, 
id
è=ğ
MLME_DISCONNECTED_IND
))

169 
	`WARN_ON
(
	`çpi_g‘_u16
(
sig_wa™
->
šd
, 
id
è!ğsig_wa™->
šd_id
);

172 
sig_wa™
->
šd_id
 = 0;

173 
šd
 = 
sig_wa™
->ind;

174 
sig_wa™
->
šd
 = 
NULL
;

176 
	`¥š_uÆock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

178  
šd
;

179 
	}
}

186 
sk_buff
 *
	$¦si_mlme_tx_rx
(
¦si_dev
 *
sdev
,

187 
Ãt_deviû
 *
dev
,

188 
sk_buff
 *
skb
,

189 
u16
 
cfm_id
,

190 
sk_buff
 **
mib_”rÜ
,

191 
u16
 
šd_id
,

192 
	$boŞ
 (*
v®id©e_cfm_wa™_šd
)(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
cfm
))

194 
sk_buff
 *
rx
 = 
NULL
;

195 
”r
;

196 
u16
 
»q_id
 = 
	`çpi_g‘_u16
(
skb
, 
id
);

197 
¦si_sig_£nd
 *
sig_wa™
 = &
sdev
->sig_wait;

199 ià(
dev
) {

200 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

202 
sig_wa™
 = &
ndev_vif
->sig_wait;

204 #ifdeà
SLSI_TEST_DEV


205 ià(
sdev
->
mlme_blocked
) {

206 
	`SLSI_DBG3
(
sdev
, 
SLSI_TX
, "Rejeùed. mlme_blocked=%d\n", sdev->
mlme_blocked
);

207 
	`kä“_skb
(
skb
);

208  
NULL
;

211 ià(
sdev
->
mlme_blocked
 || !sdev->
wÏn_£rviû_Ú
) {

212 
	`SLSI_DBG3
(
sdev
, 
SLSI_TX
, "Rejeùed. mlme_blocked=%d, wÏn_£rviû_Ú=%d\n", sdev->
mlme_blocked
,

213 
sdev
->
wÏn_£rviû_Ú
);

214 
	`kä“_skb
(
skb
);

215  
NULL
;

219 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

220 
	`SLSI_MUTEX_LOCK
(
sig_wa™
->
mu‹x
);

222 
	`¥š_lock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

223 ià(++
sig_wa™
->
´oûss_id
 > 
SLSI_TX_PROCESS_ID_MAX
)

224 
sig_wa™
->
´oûss_id
 = 
SLSI_TX_PROCESS_ID_MIN
;

226 
	`WARN_ON
(
sig_wa™
->
cfm
);

227 
	`WARN_ON
(
sig_wa™
->
šd
);

228 
	`kä“_skb
(
sig_wa™
->
cfm
);

229 
	`kä“_skb
(
sig_wa™
->
šd
);

230 
	`kä“_skb
(
sig_wa™
->
mib_”rÜ
);

231 
sig_wa™
->
cfm
 = 
NULL
;

232 
sig_wa™
->
šd
 = 
NULL
;

233 
sig_wa™
->
mib_”rÜ
 = 
NULL
;

234 
sig_wa™
->
»q_id
 =„eq_id;

235 
sig_wa™
->
cfm_id
 = cfm_id;

236 
sig_wa™
->
šd_id
 = ind_id;

238 
	`çpi_£t_u16
(
skb
, 
£nd”_pid
, 
sig_wa™
->
´oûss_id
);

239 
	`¥š_uÆock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

241 
”r
 = 
	`¦si_tx_cÚŒŞ
(
sdev
, 
dev
, 
skb
);

242 ià(
”r
 != 0) {

243 
	`SLSI_ERR
(
sdev
, "FaedØ£nd mlmsigÇl:0x%.4X,ƒ¼=%d\n", 
»q_id
, 
”r
);

244 
	`kä“_skb
(
skb
);

245 
ş—n_ex™
;

248 ià(
cfm_id
) {

249 
rx
 = 
	`¦si_mlme_wa™_fÜ_cfm
(
sdev
, 
sig_wa™
);

250 ià(
rx
 && 
šd_id
) {

252 ià(
	`v®id©e_cfm_wa™_šd
(
sdev
, 
dev
, 
rx
)) {

253 
rx
 = 
	`¦si_mlme_wa™_fÜ_šd
(
sdev
, 
dev
, 
sig_wa™
, 
šd_id
);

255 
sig_wa™
->
šd_id
 = 0;

256 
rx
 = 
NULL
;

259 } ià(
šd_id
) {

260 
rx
 = 
	`¦si_mlme_wa™_fÜ_šd
(
sdev
, 
dev
, 
sig_wa™
, 
šd_id
);

264 
	`WARN_ON
(
sig_wa™
->
cfm_id
);

265 
	`WARN_ON
(
sig_wa™
->
šd_id
);

266 
	`WARN_ON
(
sig_wa™
->
cfm
);

267 
	`WARN_ON
(
sig_wa™
->
šd
);

268 
ş—n_ex™
:

270 
	`¥š_lock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

272 
sig_wa™
->
»q_id
 = 0;

273 
sig_wa™
->
cfm_id
 = 0;

274 
sig_wa™
->
šd_id
 = 0;

275 
	`kä“_skb
(
sig_wa™
->
cfm
);

276 
	`kä“_skb
(
sig_wa™
->
šd
);

277 
sig_wa™
->
cfm
 = 
NULL
;

278 
sig_wa™
->
šd
 = 
NULL
;

280 ià(
mib_”rÜ
)

281 *
mib_”rÜ
 = 
sig_wa™
->mib_error;

283 
	`kä“_skb
(
sig_wa™
->
mib_”rÜ
);

284 
sig_wa™
->
mib_”rÜ
 = 
NULL
;

285 
	`¥š_uÆock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

287 
	`SLSI_MUTEX_UNLOCK
(
sig_wa™
->
mu‹x
);

289 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

290  
rx
;

291 
	}
}

296 
	$¦si_mlme_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

298 
»t
 = 0;

299 
¦si_sig_£nd
 *
sig_wa™
 = &
sdev
->sig_wait;

301 ià(
dev
) {

302 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

304 
sig_wa™
 = &
ndev_vif
->sig_wait;

306 
	`¥š_lock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

307 ià(++
sig_wa™
->
´oûss_id
 > 
SLSI_TX_PROCESS_ID_MAX
)

308 
sig_wa™
->
´oûss_id
 = 
SLSI_TX_PROCESS_ID_MIN
;

309 
	`çpi_£t_u16
(
skb
, 
£nd”_pid
, 
sig_wa™
->
´oûss_id
);

310 
	`¥š_uÆock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

312 
»t
 = 
	`¦si_tx_cÚŒŞ
(
sdev
, 
dev
, 
skb
);

313 ià(
»t
)

314 
	`kä“_skb
(
skb
);

315  
»t
;

316 
	}
}

318 
sk_buff
 *
	$¦si_mlme_»q_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
u16
 
šd_id
)

320 ià(
	`WARN_ON
(!
šd_id
))

321 
”r
;

322  
	`¦si_mlme_tx_rx
(
sdev
, 
dev
, 
skb
, 0, 
NULL
, 
šd_id
, NULL);

323 
”r
:

324 
	`kä“_skb
(
skb
);

325  
NULL
;

326 
	}
}

328 
sk_buff
 *
	$¦si_mlme_»q_no_cfm
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

330  
	`¦si_mlme_tx_rx
(
sdev
, 
dev
, 
skb
, 0, 
NULL
, 0, NULL);

331 
	}
}

333 
sk_buff
 *
	$¦si_mlme_»q_cfm
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
u16
 
cfm_id
)

335 ià(
	`WARN_ON
(!
cfm_id
))

336 
”r
;

337  
	`¦si_mlme_tx_rx
(
sdev
, 
dev
, 
skb
, 
cfm_id
, 
NULL
, 0, NULL);

338 
”r
:

339 
	`kä“_skb
(
skb
);

340  
NULL
;

341 
	}
}

344 
šlše
 
sk_buff
 *
	$¦si_mlme_»q_cfm_mib
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
u16
 
cfm_id
, sk_bufà**
mib_”rÜ
)

346 ià(
	`WARN_ON
(!
cfm_id
))

347 
”r
;

348 ià(
	`WARN_ON
(!
mib_”rÜ
))

349 
”r
;

350  
	`¦si_mlme_tx_rx
(
sdev
, 
dev
, 
skb
, 
cfm_id
, 
mib_”rÜ
, 0, 
NULL
);

351 
”r
:

352 
	`kä“_skb
(
skb
);

353  
NULL
;

354 
	}
}

357 
sk_buff
 *
	$¦si_mlme_»q_cfm_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
,

358 
u16
 
cfm_id
, u16 
šd_id
,

359 
	$boŞ
 (*
v®id©e_cfm_wa™_šd
)(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
cfm
))

361 ià(
	`WARN_ON
(!
cfm_id
))

362 
”r
;

363 ià(
	`WARN_ON
(!
šd_id
))

364 
”r
;

365 ià(
	`WARN_ON
(!
v®id©e_cfm_wa™_šd
))

366 
”r
;

368  
	`¦si_mlme_tx_rx
(
sdev
, 
dev
, 
skb
, 
cfm_id
, 
NULL
, 
šd_id
, 
v®id©e_cfm_wa™_šd
);

370 
”r
:

371 
	`kä“_skb
(
skb
);

372  
NULL
;

373 
	}
}

375 
›“80211_»g_ruË
 *
	$¦si_g‘_»g_ruË
(
u32
 
ûÁ”_äeq
, 
¦si_802_11d_»g_domaš
 *
domaš_šfo
)

377 
›“80211_»g_ruË
 *
ruË
;

378 
i
;

380 
i
 = 0; i < 
domaš_šfo
->
»gdomaš
->
n_»g_ruËs
; i++) {

381 
ruË
 = &
domaš_šfo
->
»gdomaš
->
»g_ruËs
[
i
];

384 ià(((
ûÁ”_äeq
 - 
	`MHZ_TO_KHZ
(10)è>ğ
ruË
->
äeq_¿nge
.
¡¬t_äeq_khz
) &&

385 ((
ûÁ”_äeq
 + 
	`MHZ_TO_KHZ
(10)è<ğ
ruË
->
äeq_¿nge
.
’d_äeq_khz
))

386  
ruË
;

389  
NULL
;

390 
	}
}

392 
u16
 
	$¦si_compu‹_chªn_šfo
(
¦si_dev
 *
sdev
, 
u16
 
width
, u16 
ûÁ”_äeq0
, u16 
chªÃl_äeq
)

394 
u16
 
chªn_šfo
;

395 
u16
 
´im_chª_pos
 = 0;

397 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "compute channel info\n");

398 
width
) {

399 
NL80211_CHAN_WIDTH_20
:

400 
chªn_šfo
 = 20;

402 
NL80211_CHAN_WIDTH_40
:

403 
chªn_šfo
 = 40;

405 ià(
ûÁ”_äeq0
 < 
chªÃl_äeq
)

406 
chªn_šfo
 |ğ
SLSI_CHANN_INFO_HT_SCB
;

408 
NL80211_CHAN_WIDTH_80
:

410 
´im_chª_pos
 = ((30 + 
chªÃl_äeq
 - 
ûÁ”_äeq0
) / 20);

411 ià(
´im_chª_pos
 > 3) {

412 
	`SLSI_ERR
(
sdev
, "Invalid center_freq0 in chandef : %u,…rimary channel = %u,"

413 "´im¬y chª…o ÿlcuÏ‹d = %d\n", 
ûÁ”_äeq0
, 
chªÃl_äeq
, 
´im_chª_pos
);

414 
´im_chª_pos
 = 0;

416 
´im_chª_pos
 = 0xFFFF & (prim_chan_pos << 8);

417 
chªn_šfo
 = 80 | 
´im_chª_pos
;

420 
	`SLSI_WARN
(
sdev
, "Inv®id chªdef.width(0x%x)\n", 
width
);

421 
chªn_šfo
 = 0;

425 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "chªÃl_width:%u, chªn_šfo:0x%x\n", 
width
, 
chªn_šfo
);

426  
chªn_šfo
;

427 
	}
}

429 
u16
 
	$¦si_g‘_chªn_šfo
(
¦si_dev
 *
sdev
, 
cfg80211_chª_def
 *
chªdef
)

431 
u16
 
chªn_šfo
 = 0;

433 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

435 ià(
chªdef
->
width
 =ğ
NL80211_CHAN_WIDTH_20
 || chªdef->width =ğ
NL80211_CHAN_WIDTH_20_NOHT
) {

436 
chªn_šfo
 = 20;

437 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "chªÃl_width:%u, chªn_šfo:0x%x\n", 
chªdef
->
width
, 
chªn_šfo
);

438 } ià(
chªdef
->
chª
) {

439 
chªn_šfo
 = 
	`¦si_compu‹_chªn_šfo
(
sdev
, 
chªdef
->
width
, chªdef->
ûÁ”_äeq1
,

440 
chªdef
->
chª
->
ûÁ”_äeq
);

442  
chªn_šfo
;

443 
	}
}

445 
	$¦si_check_chªÃliz©iÚ
(
¦si_dev
 *
sdev
, 
cfg80211_chª_def
 *
chªdef
,

446 
wifi_sh¬šg_chªÃl_sw™ched
)

448 
u8
 
width
;

449 
›“80211_»g_ruË
 *
ruË
 = 
NULL
;

450 
›“80211_chªÃl
 *
chªÃl
 = 
NULL
;

451 
u32
 
»f_æags
;

453 
chªdef
->
width
) {

454 
NL80211_CHAN_WIDTH_20
:

455 
NL80211_CHAN_WIDTH_20_NOHT
:

456 
width
 = 20;

458 
NL80211_CHAN_WIDTH_40
:

459 
width
 = 40;

461 
NL80211_CHAN_WIDTH_80
:

462 
width
 = 80;

465 
	`SLSI_ERR
(
sdev
, "Inv®id chªdef.width(0x%x)\n", 
chªdef
->
width
);

466  -
EINVAL
;

469 
chªÃl
 = 
	`›“80211_g‘_chªÃl
(
sdev
->
why
, 
chªdef
->
chª
->
ûÁ”_äeq
);

470 ià(!
chªÃl
) {

471 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ%d u£dØ¡¬ˆAP. ChªÃÈnÙ found\n", 
chªdef
->
chª
->
ûÁ”_äeq
);

472  -
EINVAL
;

475 ià(
wifi_sh¬šg_chªÃl_sw™ched
 == 1)

476 
»f_æags
 = 
IEEE80211_CHAN_DISABLED
;

478 
»f_æags
 = 
IEEE80211_CHAN_DISABLED
 | 
IEEE80211_CHAN_RADAR
;

480 ià(
chªÃl
->
æags
 & 
»f_æags
) {

481 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ%d u£dØ¡¬ˆAP\n", 
chªdef
->
chª
->
ûÁ”_äeq
);

482  -
EINVAL
;

484 
ruË
 = 
	`¦si_g‘_»g_ruË
(
	`MHZ_TO_KHZ
(
chªdef
->
ûÁ”_äeq1
), &
sdev
->
deviû_cÚfig
.
domaš_šfo
);

485 ià(!
ruË
) {

486 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ%d u£dØ¡¬ˆAP. NØ»g„uË found fÜhi chªÃl\n", 
chªdef
->
chª
->
ûÁ”_äeq
);

487  -
EINVAL
;

490 ià(
	`MHZ_TO_KHZ
(
width
è<ğ
ruË
->
äeq_¿nge
.
max_bªdwidth_khz
) {

491 
u32
 
width_bound¬y1
, 
width_bound¬y2
;

493 
width_bound¬y1
 = 
	`MHZ_TO_KHZ
(
chªdef
->
ûÁ”_äeq1
 - 
width
 / 2);

494 
width_bound¬y2
 = 
	`MHZ_TO_KHZ
(
chªdef
->
ûÁ”_äeq1
 + 
width
 / 2);

495 ià((
width_bound¬y1
 >ğ
ruË
->
äeq_¿nge
.
¡¬t_äeq_khz
è&& (
width_bound¬y2
 <ğruË->äeq_¿nge.
’d_äeq_khz
))

497 
	`SLSI_ERR
(
sdev
, "Inv®id chªÃÈ%d u£dØ¡¬ˆAP. ChªÃÈnÙ w™hš f»qu’cy„ªgoàth»g„uË\n", 
chªdef
->
chª
->
ûÁ”_äeq
);

498  -
EINVAL
;

500  -
EINVAL
;

501 
	}
}

506 
	$mib_bufãr_dump_to_log
(
¦si_dev
 *
sdev
, 
u8
 *
mib_bufãr
, 
mib_bufãr_Ën
)

508 
size_t
 
mib_decode_»suÉ
;

509 
size_t
 
off£t
 = 0;

510 
¦si_mib_’Œy
 
decoded_mib_v®ue
;

511 
¦si_mib_d©a
 
mibd©a
;

512 
”rÜ_out_Ën
 = 
mib_bufãr_Ën
 * 3;

513 
”rÜ_out_pos
 = 0;

514 *
”rÜ_out
;

516 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

518 
	`FUNC_ENTER
(
sdev
);

519 
	`SLSI_ERR
(
sdev
, "MIB bufã¸Ëngth: %u. MIB E¼Ü (decoded):", 
mib_bufãr_Ën
);

521 ià(!
mib_bufãr
) {

522 
	`SLSI_ERR
(
sdev
, "MIB buffer…ointer is NULL - can‚ot decode MIB keys\n");

525 
”rÜ_out
 = 
	`km®loc
(
”rÜ_out_Ën
, 
GFP_KERNEL
);

527 
off£t
 < 
mib_bufãr_Ën
) {

528 
”rÜ_out_pos
 = 0;

529 
mibd©a
.
d©a
 = &
mib_bufãr
[
off£t
];

530 
mibd©a
.
d©aL’gth
 = 
mib_bufãr_Ën
 - 
off£t
;

532 
mib_decode_»suÉ
 = 
	`¦si_mib_decode
(&
mibd©a
, &
decoded_mib_v®ue
);

533 ià(!
mib_decode_»suÉ
) {

534 
	`SLSI_ERR_HEX
(
sdev
, 
mibd©a
.
d©a
, mibd©a.
d©aL’gth
, "slsi_mib_decode() Failedo Decode:\n");

538 
off£t
 +ğ
mib_decode_»suÉ
;

540 
”rÜ_out_pos
 +ğ
	`¢´štf
(
”rÜ_out
 +ƒ¼Ü_out_pos, 
”rÜ_out_Ën
 -ƒ¼Ü_out_pos, "%d", ()(
decoded_mib_v®ue
.
psid
));

541 ià(
decoded_mib_v®ue
.
šdex
[0]) {

542 
”rÜ_out_pos
 +ğ
	`¢´štf
(
”rÜ_out
 +ƒ¼Ü_out_pos, 
”rÜ_out_Ën
 -ƒ¼Ü_out_pos, ".%d", ()(
decoded_mib_v®ue
.
šdex
[0]));

543 ià(
decoded_mib_v®ue
.
šdex
[1])

544 
”rÜ_out_pos
 +ğ
	`¢´štf
(
”rÜ_out
 +ƒ¼Ü_out_pos, 
”rÜ_out_Ën
 -ƒ¼Ü_out_pos, ".%d", ()(
decoded_mib_v®ue
.
šdex
[1]));

547 
decoded_mib_v®ue
.
v®ue
.
ty³
) {

548 
SLSI_MIB_TYPE_BOOL
:

549 
”rÜ_out_pos
 +ğ
	`¢´štf
(
”rÜ_out
 +ƒ¼Ü_out_pos, 
”rÜ_out_Ën
 -ƒ¼Ü_out_pos, "=%s\n", 
decoded_mib_v®ue
.
v®ue
.
u
.
boŞV®ue
 ? "TRUE" : "FALSE");

551 
SLSI_MIB_TYPE_UINT
:

552 
”rÜ_out_pos
 +ğ
	`¢´štf
(
”rÜ_out
 +ƒ¼Ü_out_pos, 
”rÜ_out_Ën
 -ƒ¼Ü_out_pos, "=%d\n", ()
decoded_mib_v®ue
.
v®ue
.
u
.
uštV®ue
);

554 
SLSI_MIB_TYPE_INT
:

555 
”rÜ_out_pos
 +ğ
	`¢´štf
(
”rÜ_out
 +ƒ¼Ü_out_pos, 
”rÜ_out_Ën
 -ƒ¼Ü_out_pos, "=%d\n", ()
decoded_mib_v®ue
.
v®ue
.
u
.
štV®ue
);

557 
SLSI_MIB_TYPE_OCTET
:

559 
u32
 
i
;

561 
”rÜ_out_pos
 +ğ
	`¢´štf
(
”rÜ_out
 +ƒ¼Ü_out_pos, 
”rÜ_out_Ën
 -ƒrror_out_pos, "=[");

562 
i
 = 0; i < 
decoded_mib_v®ue
.
v®ue
.
u
.
où‘V®ue
.
d©aL’gth
; i++)

563 
”rÜ_out_pos
 +ğ
	`¢´štf
(
”rÜ_out
 +ƒ¼Ü_out_pos, 
”rÜ_out_Ën
 -ƒ¼Ü_out_pos, "%.2X", ()
decoded_mib_v®ue
.
v®ue
.
u
.
où‘V®ue
.
d©a
[
i
]);

564 
”rÜ_out_pos
 +ğ
	`¢´štf
(
”rÜ_out
 +ƒ¼Ü_out_pos, 
”rÜ_out_Ën
 -ƒrror_out_pos, "]\n");

568 
”rÜ_out_pos
 +ğ
	`¢´štf
(
”rÜ_out
 +ƒ¼Ü_out_pos, 
”rÜ_out_Ën
 -ƒrror_out_pos, "=Can‚ot decode MIB keyype\n");

572 
	`SLSI_INFO_NODEV
("%s", 
”rÜ_out
);

574 
	`kä“
(
”rÜ_out
);

575 
	`FUNC_EXIT
(
sdev
);

576 
	}
}

578 
	$¦si_mlme_£t__add»ss
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

580 
sk_buff
 *
»q
;

581 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

582 
sk_buff
 *
cfm
;

583 
r
 = 0;

584 
u32
 
addr
;

585 
u8
 
muÉiÿ¡_add
[
ETH_ALEN
] = { 0xff, 0xff, 0xff, 0xff, 0xff, 0xff };

587 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

588 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_SET_IP_ADDRESS.request\n");

589  -
EOPNOTSUPP
;

592 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

594 
»q
 = 
	`çpi_®loc
(
mlme_£t__add»ss_»q
, 
MLME_SET_IP_ADDRESS_REQ
, 
ndev_vif
->
iâum
, Òdev_vif->
add»ss
));

595 ià(!
»q
)

596  -
ENOMEM
;

598 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t__add»ss_»q
.
_v”siÚ
, 4);

599 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_£t__add»ss_»q
.
muÉiÿ¡_add»ss
, 
muÉiÿ¡_add
);

601 
addr
 = 
	`htÚl
(
	`be32_to_ıu
(
ndev_vif
->
add»ss
));

602 
	`çpi_­³nd_d©a
(
»q
, (cÚ¡ 
u8
 *)(&
addr
), (ipaddr));

604 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "¦si_mlme_£t__add»ss(vif: %d, IP: %pI4)\n", 
ndev_vif
->
iâum
, &ndev_vif->
add»ss
);

605 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_IP_ADDRESS_CFM
);

606 ià(!
cfm
)

607  -
EIO
;

609 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t__add»ss_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

610 
	`SLSI_NET_ERR
(
dev
, "mlme_£t__add»ss_cfmÔesuÉ:0x%04xèERROR\n", 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t__add»ss_cfm
.
»suÉ_code
));

611 
r
 = -
EINVAL
;

614 
	`kä“_skb
(
cfm
);

615  
r
;

616 
	}
}

618 #ià
IS_ENABLED
(
CONFIG_IPV6
)

619 
	$¦si_mlme_£t_v6_add»ss
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

621 
sk_buff
 *
»q
;

622 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

623 
sk_buff
 *
cfm
;

624 
r
 = 0;

625 
u8
 
sŞic™ed_node_addr
[
ETH_ALEN
] = { 0x33, 0x33, 0xff, 0x00, 0x00, 0x00 };

627 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

628 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_SET_IP_ADDRESS.request\n");

629  -
EOPNOTSUPP
;

632 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

634 
»q
 = 
	`çpi_®loc
(
mlme_£t__add»ss_»q
, 
MLME_SET_IP_ADDRESS_REQ
, 
ndev_vif
->
iâum
, 16);

635 ià(!
»q
)

636  -
ENOMEM
;

638 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t__add»ss_»q
.
_v”siÚ
, 6);

640 ià(
ndev_vif
->
¡a
.
nd_ofæßd_’abËd
 == 1) {

641 
	`¦si_¥šlock_lock
(&
ndev_vif
->
v6addr_lock
);

642 
	`memıy
(&
sŞic™ed_node_addr
[3], &
ndev_vif
->
v6add»ss
.
s6_addr
[13], 3);

643 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
v6addr_lock
);

645 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_£t__add»ss_»q
.
muÉiÿ¡_add»ss
, 
sŞic™ed_node_addr
);

646 
	`çpi_­³nd_d©a
(
»q
, 
ndev_vif
->
v6add»ss
.
s6_addr
, 16);

647 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "mlme_£t__add»ss_»q(vif: %d, IP: %pI6)\n", 
ndev_vif
->
iâum
,

648 &
ndev_vif
->
v6add»ss
);

650 
u8
 
node_addr_nd_di§bË
[16];

652 
	`mem£t
(&
node_addr_nd_di§bË
, 0, (node_addr_nd_disable));

653 
	`çpi_­³nd_d©a
(
»q
, 
node_addr_nd_di§bË
, 16);

654 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "mlme_set_ip_address_req(vif: %d, IP-setting ip‡ddresso‡ll zeros)\n",

655 
ndev_vif
->
iâum
);

658 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_IP_ADDRESS_CFM
);

659 ià(!
cfm
)

660  -
EIO
;

662 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t__add»ss_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

663 
	`SLSI_NET_ERR
(
dev
, "mlme_set_ip_address_cfm(result:0x%04x) ERROR\n",

664 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t__add»ss_cfm
.
»suÉ_code
));

665 
r
 = -
EINVAL
;

667 
	`kä“_skb
(
cfm
);

668  
r
;

669 
	}
}

672 
	$¦si_mlme_£t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
mib
, 
mib_Ën
)

674 
sk_buff
 *
»q
;

675 
sk_buff
 *
cfm
;

676 
r
 = 0;

677 
u16
 
iâum
 = 0;

679 ià(
dev
) {

680 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

682 
iâum
 = 
ndev_vif
->ifnum;

684 ià(
iâum
 && !
ndev_vif
->
is_avaabË
)

685  -
ENODEV
;

688 
»q
 = 
	`çpi_®loc
(
mlme_£t_»q
, 
MLME_SET_REQ
, 
iâum
, 
mib_Ën
);

689 ià(!
»q
)

690  -
ENOMEM
;

692 
	`çpi_­³nd_d©a
(
»q
, 
mib
, 
mib_Ën
);

694 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_CFM
);

695 ià(!
cfm
)

696  -
EIO
;

698 ià(
	`çpi_g‘_d©®’
(
cfm
)) {

699 
	`mib_bufãr_dump_to_log
(
sdev
, 
	`çpi_g‘_d©a
(
cfm
), 
	`çpi_g‘_d©®’
(cfm));

700 
r
 = -
EINVAL
;

703 
	`kä“_skb
(
cfm
);

705  
r
;

706 
	}
}

708 
	$¦si_mlme_g‘
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
mib
, 
mib_Ën
, u8 *
»¥
,

709 
»¥_buf_Ën
, *
»¥_Ën
)

711 
sk_buff
 *
»q
;

712 
sk_buff
 *
”r
 = 
NULL
;

713 
sk_buff
 *
cfm
;

714 
r
 = 0;

715 
u16
 
iâum
 = 0;

717 *
»¥_Ën
 = 0;

719 ià(
dev
) {

720 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

722 
iâum
 = 
ndev_vif
->ifnum;

724 ià(
iâum
 && !
ndev_vif
->
is_avaabË
)

725  -
ENODEV
;

727 
»q
 = 
	`çpi_®loc
(
mlme_g‘_»q
, 
MLME_GET_REQ
, 
iâum
, 
mib_Ën
);

728 ià(!
»q
)

729  -
ENOMEM
;

730 
	`çpi_­³nd_d©a
(
»q
, 
mib
, 
mib_Ën
);

732 
cfm
 = 
	`¦si_mlme_»q_cfm_mib
(
sdev
, 
dev
, 
»q
, 
MLME_GET_CFM
, &
”r
);

733 ià(!
cfm
)

734  -
EIO
;

736 ià(
”r
) {

737 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "ERROR: mlme_get_cfm with mibƒrror\n");

738 
	`mib_bufãr_dump_to_log
(
sdev
, 
	`çpi_g‘_d©a
(
”r
), 
	`çpi_g‘_d©®’
(err));

739 
	`LOG_CONDITIONALLY
(
	`çpi_g‘_d©®’
(
cfm
è> 
»¥_buf_Ën
,

740 
	`SLSI_ERR
(
sdev
, "Insufficient„esp_buf_len(%d). mlme_get_cfm(%d)\n",

741 
»¥_buf_Ën
, 
	`çpi_g‘_d©®’
(
cfm
)));

742 
r
 = -
EINVAL
;

748 ià(
	`çpi_g‘_d©®’
(
cfm
è<ğ
»¥_buf_Ën
) {

749 *
»¥_Ën
 = 
	`çpi_g‘_d©®’
(
cfm
);

750 
	`memıy
(
»¥
, 
	`çpi_g‘_d©a
(
cfm
), 
	`çpi_g‘_d©®’
(cfm));

751 
r
 = 0;

753 
	`SLSI_WARN
(
sdev
, "Insuffic›Á†’gth (%dètØ»ad MIB v®ues,ƒx³ùed =%d\n", 
»¥_buf_Ën
, 
	`çpi_g‘_d©®’
(
cfm
));

754 
r
 = -
EINVAL
;

757 
	`kä“_skb
(
”r
);

758 
	`kä“_skb
(
cfm
);

760  
r
;

761 
	}
}

763 
	$¦si_mlme_add_vif
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
š‹rçû_add»ss
, u8 *
deviû_add»ss
)

765 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

766 
sk_buff
 *
»q
;

767 
sk_buff
 *
cfm
;

768 
r
 = 0, 
i
;

770 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

771 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_ADD_VIF.request\n");

772  -
EOPNOTSUPP
;

775 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

776 ià(
sdev
->
»quœe_vif_d–‘e
[
ndev_vif
->
iâum
]) {

777 
r
 = 
	`¦si_mlme_d–_vif
(
sdev
, 
dev
);

778 ià(
r
 != 0)

779 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif before‡dd_vif failed\n");

781 
sdev
->
»quœe_vif_d–‘e
[
ndev_vif
->
iâum
] = 
çl£
;

785 
i
 = 0; i < 
SLSI_LLS_AC_MAX
; i++) {

786 
ndev_vif
->
tx_no_ack
[
i
] = 0;

787 
ndev_vif
->
tx_·ck‘s
[
i
] = 0;

788 
ndev_vif
->
rx_·ck‘s
[
i
] = 0;

790 
»q
 = 
	`çpi_®loc
(
mlme_add_vif_»q
, 
MLME_ADD_VIF_REQ
, 
ndev_vif
->
iâum
, 0);

791 ià(!
»q
)

792  -
ENOMEM
;

793 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_add_vif_»q
.
vœtu®_š‹rçû_ty³
, 
ndev_vif
->
vif_ty³
);

794 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_add_vif_»q
.
š‹rçû_add»ss
, interface_address);

795 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_add_vif_»q
.
deviû_add»ss
, device_address);

796 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_add_vif_»q(vif:%d)\n", 
ndev_vif
->
iâum
);

797 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_ADD_VIF_CFM
);

798 ià(!
cfm
)

799  -
EIO
;

801 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_add_vif_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

802 
	`SLSI_NET_ERR
(
dev
, "mlme_add_vif_cfm(result:0x%04x) ERROR\n",

803 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_add_vif_cfm
.
»suÉ_code
));

804 
r
 = -
EINVAL
;

807 
ndev_vif
->
pow”_mode
 = 
FAPI_POWERMANAGEMENTMODE_ACTIVE_MODE
;

808 #ifdeà
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL


812 ià(
	`©omic_»ad
(&
ndev_vif
->
¬p_tx_couÁ
))

813 
	`SLSI_WARN
(
sdev
,

815 
ndev_vif
->
¬p_tx_couÁ
, 
sdev
->arp_tx_count);

816 
	`©omic_£t
(&
ndev_vif
->
¬p_tx_couÁ
, 0);

818 
	`kä“_skb
(
cfm
);

819  
r
;

820 
	}
}

822 
	$¦si_mlme_add_d‘eù_vif
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
š‹rçû_add»ss
, u8 *
deviû_add»ss
)

824 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

825 
sk_buff
 *
»q
;

826 
sk_buff
 *
cfm
;

827 
r
 = 0;

829 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

830 
	`SLSI_NET_INFO
(
dev
, "WlanLite SKIP MLME_ADD_VIF.request\n");

831  -
EOPNOTSUPP
;

834 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

835 
»q
 = 
	`çpi_®loc
(
mlme_add_vif_»q
, 
MLME_ADD_VIF_REQ
, 
SLSI_NET_INDEX_DETECT
, 0);

836 ià(!
»q
)

837  -
ENOMEM
;

838 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_add_vif_»q
.
vœtu®_š‹rçû_ty³
, 
FAPI_VIFTYPE_DETECT
);

839 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_add_vif_»q
.
š‹rçû_add»ss
, interface_address);

840 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_add_vif_»q
.
deviû_add»ss
, device_address);

841 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_add_vif_»q (d‘eù vifè(vif:%d)\n", 
FAPI_VIFTYPE_DETECT
);

842 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_ADD_VIF_CFM
);

843 ià(!
cfm
)

844  -
EIO
;

846 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_add_vif_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

847 
	`SLSI_NET_ERR
(
dev
, "mlme_add_vif_cfm (detect vif) (result:0x%04x) ERROR\n",

848 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_add_vif_cfm
.
»suÉ_code
));

849 
r
 = -
EINVAL
;

852 
	`kä“_skb
(
cfm
);

853  
r
;

854 
	}
}

856 
	$¦si_mlme_d–_d‘eù_vif
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

858 
sk_buff
 *
»q
;

859 
sk_buff
 *
cfm
;

860 
»t
 = 0;

862 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

863 
	`SLSI_INFO_NODEV
("WlanLite SKIP MLME_DEL_VIF.request\n");

864  
»t
;

867 ià(!
sdev
->
d‘eù_vif_aùive
)

868  
»t
;

870 
	`SLSI_DBG4_NODEV
(
SLSI_MLME
, "d–_d‘eù_viàvif:%d, mlme_blocked:%s\n", 
SLSI_NET_INDEX_DETECT
,

871 
sdev
->
mlme_blocked
 ? "true" : "false");

872 ià(
sdev
->
mlme_blocked
)

873  
»t
;

874 
»q
 = 
	`çpi_®loc
(
mlme_d–_vif_»q
, 
MLME_DEL_VIF_REQ
, 
SLSI_NET_INDEX_DETECT
, 0);

875 ià(!
»q
)

876  -
ENOMEM
;

878 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_DEL_VIF_CFM
);

879 ià(!
cfm
)

880  -
EIO
;

882 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_d–_vif_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

883 
	`SLSI_ERR_NODEV
("mlme_del_vif_cfm(result:0x%04x) ERROR\n",

884 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_d–_vif_cfm
.
»suÉ_code
));

885 
»t
 = -
EINVAL
;

888 
	`kä“_skb
(
cfm
);

889  
»t
;

890 
	}
}

892 
	$¦si_mlme_d–_vif
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

894 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

895 
sk_buff
 *
»q
;

896 
sk_buff
 *
cfm
;

897 
»t
 = 0;

898 #ifdeà
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL


899 
u32
 
¬p_tx_couÁ
;

902 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

903  -
EINVAL
;

905 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

906 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_DEL_VIF.request\n");

907  
»t
;

910 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

912 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "d–_viàvif:%d, mlme_blocked:%s\n", 
ndev_vif
->
iâum
,

913 
sdev
->
mlme_blocked
 ? "true" : "false");

914 ià(
sdev
->
mlme_blocked
)

915  
»t
;

916 
»q
 = 
	`çpi_®loc
(
mlme_d–_vif_»q
, 
MLME_DEL_VIF_REQ
, 
ndev_vif
->
iâum
, 0);

917 ià(!
»q
) {

918 
sdev
->
»quœe_vif_d–‘e
[
ndev_vif
->
iâum
] = 
Œue
;

919  -
ENOMEM
;

922 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_DEL_VIF_CFM
);

923 ià(!
cfm
) {

924 
sdev
->
»quœe_vif_d–‘e
[
ndev_vif
->
iâum
] = 
Œue
;

925  -
EIO
;

928 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_d–_vif_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

929 
	`SLSI_NET_ERR
(
dev
, "mlme_del_vif_cfm(result:0x%04x) ERROR\n",

930 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_d–_vif_cfm
.
»suÉ_code
));

931 
sdev
->
»quœe_vif_d–‘e
[
ndev_vif
->
iâum
] = 
Œue
;

932 
»t
 = -
EINVAL
;

935 ià(((
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_CLIENT
è|| (ndev_vif->iáy³ =ğ
NL80211_IFTYPE_STATION
)) &&

936 (
ndev_vif
->
d–‘e_´obe_»q_›s
)) {

937 
	`kä“
(
ndev_vif
->
´obe_»q_›s
);

938 
ndev_vif
->
´obe_»q_›s
 = 
NULL
;

939 
ndev_vif
->
´obe_»q_›_Ën
 = 0;

940 
ndev_vif
->
d–‘e_´obe_»q_›s
 = 
çl£
;

942 ià(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
))

943 
ndev_vif
->
drv_š_p2p_´oûdu»
 = 
çl£
;

945 #ifdeà
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL


947 
¬p_tx_couÁ
 = 
	`©omic_»ad
(&
ndev_vif
->arp_tx_count);

948 ià(
¬p_tx_couÁ
) {

949 
	`©omic_sub
(
¬p_tx_couÁ
, &
sdev
->arp_tx_count);

950 
	`©omic_£t
(&
ndev_vif
->
¬p_tx_couÁ
, 0);

951 ià(
	`©omic_»ad
(&
sdev
->
ù¾_·u£_¡©e
))

952 
	`scsc_wifi_uÅau£_¬p_q_®l_vif
(
sdev
);

955 ià(!
»t
)

956 
sdev
->
»quœe_vif_d–‘e
[
ndev_vif
->
iâum
] = 
çl£
;

957 
	`kä“_skb
(
cfm
);

958  
»t
;

959 
	}
}

961 #ià
defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

962 
	$¦si_mlme_£t_fÜw¬d_b—cÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
aùiÚ
)

964 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

965 
sk_buff
 *
»q
;

966 
sk_buff
 *
cfm
;

968 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

969  -
EINVAL
;

971 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

972 
	`SLSI_NET_INFO
(
dev
, "wlanlite does‚ot support mlme_forward_bacon_req\n");

973  -
EOPNOTSUPP
;

976 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_fÜw¬d_b—cÚ_»q×ùiÚ = %s(%d))\n", 
aùiÚ
 ? "start" : "stop",‡ction);

978 
»q
 = 
	`çpi_®loc
(
mlme_fÜw¬d_b—cÚ_»q
, 
MLME_FORWARD_BEACON_REQ
, 
ndev_vif
->
iâum
, 0);

979 ià(!
»q
) {

980 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc for mlme_forward_beacon_req is failed\n");

981  -
ENOMEM
;

984 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_fÜw¬d_b—cÚ_»q
.
ws_aùiÚ
, 
aùiÚ
);

986 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_FORWARD_BEACON_CFM
);

987 ià(!
cfm
) {

988 
	`SLSI_NET_ERR
(
dev
, "receiving mlme_forward_beacon_cfm is failed\n");

989  -
EIO
;

992 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_fÜw¬d_b—cÚ_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_HOST_REQUEST_SUCCESS
) {

993 
	`SLSI_NET_ERR
(
dev
, "mlme_forward_beacon_cfm(result:0x%04x) ERROR\n",

994 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_fÜw¬d_b—cÚ_cfm
.
»suÉ_code
));

995  -
EINVAL
;

998 
ndev_vif
->
is_ws_ruÂšg
 = (
aùiÚ
 ? 
Œue
 : 
çl£
);

1000 
	`kä“_skb
(
cfm
);

1002 
	}
}

1005 
	$¦si_mlme_£t_bªd_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
ušt
 
bªd
)

1007 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1008 
sk_buff
 *
»q
;

1009 
sk_buff
 *
cfm
;

1010 
»t
 = 0;

1012 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "mlme_£t_bªd_»q(vif:%u bªd:%u)\n", 
ndev_vif
->
iâum
, 
bªd
);

1014 
»q
 = 
	`çpi_®loc
(
mlme_£t_bªd_»q
, 
MLME_SET_BAND_REQ
, 
ndev_vif
->
iâum
, 0);

1015 ià(!
»q
)

1016  -
EIO
;

1017 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_bªd_»q
.
vif
, 
ndev_vif
->
iâum
);

1018 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_bªd_»q
.
bªd
, band);

1019 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_BAND_CFM
);

1020 ià(!
cfm
)

1021  -
EIO
;

1023 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_bªd_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1024 
	`SLSI_NET_ERR
(
dev
, "mlme_set_band_cfm(result:0x%04x) ERROR\n",

1025 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_bªd_cfm
.
»suÉ_code
));

1026 
»t
 = -
EINVAL
;

1029 
	`kä“_skb
(
cfm
);

1030  
»t
;

1031 
	}
}

1033 
	$¦si_mlme_£t_sÿn_mode_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
sÿn_mode
, u16 
max_chªÃl_time
,

1034 
u16
 
home_away_time
, u16 
home_time
, u16 
max_chªÃl_·ssive_time
)

1036 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1037 
sk_buff
 *
»q
;

1038 
sk_buff
 *
cfm
;

1039 
»t
 = 0;

1042 ià(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
)) {

1043 
	`SLSI_ERR
(
sdev
, "ndev_vif mutex is‚ot†ocked\n");

1044  -
EINVAL
;

1047 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_£t_sÿn_mode_»q(vif:0, sÿn_mode:%d)\n", 
sÿn_mode
);

1049 
»q
 = 
	`çpi_®loc
(
mlme_£t_sÿn_mode_»q
, 
MLME_SET_SCAN_MODE_REQ
, 0, 0);

1050 ià(!
»q
)

1051  -
EIO
;

1052 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_sÿn_mode_»q
.
sÿn_mode
, scan_mode);

1053 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_sÿn_mode_»q
.
max_chªÃl_time_aùive
, 
max_chªÃl_time
);

1054 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_sÿn_mode_»q
.
home_away_time
, home_away_time);

1055 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_sÿn_mode_»q
.
home_time
, home_time);

1056 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_sÿn_mode_»q
.
max_chªÃl_time_·ssive
, 
max_chªÃl_·ssive_time
);

1058 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
NULL
, 
»q
, 
MLME_SET_SCAN_MODE_CFM
);

1059 ià(!
cfm
)

1060  -
EIO
;

1062 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_sÿn_mode_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1063 
	`SLSI_NET_ERR
(
dev
, "mlme_set_scan_mode_cfm(result:0x%04x) ERROR\n",

1064 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_sÿn_mode_cfm
.
»suÉ_code
));

1065 
»t
 = -
EINVAL
;

1068 
	`kä“_skb
(
cfm
);

1069  
»t
;

1070 
	}
}

1072 
	$¦si_mlme_£t_rßmšg_·¿m‘”s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
psid
, 
mib_v®ue
, 
mib_Ëngth
)

1074 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1075 
sk_buff
 *
»q
;

1076 
sk_buff
 *
cfm
;

1077 
»t
 = 0;

1079 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_£t_rßmšg_·¿m‘”s_»q(vif:%d v®ue:%d)\n", 
ndev_vif
->
iâum
, 
mib_v®ue
);

1080 
»q
 = 
	`çpi_®loc
(
mlme_£t_rßmšg_·¿m‘”s_»q
, 
MLME_SET_ROAMING_PARAMETERS_REQ
, 
ndev_vif
->
iâum
, 0);

1081 ià(!
»q
) {

1082 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

1083  -
ENOMEM
;

1085 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_rßmšg_·¿m‘”s_»q
.
vif
, 
ndev_vif
->
iâum
);

1086 
	`çpi_­³nd_d©a_u16
(
»q
, 
psid
);

1087 
	`çpi_­³nd_d©a_u16
(
»q
, 
mib_Ëngth
);

1089 
mib_Ëngth
) {

1091 
	`çpi_­³nd_d©a_u8
(
»q
, 
mib_v®ue
);

1094 
	`çpi_­³nd_d©a_u16
(
»q
, 
mib_v®ue
);

1097 
	`çpi_­³nd_d©a_u32
(
»q
, 
mib_v®ue
);

1100 
	`kä“_skb
(
»q
);

1101  -
EINVAL
;

1104 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_ROAMING_PARAMETERS_CFM
);

1105 ià(!
cfm
) {

1106 
	`SLSI_NET_ERR
(
dev
, "mlme_set_roaming_parameters_cfm failure\n");

1107  -
EIO
;

1109 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_rßmšg_·¿m‘”s_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1110 
	`SLSI_NET_ERR
(
dev
, "mlme_set_roaming_parameters_cfm(result:0x%04x) ERROR\n",

1111 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_rßmšg_ty³_cfm
.
»suÉ_code
));

1112 
»t
 = -
EINVAL
;

1115 
	`kä“_skb
(
cfm
);

1116  
»t
;

1117 
	}
}

1118 
	$¦si_mlme_£t_chªÃl
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
›“80211_chªÃl
 *
chª
, 
u16
 
du¿tiÚ
, u16 
š‹rv®
, u16 
couÁ
)

1120 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1121 
sk_buff
 *
»q
;

1122 
sk_buff
 *
cfm
;

1123 
r
 = 0;

1125 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

1126 
	`SLSI_NET_INFO
(
dev
, "wlanlite does‚ot support MLME_SET_CHANNEL.request\n");

1127  -
EOPNOTSUPP
;

1130 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

1132 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_£t_chªÃl_»q(äeq:%u, du¿tiÚ:%u, iÁ”v®:%u, couÁ:%u)\n", 
chª
->
ûÁ”_äeq
, 
du¿tiÚ
, 
š‹rv®
, 
couÁ
);

1134 
»q
 = 
	`çpi_®loc
(
mlme_£t_chªÃl_»q
, 
MLME_SET_CHANNEL_REQ
, 
ndev_vif
->
iâum
, 0);

1135 ià(!
»q
)

1136  -
ENOMEM
;

1138 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_chªÃl_»q
.
avaab™y_du¿tiÚ
, 
du¿tiÚ
);

1139 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_chªÃl_»q
.
avaab™y_š‹rv®
, 
š‹rv®
);

1140 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_chªÃl_»q
.
couÁ
, count);

1141 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_chªÃl_»q
.
chªÃl_äequ’cy
, 
	`SLSI_FREQ_HOST_TO_FW
(
chª
->
ûÁ”_äeq
));

1143 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_CHANNEL_CFM
);

1144 ià(!
cfm
)

1145  -
EIO
;

1147 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_chªÃl_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1148 
	`SLSI_NET_ERR
(
dev
, "mlme_set_channel_cfm(result:0x%04x) ERROR\n",

1149 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_chªÃl_cfm
.
»suÉ_code
));

1150 
r
 = -
EINVAL
;

1153 
	`kä“_skb
(
cfm
);

1154  
r
;

1155 
	}
}

1157 
	$¦si_mlme_un£t_chªÃl_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

1159 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1160 
sk_buff
 *
»q
;

1161 
sk_buff
 *
cfm
;

1162 
r
 = 0;

1164 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "slsi_mlme_unset_channel_req\n");

1166 
»q
 = 
	`çpi_®loc
(
mlme_un£t_chªÃl_»q
, 
MLME_UNSET_CHANNEL_REQ
, 
ndev_vif
->
iâum
, 0);

1168 ià(!
»q
)

1169  -
ENOMEM
;

1171 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_UNSET_CHANNEL_CFM
);

1173 ià(!
cfm
)

1174  -
EIO
;

1176 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_un£t_chªÃl_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1177 
	`SLSI_NET_ERR
(
dev
, "mlme_unset_channel_cfm(result:0x%04x) ERROR\n",

1178 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_un£t_chªÃl_cfm
.
»suÉ_code
));

1179 
r
 = -
EINVAL
;

1182 
	`kä“_skb
(
cfm
);

1183  
r
;

1184 
	}
}

1186 
	$¦si_­_obss_sÿn_dÚe_šd
(
Ãt_deviû
 *
dev
, 
Ãtdev_vif
 *
ndev_vif
)

1188 
sk_buff
 *
sÿn_»s
;

1189 
u16
 
sÿn_id
 = 
SLSI_SCAN_HW_ID
;

1191 
	`SLSI_UNUSED_PARAMETER
(
dev
);

1193 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Scan before AP start completed\n");

1195 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

1196 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
sÿn_mu‹x
));

1197 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

1199 
sÿn_»s
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->
sÿn
[
sÿn_id
], 
NULL
);

1200 
sÿn_»s
) {

1201 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
sÿn_»s
);

1202 
size_t
 
mgmt_Ën
 = 
	`çpi_g‘_mgm’
(
sÿn_»s
);

1203 
size_t
 
›_Ën
 = 
mgmt_Ën
 - 
	`off£tof
(
›“80211_mgmt
, 
u
.
b—cÚ
.
v¬ŸbË
);

1205 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_MLME
, "OBSS scan„esult (scan_id:%d, %pM, freq:%d,„ssi:%d, ie_len = %zu)\n",

1206 
	`çpi_g‘_u16
(
sÿn_»s
, 
u
.
mlme_sÿn_šd
.
sÿn_id
),

1207 
	`çpi_g‘_mgmt
(
sÿn_»s
)->
bssid
,

1208 
	`çpi_g‘_u16
(
sÿn_»s
, 
u
.
mlme_sÿn_šd
.
chªÃl_äequ’cy
) / 2,

1209 
	`çpi_g‘_s16
(
sÿn_»s
, 
u
.
mlme_sÿn_šd
.
rssi
),

1210 
›_Ën
);

1212 ià(!
	`cfg80211_fšd_›
(
WLAN_EID_HT_CAPABILITY
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
, 
›_Ën
)) {

1213 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Non HT BSS detected on…rimary channel\n");

1214 
ndev_vif
->
­
.
nÚ_ht_bss_´e£Á
 = 
Œue
;

1217 
	`kä“_skb
(
sÿn_»s
);

1218 
sÿn_»s
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->
sÿn
[
sÿn_id
], 
NULL
);

1220 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

1221 
	}
}

1224 
boŞ
 
	$¦si_sÿn_cfm_v®id©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
cfm
)

1226 
boŞ
 
r
 = 
Œue
;

1228 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_add_sÿn_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1229 
	`SLSI_ERR_NODEV
("mlme_add_scan_cfm(result:0x%04x) ERROR\n",

1230 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_add_sÿn_cfm
.
»suÉ_code
));

1231 
r
 = 
çl£
;

1234 
	`kä“_skb
(
cfm
);

1235  
r
;

1236 
	}
}

1238 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


1239 
	$¦si_mlme_­³nd_gsÿn_chªÃl_li¡
(
¦si_dev
 *
sdev
,

1240 
Ãt_deviû
 *
dev
,

1241 
sk_buff
 *
»q
,

1242 
¦si_Æ_buck‘_·¿m
 *
Æ_buck‘
)

1244 
u16
 
chªÃl_äeq
;

1245 
u8
 
i
;

1246 
u8
 *
p
;

1247 cÚ¡ 
u8
 
chªÃls_li¡_›_h—d”
[] = {

1254 
u8
 *
chªÃls_li¡_›
 = 
	`çpi_­³nd_d©a
(
»q
, 
chªÃls_li¡_›_h—d”
, (channels_list_ie_header));

1256 ià(!
chªÃls_li¡_›
) {

1257 
	`SLSI_WARN
(
sdev
, "channel†ist IE‡ppend failed\n");

1258 
	`kä“_skb
(
»q
);

1259  -
EINVAL
;

1262 ià(
Æ_buck‘
->
bªd
 =ğ
WIFI_BAND_UNSPECIFIED
)

1264 
i
 = 0; i < 
Æ_buck‘
->
num_chªÃls
; i++) {

1265 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
);

1266 ià(!
p
) {

1267 
	`SLSI_ERR
(
sdev
, "chª desc[%d]‡µ’d faed\n", 
i
);

1268 
	`kä“_skb
(
»q
);

1269  -
EINVAL
;

1271 
chªÃl_äeq
 = 
	`SLSI_FREQ_HOST_TO_FW
(
Æ_buck‘
->
chªÃls
[
i
].
chªÃl
);

1272 
chªÃl_äeq
 = 
	`ıu_to_Ë16
(channel_freq);

1273 
	`memıy
(
p
, &
chªÃl_äeq
, (channel_freq));

1274 
p
[2] = 
FAPI_SCANPOLICY_ANY_RA
;

1275 
chªÃls_li¡_›
[1] +ğ
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
;

1278 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
);

1279 ià(!
p
) {

1280 
	`SLSI_ERR
(
sdev
, "chan desc(band specific)append failed\n");

1281 
	`kä“_skb
(
»q
);

1282  -
EINVAL
;

1285 
chªÃl_äeq
 = 0;

1286 
	`memıy
(
p
, &
chªÃl_äeq
, (channel_freq));

1287 
p
[2] = 
	`¦si_gsÿn_g‘_sÿn_pŞicy
(
Æ_buck‘
->
bªd
);

1288 
chªÃls_li¡_›
[1] +ğ
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
;

1292 
	}
}

1295 
	$¦si_mlme_­³nd_chªÃl_li¡
(
¦si_dev
 *
sdev
,

1296 
Ãt_deviû
 *
dev
,

1297 
sk_buff
 *
»q
,

1298 
u32
 
num_chªÃls
,

1299 
›“80211_chªÃl
 *
chªÃls
[],

1300 
u16
 
sÿn_ty³
,

1301 
boŞ
 
·ssive_sÿn
)

1303 
chªn
;

1304 
u16
 
äeq_fw_un™
;

1305 
u8
 
i
;

1306 
n_v®id_chªÃls
 = 0;

1307 
u8
 *
p
;

1309 cÚ¡ 
u8
 
chªÃls_li¡_›_h—d”
[] = {

1317 
u8
 *
chªÃls_li¡_›
 = 
	`çpi_­³nd_d©a
(
»q
, 
chªÃls_li¡_›_h—d”
, (channels_list_ie_header));

1319 ià(!
chªÃls_li¡_›
) {

1320 
	`SLSI_WARN
(
sdev
, "channel†ist IE‡ppend failed\n");

1321 
	`kä“_skb
(
»q
);

1322  -
EINVAL
;

1326 ià(
sÿn_ty³
 =ğ
FAPI_SCANTYPE_P2P_SCAN_FULL
) {

1327 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
);

1328 ià(!
p
) {

1329 
	`SLSI_WARN
(
sdev
, "scan channel descriptor‡ppend failed\n");

1330 
	`kä“_skb
(
»q
);

1331  -
EINVAL
;

1333 
p
[0] = 0;

1334 
p
[1] = 0;

1335 
p
[2] = 
FAPI_SCANPOLICY_2_4GHZ
 | 
FAPI_SCANPOLICY_5GHZ
 | 
FAPI_SCANPOLICY_NON_DFS
;

1336 
chªÃls_li¡_›
[1] +ğ
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
;

1340 
i
 = 0; i < 
num_chªÃls
; i++) {

1341 
chªn
 = 
chªÃls
[
i
]->
hw_v®ue
 & 0xFF;

1343 ià(
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
) {

1344 ià(
chªÃls
[
i
]->
bªd
 =ğ
NL80211_BAND_2GHZ
 && 
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
 !ğ
SLSI_FREQ_BAND_2GHZ
)

1346 ià(
chªÃls
[
i
]->
bªd
 =ğ
NL80211_BAND_5GHZ
 && 
sdev
->
deviû_cÚfig
.
suµÜ‹d_bªd
 !ğ
SLSI_FREQ_BAND_5GHZ
)

1350 
n_v®id_chªÃls
++;

1351 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
);

1352 ià(!
p
) {

1353 
	`SLSI_WARN
(
sdev
, "scan channel descriptor‡ppend failed\n");

1354 
	`kä“_skb
(
»q
);

1355  -
EINVAL
;

1357 
äeq_fw_un™
 = 2 * 
	`›“80211_chªÃl_to_äequ’cy
(
chªn
, (chann <= 14) ?

1358 
NL80211_BAND_2GHZ
 : 
NL80211_BAND_5GHZ
);

1359 
äeq_fw_un™
 = 
	`ıu_to_Ë16
(freq_fw_unit);

1360 
	`memıy
(
p
, &
äeq_fw_un™
, (freq_fw_unit));

1362 ià(
·ssive_sÿn
 && (
sÿn_ty³
 !ğ
FAPI_SCANTYPE_AP_AUTO_CHANNEL_SELECTION
))

1363 
p
[2] = 
FAPI_SCANPOLICY_PASSIVE
;

1365 
p
[2] = 0;

1367 
chªÃls_li¡_›
[1] +ğ
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
;

1369 ià(
n_v®id_chªÃls
 == 0) {

1370 
	`SLSI_NET_ERR
(
dev
, "no valid channelso Scan\n");

1371 
	`kä“_skb
(
»q
);

1372  -
EINVAL
;

1375 
	}
}

1377 
šlše
 
	$¦si_£t_sÿn_·¿ms
(

1378 
Ãt_deviû
 *
dev
,

1379 
u16
 
sÿn_id
,

1380 
u16
 
sÿn_ty³
,

1381 
u16
 
»pÜt_mode
,

1382 
num_ssids
,

1383 
cfg80211_ssid
 *
ssids
,

1384 
sk_buff
 *
»q
)

1386 
u8
 *
p
 = 
NULL
;

1387 
u8
 
i
;

1388 
cfg80211_ssid
 *
pssid
 = 
ssids
;

1389 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


1390 
Ãtdev_vif
 *Ãtdev_viàğ
	`Ãtdev_´iv
(
dev
);

1391 
¦si_dev
 *
sdev
 = 
Ãtdev_vif
->sdev;

1394 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_add_sÿn_»q
.
sÿn_id
, scan_id);

1395 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_add_sÿn_»q
.
sÿn_ty³
, scan_type);

1396 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_add_sÿn_»q
.
»pÜt_mode_b™m­
, 
»pÜt_mode
);

1398 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


1399 ià(
sdev
->
sÿn_addr_£t
)

1400 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_add_sÿn_»q
.
deviû_add»ss
, 
sdev
->
sÿn_mac_addr
);

1403 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_add_sÿn_»q
.
deviû_add»ss
, 
dev
->
dev_addr
);

1405 
i
 = 0; i < 
num_ssids
; i++, 
pssid
++) {

1406 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 2 + 
pssid
->
ssid_Ën
);

1407 ià(!
p
) {

1408 
	`kä“_skb
(
»q
);

1409 
	`SLSI_NET_WARN
(
dev
, "failo‡ppend SSIDƒlemento scan„equest\n");

1410  -
EINVAL
;

1413 *
p
++ = 
WLAN_EID_SSID
;

1414 *
p
++ = 
pssid
->
ssid_Ën
;

1416 ià(
pssid
->
ssid_Ën
)

1417 
	`memıy
(
p
, 
pssid
->
ssid
,…ssid->
ssid_Ën
);

1420 
	}
}

1422 
	#SLSI_MAX_SSID_DESC_IN_SSID_FILTER_ELEM
 7

	)

1423 
	$¦si_mlme_add_sched_sÿn
(
¦si_dev
 *
sdev
,

1424 
Ãt_deviû
 *
dev
,

1425 
cfg80211_sched_sÿn_»que¡
 *
»que¡
,

1426 cÚ¡ 
u8
 *
›s
,

1427 
u16
 
›s_Ën
)

1429 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1430 
sk_buff
 *
»q
;

1431 
sk_buff
 *
rx
;

1432 
r
 = 0;

1433 
size_t
 
®loc_d©a_size
 = 0;

1434 
u32
 
i
, 
j
;

1435 
u32
 
num_ssid_f‹r_–em’ts
 = 0;

1436 
u8
 *
deçuÉ_›s
 = 
NULL
;

1437 
deçuÉ_›_Ën
 = 0;

1440 
u8
 
sÿn_timšg_›
[] = {

1453 
u8
 
ssid_f‹r_›_hdr
[] = {

1461 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

1462 
	`SLSI_NET_WARN
(
dev
, "not supported in WlanLite mode\n");

1463  -
EOPNOTSUPP
;

1466 ià(
	`WARN_ON
(!(
dev
->
dev_addr
)))

1467  -
EINVAL
;

1469 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
sÿn_mu‹x
));

1471 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


1472 ià(
»que¡
->
æags
 & 
NL80211_SCAN_FLAG_RANDOM_ADDR
) {

1473 ià(
sdev
->
fw_mac_¿ndomiz©iÚ_’abËd
) {

1474 
	`memıy
(
sdev
->
sÿn_mac_addr
, 
»que¡
->
mac_addr
, 
ETH_ALEN
);

1475 
r
 = 
	`¦si_£t_mac_¿ndomi§tiÚ_mask
(
sdev
, 
»que¡
->
mac_addr_mask
);

1476 ià(!
r
)

1477 
sdev
->
sÿn_addr_£t
 = 1;

1479 
	`SLSI_NET_INFO
(
dev
, "Mac Randomization is‚otƒnabled in Firmware\n");

1480 
sdev
->
sÿn_addr_£t
 = 0;

1484 ià(
sdev
->
deçuÉ_sÿn_›s_Ën
 > 0)

1485 
deçuÉ_›s
 = 
	`¦si_g‘_sÿn_exŒa_›s
(
sdev
, 
›s
, 
›s_Ën
, &
deçuÉ_›_Ën
);

1487 
®loc_d©a_size
 +ğ(
sÿn_timšg_›
è+ 
›s_Ën
 + 
SLSI_SCAN_PRIVATE_IE_CHANNEL_LIST_HEADER_LEN
 +

1488 (
»que¡
->
n_chªÃls
 * 
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
);

1490 ià(
deçuÉ_›s
 && 
deçuÉ_›_Ën
 > 0)

1491 
®loc_d©a_size
 +ğ
deçuÉ_›_Ën
;

1493 
i
 = 0; i < 
»que¡
->
n_ssids
; i++) {

1495 
®loc_d©a_size
 +ğ(2 + 
»que¡
->
ssids
[
i
].
ssid_Ën
);

1498 ià(
»que¡
->
n_m©ch_£ts
) {

1499 
num_ssid_f‹r_–em’ts
 = (
»que¡
->
n_m©ch_£ts
 / 
SLSI_MAX_SSID_DESC_IN_SSID_FILTER_ELEM
) + 1;

1501 
®loc_d©a_size
 +ğ238 * 
num_ssid_f‹r_–em’ts
;

1504 
»q
 = 
	`çpi_®loc
(
mlme_add_sÿn_»q
, 
MLME_ADD_SCAN_REQ
, 0, 
®loc_d©a_size
);

1505 ià(!
»q
) {

1506 
	`kä“
(
deçuÉ_›s
);

1507  -
ENOMEM
;

1510 
r
 = 
	`¦si_£t_sÿn_·¿ms
(
dev
, (
ndev_vif
->
iâum
 << 8 | 
SLSI_SCAN_SCHED_ID
),

1511 
FAPI_SCANTYPE_SCHEDULED_SCAN
,

1512 
FAPI_REPORTMODE_REAL_TIME
,

1513 
»que¡
->
n_ssids
,

1514 
»que¡
->
ssids
,

1515 
»q
);

1516 ià(
r
) {

1517 
	`kä“
(
deçuÉ_›s
);

1518  
r
;

1521 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 4, 0))

1522 #ifdeà
CONFIG_SCSC_WLAN_EXPONENTIAL_SCHED_SCAN


1524 
	`SLSI_U32_TO_BUFF_LE
(
»que¡
->
sÿn_¶ªs
[0].
š‹rv®
 * 1000 * 1000, &
sÿn_timšg_›
[7]);

1525 ià(
»que¡
->
n_sÿn_¶ªs
 > 1 &&„eque¡->
sÿn_¶ªs
[0].
š‹rv®
 <„equest->scan_plans[1].interval) {

1526 
	`SLSI_U32_TO_BUFF_LE
(
»que¡
->
sÿn_¶ªs
[1].
š‹rv®
 * 1000 * 1000, &
sÿn_timšg_›
[11]);

1527 
sÿn_timšg_›
[15] = 
»que¡
->
sÿn_¶ªs
[1].
š‹rv®
 /„equest->scan_plans[0].interval;

1528 
sÿn_timšg_›
[16] = 
»que¡
->
sÿn_¶ªs
[0].
™”©iÚs
;

1530 
	`SLSI_U32_TO_BUFF_LE
(
»que¡
->
sÿn_¶ªs
[0].
š‹rv®
 * 1000 * 1000, &
sÿn_timšg_›
[11]);

1531 
sÿn_timšg_›
[15] = 1;

1532 
sÿn_timšg_›
[16] = 0;

1535 
	`SLSI_U32_TO_BUFF_LE
(
»que¡
->
sÿn_¶ªs
->
š‹rv®
 * 1000 * 1000, &
sÿn_timšg_›
[7]);

1536 
	`SLSI_U32_TO_BUFF_LE
(
»que¡
->
sÿn_¶ªs
->
š‹rv®
 * 1000 * 1000, &
sÿn_timšg_›
[11]);

1539 
	`SLSI_U32_TO_BUFF_LE
(
»que¡
->
š‹rv®
 * 1000, &
sÿn_timšg_›
[7]);

1540 
	`SLSI_U32_TO_BUFF_LE
(
»que¡
->
š‹rv®
 * 1000, &
sÿn_timšg_›
[11]);

1543 
	`çpi_­³nd_d©a
(
»q
, 
sÿn_timšg_›
, (scan_timing_ie));

1544 
	`çpi_­³nd_d©a
(
»q
, 
›s
, 
›s_Ën
);

1545 ià(
deçuÉ_›s
 !ğ
NULL
 && 
deçuÉ_›_Ën
 > 0) {

1546 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "Aµ’dšg deçuÉ_›_ËÀ%d\n", 
deçuÉ_›_Ën
);

1547 
	`çpi_­³nd_d©a
(
»q
, 
deçuÉ_›s
, 
deçuÉ_›_Ën
);

1548 
	`kä“
(
deçuÉ_›s
);

1551 ià(
»que¡
->
n_m©ch_£ts
) {

1552 
cfg80211_m©ch_£t
 *
m©ch_£ts
 = 
»que¡
->match_sets;

1553 
u8
 *
ssid_f‹r_›
;

1555 
j
 = 0; j < 
num_ssid_f‹r_–em’ts
; j++) {

1556 
ssid_f‹r_›
 = 
	`çpi_­³nd_d©a
(
»q
, 
ssid_f‹r_›_hdr
, (ssid_filter_ie_hdr));

1557 ià(!
ssid_f‹r_›
) {

1558 
	`kä“_skb
(
»q
);

1559 
	`SLSI_ERR
(
sdev
, "ssid_filter_ie‡ppend failed\n");

1560  -
EIO
;

1562 
i
 = 0; i < 
SLSI_MAX_SSID_DESC_IN_SSID_FILTER_ELEM
; i++, 
m©ch_£ts
++) {

1563 ià((
j
 * 
SLSI_MAX_SSID_DESC_IN_SSID_FILTER_ELEM
è+ 
i
 >ğ
»que¡
->
n_m©ch_£ts
)

1565 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "SSID: %.*s",

1566 
m©ch_£ts
->
ssid
.
ssid_Ën
, match_sets->ssid.ssid);

1567 
ssid_f‹r_›
[1] +ğ(1 + 
m©ch_£ts
->
ssid
.
ssid_Ën
);

1568 
	`çpi_­³nd_d©a
(
»q
, &
m©ch_£ts
->
ssid
.
ssid_Ën
, 1);

1569 
	`çpi_­³nd_d©a
(
»q
, 
m©ch_£ts
->
ssid
.ssid, m©ch_£ts->ssid.
ssid_Ën
);

1574 ià(
»que¡
->
n_chªÃls
) {

1575 
r
 = 
	`¦si_mlme_­³nd_chªÃl_li¡
(
sdev
, 
dev
, 
»q
, 
»que¡
->
n_chªÃls
,„eque¡->
chªÃls
,

1576 
FAPI_SCANTYPE_SCHEDULED_SCAN
, 
»que¡
->
n_ssids
 == 0);

1577 ià(
r
)

1578  
r
;

1581 
rx
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
NULL
, 
»q
, 
MLME_ADD_SCAN_CFM
);

1582 ià(!
rx
)

1583  -
EIO
;

1585 ià(
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_add_sÿn_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1586 
	`SLSI_NET_ERR
(
dev
, "mlme_add_scan_cfm(result:0x%04x) ERROR\n",

1587 
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_add_sÿn_cfm
.
»suÉ_code
));

1588 
r
 = -
EINVAL
;

1591 
	`kä“_skb
(
rx
);

1592  
r
;

1593 
	}
}

1595 
	$¦si_mlme_add_sÿn
(

1596 
¦si_dev
 *
sdev
,

1597 
Ãt_deviû
 *
dev
,

1598 
u16
 
sÿn_ty³
,

1599 
u16
 
»pÜt_mode
,

1600 
u32
 
n_ssids
,

1601 
cfg80211_ssid
 *
ssids
,

1602 
u32
 
n_chªÃls
,

1603 
›“80211_chªÃl
 *
chªÃls
[],

1604 *
gsÿn
,

1605 cÚ¡ 
u8
 *
›s
,

1606 
u16
 
›s_Ën
,

1607 
boŞ
 
wa™_fÜ_šd
)

1609 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1610 
sk_buff
 *
»q
;

1611 
sk_buff
 *
rx
;

1612 
r
 = 0;

1613 
size_t
 
®loc_d©a_size
 = 0;

1614 
u32
 
i
;

1615 
u8
 *
deçuÉ_›s
 = 
NULL
;

1616 
deçuÉ_›_Ën
 = 0;

1619 
u8
 
sÿn_timšg_›
[] = {

1632 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

1633 
	`SLSI_NET_WARN
(
dev
, "not supported in WlanLite mode\n");

1634  -
EOPNOTSUPP
;

1637 ià(
	`WARN_ON
(!(
dev
->
dev_addr
)))

1638  -
EINVAL
;

1640 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
sÿn_mu‹x
));

1641 
	`SLSI_INFO
(
sdev
, "scan started for id:0x%x,‚_channels:%d,‚_ssids:%d, scan_type:%d\n",

1642 (
ndev_vif
->
iâum
 << 8 | 
SLSI_SCAN_HW_ID
), 
n_chªÃls
, 
n_ssids
, 
sÿn_ty³
);

1644 ià(!
gsÿn
 && 
sdev
->
deçuÉ_sÿn_›s_Ën
 > 0)

1645 
deçuÉ_›s
 = 
	`¦si_g‘_sÿn_exŒa_›s
(
sdev
, 
›s
, 
›s_Ën
, &
deçuÉ_›_Ën
);

1647 
®loc_d©a_size
 +ğ(
sÿn_timšg_›
) +

1648 
›s_Ën
 +

1649 (
SLSI_SCAN_PRIVATE_IE_CHANNEL_LIST_HEADER_LEN
 + (
n_chªÃls
 * 
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
));

1650 ià(!
gsÿn
 && 
deçuÉ_›s
 !ğ
NULL
 && 
deçuÉ_›_Ën
 > 0)

1651 
®loc_d©a_size
 +ğ
deçuÉ_›_Ën
;

1653 
i
 = 0; i < 
n_ssids
; i++)

1654 
®loc_d©a_size
 +ğ2 + 
ssids
[
i
].
ssid_Ën
;

1656 
»q
 = 
	`çpi_®loc
(
mlme_add_sÿn_»q
, 
MLME_ADD_SCAN_REQ
, 0, 
®loc_d©a_size
);

1657 ià(!
»q
) {

1658 
	`kä“
(
deçuÉ_›s
);

1659  -
ENOMEM
;

1662 ià(!
gsÿn
) {

1663 
r
 = 
	`¦si_£t_sÿn_·¿ms
(

1664 
dev
,

1665 (
ndev_vif
->
iâum
 << 8 | 
SLSI_SCAN_HW_ID
),

1666 
sÿn_ty³
,

1667 
»pÜt_mode
,

1668 
n_ssids
,

1669 
ssids
,

1670 
»q
);

1671 ià(
r
) {

1672 
	`kä“
(
deçuÉ_›s
);

1673  
r
;

1676 
	`çpi_­³nd_d©a
(
»q
, 
sÿn_timšg_›
, (scan_timing_ie));

1677 
	`çpi_­³nd_d©a
(
»q
, 
›s
, 
›s_Ën
);

1678 ià(
deçuÉ_›s
 && 
deçuÉ_›_Ën
 > 0) {

1679 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "Aµ’dšg deçuÉ_›_Ën: %d\n", 
deçuÉ_›_Ën
);

1680 
	`çpi_­³nd_d©a
(
»q
, 
deçuÉ_›s
, 
deçuÉ_›_Ën
);

1681 
	`kä“
(
deçuÉ_›s
);

1684 ià(
n_chªÃls
) {

1685 
r
 = 
	`¦si_mlme_­³nd_chªÃl_li¡
(
sdev
, 
dev
, 
»q
, 
n_chªÃls
, 
chªÃls
, 
sÿn_ty³
,

1686 
n_ssids
 == 0);

1687 ià(
r
)

1688  
r
;

1691 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


1693 
¦si_gsÿn_·¿m
 *
gsÿn_·¿m
 = (¦si_gsÿn_·¿m *)
gsÿn
;

1695 
r
 = 
	`¦si_£t_sÿn_·¿ms
(

1696 
dev
,

1697 
gsÿn_·¿m
->
buck‘
->
sÿn_id
,

1698 
sÿn_ty³
,

1699 
»pÜt_mode
,

1700 
n_ssids
,

1701 
ssids
,

1702 
»q
);

1703 ià(
r
)

1704  
r
;

1706 
	`SLSI_U32_TO_BUFF_LE
((
gsÿn_·¿m
->
Æ_buck‘
->
³riod
 * 1000), &
sÿn_timšg_›
[7]);

1707 ià(
gsÿn_·¿m
->
Æ_buck‘
->
expÚ’t
) {

1708 
	`SLSI_U32_TO_BUFF_LE
((
gsÿn_·¿m
->
Æ_buck‘
->
max_³riod
 * 1000), &
sÿn_timšg_›
[11]);

1709 
sÿn_timšg_›
[15] = (
u8
)
gsÿn_·¿m
->
Æ_buck‘
->
expÚ’t
;

1710 
sÿn_timšg_›
[16] = (
u8
)
gsÿn_·¿m
->
Æ_buck‘
->
¡•_couÁ
;

1712 
	`çpi_­³nd_d©a
(
»q
, 
sÿn_timšg_›
, (scan_timing_ie));

1714 
r
 = 
	`¦si_mlme_­³nd_gsÿn_chªÃl_li¡
(
sdev
, 
dev
, 
»q
, 
gsÿn_·¿m
->
Æ_buck‘
);

1715 ià(
r
)

1716  
r
;

1719 ià(
wa™_fÜ_šd
) {

1721 
rx
 = 
	`¦si_mlme_»q_cfm_šd
(
sdev
, 
NULL
, 
»q
, 
MLME_ADD_SCAN_CFM
, 
MLME_SCAN_DONE_IND
, 
¦si_sÿn_cfm_v®id©e
);

1722 ià(!
rx
)

1723  -
EIO
;

1724 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "mlme_scan_done_ind()\n");

1732 
rx
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
NULL
, 
»q
, 
MLME_ADD_SCAN_CFM
);

1733 ià(!
rx
)

1734  -
EIO
;

1735 ià(
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_add_sÿn_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1736 
	`SLSI_NET_ERR
(
dev
, "mlme_add_scan_cfm(result:0x%04x) ERROR\n",

1737 
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_add_sÿn_cfm
.
»suÉ_code
));

1738 
r
 = -
EINVAL
;

1741 
	`kä“_skb
(
rx
);

1742  
r
;

1743 
	}
}

1745 
	$¦si_mlme_d–_sÿn
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
sÿn_id
, 
boŞ
 
sÿn_timed_out
)

1747 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1748 
sk_buff
 *
»q
;

1749 
sk_buff
 *
cfm
;

1750 
r
 = 0;

1752 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

1753 
	`SLSI_NET_WARN
(
dev
, "not supported in WlanLite mode\n");

1754  -
EOPNOTSUPP
;

1757 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_d–_sÿn_»q(sÿn_id:%d)\n", 
sÿn_id
);

1759 ià((
sÿn_id
 & 0xFFè=ğ
SLSI_SCAN_HW_ID
 && 
ndev_vif
->
sÿn
[SLSI_SCAN_HW_ID].
sÿn_»q
 && !
sÿn_timed_out
)

1760 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
sÿn_timeout_wÜk
);

1762 
»q
 = 
	`çpi_®loc
(
mlme_d–_sÿn_»q
, 
MLME_DEL_SCAN_REQ
, 0, 0);

1763 ià(!
»q
)

1764  -
ENOMEM
;

1765 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_d–_sÿn_»q
.
sÿn_id
, scan_id);

1768 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
NULL
, 
»q
, 
MLME_DEL_SCAN_CFM
);

1769 ià(!
cfm
)

1770  -
EIO
;

1772 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_d–_sÿn_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1773 
	`SLSI_NET_ERR
(
dev
, "mlme_del_scan_cfm(result:0x%04x) ERROR\n",

1774 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_d–_sÿn_cfm
.
»suÉ_code
));

1775 
r
 = -
EINVAL
;

1778 
	`kä“_skb
(
cfm
);

1779  
r
;

1780 
	}
}

1782 
	$¦si_­_add_ext_ÿ·b_›
(
sk_buff
 *
»q
, 
Ãtdev_vif
 *
ndev_vif
, cÚ¡ 
u8
 *
´ev_ext
)

1784 
u8
 
ext_ÿ·_›
[
SLSI_AP_EXT_CAPAB_IE_LEN_MAX
];

1785 
i
;

1786 
´ev_Ën
 = 0;

1788 
ext_ÿ·_›
[0] = 
WLAN_EID_EXT_CAPABILITY
;

1789 
ext_ÿ·_›
[1] = 
SLSI_AP_EXT_CAPAB_IE_LEN_MAX
 - 1 - 1;

1790 ià(
´ev_ext
) {

1791 
´ev_Ën
 = 
´ev_ext
[1];

1792 
i
 = 2; i < 
´ev_Ën
 + 2; i++)

1793 
ext_ÿ·_›
[
i
] = 
´ev_ext
[i];

1795 
i
 = 
´ev_Ën
 + 2; i < 
SLSI_AP_EXT_CAPAB_IE_LEN_MAX
; i++)

1796 
ext_ÿ·_›
[
i
] = 0x00;

1797 
	`SLSI_DBG3
(
ndev_vif
->
sdev
, 
SLSI_MLME
, "New Ext capab Added\n");

1799 
ext_ÿ·_›
[9] |= 0x40;

1801 
	`çpi_­³nd_d©a
(
»q
, &
ext_ÿ·_›
[0], 
SLSI_AP_EXT_CAPAB_IE_LEN_MAX
);

1802 
	}
}

1804 
	$¦si_´•¬e_couÁry_›
(
¦si_dev
 *
sdev
, 
u16
 
ûÁ”_äeq
, 
u8
 *
couÁry_›
, u8 **
Ãw_couÁry_›
)

1806 
›“80211_suµÜ‹d_bªd
 
bªd
;

1807 
›“80211_»g_ruË
 *
ruË
;

1808 
›“80211_chªÃl
 *
chªÃls
;

1809 
u8
 *
›
;

1810 
off£t
 = 0;

1811 
i
;

1814 ià(
ûÁ”_äeq
 < 5180)

1815 
bªd
 = 
¦si_bªd_2ghz
;

1817 
bªd
 = 
¦si_bªd_5ghz
;

1820 
›
 = 
	`km®loc
(5 + (
bªd
.
n_chªÃls
 * 3), 
GFP_KERNEL
);

1821 ià(!
›
) {

1822 
	`SLSI_ERR
(
sdev
, "Failedo‡llocate memory\n");

1823  -
ENOMEM
;

1827 
›
[
off£t
++] = 
couÁry_›
[0];

1828 
›
[
off£t
++] = 0;

1829 
›
[
off£t
++] = 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->
®pha2
[0];

1830 
›
[
off£t
++] = 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->
®pha2
[1];

1831 
›
[
off£t
++] = 
couÁry_›
[4];

1833 
chªÃls
 = 
bªd
.channels;

1834 
i
 = 0; i < 
bªd
.
n_chªÃls
; i++, 
chªÃls
++) {

1836 
ruË
 = 
	`¦si_g‘_»g_ruË
(
	`MHZ_TO_KHZ
(
chªÃls
->
ûÁ”_äeq
), &
sdev
->
deviû_cÚfig
.
domaš_šfo
);

1837 ià(
ruË
) {

1838 
›
[
off£t
++] = 
chªÃls
->
hw_v®ue
;

1839 
›
[
off£t
++] = 1;

1840 
›
[
off£t
++] = 
	`MBM_TO_DBM
(
ruË
->
pow”_ruË
.
max_eœp
);

1844 
›
[1] = 
off£t
 - 2;

1845 *
Ãw_couÁry_›
 = 
›
;

1848 
	}
}

1850 
	$¦si_modify_›s
(
Ãt_deviû
 *
dev
, 
u8
 
eid
, u8 *
›s
, 
›s_Ën
, u8 
›_šdex
, u8 
›_v®ue
)

1852 
u8
 *
›
;

1854 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "eid: %d, ie_v®uğ0x%x\n", 
eid
, 
›_v®ue
);

1856 
›
 = (
u8
 *)
	`cfg80211_fšd_›
(
eid
, 
›s
, 
›s_Ën
);

1857 ià(
›
) {

1858 
eid
) {

1859 
WLAN_EID_HT_CAPABILITY
:

1860 
WLAN_EID_VHT_CAPABILITY
:

1861 
›
[
›_šdex
] |ğ
›_v®ue
;

1863 
WLAN_EID_DS_PARAMS
:

1864 
WLAN_EID_HT_OPERATION
:

1865 ià(
›_šdex
 == 2)

1866 
›
[
›_šdex
] = 
›_v®ue
;

1868 
›
[
›_šdex
] |ğ
›_v®ue
;

1871 
	`SLSI_NET_WARN
(
dev
, "¦si_modify_›s: IEy³ mism©ch : %d\n", 
eid
);

1872  
çl£
;

1874  
Œue
;

1876 
	`SLSI_NET_WARN
(
dev
, "¦si_modify_›s: IE‚Ù found : %d\n", 
eid
);

1877  
çl£
;

1878 
	}
}

1880 
	$¦si_mlme_¡¬t_´•¬e_›s
(
sk_buff
 *
»q
, 
Ãtdev_vif
 *
ndev_vif
, 
cfg80211_­_£‰šgs
 *
£‰šgs
, cÚ¡ 
u8
 *
w·_›_pos
, cÚ¡ u8 *
wmm_›_pos
)

1882 cÚ¡ 
u8
 *
wps_›
, *
vht_ÿ·b_›
, *
_pos
 = 
NULL
, *
ext_ÿ·b_›
;

1883 
size_t
 
b—cÚ_›_Ën
 = 0, 
_Ëngth
 = 0;

1884 
u8
 *
couÁry_›
;

1885 cÚ¡ 
u8
 *
b—cÚ_
 = 
£‰šgs
->
b—cÚ
.

;

1886 
size_t
 
b—cÚ__Ën
 = 
£‰šgs
->
b—cÚ
.
_Ën
;

1892 
couÁry_›
 = (
u8
 *)
	`cfg80211_fšd_›
(
WLAN_EID_COUNTRY
, 
b—cÚ_
, 
b—cÚ__Ën
);

1893 ià(
couÁry_›
) {

1894 
u8
 *
Ãw_couÁry_›
 = 
NULL
;

1896 
	`SLSI_DBG3
(
ndev_vif
->
sdev
, 
SLSI_MLME
, "CouÁry IE found,†’gth = %d", 
couÁry_›
[1]);

1899 ià(
	`¦si_´•¬e_couÁry_›
(
ndev_vif
->
sdev
,‚dev_vif->
chª
->
ûÁ”_äeq
, 
couÁry_›
, &
Ãw_couÁry_›
) != 0)

1900 
	`SLSI_ERR
(
ndev_vif
->
sdev
, "Failedo…repare country IE");

1903 ià(
Ãw_couÁry_›
) {

1905 
	`çpi_­³nd_d©a
(
»q
, 
Ãw_couÁry_›
, (new_country_ie[1] + 2));

1908 
	`kä“
(
Ãw_couÁry_›
);

1911 
b—cÚ_
 +ğ(
couÁry_›
[1] + 2);

1912 
b—cÚ__Ën
 -ğ(
couÁry_›
[1] + 2);

1917 ià(
ndev_vif
->
­
.
nÚ_ht_bss_´e£Á
) {

1918 
u8
 
İ_mode
 = 1;

1920 
	`SLSI_NET_DBG1
(
ndev_vif
->
wdev
.
Ãtdev
, 
SLSI_MLME
, "Modify Operating mode of BSS in HT IE\n");

1921 
	`¦si_modify_›s
(
ndev_vif
->
wdev
.
Ãtdev
, 
WLAN_EID_HT_OPERATION
, (
u8
 *)
£‰šgs
->
b—cÚ
.

, s‘tšgs->b—cÚ.
_Ën
, 4, 
İ_mode
);

1922 
ndev_vif
->
­
.
nÚ_ht_bss_´e£Á
 = 
çl£
;

1932 ià(
wmm_›_pos
)

1933 
b—cÚ_›_Ën
 = 
wmm_›_pos
 - 
b—cÚ_
;

1936 
wps_›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPS
, 
b—cÚ_
, 
b—cÚ__Ën
);

1937 ià(
wps_›
)

1938 
b—cÚ_›_Ën
 = 
wps_›
 - 
b—cÚ_
;

1940 
b—cÚ_›_Ën
 = 
b—cÚ__Ën
;

1944 ià(
w·_›_pos
) {

1945 
size_t
 
Ën_befÜe
, 
Ën
;

1947 
Ën_befÜe
 = 
w·_›_pos
 - 
b—cÚ_
;

1948 
	`çpi_­³nd_d©a
(
»q
, 
b—cÚ_
, 
Ën_befÜe
);

1950 
Ën
 = 
Ën_befÜe
 + 
ndev_vif
->
­
.
w·_›_Ën
;

1952 ià(
b—cÚ_›_Ën
 > 
Ën
) {

1953 
_Ëngth
 = 
b—cÚ_›_Ën
 - 
Ën
;

1954 
_pos
 = (
b—cÚ_
 + 
Ën
);

1958 
_Ëngth
 = 
b—cÚ_›_Ën
;

1959 
_pos
 = 
b—cÚ_
;

1963 ià(
ndev_vif
->
chªdef
->
width
 =ğ
NL80211_CHAN_WIDTH_80
) {

1965 
vht_ÿ·b_›
 = (
	`cfg80211_fšd_›
(
WLAN_EID_VHT_CAPABILITY
, 
_pos
, 
_Ëngth
));

1966 
ext_ÿ·b_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_EXT_CAPABILITY
, 
_pos
, 
_Ëngth
);

1967 
_Ëngth
 > 2) {

1968 ià(
_pos
[0] =ğ
WLAN_EID_VHT_CAPABILITY
)

1969 
	`¦si_­_add_ext_ÿ·b_›
(
»q
, 
ndev_vif
, 
ext_ÿ·b_›
);

1970 ià(
_pos
[0] !ğ
WLAN_EID_EXT_CAPABILITY
 &&a_pos[0] !ğ
WLAN_EID_VHT_OPERATION
)

1971 
	`çpi_­³nd_d©a
(
»q
, 
_pos
,ail_pos[1] + 2);

1973 
_Ëngth
 -ğ
_pos
[1] + 2;

1974 
_pos
 +=ail_pos[1] + 2;

1976 ià(!
vht_ÿ·b_›
)

1977 
	`¦si_­_add_ext_ÿ·b_›
(
»q
, 
ndev_vif
, 
ext_ÿ·b_›
);

1979 
	`çpi_­³nd_d©a
(
»q
, 
_pos
, 
_Ëngth
);

1981 
	}
}

1985 
	#SLSI_VHT_CAPABILITIES_IE_LEN
 14

	)

1989 
	#SLSI_VHT_OPERATION_IE_LEN
 7

	)

1991 
	$¦si_´•¬e_vht_›s
(
Ãt_deviû
 *
dev
, 
u8
 **
vht_›_ÿ·b
, u8 **
vht_›_İ”©iÚ
)

1993 
u32
 
ÿ·bs
;

1994 
u16
 
mcs
;

1995 
u8
 *
p_ÿp
, *
p_İ”
;

1996 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1998 *
vht_›_ÿ·b
 = 
	`km®loc
(
SLSI_VHT_CAPABILITIES_IE_LEN
, 
GFP_KERNEL
);

1999 ià(!(*
vht_›_ÿ·b
))

2000  -
EINVAL
;

2001 *
vht_›_İ”©iÚ
 = 
	`km®loc
(
SLSI_VHT_OPERATION_IE_LEN
, 
GFP_KERNEL
);

2002 ià(!(*
vht_›_İ”©iÚ
)) {

2003 
	`kä“
(*
vht_›_ÿ·b
);

2004  -
EINVAL
;

2007 
p_ÿp
 = *
vht_›_ÿ·b
;

2008 
p_İ”
 = *
vht_›_İ”©iÚ
;

2010 *
p_ÿp
++ = 
WLAN_EID_VHT_CAPABILITY
;

2011 *
p_ÿp
++ = 
SLSI_VHT_CAPABILITIES_IE_LEN
 - 1 - 1;

2012 
ÿ·bs
 = 
	`ıu_to_Ë32
(
¦si_vht_ÿp
.
ÿp
);

2013 
	`memıy
(
p_ÿp
, &
ÿ·bs
, (capabs));

2014 
p_ÿp
 +ğ(
ÿ·bs
);

2015 
	`memıy
(
p_ÿp
, &
¦si_vht_ÿp
.
vht_mcs
, (slsi_vht_cap.vht_mcs));

2017 *
p_İ”
++ = 
WLAN_EID_VHT_OPERATION
;

2018 *
p_İ”
++ = 
SLSI_VHT_OPERATION_IE_LEN
 - 1 - 1;

2019 *
p_İ”
++ = 
IEEE80211_VHT_CHANWIDTH_80MHZ
;

2020 *
p_İ”
++ = 
	`›“80211_äequ’cy_to_chªÃl
(
ndev_vif
->
chªdef
->
ûÁ”_äeq1
);

2021 *
p_İ”
++ = 0;

2022 
mcs
 = 
	`ıu_to_Ë16
(0xfffc);

2023 
	`memıy
(
p_İ”
, &
mcs
, (mcs));

2026 
	}
}

2028 
	$¦si_mlme_¡¬t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
bssid
, 
cfg80211_­_£‰šgs
 *
£‰šgs
, cÚ¡ u8 *
w·_›_pos
, cÚ¡ u8 *
wmm_›_pos
, 
boŞ
 
­³nd_vht_›s
)

2030 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2031 
sk_buff
 *
»q
;

2032 
sk_buff
 *
cfm
;

2033 
›“80211_mgmt
 *
mgmt
;

2034 
r
 = 0;

2035 
u8
 *
p
;

2036 
Æ80211_auth_ty³
 
auth_ty³
 = 
£‰šgs
->auth_type;

2037 
u16
 
b—cÚ_›_h—d_Ën
;

2038 
u16
 
chª_šfo
;

2039 
u16
 
fw_äeq
;

2040 
u16
 
vht_›s_Ën
 = 0;

2041 
u8
 
ext_ÿ·b_Ën
 = 0;

2042 
u16
 
chªÃl_’code
 = 0;

2043 cÚ¡ 
u8
 *
»cv_vht_ÿ·b_›
, *
»cv_vht_İ”©iÚ_›
;

2044 
u8
 *
vht_›_ÿ·b
, *
vht_›_İ”©iÚ
;

2046 
	`SLSI_UNUSED_PARAMETER
(
bssid
);

2048 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

2049 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_START.request\n");

2050  -
EOPNOTSUPP
;

2053 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2055 
mgmt
 = (
›“80211_mgmt
 *)
£‰šgs
->
b—cÚ
.
h—d
;

2056 
b—cÚ_›_h—d_Ën
 = 
£‰šgs
->
b—cÚ
.
h—d_Ën
 - ((
u8
 *)
mgmt
->
u
.b—cÚ.
v¬ŸbË
 - (u8 *)mgmt);

2059 
ndev_vif
->
­
.
´ivacy
 = (
mgmt
->
u
.
b—cÚ
.
ÿ·b_šfo
 & 
WLAN_CAPABILITY_PRIVACY
);

2060 
ndev_vif
->
­
.
qos_’abËd
 = (
mgmt
->
u
.
b—cÚ
.
ÿ·b_šfo
 & 
WLAN_CAPABILITY_QOS
);

2062 
auth_ty³
) {

2063 
NL80211_AUTHTYPE_OPEN_SYSTEM
:

2064 
NL80211_AUTHTYPE_SHARED_KEY
:

2066 
NL80211_AUTHTYPE_AUTOMATIC
:

2067 
auth_ty³
 = 
NL80211_AUTHTYPE_OPEN_SYSTEM
;

2068 ià(
£‰šgs
->
´ivacy
 && s‘tšgs->
üy±o
.
ch”_group
 == 0)

2069 
auth_ty³
 = 
NL80211_AUTHTYPE_SHARED_KEY
;

2072 
	`SLSI_NET_ERR
(
dev
, "UnsuµÜ‹d‡uth_ty³: %d\n", 
auth_ty³
);

2073  -
EOPNOTSUPP
;

2076 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_¡¬t_»q(vif:%u, bssid:%pM, ssid:%.*s, hidd’:%d)\n", 
ndev_vif
->
iâum
, 
bssid
, ()
£‰šgs
->
ssid_Ën
, s‘tšgs->
ssid
, s‘tšgs->
hidd’_ssid
);

2078 ià(
­³nd_vht_›s
) {

2079 
vht_›s_Ën
 = 
SLSI_VHT_CAPABILITIES_IE_LEN
 + 
SLSI_VHT_OPERATION_IE_LEN
;

2081 
»cv_vht_ÿ·b_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_VHT_CAPABILITY
, 
£‰šgs
->
b—cÚ
.

,

2082 
£‰šgs
->
b—cÚ
.
_Ën
);

2083 ià(
»cv_vht_ÿ·b_›
)

2084 
vht_›s_Ën
 -ğ(
»cv_vht_ÿ·b_›
[1] + 2);

2086 
»cv_vht_İ”©iÚ_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_VHT_OPERATION
, 
£‰šgs
->
b—cÚ
.

,

2087 
£‰šgs
->
b—cÚ
.
_Ën
);

2088 ià(
»cv_vht_İ”©iÚ_›
)

2089 
vht_›s_Ën
 -ğ(
»cv_vht_İ”©iÚ_›
[1] + 2);

2091 ià(
ndev_vif
->
chªdef
->
width
 =ğ
NL80211_CHAN_WIDTH_80
) {

2095 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VHT - Ext Capab IEo be included\n");

2096 
ext_ÿ·b_Ën
 = 
SLSI_AP_EXT_CAPAB_IE_LEN_MAX
;

2099 ià(
£‰šgs
->
hidd’_ssid
 == 1)

2100 
»q
 = 
	`çpi_®loc
(
mlme_¡¬t_»q
, 
MLME_START_REQ
, 
ndev_vif
->
iâum
, 
£‰šgs
->
ssid_Ën
 + 
b—cÚ_›_h—d_Ën
 + s‘tšgs->
b—cÚ
.
_Ën
 + 
vht_›s_Ën
 + 
ext_ÿ·b_Ën
);

2102 
»q
 = 
	`çpi_®loc
(
mlme_¡¬t_»q
, 
MLME_START_REQ
, 
ndev_vif
->
iâum
, 
b—cÚ_›_h—d_Ën
 + 
£‰šgs
->
b—cÚ
.
_Ën
 + 
vht_›s_Ën
 + 
ext_ÿ·b_Ën
);

2104 ià(!
»q
)

2105  -
ENOMEM
;

2106 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_¡¬t_»q
.
bssid
, 
dev
->
dev_addr
);

2107 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¡¬t_»q
.
b—cÚ_³riod
, 
£‰šgs
->
b—cÚ_š‹rv®
);

2108 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¡¬t_»q
.
dtim_³riod
, 
£‰šgs
->dtim_period);

2109 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¡¬t_»q
.
ÿ·b™y_šfÜm©iÚ
, 
	`Ë16_to_ıu
(
mgmt
->u.
b—cÚ
.
ÿ·b_šfo
));

2110 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¡¬t_»q
.
auth’tiÿtiÚ_ty³
, 
auth_ty³
);

2111 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¡¬t_»q
.
hidd’_ssid
, 
£‰šgs
->hidd’_ssid < 3 ? s‘tšgs->hidd’_ssid : 
NL80211_HIDDEN_SSID_ZERO_LEN
);

2112 
chªÃl_’code
 = 
ndev_vif
->
acs
 =ğ
Œue
 ? 0 : 1;

2113 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_¡¬t_»q
.
¥¬e_1
, 0);

2114 
	`çpi_£t_low16_u32
(
»q
, 
u
.
mlme_¡¬t_»q
.
¥¬e_1
, 
chªÃl_’code
);

2115 #ifdeà
CONFIG_SCSC_WLAN_SAE_PWE


2116 ià(
£‰šgs
->
üy±o
.
§e_pwe
 =ğ
NL80211_SAE_PWE_HASH_TO_ELEMENT
)

2117 
	`çpi_£t_high16_u32
(
»q
, 
u
.
mlme_¡¬t_»q
.
¥¬e_1
, 1);

2120 
fw_äeq
 = 
ndev_vif
->
chª
->
ûÁ”_äeq
;

2121 
chª_šfo
 = 
	`¦si_g‘_chªn_šfo
(
sdev
, 
ndev_vif
->
chªdef
);

2122 ià((
chª_šfo
 & 20) != 20)

2123 
fw_äeq
 = 
	`¦si_g‘_ûÁ”_äeq1
(
sdev
, 
chª_šfo
, fw_freq);

2125 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¡¬t_»q
.
chªÃl_äequ’cy
, (2 * 
fw_äeq
));

2126 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¡¬t_»q
.
chªÃl_šfÜm©iÚ
, 
chª_šfo
);

2127 
ndev_vif
->
­
.
chªÃl_äeq
 = 
fw_äeq
;

2130 ià(
£‰šgs
->
hidd’_ssid
 != 0) {

2131 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 2 + 
£‰šgs
->
ssid_Ën
);

2132 ià(!
p
) {

2133 
	`kä“_skb
(
»q
);

2134  -
EINVAL
;

2136 *
p
++ = 
WLAN_EID_SSID
;

2137 *
p
++ = 
£‰šgs
->
ssid_Ën
;

2138 
	`memıy
(
p
, 
£‰šgs
->
ssid
, s‘tšgs->
ssid_Ën
);

2141 ià(
b—cÚ_›_h—d_Ën
 && 
£‰šgs
->
hidd’_ssid
 == 0)

2142 
	`çpi_­³nd_d©a
(
»q
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
, 
b—cÚ_›_h—d_Ën
);

2143 ià(
b—cÚ_›_h—d_Ën
 && 
£‰šgs
->
hidd’_ssid
 == 1)

2144 
	`çpi_­³nd_d©a
(
»q
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
 + 2, 
b—cÚ_›_h—d_Ën
 - 2);

2145 ià(
b—cÚ_›_h—d_Ën
 && 
£‰šgs
->
hidd’_ssid
 == 2)

2146 
	`çpi_­³nd_d©a
(
»q
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
 + 2 + 
£‰šgs
->
ssid_Ën
, 
b—cÚ_›_h—d_Ën
 - (2 + settings->ssid_len));

2148 ià(
£‰šgs
->
b—cÚ
.
_Ën
)

2149 
	`¦si_mlme_¡¬t_´•¬e_›s
(
»q
, 
ndev_vif
, 
£‰šgs
, 
w·_›_pos
, 
wmm_›_pos
);

2151 ià((
­³nd_vht_›s
è&& !
	`¦si_´•¬e_vht_›s
(
dev
, &
vht_›_ÿ·b
, &
vht_›_İ”©iÚ
)) {

2152 
	`çpi_­³nd_d©a
(
»q
, 
vht_›_ÿ·b
, 
SLSI_VHT_CAPABILITIES_IE_LEN
);

2153 
	`çpi_­³nd_d©a
(
»q
, 
vht_›_İ”©iÚ
, 
SLSI_VHT_OPERATION_IE_LEN
);

2154 
	`kä“
(
vht_›_ÿ·b
);

2155 
	`kä“
(
vht_›_İ”©iÚ
);

2158 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_START_CFM
);

2159 ià(!
cfm
)

2160  -
EIO
;

2161 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_¡¬t_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

2162 
	`SLSI_NET_ERR
(
dev
, "mlme_start_cfm(result:0x%04x) ERROR\n",

2163 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_¡¬t_cfm
.
»suÉ_code
));

2164 
r
 = -
EINVAL
;

2167 
	`kä“_skb
(
cfm
);

2168  
r
;

2169 
	}
}

2171 cÚ¡ 
u8
 *
	$¦si_mlme_cÚÃù_g‘_£c_›
(
cfg80211_cÚÃù_·¿ms
 *
sme
, *
£c_›_Ën
, 
boŞ
 *
r¢x_æag
)

2173 
u16
 
v”siÚ
;

2174 cÚ¡ 
u8
 *
±r
 = 
NULL
;

2175 cÚ¡ 
u8
 *
±r_r¢x
 = 
NULL
;

2176 
u8
 *
£c_›
 = 
NULL
;

2177 
›_Ën
 = 0;

2178 
r¢x_›_Ën
 = 0;

2180 ià(
sme
->
üy±o
.
w·_v”siÚs
 == 0) {

2182 
±r
 = 
	`cfg80211_fšd_›
(
SLSI_WLAN_EID_WAPI
, 
sme
->
›
, sme->
›_Ën
);

2183 ià(
±r
) {

2184 
v”siÚ
 = 
±r
[3] << 8 |…tr[2];

2185 ià(
v”siÚ
 != 1) {

2186 
	`SLSI_ERR_NODEV
("UÃx³ùed v”siÚ (%dèš WAPI ie\n", 
v”siÚ
);

2187  
NULL
;

2190 } ià(
sme
->
üy±o
.
w·_v”siÚs
 == 2) {

2192 
±r
 = 
	`cfg80211_fšd_›
(
WLAN_EID_RSN
, 
sme
->
›
, sme->
›_Ën
);

2194 ià(
±r
) {

2196 
v”siÚ
 = 
±r
[2 + 1] << 8 |…tr[2];

2197 ià(
v”siÚ
 != 1) {

2198 
	`SLSI_ERR_NODEV
("UÃx³ùed v”siÚ (%dèš„¢ ie\n", 
v”siÚ
);

2199  
NULL
;

2203 
±r_r¢x
 = 
	`cfg80211_fšd_›
(
SLSI_WLAN_EID_RSNX
, 
sme
->
›
, sme->
›_Ën
);

2204 
r¢x_›_Ën
 = (
±r_r¢x
 ?…tr_rsnx[1] + 2 : 0);

2206 
›_Ën
 = (
±r
 ?…tr[1] + 2 : 0);

2207 *
£c_›_Ën
 = 
›_Ën
 + 
r¢x_›_Ën
;

2208 ià(*
£c_›_Ën
 == 0)

2209  
NULL
;

2210 ià(
±r_r¢x
 && 
r¢x_›_Ën
 > 0) {

2211 
£c_›
 = 
	`km®loc
((
size_t
)*
£c_›_Ën
, 
GFP_KERNEL
);

2212 ià(!
£c_›
) {

2213 
	`SLSI_ERR_NODEV
("Error‡locating sec_ie\n");

2214 *
£c_›_Ën
 = 0;

2215  
NULL
;

2217 
	`memıy
(
£c_›
, 
±r
, 
›_Ën
);

2218 
	`memıy
(
£c_›
 + 
›_Ën
, 
±r_r¢x
, 
r¢x_›_Ën
);

2219 *
r¢x_æag
 = 
Œue
;

2220  
£c_›
;

2222  
±r
;

2223 
	}
}

2228 
	$¦si_mlme_cÚÃù_šfo_–ems_›_´•
(
¦si_dev
 *
sdev
, cÚ¡ 
u8
 *
cÚÃù_›
,

2229 cÚ¡ 
size_t
 
cÚÃù_›_Ën
, 
boŞ
 
is_cİy
, 
u8
 *
›_de¡
, 
›_de¡_Ën
)

2231 cÚ¡ 
u8
 *
›_pos
 = 
NULL
;

2232 
šfo_–em_Ëngth
 = 0;

2233 
u16
 
cu¼_›_Ën
, 
»m_Ën
;

2234 
i
 = 0;

2235 
u8
 
›_eid
[] = {
SLSI_WLAN_EID_INTERWORKING
,

2236 
SLSI_WLAN_EID_EXTENSION
,

2237 
WLAN_EID_VENDOR_SPECIFIC
};

2239 ià(
is_cİy
 && (!
›_de¡
 || 
›_de¡_Ën
 == 0))

2240  -
EINVAL
;

2242 
i
 = 0; i < (
›_eid
è/ (
u8
); i++) {

2243 
›_pos
 = 
	`cfg80211_fšd_›
(
›_eid
[
i
], 
cÚÃù_›
, 
cÚÃù_›_Ën
);

2244 
›_pos
) {

2245 
cu¼_›_Ën
 = *(
›_pos
 + 1) + 2;

2246 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "IE[%d] i ´e£Á havšg†’gth:%d\n", 
›_eid
[
i
], 
cu¼_›_Ën
);

2247 ià(
is_cİy
) {

2248 ià(
›_de¡_Ën
 >ğ
cu¼_›_Ën
) {

2249 
	`memıy
(
›_de¡
, 
›_pos
, 
cu¼_›_Ën
);

2250 
›_de¡
 +ğ
cu¼_›_Ën
;

2252 
›_de¡_Ën
 -ğ
cu¼_›_Ën
;

2254 
	`SLSI_ERR_NODEV
("IE[%d]ƒxŒaùƒ¼Ü (›_cİy_l:%d, c_›_l:%d):\n", 
›_eid
[
i
],

2255 
›_de¡_Ën
, 
cu¼_›_Ën
);

2256  -
EINVAL
;

2259 
šfo_–em_Ëngth
 +ğ
cu¼_›_Ën
;

2261 
›_pos
 +ğ
cu¼_›_Ën
;

2262 
»m_Ën
 = 
cÚÃù_›_Ën
 - (
›_pos
 - 
cÚÃù_›
);

2263 
›_pos
 = 
	`cfg80211_fšd_›
(
›_eid
[
i
], ie_pos, 
»m_Ën
);

2267 ià(
sdev
->
deviû_cÚfig
.
qos_šfo
 != -1) {

2268 ià(
is_cİy
) {

2269 ià(
›_de¡_Ën
 >= 9) {

2270 
pos
 = 0;

2272 
›_de¡
[
pos
++] = 
SLSI_WLAN_EID_VENDOR_SPECIFIC
;

2273 
›_de¡
[
pos
++] = 0x07;

2274 
›_de¡
[
pos
++] = 0x00;

2275 
›_de¡
[
pos
++] = 0x50;

2276 
›_de¡
[
pos
++] = 0xf2;

2277 
›_de¡
[
pos
++] = 
WLAN_OUI_TYPE_MICROSOFT_WMM
;

2278 
›_de¡
[
pos
++] = 
WMM_OUI_SUBTYPE_INFORMATION_ELEMENT
;

2279 
›_de¡
[
pos
++] = 
WMM_VERSION
;

2280 
›_de¡
[
pos
++] = 
sdev
->
deviû_cÚfig
.
qos_šfo
 & 0x0F;

2281 
›_de¡
 +ğ
pos
;

2282 
›_de¡_Ën
 -ğ
pos
;

2284 
	`SLSI_ERR_NODEV
("Requœed 9by‹ buˆËá:%d\n", 
›_de¡_Ën
);

2285  -
EINVAL
;

2287 
sdev
->
deviû_cÚfig
.
qos_šfo
 = -1;

2289 
šfo_–em_Ëngth
 += 9;

2292  
šfo_–em_Ëngth
;

2293 
	}
}

2295 
	$¦si_mlme_cÚÃù_šfo_–em’ts
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
cfg80211_cÚÃù_·¿ms
 *
sme
)

2297 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2298 
šfo_–em_Ëngth
 = 0;

2299 
sk_buff
 *
»q
;

2300 
sk_buff
 *
cfm
;

2301 
r
 = 0;

2302 
u8
 *
p
;

2304 
šfo_–em_Ëngth
 = 
	`¦si_mlme_cÚÃù_šfo_–ems_›_´•
(
sdev
, 
sme
->
›
, sme->
›_Ën
, 
çl£
, 
NULL
, 0);

2307 ià(
šfo_–em_Ëngth
 <= 0)

2308  
šfo_–em_Ëngth
;

2310 
»q
 = 
	`çpi_®loc
(
mlme_add_šfo_–em’ts_»q
, 
MLME_ADD_INFO_ELEMENTS_REQ
,

2311 
ndev_vif
->
iâum
, 
šfo_–em_Ëngth
);

2312 ià(!
»q
)

2313  -
ENOMEM
;

2315 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_add_šfo_–em’ts_»q
.
pu½o£
, 
FAPI_PURPOSE_ASSOCIATION_REQUEST
);

2317 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 
šfo_–em_Ëngth
);

2318 ià(!
p
) {

2319 
	`kä“_skb
(
»q
);

2320  -
EINVAL
;

2323 ()
	`¦si_mlme_cÚÃù_šfo_–ems_›_´•
(
sdev
, 
sme
->
›
, sme->
›_Ën
, 
Œue
, 
p
, 
šfo_–em_Ëngth
);

2326 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

2327 ià(
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
)

2328 
	`kä“
(
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
);

2329 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
 = 0;

2331 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
 = 
	`km®loc
(
šfo_–em_Ëngth
, 
GFP_KERNEL
);

2332 ià(
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
) {

2333 
	`memıy
(
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em
, 
p
, 
šfo_–em_Ëngth
);

2334 
ndev_vif
->
¡a
.
assoc_»q_add_šfo_–em_Ën
 = 
šfo_–em_Ëngth
;

2336 
	`SLSI_WARN
(
sdev
, "NØmem fÜ‚dev_vif->¡a.assoc_»q_add_šfo_–em siz%d\n", 
šfo_–em_Ëngth
);

2340 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_add_šfo_–em’ts_»q(vif:%u)\n", 
ndev_vif
->
iâum
);

2341 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_ADD_INFO_ELEMENTS_CFM
);

2342 ià(!
cfm
)

2343  -
EIO
;

2345 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_add_šfo_–em’ts_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

2346 
	`SLSI_NET_ERR
(
dev
, "mlme_add_info_elements_cfm(result:0x%04x) ERROR\n",

2347 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_cÚÃù_cfm
.
»suÉ_code
));

2348 
r
 = -
EINVAL
;

2351 ià(
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPS
, 
sme
->
›
, sme->
›_Ën
))

2352 
ndev_vif
->
¡a
.
is_wps
 = 
Œue
;

2354 
	`kä“_skb
(
cfm
);

2355  
r
;

2356 
	}
}

2358 
	$¦si_mlme_cÚÃù
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
cfg80211_cÚÃù_·¿ms
 *
sme
, 
›“80211_chªÃl
 *
chªÃl
, cÚ¡ 
u8
 *
bssid
)

2360 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2361 
sk_buff
 *
»q
;

2362 
sk_buff
 *
cfm
;

2363 
r
 = 0;

2364 
u8
 *
p
;

2365 
Æ80211_auth_ty³
 
auth_ty³
 = 
sme
->auth_type;

2366 
u8
 
mac_addr
[
ETH_ALEN
] = { 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF };

2367 
key_·¿ms
 
¦si_key
;

2368 cÚ¡ 
u8
 *
£c_›
 = 
NULL
;

2369 
£c_›_Ën
 = 0;

2370 
boŞ
 
r¢x_›_æag
 = 
çl£
;

2372 
	`mem£t
(&
¦si_key
, 0, (slsi_key));

2374 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

2375 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_CONNECT.request\n");

2376  -
EOPNOTSUPP
;

2379 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2381 ià(
	`WARN
(!
bssid
, "BSSID is Null"))

2382  -
EINVAL
;

2384 ià(
	`WARN
(!
sme
->
ssid_Ën
, "SSID is Null"))

2385  -
EINVAL
;

2387 
auth_ty³
) {

2388 
NL80211_AUTHTYPE_OPEN_SYSTEM
:

2389 
NL80211_AUTHTYPE_SHARED_KEY
:

2391 
NL80211_AUTHTYPE_SAE
:

2392 
auth_ty³
 = 
NL80211_AUTHTYPE_NETWORK_EAP
;

2394 
NL80211_AUTHTYPE_AUTOMATIC
:

2398 ià(
sme
->
´ivacy
 &&

2399 (
sme
->
üy±o
.
ch”_group
 =ğ
WLAN_CIPHER_SUITE_WEP40
 ||

2400 
sme
->
üy±o
.
ch”_group
 =ğ
WLAN_CIPHER_SUITE_WEP104
))

2401 
auth_ty³
 = 
NL80211_AUTHTYPE_SHARED_KEY
;

2403 
auth_ty³
 = 
NL80211_AUTHTYPE_OPEN_SYSTEM
;

2406 
	`SLSI_NET_ERR
(
dev
, "UnsuµÜ‹d‡uth_ty³: %d\n", 
auth_ty³
);

2407  -
EOPNOTSUPP
;

2411 ià((
auth_ty³
 =ğ
NL80211_AUTHTYPE_SHARED_KEY
) &&

2412 ((
sme
->
üy±o
.
ch”_group
 =ğ
WLAN_CIPHER_SUITE_WEP40
) ||

2413 (
sme
->
üy±o
.
ch”_group
 =ğ
WLAN_CIPHER_SUITE_WEP104
)) &&

2414 (
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
)) {

2415 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "key†’ (%d)\n", 
sme
->
key_Ën
);

2416 
¦si_key
.
key
 = (
u8
 *)
sme
->key;

2417 ià(!
¦si_key
.
key
)

2418  -
EINVAL
;

2419 
¦si_key
.
key_Ën
 = 
sme
->key_len;

2420 
¦si_key
.
£q_Ën
 = 0;

2421 ià(
sme
->
üy±o
.
n_ch”s_·œwi£
)

2422 
¦si_key
.
ch”
 = 
sme
->
üy±o
.
ch”s_·œwi£
[0];

2424 
r
 = 
	`¦si_mlme_£t_key
(
sdev
, 
dev
, 
sme
->
key_idx
, 
FAPI_KEYTYPE_WEP
, 
mac_addr
, &
¦si_key
);

2425 ià(
r
 != 0) {

2426 
	`SLSI_NET_ERR
(
dev
, "E¼Ü S‘tšg Sh¬ed key (%d)", 
r
);

2427  
r
;

2432 ià(
sme
->
›_Ën
) {

2433 
r
 = 
	`¦si_mlme_cÚÃù_šfo_–em’ts
(
sdev
, 
dev
, 
sme
);

2434 ià(
r
)

2435  
r
;

2437 
£c_›
 = 
	`¦si_mlme_cÚÃù_g‘_£c_›
(
sme
, &
£c_›_Ën
, &
r¢x_›_æag
);

2438 ià(
£c_›_Ën
 < 0) {

2439 
	`SLSI_NET_ERR
(
dev
, "ERROR…reparing Security IEs\n");

2440  
£c_›_Ën
;

2444 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_cÚÃù_»q(vif:%u, bssid:%pM, ssid:%.*s)\n", 
ndev_vif
->
iâum
, 
bssid
, ()
sme
->
ssid_Ën
, sme->
ssid
);

2445 
»q
 = 
	`çpi_®loc
(
mlme_cÚÃù_»q
, 
MLME_CONNECT_REQ
, 
ndev_vif
->
iâum
,

2446 2 + 
sme
->
ssid_Ën
 +

2447 
£c_›_Ën
);

2448 ià(!
»q
)

2449  -
ENOMEM
;

2451 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_cÚÃù_»q
.
bssid
, bssid);

2452 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_cÚÃù_»q
.
auth’tiÿtiÚ_ty³
, 
auth_ty³
);

2454 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_cÚÃù_»q
.
chªÃl_äequ’cy
, (2 * 
chªÃl
->
ûÁ”_äeq
));

2456 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 2 + 
sme
->
ssid_Ën
 + 
£c_›_Ën
);

2457 ià(!
p
) {

2458 
	`kä“_skb
(
»q
);

2459  -
EINVAL
;

2461 *
p
++ = 
WLAN_EID_SSID
;

2462 *
p
++ = 
sme
->
ssid_Ën
;

2463 
	`memıy
(
p
, 
sme
->
ssid
, sme->
ssid_Ën
);

2464 
p
 +ğ
sme
->
ssid_Ën
;

2466 ià(
£c_›_Ën
)

2467 
	`memıy
(
p
, 
£c_›
, 
£c_›_Ën
);

2468 ià(
r¢x_›_æag
 && 
£c_›
)

2469 
	`kä“
(
£c_›
);

2470 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_CONNECT_CFM
);

2471 ià(!
cfm
)

2472  -
EIO
;

2474 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_cÚÃù_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

2475 
	`SLSI_NET_ERR
(
dev
, "mlme_connect_cfm(result:0x%04x) ERROR\n",

2476 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_cÚÃù_cfm
.
»suÉ_code
));

2477 
r
 = -
EINVAL
;

2479 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

2481 
ndev_vif
->
¡a
.
drv_cÚÃù_»q_Úgošg
 = 
Œue
;

2484 
	`kä“_skb
(
cfm
);

2485  
r
;

2486 
	}
}

2488 
	$¦si_mlme_cÚÃù_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

2490 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2491 
sk_buff
 *
»q
;

2492 
sk_buff
 *
cfm
;

2494 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

2497 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

2498 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_CONNECT_RESP\n");

2502 
	`SLSI_NET_INFO
(
dev
, "mlme_cÚÃù_»¥(vif:%u)\n", 
ndev_vif
->
iâum
);

2503 
»q
 = 
	`çpi_®loc
(
mlme_cÚÃù_»s
, 
MLME_CONNECT_RES
, 
ndev_vif
->
iâum
, 0);

2504 ià(!
»q
)

2507 
cfm
 = 
	`¦si_mlme_»q_no_cfm
(
sdev
, 
dev
, 
»q
);

2508 
	`WARN_ON
(
cfm
);

2509 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

2510 
ndev_vif
->
¡a
.
drv_cÚÃù_»q_Úgošg
 = 
çl£
;

2511 
	`¦si_ä“_cÚÃùiÚ_·¿ms
(
sdev
, 
dev
);

2512 
	`¦si_£t_»£t_cÚÃù_©‹m±ed_æag
(
sdev
, 
dev
, 
NULL
);

2514 
	}
}

2516 
	$¦si_mlme_cÚÃùed_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
³”_šdex
)

2518 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2519 
sk_buff
 *
»q
;

2521 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

2524 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

2525 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_CONNECT_RESP\n");

2529 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_cÚÃùed_»¥(vif:%u,…“r_šdex:%d)\n", 
ndev_vif
->
iâum
, 
³”_šdex
);

2530 
»q
 = 
	`çpi_®loc
(
mlme_cÚÃùed_»s
, 
MLME_CONNECTED_RES
, 
ndev_vif
->
iâum
, 0);

2531 ià(!
»q
) {

2532 
	`SLSI_NET_ERR
(
dev
, "mlme-connected-response :: memory‡llocation failed\n");

2536 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_cÚÃùed_»s
.
assocŸtiÚ_id’tif›r
, 
³”_šdex
);

2537 
	`¦si_mlme_»q_no_cfm
(
sdev
, 
dev
, 
»q
);

2538 
	}
}

2540 
	$¦si_mlme_rßmed_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

2542 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2543 
sk_buff
 *
»q
;

2544 
sk_buff
 *
cfm
;

2546 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

2549 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

2550 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_ROAMED_RESP\n");

2554 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_roamed_resp\n");

2555 
»q
 = 
	`çpi_®loc
(
mlme_rßmed_»s
, 
MLME_ROAMED_RES
, 
ndev_vif
->
iâum
, 0);

2556 ià(!
»q
)

2559 
cfm
 = 
	`¦si_mlme_»q_no_cfm
(
sdev
, 
dev
, 
»q
);

2560 
	`WARN_ON
(
cfm
);

2561 
	}
}

2564 
boŞ
 
	$¦si_discÚÃù_cfm_v®id©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
cfm
)

2566 
»suÉ
 = 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_discÚÃù_cfm
.
»suÉ_code
);

2567 
boŞ
 
r
 = 
çl£
;

2569 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

2571 ià(
	`WARN_ON
(!
dev
))

2572 
ex™
;

2574 ià(
»suÉ
 =ğ
FAPI_RESULTCODE_SUCCESS
)

2575 
r
 = 
Œue
;

2577 ià(
»suÉ
 !ğ
FAPI_RESULTCODE_NOT_PRESENT
)

2578 
	`SLSI_NET_ERR
(
dev
, "mlme_disconnect_cfm(result:0x%04x) ERROR\n",

2579 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_discÚÃù_cfm
.
»suÉ_code
));

2581 
ex™
:

2582 
	`kä“_skb
(
cfm
);

2583  
r
;

2584 
	}
}

2587 
boŞ
 
	$¦si_rßmšg_chªÃl_li¡_cfm_v®id©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
cfm
)

2589 
»suÉ
 = 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_rßmšg_chªÃl_li¡_cfm
.
»suÉ_code
);

2590 
boŞ
 
r
 = 
çl£
;

2592 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

2594 ià(
	`WARN_ON
(!
dev
))

2595 
ex™
;

2597 ià(
»suÉ
 =ğ
FAPI_RESULTCODE_SUCCESS
)

2598 
r
 = 
Œue
;

2600 ià(
»suÉ
 !ğ
FAPI_RESULTCODE_NOT_PRESENT
)

2601 
	`SLSI_NET_ERR
(
dev
, "mlme_roaming_channel_list_cfm(result:0x%04x) ERROR\n",

2602 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_rßmšg_chªÃl_li¡_cfm
.
»suÉ_code
));

2604 
ex™
:

2605 
	`kä“_skb
(
cfm
);

2606  
r
;

2607 
	}
}

2609 
sk_buff
 *
	$¦si_mlme_rßmšg_chªÃl_li¡_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

2611 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2612 
sk_buff
 *
»q
;

2613 
sk_buff
 *
rx
;

2615 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

2616 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_DISCONNECT.request\n");

2617  
NULL
;

2620 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2622 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_rßmšg_chªÃl_li¡_»q(vif:%u)\n", 
ndev_vif
->
iâum
);

2624 
»q
 = 
	`çpi_®loc
(
mlme_rßmšg_chªÃl_li¡_»q
, 
MLME_ROAMING_CHANNEL_LIST_REQ
, 
ndev_vif
->
iâum
, 0);

2625 ià(!
»q
) {

2626 
	`SLSI_NET_ERR
(
dev
, "fapi_alloc failed!\n");

2627  
NULL
;

2630 
rx
 = 
	`¦si_mlme_»q_cfm_šd
(
sdev
, 
dev
, 
»q
, 
MLME_ROAMING_CHANNEL_LIST_CFM
, 
MLME_ROAMING_CHANNEL_LIST_IND
, 
¦si_rßmšg_chªÃl_li¡_cfm_v®id©e
);

2631 ià(!
rx
) {

2632 
	`SLSI_NET_ERR
(
dev
, "mlme_roaming_channel_list_cfm() ERROR\n");

2633  
NULL
;

2636  
rx
;

2637 
	}
}

2639 
	$¦si_mlme_discÚÃù
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
mac
, 
u16
 
»asÚ_code
, 
boŞ
 
wa™_šd
)

2641 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2642 
sk_buff
 *
»q
;

2643 
sk_buff
 *
rx
;

2644 
r
 = 0;

2646 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

2647 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_DISCONNECT.request\n");

2648  -
EOPNOTSUPP
;

2651 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2652 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

2653  -
EINVAL
;

2655 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_discÚÃù_»q(vif:%u, bssid:%pM,„—sÚ:%d)\n", 
ndev_vif
->
iâum
, 
mac
, 
»asÚ_code
);

2657 
»q
 = 
	`çpi_®loc
(
mlme_discÚÃù_»q
, 
MLME_DISCONNECT_REQ
, 
ndev_vif
->
iâum
,

2658 
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s_Ën
);

2660 ià(!
»q
)

2661  -
ENOMEM
;

2662 
	`SLSI_INFO
(
sdev
, "S’d DEAUTH,„—sÚ = %d\n", 
»asÚ_code
);

2663 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_discÚÃù_»q
.
»asÚ_code
,„eason_code);

2664 ià(
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s_Ën
 > 0)

2665 
	`çpi_­³nd_d©a
(
»q
, 
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s
,‚dev_vif->¡a.
v’dÜ_discÚÃù_›s_Ën
);

2666 
	`kä“
(
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s
);

2667 
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s
 = 
NULL
;

2668 
ndev_vif
->
¡a
.
v’dÜ_discÚÃù_›s_Ën
 = 0;

2670 ià(
mac
)

2671 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_discÚÃù_»q
.
³”_¡a_add»ss
, 
mac
);

2673 
	`çpi_£t_mem£t
(
»q
, 
u
.
mlme_discÚÃù_»q
.
³”_¡a_add»ss
, 0);

2674 ià(
wa™_šd
) {

2675 
rx
 = 
	`¦si_mlme_»q_cfm_šd
(
sdev
, 
dev
, 
»q
, 
MLME_DISCONNECT_CFM
, 
MLME_DISCONNECT_IND
, 
¦si_discÚÃù_cfm_v®id©e
);

2676 ià(!
rx
) {

2677 
	`SLSI_NET_ERR
(
dev
, "mlme_disconnect_cfm() ERROR\n");

2678 
r
 = -
EINVAL
;

2681 
rx
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_DISCONNECT_CFM
);

2682 ià(
rx
) {

2683 ià(
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_discÚÃù_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

2684 
	`SLSI_NET_ERR
(
dev
, "mlme_disconnect_cfm(result:0x%04x) ERROR\n",

2685 
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_discÚÃù_cfm
.
»suÉ_code
));

2686 
r
 = -
EINVAL
;

2689 
r
 = -
EIO
;

2693 
	`kä“_skb
(
rx
);

2694  
r
;

2695 
	}
}

2697 
	$¦si_mlme_£t_key
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
key_id
, u16 
key_ty³
, cÚ¡ 
u8
 *
add»ss
, 
key_·¿ms
 *
key
)

2699 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2700 
sk_buff
 *
»q
;

2701 
sk_buff
 *
cfm
;

2702 
r
 = 0;

2704 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

2705 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_SETKEYS.request\n");

2706  -
EOPNOTSUPP
;

2709 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2711 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_£tkeys_»q(key_id:%d, key_ty³:%d,‡dd»ss:%pM,†’gth:%d, ch”:0x%.8X)\n", 
key_id
, 
key_ty³
, 
add»ss
, 
key
->
key_Ën
, key->
ch”
);

2712 
»q
 = 
	`çpi_®loc
(
mlme_£tkeys_»q
, 
MLME_SETKEYS_REQ
, 
ndev_vif
->
iâum
, 
key
->
key_Ën
 + 1);

2713 ià(!
»q
)

2714  -
ENOMEM
;

2715 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£tkeys_»q
.
Ëngth
, 
key
->
key_Ën
 * 8);

2716 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£tkeys_»q
.
key_id
, key_id);

2717 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£tkeys_»q
.
key_ty³
, key_type);

2718 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_£tkeys_»q
.
add»ss
,‡ddress);

2719 
	`çpi_£t_mem£t
(
»q
, 
u
.
mlme_£tkeys_»q
.
£qu’û_numb”
, 0x00);

2721 ià(
key
->
£q_Ën
 && key->
£q
) {

2722 
i
;

2723 
u16
 
‹mp_£q
;

2725 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "mlme_£tkeys_»q(key->£q_Ën:%d)\n", 
key
->
£q_Ën
);

2732 
i
 = 0; i < 
key
->
£q_Ën
; i += 2) {

2733 
‹mp_£q
 = (
u16
)(
key
->
£q
[
i
 + 1] << 8) | (u16)(key->seq[i]);

2734 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£tkeys_»q
.
£qu’û_numb”
[
i
 / 2], 
‹mp_£q
);

2738 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_£tkeys_»q
.
ch”_su™e_£ËùÜ
, 
key
->
ch”
);

2740 ià(
key
->
ch”
 =ğ
WLAN_CIPHER_SUITE_WEP40
 || key->ch” =ğ
WLAN_CIPHER_SUITE_WEP104
) {

2741 
u8
 
w•_key_id
 = (u8)
key_id
;

2743 ià(
key_id
 > 3)

2744 
	`SLSI_NET_WARN
(
dev
, "Key ID is greaterhan 3");

2748 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£tkeys_»q
.
Ëngth
, (
key
->
key_Ën
 + 1) * 8);

2749 
	`çpi_­³nd_d©a
(
»q
, &
w•_key_id
, 1);

2751 
	`çpi_­³nd_d©a
(
»q
, 
key
->key, key->
key_Ën
);

2753 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SETKEYS_CFM
);

2754 ià(!
cfm
)

2755  -
EIO
;

2757 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£tkeys_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

2758 
	`SLSI_NET_ERR
(
dev
, "mlme_setkeys_cfm(result:0x%04x) ERROR\n",

2759 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£tkeys_cfm
.
»suÉ_code
));

2760 
r
 = -
EINVAL
;

2762 
	`kä“_skb
(
cfm
);

2763  
r
;

2764 
	}
}

2766 
	$¦si_mlme_g‘_key
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
key_id
, u16 
key_ty³
, 
u8
 *
£q
, *
£q_Ën
)

2768 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2769 
sk_buff
 *
»q
;

2770 
sk_buff
 *
cfm
;

2771 
r
 = 0;

2773 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2775 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_g‘_key_£qu’û_»q(key_id:%d, key_ty³:%d)\n", 
key_id
, 
key_ty³
);

2776 
»q
 = 
	`çpi_®loc
(
mlme_g‘_key_£qu’û_»q
, 
MLME_GET_KEY_SEQUENCE_REQ
, 
ndev_vif
->
iâum
, 0);

2777 ià(!
»q
)

2778  -
ENOMEM
;

2779 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_g‘_key_£qu’û_»q
.
key_id
, key_id);

2780 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_g‘_key_£qu’û_»q
.
key_ty³
, key_type);

2782 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_GET_KEY_SEQUENCE_CFM
);

2783 ià(!
cfm
)

2784  -
EIO
;

2786 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_g‘_key_£qu’û_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

2787 
	`SLSI_NET_ERR
(
dev
, "mlme_get_key_sequence_cfm(result:0x%04x) ERROR\n",

2788 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_g‘_key_£qu’û_cfm
.
»suÉ_code
));

2789 
r
 = -
ENOENT
;

2791 
i
;

2792 
u16
 
‹mp_£q
;

2798 *
£q_Ën
 = 8;

2806 
i
 = 0; i < *
£q_Ën
 / 2; i++) {

2807 
‹mp_£q
 = 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_g‘_key_£qu’û_cfm
.
£qu’û_numb”
[
i
]);

2808 *
£q
 = (
u8
)(
‹mp_£q
 & 0xFF);

2809 *(
£q
 + 1èğ(
u8
)((
‹mp_£q
 >> 8) & 0xFF);

2811 
£q
 += 2;

2815 
	`kä“_skb
(
cfm
);

2816  
r
;

2817 
	}
}

2819 #ifdeà
CONFIG_SCSC_WLAN_MAX_LINK_SPEED


2820 
	$¦si_ÿlc_max_d©a_¿‹
(
Ãt_deviû
 *
dev
, 
u8
 
bªdwidth
, u8 
ª‹Âa_mode
)

2822 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2823 
u8
 
bªdwidth_šdex
, 
¡a_mode
, 
mcs_šdex
;

2825 ià(
bªdwidth
 =ğ0 || 
ª‹Âa_mode
 > 3) {

2826 
	`SLSI_NET_ERR
(
dev
, "MIB value is wrong.");

2830 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2833 
bªdwidth_šdex
 = 
bªdwidth
 / 40;

2834 
¡a_mode
 = 
	`¦si_¡a_›“80211_mode
(
dev
, 
ndev_vif
->
¡a
.
¡a_bss
->
chªÃl
->
ûÁ”_äeq
);

2836 ià(
¡a_mode
 =ğ
SLSI_80211_MODE_11B
) {

2837 
ndev_vif
->
¡a
.
max_¿‹_mbps
 = 11;

2838 } ià(
¡a_mode
 =ğ
SLSI_80211_MODE_11G
 || s_mod=ğ
SLSI_80211_MODE_11A
) {

2839 
ndev_vif
->
¡a
.
max_¿‹_mbps
 = 54;

2840 } ià(
¡a_mode
 =ğ
SLSI_80211_MODE_11N
) {

2841 
ndev_vif
->
¡a
.
max_¿‹_mbps
 = ()(
¦si_¿‹s_bË
[
bªdwidth_šdex
][1][7] * (
ª‹Âa_mode
 + 1)) / 10;

2842 } ià(
¡a_mode
 =ğ
SLSI_80211_MODE_11AC
) {

2843 ià(
bªdwidth_šdex
 == 0)

2844 
mcs_šdex
 = 8;

2846 
mcs_šdex
 = 9;

2847 
ndev_vif
->
¡a
.
max_¿‹_mbps
 = ()(
¦si_¿‹s_bË
[
bªdwidth_šdex
][1][
mcs_šdex
] * (
ª‹Âa_mode
 + 1)) / 10;

2849 
	}
}

2852 
	$¦si_decode_fw_¿‹
(
u32
 
fw_¿‹
, 
¿‹_šfo
 *
¿‹
, *
d©a_¿‹_mbps
)

2854 cÚ¡ 
fw_¿‹_idx_to_80211_¿‹
[] = { 0, 10, 20, 55, 60, 90, 110, 120, 180, 240, 360, 480, 540 };

2856 ià(
¿‹
) {

2857 
¿‹
->
æags
 = 0;

2858 
¿‹
->
Ëgacy
 = 0;

2859 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 0, 0))

2860 
¿‹
->
bw
 = 0;

2864 ià((
fw_¿‹
 & 
SLSI_FW_API_RATE_HT_SELECTOR_FIELD
è=ğ
SLSI_FW_API_RATE_NON_HT_SELECTED
) {

2865 
u16
 
fw_¿‹_idx
 = 
fw_¿‹
 & 
SLSI_FW_API_RATE_INDEX_FIELD
;

2867 ià(
fw_¿‹
 > 0 && 
fw_¿‹_idx
 < 
	`ARRAY_SIZE
(
fw_¿‹_idx_to_80211_¿‹
)) {

2868 ià(
¿‹
)

2869 
¿‹
->
Ëgacy
 = 
fw_¿‹_idx_to_80211_¿‹
[
fw_¿‹_idx
];

2870 ià(
d©a_¿‹_mbps
)

2871 *
d©a_¿‹_mbps
 = ()
fw_¿‹_idx_to_80211_¿‹
[
fw_¿‹_idx
] / 10;

2873 } ià((
fw_¿‹
 & 
SLSI_FW_API_RATE_HT_SELECTOR_FIELD
è=ğ
SLSI_FW_API_RATE_HT_SELECTED
) {

2874 
u8
 
mcs_idx
 = 
SLSI_FW_API_RATE_HT_MCS_FIELD
 & 
fw_¿‹
;

2875 
u8
 
nss
 = ((
SLSI_FW_API_RATE_HT_NSS_FIELD
 & 
fw_¿‹
) >> 6) + 1;

2877 ià(
¿‹
) {

2878 
¿‹
->
æags
 |ğ
RATE_INFO_FLAGS_MCS
;

2879 
¿‹
->
mcs
 = 
mcs_idx
;

2881 ià((
fw_¿‹
 & 
SLSI_FW_API_RATE_BW_FIELD
è=ğ
SLSI_FW_API_RATE_BW_40MHZ
)

2882 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 0, 0))

2883 
¿‹
->
bw
 |ğ
RATE_INFO_BW_40
;

2885 
¿‹
->
æags
 |ğ
RATE_INFO_FLAGS_40_MHZ_WIDTH
;

2887 ià(
fw_¿‹
 & 
SLSI_FW_API_RATE_SGI
)

2888 
¿‹
->
æags
 |ğ
RATE_INFO_FLAGS_SHORT_GI
;

2891 ià(
d©a_¿‹_mbps
) {

2892 
chª_bw_idx
;

2893 
gi_idx
;

2895 
chª_bw_idx
 = (
fw_¿‹
 & 
SLSI_FW_API_RATE_BW_FIELD
) >> 9;

2896 
gi_idx
 = ((
fw_¿‹
 & 
SLSI_FW_API_RATE_SGI
) == SLSI_FW_API_RATE_SGI) ? 1 : 0;

2899 ià(
chª_bw_idx
 < 2) {

2900 ià(
mcs_idx
 <= 7) {

2901 *
d©a_¿‹_mbps
 = ()
¦si_¿‹s_bË
[
chª_bw_idx
][
gi_idx
][
mcs_idx
] / 10;

2902 } ià(
mcs_idx
 <= 15) {

2903 *
d©a_¿‹_mbps
 = ()(
nss
 * 
¦si_¿‹s_bË
[
chª_bw_idx
][
gi_idx
][
mcs_idx
 - 8]) / 10;

2904 } ià(
mcs_idx
 =ğ32 && 
chª_bw_idx
 == 1) {

2906 ià(
gi_idx
 == 1)

2907 *
d©a_¿‹_mbps
 = () 6.7;

2909 *
d©a_¿‹_mbps
 = 6;

2912 
	`SLSI_WARN_NODEV
("FW DATA RATE decodeƒrror fw_rate:%x, bw:%x, mcs_idx:%x,‚ss : %d\n",

2913 
fw_¿‹
, 
chª_bw_idx
, 
mcs_idx
, 
nss
);

2916 } ià((
fw_¿‹
 & 
SLSI_FW_API_RATE_HT_SELECTOR_FIELD
è=ğ
SLSI_FW_API_RATE_VHT_SELECTED
) {

2917 
chª_bw_idx
;

2918 
gi_idx
;

2919 
mcs_idx
;

2920 
u8
 
nss
;

2925 
chª_bw_idx
 = (
fw_¿‹
 & 
SLSI_FW_API_RATE_BW_FIELD
) >> 9;

2926 
gi_idx
 = ((
fw_¿‹
 & 
SLSI_FW_API_RATE_SGI
) == SLSI_FW_API_RATE_SGI) ? 1 : 0;

2928 
nss
 = ((
SLSI_FW_API_RATE_VHT_NSS_FIELD
 & 
fw_¿‹
) >> 4) + 1;

2929 
mcs_idx
 = 
SLSI_FW_API_RATE_VHT_MCS_FIELD
 & 
fw_¿‹
;

2931 ià((
chª_bw_idx
 <ğ2è&& (
mcs_idx
 <= 11)) {

2932 ià(
¿‹
)

2933 
¿‹
->
Ëgacy
 = 
nss
 * 
¦si_¿‹s_bË
[
chª_bw_idx
][
gi_idx
][
mcs_idx
];

2934 ià(
d©a_¿‹_mbps
)

2935 *
d©a_¿‹_mbps
 = ()(
nss
 * 
¦si_¿‹s_bË
[
chª_bw_idx
][
gi_idx
][
mcs_idx
]) / 10;

2937 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "FW DATA RATE decodeƒrror fw_rate:%x, bw:%x, mcs_idx:%x,nss : %d\n\n",

2938 
fw_¿‹
, 
chª_bw_idx
, 
mcs_idx
, 
nss
);

2940 } ià((
fw_¿‹
 & 
SLSI_FW_API_RATE_HE_SELECTED
) == SLSI_FW_API_RATE_HE_SELECTED) {

2941 
chª_bw_idx
;

2942 
gi_idx
;

2943 
mcs_idx
;

2944 
u8
 
nss
;

2949 
chª_bw_idx
 = (
fw_¿‹
 & 
SLSI_FW_API_RATE_BW_FIELD
) >> 9;

2950 
gi_idx
 = 
	`SLSI_FW_API_GET_11AX_GI
(
fw_¿‹
);

2952 
nss
 = ((
SLSI_FW_API_RATE_VHT_NSS_FIELD
 & 
fw_¿‹
) >> 4) + 1;

2953 
mcs_idx
 = 
SLSI_FW_API_RATE_VHT_MCS_FIELD
 & 
fw_¿‹
;

2955 ià((
chª_bw_idx
 <ğ3è&& (
mcs_idx
 < 12)) {

2956 ià(
¿‹
)

2957 
¿‹
->
Ëgacy
 = 
nss
 * (
¦si_he_¿‹s_bË_2x2
[
chª_bw_idx
][
mcs_idx
][
gi_idx
] / 2) * 10;

2958 ià(
d©a_¿‹_mbps
)

2959 *
d©a_¿‹_mbps
 = ()
nss
 * (
¦si_he_¿‹s_bË_2x2
[
chª_bw_idx
][
mcs_idx
][
gi_idx
] / 2);

2961 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "FW DATA RATE decodeƒrror fw_rate:%x, bw:%x, mcs_idx:%x,nss : %d\n\n",

2962 
fw_¿‹
, 
chª_bw_idx
, 
mcs_idx
, 
nss
);

2965 
	}
}

2967 
	$¦si_mlme_g‘_sšfo_mib
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

2968 
¦si_³”
 *
³”
)

2970 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2971 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

2972 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

2973 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

2974 #ifdeà
CONFIG_SCSC_WLAN_MAX_LINK_SPEED


2975 
u8
 
bªdwidth
 = 0, 
ª‹Âa_mode
 = 4;

2977 
d©a_Ëngth
 = 0;

2978 
r
 = 0;

2979 
mib_šdex
 = 0;

2980 cÚ¡ 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = {

2981 { 
SLSI_PSID_UNIFI_TX_DATA_RATE
, { 0, 0 } },

2982 { 
SLSI_PSID_UNIFI_RX_DATA_RATE
, { 0, 0 } },

2983 { 
SLSI_PSID_UNIFI_RSSI
, { 0, 0 } },

2984 { 
SLSI_PSID_UNIFI_THROUGHPUT_DEBUG
, { 3, 0 } },

2985 { 
SLSI_PSID_UNIFI_THROUGHPUT_DEBUG
, { 25, 0 } },

2986 { 
SLSI_PSID_UNIFI_THROUGHPUT_DEBUG
, { 30, 0 } },

2987 { 
SLSI_PSID_UNIFI_FRAME_TX_COUNTERS
, { 1, 0 } },

2988 { 
SLSI_PSID_UNIFI_FRAME_TX_COUNTERS
, { 2, 0 } },

2989 { 
SLSI_PSID_UNIFI_FRAME_RX_COUNTERS
, { 1, 0 } },

2990 #ifdeà
CONFIG_SCSC_ENHANCED_PACKET_STATS


2991 { 
SLSI_PSID_UNIFI_FRAME_TX_COUNTERS
, { 3, 0 } },

2992 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 2, 0))

2993 { 
SLSI_PSID_UNIFI_FRAME_TX_COUNTERS
, { 4, 0 } },

2996 #ifdeà
CONFIG_SCSC_WLAN_MAX_LINK_SPEED


2997 { 
SLSI_PSID_UNIFI_CURRENT_BSS_BANDWIDTH
, { 0, 0 } },

2998 { 
SLSI_PSID_UNIFI_STA_VIF_LINK_NSS
, { 0, 0 } }

3001 
rx_couÁ”
 = 0;

3003 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3005 ià(!
³”
) {

3006 
	`SLSI_WARN
(
sdev
, "Peer Not‡vailable\n");

3007  -
EINVAL
;

3011 ià(
	`__¿‹lim™
(&
³”
->
sšfo_mib_g‘_rs
))

3014 
r
 = 
	`¦si_mib_’code_g‘_li¡
(&
mib»q
, ((
g‘_v®ues
è/ (
¦si_mib_g‘_’Œy
)),

3015 
g‘_v®ues
);

3016 ià(
r
 !ğ
SLSI_MIB_STATUS_SUCCESS
)

3017  -
ENOMEM
;

3023 
mibr¥
.
d©aL’gth
 = 114;

3024 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

3026 ià(!
mibr¥
.
d©a
) {

3027 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "failedo‡llocate memory\n");

3028 
	`kä“
(
mib»q
.
d©a
);

3029  -
ENOMEM
;

3032 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
dev
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
.data,

3033 
mibr¥
.
d©aL’gth
, &
d©a_Ëngth
);

3034 
	`kä“
(
mib»q
.
d©a
);

3036 ià(
r
 == 0) {

3037 
mibr¥
.
d©aL’gth
 = (
u32
)
d©a_Ëngth
;

3038 
v®ues
 = 
	`¦si_mib_decode_g‘_li¡
(&
mibr¥
,

3039 ((
g‘_v®ues
è/ (
¦si_mib_g‘_’Œy
)), get_values);

3040 ià(!
v®ues
) {

3041 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mib decode†ist failed\n");

3042 
	`kä“
(
mibr¥
.
d©a
);

3043  -
ENOMEM
;

3046 ià(
v®ues
[
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3047 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_UINT
);

3048 
	`¦si_decode_fw_¿‹
((
u32
)
v®ues
[
mib_šdex
].
u
.
uštV®ue
, &
³”
->
sšfo
.
tx¿‹
, &
ndev_vif
->
¡a
.
d©a_¿‹_mbps
);

3049 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 0, 0))

3050 
³”
->
sšfo
.
fËd
 |ğ
	`BIT
(
NL80211_STA_INFO_TX_BITRATE
);

3052 
³”
->
sšfo
.
fËd
 |ğ
STATION_INFO_TX_BITRATE
;

3054 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "SLSI_PSID_UNIFI_TX_DATA_RATE = 0x%x\n",

3055 
v®ues
[
mib_šdex
].
u
.
uštV®ue
);

3057 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3059 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3060 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_UINT
);

3061 
	`¦si_decode_fw_¿‹
((
u32
)
v®ues
[
mib_šdex
].
u
.
uštV®ue
, &
³”
->
sšfo
.
rx¿‹
, 
NULL
);

3062 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 0, 0))

3063 
³”
->
sšfo
.
fËd
 |ğ
	`BIT
(
NL80211_STA_INFO_RX_BITRATE
);

3065 
³”
->
sšfo
.
fËd
 |ğ
STATION_INFO_RX_BITRATE
;

3067 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "SLSI_PSID_UNIFI_RX_DATA_RATE = 0x%x\n",

3068 
v®ues
[
mib_šdex
].
u
.
uštV®ue
);

3070 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3072 ià(
v®ues
[++
mib_šdex
].
ty³
 !ğ
SLSI_MIB_TYPE_NONE
) {

3073 
	`SLSI_CHECK_TYPE
(
sdev
, 
v®ues
[
mib_šdex
].
ty³
, 
SLSI_MIB_TYPE_INT
);

3074 ià(
v®ues
[
mib_šdex
].
u
.
štV®ue
 >= 0)

3075 
³”
->
sšfo
.
sigÇl
 = -1;

3077 
³”
->
sšfo
.
sigÇl
 = (
s8
)
v®ues
[
mib_šdex
].
u
.
štV®ue
;

3078 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 0, 0))

3079 
³”
->
sšfo
.
fËd
 |ğ
	`BIT
(
NL80211_STA_INFO_SIGNAL
);

3081 
³”
->
sšfo
.
fËd
 |ğ
STATION_INFO_SIGNAL
;

3083 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "SLSI_PSID_UNIFI_RSSI = %d\n",

3084 
v®ues
[
mib_šdex
].
u
.
štV®ue
);

3086 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3087 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

3088 
rx_couÁ”
 +ğ
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

3090 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3091 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

3092 
rx_couÁ”
 +ğ
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

3094 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3095 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

3096 
rx_couÁ”
 +ğ
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

3098 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3099 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

3100 
³”
->
sšfo
.
tx_·ck‘s
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

3102 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3103 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

3104 
³”
->
sšfo
.
tx_çed
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

3106 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3107 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

3108 
³”
->
sšfo
.
rx_·ck‘s
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

3110 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3111 #ifdeà
CONFIG_SCSC_ENHANCED_PACKET_STATS


3112 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

3113 
³”
->
sšfo
.
tx_»Œ›s
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

3115 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3116 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 2, 0))

3117 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

3118 
³”
->
sšfo
.
aœtime_lšk_m‘ric
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

3120 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3123 #ifdeà
CONFIG_SCSC_WLAN_MAX_LINK_SPEED


3124 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

3125 
bªdwidth
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

3127 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3128 ià(
v®ues
[++
mib_šdex
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
) {

3129 
ª‹Âa_mode
 = 
v®ues
[
mib_šdex
].
u
.
uštV®ue
;

3130 
	`¦si_ÿlc_max_d©a_¿‹
(
dev
, 
bªdwidth
, 
ª‹Âa_mode
);

3132 
	`SLSI_ERR
(
sdev
, "Inv®idy³: PSID = 0x%x\n", 
g‘_v®ues
[
mib_šdex
].
psid
);

3136 
³”
->
sšfo
.
rx_drİ³d_misc
 = 
rx_couÁ”
;

3138 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 0, 0))

3139 
³”
->
sšfo
.
fËd
 |ğ
	`BIT
(
NL80211_STA_INFO_TX_FAILED
è| BIT(
NL80211_STA_INFO_RX_DROP_MISC
) |

3140 
	`BIT
(
NL80211_STA_INFO_TX_PACKETS
è| BIT(
NL80211_STA_INFO_RX_PACKETS
);

3141 #ifdeà
CONFIG_SCSC_ENHANCED_PACKET_STATS


3142 
³”
->
sšfo
.
fËd
 |ğ
	`BIT
(
NL80211_STA_INFO_TX_RETRIES
);

3143 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 2, 0))

3144 
³”
->
sšfo
.
fËd
 |ğ
	`BIT
(
NL80211_STA_INFO_AIRTIME_LINK_METRIC
);

3149 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_g‘_»q faedÔesuÉ:0x%4x)\n", 
r
);

3152 
	`kä“
(
mibr¥
.
d©a
);

3153 
	`kä“
(
v®ues
);

3154  
r
;

3155 
	}
}

3157 
	$¦si_mlme_cÚÃù_sÿn
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

3158 
u32
 
n_ssids
, 
cfg80211_ssid
 *
ssids
, 
›“80211_chªÃl
 *
chªÃl
)

3160 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3161 
r
 = 0;

3162 
›“80211_chªÃl
 **
sÿn_chªÃls
 = 
NULL
;

3163 
›“80211_chªÃl
 **
add_sÿn_chªÃls
;

3164 
n_chªÃls
 = 0;

3165 
sk_buff
 *
sÿn
;

3166 
cfg80211_sÿn_šfo
 
šfo
 = {.
abÜ‹d
 = 
Œue
};

3168 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

3170 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
) {

3171 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "stop on-going Scan\n");

3172 ()
	`¦si_mlme_d–_sÿn
(
sdev
, 
dev
, 
ndev_vif
->
iâum
 << 8 | 
SLSI_SCAN_HW_ID
, 
çl£
);

3173 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 9, 0))

3174 
	`cfg80211_sÿn_dÚe
(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
, &
šfo
);

3176 
	`cfg80211_sÿn_dÚe
(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
, 
Œue
);

3179 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
sÿn_»q
 = 
NULL
;

3182 ià(!
chªÃl
) {

3183 
Æ80211_bªd
 
bªd
;

3184 
why
 *why = 
sdev
->wiphy;

3185 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 9, 0))

3186 
bªd
 = 0; bªd < 
NUM_NL80211_BANDS
; band++) {

3188 
bªd
 = 0; bªd < 
IEEE80211_NUM_BANDS
; band++) {

3190 ià(!
why
->
bªds
[
bªd
])

3192 
n_chªÃls
 +ğ
why
->
bªds
[
bªd
]->n_channels;

3195 
	`WARN_ON
(
n_chªÃls
 == 0);

3196 
sÿn_chªÃls
 = 
	`km®loc_¬¿y
((
size_t
)
n_chªÃls
, (*sÿn_chªÃls), 
GFP_KERNEL
);

3197 ià(!
sÿn_chªÃls
) {

3198 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

3199  -
ENOMEM
;

3201 
n_chªÃls
 = 0;

3202 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 9, 0))

3203 
bªd
 = 0; bªd < 
NUM_NL80211_BANDS
; band++) {

3205 
bªd
 = 0; bªd < 
IEEE80211_NUM_BANDS
; band++) {

3207 
j
;

3209 ià(!
why
->
bªds
[
bªd
])

3211 
j
 = 0; j < 
why
->
bªds
[
bªd
]->
n_chªÃls
; j++)

3212 ià(!(
why
->
bªds
[
bªd
]->
chªÃls
[
j
].
æags
 & 
IEEE80211_CHAN_DISABLED
)) {

3213 
sÿn_chªÃls
[
n_chªÃls
] = &
why
->
bªds
[
bªd
]->
chªÃls
[
j
];

3214 
n_chªÃls
++;

3217 
add_sÿn_chªÃls
 = 
sÿn_chªÃls
;

3219 
n_chªÃls
 = 1;

3220 
add_sÿn_chªÃls
 = &
chªÃl
;

3222 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
 = 
Œue
;

3223 
r
 = 
	`¦si_mlme_add_sÿn
(
sdev
,

3224 
dev
,

3225 
FAPI_SCANTYPE_FULL_SCAN
,

3226 
FAPI_REPORTMODE_REAL_TIME
,

3227 
n_ssids
,

3228 
ssids
,

3229 
n_chªÃls
,

3230 
add_sÿn_chªÃls
,

3231 
NULL
,

3232 
ndev_vif
->
´obe_»q_›s
,

3233 
ndev_vif
->
´obe_»q_›_Ën
,

3234 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
);

3236 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

3237 
sÿn
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->sÿn[
SLSI_SCAN_HW_ID
], 
NULL
);

3238 
sÿn
) {

3239 
	`¦si_rx_sÿn_·ss_to_cfg80211
(
sdev
, 
dev
, 
sÿn
);

3240 
sÿn
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->sÿn[
SLSI_SCAN_HW_ID
], 
NULL
);

3242 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

3244 
	`kä“
(
sÿn_chªÃls
);

3245 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
 = 
çl£
;

3247 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

3248  
r
;

3249 
	}
}

3254 
DEFINE_MUTEX
(
pow”mgt_lock
);

3260 
	$¦si_mlme_pow”mgt_uÆocked
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
pow”_mode
)

3262 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3263 
sk_buff
 *
»q
;

3264 
sk_buff
 *
rx
;

3265 
r
 = 0;

3267 
	`mu‹x_lock
(&
pow”mgt_lock
);

3269 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
)) {

3270 
	`mu‹x_uÆock
(&
pow”mgt_lock
);

3271  -
EINVAL
;

3274 ià(
ndev_vif
->
pow”_mode
 ==…ower_mode) {

3275 
	`mu‹x_uÆock
(&
pow”mgt_lock
);

3276 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "power management mode is same‡s„equested. No changes done\n");

3280 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_pow”mgt_»q(vif:%d,…ow”_mªagem’t_mode:%d)\n", 
ndev_vif
->
iâum
, 
pow”_mode
);

3281 
»q
 = 
	`çpi_®loc
(
mlme_pow”mgt_»q
, 
MLME_POWERMGT_REQ
, 
ndev_vif
->
iâum
, 0);

3282 ià(!
»q
) {

3283 
	`mu‹x_uÆock
(&
pow”mgt_lock
);

3284  -
ENOMEM
;

3286 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_pow”mgt_»q
.
pow”_mªagem’t_mode
, 
pow”_mode
);

3288 
rx
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_POWERMGT_CFM
);

3289 ià(!
rx
) {

3290 
	`mu‹x_uÆock
(&
pow”mgt_lock
);

3291  -
EIO
;

3294 ià(
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_pow”mgt_cfm
.
»suÉ_code
è=ğ
FAPI_RESULTCODE_SUCCESS
) {

3295 
ndev_vif
->
pow”_mode
 =…ower_mode;

3297 
	`SLSI_NET_ERR
(
dev
, "mlme_powermgt_cfm(result:0x%04x) ERROR\n",

3298 
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_pow”mgt_cfm
.
»suÉ_code
));

3299 
r
 = -
EINVAL
;

3302 
	`kä“_skb
(
rx
);

3303 
	`mu‹x_uÆock
(&
pow”mgt_lock
);

3304  
r
;

3305 
	}
}

3307 
	$¦si_mlme_pow”mgt
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
pow”_mode
)

3309 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3311 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3313  
	`¦si_mlme_pow”mgt_uÆocked
(
sdev
, 
dev
, 
pow”_mode
);

3314 
	}
}

3316 #ifdeà
CONFIG_SCSC_WLAN_NUM_ANTENNAS


3317 
	$¦si_mlme_g‘_num_ª‹Âas
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, *
num_ª‹Âas
)

3319 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3320 
sk_buff
 *
»q
;

3321 
sk_buff
 *
cfm
;

3322 
»t
 = 0;

3323 cÚ¡ 
boŞ
 
is_¡a
 = (
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
);

3324 cÚ¡ 
boŞ
 
is_soá­
 = (
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_AP
);

3326 ià(!
is_¡a
 && !
is_soá­
) {

3327 
	`SLSI_NET_ERR
(
dev
, "Inv®id iÁ”çûy³ %s\n", dev->
Çme
);

3328  -
EPERM
;

3330 ià(
is_¡a
 && (
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
)) {

3331 
	`SLSI_NET_ERR
(
dev
, "sta is‚ot in connected state\n");

3332  -
EPERM
;

3334 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "mlme_g‘_num_ª‹Âas_»q(vif:%u)\n", 
ndev_vif
->
iâum
);

3336 
»q
 = 
	`çpi_®loc
(
mlme_g‘_num_ª‹Âas_»q
, 
MLME_GET_NUM_ANTENNAS_REQ
, 
ndev_vif
->
iâum
, 0);

3337 ià(!
»q
)

3338  -
EIO
;

3340 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_GET_NUM_ANTENNAS_CFM
);

3341 ià(!
cfm
)

3342  -
EIO
;

3344 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_g‘_num_ª‹Âas_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

3345 
	`SLSI_NET_ERR
(
dev
, "mlme_get_num_antennas_cfm(result:0x%04x) ERROR\n",

3346 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_g‘_num_ª‹Âas_cfm
.
»suÉ_code
));

3347 
»t
 = -
EINVAL
;

3349 *
num_ª‹Âas
 = 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_g‘_num_ª‹Âas_cfm
.
numb”_of_ª‹Âas
);

3351 
	`kä“_skb
(
cfm
);

3352  
»t
;

3353 
	}
}

3356 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


3357 
	$¦si_mlme_synchrÚi£d_»¥Ú£
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

3358 
cfg80211_ex‹º®_auth_·¿ms
 *
·¿ms
)

3360 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3361 
sk_buff
 *
»q
;

3362 
sk_buff
 *
cfm
;

3363 ià(
ndev_vif
->
aùiv©ed
) {

3364 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "MLME_SYNCHRONISED_RES\n");

3366 
»q
 = 
	`çpi_®loc
(
mlme_synchrÚi£d_»s
, 
MLME_SYNCHRONISED_RES
, 
ndev_vif
->
iâum
, 0);

3367 ià(!
»q
)

3368  -
ENOMEM
;

3370 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_synchrÚi£d_»s
.
»suÉ_code
, 
·¿ms
->
¡©us
);

3371 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_synchrÚi£d_»s
.
bssid
, 
·¿ms
->bssid);

3373 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_synchronised_response(vif:%d) status:%d\n",

3374 
ndev_vif
->
iâum
, 
·¿ms
->
¡©us
);

3375 
cfm
 = 
	`¦si_mlme_»q_no_cfm
(
sdev
, 
dev
, 
»q
);

3376 ià(
cfm
)

3377 
	`SLSI_NET_ERR
(
dev
, "Received cfm for MLME_SYNCHRONISED_RES\n");

3379 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "vif is‚ot‡ctive");

3380 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

3381 
ndev_vif
->
¡a
.
w·3_auth_¡©e
 = 
SLSI_WPA3_AUTHENTICATED
;

3385 
	}
}

3388 
	$¦si_mlme_»gi¡”_aùiÚ_äame
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
af_b™m­_aùive
, u32 
af_b™m­_su¥’ded
)

3390 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3391 
sk_buff
 *
»q
;

3392 
sk_buff
 *
cfm
;

3393 
r
 = 0;

3395 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3397 
»q
 = 
	`çpi_®loc
(
mlme_»gi¡”_aùiÚ_äame_»q
, 
MLME_REGISTER_ACTION_FRAME_REQ
, 
ndev_vif
->
iâum
, 0);

3398 ià(!
»q
)

3399  -
ENOMEM
;

3401 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_»gi¡”_aùiÚ_äame_»q
.
aùiÚ_äame_ÿ‹gÜy_b™m­_aùive
, 
af_b™m­_aùive
);

3402 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_»gi¡”_aùiÚ_äame_»q
.
aùiÚ_äame_ÿ‹gÜy_b™m­_su¥’ded
, 
af_b™m­_su¥’ded
);

3404 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_»gi¡”_aùiÚ_äame(vif:%d,‡ùive:%d, su¥’ded:%d)\n", 
ndev_vif
->
iâum
, 
af_b™m­_aùive
, 
af_b™m­_su¥’ded
);

3405 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_REGISTER_ACTION_FRAME_CFM
);

3406 ià(!
cfm
)

3407  -
EIO
;

3409 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_»gi¡”_aùiÚ_äame_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

3410 
	`SLSI_NET_ERR
(
dev
, "mlme_register_action_frame_cfm(result:0x%04x) ERROR\n",

3411 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_»gi¡”_aùiÚ_äame_cfm
.
»suÉ_code
));

3412 
r
 = -
EINVAL
;

3415 
	`kä“_skb
(
cfm
);

3416  
r
;

3417 
	}
}

3419 
	$¦si_mlme_chªÃl_sw™ch
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
ûÁ”_äeq
, u16 
chª_šfo
)

3421 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3422 
sk_buff
 *
»q
;

3423 
sk_buff
 *
cfm
;

3424 
r
 = 0;

3426 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3428 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_chªÃl_sw™ch_»q(vif:%d, f»q: %d, chªÃÈšfo: 0x%x)\n", 
ndev_vif
->
iâum
, 
ûÁ”_äeq
, 
chª_šfo
);

3429 
»q
 = 
	`çpi_®loc
(
mlme_chªÃl_sw™ch_»q
, 
MLME_CHANNEL_SWITCH_REQ
, 
ndev_vif
->
iâum
, 0);

3430 ià(!
»q
)

3431  -
ENOMEM
;

3433 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_chªÃl_sw™ch_»q
.
chªÃl_äequ’cy
, 
	`SLSI_FREQ_HOST_TO_FW
(
ûÁ”_äeq
));

3434 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_chªÃl_sw™ch_»q
.
chªÃl_šfÜm©iÚ
, 
chª_šfo
);

3436 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_CHANNEL_SWITCH_CFM
);

3437 ià(!
cfm
)

3438  -
EIO
;

3440 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_chªÃl_sw™ch_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

3441 
	`SLSI_NET_ERR
(
dev
, "mlme_channel_switch_cfm(result:0x%04x) ERROR\n",

3442 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_chªÃl_sw™ch_cfm
.
»suÉ_code
));

3443 
r
 = -
EINVAL
;

3446 
	`kä“_skb
(
cfm
);

3447  
r
;

3448 
	}
}

3450 
	$¦si_mlme_add_šfo_–em’ts
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
pu½o£
, cÚ¡ 
u8
 *
›s
, cÚ¡ u16 
›s_Ën
)

3452 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3453 
sk_buff
 *
»q
;

3454 
sk_buff
 *
cfm
;

3455 
r
 = 0;

3456 
u8
 *
p
;

3458 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3460 
»q
 = 
	`çpi_®loc
(
mlme_add_šfo_–em’ts_»q
, 
MLME_ADD_INFO_ELEMENTS_REQ
, 
ndev_vif
->
iâum
, 
›s_Ën
);

3461 ià(!
»q
)

3462  -
ENOMEM
;

3464 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_add_šfo_–em’ts_»q
.
pu½o£
,…urpose);

3466 ià(
›s_Ën
 != 0) {

3467 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
›s
, 
›s_Ën
);

3468 ià(!
p
) {

3469 
	`kä“_skb
(
»q
);

3470  -
EINVAL
;

3474 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_add_šfo_–em’ts_»q(vif:%d, ies_Ën:%d)\n", 
ndev_vif
->
iâum
, 
›s_Ën
);

3475 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_ADD_INFO_ELEMENTS_CFM
);

3476 ià(!
cfm
)

3477  -
EIO
;

3479 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_add_šfo_–em’ts_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

3480 
	`SLSI_NET_ERR
(
dev
, "mlme_add_info_elements_cfm(result:0x%04x) ERROR\n",

3481 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_add_šfo_–em’ts_cfm
.
»suÉ_code
));

3482 
r
 = -
EINVAL
;

3485 
	`kä“_skb
(
cfm
);

3486  
r
;

3487 
	}
}

3489 
	$¦si_mlme_£nd_äame_d©a
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
u16
 
msg_ty³
,

3490 
u16
 
ho¡_g
, 
u32
 
dw–l_time
, u32 
³riod
)

3492 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3493 
u16
 
Ën
 = 
skb
->len;

3494 
sk_buff
 *
Üigš®_skb
 = 0;

3495 
»t
;

3496 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


3497 
is_’hªûd_¬p_»que¡_äame
 = 0;

3501 ià(
msg_ty³
 =ğ
FAPI_MESSAGETYPE_ARP
) {

3502 
ä“_¦Ùs
 = 0;

3504 
ä“_¦Ùs
 = 
	`h4_ä“_ù¾_¦Ùs_couÁ
(&
sdev
->
h4_š¡
);

3506 ià(
ä“_¦Ùs
 < 0) {

3507 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
,

3509  
ä“_¦Ùs
;

3512 ià(
ä“_¦Ùs
 < 
SLSI_MLME_ARP_DROP_FREE_SLOTS_COUNT
) {

3513 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
,

3514 "drİ ARP (NØARP CÚŒŞ slÙs:%d)\n", 
ä“_¦Ùs
);

3515 
	`kä“_skb
(
skb
);

3516  
NETDEV_TX_OK
;

3519 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


3520 ià(
ndev_vif
->
’hªûd_¬p_d‘eù_’abËd
 && (
msg_ty³
 =ğ
FAPI_MESSAGETYPE_ARP
)) {

3521 
u8
 *
äame
 = 
skb
->
d©a
 + (
‘hhdr
);

3522 
u16
 
¬p_İcode
 = 
äame
[
SLSI_ARP_OPCODE_OFFSET
] << 8 | frame[SLSI_ARP_OPCODE_OFFSET + 1];

3524 ià((
¬p_İcode
 =ğ
SLSI_ARP_REQUEST_OPCODE
) &&

3525 !
	`SLSI_IS_GRATUITOUS_ARP
(
äame
) &&

3526 !
	`memcmp
(&
äame
[
SLSI_ARP_DEST_IP_ADDR_OFFSET
], &
ndev_vif
->
rg‘__addr
, 4))

3527 
is_’hªûd_¬p_»que¡_äame
 = 1;

3533 ià(
	`skb_h—droom
(
skb
è< (
	`çpi_sig_size
(
mlme_£nd_äame_»q
))) {

3534 
sk_buff
 *
skb2
 = 
NULL
;

3536 
skb2
 = 
	`skb_»®loc_h—droom
(
skb
, 
	`çpi_sig_size
(
mlme_£nd_äame_»q
));

3537 ià(!
skb2
)

3538  -
EINVAL
;

3539 
Üigš®_skb
 = 
skb
;

3540 
skb
 = 
skb2
;

3542 
Ën
 = 
skb
->len;

3543 ()
	`skb_push
(
skb
, (
	`çpi_sig_size
(
mlme_£nd_äame_»q
)));

3546 
	`çpi_£t_u16
(
skb
, 
id
, 
MLME_SEND_FRAME_REQ
);

3547 
	`çpi_£t_u16
(
skb
, 
»ûiv”_pid
, 0);

3548 
	`çpi_£t_u16
(
skb
, 
£nd”_pid
, 
SLSI_TX_PROCESS_ID_MIN
);

3549 
	`çpi_£t_u16
(
skb
, 
fw_»ã»nû
, 0);

3552 
	`çpi_£t_u16
(
skb
, 
u
.
mlme_£nd_äame_»q
.
vif
, 
ndev_vif
->
iâum
);

3554 ià(
ho¡_g
 == 0)

3555 
ho¡_g
 = 
	`¦si_tx_mgmt_ho¡_g
(
sdev
);

3556 #ifdeà
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL


3557 ià(
msg_ty³
 =ğ
FAPI_MESSAGETYPE_ARP
 && 
sdev
->
fw_max_¬p_couÁ
)

3558 
ho¡_g
 |ğ
SLSI_HOST_TAG_ARP_MASK
;

3560 
	`çpi_£t_u16
(
skb
, 
u
.
mlme_£nd_äame_»q
.
ho¡_g
, host_tag);

3561 
	`çpi_£t_u16
(
skb
, 
u
.
mlme_£nd_äame_»q
.
d©a_un™_desütÜ
, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_3_FRAME
);

3562 
	`çpi_£t_u16
(
skb
, 
u
.
mlme_£nd_äame_»q
.
mes§ge_ty³
, 
msg_ty³
);

3563 
	`çpi_£t_u16
(
skb
, 
u
.
mlme_£nd_äame_»q
.
chªÃl_äequ’cy
, 0);

3564 
	`çpi_£t_u32
(
skb
, 
u
.
mlme_£nd_äame_»q
.
dw–l_time
, dwell_time);

3565 
	`çpi_£t_u32
(
skb
, 
u
.
mlme_£nd_äame_»q
.
³riod
,…eriod);

3567 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "vif:%d, mes§ge_ty³:%d, ho¡_g:0x%x\n", 
ndev_vif
->
iâum
, 
msg_ty³
, 
ho¡_g
);

3569 
»t
 = 
	`¦si_tx_cÚŒŞ
(
sdev
, 
dev
, 
skb
);

3570 ià(
»t
 != 0) {

3571 
	`SLSI_WARN
(
sdev
, "çedØ£nd MLME sigÇlÓ¼=%d)\n", 
»t
);

3572  
»t
;

3574 #ifdeà
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL


3575 ià(
ho¡_g
 & 
SLSI_HOST_TAG_ARP_MASK
) {

3576 
	`©omic_šc
(&
sdev
->
¬p_tx_couÁ
);

3577 
	`©omic_šc
(&
ndev_vif
->
¬p_tx_couÁ
);

3579 ià(
	`©omic_»ad
(&
sdev
->
¬p_tx_couÁ
è=ğsdev->
fw_max_¬p_couÁ
)

3580 
	`scsc_wifi_·u£_¬p_q_®l_vif
(
sdev
);

3583 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


3584 ià(
is_’hªûd_¬p_»que¡_äame
) {

3585 
i
;

3587 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_»q_couÁ_to_low”_mac
++;

3588 
i
 = 0; i < 
SLSI_MAX_ARP_SEND_FRAME
; i++) {

3589 ià(!
ndev_vif
->
’hªûd_¬p_ho¡_g
[
i
]) {

3590 
ndev_vif
->
’hªûd_¬p_ho¡_g
[
i
] = 
ho¡_g
;

3597 ià(
Üigš®_skb
)

3598 
	`cÚsume_skb
(
Üigš®_skb
);

3604 ià(
msg_ty³
 =ğ
FAPI_MESSAGETYPE_EAPOL_KEY_M4
) {

3605 
ndev_vif
->
¡a
.
m4_ho¡_g
 = 
ho¡_g
;

3606 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "EAPOL-Key M4 f¿m(ho¡_g:%d)\n", 
ndev_vif
->
¡a
.
m4_ho¡_g
);

3607 } ià(
msg_ty³
 =ğ
FAPI_MESSAGETYPE_EAP_MESSAGE
) {

3608 ià(!
ndev_vif
->
¡a
.
is_wps
 && (ndev_vif->
iáy³
 =ğ
NL80211_IFTYPE_STATION
)) {

3612 
ndev_vif
->
¡a
.
—p_ho¡g
 = 
ho¡_g
;

3613 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "EAP f¿m(ho¡_g:%d)\n", 
ndev_vif
->
¡a
.
—p_ho¡g
);

3616  
»t
;

3617 
	}
}

3619 
	$¦si_mlme_£nd_äame_mgmt
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
äame
, 
äame_Ën
,

3620 
u16
 
d©a_desc
, u16 
msg_ty³
, u16 
ho¡_g
, u16 
äeq
, 
u32
 
dw–l_time
, u32 
³riod
)

3622 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3623 
sk_buff
 *
»q
;

3624 
sk_buff
 *
cfm
;

3625 
r
 = 0;

3626 
u8
 *
p
;

3628 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3630 
»q
 = 
	`çpi_®loc
(
mlme_£nd_äame_»q
, 
MLME_SEND_FRAME_REQ
, 
ndev_vif
->
iâum
, 
äame_Ën
);

3631 ià(!
»q
) {

3632 
	`SLSI_WARN
(
sdev
, "failedo‡lloc memory\n");

3633  -
ENOMEM
;

3636 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£nd_äame_»q
.
ho¡_g
, host_tag);

3637 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£nd_äame_»q
.
d©a_un™_desütÜ
, 
d©a_desc
);

3638 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£nd_äame_»q
.
mes§ge_ty³
, 
msg_ty³
);

3639 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£nd_äame_»q
.
chªÃl_äequ’cy
, 
äeq
);

3640 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_£nd_äame_»q
.
dw–l_time
, dwell_time);

3641 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_£nd_äame_»q
.
³riod
,…eriod);

3643 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
äame
, 
äame_Ën
);

3644 ià(!
p
) {

3645 
	`kä“_skb
(
»q
);

3646 
	`SLSI_WARN
(
sdev
, "failedo‡ppend data\n");

3647  -
EINVAL
;

3650 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_£nd_äame_»q(vif:%d, mes§ge_ty³:%d,ho¡_g:%d)\n", 
ndev_vif
->
iâum
, 
msg_ty³
, 
ho¡_g
);

3651 
	`¦si_debug_äame
(
sdev
, 
dev
, 
»q
, "TX");

3652 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SEND_FRAME_CFM
);

3653 ià(!
cfm
)

3654  -
EIO
;

3656 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£nd_äame_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

3657 
	`SLSI_NET_ERR
(
dev
, "mlme_send_frame_cfm(result:0x%04x) ERROR\n",

3658 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£nd_äame_cfm
.
»suÉ_code
));

3659 
r
 = -
EINVAL
;

3662 
	`kä“_skb
(
cfm
);

3663  
r
;

3664 
	}
}

3666 
	$¦si_mlme_wifish¬šg_³rm™‹d_chªÃls
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
³rm™‹d_chªÃls
)

3668 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3669 
sk_buff
 *
»q
;

3670 
sk_buff
 *
cfm
;

3671 
r
 = 0;

3673 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3675 
»q
 = 
	`çpi_®loc
(
mlme_wifish¬šg_³rm™‹d_chªÃls_»q
, 
MLME_WIFISHARING_PERMITTED_CHANNELS_REQ
,

3676 
ndev_vif
->
iâum
, 8);

3677 ià(!
»q
) {

3678 
r
 = -
ENOMEM
;

3679 
ex™
;

3682 
	`çpi_­³nd_d©a
(
»q
, 
³rm™‹d_chªÃls
, 8);

3684 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "(vif:%u)\n", 
ndev_vif
->
iâum
);

3685 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_WIFISHARING_PERMITTED_CHANNELS_CFM
);

3686 ià(!
cfm
) {

3687 
r
 = -
EIO
;

3688 
ex™
;

3691 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_wifish¬šg_³rm™‹d_chªÃls_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

3692 
	`SLSI_NET_ERR
(
dev
, "mlme_wifisharing_permitted_channels_cfm(result:0x%04x) ERROR\n",

3693 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_wifish¬šg_³rm™‹d_chªÃls_cfm
.
»suÉ_code
));

3694 
r
 = -
EINVAL
;

3697 
ex™
:

3698 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3699  
r
;

3701 
	}
}

3703 
	$¦si_mlme_»£t_dw–l_time
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

3705 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3706 
sk_buff
 *
»q
;

3707 
sk_buff
 *
cfm
;

3708 
r
 = 0;

3710 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3711 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

3712  -
EINVAL
;

3714 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_»£t_dw–l_time_»q (vif:%d)\n", 
ndev_vif
->
iâum
);

3716 
»q
 = 
	`çpi_®loc
(
mlme_»£t_dw–l_time_»q
, 
MLME_RESET_DWELL_TIME_REQ
, 
ndev_vif
->
iâum
, 0);

3718 ià(!
»q
)

3719  -
ENOMEM
;

3721 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_RESET_DWELL_TIME_CFM
);

3722 ià(!
cfm
)

3723  -
EIO
;

3725 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_»£t_dw–l_time_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

3726 
	`SLSI_NET_ERR
(
dev
, "mlme_reset_dwell_time_cfm(result:0x%04x) ERROR\n",

3727 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_»£t_dw–l_time_cfm
.
»suÉ_code
));

3728 
r
 = -
EINVAL
;

3731 
	`kä“_skb
(
cfm
);

3732  
r
;

3733 
	}
}

3735 
	$¦si_mlme_£t_·ck‘_f‹r
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

3736 
pkt_f‹r_Ën
,

3737 
u8
 
num_f‹rs
,

3738 
¦si_mlme_pkt_f‹r_–em
 *
pkt_f‹r_–ems
)

3740 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3741 
sk_buff
 *
»q
;

3742 
sk_buff
 *
cfm
;

3743 
r
 = 0, 
i
 = 0, 
j
 = 0;

3744 
u8
 *
p
;

3745 
šdex
 = 0;

3747 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

3748  -
EINVAL
;

3750 ià(
	`WARN_ON
(!
num_f‹rs
))

3751  -
EINVAL
;

3753 
»q
 = 
	`çpi_®loc
(
mlme_£t_·ck‘_f‹r_»q
, 
MLME_SET_PACKET_FILTER_REQ
, 
ndev_vif
->
iâum
, 
pkt_f‹r_Ën
);

3754 ià(!
»q
)

3755  -
ENOMEM
;

3757 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 
pkt_f‹r_Ën
);

3758 ià(!
p
) {

3759 
	`kä“_skb
(
»q
);

3760  -
EINVAL
;

3763 
i
 = 0; i < 
num_f‹rs
; i++) {

3764 
¦si_mlme_pkt_f‹r_–em
 
pkt_f‹r_–em
 = 
pkt_f‹r_–ems
[
i
];

3766 
	`memıy
(&
p
[
šdex
], 
pkt_f‹r_–em
.
h—d”
, 
SLSI_PKT_FILTER_ELEM_HDR_LEN
);

3767 
šdex
 +ğ
SLSI_PKT_FILTER_ELEM_HDR_LEN
;

3769 
j
 = 0; j < 
pkt_f‹r_–em
.
num_·‰”n_desc
; j++) {

3770 
p
[
šdex
++] = 
pkt_f‹r_–em
.
·‰”n_desc
[
j
].
off£t
;

3771 
p
[
šdex
++] = 
pkt_f‹r_–em
.
·‰”n_desc
[
j
].
mask_Ëngth
;

3772 
	`memıy
(&
p
[
šdex
], 
pkt_f‹r_–em
.
·‰”n_desc
[
j
].
mask
,…kt_f‹r_–em.·‰”n_desc[j].
mask_Ëngth
);

3773 
šdex
 +ğ
pkt_f‹r_–em
.
·‰”n_desc
[
j
].
mask_Ëngth
;

3774 
	`memıy
(&
p
[
šdex
], 
pkt_f‹r_–em
.
·‰”n_desc
[
j
].
·‰”n
,…kt_f‹r_–em.·‰”n_desc[j].
mask_Ëngth
);

3775 
šdex
 +ğ
pkt_f‹r_–em
.
·‰”n_desc
[
j
].
mask_Ëngth
;

3779 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_£t_·ck‘_f‹r_»q(vif:%d,‚um_f‹rs:%d)\n", 
ndev_vif
->
iâum
, 
num_f‹rs
);

3780 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_PACKET_FILTER_CFM
);

3781 ià(!
cfm
)

3782  -
EIO
;

3784 
	`kä“_skb
(
cfm
);

3785  
r
;

3786 
	}
}

3788 
	$¦si_mlme_£t_pmk
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
pmk
, 
u16
 
pmkËn
)

3790 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3791 
sk_buff
 *
»q
;

3792 
sk_buff
 *
cfm
;

3793 
r
 = 0;

3795 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3797 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

3798  -
EINVAL
;

3799 ià(
pmk
)

3800 
»q
 = 
	`çpi_®loc
(
mlme_£t_pmk_»q
, 
MLME_SET_PMK_REQ
, 
ndev_vif
->
iâum
, 
pmkËn
);

3802 
»q
 = 
	`çpi_®loc
(
mlme_£t_pmk_»q
, 
MLME_SET_PMK_REQ
, 
ndev_vif
->
iâum
, 0);

3804 ià(!
»q
)

3805  -
ENOMEM
;

3806 ià(
pmk
)

3807 
	`çpi_­³nd_d©a
(
»q
, 
pmk
, 
pmkËn
);

3809 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_£t_pmk_»q(vif:%u,…mkËn:%d)\n", 
ndev_vif
->
iâum
, 
pmkËn
);

3810 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_PMK_CFM
);

3811 ià(!
cfm
)

3812  -
EIO
;

3814 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_pmk_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

3815 
	`SLSI_NET_ERR
(
dev
, "mlme_set_pmk_cfm(result:0x%04x) ERROR\n",

3816 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_pmk_cfm
.
»suÉ_code
));

3817 
r
 = -
EINVAL
;

3819 
	`kä“_skb
(
cfm
);

3820  
r
;

3821 
	}
}

3823 
	$¦si_mlme_rßm
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
bssid
, 
u16
 
äeq
)

3825 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3826 
sk_buff
 *
»q
;

3827 
sk_buff
 *
cfm
;

3828 
r
 = 0;

3830 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3831 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

3832  -
EINVAL
;

3834 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_rßm_»q(vif:%u, bssid:%pM, f»q:%d)\n", 
ndev_vif
->
iâum
, 
bssid
, 
äeq
);

3835 
»q
 = 
	`çpi_®loc
(
mlme_rßm_»q
, 
MLME_ROAM_REQ
, 
ndev_vif
->
iâum
, 0);

3836 ià(!
»q
)

3837  -
ENOMEM
;

3838 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_rßm_»q
.
bssid
, bssid);

3839 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_rßm_»q
.
chªÃl_äequ’cy
, 
	`SLSI_FREQ_HOST_TO_FW
(
äeq
));

3840 
	`©omic_£t
(&
ndev_vif
->
¡a
.
drİ_rßmed_šd
, 1);

3841 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_ROAM_CFM
);

3842 
	`©omic_£t
(&
ndev_vif
->
¡a
.
drİ_rßmed_šd
, 0);

3843 ià(!
cfm
)

3844  -
EIO
;

3845 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_rßm_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

3846 
	`SLSI_NET_ERR
(
dev
, "mlme_roam_cfm(result:0x%04x) ERROR\n",

3847 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_rßm_cfm
.
»suÉ_code
));

3848 
r
 = -
EINVAL
;

3850 
	`kä“_skb
(
cfm
);

3851 
ndev_vif
->
¡a
.
rßm_š_´og»ss
 = 
Œue
;

3852  
r
;

3853 
	}
}

3855 
	$¦si_mlme_£t_ÿched_chªÃls
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
chªÃls_couÁ
, 
u8
 *
chªÃls
)

3857 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3858 
sk_buff
 *
»q
;

3859 
sk_buff
 *
cfm
;

3860 
u8
 *
p
;

3861 
r
 = 0;

3862 
size_t
 
chªÃl_›
 = 0;

3863 
i
;

3864 cÚ¡ 
u8
 
chªÃls_li¡_›_h—d”
[] = {

3872 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3873 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

3874  -
EINVAL
;

3876 ià(
chªÃls_couÁ
) {

3877 
chªÃl_›
 +ğ6 + (
chªÃls_couÁ
 * 
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
);

3878 
»q
 = 
	`çpi_®loc
(
mlme_£t_ÿched_chªÃls_»q
, 
MLME_SET_CACHED_CHANNELS_REQ
, 
ndev_vif
->
iâum
, 
chªÃl_›
);

3880 
»q
 = 
	`çpi_®loc
(
mlme_£t_ÿched_chªÃls_»q
, 
MLME_SET_CACHED_CHANNELS_REQ
, 
ndev_vif
->
iâum
, 0);

3882 ià(!
»q
)

3883  -
ENOMEM
;

3885 ià(
chªÃls_couÁ
) {

3886 
u16
 
äeq_fw_un™
;

3887 
u8
 *
chªÃls_li¡_›
 = 
	`çpi_­³nd_d©a
(
»q
, 
chªÃls_li¡_›_h—d”
, (channels_list_ie_header));

3889 ià(!
chªÃls_li¡_›
) {

3890 
	`SLSI_WARN
(
sdev
, "channel†ist IE‡ppend failed\n");

3891 
	`kä“_skb
(
»q
);

3892  -
EINVAL
;

3895 
i
 = 0; i < 
chªÃls_couÁ
; i++) {

3896 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "»que¡ fÜ chªÃl %d\n", 
chªÃls
[
i
]);

3897 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
);

3898 ià(!
p
) {

3899 
	`kä“_skb
(
»q
);

3900  -
EINVAL
;

3902 
äeq_fw_un™
 = 2 * 
	`›“80211_chªÃl_to_äequ’cy
(
chªÃls
[
i
], (chªÃls[i] <ğ14è? 
NL80211_BAND_2GHZ
 : 
NL80211_BAND_5GHZ
);

3903 
äeq_fw_un™
 = 
	`ıu_to_Ë16
(freq_fw_unit);

3904 
	`memıy
(
p
, &
äeq_fw_un™
, (freq_fw_unit));

3906 
p
[2] = 
FAPI_SCANPOLICY_2_4GHZ
 | 
FAPI_SCANPOLICY_5GHZ
;

3908 
chªÃls_li¡_›
[1] +ğ
SLSI_SCAN_CHANNEL_DESCRIPTOR_SIZE
;

3912 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_£t_ÿched_chªÃls_»q(vif:%d)\n", 
ndev_vif
->
iâum
);

3913 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_CACHED_CHANNELS_CFM
);

3914 ià(!
cfm
)

3915  -
EIO
;

3917 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_ÿched_chªÃls_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

3918 
	`SLSI_NET_ERR
(
dev
, "mlme_set_cached_channels_cfm(result:0x%04x) ERROR\n",

3919 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_ÿched_chªÃls_cfm
.
»suÉ_code
));

3920 
r
 = -
EINVAL
;

3923 
	`kä“_skb
(
cfm
);

3924  
r
;

3925 
	}
}

3927 
	$¦si_mlme_£t_aş
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
iâum
,

3928 
Æ80211_aş_pŞicy
 
aş_pŞicy
, 
max_aş_’Œ›s
,

3929 
mac_add»ss
 
mac_addrs
[])

3931 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3932 
sk_buff
 *
»q
;

3933 
sk_buff
 *
cfm
;

3934 
size_t
 
mac_aş_size
 = 0;

3935 
i
, 
r
 = 0;

3936 
n_aş_’Œ›s
 = 0;

3937 
u8
 
z”o_addr
[
ETH_ALEN
] = {0};

3939 ià(
iâum
 > 0 && 
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

3940  -
EINVAL
;

3942 
i
 = 0; i < 
max_aş_’Œ›s
; i++) {

3943 ià(!
	`SLSI_ETHER_EQUAL
(
mac_addrs
[
i
].
addr
, 
z”o_addr
))

3944 
n_aş_’Œ›s
++;

3947 
mac_aş_size
 = ((
mac_addrs
[0])è* (
n_aş_’Œ›s
);

3948 
»q
 = 
	`çpi_®loc
(
mlme_£t_aş_»q
, 
MLME_SET_ACL_REQ
, 
iâum
, 
mac_aş_size
);

3949 ià(!
»q
) {

3950 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

3951  -
ENOMEM
;

3953 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_aş_»q
.
’Œ›s
, 
n_aş_’Œ›s
);

3954 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_aş_»q
.
aş_pŞicy
,‡cl_policy);

3956 
i
 = 0; i < 
max_aş_’Œ›s
; i++) {

3957 ià(!
	`SLSI_ETHER_EQUAL
(
mac_addrs
[
i
].
addr
, 
z”o_addr
))

3958 
	`çpi_­³nd_d©a
(
»q
, 
mac_addrs
[
i
].
addr
, ((mac_addrs[i])));

3961 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_£t_aş_»q(vif:%u,‚_aş_’Œ›s:%d)\n", 
iâum
, 
n_aş_’Œ›s
);

3963 ià(
iâum
)

3964 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_ACL_CFM
);

3966 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
NULL
, 
»q
, 
MLME_SET_ACL_CFM
);

3967 ià(!
cfm
)

3968  -
EIO
;

3970 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_aş_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

3971 
	`SLSI_NET_ERR
(
dev
, "mlme_set_acl_cfm(result:0x%04x) ERROR\n",

3972 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_aş_cfm
.
»suÉ_code
));

3973 
r
 = -
EINVAL
;

3976 
	`kä“_skb
(
cfm
);

3977  
r
;

3978 
	}
}

3980 
	$¦si_mlme_£t_Œaffic_·¿m‘”s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
u£r_´iÜ™y
, u16 
medium_time
, u16 
mšimun_d©a_¿‹
, 
u8
 *
mac
)

3982 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3983 
sk_buff
 *
»q
;

3984 
sk_buff
 *
rx
;

3985 
r
 = 0;

3987 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3989 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

3990  -
EINVAL
;

3992 ià(
	`WARN_ON
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
 &&‚dev_vif->
iáy³
 =ğ
NL80211_IFTYPE_STATION
))

3993  -
EINVAL
;

3995 
»q
 = 
	`çpi_®loc
(
mlme_£t_Œaffic_·¿m‘”s_»q
, 
MLME_SET_TRAFFIC_PARAMETERS_REQ
, 
ndev_vif
->
iâum
, 0);

3996 ià(!
»q
)

3997  -
ENOMEM
;

3999 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_Œaffic_·¿m‘”s_»q
.
u£r_´iÜ™y
, user_priority);

4000 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_Œaffic_·¿m‘”s_»q
.
medium_time
, medium_time);

4001 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_Œaffic_·¿m‘”s_»q
.
mšimum_d©a_¿‹
, 
mšimun_d©a_¿‹
);

4003 ià(
mac
)

4004 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_£t_Œaffic_·¿m‘”s_»q
.
³”_add»ss
, 
mac
);

4006 
	`çpi_£t_mem£t
(
»q
, 
u
.
mlme_£t_Œaffic_·¿m‘”s_»q
.
³”_add»ss
, 0);

4008 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_£t_Œaffic_·¿m‘”s_»q(vif:%u, u£r_´iÜ™y:%d, medium_time:%d)\n", 
ndev_vif
->
iâum
, 
u£r_´iÜ™y
, 
medium_time
);

4009 
rx
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_TRAFFIC_PARAMETERS_CFM
);

4010 ià(!
rx
)

4011  -
EIO
;

4013 ià(
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_£t_Œaffic_·¿m‘”s_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4014 
	`SLSI_NET_ERR
(
dev
, "mlme_set_traffic_parameters_cfm(result:0x%04x) ERROR\n",

4015 
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_£t_Œaffic_·¿m‘”s_cfm
.
»suÉ_code
));

4016 
r
 = -
EINVAL
;

4019  
r
;

4020 
	}
}

4022 
	$¦si_mlme_d–_Œaffic_·¿m‘”s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
u£r_´iÜ™y
)

4024 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4025 
sk_buff
 *
»q
;

4026 
sk_buff
 *
rx
;

4027 
r
 = 0;

4029 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4031 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

4032  -
EINVAL
;

4034 ià(
	`WARN_ON
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
 &&‚dev_vif->
iáy³
 =ğ
NL80211_IFTYPE_STATION
))

4035  -
EINVAL
;

4037 
»q
 = 
	`çpi_®loc
(
mlme_d–_Œaffic_·¿m‘”s_»q
, 
MLME_DEL_TRAFFIC_PARAMETERS_REQ
, 
ndev_vif
->
iâum
, 0);

4038 ià(!
»q
)

4039  -
ENOMEM
;

4041 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_d–_Œaffic_·¿m‘”s_»q
.
u£r_´iÜ™y
, user_priority);

4043 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_d–_Œaffic_·¿m‘”s_»q(vif:%u, u£r_´iÜ™y:%d)\n", 
ndev_vif
->
iâum
, 
u£r_´iÜ™y
);

4044 
rx
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_DEL_TRAFFIC_PARAMETERS_CFM
);

4045 ià(!
rx
)

4046  -
EIO
;

4048 ià(
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_d–_Œaffic_·¿m‘”s_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4049 
	`SLSI_NET_ERR
(
dev
, "mlme_del_traffic_parameters_cfm(result:0x%04x) ERROR\n",

4050 
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_d–_Œaffic_·¿m‘”s_cfm
.
»suÉ_code
));

4051 
r
 = -
EINVAL
;

4054  
r
;

4055 
	}
}

4057 
	$¦si_mlme_£t_ext_ÿ·b
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
d©a
, 
d©®’gth
)

4059 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

4060 
”rÜ
 = 0;

4062 
”rÜ
 = 
	`¦si_mib_’code_où‘
(&
mib_d©a
, 
SLSI_PSID_UNIFI_EXTENDED_CAPABILITIES
, 
d©®’gth
, 
d©a
, 0);

4063 ià(
”rÜ
 !ğ
SLSI_MIB_STATUS_SUCCESS
) {

4064 
”rÜ
 = -
ENOMEM
;

4065 
ex™
;

4068 ià(
	`WARN_ON
(
mib_d©a
.
d©aL’gth
 == 0)) {

4069 
”rÜ
 = -
EINVAL
;

4070 
ex™
;

4073 
”rÜ
 = 
	`¦si_mlme_£t
(
sdev
, 
NULL
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

4074 
	`kä“
(
mib_d©a
.
d©a
);

4076 ià(!
”rÜ
)

4079 
ex™
:

4080 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀ£‰šgƒxˆÿ·b.ƒ¼Ü = %d\n", 
”rÜ
);

4081  
”rÜ
;

4082 
	}
}

4084 
	$¦si_mlme_tdls_³”_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
pid
, u16 
tdls_ev’t
)

4086 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4087 
sk_buff
 *
»q
;

4088 
sk_buff
 *
cfm
;

4090 
»q
 = 
	`çpi_®loc
(
mlme_tdls_³”_»s
, 
MLME_TDLS_PEER_RES
, 
ndev_vif
->
iâum
, 0);

4091 ià(!
»q
)

4092  -
ENOMEM
;

4094 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_tdls_³”_»s
.
³”_šdex
, 
pid
);

4095 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_tdls_³”_»s
.
tdls_ev’t
,dls_event);

4097 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_tdls_³”_»s(vif:%d)\n", 
ndev_vif
->
iâum
);

4098 
cfm
 = 
	`¦si_mlme_»q_no_cfm
(
sdev
, 
dev
, 
»q
);

4099 
	`WARN_ON
(
cfm
);

4102 
	}
}

4104 
	$¦si_mlme_tdls_aùiÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
³”
, 
aùiÚ
, 
u16
 
ûÁ”_äeq
, u16 
chª_šfo
)

4106 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4107 
sk_buff
 *
»q
;

4108 
sk_buff
 *
cfm
;

4109 
r
 = 0;

4111 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_tdls_aùiÚ_»q×ùiÚ:%u)\n", 
aùiÚ
);

4112 
»q
 = 
	`çpi_®loc
(
mlme_tdls_aùiÚ_»q
, 
MLME_TDLS_ACTION_REQ
, 
ndev_vif
->
iâum
, 0);

4113 ià(!
»q
)

4114  -
ENOMEM
;

4116 
ûÁ”_äeq
 = 
	`SLSI_FREQ_HOST_TO_FW
(center_freq);

4118 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_tdls_aùiÚ_»q
.
³”_¡a_add»ss
, 
³”
);

4119 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_tdls_aùiÚ_»q
.
tdls_aùiÚ
, 
aùiÚ
);

4120 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_tdls_aùiÚ_»q
.
chªÃl_äequ’cy
, 
ûÁ”_äeq
);

4121 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_tdls_aùiÚ_»q
.
chªÃl_šfÜm©iÚ
, 
chª_šfo
);

4123 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_TDLS_ACTION_CFM
);

4124 ià(!
cfm
)

4125  -
EIO
;

4127 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_tdls_aùiÚ_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4128 
	`SLSI_NET_ERR
(
dev
, "mlme_tdls_action_cfm(result:0x%04x) ERROR\n",

4129 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_tdls_aùiÚ_cfm
.
»suÉ_code
));

4130 
r
 = -
EINVAL
;

4133 
	`kä“_skb
(
cfm
);

4135  
r
;

4136 
	}
}

4138 
	$¦si_mlme_»assocŸ‹
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4140 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4141 
sk_buff
 *
»q
;

4142 
sk_buff
 *
cfm
;

4143 
r
 = 0;

4145 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4146 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

4147  -
EINVAL
;

4149 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_»assoc_»q(vif:%u)\n", 
ndev_vif
->
iâum
);

4150 
»q
 = 
	`çpi_®loc
(
mlme_»assocŸ‹_»q
, 
MLME_REASSOCIATE_REQ
, 
ndev_vif
->
iâum
, 0);

4151 ià(!
»q
)

4152  -
ENOMEM
;

4154 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_REASSOCIATE_CFM
);

4155 ià(!
cfm
)

4156  -
EIO
;

4158 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_»assocŸ‹_cfm
.
»suÉ_code
è=ğ
FAPI_RESULTCODE_HOST_REQUEST_SUCCESS
) {

4159 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_reassoc_cfm(result:0x%04x)\n",

4160 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_»assocŸ‹_cfm
.
»suÉ_code
));

4162 
	`SLSI_NET_ERR
(
dev
, "mlme_reassoc_cfm(result:0x%04x) ERROR\n",

4163 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_»assocŸ‹_cfm
.
»suÉ_code
));

4164 
r
 = -
EINVAL
;

4166 
	`kä“_skb
(
cfm
);

4167  
r
;

4168 
	}
}

4170 
	$¦si_mlme_»assocŸ‹_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4172 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4173 
sk_buff
 *
»q
;

4174 
sk_buff
 *
cfm
;

4176 ià(
	`WARN_ON
(!
ndev_vif
->
aùiv©ed
))

4179 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

4180 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_REASSOCIATE_RESP\n");

4184 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_»assocŸ‹_»¥(vif:%d)\n", 
ndev_vif
->
iâum
);

4185 
»q
 = 
	`çpi_®loc
(
mlme_»assocŸ‹_»s
, 
MLME_REASSOCIATE_RES
, 
ndev_vif
->
iâum
, 0);

4186 ià(!
»q
)

4189 
cfm
 = 
	`¦si_mlme_»q_no_cfm
(
sdev
, 
dev
, 
»q
);

4190 
	`WARN_ON
(
cfm
);

4191 
	}
}

4193 
	$¦si_mlme_add_¿nge_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 
couÁ
,

4194 
¦si_¹t_cÚfig
 *
Æ_¹t_·¿ms
, 
u16
 
¹t_id
, 
u8
 *
sourû_addr
)

4196 
sk_buff
 *
»q
;

4197 
sk_buff
 *
rx
;

4198 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4199 
r
 = 0, 
i
;

4200 
size_t
 
®loc_d©a_size
 = 0;

4201 
u8
 
çpi_›_g’”ic
[] = { 0xdd, 0x1c, 0x00, 0x16, 0x32, 0x0a, 0x01 };

4203 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4205 
®loc_d©a_size
 +ğ
couÁ
 * (
çpi_›_g’”ic
[1] + 2);

4207 
»q
 = 
	`çpi_®loc
(
mlme_add_¿nge_»q
, 
MLME_ADD_RANGE_REQ
, 0, 
®loc_d©a_size
);

4208 ià(!
»q
) {

4209 
	`SLSI_ERR
(
sdev
, "çedØ®loø%zd\n", 
®loc_d©a_size
);

4210  -
ENOMEM
;

4212 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "count:%d‡llocated data size: %d, source_addr:%pM\n",

4213 
couÁ
, 
®loc_d©a_size
, 
sourû_addr
);

4215 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_add_¿nge_»q
.
vif
, 0);

4216 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_add_¿nge_»q
.
¹t_id
,„tt_id);

4217 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_add_¿nge_»q
.
deviû_add»ss
, 
sourû_addr
);

4218 
i
 = 0; i < 
couÁ
; i++) {

4219 
	`çpi_­³nd_d©a
(
»q
, 
çpi_›_g’”ic
, (fapi_ie_generic));

4220 
	`çpi_­³nd_d©a
(
»q
, 
Æ_¹t_·¿ms
[
i
].
³”_addr
, 
ETH_ALEN
);

4221 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
¹t_³”
, 1);

4222 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
¹t_ty³
, 1);

4223 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
chªÃl_äeq
, 2);

4224 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
bur¡_³riod
, 1);

4225 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
num_bur¡
, 1);

4226 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
num_äames_³r_bur¡
, 1);

4227 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
num_»Œ›s_³r_ámr
, 1);

4228 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
bur¡_du¿tiÚ
, 1);

4229 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
´—mbË
, 2);

4230 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
bw
, 2);

4231 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
LCI_»que¡
, 2);

4232 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
Æ_¹t_·¿ms
[
i
].
LCR_»que¡
, 2);

4234 
rx
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
NULL
, 
»q
, 
MLME_ADD_RANGE_CFM
);

4235 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "(After mlme„eq cfm for„tt config)\n");

4236 ià(!
rx
)

4237  -
EIO
;

4238 ià(
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_add_¿nge_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4239 
	`SLSI_ERR
(
sdev
, "mlme_add_range_cfm(ERROR:0x%04x)",

4240 
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_add_¿nge_cfm
.
»suÉ_code
));

4241 
r
 = -
EINVAL
;

4244 
	`kä“_skb
(
rx
);

4245  
r
;

4246 
	}
}

4248 
boŞ
 
	$¦si_d–_¿nge_cfm_v®id©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
cfm
)

4250 
»suÉ
 = 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_d–_¿nge_cfm
.
»suÉ_code
);

4251 
boŞ
 
r
 = 
çl£
;

4253 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

4255 ià(
	`WARN_ON
(!
dev
))

4256 
ex™
;

4258 ià(
»suÉ
 =ğ
FAPI_RESULTCODE_SUCCESS
)

4259 
r
 = 
Œue
;

4261 
	`SLSI_NET_ERR
(
dev
, "mlme_d–_¿nge_cfmÔesuÉ:0x%04xèERROR\n", 
»suÉ
);

4263 
ex™
:

4264 
	`kä“_skb
(
cfm
);

4265  
r
;

4266 
	}
}

4268 
	$¦si_mlme_d–_¿nge_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
couÁ
,

4269 
u8
 *
addr
, 
u16
 
¹t_id
)

4271 
sk_buff
 *
»q
;

4272 
sk_buff
 *
rx
;

4273 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4274 
r
 = 0, 
i
;

4275 
size_t
 
®loc_d©a_size
 = 0;

4277 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4279 
®loc_d©a_size
 +ğ
couÁ
 * (
ETH_ALEN
);

4281 
»q
 = 
	`çpi_®loc
(
mlme_d–_¿nge_»q
, 
MLME_DEL_RANGE_REQ
, 0, 
®loc_d©a_size
);

4282 ià(!
»q
) {

4283 
	`SLSI_ERR
(
sdev
, "çedØ®loø%zd\n", 
®loc_d©a_size
);

4284  -
ENOMEM
;

4287 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_d–_¿nge_»q
.
vif
, 0);

4288 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_d–_¿nge_»q
.
¹t_id
,„tt_id);

4289 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_d–_¿nge_»q
.
’Œ›s
, 
couÁ
);

4290 
	`SLSI_INFO
(
sdev
, "¹t_id:%d,couÁ:%d\n", 
¹t_id
, 
couÁ
);

4291 
i
 = 0; i < 
couÁ
; i++)

4292 
	`çpi_­³nd_d©a
(
»q
, &
addr
[
i
 * 
ETH_ALEN
], ETH_ALEN);

4294 
rx
 = 
	`¦si_mlme_»q_cfm_šd
(
sdev
, 
dev
, 
»q
, 
MLME_DEL_RANGE_CFM
, 
MLME_RANGE_IND
, 
¦si_d–_¿nge_cfm_v®id©e
);

4295 ià(!
rx
) {

4296 
	`SLSI_NET_ERR
(
dev
, "mlme_del_range_cfm() ERROR\n");

4297 
r
 = -
EINVAL
;

4299 
	`kä“_skb
(
rx
);

4300  
r
;

4301 
	}
}

4303 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


4304 
	#SLSI_FAPI_EPNO_NETWORK_MIN_SIZE
 (3)

	)

4305 
	$¦si_mlme_£t_²o_li¡
(
¦si_dev
 *
sdev
, 
couÁ
,

4306 
¦si_•no_·¿m
 *
•no_·¿m
, 
¦si_•no_hs2_·¿m
 *
•no_hs2_·¿m
)

4308 
sk_buff
 *
»q
;

4309 
sk_buff
 *
rx
;

4310 
r
 = 0;

4311 
size_t
 
®loc_d©a_size
 = 0;

4312 
u32
 
i
, 
j
;

4313 
u8
 
çpi_›_g’”ic
[] = { 0xdd, 0, 0x00, 0x16, 0x32, 0x01, 0x00 };

4314 
u8
 *
buff_±r
, *
›_¡¬t_pos
;

4315 
size_t
 
¡r_Ën
 = 0;

4317 
¡r_Ën
 = 
	`¡ºËn
(
•no_hs2_·¿m
->
»®m
, 
	`ARRAY_SIZE
(epno_hs2_param->realm));

4318 ià(
couÁ
) {

4320 ià(
•no_·¿m
) {

4321 
®loc_d©a_size
 +ğ(
çpi_›_g’”ic
è+ 
SLSI_FAPI_EPNO_NETWORK_MIN_SIZE
 * 
couÁ
 + 11;

4322 
i
 = 0; i < 
couÁ
; i++)

4323 
®loc_d©a_size
 +ğ
•no_·¿m
->
•no_ssid
[
i
].
ssid_Ën
;

4324 } ià(
•no_hs2_·¿m
) {

4325 
i
 = 0; i < 
couÁ
; i++) {

4330 ià(
¡r_Ën
)

4331 
®loc_d©a_size
 +ğ(
çpi_›_g’”ic
è+ 1 + 1 + (
¡r_Ën
 + 1)

4334 
®loc_d©a_size
 +ğ(
çpi_›_g’”ic
) + 1 + 1 + 0

4341 
»q
 = 
	`çpi_®loc
(
mlme_£t_²o_li¡_»q
, 
MLME_SET_PNO_LIST_REQ
, 0, 
®loc_d©a_size
);

4342 ià(!
»q
) {

4343 
	`SLSI_ERR
(
sdev
, "çedØ®loø%zd\n", 
®loc_d©a_size
);

4344  -
ENOMEM
;

4346 ià(
couÁ
) {

4348 ià(
•no_·¿m
) {

4349 
çpi_›_g’”ic
[1] = 
®loc_d©a_size
 - 2;

4350 
çpi_›_g’”ic
[6] = 9;

4351 
	`çpi_­³nd_d©a
(
»q
, 
çpi_›_g’”ic
, (fapi_ie_generic));

4352 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)
•no_·¿m
, ((*epno_param) - 1));

4353 
i
 = 0; i < 
couÁ
; i++) {

4354 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
•no_·¿m
->
•no_ssid
[
i
].
æags
, 2);

4355 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
•no_·¿m
->
•no_ssid
[
i
].
ssid_Ën
, 1);

4356 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)
•no_·¿m
->
•no_ssid
[
i
].
ssid
,

4357 
•no_·¿m
->
•no_ssid
[
i
].
ssid_Ën
);

4359 } ià(
•no_hs2_·¿m
) {

4360 
u8
 
»®m_Ëngth
;

4361 
u8
 
rßmšg_cÚsÜtium_couÁ
 = 16;

4362 
u8
 
¶mn_Ëngth
 = 6;

4363 
u8
 
¶mn_dig™
[6];

4365 
çpi_›_g’”ic
[6] = 0x10;

4366 
i
 = 0; i < 
couÁ
; i++) {

4367 
buff_±r
 = 
	`çpi_­³nd_d©a
(
»q
, 
çpi_›_g’”ic
, (fapi_ie_generic));

4368 ià(!
buff_±r
) {

4369 
	`SLSI_ERR
(
sdev
, "failed‡ppend data\n");

4370 
	`kä“_skb
(
»q
);

4371  -
EINVAL
;

4373 
›_¡¬t_pos
 = 
buff_±r
;

4375 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
•no_hs2_·¿m
[
i
].
id
, 1);

4377 
»®m_Ëngth
 = 
	`¡¾’
(
•no_hs2_·¿m
[
i
].
»®m
);

4378 ià(
»®m_Ëngth
) {

4379 
»®m_Ëngth
++;

4380 
	`çpi_­³nd_d©a
(
»q
, &
»®m_Ëngth
, 1);

4381 
	`çpi_­³nd_d©a
(
»q
, 
•no_hs2_·¿m
[
i
].
»®m
, 
»®m_Ëngth
);

4383 
	`çpi_­³nd_d©a
(
»q
, &
»®m_Ëngth
, 1);

4386 
	`çpi_­³nd_d©a
(
»q
, &
rßmšg_cÚsÜtium_couÁ
, 1);

4387 
	`çpi_­³nd_d©a
(
»q
, (
u8
 *)&
•no_hs2_·¿m
[
i
].
rßmšg_cÚsÜtium_ids
, 16 * 8);

4389 
	`çpi_­³nd_d©a
(
»q
, &
¶mn_Ëngth
, 1);

4390 
j
 = 0; j < 3; j++) {

4391 
¶mn_dig™
[
j
 * 2] = 
•no_hs2_·¿m
[
i
].
¶mn
[i] & 0x0F;

4392 
¶mn_dig™
[(
j
 * 2è+ 1] = 
•no_hs2_·¿m
[
i
].
¶mn
[i] & 0xF0 >> 4;

4394 
buff_±r
 = 
	`çpi_­³nd_d©a
(
»q
, 
¶mn_dig™
, (plmn_digit));

4395 ià(!
buff_±r
) {

4396 
	`SLSI_ERR
(
sdev
, "failed‡ppend data\n");

4397 
	`kä“_skb
(
»q
);

4398  -
EINVAL
;

4401 
buff_±r
 +ğ(
¶mn_dig™
);

4402 
›_¡¬t_pos
[1] = 
buff_±r
 - ie_start_pos - 2;

4409 
rx
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
NULL
, 
»q
, 
MLME_SET_PNO_LIST_CFM
);

4410 ià(!
rx
)

4411  -
EIO
;

4412 ià(
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_£t_²o_li¡_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4413 
	`SLSI_ERR
(
sdev
, "mlme_set_pno_list_cfm(ERROR:0x%04x)",

4414 
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_£t_²o_li¡_cfm
.
»suÉ_code
));

4415 
r
 = -
EINVAL
;

4417 
	`kä“_skb
(
rx
);

4418  
r
;

4419 
	}
}

4421 
	$¦si_mlme_¡¬t_lšk_¡©s_»q
(
¦si_dev
 *
sdev
, 
u16
 
mpdu_size_th»shŞd
, 
boŞ
 
agg»ssive_¡©s_’abËd
)

4423 
sk_buff
 *
»q
;

4424 
sk_buff
 *
cfm
;

4425 
r
 = 0;

4427 
»q
 = 
	`çpi_®loc
(
mlme_¡¬t_lšk_¡©i¡ics_»q
, 
MLME_START_LINK_STATISTICS_REQ
, 0, 0);

4428 ià(!
»q
) {

4429 
	`SLSI_ERR
(
sdev
, "memory‡llocation failed for signal\n");

4430  -
ENOMEM
;

4433 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¡¬t_lšk_¡©i¡ics_»q
.
mpdu_size_th»shŞd
, mpdu_size_threshold);

4434 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¡¬t_lšk_¡©i¡ics_»q
.
agg»ssive_¡©i¡ics_g©h”šg_’abËd
,

4435 
agg»ssive_¡©s_’abËd
);

4437 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "(mpdu_size_threshold:%d,‡ggressive_stats_enabled:%d)\n",

4438 
mpdu_size_th»shŞd
, 
agg»ssive_¡©s_’abËd
);

4439 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
NULL
, 
»q
, 
MLME_START_LINK_STATISTICS_CFM
);

4440 ià(!
cfm
)

4441  -
EIO
;

4443 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_¡¬t_lšk_¡©i¡ics_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4444 
	`SLSI_ERR
(
sdev
, "mlme_start_link_statistics_cfm (result:0x%04x) ERROR\n",

4445 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_¡¬t_lšk_¡©i¡ics_cfm
.
»suÉ_code
));

4446 
r
 = -
EINVAL
;

4449 
	`kä“_skb
(
cfm
);

4450  
r
;

4451 
	}
}

4453 
	$¦si_mlme_¡İ_lšk_¡©s_»q
(
¦si_dev
 *
sdev
, 
u16
 
¡©s_¡İ_mask
)

4455 
sk_buff
 *
»q
;

4456 
sk_buff
 *
cfm
;

4457 
r
 = 0;

4459 
»q
 = 
	`çpi_®loc
(
mlme_¡İ_lšk_¡©i¡ics_»q
, 
MLME_STOP_LINK_STATISTICS_REQ
, 0, 0);

4460 ià(!
»q
) {

4461 
	`SLSI_ERR
(
sdev
, "memory‡llocation failed for signal\n");

4462  -
ENOMEM
;

4465 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¡İ_lšk_¡©i¡ics_»q
.
¡©i¡ics_¡İ_b™m­
, 
¡©s_¡İ_mask
);

4467 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "¡©i¡ics_¡İ_b™m­:%d\n", 
¡©s_¡İ_mask
);

4468 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
NULL
, 
»q
, 
MLME_STOP_LINK_STATISTICS_CFM
);

4469 ià(!
cfm
)

4470  -
EIO
;

4472 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_¡İ_lšk_¡©i¡ics_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4473 
	`SLSI_ERR
(
sdev
, "mlme_stop_link_statistics_cfm (result:0x%04x) ERROR\n",

4474 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_¡İ_lšk_¡©i¡ics_cfm
.
»suÉ_code
));

4475 
r
 = -
EINVAL
;

4477 
	`kä“_skb
(
cfm
);

4478  
r
;

4479 
	}
}

4482 
	$¦si_mlme_£t_rssi_mÚ™Ü
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 
’abË
, 
s8
 
low_rssi_th»shŞd
, s8 
high_rssi_th»shŞd
)

4484 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4485 
sk_buff
 *
»q
;

4486 
sk_buff
 *
cfm
;

4487 
r
 = 0;

4489 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_set_rssi_monitor(vif:%u),ƒnable =%d,†ow_rssi_threshold = %d,high_rssi_threshold =%d\n",

4490 
ndev_vif
->
iâum
, 
’abË
, 
low_rssi_th»shŞd
, 
high_rssi_th»shŞd
);

4492 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4493 
»q
 = 
	`çpi_®loc
(
mlme_mÚ™Ü_rssi_»q
, 
MLME_MONITOR_RSSI_REQ
, 
ndev_vif
->
iâum
, 0);

4494 ià(!
»q
) {

4495 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

4496  -
ENOMEM
;

4499 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_mÚ™Ü_rssi_»q
.
rssi_mÚ™Üšg_’abËd
, 
’abË
);

4500 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_mÚ™Ü_rssi_»q
.
low_rssi_th»shŞd
,†ow_rssi_threshold);

4501 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_mÚ™Ü_rssi_»q
.
high_rssi_th»shŞd
, high_rssi_threshold);

4503 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_MONITOR_RSSI_CFM
);

4504 ià(!
cfm
)

4505  -
EIO
;

4507 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_mÚ™Ü_rssi_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4508 
	`SLSI_NET_ERR
(
dev
, "mlme_mÚ™Ü_rssi_cfmÔesuÉ:0x%04xèERROR\n", 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_mÚ™Ü_rssi_cfm
.
»suÉ_code
));

4509 
r
 = -
EINVAL
;

4512 
	`kä“_skb
(
cfm
);

4513  
r
;

4514 
	}
}

4516 
¦si_mib_v®ue
 *
	$¦si_»ad_mibs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

4517 
¦si_mib_g‘_’Œy
 *
mib_’Œ›s
, 
mib_couÁ
, 
¦si_mib_d©a
 *
mibr¥
)

4519 
¦si_mib_d©a
 
mib»q
 = { 0, 
NULL
 };

4520 
¦si_mib_v®ue
 *
v®ues
;

4521 
rx_Ëngth
, 
r
;

4523 
r
 = 
	`¦si_mib_’code_g‘_li¡
(&
mib»q
, 
mib_couÁ
, 
mib_’Œ›s
);

4524 ià(
r
 !ğ
SLSI_MIB_STATUS_SUCCESS
) {

4525 
	`SLSI_WARN
(
sdev
, "¦si_mib_’code_g‘_li¡ fa %d\n", 
r
);

4526  
NULL
;

4529 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
dev
, 
mib»q
.
d©a
, mib»q.
d©aL’gth
, 
mibr¥
->d©a, mibr¥->d©aL’gth, &
rx_Ëngth
);

4530 
	`kä“
(
mib»q
.
d©a
);

4532 ià(
r
 != 0) {

4533 
	`SLSI_ERR
(
sdev
, "Mib (”r:%d)\n", 
r
);

4534  
NULL
;

4537 
mibr¥
->
d©aL’gth
 = (
u32
)
rx_Ëngth
;

4538 
v®ues
 = 
	`¦si_mib_decode_g‘_li¡
(
mibr¥
, 
mib_couÁ
, 
mib_’Œ›s
);

4539 ià(!
v®ues
)

4540 
	`SLSI_WARN
(
sdev
, "decodeƒrror\n");

4541  
v®ues
;

4542 
	}
}

4544 
	$¦si_mlme_£t_ùwšdow
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
ù_·¿m
)

4546 
Ãtdev_vif
 *
ndev_vif
;

4547 
sk_buff
 *
»q
;

4548 
sk_buff
 *
cfm
;

4549 
r
 = 0;

4551 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_£t_ùwšdow(ù_·¿m = %d)\n", 
ù_·¿m
);

4553 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4555 
»q
 = 
	`çpi_®loc
(
mlme_£t_ùwšdow_»q
, 
MLME_SET_CTWINDOW_REQ
, 
ndev_vif
->
iâum
, 0);

4556 ià(!
»q
)

4557  -
ENOMEM
;

4559 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_ùwšdow_»q
.
ùwšdow
, 
ù_·¿m
);

4561 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_CTWINDOW_CFM
);

4562 ià(!
cfm
)

4563  -
EIO
;

4565 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_ùwšdow_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4566 
	`SLSI_NET_ERR
(
dev
, "mlme_set_ctwindow_cfm(result:0x%04x) ERROR\n",

4567 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_ùwšdow_cfm
.
»suÉ_code
));

4568 
r
 = -
EINVAL
;

4570 
	`kä“_skb
(
cfm
);

4571  
r
;

4572 
	}
}

4574 
	$¦si_mlme_£t_p2p_nß
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
nß_couÁ
,

4575 
š‹rv®
, 
du¿tiÚ
)

4577 
Ãtdev_vif
 *
ndev_vif
;

4578 
sk_buff
 *
»q
;

4579 
sk_buff
 *
cfm
;

4580 
r
 = 0;

4582 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_set_noa_req(noa_count = %d, interval = %d, duration = %d)\n",

4583 
nß_couÁ
, 
š‹rv®
, 
du¿tiÚ
);

4585 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4587 
»q
 = 
	`çpi_®loc
(
mlme_£t_nß_»q
, 
MLME_SET_NOA_REQ
, 
ndev_vif
->
iâum
, 0);

4588 ià(!
»q
)

4589  -
ENOMEM
;

4591 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_nß_»q
.
»que¡_id
, 
SLSI_NOA_CONFIG_REQUEST_ID
);

4592 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_nß_»q
.
nß_couÁ
,‚oa_count);

4593 ià(!
š‹rv®
)

4594 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_£t_nß_»q
.
š‹rv®
, (1 * 1024 * 
ndev_vif
->
­
.
b—cÚ_š‹rv®
));

4596 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_£t_nß_»q
.
š‹rv®
, interval * 1000);

4597 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_£t_nß_»q
.
du¿tiÚ
, duration * 1000);

4599 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_NOA_CFM
);

4600 ià(!
cfm
)

4601  -
EIO
;

4603 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_nß_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4604 
	`SLSI_NET_ERR
(
dev
, "mlme_set_noa_cfm(result:0x%04x) ERROR\n",

4605 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_nß_cfm
.
»suÉ_code
));

4606 
r
 = -
EINVAL
;

4608 
	`kä“_skb
(
cfm
);

4609  
r
;

4610 
	}
}

4612 
	$¦si_mlme_£t_ho¡_¡©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
ho¡_¡©e
)

4614 
sk_buff
 *
»q
;

4615 
sk_buff
 *
cfm
;

4616 
r
 = 0;

4618 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

4619 
	`SLSI_NET_INFO
(
dev
, "Skip MLME_HOST_STATE_REQ in wlanlite mode\n");

4620  -
EOPNOTSUPP
;

4623 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_£t_ho¡_¡©e(¡©ğ0x%04x)\n", 
ho¡_¡©e
);

4625 
»q
 = 
	`çpi_®loc
(
mlme_ho¡_¡©e_»q
, 
MLME_HOST_STATE_REQ
, 0, 0);

4626 ià(!
»q
) {

4627 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

4628  -
ENOMEM
;

4631 ià(
	`¦si_g‘_Ëgacy_§r_backoff
()) {

4632 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_ho¡_¡©e_»q
.
ho¡_¡©e
, host_state);

4634 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_ho¡_¡©e_»q
.
ho¡_¡©e
, 0xFFFF);

4635 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_ho¡_¡©e_»q
.
¥¬e_1
, 0);

4636 
	`çpi_£t_low16_u32
(
»q
, 
u
.
mlme_ho¡_¡©e_»q
.
¥¬e_1
, 
ho¡_¡©e
);

4639 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
NULL
, 
»q
, 
MLME_HOST_STATE_CFM
);

4640 ià(!
cfm
)

4641  -
EIO
;

4643 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_ho¡_¡©e_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4644 
	`SLSI_NET_ERR
(
dev
, "mlme_host_state_cfm(result:0x%04x) ERROR\n",

4645 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_ho¡_¡©e_cfm
.
»suÉ_code
));

4646 
r
 = -
EINVAL
;

4649 
	`kä“_skb
(
cfm
);

4650  
r
;

4651 
	}
}

4653 
	$¦si_mlme_»ad_­f_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 **
ho¡_d¡
, *
d©®’
)

4655 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4656 
sk_buff
 *
»q
;

4657 
sk_buff
 *
rx
;

4658 
r
 = 0;

4660 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4662 ià(!
ndev_vif
->
aùiv©ed
) {

4663 
	`SLSI_ERR
(
sdev
, "ndev_vif is‚ot‡ctivated\n");

4664 
r
 = -
EINVAL
;

4665 
ex™
;

4668 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) {

4669 
	`SLSI_ERR
(
sdev
, "vif_type is‚ot FAPI_VIFTYPE_STATION\n");

4670 
r
 = -
EINVAL
;

4671 
ex™
;

4674 
»q
 = 
	`çpi_®loc
(
mlme_»ad_­f_»q
, 
MLME_READ_APF_REQ
, 
ndev_vif
->
iâum
, 0);

4675 ià(!
»q
) {

4676 
r
 = -
ENOMEM
;

4677 
ex™
;

4680 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_»ad_­f_»q(vif:%u)\n", 
ndev_vif
->
iâum
);

4681 
rx
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_READ_APF_CFM
);

4682 ià(!
rx
) {

4683 
r
 = -
EIO
;

4684 
ex™
;

4687 ià(
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_»ad_­f_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4688 
	`SLSI_NET_ERR
(
dev
, "mlme_read_apf_cfm(result:0x%04x) ERROR\n",

4689 
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_»ad_­f_cfm
.
»suÉ_code
));

4690 
r
 = -
EINVAL
;

4693 *
d©®’
 = 
	`çpi_g‘_d©®’
(
rx
);

4694 *
ho¡_d¡
 = 
	`çpi_g‘_d©a
(
rx
);

4696 
ex™
:

4697 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4698  
r
;

4699 
	}
}

4701 
	$¦si_mlme_š¡®l_­f_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

4702 
u8
 *
´og¿m
, 
u32
 
´og¿m_Ën
)

4704 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4705 
sk_buff
 *
»q
;

4706 
sk_buff
 *
rx
;

4707 
r
 = 0;

4709 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4711 ià(!
ndev_vif
->
aùiv©ed
) {

4712 
	`SLSI_ERR
(
sdev
, "ndev_vif is‚ot‡ctivated\n");

4713 
r
 = -
EINVAL
;

4714 
ex™
;

4717 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) {

4718 
	`SLSI_ERR
(
sdev
, "vif_type is‚ot FAPI_VIFTYPE_STATION\n");

4719 
r
 = -
EINVAL
;

4720 
ex™
;

4723 
»q
 = 
	`çpi_®loc
(
mlme_š¡®l_­f_»q
, 
MLME_INSTALL_APF_REQ
, 
ndev_vif
->
iâum
, 
´og¿m_Ën
);

4724 ià(!
»q
) {

4725 
r
 = -
ENOMEM
;

4726 
ex™
;

4730 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_š¡®l_­f_»q
.
f‹r_mode
, 
FAPI_APFFILTERMODE_SUSPEND
);

4731 
	`çpi_­³nd_d©a
(
»q
, 
´og¿m
, 
´og¿m_Ën
);

4733 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_install_apf_req(vif:%u, filter_mode:%d)\n",

4734 
ndev_vif
->
iâum
, 
FAPI_APFFILTERMODE_SUSPEND
);

4735 
rx
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_INSTALL_APF_CFM
);

4736 ià(!
rx
) {

4737 
r
 = -
EIO
;

4738 
ex™
;

4741 ià(
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_š¡®l_­f_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4742 
	`SLSI_NET_ERR
(
dev
, "mlme_install_apf_cfm(result:0x%04x) ERROR\n",

4743 
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_š¡®l_­f_cfm
.
»suÉ_code
));

4744 
r
 = -
EINVAL
;

4747 
ex™
:

4748 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4749  
r
;

4750 
	}
}

4752 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


4753 
	$¦si_mlme_¬p_d‘eù_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
aùiÚ
, 
u8
 *
rg‘_addr
)

4755 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4756 
sk_buff
 *
»q
;

4757 
sk_buff
 *
rx
;

4758 
r
 = 0;

4759 
u32
 
add»ss
 = 0x0;

4760 
i
 = 0;

4762 ià(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
)) {

4763 
	`SLSI_ERR
(
sdev
, "ndev_vif mutex is‚ot†ocked\n");

4764 
r
 = -
EINVAL
;

4765 
ex™
;

4768 ià(!
ndev_vif
->
aùiv©ed
) {

4769 
	`SLSI_ERR
(
sdev
, "ndev_vif is‚ot‡ctivated\n");

4770 
r
 = -
EINVAL
;

4771 
ex™
;

4774 ià((
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
è&& (ndev_vif->
iáy³
 =ğ
NL80211_IFTYPE_STATION
)) {

4775 
	`SLSI_ERR
(
sdev
, "vif_type is‚ot FAPI_VIFTYPE_STATION\n");

4776 
r
 = -
EINVAL
;

4777 
ex™
;

4780 
»q
 = 
	`çpi_®loc
(
mlme_¬p_d‘eù_»q
, 
MLME_ARP_DETECT_REQ
, 
ndev_vif
->
iâum
, 0);

4781 ià(!
»q
) {

4782 
r
 = -
ENOMEM
;

4783 
ex™
;

4786 
i
 = 0; i < 4; i++)

4787 
add»ss
 = (add»s << 8è| (()
rg‘_addr
[
i
]);

4788 
add»ss
 = 
	`htÚl
(ipaddress);

4790 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_¬p_d‘eù_»q
.
¬p_d‘eù_aùiÚ
, 
aùiÚ
);

4791 
	`çpi_­³nd_d©a
(
»q
, (cÚ¡ 
u8
 *)&
add»ss
, 4);

4793 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_arp_detect_req(vif:%u,‡ction:%d IP Address:%d.%d.%d.%d)\n",

4794 
ndev_vif
->
iâum
, 
aùiÚ
,‚dev_vif->
rg‘__addr
[0],‚dev_vif->target_ip_addr[1],

4795 
ndev_vif
->
rg‘__addr
[2],‚dev_vif->target_ip_addr[3]);

4796 
rx
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_ARP_DETECT_CFM
);

4797 ià(!
rx
) {

4798 
r
 = -
EIO
;

4799 
ex™
;

4802 ià(
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_¬p_d‘eù_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4803 
	`SLSI_NET_ERR
(
dev
, "mlme_arp_detect_cfm(result:0x%04x) ERROR\n",

4804 
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_¬p_d‘eù_cfm
.
»suÉ_code
));

4805 
r
 = -
EINVAL
;

4808 
ex™
:

4809  
r
;

4810 
	}
}

4813 
	$¦si_mlme_¡¬t_d‘eù_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

4815 
sk_buff
 *
»q
;

4816 
sk_buff
 *
cfm
;

4817 
r
 = 0;

4819 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_¡¬t_d‘eù_»q(vif:%u)\n", 
SLSI_NET_INDEX_DETECT
);

4820 
»q
 = 
	`çpi_®loc
(
mlme_¡¬t_d‘eù_»q
, 
MLME_START_DETECT_REQ
, 
SLSI_NET_INDEX_DETECT
, 0);

4821 ià(!
»q
) {

4822 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

4823  -
ENOMEM
;

4826 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_START_DETECT_CFM
);

4827 ià(!
cfm
)

4828  -
EIO
;

4830 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_¡¬t_d‘eù_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4831 
	`SLSI_NET_ERR
(
dev
, "mlme_start_detect_cfm(result:0x%04x) ERROR\n",

4832 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_¡¬t_d‘eù_cfm
.
»suÉ_code
));

4833 
r
 = -
EINVAL
;

4836 
	`kä“_skb
(
cfm
);

4837  
r
;

4838 
	}
}

4840 
	#SLSI_TEST_CONFIG_MONITOR_MODE_DESCRIPTOR_SIZE
 (12)

	)

4841 
	$¦si_‹¡_§p_cÚfigu»_mÚ™Ü_mode
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
cfg80211_chª_def
 *
chªdef
)

4843 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4844 
sk_buff
 *
»q
;

4845 
sk_buff
 *
cfm
;

4846 
u8
 *
p
 = 
NULL
;

4847 
size_t
 
®loc_d©a_size
 = 0;

4848 
u16
 
ûÁ”_äeq1
;

4849 
u16
 
ûÁ”_äeq2
;

4850 
u16
 
chª_šfo
;

4851 
r
 = 0;

4853 cÚ¡ 
u8
 
mÚ™Ü_cÚfig_›_h—d”
[] = {

4861 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

4862 
	`SLSI_NET_WARN
(
dev
, "WlanLite: NOT supported\n");

4863  -
EOPNOTSUPP
;

4866 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4868 
chª_šfo
 = 
	`¦si_g‘_chªn_šfo
(
sdev
, 
chªdef
);

4869 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "test_configure_monitor_mode_req(center_freq1:%u, chan_info:%u, center_freq2:%u)\n",

4870 
chªdef
->
ûÁ”_äeq1
,

4871 
chª_šfo
,

4872 
chªdef
->
ûÁ”_äeq2
);

4874 
ûÁ”_äeq1
 = 
	`SLSI_FREQ_HOST_TO_FW
(
chªdef
->center_freq1);

4875 
ûÁ”_äeq1
 = 
	`ıu_to_Ë16
(center_freq1);

4876 
ûÁ”_äeq2
 = 
	`SLSI_FREQ_HOST_TO_FW
(
chªdef
->center_freq2);

4877 
ûÁ”_äeq2
 = 
	`ıu_to_Ë16
(center_freq2);

4879 
®loc_d©a_size
 = (
mÚ™Ü_cÚfig_›_h—d”
è+ 
SLSI_TEST_CONFIG_MONITOR_MODE_DESCRIPTOR_SIZE
;

4881 
»q
 = 
	`çpi_®loc
(
‹¡_cÚfigu»_mÚ™Ü_mode_»q
, 
TEST_CONFIGURE_MONITOR_MODE_REQ
, 
ndev_vif
->
iâum
, 
®loc_d©a_size
);

4882 ià(!
»q
) {

4883 
	`SLSI_NET_ERR
(
dev
, "çedØ®loøMÚ™Ü mod»que¡ (Ën:%d)\n", 
®loc_d©a_size
);

4884  -
ENOMEM
;

4887 
	`çpi_­³nd_d©a
(
»q
, 
mÚ™Ü_cÚfig_›_h—d”
, (monitor_config_ie_header));

4888 
	`çpi_­³nd_d©a
(
»q
, (cÚ¡ 
u8
 *)&
ûÁ”_äeq1
, 2);

4889 
	`çpi_­³nd_d©a
(
»q
, (cÚ¡ 
u8
 *)&
chª_šfo
, 2);

4890 
	`çpi_­³nd_d©a
(
»q
, (cÚ¡ 
u8
 *)&
ûÁ”_äeq2
, 2);

4893 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
NULL
, 6);

4894 ià(!
p
) {

4895 
	`SLSI_NET_ERR
(
dev
, "mac‡ddress filtering‡ppend failed\n");

4896 
	`kä“_skb
(
»q
);

4897  -
EINVAL
;

4899 
	`mem£t
(
p
, 0, 6);

4901 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
TEST_CONFIGURE_MONITOR_MODE_CFM
);

4902 ià(!
cfm
) {

4903 
	`SLSI_NET_ERR
(
dev
, "failedo„eceive Confirm\n");

4904  -
EIO
;

4907 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_chªÃl_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4908 
	`SLSI_NET_ERR
(
dev
, "test_configure_monitor_mode_cfm(result:0x%04x) ERROR\n",

4909 
	`çpi_g‘_u16
(
cfm
, 
u
.
‹¡_cÚfigu»_mÚ™Ü_mode_cfm
.
»suÉ_code
));

4910 
r
 = -
EINVAL
;

4913 
	`kä“_skb
(
cfm
);

4914  
r
;

4915 
	}
}

4917 
	$¦si_mlme_d–ba_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
³”_q¡a_add»ss
, 
u16
 
´iÜ™y
, u16 
dœeùiÚ
, u16 
£qu’û_numb”
, u16 
»asÚ_code
)

4919 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4920 
sk_buff
 *
»q
;

4921 
sk_buff
 *
cfm
;

4922 
r
 = 0;

4924 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

4925 
	`SLSI_NET_WARN
(
dev
, "WlanLite: NOT supported\n");

4926  -
EOPNOTSUPP
;

4929 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

4931 
»q
 = 
	`çpi_®loc
(
mlme_d–ba_»q
, 
MLME_DELBA_REQ
, 
ndev_vif
->
iâum
, 0);

4932 ià(!
»q
) {

4933 
	`SLSI_NET_ERR
(
dev
, "failedo‡lloc DELBA„equest\n");

4934  -
ENOMEM
;

4937 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_delba_req(vif:%d,…eer:%pM,…riority:%d, direction:%d, sn:%d,„eason_code:%d)\n",

4938 
ndev_vif
->
iâum
, 
³”_q¡a_add»ss
, 
´iÜ™y
, 
dœeùiÚ
, 
£qu’û_numb”
, 
»asÚ_code
);

4940 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_d–ba_»q
.
³”_q¡a_add»ss
,…eer_qsta_address);

4941 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_d–ba_»q
.
u£r_´iÜ™y
, 
´iÜ™y
);

4942 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_d–ba_»q
.
dœeùiÚ
, direction);

4943 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_d–ba_»q
.
£qu’û_numb”
, sequence_number);

4944 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_d–ba_»q
.
»asÚ
, 
»asÚ_code
);

4946 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_DELBA_CFM
);

4947 ià(!
cfm
) {

4948 
	`SLSI_NET_ERR
(
dev
, "failedo„eceive Confirm\n");

4949  -
EIO
;

4952 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_d–ba_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

4953 
	`SLSI_NET_ERR
(
dev
, "mlme_delba_cfm(result:0x%04x) ERROR\n",

4954 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_d–ba_cfm
.
»suÉ_code
));

4955 
r
 = -
EINVAL
;

4958 
	`kä“_skb
(
cfm
);

4959  
r
;

4960 
	}
}

4963 
	$¦si_mlme_£t_couÁry
(
¦si_dev
 *
sdev
, *
®pha2
)

4965 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

4966 
sk_buff
 *
»q
;

4967 
sk_buff
 *
cfm
;

4968 
couÁry_šdex
 = -1;

4969 
u32
 
ruËs_Ën
 = 0;

4970 
u16
 
couÁry_code
 = 0;

4971 
u8
 
­³nd_by‹
 = 0;

4972 
u8
 
dfs_»giÚ
 = 0;

4973 
i
 = 0;

4974 
”rÜ
 = 0;

4975 
äeq_¿nge
 = 0;

4977 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

4978 
	`SLSI_WARN
(
sdev
, "WlanLite: NOT supported\n");

4979  -
EOPNOTSUPP
;

4982 ià(
sdev
->
»gdb
.
»gdb_¡©e
 =ğ
SLSI_REG_DB_SET
) {

4983 
i
 = 0; i < 
sdev
->
»gdb
.
num_couÁr›s
; i++) {

4984 ià((
sdev
->
»gdb
.
couÁry
[
i
].
®pha2
[0] ==‡lpha2[0]) &&

4985 (
sdev
->
»gdb
.
couÁry
[
i
].
®pha2
[1] ==‡lpha2[1])) {

4986 
couÁry_šdex
 = 
i
;

4991 ià(
couÁry_šdex
 == -1) {

4992 
	`SLSI_ERR
(
sdev
, "Invalid country code!\n");

4993  -
EINVAL
;

4997 
ruËs_Ën
 = 7 * 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË_num
;

4998 
dfs_»giÚ
 = 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].dfs_region;

5002 
»q
 = 
	`çpi_®loc
(
mlme_£t_couÁry_»q
, 
MLME_SET_COUNTRY_REQ
, 0, 
ruËs_Ën
);

5003 ià(!
»q
)

5004  -
ENOMEM
;

5006 
couÁry_code
 = (((
u16
)
®pha2
[0] << 8) | (u16)alpha2[1]);

5007 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_couÁry_»q
.
couÁry_code
, country_code);

5008 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_couÁry_»q
.
dfs_»guÏtÜy_domaš
, 
dfs_»giÚ
);

5009 ià(
ruËs_Ën
) {

5010 
i
 = 0; i < 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË_num
; i++) {

5011 ià(
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË
[
i
]->
äeq_¿nge
->
¡¬t_äeq
 >= 57000)

5013 
­³nd_by‹
 = (
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË
[
i
]->
äeq_¿nge
->
¡¬t_äeq
 * 2) & 0xFF;

5014 
	`çpi_­³nd_d©a
(
»q
, &
­³nd_by‹
, 1);

5015 
­³nd_by‹
 = ((
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË
[
i
]->
äeq_¿nge
->
¡¬t_äeq
 * 2) >> 8) & 0xFF;

5016 
	`çpi_­³nd_d©a
(
»q
, &
­³nd_by‹
, 1);

5017 
­³nd_by‹
 = (
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË
[
i
]->
äeq_¿nge
->
’d_äeq
 * 2) & 0xFF;

5018 
	`çpi_­³nd_d©a
(
»q
, &
­³nd_by‹
, 1);

5019 
­³nd_by‹
 = ((
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË
[
i
]->
äeq_¿nge
->
’d_äeq
 * 2) >> 8) & 0xFF;

5020 
	`çpi_­³nd_d©a
(
»q
, &
­³nd_by‹
, 1);

5021 
äeq_¿nge
 = 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË
[
i
]->äeq_¿nge->
’d_äeq
 -

5022 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË
[
i
]->
äeq_¿nge
->
¡¬t_äeq
;

5023 ià(((
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË
[
i
]->
äeq_¿nge
->
¡¬t_äeq
 / 1000) == 5) &&

5024 
sdev
->
fÜûd_bªdwidth
 &&

5025 (
äeq_¿nge
 >ğ
sdev
->
fÜûd_bªdwidth
))

5026 
­³nd_by‹
 = 
sdev
->
fÜûd_bªdwidth
;

5028 
­³nd_by‹
 = 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË
[
i
]->
äeq_¿nge
->
max_bªdwidth
 & 0xFF;

5029 
	`çpi_­³nd_d©a
(
»q
, &
­³nd_by‹
, 1);

5030 
­³nd_by‹
 = 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË
[
i
]->
max_eœp
 & 0xFF;

5031 
	`çpi_­³nd_d©a
(
»q
, &
­³nd_by‹
, 1);

5032 
­³nd_by‹
 = 
sdev
->
»gdb
.
couÁry
[
couÁry_šdex
].
cŞËùiÚ
->
»g_ruË
[
i
]->
æags
 & 0xFF;

5033 
	`çpi_­³nd_d©a
(
»q
, &
­³nd_by‹
, 1);

5037 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "mlme_£t_couÁry_»q(couÁry:%c%c, dfs_»guÏtÜy_domaš:%x)\n", 
®pha2
[0],‡Íha2[1], 
dfs_»giÚ
);

5038 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
NULL
, 
»q
, 
MLME_SET_COUNTRY_CFM
);

5039 ià(!
cfm
)

5040  -
EIO
;

5042 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_couÁry_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

5043 
	`SLSI_ERR
(
sdev
, "mlme_set_country_cfm(result:0x%04x) ERROR\n",

5044 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_couÁry_cfm
.
»suÉ_code
));

5045 
	`kä“_skb
(
cfm
);

5046 
”rÜ
 = 
	`¦si_mib_’code_où‘
(&
mib_d©a
, 
SLSI_PSID_UNIFI_DEFAULT_COUNTRY
, 3, 
®pha2
, 0);

5047 ià(
”rÜ
 !ğ
SLSI_MIB_STATUS_SUCCESS
)

5048  -
ENOMEM
;

5050 ià(
	`WARN_ON
(
mib_d©a
.
d©aL’gth
 == 0))

5051  -
EINVAL
;

5053 
”rÜ
 = 
	`¦si_mlme_£t
(
sdev
, 
NULL
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

5054 ià(
”rÜ
)

5055  -
EINVAL
;

5057 
	`kä“
(
mib_d©a
.
d©a
);

5061 
	`kä“_skb
(
cfm
);

5063 
	}
}

5065 
	$¦si_mlme_£t_couÁry_fÜ_»cov”y
(
¦si_dev
 *
sdev
)

5067 
»t
 = 0;

5068 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

5070 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

5071 
»t
 = 
	`¦si_mib_’code_où‘
(&
mib_d©a
, 
SLSI_PSID_UNIFI_DEFAULT_COUNTRY
, 3, 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->
®pha2
, 0);

5072 ià(
»t
 !ğ
SLSI_MIB_STATUS_SUCCESS
) {

5073 
»t
 = -
ENOMEM
;

5074 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg couÁryƒ¼Ü = %d\n", 
»t
);

5075 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

5079 ià(
mib_d©a
.
d©aL’gth
 == 0) {

5080 
»t
 = -
EINVAL
;

5081 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg couÁryƒ¼Ü = %d\n", 
»t
);

5082 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

5086 
»t
 = 
	`¦si_mlme_£t
(
sdev
, 
NULL
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

5087 
	`kä“
(
mib_d©a
.
d©a
);

5089 ià(
»t
)

5090 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg couÁryƒ¼Ü = %d\n", 
»t
);

5091 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

5092 
	}
}

5094 #ifdeà
CONFIG_SCSC_WLAN_NUM_ANTENNAS


5096 
	$¦si_mlme_£t_num_ª‹Âas
(
Ãt_deviû
 *
dev
, cÚ¡ 
u16
 
num_of_ª‹Âas
, 
äame_ty³
)

5098 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5099 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

5100 
sk_buff
 *
»q
;

5101 
sk_buff
 *
cfm
;

5102 
»t
 = 0;

5103 cÚ¡ 
boŞ
 
is_¡a
 = (
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
);

5104 cÚ¡ 
boŞ
 
is_soá­
 = (
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_AP
);

5106 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

5108 ià(
num_of_ª‹Âas
 > 2 ||‚um_of_antennas == 0) {

5109 
	`SLSI_NET_ERR
(
dev
, "Inv®id‚um_of_ª‹Âa %hu\n", 
num_of_ª‹Âas
);

5110  -
EINVAL
;

5112 ià(
äame_ty³
 < 0 || frame_type > 2) {

5113 
	`SLSI_ERR
(
sdev
, "Inv®id f¿me_ty³: '%d'\n", 
äame_ty³
);

5114  -
EINVAL
;

5116 ià(!
is_¡a
 && !
is_soá­
) {

5117 
	`SLSI_NET_ERR
(
dev
, "Inv®id iÁ”çûy³ %s\n", dev->
Çme
);

5118  -
EPERM
;

5120 ià(
is_¡a
 && (
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
)) {

5121 
	`SLSI_NET_ERR
(
dev
, "sta is‚ot in connected state\n");

5122  -
EPERM
;

5124 
	`SLSI_NET_INFO
(
dev
, "SetNumAntennas(vif:%u NumAntenna:%u ftype:%d)\n",

5125 
ndev_vif
->
iâum
, 
num_of_ª‹Âas
, 
äame_ty³
);

5127 
»q
 = 
	`çpi_®loc
(
mlme_£t_num_ª‹Âas_»q
, 
MLME_SET_NUM_ANTENNAS_REQ
, 
ndev_vif
->
iâum
, 0);

5128 ià(!
»q
) {

5129 
	`SLSI_NET_ERR
(
dev
, "failedo‡lloc set‚um‡ntennas„equest\n");

5130  -
ENOMEM
;

5132 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_num_ª‹Âas_»q
.
vif
, 
ndev_vif
->
iâum
);

5133 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_num_ª‹Âas_»q
.
numb”_of_ª‹Âas
, 
num_of_ª‹Âas
);

5134 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t_num_ª‹Âas_»q
.
¥¬e_1
, 
äame_ty³
);

5135 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_NUM_ANTENNAS_CFM
);

5136 ià(!
cfm
)

5137  -
EIO
;

5139 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_num_ª‹Âas_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

5140 
	`SLSI_NET_ERR
(
dev
, "SetNumAntennasCfm(result:0x%04x) ERROR\n",

5141 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t_num_ª‹Âas_cfm
.
»suÉ_code
));

5142 
»t
 = -
EINVAL
;

5144 
	`kä“_skb
(
cfm
);

5145  
»t
;

5146 
	}
}

5149 
	$¦si_mlme_£t_muÉiÿ¡_
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
__be32
 
muÉiÿ¡__li¡
[], 
couÁ
)

5151 
sk_buff
 *
»q
;

5152 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5153 
sk_buff
 *
cfm
;

5154 
r
 = 0;

5155 
u32
 
addr
;

5156 
u8
 
muÉiÿ¡_add
[
ETH_ALEN
] = { 0xff, 0xff, 0xff, 0xff, 0xff, 0xff };

5157 
u8
 
Ëngth
 = 
couÁ
 * 4 + 5;

5158 
size_t
 
®loc_d©a_size
 = 0;

5159 
u8
 
çpi_›_g’”ic
[] = { 0xdd, 
Ëngth
, 0x00, 0x16, 0x32, 0x03, 0x01 };

5160 
i
 = 0;

5161 
u16
 
v”siÚ_šfo
 = 0x0100;

5163 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

5164 
	`SLSI_NET_INFO
(
dev
, "Skip sending signal, WlanLite FW does‚ot support MLME_SET_IP_ADDRESS.request\n");

5165  -
EOPNOTSUPP
;

5168 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

5170 
®loc_d©a_size
 = 
Ëngth
 + 2;

5171 
»q
 = 
	`çpi_®loc
(
mlme_£t__add»ss_»q
, 
MLME_SET_IP_ADDRESS_REQ
, 
ndev_vif
->
iâum
, 
®loc_d©a_size
);

5172 ià(!
»q
)

5173  -
ENOMEM
;

5175 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_£t__add»ss_»q
.
_v”siÚ
, 
v”siÚ_šfo
);

5176 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_£t__add»ss_»q
.
muÉiÿ¡_add»ss
, 
muÉiÿ¡_add
);

5178 
	`çpi_­³nd_d©a
(
»q
, 
çpi_›_g’”ic
, (fapi_ie_generic));

5179 
i
 = 0; i < 
couÁ
; i++) {

5180 
addr
 = 
	`htÚl
(
	`be32_to_ıu
(
muÉiÿ¡__li¡
[
i
]));

5181 
	`çpi_­³nd_d©a
(
»q
, (cÚ¡ 
u8
 *)(&
addr
), (ipaddr));

5184 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "¦si_mlme_£t__add»ss(vif: %d)\n", 
ndev_vif
->
iâum
);

5185 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_SET_IP_ADDRESS_CFM
);

5186 ià(!
cfm
)

5187  -
EIO
;

5189 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t__add»ss_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

5190 
	`SLSI_NET_ERR
(
dev
, "mlme_£t__add»ss_cfmÔesuÉ:0x%04xèERROR\n", 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_£t__add»ss_cfm
.
»suÉ_code
));

5191 
r
 = -
EINVAL
;

5193 
	`kä“_skb
(
cfm
);

5194  
r
;

5195 
	}
}

	@mlme.h

7 #iâdeà
__SLSI_MLME_H__


8 
	#__SLSI_MLME_H__


	)

10 
	~"dev.h
"

11 
	~"mib.h
"

13 
	e¦si_ac_šdex_wmm_³
 {

14 
	mAC_BE
,

15 
	mAC_BK
,

16 
	mAC_VI
,

17 
	mAC_VO


20 
	#SLSI_FREQ_FW_TO_HOST
(
f
è((fè/ 2)

	)

21 
	#SLSI_FREQ_HOST_TO_FW
(
f
è((fè* 2)

	)

23 
	#SLSI_SINFO_MIB_ACCESS_TIMEOUT
 (1000è

	)

25 
	#SLSI_WLAN_EID_VENDOR_SPECIFIC
 0xdd

	)

26 
	#SLSI_WLAN_EID_INTERWORKING
 107

	)

27 
	#SLSI_WLAN_EID_EXTENSION
 255

	)

29 
	#SLSI_WLAN_OUI_TYPE_WFA_HS20_IND
 0x10

	)

30 
	#SLSI_WLAN_OUI_TYPE_WFA_OSEN
 0x12

	)

31 
	#SLSI_WLAN_OUI_TYPE_WFA_MBO
 0x16

	)

33 
	#SLSI_WLAN_FAIL_WORK_TIMEOUT
 1500

	)

36 
	#SLSI_WLAN_EXT_CAPA2_BSS_TRANSISITION_ENABLED
 (
	`BIT
(3))

	)

37 
	#SLSI_WLAN_EXT_CAPA3_INTERWORKING_ENABLED
 (
	`BIT
(7))

	)

38 
	#SLSI_WLAN_EXT_CAPA4_QOS_MAP_ENABLED
 (
	`BIT
(0))

	)

39 
	#SLSI_WLAN_EXT_CAPA5_WNM_NOTIF_ENABLED
 (
	`BIT
(6))

	)

40 
	#SLSI_WLAN_EXT_CAPA2_QBSS_LOAD_ENABLED
 
	`BIT
(7)

	)

41 
	#SLSI_WLAN_EXT_CAPA1_PROXY_ARP_ENABLED
 
	`BIT
(4)

	)

42 
	#SLSI_WLAN_EXT_CAPA2_TFS_ENABLED
 
	`BIT
(0)

	)

43 
	#SLSI_WLAN_EXT_CAPA2_WNM_SLEEP_ENABLED
 
	`BIT
(1)

	)

44 
	#SLSI_WLAN_EXT_CAPA2_TIM_ENABLED
 
	`BIT
(2)

	)

45 
	#SLSI_WLAN_EXT_CAPA2_DMS_ENABLED
 
	`BIT
(4)

	)

48 
	#SLSI_WLAN_RM_CAPA0_LINK_MEASUREMENT_ENABLED
 
	`BIT
(0)

	)

49 
	#SLSI_WLAN_RM_CAPA0_NEIGHBOR_REPORT_ENABLED
 
	`BIT
(1)

	)

50 
	#SLSI_WLAN_RM_CAPA0_PASSIVE_MODE_ENABLED
 
	`BIT
(4)

	)

51 
	#SLSI_WLAN_RM_CAPA0_ACTIVE_MODE_ENABLED
 
	`BIT
(5)

	)

52 
	#SLSI_WLAN_RM_CAPA0_TABLE_MODE_ENABLED
 
	`BIT
(6)

	)

55 
	#SLSI_AP_EXT_CAPAB_IE_LEN_MAX
 12

	)

57 
	#SLSI_SCAN_DONE_IND_WAIT_TIMEOUT
 40000

	)

60 #iâdeà
WLAN_EID_COUNTRY


61 
	#WLAN_EID_COUNTRY
 7

	)

65 
	#SLSI_P2P_WILDCARD_SSID
 "DIRECT-"

	)

66 
	#SLSI_P2P_WILDCARD_SSID_LENGTH
 7

	)

67 
	#SLSI_P2P_SOCIAL_CHAN_COUNT
 3

	)

72 
	#SLSI_IS_P2P_SSID
(
ssid
, 
ssid_Ën
è((ssid_ËÀ>ğ
SLSI_P2P_WILDCARD_SSID_LENGTH
) && \

73 (
	`memcmp
(
ssid
, 
SLSI_P2P_WILDCARD_SSID
, 
SLSI_P2P_WILDCARD_SSID_LENGTH
è=ğ0))

	)

76 
	#SLSI_ACTION_FRAME_PUBLIC
 (
	`BIT
(4))

	)

77 
	#SLSI_ACTION_FRAME_VENDOR_SPEC_PROTECTED
 (
	`BIT
(30))

	)

78 
	#SLSI_ACTION_FRAME_VENDOR_SPEC
 (
	`BIT
(31))

	)

79 
	#SLSI_ACTION_FRAME_WMM
 (
	`BIT
(17))

	)

80 
	#SLSI_ACTION_FRAME_WNM
 (
	`BIT
(10))

	)

81 
	#SLSI_ACTION_FRAME_QOS
 (
	`BIT
(1))

	)

82 
	#SLSI_ACTION_FRAME_PROTECTED_DUAL
 
	`BIT
(9)

	)

83 
	#SLSI_ACTION_FRAME_RADIO_MEASUREMENT
 
	`BIT
(5)

	)

86 
	#SLSI_TX_RATE_NON_HT_1MBPS
 0x4001

	)

87 
	#SLSI_TX_RATE_NON_HT_6MBPS
 0x4004

	)

88 
	#SLSI_ROAMING_CHANNELS_MAX
 38

	)

90 
	#SLSI_WLAN_EID_WAPI
 68

	)

91 
	#SLSI_WLAN_EID_RSNX
 244

	)

98 
	#SLSI_FW_CHANNEL_DURATION_UNSPECIFIED
 (0x0000)

	)

99 
›“80211_suµÜ‹d_bªd
 
¦si_bªd_2ghz
;

100 
›“80211_suµÜ‹d_bªd
 
¦si_bªd_5ghz
;

101 
›“80211_¡a_vht_ÿp
 
¦si_vht_ÿp
;

104 
	#SLSI_MAX_PATTERN_DESC
 4

	)

105 
	#SLSI_PKT_DESC_FIXED_LEN
 2

	)

106 
	#SLSI_PKT_FILTER_ELEM_FIXED_LEN
 6

	)

107 
	#SLSI_PKT_FILTER_ELEM_HDR_LEN
 (2 + 
SLSI_PKT_FILTER_ELEM_FIXED_LEN
è

	)

108 
	#SLSI_MAX_PATTERN_LENGTH
 6

	)

111 
	#SLSI_DEFAULT_UNIFI_PEER_RX_RETRY_PACKETS
 0

	)

112 
	#SLSI_DEFAULT_UNIFI_PEER_RX_BC_MC_PACKETS
 0

	)

113 
	#SLSI_DEFAULT_UNIFI_PEER_BANDWIDTH
 -1

	)

114 
	#SLSI_DEFAULT_UNIFI_PEER_NSS
 0

	)

115 
	#SLSI_DEFAULT_UNIFI_PEER_RSSI
 1

	)

116 
	#SLSI_DEFAULT_UNIFI_PEER_TX_DATA_RATE
 0

	)

118 
	#SLSI_CHECK_TYPE
(
sdev
, 
»cv_ty³
, 
exp_ty³
) \

120 
v¬1
 = 
»cv_ty³
; \

121 
v¬2
 = 
exp_ty³
; \

122 ià(
v¬1
 !ğ
v¬2
) { \

123 
	`SLSI_WARN
(
sdev
, "Ty³ mism©ch,ƒx³ùed:%d„eûived:%d\n", 
v¬2
, 
v¬1
); \

125 } 0)

	)

127 
	s¦si_mlme_·‰”n_desc
 {

128 
u8
 
	moff£t
;

129 
u8
 
	mmask_Ëngth
;

130 
u8
 
	mmask
[
SLSI_MAX_PATTERN_LENGTH
];

131 
u8
 
	m·‰”n
[
SLSI_MAX_PATTERN_LENGTH
];

134 
	s¦si_mlme_pkt_f‹r_–em
 {

135 
u8
 
	mh—d”
[
SLSI_PKT_FILTER_ELEM_HDR_LEN
];

136 
u8
 
	mnum_·‰”n_desc
;

137 
¦si_mlme_·‰”n_desc
 
	m·‰”n_desc
[
SLSI_MAX_PATTERN_DESC
];

140 
u16
 
¦si_g‘_chªn_šfo
(
¦si_dev
 *
sdev
, 
cfg80211_chª_def
 *
chªdef
);

141 
¦si_check_chªÃliz©iÚ
(
¦si_dev
 *
sdev
, 
cfg80211_chª_def
 *
chªdef
,

142 
wifi_sh¬šg_chªÃl_sw™ched
);

143 
¦si_mlme_£t__add»ss
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

144 #ià
IS_ENABLED
(
CONFIG_IPV6
)

145 
¦si_mlme_£t_v6_add»ss
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

147 
¦si_mlme_£t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
»q
, 
»q_Ën
);

148 
¦si_mlme_g‘
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
»q
, 
»q_Ën
,

149 
u8
 *
»¥
, 
»¥_buf_Ën
, *
»¥_Ën
);

151 
¦si_mlme_add_vif
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
š‹rçû_add»ss
, u8 *
deviû_add»ss
);

152 
¦si_mlme_d–_vif
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

153 
¦si_mlme_add_d‘eù_vif
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
š‹rçû_add»ss
, u8 *
deviû_add»ss
);

154 
¦si_mlme_d–_d‘eù_vif
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

155 #ià
defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

156 
¦si_mlme_£t_fÜw¬d_b—cÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
aùiÚ
);

158 
¦si_mlme_£t_chªÃl
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
›“80211_chªÃl
 *
chª
, 
u16
 
du¿tiÚ
, u16 
š‹rv®
, u16 
couÁ
);

159 
¦si_­_obss_sÿn_dÚe_šd
(
Ãt_deviû
 *
dev
, 
Ãtdev_vif
 *
ndev_vif
);

161 
¦si_mlme_un£t_chªÃl_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

163 
u16
 
¦si_compu‹_chªn_šfo
(
¦si_dev
 *
sdev
, u16 
width
, u16 
ûÁ”_äeq0
, u16 
chªÃl_äeq
);

170 
¦si_mlme_add_sÿn
(
¦si_dev
 *
sdev
,

171 
Ãt_deviû
 *
dev
,

172 
u16
 
sÿn_ty³
,

173 
u16
 
»pÜt_mode
,

174 
u32
 
n_ssids
,

175 
cfg80211_ssid
 *
ssids
,

176 
u32
 
n_chªÃls
,

177 
›“80211_chªÃl
 *
chªÃls
[],

178 *
gsÿn_·¿m
,

179 cÚ¡ 
u8
 *
›s
,

180 
u16
 
›s_Ën
,

181 
boŞ
 
wa™_fÜ_šd
);

183 
¦si_mlme_add_sched_sÿn
(
¦si_dev
 *
sdev
,

184 
Ãt_deviû
 *
dev
,

185 
cfg80211_sched_sÿn_»que¡
 *
»que¡
,

186 cÚ¡ 
u8
 *
›s
,

187 
u16
 
›s_Ën
);

189 
¦si_mlme_d–_sÿn
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
sÿn_id
, 
boŞ
 
sÿn_timed_out
);

190 
¦si_mlme_¡¬t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
bssid
, 
cfg80211_­_£‰šgs
 *
£‰šgs
, cÚ¡ u8 *
w·_›_pos
, cÚ¡ u8 *
wmm_›_pos
, 
boŞ
 
­³nd_vht_›s
);

191 
¦si_mlme_cÚÃù
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
cfg80211_cÚÃù_·¿ms
 *
sme
, 
›“80211_chªÃl
 *
chªÃl
, cÚ¡ 
u8
 *
bssid
);

192 
¦si_mlme_£t_key
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
key_id
, u16 
key_ty³
, cÚ¡ 
u8
 *
add»ss
, 
key_·¿ms
 *
key
);

193 
¦si_mlme_g‘_key
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
key_id
, u16 
key_ty³
, 
u8
 *
£q
, *
£q_Ën
);

205 
¦si_mlme_discÚÃù
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
bssid
, 
u16
 
»asÚ_code
, 
boŞ
 
wa™_šd
);

206 
sk_buff
 *
¦si_mlme_rßmšg_chªÃl_li¡_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

207 
¦si_mlme_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

208 
sk_buff
 *
¦si_mlme_»q_no_cfm
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, sk_bufà*
skb
);

210 
sk_buff
 *
¦si_mlme_»q_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, sk_bufà*
skb
, 
u16
 
šd_id
);

212 
¦si_mlme_g‘_sšfo_mib
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

213 
¦si_³”
 *
³”
);

215 
¦si_mlme_cÚÃù_sÿn
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

216 
u32
 
n_ssids
, 
cfg80211_ssid
 *
ssids
, 
›“80211_chªÃl
 *
chªÃl
);

217 
¦si_mlme_pow”mgt
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
ps_mode
);

218 
¦si_mlme_pow”mgt_uÆocked
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
ps_mode
);

219 
¦si_mlme_»gi¡”_aùiÚ_äame
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
af_b™m­_aùive
, u32 
af_b™m­_su¥’ded
);

220 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


221 
¦si_mlme_synchrÚi£d_»¥Ú£
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

222 
cfg80211_ex‹º®_auth_·¿ms
 *
·¿ms
);

224 #ifdeà
CONFIG_SCSC_WLAN_NUM_ANTENNAS


225 
¦si_mlme_g‘_num_ª‹Âas
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, *
num_ª‹Âas
);

227 
¦si_mlme_chªÃl_sw™ch
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
ûÁ”_äeq
, u16 
chª_šfo
);

228 
¦si_mlme_add_šfo_–em’ts
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
pu½o£
, cÚ¡ 
u8
 *
›s
, cÚ¡ u16 
›s_Ën
);

229 
¦si_mlme_£nd_äame_mgmt
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
äame
, 
äame_Ën
, 
u16
 
d©a_desc
, u16 
msg_ty³
, u16 
ho¡_g
, u16 
äeq
, 
u32
 
dw–l_time
, u32 
³riod
);

230 
¦si_mlme_£nd_äame_d©a
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
u16
 
msg_ty³
,

231 
u16
 
ho¡_g
, 
u32
 
dw–l_time
, u32 
³riod
);

232 
¦si_mlme_wifish¬šg_³rm™‹d_chªÃls
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
³rm™‹d_chªÃls
);

233 
¦si_mlme_»£t_dw–l_time
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

234 
¦si_mlme_£t_·ck‘_f‹r
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
pkt_f‹r_Ën
, 
u8
 
num_f‹rs
, 
¦si_mlme_pkt_f‹r_–em
 *
pkt_f‹r_–ems
);

235 
¦si_mlme_cÚÃù_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

236 
¦si_mlme_cÚÃùed_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
³”_šdex
);

237 
¦si_mlme_rßmed_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

238 
¦si_mlme_£t_pmk
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
pmk
, 
u16
 
pmkËn
);

239 
¦si_mlme_rßm
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
bssid
, 
u16
 
äeq
);

240 
¦si_mlme_£t_ÿched_chªÃls
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
chªÃls_couÁ
, 
u8
 *
chªÃls
);

241 
¦si_mlme_tdls_³”_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
pid
, u16 
tdls_ev’t
);

242 
¦si_mlme_tdls_aùiÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, cÚ¡ 
u8
 *
³”
, 
aùiÚ
, 
u16
 
ûÁ”_äeq
, u16 
chª_šfo
);

243 
¦si_mlme_£t_aş
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
iâum
, 
Æ80211_aş_pŞicy
 
aş_pŞicy
, 
max_aş_’Œ›s
, 
mac_add»ss
 
mac_addrs
[]);

244 
¦si_mlme_£t_Œaffic_·¿m‘”s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
u£r_´iÜ™y
, u16 
medium_time
, u16 
mšimun_d©a_¿‹
, 
u8
 *
mac
);

245 
¦si_mlme_d–_Œaffic_·¿m‘”s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
u£r_´iÜ™y
);

246 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


247 
¦si_mlme_£t_²o_li¡
(
¦si_dev
 *
sdev
, 
couÁ
,

248 
¦si_•no_·¿m
 *
•no_·¿m
, 
¦si_•no_hs2_·¿m
 *
•no_hs2_·¿m
);

249 
¦si_mlme_¡¬t_lšk_¡©s_»q
(
¦si_dev
 *
sdev
, 
u16
 
mpdu_size_th»shŞd
, 
boŞ
 
agg»ssive_¡©is_’abËd
);

250 
¦si_mlme_¡İ_lšk_¡©s_»q
(
¦si_dev
 *
sdev
, 
u16
 
¡©s_¡İ_mask
);

251 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


252 
¦si_mlme_Çn_’abË
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_h®_Çn_’abË_»q
 *
h®_»q
);

253 
¦si_mlme_Çn_publish
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_h®_Çn_publish_»q
 *
h®_»q
,

254 
u16
 
publish_id
);

255 
¦si_mlme_Çn_subsüibe
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_h®_Çn_subsüibe_»q
 *
h®_»q
,

256 
u16
 
subsüibe_id
);

257 
¦si_mlme_Çn_tx_fŞlowup
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

258 
¦si_h®_Çn_Œªsm™_fŞlowup_»q
 *
h®_»q
);

259 
¦si_mlme_Çn_£t_cÚfig
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_h®_Çn_cÚfig_»q
 *
h®_»q
);

260 
¦si_mlme_ndp_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

261 
¦si_h®_Çn_d©a_·th_š™ŸtÜ_»q
 *
h®_»q
, 
u32
 
ndp_š¡ªû_id
, 
u16
 
ndl_vif_id
);

262 
¦si_mlme_ndp_»¥Ú£
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

263 
¦si_h®_Çn_d©a_·th_šdiÿtiÚ_»¥Ú£
 *
h®_»q
, 
u16
 
loÿl_ndp_š¡ªû_id
);

264 
¦si_mlme_ndp_‹rmš©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
ndp_š¡ªû_id
, u16 
Œª§ùiÚ_id
);

265 
¦si_mlme_Çn_¿nge_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 
couÁ
, 
¦si_¹t_cÚfig
 *
Æ_¹t_·¿ms
);

266 
¦si_mlme_Çn_¿nge_ÿnûl_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

270 
¦si_mlme_£t_ext_ÿ·b
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
d©a
, 
d©®’gth
);

271 
¦si_mlme_»assocŸ‹
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

272 
¦si_mlme_»assocŸ‹_»¥
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

273 
¦si_modify_›s
(
Ãt_deviû
 *
dev
, 
u8
 
eid
, u8 *
›s
, 
›s_Ën
, u8 
›_šdex
, u8 
›_v®ue
);

274 
¦si_mlme_£t_rssi_mÚ™Ü
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 
’abË
, 
s8
 
low_rssi_th»shŞd
, s8 
high_rssi_th»shŞd
);

275 
¦si_mib_v®ue
 *
¦si_»ad_mibs
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_mib_g‘_’Œy
 *
mib_’Œ›s
, 
mib_couÁ
, 
¦si_mib_d©a
 *
mibr¥
);

276 
¦si_mlme_£t_ho¡_¡©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
ho¡_¡©e
);

277 
¦si_mlme_»ad_­f_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 **
ho¡_d¡
, *
d©®’
);

278 
¦si_mlme_š¡®l_­f_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

279 
u8
 *
´og¿m
, 
u32
 
´og¿m_Ën
);

280 
¦si_mlme_£t_muÉiÿ¡_
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
__be32
 
muÉiÿ¡__li¡
[], 
couÁ
);

282 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


283 
¦si_mlme_¬p_d‘eù_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
aùiÚ
, 
u8
 *
addr
);

285 
¦si_mlme_¡¬t_d‘eù_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

286 
¦si_mlme_£t_ùwšdow
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
ù_·¿m
);

287 
¦si_mlme_£t_p2p_nß
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
nß_couÁ
,

288 
š‹rv®
, 
du¿tiÚ
);

289 
¦si_decode_fw_¿‹
(
u32
 
fw_¿‹
, 
¿‹_šfo
 *
¿‹
, *
d©a_¿‹_mbps
);

290 
¦si_‹¡_§p_cÚfigu»_mÚ™Ü_mode
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
cfg80211_chª_def
 *
chªdef
);

291 
¦si_mlme_d–ba_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
³”_q¡a_add»ss
, 
u16
 
´iÜ™y
, u16 
dœeùiÚ
, u16 
£qu’û_numb”
, u16 
»asÚ_code
);

294 
sk_buff
 *
¦si_mlme_»q_cfm
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, sk_bufà*
skb
, 
u16
 
cfm_id
);

295 
sk_buff
 *
¦si_mlme_»q_cfm_šd
(
¦si_dev
 *
sdev
,

296 
Ãt_deviû
 *
dev
,

297 
sk_buff
 *
skb
,

298 
u16
 
cfm_id
,

299 
u16
 
šd_id
,

300 
	$boŞ
 (*
v®id©e_cfm_wa™_šd
)(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
cfm
));

301 
	`¦si_mlme_£t_couÁry
(
¦si_dev
 *
sdev
, *
®pha2
);

302 
	`¦si_mlme_£t_rßmšg_·¿m‘”s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
psid
, 
mib_v®ue
, 
mib_Ëngth
);

303 
	`¦si_mlme_£t_bªd_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
ušt
 
bªd
);

304 
	`¦si_mlme_£t_sÿn_mode_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
sÿn_mode
, u16 
max_chªÃl_time
,

305 
u16
 
home_away_time
, u16 
home_time
, u16 
max_chªÃl_·ssive_time
);

306 
	`¦si_mlme_add_¿nge_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 
couÁ
, 
¦si_¹t_cÚfig
 *
Æ_¹t_·¿ms
,

307 
u16
 
¹t_id
, 
u8
 *
sourû_addr
);

308 
	`¦si_mlme_d–_¿nge_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
couÁ
, 
u8
 *
addr
, u16 
¹t_id
);

309 
	`¦si_mlme_£t_couÁry_fÜ_»cov”y
(
¦si_dev
 *
sdev
);

310 #ifdeà
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL


311 
	`¦si_rx_£nd_äame_cfm_async
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

313 #ifdeà
CONFIG_SCSC_WLAN_NUM_ANTENNAS


314 
	`¦si_mlme_£t_num_ª‹Âas
(
Ãt_deviû
 *
dev
, cÚ¡ 
u16
 
num_of_ª‹Âas
, 
äame_ty³
);

	@mlme_nan.c

7 
	~"debug.h
"

8 
	~"mlme.h
"

9 
	~"Æ80211_v’dÜ_Çn.h
"

11 
	#SLSI_FAPI_NAN_ATTRIBUTE_PUT_U8
(
»q
, 
©Œibu‹
, 
v®
) \

13 
u16
 
©Œibu‹_Ën
 = 1; \

14 
sk_buff
 *
»q_p
 = 
»q
; \

15 
	`çpi_­³nd_d©a
((
»q_p
), (
u8
 *)&(
©Œibu‹
), 2); \

16 
	`çpi_­³nd_d©a
((
»q_p
), (
u8
 *)&
©Œibu‹_Ën
, 2); \

17 
	`çpi_­³nd_d©a
((
»q_p
), (
u8
 *)&(
v®
), 1); \

18 }

	)

20 
	#SLSI_FAPI_NAN_ATTRIBUTE_PUT_U16
(
»q
, 
©Œibu‹
, 
v®
) \

22 
u16
 
©Œibu‹_Ën
 = 2; \

23 
__Ë16
 
Ë16v®
 = 
	`ıu_to_Ë16
(
v®
); \

24 
sk_buff
 *
»q_p
 = 
»q
; \

25 
	`çpi_­³nd_d©a
((
»q_p
), (
u8
 *)&(
©Œibu‹
), 2); \

26 
	`çpi_­³nd_d©a
((
»q_p
), (
u8
 *)&
©Œibu‹_Ën
, 2); \

27 
	`çpi_­³nd_d©a
((
»q_p
), (
u8
 *)&
Ë16v®
, 2); \

28 }

	)

30 
	#SLSI_FAPI_NAN_ATTRIBUTE_PUT_U32
(
»q
, 
©Œibu‹
, 
v®
) \

32 
u16
 
©Œibu‹_Ën
 = 4; \

33 
__Ë32
 
Ë32v®
 = 
	`ıu_to_Ë32
(
v®
);\

34 
sk_buff
 *
»q_p
 = 
»q
; \

35 
	`çpi_­³nd_d©a
((
»q_p
), (
u8
 *)&(
©Œibu‹
), 2); \

36 
	`çpi_­³nd_d©a
((
»q_p
), (
u8
 *)&
©Œibu‹_Ën
, 2); \

37 
	`çpi_­³nd_d©a
((
»q_p
), (
u8
 *)&
Ë32v®
, 4); \

38 }

	)

40 
	#SLSI_FAPI_NAN_ATTRIBUTE_PUT_DATA
(
»q
, 
©Œibu‹
, 
v®
, 
v®_Ën
) \

42 
u16
 
©Œibu‹_Ën
 = (
v®_Ën
); \

43 
sk_buff
 *
»q_p
 = 
»q
; \

44 
	`çpi_­³nd_d©a
((
»q_p
), (
u8
 *)&(
©Œibu‹
), 2); \

45 
	`çpi_­³nd_d©a
((
»q_p
), (
u8
 *)&
©Œibu‹_Ën
, 2); \

46 
	`çpi_­³nd_d©a
((
»q_p
), (
v®
), (
©Œibu‹_Ën
)); \

47 }

	)

49 
u32
 
	$¦si_mlme_Çn_­³nd_v
(
sk_buff
 *
»q
, 
u16
 
g
, u16 
Ën
, 
u8
 *
d©a
)

51 
u8
 *
p
;

53 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
g
);

54 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
Ën
);

55 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
d©a
, 
Ën
);

56 ià(
p
)

59 
	}
}

61 
u32
 
	$¦si_mlme_Çn_­³nd_£rviû_šfo_v
(
sk_buff
 *
»q
, 
¦si_h®_Çn_d©a_·th_­p_šfo
 *
­p_šfo
)

63 
pos
 = 0;

64 
u16
 
Ëngth
;

65 
»t
 = 1;

67 
pos
 < (
­p_šfo
->
ndp_­p_šfo_Ën
 - 3)) {

68 
Ëngth
 = 
­p_šfo
->
ndp_­p_šfo
[
pos
 + 2] << 8 |‡pp_info->ndp_app_info[pos + 1];

69 ià(
­p_šfo
->
ndp_­p_šfo
[
pos
] == 0x01) {

70 ià((
Ëngth
 + 
pos
 + 3è<ğ
­p_šfo
->
ndp_­p_šfo_Ën
)

71 
»t
 = 
	`¦si_mlme_Çn_­³nd_v
(
»q
, 
SLSI_NAN_TLV_WFA_SERVICE_INFO
, 
Ëngth
,

72 &
­p_šfo
->
ndp_­p_šfo
[
pos
 + 3]);

75 
pos
 =…o + 
Ëngth
 + 3;

77  
»t
;

78 
	}
}

80 
u16
 
	$¦si_mlme_Çn_£rviû_šfo_v_Ëngth
(
¦si_h®_Çn_d©a_·th_­p_šfo
 *
­p_šfo
)

82 
pos
 = 0;

83 
u16
 
Ëngth
 = 0;

85 
pos
 < (
­p_šfo
->
ndp_­p_šfo_Ën
 - 3)) {

86 ià(
­p_šfo
->
ndp_­p_šfo
[
pos
] == 0x01) {

87 
Ëngth
 = 
­p_šfo
->
ndp_­p_šfo
[
pos
 + 2] << 8 |‡pp_info->ndp_app_info[pos + 1];

91 
pos
 =…o + 
­p_šfo
->
ndp_­p_šfo
[pos + 1] + 3;

93  
Ëngth
;

94 
	}
}

96 
u32
 
	$¦si_mlme_Çn_­³nd_cÚfig_v
(
sk_buff
 *
»q
, 
u8
 
ma¡”_´ef
, 
u16
 
šşude_ps_id
, u8 
ps_id_couÁ
,

97 
u16
 
šşude_ss_id
, 
u8
 
ss_id_couÁ
, u16 
rssi_wšdow
, 
u32
 
nmi_¿nd_š‹rv®
,

98 
u16
 
şu¡”_m”ge
)

100 
u8
 *
p
;

102 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
SLSI_NAN_TLV_TAG_CONFIGURATION
);

103 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 0x000f);

104 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
ma¡”_´ef
);

107 
p
 = 
	`çpi_­³nd_d©a_boŞ
(
»q
, 
šşude_ps_id
);

108 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
ps_id_couÁ
);

111 
p
 = 
	`çpi_­³nd_d©a_boŞ
(
»q
, 
šşude_ss_id
);

112 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
ss_id_couÁ
);

114 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
rssi_wšdow
);

115 
p
 = 
	`çpi_­³nd_d©a_u32
(
»q
, 
nmi_¿nd_š‹rv®
);

116 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
şu¡”_m”ge
);

118 ià(
p
)

121 
	}
}

123 
u32
 
	$¦si_mlme_Çn_­³nd_bªd_¥ecific_cÚfig
(
sk_buff
 *
»q
, 
u16
 
g
, 
u8
 
rssi_şo£
, u8 
rssi_middË
,

124 
u8
 
rssi_´oxim™y
, u8 
dw–l_time
, 
u16
 
sÿn_³riod
,

125 
u16
 
u£_dw_št_v®
, 
u8
 
dw_š‹rv®
)

127 
u8
 *
p
;

129 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
g
);

130 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 0x0009);

131 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
rssi_şo£
);

132 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
rssi_middË
);

133 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
rssi_´oxim™y
);

134 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
dw–l_time
);

135 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
sÿn_³riod
);

136 
p
 = 
	`çpi_­³nd_d©a_boŞ
(
»q
, 
u£_dw_št_v®
);

137 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
dw_š‹rv®
);

138 ià(
p
)

141 
	}
}

143 
u32
 
	$¦si_mlme_Çn_­³nd_2g4_bªd_¥ecific_cÚfig
(
sk_buff
 *
»q
, 
u8
 
rssi_şo£
, u8 
rssi_middË
,

144 
u8
 
rssi_´oxim™y
, u8 
dw–l_time
, 
u16
 
sÿn_³riod
,

145 
u16
 
u£_dw_št_v®
, 
u8
 
dw_š‹rv®
)

147  
	`¦si_mlme_Çn_­³nd_bªd_¥ecific_cÚfig
(
»q
, 
SLSI_NAN_TLV_TAG_2G4_BAND_SPECIFIC_CONFIG
, 
rssi_şo£
,

148 
rssi_middË
, 
rssi_´oxim™y
, 
dw–l_time
, 
sÿn_³riod
,

149 
u£_dw_št_v®
, 
dw_š‹rv®
);

150 
	}
}

152 
u32
 
	$¦si_mlme_Çn_­³nd_5g_bªd_¥ecific_cÚfig
(
sk_buff
 *
»q
, 
u8
 
rssi_şo£
, u8 
rssi_middË
,

153 
u8
 
rssi_´oxim™y
, u8 
dw–l_time
, 
u16
 
sÿn_³riod
,

154 
u16
 
u£_dw_št_v®
, 
u8
 
dw_š‹rv®
)

156  
	`¦si_mlme_Çn_­³nd_bªd_¥ecific_cÚfig
(
»q
, 
SLSI_NAN_TLV_TAG_5G_BAND_SPECIFIC_CONFIG
, 
rssi_şo£
,

157 
rssi_middË
, 
rssi_´oxim™y
, 
dw–l_time
, 
sÿn_³riod
,

158 
u£_dw_št_v®
, 
dw_š‹rv®
);

159 
	}
}

161 
u32
 
	$¦si_mlme_Çn_­³nd_cÚfig_suµËm’l
(
sk_buff
 *
»q
, 
u32
 
db_š‹rv®_ms
, u32 
nss_discov”y
,

162 
u32
 
’abË_dw_—¾y_‹rmš©iÚ
, u32 
’abË_¿ngšg
)

164 
u8
 *
p
;

166 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
SLSI_NAN_TLV_TAG_CONFIG_SUPPLEMENTAL
);

167 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 0x0007);

168 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
db_š‹rv®_ms
);

169 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
nss_discov”y
);

170 
p
 = 
	`çpi_­³nd_d©a_boŞ
(
»q
, 
’abË_dw_—¾y_‹rmš©iÚ
);

171 
p
 = 
	`çpi_­³nd_d©a_boŞ
(
»q
, 
’abË_¿ngšg
);

172 ià(
p
)

175 
	}
}

177 
u32
 
	$¦si_mlme_Çn_­³nd_discov”y_cÚfig
(
sk_buff
 *
»q
, 
u8
 
sd_ty³
, u8 
tx_ty³
, 
u16
 
‰l
, u16 
dw_³riod
,

178 
u8
 
dw_couÁ
, u8 
disc_m©ch_šd
, 
u16
 
u£_rssi_th»s
, u16 
¿ngšg_»q
,

179 
u16
 
d©a_·th_»q
)

181 
u8
 *
p
;

183 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
SLSI_NAN_TLV_TAG_DISCOVERY_COMMON_SPECIFIC
);

184 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 0x000e);

185 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
sd_ty³
);

186 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
tx_ty³
);

187 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
‰l
);

188 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
dw_³riod
);

189 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
dw_couÁ
);

190 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
disc_m©ch_šd
);

191 
p
 = 
	`çpi_­³nd_d©a_boŞ
(
»q
, 
u£_rssi_th»s
);

192 
p
 = 
	`çpi_­³nd_d©a_boŞ
(
»q
, 
¿ngšg_»q
);

193 
p
 = 
	`çpi_­³nd_d©a_boŞ
(
»q
, 
d©a_·th_»q
);

194 ià(
p
)

197 
	}
}

199 
u32
 
	$¦si_mlme_Çn_­³nd_subsüibe_¥ecific
(
sk_buff
 *
»q
, 
u8
 
¤f_ty³
, 
u16
 
»¥Úd_if_š_add»ss_£t
,

200 
u16
 
u£_¤f
, u16 
ssi_»quœed_fÜ_m©ch
)

202 
u8
 *
p
;

204 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
SLSI_NAN_TLV_TAG_SUBSCRIBE_SPECIFIC
);

205 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 0x0007);

206 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
¤f_ty³
);

207 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
»¥Úd_if_š_add»ss_£t
);

208 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
u£_¤f
);

209 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
ssi_»quœed_fÜ_m©ch
);

210 ià(
p
)

213 
	}
}

215 
u32
 
	$¦si_mlme_Çn_­³nd_add»ss_£t
(
sk_buff
 *
»q
, 
u16
 
couÁ
, 
u8
 *
add»s£s
)

217 ià(!
couÁ
)

219  
	`¦si_mlme_Çn_­³nd_v
(
»q
, 
SLSI_NAN_TLV_TAG_INTERFACE_ADDRESS_SET
, 
couÁ
 * 6, 
add»s£s
);

220 
	}
}

222 
u32
 
	$¦si_mlme_Çn_­³nd_£rviû_Çme
(
sk_buff
 *
»q
, 
u16
 
Ën
, 
u8
 *
d©a
)

224 ià(!
Ën
)

226  
	`¦si_mlme_Çn_­³nd_v
(
»q
, 
SLSI_NAN_TLV_TAG_SERVICE_NAME
, 
Ën
, 
d©a
);

227 
	}
}

229 
u32
 
	$¦si_mlme_Çn_­³nd_£rviû_¥ecific_šfo
(
sk_buff
 *
»q
, 
u16
 
Ën
, 
u8
 *
d©a
)

231 ià(!
Ën
)

233  
	`¦si_mlme_Çn_­³nd_v
(
»q
, 
SLSI_NAN_TLV_TAG_SERVICE_SPECIFIC_INFO
, 
Ën
, 
d©a
);

234 
	}
}

236 
u32
 
	$¦si_mlme_Çn_­³nd_ext_£rviû_¥ecific_šfo
(
sk_buff
 *
»q
, 
u16
 
Ën
, 
u8
 *
d©a
)

238 ià(!
Ën
)

240  
	`¦si_mlme_Çn_­³nd_v
(
»q
, 
SLSI_NAN_TLV_TAG_EXT_SERVICE_SPECIFIC_INFO
, 
Ën
, 
d©a
);

241 
	}
}

243 
u32
 
	$¦si_mlme_Çn_­³nd_tx_m©ch_f‹r
(
sk_buff
 *
»q
, 
u16
 
Ën
, 
u8
 *
d©a
)

245 ià(!
Ën
)

247  
	`¦si_mlme_Çn_­³nd_v
(
»q
, 
SLSI_NAN_TLV_TAG_TX_MATCH_FILTER
, 
Ën
, 
d©a
);

248 
	}
}

250 
u32
 
	$¦si_mlme_Çn_­³nd_rx_m©ch_f‹r
(
sk_buff
 *
»q
, 
u16
 
Ën
, 
u8
 *
d©a
)

252 ià(!
Ën
)

254  
	`¦si_mlme_Çn_­³nd_v
(
»q
, 
SLSI_NAN_TLV_TAG_RX_MATCH_FILTER
, 
Ën
, 
d©a
);

255 
	}
}

257 
u32
 
	$¦si_mlme_Çn_­³nd_d©a_·th_£c
(
sk_buff
 *
»q
, 
¦si_Çn_£cur™y_šfo
 *
£c_šfo
)

259 
u8
 *
p
, *
Ën_p
;

260 
u8
 *
pmk
;

261 
u8
 
·s¥h¿£_Ën
 = 0;

262 
u8
 *
·s¥h¿£
;

263 
u8
 
£c_ty³
 = 
£c_šfo
->
key_šfo
.
key_ty³
;

264 
u8
 
pmk_Ën
 = 0;

266 ià(
£c_šfo
->
key_šfo
.
key_ty³
 == 1) {

267 
pmk_Ën
 = 
£c_šfo
->
key_šfo
.
body
.
pmk_šfo
.pmk_len;

268 
pmk
 = 
£c_šfo
->
key_šfo
.
body
.
pmk_šfo
.pmk;

269 } ià(
£c_šfo
->
key_šfo
.
key_ty³
 == 2) {

270 
·s¥h¿£_Ën
 = 
£c_šfo
->
key_šfo
.
body
.
·s¥h¿£_šfo
.passphrase_len;

271 
·s¥h¿£
 = 
£c_šfo
->
key_šfo
.
body
.
·s¥h¿£_šfo
.passphrase;

273 
£c_ty³
 = 0;

276 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
SLSI_NAN_TLV_TAG_DATA_PATH_SECURITY
);

277 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 0x0002);

278 
Ën_p
 = 
p
;

279 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
£c_ty³
);

280 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
£c_šfo
->
ch”_ty³
);

281 ià(
£c_šfo
->
key_šfo
.
key_ty³
 == 1) {

282 ià(
pmk_Ën
)

283 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
pmk
, 
pmk_Ën
);

284 ià(
p
 && 
Ën_p
)

285 *
Ën_p
 = 2 + 
pmk_Ën
;

286 } ià(
£c_šfo
->
key_šfo
.
key_ty³
 == 2) {

287 ià(
·s¥h¿£_Ën
)

288 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
·s¥h¿£
, 
·s¥h¿£_Ën
);

289 ià(
p
 && 
Ën_p
)

290 *
Ën_p
 = 2 + 
·s¥h¿£_Ën
;

292 ià(!
p
)

295 
	}
}

297 
u32
 
	$¦si_mlme_Çn_­³nd_¿ngšg
(
sk_buff
 *
»q
, 
¦si_Çn_¿ngšg_cfg
 *
¿ngšg_cfg
)

299 
u8
 *
p
;

301 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
SLSI_NAN_TLV_TAG_RANGING
);

302 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 0x000d);

303 
p
 = 
	`çpi_­³nd_d©a_u32
(
»q
, 
¿ngšg_cfg
->
¿ngšg_š‹rv®_m£c
);

304 
p
 = 
	`çpi_­³nd_d©a_u8
(
»q
, 
¿ngšg_cfg
->
cÚfig_¿ngšg_šdiÿtiÚs
);

305 
p
 = 
	`çpi_­³nd_d©a_u32
(
»q
, 
¿ngšg_cfg
->
di¡ªû_šg»ss_mm
);

306 
p
 = 
	`çpi_­³nd_d©a_u32
(
»q
, 
¿ngšg_cfg
->
di¡ªû_eg»ss_mm
);

307 ià(
p
)

310 
	}
}

312 
	$¦si_mlme_Çn_­³nd_v6_lšk_v
(
sk_buff
 *
»q
, 
u8
 *
loÿl_ndi
)

314 
u8
 *
p
;

315 
u8
 
š‹rçû_id’tif›r
[8];

317 
	`memıy
(&
š‹rçû_id’tif›r
[0], &
loÿl_ndi
[0], 3);

318 
š‹rçû_id’tif›r
[3] = 0xFF;

319 
š‹rçû_id’tif›r
[4] = 0xFE;

320 
	`memıy
(&
š‹rçû_id’tif›r
[5], &
loÿl_ndi
[3], 3);

322 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 
SLSI_NAN_TLV_WFA_IPV6_LOCAL_LINK
);

323 
p
 = 
	`çpi_­³nd_d©a_u16
(
»q
, 0x0008);

324 
p
 = 
	`çpi_­³nd_d©a
(
»q
, 
š‹rçû_id’tif›r
, 8);

326 ià(
p
)

329 
	}
}

331 
u32
 
	$¦si_mlme_Çn_’abË_çpi_d©a
(
Ãtdev_vif
 *
ndev_vif
, 
sk_buff
 *
»q
, 
¦si_h®_Çn_’abË_»q
 *
h®_»q
,

332 
u8
 
şu¡”_m”ge
)

334 
u16
 
publish_id_šc
, 
£rviû_id_šc
;

335 
u8
 
publish_id_šc_couÁ
 = 0;

336 
u8
 
£rviû_id_šc_couÁ
 = 0;

337 
u8
 
rssi_şo£
, 
rssi_middË
, 
rssi_´oxim™y
;

338 
u16
 
rssi_wšdow
 = 
h®_»q
->
cÚfig_rssi_wšdow_size
 ? h®_»q->
rssi_wšdow_size_v®
 : 8;

339 
u32
 
»t
;

342 
publish_id_šc
 = 
h®_»q
->
cÚfig_sid_b—cÚ
 && (h®_»q->
sid_b—cÚ_v®
 & 0x01);

343 ià(
publish_id_šc
)

344 
publish_id_šc_couÁ
 = 
h®_»q
->
sid_b—cÚ_v®
 >> 1;

345 
£rviû_id_šc
 = 
h®_»q
->
cÚfig_subsüibe_sid_b—cÚ
 && (h®_»q->
subsüibe_sid_b—cÚ_v®
 & 0x01);

346 ià(
£rviû_id_šc
)

347 
£rviû_id_šc_couÁ
 = 
h®_»q
->
subsüibe_sid_b—cÚ_v®
 >> 1;

348 
»t
 = 
	`¦si_mlme_Çn_­³nd_cÚfig_v
(
»q
, 
h®_»q
->
ma¡”_´ef
, 
publish_id_šc
, 
publish_id_šc_couÁ
,

349 
£rviû_id_šc
, 
£rviû_id_šc_couÁ
, 
rssi_wšdow
,

350 
h®_»q
->
disc_mac_addr_¿nd_š‹rv®_£c
, 
şu¡”_m”ge
);

351 ià(
»t
) {

352 
	`SLSI_WARN_NODEV
("Error‡ppend config TLV\n");

353  
»t
;

357 
rssi_şo£
 = 
h®_»q
->
cÚfig_2dÙ4g_rssi_şo£
 ? h®_»q->
rssi_şo£_2dÙ4g_v®
 : 0;

358 
rssi_middË
 = 
h®_»q
->
cÚfig_2dÙ4g_rssi_middË
 ? h®_»q->
rssi_middË_2dÙ4g_v®
 : 0;

359 
rssi_´oxim™y
 = 
h®_»q
->
cÚfig_2dÙ4g_rssi_´oxim™y
 ? h®_»q->
rssi_´oxim™y_2dÙ4g_v®
 : 0;

360 
»t
 = 
	`¦si_mlme_Çn_­³nd_2g4_bªd_¥ecific_cÚfig
(
»q
, 
rssi_şo£
, 
rssi_middË
, 
rssi_´oxim™y
,

361 
h®_»q
->
sÿn_·¿ms_v®
.
dw–l_time
[0],

362 
h®_»q
->
sÿn_·¿ms_v®
.
sÿn_³riod
[0],

363 (
u16
)
h®_»q
->
cÚfig_2dÙ4g_dw_bªd
,

364 
h®_»q
->
dw_2dÙ4g_š‹rv®_v®
);

365 ià(
»t
) {

366 
	`SLSI_WARN_NODEV
("Error‡ppend 2.4G band specific TLV\n");

367  
»t
;

371 ià(
h®_»q
->
cÚfig_suµÜt_5g
 && h®_»q->
suµÜt_5g_v®
) {

372 
rssi_şo£
 = 
h®_»q
->
cÚfig_5g_rssi_şo£
 ? h®_»q->
rssi_şo£_5g_v®
 : 0;

373 
rssi_middË
 = 
h®_»q
->
cÚfig_5g_rssi_middË
 ? h®_»q->
rssi_middË_5g_v®
 : 0;

374 
rssi_´oxim™y
 = 
h®_»q
->
cÚfig_5g_rssi_şo£_´oxim™y
 ? h®_»q->
rssi_şo£_´oxim™y_5g_v®
 : 0;

375 
»t
 = 
	`¦si_mlme_Çn_­³nd_5g_bªd_¥ecific_cÚfig
(
»q
, 
rssi_şo£
, 
rssi_middË
, 
rssi_´oxim™y
,

376 
h®_»q
->
sÿn_·¿ms_v®
.
dw–l_time
[1],

377 
h®_»q
->
sÿn_·¿ms_v®
.
sÿn_³riod
[1],

378 (
u16
)
h®_»q
->
cÚfig_5g_dw_bªd
,

379 
h®_»q
->
dw_5g_š‹rv®_v®
);

380 ià(
»t
) {

381 
	`SLSI_WARN_NODEV
("Error‡ppend 5G band specific TLV\n");

382  
»t
;

386 
»t
 = 
	`¦si_mlme_Çn_­³nd_cÚfig_suµËm’l
(
»q
, 
h®_»q
->
discov”y_b—cÚ_š‹rv®_ms
,

387 
h®_»q
->
nss_discov”y
, h®_»q->
’abË_dw_—¾y_‹rmš©iÚ
,

388 
h®_»q
->
’abË_¿ngšg
);

389 ià(
»t
) {

390 
	`SLSI_WARN_NODEV
("Failedo‡dd config supplemental TLV\n");

391  
»t
;

394  
»t
;

395 
	}
}

397 
	$¦si_mlme_Çn_¡Üe_cÚfig
(
Ãtdev_vif
 *
ndev_vif
, 
¦si_h®_Çn_’abË_»q
 *
h®_»q
)

399 
ndev_vif
->
Çn
.
cÚfig
.
cÚfig_rssi_´oxim™y
 = 
h®_»q
->
cÚfig_2dÙ4g_rssi_´oxim™y
;

400 
ndev_vif
->
Çn
.
cÚfig
.
rssi_şo£_2dÙ4g_v®
 = 
h®_»q
->rssi_close_2dot4g_val;

401 
ndev_vif
->
Çn
.
cÚfig
.
rssi_middË_2dÙ4g_v®
 = 
h®_»q
->rssi_middle_2dot4g_val;

402 
ndev_vif
->
Çn
.
cÚfig
.
rssi_´oxim™y
 = 
h®_»q
->
rssi_´oxim™y_2dÙ4g_v®
;

403 
ndev_vif
->
Çn
.
cÚfig
.
sÿn_·¿ms_v®
.
dw–l_time
[0] = 
h®_»q
->scan_params_val.dwell_time[0];

404 
ndev_vif
->
Çn
.
cÚfig
.
sÿn_·¿ms_v®
.
sÿn_³riod
[0] = 
h®_»q
->scan_params_val.scan_period[0];

405 
ndev_vif
->
Çn
.
cÚfig
.
cÚfig_2dÙ4g_dw_bªd
 = (
u16
)
h®_»q
->config_2dot4g_dw_band;

406 
ndev_vif
->
Çn
.
cÚfig
.
dw_2dÙ4g_š‹rv®_v®
 = 
h®_»q
->dw_2dot4g_interval_val;

408 
ndev_vif
->
Çn
.
cÚfig
.
cÚfig_5g_rssi_şo£_´oxim™y
 = 
h®_»q
->config_5g_rssi_close_proximity;

409 
ndev_vif
->
Çn
.
cÚfig
.
rssi_şo£_5g_v®
 = 
h®_»q
->rssi_close_5g_val;

410 
ndev_vif
->
Çn
.
cÚfig
.
rssi_middË_5g_v®
 = 
h®_»q
->rssi_middle_5g_val;

411 
ndev_vif
->
Çn
.
cÚfig
.
rssi_şo£_´oxim™y_5g_v®
 = 
h®_»q
->rssi_close_proximity_5g_val;

412 
ndev_vif
->
Çn
.
cÚfig
.
sÿn_·¿ms_v®
.
dw–l_time
[1] = 
h®_»q
->scan_params_val.dwell_time[1];

413 
ndev_vif
->
Çn
.
cÚfig
.
sÿn_·¿ms_v®
.
sÿn_³riod
[1] = 
h®_»q
->scan_params_val.scan_period[1];

414 
ndev_vif
->
Çn
.
cÚfig
.
cÚfig_5g_dw_bªd
 = (
u16
)
h®_»q
->config_5g_dw_band;

415 
ndev_vif
->
Çn
.
cÚfig
.
dw_5g_š‹rv®_v®
 = 
h®_»q
->dw_5g_interval_val;

416 
ndev_vif
->
Çn
.
¡©e
 = 1;

417 
	}
}

419 
	$¦si_mlme_Çn_’abË
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_h®_Çn_’abË_»q
 *
h®_»q
)

421 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

422 
sk_buff
 *
»q
;

423 
sk_buff
 *
cfm
;

424 
r
 = 0;

425 
u16
 
Çn_İ”_ù¾
 = 0;

427 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "\n");

430 
»q
 = 
	`çpi_®loc
(
mlme_Çn_¡¬t_»q
, 
MLME_NAN_START_REQ
, 
ndev_vif
->
iâum
, 56);

431 ià(!
»q
) {

432 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

433  -
ENOMEM
;

436 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_Çn_¡¬t_»q
.
Çn_İ”©iÚ_cÚŒŞ_æags
, 
Çn_İ”_ù¾
);

437 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_Çn_¡¬t_»q
.
¥¬e_1
, 
h®_»q
->
Œª§ùiÚ_id
);

439 
r
 = 
	`¦si_mlme_Çn_’abË_çpi_d©a
(
ndev_vif
, 
»q
, 
h®_»q
, !ndev_vif->
Çn
.
di§bË_şu¡”_m”ge
);

440 ià(
r
) {

441 
	`SLSI_NET_ERR
(
dev
, "Failedo construct mbulkdata\n");

442 
	`kä“_skb
(
»q
);

443  -
EINVAL
;

446 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_NAN_START_CFM
);

447 ià(!
cfm
)

448  -
EIO
;

450 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_¡¬t_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

451 
	`SLSI_NET_ERR
(
dev
, "MLME_NAN_START_CFM(result:0x%04x) ERROR\n",

452 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_¡¬t_cfm
.
»suÉ_code
));

453 
r
 = -
EINVAL
;

455 ià(!
r
)

456 
	`¦si_mlme_Çn_¡Üe_cÚfig
(
ndev_vif
, 
h®_»q
);

457 
	`kä“_skb
(
cfm
);

458  
r
;

459 
	}
}

461 
u32
 
	$¦si_mlme_Çn_publish_çpi_d©a
(
sk_buff
 *
»q
, 
¦si_h®_Çn_publish_»q
 *
h®_»q
)

463 
u32
 
»t
;

465 
»t
 = 
	`¦si_mlme_Çn_­³nd_discov”y_cÚfig
(
»q
, 
h®_»q
->
publish_ty³
, h®_»q->
tx_ty³
, h®_»q->
‰l
,

466 
h®_»q
->
³riod
, h®_»q->
publish_couÁ
, h®_»q->
publish_m©ch_šdiÿtÜ
,

467 (
u16
)
h®_»q
->
rssi_th»shŞd_æag
, (u16)h®_»q->
sd—_·¿ms
.
¿ngšg_¡©e
,

468 (
u16
)
h®_»q
->
sd—_·¿ms
.
cÚfig_Çn_d©a_·th
);

469 ià(
»t
) {

470 
	`SLSI_WARN_NODEV
("Error‡ppend disovery config TLV\n");

471  
»t
;

474 ià(
h®_»q
->
£rviû_Çme_Ën
) {

475 
»t
 = 
	`¦si_mlme_Çn_­³nd_£rviû_Çme
(
»q
, 
h®_»q
->
£rviû_Çme_Ën
, h®_»q->
£rviû_Çme
);

476 ià(
»t
) {

477 
	`SLSI_WARN_NODEV
("Error‡ppend servicename TLV\n");

478  
»t
;

482 ià(
h®_»q
->
£rviû_¥ecific_šfo_Ën
) {

483 
»t
 = 
	`¦si_mlme_Çn_­³nd_£rviû_¥ecific_šfo
(
»q
, 
h®_»q
->
£rviû_¥ecific_šfo_Ën
,

484 
h®_»q
->
£rviû_¥ecific_šfo
);

485 ià(
»t
) {

486 
	`SLSI_WARN_NODEV
("Error‡ppend servSpecInfo TLV\n");

487  
»t
;

491 ià(
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
) {

492 
»t
 = 
	`¦si_mlme_Çn_­³nd_ext_£rviû_¥ecific_šfo
(
»q
, 
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
,

493 
h®_»q
->
sd—_£rviû_¥ecific_šfo
);

494 ià(
»t
) {

495 
	`SLSI_WARN_NODEV
("Error‡ppendƒxtServSpecInfo TLV\n");

496  
»t
;

500 ià(
h®_»q
->
rx_m©ch_f‹r_Ën
) {

501 
»t
 = 
	`¦si_mlme_Çn_­³nd_rx_m©ch_f‹r
(
»q
, 
h®_»q
->
rx_m©ch_f‹r_Ën
, h®_»q->
rx_m©ch_f‹r
);

502 ià(
»t
) {

503 
	`SLSI_WARN_NODEV
("Error‡ppend„x match filter TLV\n");

504  
»t
;

508 ià(
h®_»q
->
tx_m©ch_f‹r_Ën
) {

509 
»t
 = 
	`¦si_mlme_Çn_­³nd_tx_m©ch_f‹r
(
»q
, 
h®_»q
->
tx_m©ch_f‹r_Ën
, h®_»q->
tx_m©ch_f‹r
);

510 ià(
»t
) {

511 
	`SLSI_WARN_NODEV
("Error‡ppendx match filter TLV\n");

512  
»t
;

516 ià(
h®_»q
->
sd—_·¿ms
.
cÚfig_Çn_d©a_·th
) {

517 
»t
 = 
	`¦si_mlme_Çn_­³nd_d©a_·th_£c
(
»q
, &
h®_»q
->
£c_šfo
);

518 ià(
»t
) {

519 
	`SLSI_WARN_NODEV
("Error‡ppend datapath sec TLV\n");

520  
»t
;

523 ià(
h®_»q
->
sd—_·¿ms
.
¿ngšg_¡©e
) {

524 
»t
 = 
	`¦si_mlme_Çn_­³nd_¿ngšg
(
»q
, &
h®_»q
->
¿ngšg_cfg
);

525 ià(
»t
)

526 
	`SLSI_WARN_NODEV
("Error‡ppend„anging config TLV\n");

528  
»t
;

529 
	}
}

531 
	$¦si_mlme_Çn_publish
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_h®_Çn_publish_»q
 *
h®_»q
,

532 
u16
 
publish_id
)

534 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

535 
sk_buff
 *
»q
;

536 
sk_buff
 *
cfm
;

537 
r
 = 0;

538 
u16
 
Çn_sdf_æags
 = 0;

540 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "\n");

541 ià(
h®_»q
) {

543 
u16
 
Ëngth
 = 18 + 70 + 11;

545 
Ëngth
 +ğ
h®_»q
->
£rviû_Çme_Ën
 ? hal_req->service_name_len + 4 : 0;

546 
Ëngth
 +ğ
h®_»q
->
£rviû_¥ecific_šfo_Ën
 ? hal_req->service_specific_info_len + 4 : 0;

547 
Ëngth
 +ğ
h®_»q
->
rx_m©ch_f‹r_Ën
 ? hal_req->rx_match_filter_len + 4 : 0;

548 
Ëngth
 +ğ
h®_»q
->
tx_m©ch_f‹r_Ën
 ? hal_req->tx_match_filter_len + 4 : 0;

549 
Ëngth
 +ğ
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
 ? hal_req->sdea_service_specific_info_len + 4 : 0;

551 
»q
 = 
	`çpi_®loc
(
mlme_Çn_publish_»q
, 
MLME_NAN_PUBLISH_REQ
, 
ndev_vif
->
iâum
, 
Ëngth
);

552 ià(!
»q
) {

553 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

554  -
ENOMEM
;

563 ià(
h®_»q
->
»cv_šdiÿtiÚ_cfg
 & 
	`BIT
(0))

564 
Çn_sdf_æags
 |ğ
FAPI_NANSDFCONTROL_PUBLISH_END_EVENT
;

565 ià(
h®_»q
->
»cv_šdiÿtiÚ_cfg
 & 
	`BIT
(1))

566 
Çn_sdf_æags
 |ğ
FAPI_NANSDFCONTROL_MATCH_EXPIRED_EVENT
;

567 ià(
h®_»q
->
»cv_šdiÿtiÚ_cfg
 & 
	`BIT
(2))

568 
Çn_sdf_æags
 |ğ
FAPI_NANSDFCONTROL_RECEIVED_FOLLOWUP_EVENT
;

570 
ndev_vif
->
Çn
.
Çn_sdf_æags
[
publish_id
] =‚an_sdf_flags;

572 
»q
 = 
	`çpi_®loc
(
mlme_Çn_publish_»q
, 
MLME_NAN_PUBLISH_REQ
, 
ndev_vif
->
iâum
, 0);

573 ià(!
»q
) {

574 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

575  -
ENOMEM
;

579 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_Çn_publish_»q
.
£ssiÚ_id
, 
publish_id
);

580 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_Çn_publish_»q
.
Çn_sdf_æags
, 0);

582 ià(
h®_»q
) {

583 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_Çn_publish_»q
.
¥¬e_1
, 
h®_»q
->
Œª§ùiÚ_id
);

584 
r
 = 
	`¦si_mlme_Çn_publish_çpi_d©a
(
»q
, 
h®_»q
);

585 ià(
r
) {

586 
	`SLSI_NET_ERR
(
dev
, "Failedo construct mbulkdata\n");

587 
	`kä“_skb
(
»q
);

588  -
EINVAL
;

591 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_Çn_publish_»q
.
¥¬e_1
, 0);

594 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_NAN_PUBLISH_CFM
);

595 ià(!
cfm
)

596  -
EIO
;

598 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_publish_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

599 
	`SLSI_NET_ERR
(
dev
, "MLME_NAN_PUBLISH_CFM(result:0x%04x) ERROR\n",

600 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_publish_cfm
.
»suÉ_code
));

601 
r
 = -
EINVAL
;

604 ià(
h®_»q
 && !
r
)

605 
ndev_vif
->
Çn
.
£rviû_id_m­
 |ğ(
u32
)
	`BIT
(
publish_id
);

607 
ndev_vif
->
Çn
.
£rviû_id_m­
 &ğ(
u32
)~
	`BIT
(
publish_id
);

608 
	`kä“_skb
(
cfm
);

609  
r
;

610 
	}
}

612 
u32
 
	$¦si_mlme_Çn_subsüibe_çpi_d©a
(
sk_buff
 *
»q
, 
¦si_h®_Çn_subsüibe_»q
 *
h®_»q
)

614 
u32
 
»t
;

616 
»t
 = 
	`¦si_mlme_Çn_­³nd_subsüibe_¥ecific
(
»q
, 
h®_»q
->
£rviû_»¥Ú£_f‹r
,

617 
h®_»q
->
£rviû_»¥Ú£_šşude
,

618 
h®_»q
->
u£_£rviû_»¥Ú£_f‹r
,

619 
h®_»q
->
ssi_»quœed_fÜ_m©ch_šdiÿtiÚ
);

620 ià(
»t
) {

621 
	`SLSI_WARN_NODEV
("Error‡ppend subscribe specific TLV\n");

622  
»t
;

625 
»t
 = 
	`¦si_mlme_Çn_­³nd_discov”y_cÚfig
(
»q
, 
h®_»q
->
subsüibe_ty³
,

626 
h®_»q
->
subsüibe_ty³
 ? 0 : 1, h®_»q->
‰l
,

627 
h®_»q
->
³riod
, h®_»q->
subsüibe_couÁ
, h®_»q->
subsüibe_m©ch_šdiÿtÜ
,

628 
h®_»q
->
rssi_th»shŞd_æag
, (
u16
)h®_»q->
sd—_·¿ms
.
¿ngšg_¡©e
,

629 
h®_»q
->
sd—_·¿ms
.
cÚfig_Çn_d©a_·th
);

630 ià(
»t
) {

631 
	`SLSI_WARN_NODEV
("Error‡ppend discovery config TLV\n");

632  
»t
;

635 ià(
h®_»q
->
£rviû_Çme_Ën
) {

636 
»t
 = 
	`¦si_mlme_Çn_­³nd_£rviû_Çme
(
»q
, 
h®_»q
->
£rviû_Çme_Ën
, h®_»q->
£rviû_Çme
);

637 ià(
»t
) {

638 
	`SLSI_WARN_NODEV
("Error‡ppend service‚ame TLV\n");

639  
»t
;

643 ià(
h®_»q
->
£rviû_¥ecific_šfo_Ën
) {

644 
»t
 = 
	`¦si_mlme_Çn_­³nd_£rviû_¥ecific_šfo
(
»q
, 
h®_»q
->
£rviû_¥ecific_šfo_Ën
,

645 
h®_»q
->
£rviû_¥ecific_šfo
);

646 ià(
»t
) {

647 
	`SLSI_WARN_NODEV
("Error‡ppend servSpecInfo TLV\n");

648  
»t
;

652 ià(
h®_»q
->
rx_m©ch_f‹r_Ën
) {

653 
»t
 = 
	`¦si_mlme_Çn_­³nd_rx_m©ch_f‹r
(
»q
, 
h®_»q
->
rx_m©ch_f‹r_Ën
, h®_»q->
rx_m©ch_f‹r
);

654 ià(
»t
) {

655 
	`SLSI_WARN_NODEV
("Error‡ppend„x match filter TLV\n");

656  
»t
;

660 ià(
h®_»q
->
tx_m©ch_f‹r_Ën
) {

661 
»t
 = 
	`¦si_mlme_Çn_­³nd_tx_m©ch_f‹r
(
»q
, 
h®_»q
->
tx_m©ch_f‹r_Ën
, h®_»q->
tx_m©ch_f‹r
);

662 ià(
»t
) {

663 
	`SLSI_WARN_NODEV
("Error‡ppendx match filter TLV\n");

664  
»t
;

668 ià(
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
) {

669 
»t
 = 
	`¦si_mlme_Çn_­³nd_ext_£rviû_¥ecific_šfo
(
»q
, 
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
,

670 
h®_»q
->
sd—_£rviû_¥ecific_šfo
);

671 ià(
»t
) {

672 
	`SLSI_WARN_NODEV
("Error‡ppendƒxtServSpecInfo TLV\n");

673  
»t
;

677 ià(
h®_»q
->
sd—_·¿ms
.
cÚfig_Çn_d©a_·th
) {

678 
»t
 = 
	`¦si_mlme_Çn_­³nd_d©a_·th_£c
(
»q
, &
h®_»q
->
£c_šfo
);

679 ià(
»t
) {

680 
	`SLSI_WARN_NODEV
("Error‡ppend datapath sec TLV\n");

681  
»t
;

684 ià(
h®_»q
->
sd—_·¿ms
.
¿ngšg_¡©e
) {

685 
»t
 = 
	`¦si_mlme_Çn_­³nd_¿ngšg
(
»q
, &
h®_»q
->
¿ngšg_cfg
);

686 ià(
»t
) {

687 
	`SLSI_WARN_NODEV
("Error‡ppend„anging config TLV\n");

688  
»t
;

692 
»t
 = 
	`¦si_mlme_Çn_­³nd_add»ss_£t
(
»q
, 
h®_»q
->
num_štf_addr_´e£Á
, (
u8
 *)h®_»q->
štf_addr
);

693 ià(
»t
)

694 
	`SLSI_WARN_NODEV
("Error‡ppend‡ddress set TLV\n");

695  
»t
;

696 
	}
}

698 
	$¦si_mlme_Çn_subsüibe
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_h®_Çn_subsüibe_»q
 *
h®_»q
,

699 
u16
 
subsüibe_id
)

701 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

702 
sk_buff
 *
»q
;

703 
sk_buff
 *
cfm
;

704 
r
 = 0;

705 
u16
 
Çn_sdf_æags
 = 0;

707 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "\n");

708 ià(
h®_»q
) {

710 
u16
 
Ëngth
 = 11 + 18 + 70 + 11;

712 
Ëngth
 +ğ
h®_»q
->
£rviû_Çme_Ën
 ? hal_req->service_name_len + 4 : 0;

713 
Ëngth
 +ğ
h®_»q
->
£rviû_¥ecific_šfo_Ën
 ? hal_req->service_specific_info_len + 4 : 0;

714 
Ëngth
 +ğ
h®_»q
->
rx_m©ch_f‹r_Ën
 ? hal_req->rx_match_filter_len + 4 : 0;

715 
Ëngth
 +ğ
h®_»q
->
tx_m©ch_f‹r_Ën
 ? hal_req->tx_match_filter_len + 4 : 0;

716 
Ëngth
 +ğ
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
 ? hal_req->sdea_service_specific_info_len + 4 : 0;

717 
Ëngth
 +ğ
h®_»q
->
num_štf_addr_´e£Á
 ? hal_req->num_intf_addr_present * 6 + 4 : 0;

719 
»q
 = 
	`çpi_®loc
(
mlme_Çn_subsüibe_»q
, 
MLME_NAN_SUBSCRIBE_REQ
, 
ndev_vif
->
iâum
, 
Ëngth
);

720 ià(!
»q
) {

721 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

722  -
ENOMEM
;

730 ià(
h®_»q
->
»cv_šdiÿtiÚ_cfg
 & 
	`BIT
(0))

731 
Çn_sdf_æags
 |ğ
FAPI_NANSDFCONTROL_SUBSCRIBE_END_EVENT
;

732 ià(
h®_»q
->
»cv_šdiÿtiÚ_cfg
 & 
	`BIT
(1))

733 
Çn_sdf_æags
 |ğ
FAPI_NANSDFCONTROL_MATCH_EXPIRED_EVENT
;

734 ià(
h®_»q
->
»cv_šdiÿtiÚ_cfg
 & 
	`BIT
(2))

735 
Çn_sdf_æags
 |ğ
FAPI_NANSDFCONTROL_RECEIVED_FOLLOWUP_EVENT
;

736 
ndev_vif
->
Çn
.
Çn_sdf_æags
[
subsüibe_id
] =‚an_sdf_flags;

738 
»q
 = 
	`çpi_®loc
(
mlme_Çn_subsüibe_»q
, 
MLME_NAN_SUBSCRIBE_REQ
, 
ndev_vif
->
iâum
, 0);

739 ià(!
»q
) {

740 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

741  -
ENOMEM
;

745 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_Çn_subsüibe_»q
.
£ssiÚ_id
, 
subsüibe_id
);

746 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_Çn_subsüibe_»q
.
Çn_sdf_æags
, 0);

747 ià(
h®_»q
) {

748 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_Çn_subsüibe_»q
.
¥¬e_1
, 
h®_»q
->
Œª§ùiÚ_id
);

749 
r
 = 
	`¦si_mlme_Çn_subsüibe_çpi_d©a
(
»q
, 
h®_»q
);

750 ià(
r
) {

751 
	`SLSI_NET_ERR
(
dev
, "Failedo construct mbulkdata\n");

752 
	`kä“_skb
(
»q
);

753  -
EINVAL
;

756 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_Çn_subsüibe_»q
.
¥¬e_1
, 0);

759 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_NAN_SUBSCRIBE_CFM
);

760 ià(!
cfm
)

761  -
EIO
;

763 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_subsüibe_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

764 
	`SLSI_NET_ERR
(
dev
, "MLME_NAN_SUBSCRIBE_CFM(res:0x%04x)\n",

765 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_subsüibe_cfm
.
»suÉ_code
));

766 
r
 = -
EINVAL
;

769 ià(
h®_»q
 && !
r
)

770 
ndev_vif
->
Çn
.
£rviû_id_m­
 |ğ(
u32
)
	`BIT
(
subsüibe_id
);

772 
ndev_vif
->
Çn
.
£rviû_id_m­
 &ğ(
u32
)~
	`BIT
(
subsüibe_id
);

773 
	`kä“_skb
(
cfm
);

774  
r
;

775 
	}
}

777 
u32
 
	$¦si_mlme_Çn_fŞlowup_çpi_d©a
(
sk_buff
 *
»q
, 
¦si_h®_Çn_Œªsm™_fŞlowup_»q
 *
h®_»q
)

779 
u32
 
»t
;

781 
»t
 = 
	`¦si_mlme_Çn_­³nd_£rviû_¥ecific_šfo
(
»q
, 
h®_»q
->
£rviû_¥ecific_šfo_Ën
,

782 
h®_»q
->
£rviû_¥ecific_šfo
);

783 ià(
»t
) {

784 
	`SLSI_WARN_NODEV
("Error‡ppend service specific info TLV\n");

785  
»t
;

788 
»t
 = 
	`¦si_mlme_Çn_­³nd_ext_£rviû_¥ecific_šfo
(
»q
, 
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
,

789 
h®_»q
->
sd—_£rviû_¥ecific_šfo
);

790 ià(
»t
)

791 
	`SLSI_WARN_NODEV
("Error‡ppendƒxtServSpecInfo TLV\n");

792  
»t
;

793 
	}
}

795 
	$¦si_mlme_Çn_tx_fŞlowup
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

796 
¦si_h®_Çn_Œªsm™_fŞlowup_»q
 *
h®_»q
)

798 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

799 
sk_buff
 *
»q
;

800 
sk_buff
 *
cfm
;

801 
r
 = 0;

802 
u16
 
Çn_sdf_æags
 = 0;

803 
u16
 
d©a_Ën
;

805 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "\n");

807 ià(
	`¦si_Çn_push_fŞlowup_ids
(
sdev
, 
dev
, 
h®_»q
->
»que¡Ü_š¡ªû_id
, h®_»q->
Œª§ùiÚ_id
) < 0) {

808 
	`SLSI_WARN
(
sdev
, "Host followup_req queue full\n");

809  
SLSI_HAL_NAN_STATUS_FOLLOWUP_QUEUE_FULL
;

812 
d©a_Ën
 = 
h®_»q
->
£rviû_¥ecific_šfo_Ën
 ? (hal_req->service_specific_info_len + 4) : 0;

813 
d©a_Ën
 = 
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
 ? (hal_req->sdea_service_specific_info_len + 4) : 0;

816 
»q
 = 
	`çpi_®loc
(
mlme_Çn_fŞlowup_»q
, 
MLME_NAN_FOLLOWUP_REQ
, 
ndev_vif
->
iâum
, 5 * 255);

817 ià(!
»q
) {

818 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

819  -
ENOMEM
;

822 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_Çn_fŞlowup_»q
.
£ssiÚ_id
, 
h®_»q
->
publish_subsüibe_id
);

823 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_Çn_fŞlowup_»q
.
m©ch_id
, 
h®_»q
->
»que¡Ü_š¡ªû_id
);

824 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_Çn_fŞlowup_»q
.
Çn_sdf_æags
,‚an_sdf_flags);

825 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_Çn_fŞlowup_»q
.
¥¬e_1
, 
h®_»q
->
Œª§ùiÚ_id
);

827 
r
 = 
	`¦si_mlme_Çn_fŞlowup_çpi_d©a
(
»q
, 
h®_»q
);

828 ià(
r
) {

829 
	`SLSI_NET_ERR
(
dev
, "Failedo construct mbulkdata\n");

830 
	`kä“_skb
(
»q
);

831  -
EINVAL
;

834 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_NAN_FOLLOWUP_CFM
);

835 ià(!
cfm
) {

836 
	`¦si_Çn_pİ_fŞlowup_ids
(
sdev
, 
dev
, 
h®_»q
->
»que¡Ü_š¡ªû_id
);

837  -
EIO
;

840 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_fŞlowup_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

841 
	`¦si_Çn_pİ_fŞlowup_ids
(
sdev
, 
dev
, 
h®_»q
->
»que¡Ü_š¡ªû_id
);

842 
	`SLSI_NET_ERR
(
dev
, "MLME_NAN_FOLLOWUP_CFM(res:0x%04x)\n",

843 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_fŞlowup_cfm
.
»suÉ_code
));

844 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_fŞlowup_cfm
.
»suÉ_code
) ==

845 
FAPI_RESULTCODE_TOO_MANY_SIMULTANEOUS_REQUESTS
)

846 
r
 = 
SLSI_HAL_NAN_STATUS_FOLLOWUP_QUEUE_FULL
;

848 
r
 = -
EINVAL
;

851 
	`kä“_skb
(
cfm
);

852  
r
;

853 
	}
}

855 
u32
 
	$¦si_mlme_Çn_cÚfig_çpi_d©a
(
Ãtdev_vif
 *
ndev_vif
, 
sk_buff
 *
»q
, 
¦si_h®_Çn_cÚfig_»q
 *
h®_»q
, 
u8
 
şu¡”_m”ge
)

857 
u16
 
rssi_wšdow
 = 
h®_»q
->
cÚfig_rssi_wšdow_size
 ? h®_»q->
rssi_wšdow_size_v®
 : 8;

858 
u32
 
»t
;

859 
u8
 
rssi_şo£
 = 
h®_»q
->
rssi_şo£_2dÙ4g_v®
;

860 
u8
 
rssi_middË
 = 
h®_»q
->
rssi_middË_2dÙ4g_v®
;

861 
u8
 
rssi_´oxim™y
 = 0;

863 
u16
 
is_sid_š_b—cÚ
 = 
h®_»q
->
cÚfig_subsüibe_sid_b—cÚ
 && (h®_»q->
subsüibe_sid_b—cÚ_v®
 & 0x01);

864 
u8
 
sid_couÁ_š_b—cÚ
 = 
h®_»q
->
cÚfig_subsüibe_sid_b—cÚ
 ? h®_»q->
subsüibe_sid_b—cÚ_v®
 >> 1 : 0;

866 ià(!
h®_»q
->
ma¡”_´ef
)

867 
h®_»q
->
ma¡”_´ef
 = 
ndev_vif
->
Çn
.
ma¡”_´ef_v®ue
;

869 
»t
 = 
	`¦si_mlme_Çn_­³nd_cÚfig_v
(
»q
, 
h®_»q
->
ma¡”_´ef
,

870 
h®_»q
->
cÚfig_sid_b—cÚ
 && (h®_»q->
sid_b—cÚ
 & 0x01),

871 
h®_»q
->
cÚfig_sid_b—cÚ
 ? h®_»q->
sid_b—cÚ
 >> 1 : 0,

872 
is_sid_š_b—cÚ
, 
sid_couÁ_š_b—cÚ
, 
rssi_wšdow
,

873 
h®_»q
->
disc_mac_addr_¿nd_š‹rv®_£c
, 
şu¡”_m”ge
);

874 ià(
»t
) {

875 
	`SLSI_WARN_NODEV
("Error‡ppend config TLV\n");

876  
»t
;

880 
rssi_´oxim™y
 = 
h®_»q
->
cÚfig_rssi_´oxim™y
 ? hal_req->rssi_proximity : 0;

882 
»t
 = 
	`¦si_mlme_Çn_­³nd_2g4_bªd_¥ecific_cÚfig
(
»q
, 
rssi_şo£
, 
rssi_middË
, 
rssi_´oxim™y
,

883 
h®_»q
->
sÿn_·¿ms_v®
.
dw–l_time
[0],

884 
h®_»q
->
sÿn_·¿ms_v®
.
sÿn_³riod
[0],

885 
h®_»q
->
cÚfig_2dÙ4g_dw_bªd
,

886 
h®_»q
->
dw_2dÙ4g_š‹rv®_v®
);

887 ià(
»t
) {

888 
	`SLSI_WARN_NODEV
("Error‡ppend 2.4G band specific TLV\n");

889  
»t
;

893 
rssi_şo£
 = 
h®_»q
->
rssi_şo£_5g_v®
;

894 
rssi_middË
 = 
h®_»q
->
rssi_middË_5g_v®
;

895 
rssi_´oxim™y
 = 
h®_»q
->
cÚfig_5g_rssi_şo£_´oxim™y
 ? h®_»q->
rssi_şo£_´oxim™y_5g_v®
 : 0;

897 
»t
 = 
	`¦si_mlme_Çn_­³nd_5g_bªd_¥ecific_cÚfig
(
»q
, 
rssi_şo£
, 
rssi_middË
, 
rssi_´oxim™y
,

898 
h®_»q
->
sÿn_·¿ms_v®
.
dw–l_time
[1],

899 
h®_»q
->
sÿn_·¿ms_v®
.
sÿn_³riod
[1],

900 
h®_»q
->
cÚfig_5g_dw_bªd
,

901 
h®_»q
->
dw_5g_š‹rv®_v®
);

902 ià(
»t
) {

903 
	`SLSI_WARN_NODEV
("Error‡ppend 5G band specific TLV\n");

904  
»t
;

907 
»t
 = 
	`¦si_mlme_Çn_­³nd_cÚfig_suµËm’l
(
»q
, 
h®_»q
->
discov”y_b—cÚ_š‹rv®_ms
,

908 
h®_»q
->
nss_discov”y
, h®_»q->
’abË_dw_—¾y_‹rmš©iÚ
,

909 
h®_»q
->
’abË_¿ngšg
);

910 ià(
»t
) {

911 
	`SLSI_WARN_NODEV
("Failedo‡dd config supplemental TLV\n");

912  
»t
;

914  
»t
;

915 
	}
}

917 
	$¦si_mlme_Çn_£t_cÚfig
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_h®_Çn_cÚfig_»q
 *
h®_»q
)

919 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

920 
sk_buff
 *
»q
;

921 
sk_buff
 *
cfm
;

922 
r
 = 0;

923 
u16
 
Çn_İ”_ù¾
 = 0;

925 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "\n");

927 
»q
 = 
	`çpi_®loc
(
mlme_Çn_cÚfig_»q
, 
MLME_NAN_CONFIG_REQ
, 
ndev_vif
->
iâum
, 56);

928 ià(!
»q
) {

929 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

930  -
ENOMEM
;

933 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_Çn_cÚfig_»q
.
Çn_İ”©iÚ_cÚŒŞ_æags
, 
Çn_İ”_ù¾
);

934 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_Çn_cÚfig_»q
.
¥¬e_1
, 
h®_»q
->
Œª§ùiÚ_id
);

936 
r
 = 
	`¦si_mlme_Çn_cÚfig_çpi_d©a
(
ndev_vif
, 
»q
, 
h®_»q
, !ndev_vif->
Çn
.
di§bË_şu¡”_m”ge
);

937 ià(
r
) {

938 
	`SLSI_NET_ERR
(
dev
, "Failedo construct mbulkdata\n");

939 
	`kä“_skb
(
»q
);

940  -
EINVAL
;

943 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_NAN_CONFIG_CFM
);

944 ià(!
cfm
)

945  -
EIO
;

947 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_cÚfig_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

948 
	`SLSI_NET_ERR
(
dev
, "MLME_NAN_FOLLOWUP_CFM(res:0x%04x)\n",

949 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_cÚfig_cfm
.
»suÉ_code
));

950 
r
 = -
EINVAL
;

953 
	`kä“_skb
(
cfm
);

954  
r
;

955 
	}
}

957 
	$¦si_mlme_ndp_»que¡_çpi_d©a
(
sk_buff
 *
»q
,

958 
¦si_h®_Çn_d©a_·th_š™ŸtÜ_»q
 *
h®_»q
,

959 
boŞ
 
šşude_v6_addr_v
, boŞ 
šşude_£rviû_šfo_v
,

960 
u8
 *
loÿl_ndi
)

962 
»t
;

964 
»t
 = 
	`¦si_mlme_Çn_­³nd_d©a_·th_£c
(
»q
, &
h®_»q
->
key_šfo
);

965 ià(
»t
) {

966 
	`SLSI_WARN_NODEV
("Error data_path sec TLV\n");

967  
»t
;

970 ià(
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
) {

971 
»t
 = 
	`¦si_mlme_Çn_­³nd_v
(
»q
, 
SLSI_NAN_TLV_TAG_APP_INFO
, 
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
,

972 
h®_»q
->
­p_šfo
.
ndp_­p_šfo
);

973 ià(
»t
) {

974 
	`SLSI_WARN_NODEV
("Error‡pp info TLV\n");

975  
»t
;

978 ià(
šşude_£rviû_šfo_v
) {

979 
»t
 = 
	`¦si_mlme_Çn_­³nd_£rviû_šfo_v
(
»q
, &
h®_»q
->
­p_šfo
);

980 ià(
»t
)

981 
	`SLSI_WARN_NODEV
("Error Adding Service Info TLV\n");

983 ià(
šşude_v6_addr_v
) {

984 
»t
 = 
	`¦si_mlme_Çn_­³nd_v6_lšk_v
(
»q
, 
loÿl_ndi
);

985 ià(
»t
)

986 
	`SLSI_WARN_NODEV
("Error ipv6†inklv\n");

988 ià(
h®_»q
->
£rviû_Çme_Ën
) {

989 
»t
 = 
	`¦si_mlme_Çn_­³nd_£rviû_Çme
(
»q
, 
h®_»q
->
£rviû_Çme_Ën
, h®_»q->
£rviû_Çme
);

990 ià(
»t
)

991 
	`SLSI_WARN_NODEV
("Error‡ppend servicename TLV\n");

993  
»t
;

994 
	}
}

996 
	$¦si_mlme_ndp_»que¡
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

997 
¦si_h®_Çn_d©a_·th_š™ŸtÜ_»q
 *
h®_»q
, 
u32
 
ndp_š¡ªû_id
, 
u16
 
ndl_vif_id
)

999 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1000 
sk_buff
 *
»q
;

1001 
sk_buff
 *
cfm
;

1002 
r
 = 0, 
d©a_Ën
;

1003 
boŞ
 
šşude_v6_lšk_v
, 
šşude_£rviû_šfo_v
 = 0;

1004 
u8
 *
loÿl_ndi
;

1005 
Ãt_deviû
 *
d©a_dev
;

1006 
Ãtdev_vif
 *
ndev_d©a_vif
;

1008 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "\n");

1010 
d©a_dev
 = 
	`¦si_g‘_Ãtdev_by_iâame
(
sdev
, 
h®_»q
->
ndp_içû
);

1011 ià(!
d©a_dev
) {

1012 
	`SLSI_NET_ERR
(
dev
, "nØÃt_deviû fÜ %s\n", 
h®_»q
->
ndp_içû
);

1013  -
EINVAL
;

1015 
loÿl_ndi
 = 
d©a_dev
->
dev_addr
;

1016 
ndev_d©a_vif
 = 
	`Ãtdev_´iv
(
d©a_dev
);

1018 
šşude_v6_lšk_v
 = 
	`¦si_dev_Çn_is_v6_lšk_v_šşude
();

1020 
d©a_Ën
 = 74;

1021 
d©a_Ën
 +ğ
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
 ? 4 + hal_req->app_info.ndp_app_info_len : 0;

1022 
d©a_Ën
 +ğ
šşude_v6_lšk_v
 ? 4 + 8 : 0;

1023 
d©a_Ën
 +ğ
h®_»q
->
£rviû_Çme_Ën
 ? hal_req->service_name_len + 4 : 0;

1024 ià(
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
) {

1025 
u16
 
Ëngth
;

1027 
Ëngth
 = 
	`¦si_mlme_Çn_£rviû_šfo_v_Ëngth
(&
h®_»q
->
­p_šfo
);

1028 
d©a_Ën
 +ğ(
Ëngth
 + 1);

1029 
šşude_£rviû_šfo_v
 = 1;

1031 
»q
 = 
	`çpi_®loc
(
mlme_ndp_»que¡_»q
, 
MLME_NDP_REQUEST_REQ
, 
ndev_vif
->
iâum
, 
d©a_Ën
);

1032 ià(!
»q
) {

1033 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

1034  -
ENOMEM
;

1037 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_ndp_»que¡_»q
.
ndl_vif_šdex
, 
ndl_vif_id
);

1038 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_ndp_»que¡_»q
.
m©ch_id
, 
h®_»q
->
»que¡Ü_š¡ªû_id
);

1039 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_ndp_»que¡_»q
.
loÿl_ndp_š‹rçû_add»ss
, 
loÿl_ndi
);

1040 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_ndp_»que¡_»q
.
³”_nmi
, 
h®_»q
->
³”_disc_mac_addr
);

1041 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_ndp_»que¡_»q
.
ndp_š¡ªû_id
,‚dp_instance_id);

1042 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_ndp_»que¡_»q
.
¥¬e_1
, 
h®_»q
->
Œª§ùiÚ_id
);

1044 
r
 = 
	`¦si_mlme_ndp_»que¡_çpi_d©a
(
»q
, 
h®_»q
, 
šşude_v6_lšk_v
, 
šşude_£rviû_šfo_v
, 
loÿl_ndi
);

1045 ià(
r
) {

1046 
	`SLSI_NET_ERR
(
dev
, "Failedo construct mbulkdata\n");

1047 
	`kä“_skb
(
»q
);

1048  -
EINVAL
;

1051 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_NDP_REQUEST_CFM
);

1052 ià(!
cfm
)

1053  -
EIO
;

1055 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_ndp_»que¡_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1056 
	`SLSI_NET_ERR
(
dev
, "MLME_NDP_REQUEST_CFM(res:0x%04x)\n",

1057 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_ndp_»que¡_cfm
.
»suÉ_code
));

1058 
r
 = -
EINVAL
;

1060 
	`SLSI_MUTEX_LOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

1061 
ndev_d©a_vif
->
Çn
.
ndp_couÁ
++;

1062 
	`SLSI_MUTEX_UNLOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

1063 ià(
	`¦si_Çn_ndp_Ãw_’Œy
(
sdev
, 
dev
, 
ndp_š¡ªû_id
, 
ndl_vif_id
, 
loÿl_ndi
, 
h®_»q
->
³”_disc_mac_addr
))

1064 
	`SLSI_NET_ERR
(
dev
, "šv®id‚dl_vifid:%d‚dp_id:%d\n", 
ndl_vif_id
, 
ndp_š¡ªû_id
);

1067 
	`kä“_skb
(
cfm
);

1068  
r
;

1069 
	}
}

1071 
	$¦si_mlme_ndp_»¥Ú£_çpi_d©a
(
sk_buff
 *
»q
,

1072 
¦si_h®_Çn_d©a_·th_šdiÿtiÚ_»¥Ú£
 *
h®_»q
,

1073 
boŞ
 
šşude_v6_lšk_v
, boŞ 
šşude_£rviû_šfo_v
,

1074 
u8
 *
loÿl_ndi
)

1076 
»t
;

1078 
»t
 = 
	`¦si_mlme_Çn_­³nd_d©a_·th_£c
(
»q
, &
h®_»q
->
key_šfo
);

1079 ià(
»t
) {

1080 
	`SLSI_WARN_NODEV
("Error data_path sec TLV\n");

1081  
»t
;

1084 ià(
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
) {

1085 
»t
 = 
	`¦si_mlme_Çn_­³nd_v
(
»q
, 
SLSI_NAN_TLV_TAG_APP_INFO
, 
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
,

1086 
h®_»q
->
­p_šfo
.
ndp_­p_šfo
);

1087 ià(
»t
) {

1088 
	`SLSI_WARN_NODEV
("Error‡pp info TLV\n");

1089  
»t
;

1092 ià(
šşude_£rviû_šfo_v
) {

1093 
»t
 = 
	`¦si_mlme_Çn_­³nd_£rviû_šfo_v
(
»q
, &
h®_»q
->
­p_šfo
);

1094 ià(
»t
)

1095 
	`SLSI_WARN_NODEV
("Error Adding Service Info TLV\n");

1097 ià(
šşude_v6_lšk_v
) {

1098 
»t
 = 
	`¦si_mlme_Çn_­³nd_v6_lšk_v
(
»q
, 
loÿl_ndi
);

1099 ià(
»t
)

1100 
	`SLSI_WARN_NODEV
("Error ipv6†inklv\n");

1102 ià(
h®_»q
->
£rviû_Çme_Ën
) {

1103 
»t
 = 
	`¦si_mlme_Çn_­³nd_£rviû_Çme
(
»q
, 
h®_»q
->
£rviû_Çme_Ën
, h®_»q->
£rviû_Çme
);

1104 ià(
»t
)

1105 
	`SLSI_WARN_NODEV
("Error‡ppend servicename TLV\n");

1107  
»t
;

1108 
	}
}

1110 
	$¦si_mlme_ndp_»¥Ú£
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

1111 
¦si_h®_Çn_d©a_·th_šdiÿtiÚ_»¥Ú£
 *
h®_»q
, 
u16
 
loÿl_ndp_š¡ªû_id
)

1113 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1114 
sk_buff
 *
»q
;

1115 
sk_buff
 *
cfm
;

1116 
r
 = 0, 
d©a_Ën
;

1117 
boŞ
 
šşude_v6_lšk_v
, 
šşude_£rviû_šfo_v
 = 0;

1118 
u8
 *
loÿl_ndi
;

1119 
u16
 
ndl_vif_id
, 
r¥_code
;

1120 
Ãt_deviû
 *
d©a_dev
;

1121 
u8
 
nomac
[
ETH_ALEN
] = {0, 0, 0, 0, 0, 0};

1123 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "\n");

1124 
d©a_dev
 = 
	`¦si_g‘_Ãtdev_by_iâame
(
sdev
, 
h®_»q
->
ndp_içû
);

1125 ià(!
d©a_dev
)

1126 
loÿl_ndi
 = 
nomac
;

1128 
loÿl_ndi
 = 
d©a_dev
->
dev_addr
;

1130 
šşude_v6_lšk_v
 = 
	`¦si_dev_Çn_is_v6_lšk_v_šşude
();

1132 
d©a_Ën
 = 74;

1133 
d©a_Ën
 +ğ
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
 ? 4 + hal_req->app_info.ndp_app_info_len : 0;

1134 
d©a_Ën
 +ğ
šşude_v6_lšk_v
 ? 4 + 8 : 0;

1135 
d©a_Ën
 +ğ
h®_»q
->
£rviû_Çme_Ën
 ? 4 + hal_req->service_name_len : 0;

1136 ià(
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
) {

1137 
u16
 
Ëngth
;

1139 
Ëngth
 = 
	`¦si_mlme_Çn_£rviû_šfo_v_Ëngth
(&
h®_»q
->
­p_šfo
);

1140 
d©a_Ën
 +ğ(
Ëngth
 + 1);

1141 
šşude_£rviû_šfo_v
 = 1;

1144 
»q
 = 
	`çpi_®loc
(
mlme_ndp_»¥Ú£_»q
, 
MLME_NDP_RESPONSE_REQ
, 
ndev_vif
->
iâum
, 
d©a_Ën
);

1145 ià(!
»q
) {

1146 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

1147  -
ENOMEM
;

1149 ià(
h®_»q
->
ndp_š¡ªû_id
)

1150 
ndl_vif_id
 = 
ndev_vif
->
Çn
.
ndp_š¡ªû_id2ndl_vif
[
h®_»q
->
ndp_š¡ªû_id
 - 1];

1152 
ndl_vif_id
 = 0;

1153 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_ndp_»¥Ú£_»q
.
ndl_vif_šdex
, 
ndl_vif_id
);

1154 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_ndp_»¥Ú£_»q
.
»que¡_id
, 
loÿl_ndp_š¡ªû_id
);

1155 
	`çpi_£t_memıy
(
»q
, 
u
.
mlme_ndp_»¥Ú£_»q
.
loÿl_ndp_š‹rçû_add»ss
, 
loÿl_ndi
);

1156 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_ndp_»¥Ú£_»q
.
ndp_š¡ªû_id
, 
h®_»q
->ndp_instance_id);

1157 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_ndp_»¥Ú£_»q
.
¥¬e_1
, 
h®_»q
->
Œª§ùiÚ_id
);

1159 
r¥_code
 = 
h®_»q
->r¥_cod=ğ
NAN_DP_REQUEST_ACCEPT
 ? 
FAPI_REASONCODE_NDP_ACCEPTED
 :

1160 
FAPI_REASONCODE_NDP_REJECTED
;

1161 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_ndp_»¥Ú£_»q
.
»asÚ_code
, 
r¥_code
);

1162 
r
 = 
	`¦si_mlme_ndp_»¥Ú£_çpi_d©a
(
»q
, 
h®_»q
, 
šşude_v6_lšk_v
, 
šşude_£rviû_šfo_v
, 
loÿl_ndi
);

1163 ià(
r
) {

1164 
	`SLSI_NET_ERR
(
dev
, "Failedo construct mbulkdata\n");

1165 
	`kä“_skb
(
»q
);

1166  -
EINVAL
;

1169 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_NDP_RESPONSE_CFM
);

1170 ià(!
cfm
)

1171  -
EIO
;

1173 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_ndp_»¥Ú£_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1174 
	`SLSI_NET_ERR
(
dev
, "MLME_NDP_RESPONSE_CFM(res:0x%04x)\n",

1175 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_ndp_»que¡_cfm
.
»suÉ_code
));

1176 
r
 = -
EINVAL
;

1177 
	`¦si_Çn_ndp_d–_’Œy
(
sdev
, 
dev
, 
h®_»q
->
ndp_š¡ªû_id
, 
çl£
);

1179 ià(
r¥_code
 =ğ
FAPI_REASONCODE_NDP_REJECTED
)

1180 
	`¦si_Çn_ndp_d–_’Œy
(
sdev
, 
dev
, 
h®_»q
->
ndp_š¡ªû_id
, 
çl£
);

1184 ià(
h®_»q
->
ndp_š¡ªû_id
 && 
r¥_code
 =ğ
FAPI_REASONCODE_NDP_ACCEPTED
)

1185 
	`‘h”_addr_cİy
(
ndev_vif
->
Çn
.
ndp_ndi
[
h®_»q
->
ndp_š¡ªû_id
 - 1], 
loÿl_ndi
);

1186 ià(
d©a_dev
) {

1187 
Ãtdev_vif
 *
ndev_d©a_vif
 = 
	`Ãtdev_´iv
(
d©a_dev
);

1189 
ndev_d©a_vif
 = 
	`Ãtdev_´iv
(
d©a_dev
);

1190 
	`SLSI_MUTEX_LOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

1191 
ndev_d©a_vif
->
Çn
.
ndp_couÁ
++;

1192 
	`SLSI_MUTEX_UNLOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

1196 
	`kä“_skb
(
cfm
);

1197  
r
;

1198 
	}
}

1200 
	$¦si_mlme_ndp_‹rmš©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
ndp_š¡ªû_id
, u16 
Œª§ùiÚ_id
)

1202 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1203 
sk_buff
 *
»q
;

1204 
sk_buff
 *
cfm
;

1206 ià(
ndev_vif
->
Çn
.
ndp_¡©e
[
ndp_š¡ªû_id
 - 1] !ğ
ndp_¦Ù_¡©us_š_u£
) {

1207 
	`¦si_Çn_ndp_‹rmš©iÚ_hªdËr
(
sdev
, 
dev
, 
ndp_š¡ªû_id
, 
ndev_vif
->
Çn
.
ndp_ndi
[ndp_instance_id - 1]);

1211 
»q
 = 
	`çpi_®loc
(
mlme_ndp_‹rmš©e_»q
, 
MLME_NDP_TERMINATE_REQ
, 
ndev_vif
->
iâum
, 0);

1212 ià(!
»q
) {

1213 
	`SLSI_NET_ERR
(
dev
, "fapi‡lloc failure\n");

1214  -
ENOMEM
;

1217 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_ndp_‹rmš©e_»q
.
ndp_š¡ªû_id
,‚dp_instance_id);

1218 
	`çpi_£t_u32
(
»q
, 
u
.
mlme_ndp_‹rmš©e_»q
.
¥¬e_1
, 
Œª§ùiÚ_id
);

1219 
cfm
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_NDP_TERMINATE_CFM
);

1220 ià(!
cfm
) {

1221 
	`¦si_Çn_ndp_‹rmš©iÚ_hªdËr
(
sdev
, 
dev
, 
ndp_š¡ªû_id
, 
ndev_vif
->
Çn
.
ndp_ndi
[ndp_instance_id - 1]);

1222  -
EIO
;

1225 ià(
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_ndp_‹rmš©e_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1226 
	`SLSI_NET_ERR
(
dev
, "MLME_NDP_TERMINATE_CFM(res:0x%04x)\n",

1227 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_ndp_‹rmš©e_cfm
.
»suÉ_code
));

1228 
	`¦si_Çn_ndp_‹rmš©iÚ_hªdËr
(
sdev
, 
dev
, 
ndp_š¡ªû_id
, 
ndev_vif
->
Çn
.
ndp_ndi
[ndp_instance_id - 1]);

1231 
	`kä“_skb
(
cfm
);

1233 
	}
}

1235 
	$¦si_mlme_Çn_¿nge_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 
couÁ
,

1236 
¦si_¹t_cÚfig
 *
Æ_¹t_·¿ms
)

1238 
sk_buff
 *
»q
;

1239 
sk_buff
 *
rx
;

1240 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1241 
r
 = 0, 
i
;

1243 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

1244 
»q
 = 
	`çpi_®loc
(
mlme_Çn_¿nge_»q
, 
MLME_NAN_RANGE_REQ
, 0, 
couÁ
 * (
SLSI_NAN_TLV_NAN_RTT_CONFIG_LEN
 + 4));

1245 ià(!
»q
) {

1246 
	`SLSI_ERR
(
sdev
, "çedØ®loø%zd\n", 
couÁ
 * (
SLSI_NAN_TLV_NAN_RTT_CONFIG_LEN
 + 4));

1247  -
ENOMEM
;

1249 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "couÁ:%d\n", 
couÁ
);

1251 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_Çn_¿nge_»q
.
vif
, 
ndev_vif
->
iâum
);

1252 
i
 = 0; i < 
couÁ
; i++) {

1253 
	`çpi_­³nd_d©a_u16
(
»q
, 
SLSI_NAN_TLV_NAN_RTT_CONFIG
);

1254 
	`çpi_­³nd_d©a_u16
(
»q
, 
SLSI_NAN_TLV_NAN_RTT_CONFIG_LEN
);

1255 
	`çpi_­³nd_d©a
(
»q
, 
Æ_¹t_·¿ms
[
i
].
³”_addr
, 
ETH_ALEN
);

1256 
	`çpi_­³nd_d©a_u8
(
»q
, 
Æ_¹t_·¿ms
[
i
].
num_äames_³r_bur¡
);

1257 
	`çpi_­³nd_d©a_u8
(
»q
, 
Æ_¹t_·¿ms
[
i
].
bur¡_du¿tiÚ
);

1258 
	`çpi_­³nd_d©a_u8
(
»q
, 
Æ_¹t_·¿ms
[
i
].
num_»Œ›s_³r_ámr
);

1260 
rx
 = 
	`¦si_mlme_»q_cfm
(
sdev
, 
dev
, 
»q
, 
MLME_NAN_RANGE_CFM
);

1261 ià(!
rx
)

1262  -
EIO
;

1263 ià(
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_Çn_¿nge_cfm
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

1264 
	`SLSI_ERR
(
sdev
, "mlme_nan_range_cfm(ERROR:0x%04x)",

1265 
	`çpi_g‘_u16
(
rx
, 
u
.
mlme_Çn_¿nge_cfm
.
»suÉ_code
));

1266 
r
 = -
EINVAL
;

1269 
	`kä“_skb
(
rx
);

1270  
r
;

1271 
	}
}

1273 
boŞ
 
	$¦si_Çn_¿nge_ÿnûl_cfm_v®id©e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
cfm
)

1275 
»suÉ
 = 
	`çpi_g‘_u16
(
cfm
, 
u
.
mlme_Çn_¿nge_ÿnûl_cfm
.
»suÉ_code
);

1276 
boŞ
 
r
 = 
çl£
;

1278 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

1280 ià(
	`WARN_ON
(!
dev
))

1281 
ex™
;

1283 ià(
»suÉ
 =ğ
FAPI_RESULTCODE_SUCCESS
)

1284 
r
 = 
Œue
;

1286 
	`SLSI_NET_ERR
(
dev
, "mlme_Çn_¿nge_ÿnûl_cfmÔesuÉ:0x%04xèERROR\n", 
»suÉ
);

1288 
ex™
:

1289 
	`kä“_skb
(
cfm
);

1290  
r
;

1291 
	}
}

1293 
	$¦si_mlme_Çn_¿nge_ÿnûl_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

1295 
sk_buff
 *
»q
;

1296 
sk_buff
 *
rx
;

1297 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1298 
r
 = 0;

1300 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

1302 
»q
 = 
	`çpi_®loc
(
mlme_Çn_¿nge_ÿnûl_»q
, 
MLME_NAN_RANGE_CANCEL_REQ
, 0, 0);

1303 ià(!
»q
) {

1304 
	`SLSI_ERR
(
sdev
, "failedo‡lloc cancel„eq\n");

1305  -
ENOMEM
;

1308 
	`çpi_£t_u16
(
»q
, 
u
.
mlme_Çn_¿nge_ÿnûl_»q
.
vif
, 
ndev_vif
->
iâum
);

1310 
rx
 = 
	`¦si_mlme_»q_cfm_šd
(
sdev
, 
dev
, 
»q
, 
MLME_NAN_RANGE_CANCEL_CFM
, 
MLME_SPARE_5_IND
, 
¦si_Çn_¿nge_ÿnûl_cfm_v®id©e
);

1311 ià(!
rx
) {

1312 
	`SLSI_NET_ERR
(
dev
, "mlme_nan_range_cancel_cfm() ERROR\n");

1313 
r
 = -
EINVAL
;

1315 
	`kä“_skb
(
rx
);

1316  
r
;

1317 
	}
}

	@netif.c

7 
	~<lšux/Ãtdeviû.h
>

8 
	~<lšux/‘h”deviû.h
>

9 
	~<lšux/¹Ãšk.h
>

10 
	~<Ãt/sch_g’”ic.h
>

11 
	~<lšux/if_‘h”.h
>

12 
	~<scsc/scsc_logršg.h
>

14 
	~"debug.h
"

15 
	~"Ãtif.h
"

16 
	~"dev.h
"

17 
	~"mgt.h
"

18 
	~"scsc_wifi_fcq.h
"

19 
	~"ioùl.h
"

20 
	~"mib.h
"

21 
	~"mlme.h
"

22 
	~"h4_§m¶”.h
"

24 
	#IP4_OFFSET_TO_TOS_FIELD
 1

	)

25 
	#IP6_OFFSET_TO_TC_FIELD_0
 0

	)

26 
	#IP6_OFFSET_TO_TC_FIELD_1
 1

	)

27 
	#FIELD_TO_DSCP
 2

	)

31 
	#DSCP_VA
 0x2C

	)

33 
	#DSCP_EF
 0x2E

	)

35 
	#DSCP_AF43
 0x26

	)

36 
	#DSCP_AF42
 0x24

	)

37 
	#DSCP_AF41
 0x22

	)

38 
	#DSCP_AF33
 0x1E

	)

39 
	#DSCP_AF32
 0x1C

	)

40 
	#DSCP_AF31
 0x1A

	)

41 
	#DSCP_AF23
 0x16

	)

42 
	#DSCP_AF22
 0x14

	)

43 
	#DSCP_AF21
 0x12

	)

44 
	#DSCP_AF13
 0x0E

	)

45 
	#DSCP_AF12
 0x0C

	)

46 
	#DSCP_AF11
 0x0A

	)

48 
	#CS7
 0x38

	)

49 
	#CS6
 0x30

	)

50 
	#CS5
 0x28

	)

51 
	#CS4
 0x20

	)

52 
	#CS3
 0x18

	)

53 
	#CS2
 0x10

	)

54 
	#CS0
 0x00

	)

56 
	#CS1
 0x08

	)

58 
	#SLSI_TX_TIMEOUT
 (5 * 
HZ
)

	)

60 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


61 #ifdeà
CONFIG_SOC_EXYNOS9630


62 
ušt
 
	gÇpi_ıu_big_ut_š_mbps
 = 400;

63 #–ià
defšed
(
CONFIG_SOC_S5E9815
)

64 
ušt
 
	gÇpi_ıu_big_ut_š_mbps
 = 10;

66 
ušt
 
	gÇpi_ıu_big_ut_š_mbps
;

68 
moduË_·¿m
(
Çpi_ıu_big_ut_š_mbps
, , 
S_IRUGO
 | 
S_IWUSR
);

69 
MODULE_PARM_DESC
(
Çpi_ıu_big_ut_š_mbps
, "throughput (in Mbps)o switch NAPI‡nd RPSo Big CPU");

71 #ifdeà
CONFIG_SOC_S5E9815


72 
ušt
 
	g½s_’abË_ut_š_mbps
;

74 
ušt
 
	g½s_’abË_ut_š_mbps
 = 100;

76 
moduË_·¿m
(
½s_’abË_ut_š_mbps
, , 
S_IRUGO
 | 
S_IWUSR
);

77 
MODULE_PARM_DESC
(
½s_’abË_ut_š_mbps
, "throughput (in Mbps)oƒnable RPS");

79 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI_GRO


80 
	ggro_æush_timeout
 = 4000;

81 
moduË_·¿m
(
gro_æush_timeout
, 
ulÚg
, 
S_IRUGO
 | 
S_IWUSR
);

82 
MODULE_PARM_DESC
(
gro_æush_timeout
, "GROimeout (in‚s)");

84 #iâdeà
CONFIG_ARM


85 
boŞ
 
	gtı_ack_suµ»ssiÚ_di§bË
;

86 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_di§bË
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

87 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_di§bË
, "Disable TCP‡ck suppression feature");

89 
boŞ
 
	gtı_ack_suµ»ssiÚ_di§bË_2g
;

90 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_di§bË_2g
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

91 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_di§bË_2g
, "Disable TCP‡ck suppression for only 2.4GHz band");

93 
boŞ
 
	gtı_ack_suµ»ssiÚ_mÚ™Ü
 = 
Œue
;

94 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_mÚ™Ü
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

95 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_mÚ™Ü
, "TCP‡ck suppressionhroughput monitor: Y:ƒnable (default), N: disable");

97 
ušt
 
	gtı_ack_suµ»ssiÚ_mÚ™Ü_š‹rv®
 = 500;

98 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_mÚ™Ü_š‹rv®
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

99 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_mÚ™Ü_š‹rv®
, "Sampling interval (in ms) forhroughput monitor");

101 
ušt
 
	gtı_ack_suµ»ssiÚ_timeout
 = 16;

102 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_timeout
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

103 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_timeout
, "Timeout (in ms) before cached TCP‡ck is flushedox");

105 
ušt
 
	gtı_ack_suµ»ssiÚ_max
 = 16;

106 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_max
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

107 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_max
, "Maximum‚umber of TCP‡cks suppressed before†atest flushedox");

109 
ušt
 
	gtı_ack_suµ»ssiÚ_¿‹_v”y_high
 = 100;

110 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_¿‹_v”y_high
, , 
S_IRUGO
 | 
S_IWUSR
);

111 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_¿‹_v”y_high
, "Rate (in Mbps)o‡pply very high degree of suppression");

113 
ušt
 
	gtı_ack_suµ»ssiÚ_¿‹_v”y_high_timeout
 = 4;

114 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_¿‹_v”y_high_timeout
, , 
S_IRUGO
 | 
S_IWUSR
);

115 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_¿‹_v”y_high_timeout
, "Timeout (in ms) before cached TCP‡ck is flushed in very high„ate");

117 
ušt
 
	gtı_ack_suµ»ssiÚ_¿‹_v”y_high_acks
 = 20;

118 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_¿‹_v”y_high_acks
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

119 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_¿‹_v”y_high_acks
, "Maximum‚umber of TCP‡cks suppressed before†atest flushed in very high„ate");

121 
ušt
 
	gtı_ack_suµ»ssiÚ_¿‹_high
 = 20;

122 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_¿‹_high
, , 
S_IRUGO
 | 
S_IWUSR
);

123 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_¿‹_high
, "Rate (in Mbps)o‡pply high degree of suppression");

125 
ušt
 
	gtı_ack_suµ»ssiÚ_¿‹_high_timeout
 = 4;

126 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_¿‹_high_timeout
, , 
S_IRUGO
 | 
S_IWUSR
);

127 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_¿‹_high_timeout
, "Timeout (in ms) before cached TCP‡ck is flushed in high„ate");

129 
ušt
 
	gtı_ack_suµ»ssiÚ_¿‹_high_acks
 = 16;

130 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_¿‹_high_acks
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

131 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_¿‹_high_acks
, "Maximum‚umber of TCP‡cks suppressed before†atest flushed in high„ate");

133 
ušt
 
	gtı_ack_suµ»ssiÚ_¿‹_low
 = 1;

134 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_¿‹_low
, , 
S_IRUGO
 | 
S_IWUSR
);

135 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_¿‹_low
, "Rate (in Mbps)o‡pply†ow degree of suppression");

137 
ušt
 
	gtı_ack_suµ»ssiÚ_¿‹_low_timeout
 = 4;

138 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_¿‹_low_timeout
, , 
S_IRUGO
 | 
S_IWUSR
);

139 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_¿‹_low_timeout
, "Timeout (in ms) before cached TCP‡ck is flushed in†ow„ate");

141 
ušt
 
	gtı_ack_suµ»ssiÚ_¿‹_low_acks
 = 10;

142 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_¿‹_low_acks
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

143 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_¿‹_low_acks
, "Maximum‚umber of TCP‡cks suppressed before†atest flushed in†ow„ate");

145 
ušt
 
	gtı_ack_suµ»ssiÚ_¦ow_¡¬t_acks
 = 512;

146 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_¦ow_¡¬t_acks
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

147 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_¦ow_¡¬t_acks
, "Maximum‚umber of Acks sent in slow start");

149 
ušt
 
	gtı_ack_suµ»ssiÚ_rcv_wšdow
 = 128;

150 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_rcv_wšdow
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

151 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_rcv_wšdow
, "Receive window size (in unit of Kbytes)hatriggers Ack suppression");

153 
boŞ
 
	gtı_ack_suµ»ssiÚ_d–ay_acks_suµ»ss
;

154 
moduË_·¿m
(
tı_ack_suµ»ssiÚ_d–ay_acks_suµ»ss
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

155 
MODULE_PARM_DESC
(
tı_ack_suµ»ssiÚ_d–ay_acks_suµ»ss
, "0: do‚ot suppress delay Acks (default), 1: delay Acks can be suppressed");

157 #ià
KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


158 
¦si_Ãtif_tı_ack_suµ»ssiÚ_timeout
(
tim”_li¡
 *
t
);

160 
¦si_Ãtif_tı_ack_suµ»ssiÚ_timeout
(
d©a
);

162 
¦si_Ãtif_tı_ack_suµ»ssiÚ_¡¬t
(
Ãt_deviû
 *
dev
);

163 
¦si_Ãtif_tı_ack_suµ»ssiÚ_¡İ
(
Ãt_deviû
 *
dev
);

164 
sk_buff
 *
¦si_Ãtif_tı_ack_suµ»ssiÚ_pkt
(
Ãt_deviû
 *
dev
, sk_bufà*
skb
);

167 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


168 
	$¦si_Ãt_¿ndomize_nmi_ndi
(
¦si_dev
 *
sdev
)

170 
exÜ_ba£
 = 1, 
exÜ_by‹
 = 5, 
i
;

171 
u8
 
¿ndom_mac
[
ETH_ALEN
];

174 
	`SLSI_ETHER_COPY
(
¿ndom_mac
, 
sdev
->
hw_addr
);

179 
	`¦si_g‘_¿ndom_by‹s
(&
¿ndom_mac
[3], 3);

180 ià(!
	`memcmp
(&
¿ndom_mac
[3], &
sdev
->
hw_addr
[3], 3))

181 
	`¦si_g‘_¿ndom_by‹s
(&
¿ndom_mac
[3], 3);

182 
	`SLSI_ETHER_COPY
(
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_NAN
], 
¿ndom_mac
);

184 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_NAN
][0] |= 0x02;

186 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_NAN
][3] ^= 0x80;

187 
i
 = 
SLSI_NAN_DATA_IFINDEX_START
; i < 
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1; i++) {

188 
	`SLSI_ETHER_COPY
(
sdev
->
Ãtdev_add»s£s
[
i
], 
¿ndom_mac
);

189 
sdev
->
Ãtdev_add»s£s
[
i
][0] |= 0x02;

190 
sdev
->
Ãtdev_add»s£s
[
i
][
exÜ_by‹
] ^ğ
exÜ_ba£
;

191 
exÜ_ba£
++;

195 ià(
exÜ_ba£
 > 0xf)

198 
	}
}

201 
	$¦si_mac_add»ss_š™
(
¦si_dev
 *
sdev
)

203 
	`SLSI_DBG1
(
sdev
, 
SLSI_NETDEV
, "\n");

204 
	`¦si_g‘_hw_mac_add»ss
(
sdev
, sdev->
hw_addr
);

206 
	`SLSI_DBG1
(
sdev
, 
SLSI_NETDEV
, "H¬dw¬MAC‡dd»s ğ%pM\n", sdev->
hw_addr
);

208 
	`SLSI_ETHER_COPY
(
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_WLAN
], sdev->
hw_addr
);

210 
	`SLSI_ETHER_COPY
(
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2P
], sdev->
hw_addr
);

212 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2P
][0] |= 0x02;

214 
	`SLSI_ETHER_COPY
(
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2PX_SWLAN
], sdev->
hw_addr
);

216 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2PX_SWLAN
][0] |= 0x02;

218 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2PX_SWLAN
][4] ^= 0x80;

220 #ià
CONFIG_SCSC_WLAN_MAX_INTERFACES
 >ğ4 && 
	`defšed
(
CONFIG_SCSC_WIFI_NAN_ENABLE
)

221 ià(
	`¦si_g‘_Çn_mac_¿ndom
())

222 
	`¦si_Ãt_¿ndomize_nmi_ndi
(
sdev
);

224 
	}
}

226 
šlše
 
boŞ
 
	$¦si_Ãtif_is_udp_pkt
(
sk_buff
 *
skb
)

228 ià(
	`_hdr
(
skb
)->
v”siÚ
 == 4)

229  (
	`_hdr
(
skb
)->
´ÙocŞ
 =ğ
IPPROTO_UDP
);

230 ià(
	`_hdr
(
skb
)->
v”siÚ
 == 6)

231  (
	`v6_hdr
(
skb
)->
Ãxthdr
 =ğ
NEXTHDR_UDP
);

233  
çl£
;

234 
	}
}

236 
šlše
 
	$¦si_Ãtif_£t_tid_chªge_tid
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

238 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

240 ià(
ndev_vif
->
£t_tid_©Œ
.
mode
 =ğ
SLSI_NETIF_SET_TID_OFF
)

244 ià(
skb
->
´iÜ™y
 !ğ
FAPI_PRIORITY_QOS_UP0
)

248 ià(!
	`¦si_Ãtif_is_udp_pkt
(
skb
))

251 
skb
->
´iÜ™y
 = 
ndev_vif
->
£t_tid_©Œ
.
tid
;

252 
	}
}

254 
	$¦si_Ãtif_£t_tid_cÚfig
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 
mode
, 
u32
 
uid
, u8 
tid
)

256 
Ãtdev_vif
 *
ndev_vif
;

257 
»t
 = 0;

259 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

261 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

262 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

263 ià(!
ndev_vif
->
aùiv©ed
) {

264 
	`SLSI_NET_WARN
(
dev
, "invalid VIF\n");

265 
»t
 = -
ENODEV
;

266 
ex™
;

269 ià(
mode
 > 
SLSI_NETIF_SET_TID_ALL_UDP
) {

270 
	`SLSI_NET_WARN
(
dev
, "šv®id mod%d\n", 
mode
);

271 
»t
 = -
EINVAL
;

272 
ex™
;

275 ià(
tid
 > 
FAPI_PRIORITY_QOS_UP7
) {

276 
	`SLSI_NET_WARN
(
dev
, "šv®id TID %d\n", 
tid
);

277 
»t
 = -
EINVAL
;

278 
ex™
;

281 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "mode:%d uid:%did:%d\n", 
mode
, 
uid
, 
tid
);

282 
ndev_vif
->
£t_tid_©Œ
.
mode
 = mode;

283 
ndev_vif
->
£t_tid_©Œ
.
uid
 = uid;

284 
ndev_vif
->
£t_tid_©Œ
.
tid
 =id;

286 
ex™
:

287 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

288 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

289  
»t
;

290 
	}
}

293 
	$¦si_Ãt_İ’
(
Ãt_deviû
 *
dev
)

295 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

296 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

297 
”r
;

298 
dev_addr_z”o_check
[
ETH_ALEN
];

299 
Ãt_deviû
 *
­_dev
 = 
NULL
;

300 
Ãtdev_vif
 *
­_dev_vif
;

301 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


302 
Ãt_deviû
 *
Çn_dev
;

303 
Ãtdev_vif
 *
Çn_ndev_vif
;

305 #ià
	`defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

306 
u8
 
mhs_Ü_du®_¡a_mac
[
ETH_ALEN
];

308 
r
 = 0;

310 ià(
	`WARN_ON
(
ndev_vif
->
is_avaabË
))

311  -
EINVAL
;

313 ià(
sdev
->
mlme_blocked
) {

314 
	`SLSI_NET_WARN
(
dev
, "Fail: called when MLME in blocked state\n");

315 
	`¦si_dump_sy¡em_”rÜ_bufãr
(
sdev
);

316  -
EIO
;

319 ià(
sdev
->
»cov”y_ç_§ã
) {

320 
r
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sdev
->
»cov”y_ç_§ã_com¶‘e
,

321 
	`m£cs_to_jiff›s
(
SLSI_SYS_ERROR_RECOVERY_TIMEOUT
));

323 ià(
r
 == 0) {

324 
	`SLSI_INFO
(
sdev
, "Fail: systemƒrror„ecovery still in…rogress\n");

325 
	`¦si_dump_sy¡em_”rÜ_bufãr
(
sdev
);

327 
	`»š™_com¶‘iÚ
(&
sdev
->
»cov”y_ç_§ã_com¶‘e
);

330 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl_š™
);

332 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

333 ià(!
sdev
->
Ãtdev_up_couÁ
) {

334 
	`¦si_purge_bÏckli¡
(
ndev_vif
);

335 
	`mem£t
(&
sdev
->
wake_»asÚ_¡©s
, 0, (
¦si_wÏn_driv”_wake_»asÚ_út
));

336 } ià(
sdev
->
Ãtdev_up_couÁ
 == 1) {

337 
­_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2PX_SWLAN
);

338 ià(
­_dev
) {

339 
­_dev_vif
 = 
	`Ãtdev_´iv
(
­_dev
);

340 ià(
­_dev_vif
->
is_avaabË
) {

341 
	`mem£t
(&
sdev
->
wake_»asÚ_¡©s
, 0, (
¦si_wÏn_driv”_wake_»asÚ_út
));

342 
	`¦si_purge_bÏckli¡
(
ndev_vif
);

347 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

349 
”r
 = 
	`¦si_¡¬t
(
sdev
, 
dev
);

350 ià(
	`WARN_ON
(
”r
)) {

351 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl_š™
);

352  
”r
;

355 ià(!
sdev
->
Ãtdev_up_couÁ
) {

356 
	`¦si_mac_add»ss_š™
(
sdev
);

357 
sdev
->
š™Ÿl_sÿn
 = 
Œue
;

358 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


359 
Çn_dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

360 
Çn_ndev_vif
 = 
Çn_dev
 ? 
	`Ãtdev_´iv
Òª_devè: 
NULL
;

361 ià(
Çn_ndev_vif
)

362 
	`»š™_com¶‘iÚ
(&
Çn_ndev_vif
->
sig_wa™
.
com¶‘iÚ
);

365 
ndev_vif
->
acs
 = 
çl£
;

366 
	`mem£t
(
dev_addr_z”o_check
, 0, 
ETH_ALEN
);

367 ià((!
	`memcmp
(
dev
->
dev_addr
, 
dev_addr_z”o_check
, 
ETH_ALEN
)) ||

368 (
	`SLSI_IS_VIF_INDEX_MHS_DUALSTA
(
sdev
, 
ndev_vif
è&& (!
	`memcmp
(
dev
->
dev_addr
, 
SLSI_DEFAULT_HW_MAC_ADDR
, 
ETH_ALEN
)))) {

369 #ià
	`defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

370 ià(
	`SLSI_IS_VIF_INDEX_MHS_DUALSTA
(
sdev
, 
ndev_vif
)) {

371 
	`SLSI_ETHER_COPY
(
mhs_Ü_du®_¡a_mac
, 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2PX_SWLAN
]);

372 
mhs_Ü_du®_¡a_mac
[2] ^= 0x80;

373 
	`SLSI_ETHER_COPY
(
dev
->
dev_addr
, 
mhs_Ü_du®_¡a_mac
);

375 
	`SLSI_ETHER_COPY
(
dev
->
dev_addr
, 
sdev
->
Ãtdev_add»s£s
[
ndev_vif
->
iâum
]);

378 
	`SLSI_ETHER_COPY
(
dev
->
dev_addr
, 
sdev
->
Ãtdev_add»s£s
[
ndev_vif
->
iâum
]);

381 #ià
	`defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

382 ià(!
	`SLSI_IS_VIF_INDEX_MHS_DUALSTA
(
sdev
, 
ndev_vif
)) {

383 
	`SLSI_ETHER_COPY
(
dev
->
³rm_addr
, 
sdev
->
Ãtdev_add»s£s
[
ndev_vif
->
iâum
]);

385 
	`SLSI_ETHER_COPY
(
mhs_Ü_du®_¡a_mac
, 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2PX_SWLAN
]);

386 
mhs_Ü_du®_¡a_mac
[2] ^= 0x80;

387 
	`SLSI_ETHER_COPY
(
dev
->
³rm_addr
, 
mhs_Ü_du®_¡a_mac
);

390 
	`SLSI_ETHER_COPY
(
dev
->
³rm_addr
, 
sdev
->
Ãtdev_add»s£s
[
ndev_vif
->
iâum
]);

393 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

395 
	`»š™_com¶‘iÚ
(&
ndev_vif
->
sig_wa™
.
com¶‘iÚ
);

397 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_MONITOR
) {

398 
”r
 = 
	`¦si_¡¬t_mÚ™Ü_mode
(
sdev
, 
dev
);

399 ià(
	`WARN_ON
(
”r
)) {

400 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

401 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl_š™
);

402  
”r
;

405 
	`SLSI_NET_INFO
(
dev
, "iâum:%d„:%d MAC:" 
MACSTR
 "\n", 
ndev_vif
->
iâum
, 
sdev
->
»cov”y_¡©us
, 
	`MAC2STR
(dev->
dev_addr
));

406 
ndev_vif
->
is_avaabË
 = 
Œue
;

407 
sdev
->
Ãtdev_up_couÁ
++;

409 #iâdeà
CONFIG_ARM


410 
	`¦si_Ãtif_tı_ack_suµ»ssiÚ_¡¬t
(
dev
);

413 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

415 
	`Ãtif_tx_¡¬t_®l_queues
(
dev
);

416 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl_š™
);

420 ià(
	`¦si_is_rf_‹¡_mode_’abËd
()) {

421 
	`SLSI_NET_INFO
(
dev
, "*#rf#„fest mode set isƒnabled.\n");

422 
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAMING_ACTIVATED
, 0);

423 
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAM_MODE
, 0);

424 
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 2511, 1);

425 
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_TPC_MAX_POWER_RSSI_THRESHOLD
, 0);

429 
	}
}

431 
	$¦si_Ãt_¡İ
(
Ãt_deviû
 *
dev
)

433 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

434 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

435 
r
 = 0;

437 ià(
sdev
->
»cov”y_ç_§ã
) {

438 
r
 = 
	`wa™_fÜ_com¶‘iÚ_timeout
(&
sdev
->
»cov”y_ç_§ã_com¶‘e
,

439 
	`m£cs_to_jiff›s
(
SLSI_SYS_ERROR_RECOVERY_TIMEOUT
));

441 ià(
r
 == 0) {

442 
	`SLSI_INFO
(
sdev
, "Fail: systemƒrror„ecovery still in…rogress\n");

443 
	`¦si_dump_sy¡em_”rÜ_bufãr
(
sdev
);

445 
	`»š™_com¶‘iÚ
(&
sdev
->
»cov”y_ç_§ã_com¶‘e
);

448 
	`SLSI_NET_INFO
(
dev
, "iâum:%d„:%d\n", 
ndev_vif
->
iâum
, 
sdev
->
»cov”y_¡©us
);

449 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

450 
	`Ãtif_tx_¡İ_®l_queues
(
dev
);

451 
sdev
->
š™Ÿl_sÿn
 = 
çl£
;

452 
ndev_vif
->
acs
 = 
çl£
;

453 ià(!
ndev_vif
->
is_avaabË
) {

455 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "Not‡vailable\n");

456 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

459 #iâdeà
CONFIG_ARM


460 
	`¦si_Ãtif_tı_ack_suµ»ssiÚ_¡İ
(
dev
);

462 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

463 
	`¦si_¡İ_Ãt_dev
(
sdev
, 
dev
);

464 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

465 
sdev
->
®low_sw™ch_40_mhz
 = 
Œue
;

466 
sdev
->
®low_sw™ch_80_mhz
 = 
Œue
;

467 
sdev
->
acs_chªÃl_sw™ched
 = 
çl£
;

468 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

470 
	}
}

473 
	$¦si_Ãt_ioùl
(
Ãt_deviû
 *
dev
, 
iäeq
 *
rq
, 
cmd
)

475 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_NETDEV
, "IOCTL cmd:0x%.4x\n", 
cmd
);

477 ià(
cmd
 =ğ
SIOCDEVPRIVATE
 + 2) {

478  
	`¦si_ioùl
(
dev
, 
rq
, 
cmd
);

481  -
EOPNOTSUPP
;

482 
	}
}

484 
Ãt_deviû_¡©s
 *
	$¦si_Ãt_g‘_¡©s
(
Ãt_deviû
 *
dev
)

486 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

488 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_NETDEV
, "\n");

489  &
ndev_vif
->
¡©s
;

490 
	}
}

492 
	$¦si_Ãtif_show_¡©s
(
Ãt_deviû
 *
dev
)

494 
Ãt_deviû_¡©s
 *
¡©s
;

496 
¡©s
 = 
	`¦si_Ãt_g‘_¡©s
(
dev
);

497 ià(!
¡©s
) {

498 
	`SLSI_NET_ERR
(
dev
, "Cª'ˆg‘ st oà%s\n", dev->
Çme
);

502 
	`SLSI_NET_INFO
(
dev
, "[tx]bytes %lu…ackets %luƒrr %lu drop %lu fifo %lu colls %lu carrier %lu comp %lu\n",

503 
¡©s
->
tx_by‹s
, sts->
tx_·ck‘s
, sts->
tx_”rÜs
, sts->
tx_drİ³d
, sts->
tx_fifo_”rÜs
,

504 
¡©s
->
cŞlisiÚs
, sts->
tx_ÿ¼›r_”rÜs
, sts->
tx_com´es£d
);

505 
	`SLSI_NET_INFO
(
dev
, "[rx]bytes %lu…ackets %luƒrr %lu drop %lu fifo %lu frame %lu comp %lu mc %lu\n",

506 
¡©s
->
rx_by‹s
, sts->
rx_·ck‘s
, sts->
rx_”rÜs
, sts->
rx_drİ³d
, sts->
tx_fifo_”rÜs
,

507 
¡©s
->
rx_äame_”rÜs
, sts->
rx_com´es£d
, sts->
muÉiÿ¡
);

508 
	}
}

510 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 6, 0))

511 
	$¦si_Ãt_tx_timeout
(
Ãt_deviû
 *
dev
, 
txqueue
)

513 
	$¦si_Ãt_tx_timeout
(
Ãt_deviû
 *
dev
)

516 ià(!
	`Ãt_¿‹lim™
())

519 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 6, 0))

520 
	`SLSI_NET_ERR
(
dev
, "T¿nsm™ Timed Out!!!‚am% ¡©0x%lxxq %u\n", dev->
Çme
, dev->
¡©e
, 
txqueue
);

522 
	`SLSI_NET_ERR
(
dev
, "T¿nsm™ Timed Out!!!‚am% ¡©0x%lx\n", dev->
Çme
, dev->
¡©e
);

525 
	`¦si_Ãtif_show_¡©s
(
dev
);

526 
	}
}

528 #ifdeà
CONFIG_SCSC_USE_WMM_TOS


529 
u16
 
	$¦si_g‘_´iÜ™y_äom_tos
(
u8
 *
äame
, 
u16
 
´Ùo
)

531 ià(
	`WARN_ON
(!
äame
))

532  
FAPI_PRIORITY_QOS_UP0
;

534 
´Ùo
) {

535 
ETH_P_IP
:

536  (
u16
)(((
äame
[
IP4_OFFSET_TO_TOS_FIELD
]) & 0xE0) >> 5);

538 
ETH_P_IPV6
:

539  (
u16
)((*
äame
 & 0x0E) >> 1);

542  
FAPI_PRIORITY_QOS_UP0
;

544 
	}
}

547 
u16
 
	$¦si_g‘_´iÜ™y_äom_tos_dsı
(
u8
 *
äame
, 
u16
 
´Ùo
)

549 
u8
 
dsı
;

551 ià(
	`WARN_ON
(!
äame
))

552  
FAPI_PRIORITY_QOS_UP0
;

554 
´Ùo
) {

555 
ETH_P_IP
:

556 
dsı
 = 
äame
[
IP4_OFFSET_TO_TOS_FIELD
] >> 
FIELD_TO_DSCP
;

559 
ETH_P_IPV6
:

561 
dsı
 = (((
äame
[
IP6_OFFSET_TO_TC_FIELD_0
] & 0x0F) << 4) |

562 ((
äame
[
IP6_OFFSET_TO_TC_FIELD_1
] & 0xF0è>> 4)è>> 
FIELD_TO_DSCP
;

566  
FAPI_PRIORITY_QOS_UP0
;

569 #ià(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

570 
dsı
) {

571 
CS7
:

572 
CS6
:

573  
FAPI_PRIORITY_QOS_UP7
;

574 
DSCP_EF
:

575 
DSCP_VA
:

576  
FAPI_PRIORITY_QOS_UP6
;

577 
CS5
:

578  
FAPI_PRIORITY_QOS_UP5
;

579 
DSCP_AF41
:

580 
DSCP_AF42
:

581 
DSCP_AF43
:

582 
CS4
:

583 
DSCP_AF31
:

584 
DSCP_AF32
:

585 
DSCP_AF33
:

586 
CS3
:

587  
FAPI_PRIORITY_QOS_UP4
;

588 
DSCP_AF21
:

589 
DSCP_AF22
:

590 
DSCP_AF23
:

591  
FAPI_PRIORITY_QOS_UP3
;

592 
CS2
:

593 
DSCP_AF11
:

594 
DSCP_AF12
:

595 
DSCP_AF13
:

596 
CS0
:

597  
FAPI_PRIORITY_QOS_UP0
;

598 
CS1
:

599  
FAPI_PRIORITY_QOS_UP1
;

601  
FAPI_PRIORITY_QOS_UP0
;

604 
dsı
) {

605 
DSCP_EF
:

606 
DSCP_VA
:

607  
FAPI_PRIORITY_QOS_UP6
;

608 
DSCP_AF43
:

609 
DSCP_AF42
:

610 
DSCP_AF41
:

611  
FAPI_PRIORITY_QOS_UP5
;

612 
DSCP_AF33
:

613 
DSCP_AF32
:

614 
DSCP_AF31
:

615 
DSCP_AF23
:

616 
DSCP_AF22
:

617 
DSCP_AF21
:

618 
DSCP_AF13
:

619 
DSCP_AF12
:

620 
DSCP_AF11
:

621  
FAPI_PRIORITY_QOS_UP0
;

622 
CS7
:

623  
FAPI_PRIORITY_QOS_UP7
;

624 
CS6
:

625  
FAPI_PRIORITY_QOS_UP6
;

626 
CS5
:

627  
FAPI_PRIORITY_QOS_UP5
;

628 
CS4
:

629  
FAPI_PRIORITY_QOS_UP4
;

630 
CS3
:

631  
FAPI_PRIORITY_QOS_UP3
;

632 
CS2
:

633  
FAPI_PRIORITY_QOS_UP2
;

634 
CS1
:

635  
FAPI_PRIORITY_QOS_UP1
;

636 
CS0
:

637  
FAPI_PRIORITY_QOS_UP0
;

639  
FAPI_PRIORITY_QOS_UP0
;

642 
	}
}

646 
boŞ
 
	$¦si_Ãt_downg¿de_ac
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

648 
	`SLSI_UNUSED_PARAMETER
(
dev
);

650 
skb
->
´iÜ™y
) {

653 
skb
->
´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP5
;

654  
Œue
;

657 
skb
->
´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP3
;

658  
Œue
;

661 
skb
->
´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP2
;

662  
Œue
;

664  
çl£
;

666 
	}
}

668 
u8
 
	$¦si_Ãt_up_to_ac_m­pšg
(
u8
 
´iÜ™y
)

670 
´iÜ™y
) {

671 
FAPI_PRIORITY_QOS_UP6
:

672 
FAPI_PRIORITY_QOS_UP7
:

673  
	`BIT
(
FAPI_PRIORITY_QOS_UP6
è| BIT(
FAPI_PRIORITY_QOS_UP7
);

674 
FAPI_PRIORITY_QOS_UP4
:

675 
FAPI_PRIORITY_QOS_UP5
:

676  
	`BIT
(
FAPI_PRIORITY_QOS_UP4
è| BIT(
FAPI_PRIORITY_QOS_UP5
);

677 
FAPI_PRIORITY_QOS_UP0
:

678 
FAPI_PRIORITY_QOS_UP3
:

679  
	`BIT
(
FAPI_PRIORITY_QOS_UP0
è| BIT(
FAPI_PRIORITY_QOS_UP3
);

681  
	`BIT
(
FAPI_PRIORITY_QOS_UP1
è| BIT(
FAPI_PRIORITY_QOS_UP2
);

683 
	}
}

685 
¦si_Œaffic_q
 
	$¦si_äame_´iÜ™y_to_ac_queue
(
u16
 
´iÜ™y
)

687 
´iÜ™y
) {

688 
FAPI_PRIORITY_QOS_UP0
:

689 
FAPI_PRIORITY_QOS_UP3
:

690  
SLSI_TRAFFIC_Q_BE
;

691 
FAPI_PRIORITY_QOS_UP1
:

692 
FAPI_PRIORITY_QOS_UP2
:

693  
SLSI_TRAFFIC_Q_BK
;

694 
FAPI_PRIORITY_QOS_UP4
:

695 
FAPI_PRIORITY_QOS_UP5
:

696  
SLSI_TRAFFIC_Q_VI
;

697 
FAPI_PRIORITY_QOS_UP6
:

698 
FAPI_PRIORITY_QOS_UP7
:

699  
SLSI_TRAFFIC_Q_VO
;

701  
SLSI_TRAFFIC_Q_BE
;

703 
	}
}

705 
	$¦si_ac_to_tids
(
¦si_Œaffic_q
 
ac
, *
tids
)

707 
ac
) {

708 
SLSI_TRAFFIC_Q_BE
:

709 
tids
[0] = 
FAPI_PRIORITY_QOS_UP0
;

710 
tids
[1] = 
FAPI_PRIORITY_QOS_UP3
;

713 
SLSI_TRAFFIC_Q_BK
:

714 
tids
[0] = 
FAPI_PRIORITY_QOS_UP1
;

715 
tids
[1] = 
FAPI_PRIORITY_QOS_UP2
;

718 
SLSI_TRAFFIC_Q_VI
:

719 
tids
[0] = 
FAPI_PRIORITY_QOS_UP4
;

720 
tids
[1] = 
FAPI_PRIORITY_QOS_UP5
;

723 
SLSI_TRAFFIC_Q_VO
:

724 
tids
[0] = 
FAPI_PRIORITY_QOS_UP6
;

725 
tids
[1] = 
FAPI_PRIORITY_QOS_UP7
;

729  -
EINVAL
;

733 
	}
}

735 
	$¦si_Ãt_downg¿de_´i
(
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
,

736 
sk_buff
 *
skb
)

741 
	`uÆik–y
(
³”
->
wmm_acm
 & 
	`BIT
(
skb
->
´iÜ™y
)) &&

742 !(
³”
->
t¥ec_e¡ablished
 & 
	`¦si_Ãt_up_to_ac_m­pšg
(
skb
->
´iÜ™y
))) {

743 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_NETDEV
, "Downg¿dšg from UP:%d\n", 
skb
->
´iÜ™y
);

744 ià(!
	`¦si_Ãt_downg¿de_ac
(
dev
, 
skb
))

747 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_NETDEV
, "TØUP:%d\n", 
skb
->
´iÜ™y
);

748 
	}
}

750 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 4, 0))

751 
u16
 
	$¦si_Ãt_£Ëù_queue
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, Ãt_deviû *
sb_dev
)

752 #–ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 19, 0))

753 
u16
 
	$¦si_Ãt_£Ëù_queue
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, Ãt_deviû *
sb_dev
, 
£Ëù_queue_çÎback_t
 
çÎback
)

755 
u16
 
	$¦si_Ãt_£Ëù_queue
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, *
acûl_´iv
, 
£Ëù_queue_çÎback_t
 
çÎback
)

758 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

759 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

760 
u16
 
Ãtif_q
 = 0;

761 
‘hhdr
 *
ehdr
 = (‘hhd¸*)
skb
->
d©a
;

762 
´Ùo
 = 0;

763 
¦si_³”
 *
³”
;

764 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 19, 0))

765 ()
sb_dev
;

767 ()
acûl_´iv
;

769 #ià(
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(5, 4, 0))

770 ()
çÎback
;

772 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_NETDEV
, "\n");

775 ià(!
	`skb_mac_h—d”_was_£t
(
skb
))

776 
	`skb_»£t_mac_h—d”
(
skb
);

778 ià(
	`is_z”o_‘h”_addr
(
ehdr
->
h_sourû
)) {

779 
	`SLSI_NET_WARN
(
dev
, "šv®id sourû‡dd»s (¤c:" 
MACSTR
 ")\n", 
	`MAC2STR
(
ehdr
->
h_sourû
));

780 
	`SCSC_BIN_TAG_INFO
(
BINARY
, 
skb
->
d©a
, skb->
Ën
 > 128 ? 128 : skb->len);

781  
SLSI_NETIF_Q_DISCARD
;

784 
´Ùo
 = 
	`be16_to_ıu
(
	`‘h_hdr
(
skb
)->
h_´Ùo
);

786 
´Ùo
) {

790 
ETH_P_PAE
:

791 
ETH_P_WAI
:

792 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
,

794  
SLSI_NETIF_Q_PRIORITY
;

795 
ETH_P_ARP
:

796 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
, "ARP frame. ARP Queue Selected\n");

797  
SLSI_NETIF_Q_ARP
;

798 
ETH_P_IP
:

799 ià(
	`¦si_is_dhı_·ck‘
(
skb
->
d©a
è=ğ
SLSI_TX_IS_NOT_DHCP
)

801 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
,

803  
SLSI_NETIF_Q_PRIORITY
;

806 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
)

808 ià(
	`is_muÉiÿ¡_‘h”_addr
(
ehdr
->
h_de¡
)) {

809 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
, "Multicast AC queue will be selected\n");

810 #ifdeà
CONFIG_SCSC_USE_WMM_TOS


811 
skb
->
´iÜ™y
 = 
	`¦si_g‘_´iÜ™y_äom_tos
(skb->
d©a
 + 
ETH_HLEN
, 
´Ùo
);

813 
skb
->
´iÜ™y
 = 
	`¦si_g‘_´iÜ™y_äom_tos_dsı
(skb->
d©a
 + 
ETH_HLEN
, 
´Ùo
);

815  
	`¦si_Ãtif_g‘_muÉiÿ¡_queue
(
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
));

818 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

819 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
ehdr
->
h_de¡
);

820 ià(!
³”
) {

821 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "Disÿrd: P“¸%pM NOT found\n", 
ehdr
->
h_de¡
);

822 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

823  
SLSI_NETIF_Q_DISCARD
;

826 ià(
³”
->
qos_’abËd
) {

827 ià(
³”
->
qos_m­_£t
) {

828 
skb
->
´iÜ™y
 = 
	`cfg80211_şassify8021d
(skb, &
³”
->
qos_m­
);

830 #ifdeà
CONFIG_SCSC_WLAN_PRIORITISE_IMP_FRAMES


831 ià((
´Ùo
 =ğ
ETH_P_IP
 && 
	`¦si_is_dns_·ck‘
(
skb
->
d©a
)) ||

832 (
´Ùo
 =ğ
ETH_P_IP
 && 
	`¦si_is_mdns_·ck‘
(
skb
->
d©a
)) ||

833 (
´Ùo
 =ğ
ETH_P_IP
 && 
	`¦si_is_tı_sync_·ck‘
(
dev
, 
skb
))) {

834 
skb
->
´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP7
;

838 #ifdeà
CONFIG_SCSC_USE_WMM_TOS


839 
skb
->
´iÜ™y
 = 
	`¦si_g‘_´iÜ™y_äom_tos
(skb->
d©a
 + 
ETH_HLEN
, 
´Ùo
);

841 
skb
->
´iÜ™y
 = 
	`¦si_g‘_´iÜ™y_äom_tos_dsı
(skb->
d©a
 + 
ETH_HLEN
, 
´Ùo
);

845 
	`¦si_Ãtif_£t_tid_chªge_tid
(
dev
, 
skb
);

847 
skb
->
´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP0
;

850 
	`¦si_Ãt_downg¿de_´i
(
dev
, 
³”
, 
skb
);

852 
Ãtif_q
 = 
	`¦si_Ãtif_g‘_³”_queue
(
³”
->
queue£t
, 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
));

853 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
, "´io:%d queue:%u\n", 
skb
->
´iÜ™y
, 
Ãtif_q
);

854 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

855  
Ãtif_q
;

856 
	}
}

858 
	$¦si_tdls_move_·ck‘s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

859 
¦si_³”
 *
¡a_³”
, ¦si_³” *
tdls_³”
, 
boŞ
 
cÚÃùiÚ
)

861 
Ãtdev_vif
 *Ãtdev_viàğ
	`Ãtdev_´iv
(
dev
);

862 
sk_buff
 *
skb
 = 
NULL
;

863 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 7, 0))

864 
sk_buff
 *
skb_to_ä“
 = 
NULL
;

866 
‘hhdr
 *
ehdr
;

867 
Qdisc
 *
qd
;

868 
u32
 
num_pkts
;

869 
u16
 
¡aq
;

870 
u16
 
tdlsq
;

871 
u16
 
Ãtq
;

872 
u16
 
i
;

873 
u16
 
j
;

874 
šdex
;

875 
¦si_tı_ack_s
 *
tı_ack
;

878 
¡aq
 = 
	`¦si_Ãtif_g‘_³”_queue
(
¡a_³”
->
queue£t
, 0);

879 
tdlsq
 = 
	`¦si_Ãtif_g‘_³”_queue
(
tdls_³”
->
queue£t
, 0);

881 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TDLS
, "Connection: %d, sta_qset: %d,dls_qset: %d, sta_netq: %d,dls_netq: %d\n",

882 
cÚÃùiÚ
, 
¡a_³”
->
queue£t
, 
tdls_³”
->queue£t, 
¡aq
, 
tdlsq
);

885 
	`¦si_tx_·u£_queues
(
sdev
);

888 
šdex
 = 0; index < 
TCP_ACK_SUPPRESSION_RECORDS_MAX
; index++) {

889 
tı_ack
 = &
Ãtdev_vif
->
ack_suµ»ssiÚ
[
šdex
];

890 ià(!
tı_ack
->
¡©e
)

893 
	`skb_queue_w®k
(&
tı_ack
->
li¡
, 
skb
) {

894 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_TDLS
, "äamš TCP Ack†i¡ (³”:%pM)\n", 
	`‘h_hdr
(
skb
)->
h_de¡
);

896 ià(
	`com·»_‘h”_addr
(
tdls_³”
->
add»ss
, 
	`‘h_hdr
(
skb
)->
h_de¡
) == 0) {

897 ià(
cÚÃùiÚ
) {

899 
skb
->
queue_m­pšg
 +ğ(
tdls_³”
->
queue£t
 * 
SLSI_NETIF_Q_PER_PEER
);

902 
skb
->
queue_m­pšg
 -ğ(
tdls_³”
->
queue£t
 * 
SLSI_NETIF_Q_PER_PEER
);

912 ià(
cÚÃùiÚ
)

913 
tdls_³”
->
v®id
 = 
Œue
;

915 
tdls_³”
->
v®id
 = 
çl£
;

918 
i
 = 0; i < 
SLSI_NETIF_Q_PER_PEER
; i++) {

919 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_TDLS
, "NETQ%d: Before:dlsq_len = %d, staq_len = %d\n",

920 
i
, 
dev
->
_tx
[
tdlsq
 + i].
qdisc
->
q
.
qËn
, dev->_tx[
¡aq
 + i].qdisc->q.qlen);

922 ià(
cÚÃùiÚ
) {

924 ià(
dev
->
_tx
[
tdlsq
 + 
i
].
qdisc
->
q
.
qËn
)

925 
	`SLSI_NET_ERR
(
dev
, "tdls_cÚÃùiÚ: Pack‘…»£Á iÀqueu%d\n", 
tdlsq
 + 
i
);

927 
qd
 = 
dev
->
_tx
[
¡aq
 + 
i
].
qdisc
;

929 
num_pkts
 = 
qd
->
q
.
qËn
;

932 
j
 = 0; j < 
num_pkts
; j++) {

933 
qd
 = 
dev
->
_tx
[
¡aq
 + 
i
].
qdisc
;

935 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 16, 0))

936 
skb
 = 
	`skb_³ek
(&
qd
->
gso_skb
);

938 
skb
 = 
qd
->
gso_skb
;

940 ià(
skb
) {

941 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 16, 0))

942 
skb
 = 
	`__skb_dequeue
(&
qd
->
gso_skb
);

944 
qd
->
gso_skb
 = 
NULL
;

946 
qd
->
q
.
qËn
--;

948 
skb
 = 
qd
->
	`dequeue
(qd);

951 ià(!
skb
) {

952 
	`SLSI_NET_ERR
(
dev
, "tdls_connection: STA NETQ skb is NULL\n");

957 
Ãtq
 = 
skb
->
queue_m­pšg
;

958 
ehdr
 = (
‘hhdr
 *)
skb
->
d©a
;

959 ià(
	`com·»_‘h”_addr
(
tdls_³”
->
add»ss
, 
ehdr
->
h_de¡
) == 0) {

960 
Ãtq
 +ğ(
tdls_³”
->
queue£t
 * 
SLSI_NETIF_Q_PER_PEER
);

961 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TDLS
, "NETQ%d: Queue mapping changed from %do %d\n",

962 
i
, 
skb
->
queue_m­pšg
, 
Ãtq
);

963 
	`skb_£t_queue_m­pšg
(
skb
, 
Ãtq
);

966 
qd
 = 
dev
->
_tx
[
Ãtq
].
qdisc
;

967 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 7, 0))

968 
qd
->
	`’queue
(
skb
, qd, &
skb_to_ä“
);

971 
qd
->
	`’queue
(
skb
, qd);

975 
num_pkts
 = 
dev
->
_tx
[
tdlsq
 + 
i
].
qdisc
->
q
.
qËn
;

977 
j
 = 0; j < 
num_pkts
; j++) {

979 
qd
 = 
dev
->
_tx
[
tdlsq
 + 
i
].
qdisc
;

980 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 16, 0))

981 
skb
 = 
	`skb_³ek
(&
qd
->
gso_skb
);

983 
skb
 = 
qd
->
gso_skb
;

985 ià(
skb
) {

986 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 16, 0))

987 
skb
 = 
	`__skb_dequeue
(&
qd
->
gso_skb
);

989 
qd
->
gso_skb
 = 
NULL
;

991 
qd
->
q
.
qËn
--;

993 
skb
 = 
qd
->
	`dequeue
(qd);

996 ià(!
skb
) {

997 
	`SLSI_NET_ERR
(
dev
, "tdls_teardown: TDLS NETQ skb is NULL\n");

1002 
	`skb_£t_queue_m­pšg
(
skb
, 
¡aq
 + 
i
);

1005 
qd
 = 
dev
->
_tx
[
¡aq
 + 
i
].
qdisc
;

1006 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 7, 0))

1007 
qd
->
	`’queue
(
skb
, qd, &
skb_to_ä“
);

1010 
qd
->
	`’queue
(
skb
, qd);

1014 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_TDLS
, "NETQ%d: After :dlsq_len = %d, staq_len = %d\n",

1015 
i
, 
dev
->
_tx
[
tdlsq
 + i].
qdisc
->
q
.
qËn
, dev->_tx[
¡aq
 + i].qdisc->q.qlen);

1017 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 7, 0))

1018 ià(
	`uÆik–y
(
skb_to_ä“
))

1019 
	`kä“_skb_li¡
(
skb_to_ä“
);

1023 ià(!
cÚÃùiÚ
)

1024 
i
 = 0; i < 
SLSI_NETIF_Q_PER_PEER
; i++) {

1025 ià(
dev
->
_tx
[
tdlsq
 + 
i
].
qdisc
->
q
.
qËn
)

1026 
	`SLSI_NET_ERR
(
dev
, "tdls_‹¬down: Pack‘…»£Á iÀNET queu%d\n", 
tdlsq
 + 
i
);

1030 
	`¦si_tx_uÅau£_queues
(
sdev
);

1031 
	}
}

1068 
Ãtdev_tx_t
 
	$¦si_Ãt_hw_xm™
(
sk_buff
 *
skb
, 
Ãt_deviû
 *
dev
)

1070 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1071 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1072 
r
 = 
NETDEV_TX_OK
;

1073 
sk_buff
 *
Üigš®_skb
 = 
NULL
;

1074 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1075 
known_u£rs
 = 0;

1082 
·ck‘_Ën
 = 
skb
->
Ën
;

1083 
¦si_Œaffic_q
 
Œaffic_q
 = 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
);

1085 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

1086 
	`¦si_skb_cb_š™
(
skb
);

1094 ià((
ušŒ_t
)
skb
->
d©a
 & 0x1) {

1095 
sk_buff
 *
skb2
 = 
NULL
;

1099 
skb2
 = 
	`skb_cİy_ex·nd
(
skb
, 
SLSI_NETIF_SKB_HEADROOM
, 
	`skb_room
(skb), 
GFP_ATOMIC
);

1100 ià(
skb2
 && (!(((
ušŒ_t
)skb2->
d©a
) & 0x1))) {

1102 
Üigš®_skb
 = 
skb
;

1103 
skb
 = 
skb2
;

1104 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
, "Oddly‡ligned skb„ealigned\n");

1107 
	`SLSI_NET_WARN
(
dev
, "Oddly‡ligned skb failed„ealignment, dropping\n");

1108 ià(
skb2
) {

1109 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
, "skb_copy_expand didn't‡lign for us\n");

1110 
	`kä“_skb
(
skb2
);

1112 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
, "skb_copy_expand failed whenryingo‡lign\n");

1114 
r
 = -
EFAULT
;

1115 
ev®u©e
;

1124 ià(!
	`skb_mac_h—d”_was_£t
(
skb
))

1125 
	`skb_»£t_mac_h—d”
(
skb
);

1127 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
, "PrÙØ0x%.4X\n", 
	`be16_to_ıu
(
	`‘h_hdr
(
skb
)->
h_´Ùo
));

1129 ià(!
ndev_vif
->
is_avaabË
) {

1130 
	`SLSI_NET_WARN
(
dev
, "vif NOT‡vailable\n");

1131 
r
 = -
EFAULT
;

1132 
ev®u©e
;

1135 ià(
skb
->
queue_m­pšg
 =ğ
SLSI_NETIF_Q_DISCARD
) {

1136 
	`SLSI_NET_WARN
(
dev
, "Discard Queue :: Packet Dropped\n");

1137 
r
 = -
EIO
;

1138 
ev®u©e
;

1141 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1142 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 11, 0))

1143 
known_u£rs
 = 
	`»fcouÁ_»ad
(&
skb
->
u£rs
);

1145 
known_u£rs
 = 
	`©omic_»ad
(&
skb
->
u£rs
);

1149 #iâdeà
CONFIG_ARM


1150 
skb
 = 
	`¦si_Ãtif_tı_ack_suµ»ssiÚ_pkt
(
dev
, skb);

1151 ià(!
skb
) {

1152 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

1153 ià(
Üigš®_skb
)

1154 
	`cÚsume_skb
(
Üigš®_skb
);

1155  
NETDEV_TX_OK
;

1160 
r
 = 
	`¦si_tx_d©a
(
sdev
, 
dev
, 
skb
);

1161 
ev®u©e
:

1162 ià(
r
 == 0) {

1168 ià(
Üigš®_skb
)

1169 
	`cÚsume_skb
(
Üigš®_skb
);

1172 
ndev_vif
->
tx_·ck‘s
[
Œaffic_q
]++;

1173 
ndev_vif
->
¡©s
.
tx_·ck‘s
++;

1174 
ndev_vif
->
¡©s
.
tx_by‹s
 +ğ
·ck‘_Ën
;

1175 
r
 = 
NETDEV_TX_OK
;

1189 ià(
r
 =ğ-
ENOSPC
) {

1191 
ndev_vif
->
¡©s
.
tx_fifo_”rÜs
++;

1193 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1194 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 11, 0))

1195 
	`WARN_ON
(
known_u£rs
 && 
	`»fcouÁ_»ad
(&
skb
->
u£rs
) != known_users);

1197 
	`WARN_ON
(
known_u£rs
 && 
	`©omic_»ad
(&
skb
->
u£rs
) != known_users);

1200 ià(
Üigš®_skb
) {

1201 
	`cÚsume_skb
(
skb
);

1202 
	`kä“_skb
(
Üigš®_skb
);

1204 
	`kä“_skb
(
skb
);

1206 
ndev_vif
->
¡©s
.
tx_drİ³d
++;

1216 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

1217  
r
;

1218 
	}
}

1220 
Ãtdev_ã©u»s_t
 
	$¦si_Ãt_fix_ã©u»s
(
Ãt_deviû
 *
dev
, 
Ãtdev_ã©u»s_t
 
ã©u»s
)

1222 
	`SLSI_UNUSED_PARAMETER
(
dev
);

1224 #ifdeà
CONFIG_SCSC_WLAN_SG


1225 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_RX
, "Scatter-gather‡nd GSOƒnabled\n");

1226 
ã©u»s
 |ğ
NETIF_F_SG
;

1227 
ã©u»s
 |ğ
NETIF_F_GSO
;

1230 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI_GRO


1231 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_RX
, "NAPI Rx GROƒnabled\n");

1232 
ã©u»s
 |ğ
NETIF_F_GRO
;

1234 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_RX
, "NAPI Rx GRO disabled\n");

1235 
ã©u»s
 &ğ~
NETIF_F_GRO
;

1237  
ã©u»s
;

1238 
	}
}

1240 
	$¦si_£t_muÉiÿ¡_li¡
(
Ãt_deviû
 *
dev
)

1242 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1243 
u8
 
couÁ
, 
i
 = 0;

1244 
u8
 
mdns_addr
[
ETH_ALEN
] = { 0x01, 0x00, 0x5E, 0x00, 0x00, 0xFB };

1245 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

1246 
u8
 
mdns6_addr
[
ETH_ALEN
] = { 0x33, 0x33, 0x00, 0x00, 0x00, 0xFB };

1247 cÚ¡ 
u8
 
sŞic™ed_node_addr
[
ETH_ALEN
] = { 0x33, 0x33, 0xff, 0x00, 0x00, 0x01 };

1248 
u8
 
v6addr_suffix
[3];

1250 
u8
 
mc_addr_´efix
[3] = { 0x01, 0x00, 0x5e };

1252 
Ãtdev_hw_addr
 *
ha
;

1254 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
)

1257 ià(!
ndev_vif
->
is_avaabË
) {

1258 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "vif NOT‡vailable\n");

1262 
couÁ
 = 
	`Ãtdev_mc_couÁ
(
dev
);

1263 ià(!
couÁ
) {

1264 
ndev_vif
->
¡a
.
»gd_mc_addr_couÁ
 = 0;

1268 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

1269 
	`¦si_¥šlock_lock
(&
ndev_vif
->
v6addr_lock
);

1270 
	`memıy
(
v6addr_suffix
, &
ndev_vif
->
v6add»ss
.
s6_addr
[13], 3);

1271 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
v6addr_lock
);

1274 
	`¦si_¥šlock_lock
(&
ndev_vif
->
¡a
.
»gd_mc_addr_lock
);

1275 
	`Ãtdev_fÜ_—ch_mc_addr
(
ha
, 
dev
) {

1276 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

1277 ià((!
	`memcmp
(
ha
->
addr
, 
mdns_addr
, 
ETH_ALEN
)) ||

1278 (!
	`memcmp
(
ha
->
addr
, 
mdns6_addr
, 
ETH_ALEN
)) ||

1279 (!
	`memcmp
(
ha
->
addr
, 
sŞic™ed_node_addr
, 3) &&

1280 !
	`memcmp
(&
ha
->
addr
[3], 
v6addr_suffix
, 3))) {

1282 ià((!
	`memcmp
(
ha
->
addr
, 
mdns_addr
, 
ETH_ALEN
)) ||

1283 (
	`memcmp
(
ha
->
addr
, 
mc_addr_´efix
, 3))) {

1285 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_NETDEV
, "Drİ MAC %pM\n", 
ha
->
addr
);

1288 ià(
i
 =ğ
SLSI_MC_ADDR_ENTRY_MAX
) {

1289 
	`SLSI_NET_WARN
(
dev
, "MAC†i¡ ha »ached max†im™ (%d),‡ùu® couÁ %d\n", 
SLSI_MC_ADDR_ENTRY_MAX
, 
couÁ
);

1293 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_NETDEV
, "idx %d MAC %pM\n", 
i
, 
ha
->
addr
);

1294 
	`SLSI_ETHER_COPY
(
ndev_vif
->
¡a
.
»gd_mc_addr
[
i
++], 
ha
->
addr
);

1296 
ndev_vif
->
¡a
.
»gd_mc_addr_couÁ
 = 
i
;

1297 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
¡a
.
»gd_mc_addr_lock
);

1299 
	`¦si_wake_lock
(&
ndev_vif
->
sdev
->
wÏn_wl
);

1300 
	`scheduË_wÜk
(&
ndev_vif
->
£t_muÉiÿ¡_f‹r_wÜk
);

1301 
	}
}

1303 
	$¦si_£t_mac_add»ss
(
Ãt_deviû
 *
dev
, *
addr
)

1305 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1306 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1307 
sockaddr
 *
§
 = (sockadd¸*)
addr
;

1309 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "%pM\n", 
§
->
§_d©a
);

1310 
	`SLSI_ETHER_COPY
(
dev
->
dev_addr
, 
§
->
§_d©a
);

1311 
sdev
->
mac_chªged
 = 
Œue
;

1312 
ndev_vif
->
add»ss
 = 0;

1317 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
))

1318 
sdev
->
š™Ÿl_sÿn
 = 
Œue
;

1320 
	}
}

1322 cÚ¡ 
Ãt_deviû_İs
 
	g¦si_Ãtdev_İs
 = {

1323 .
ndo_İ’
 = 
¦si_Ãt_İ’
,

1324 .
	gndo_¡İ
 = 
¦si_Ãt_¡İ
,

1325 .
	gndo_¡¬t_xm™
 = 
¦si_Ãt_hw_xm™
,

1326 .
	gndo_do_ioùl
 = 
¦si_Ãt_ioùl
,

1327 .
	gndo_tx_timeout
 = 
¦si_Ãt_tx_timeout
,

1328 .
	gndo_g‘_¡©s
 = 
¦si_Ãt_g‘_¡©s
,

1329 .
	gndo_£Ëù_queue
 = 
¦si_Ãt_£Ëù_queue
,

1330 .
	gndo_fix_ã©u»s
 = 
¦si_Ãt_fix_ã©u»s
,

1331 .
	gndo_£t_rx_mode
 = 
¦si_£t_muÉiÿ¡_li¡
,

1332 .
	gndo_£t_mac_add»ss
 = 
¦si_£t_mac_add»ss
,

1335 
	$¦si_if_£tup
(
Ãt_deviû
 *
dev
)

1337 
	`‘h”_£tup
(
dev
);

1338 
dev
->
Ãtdev_İs
 = &
¦si_Ãtdev_İs
;

1339 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 11, 9))

1340 
dev
->
Ãeds_ä“_Ãtdev
 = 
Œue
;

1342 
dev
->
de¡ruùÜ
 = 
ä“_Ãtdev
;

1344 
dev
->
w©chdog_timeo
 = 
SLSI_TX_TIMEOUT
;

1345 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI_GRO


1346 
dev
->
gro_æush_timeout
 = gro_flush_timeout;

1348 
	}
}

1350 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


1351 #ià
defšed
(
CONFIG_SOC_EXYNOS9610
è|| defšed(
CONFIG_SOC_EXYNOS3830
è|| defšed(
CONFIG_SOC_S5E3830
)

1352 
	#SCSC_NETIF_NAPI_CPU_BIG
 7

	)

1353 
	#SCSC_NETIF_RPS_CPUS_MASK
 "ã"

	)

1354 
	#SCSC_NETIF_RPS_CPUS_BIG_MASK
 "70"

	)

1355 #–ià
defšed
(
CONFIG_SOC_S5E9815
)

1356 
	#SCSC_NETIF_NAPI_CPU_BIG
 4

	)

1357 
	#SCSC_NETIF_RPS_CPUS_MASK
 "00"

	)

1358 
	#SCSC_NETIF_RPS_CPUS_BIG_MASK
 "60"

	)

1359 #–ià
defšed
(
CONFIG_SOC_EXYNOS9630
)

1360 
	#SCSC_NETIF_NAPI_CPU_BIG
 7

	)

1361 
	#SCSC_NETIF_RPS_CPUS_MASK
 "ã"

	)

1362 
	#SCSC_NETIF_RPS_CPUS_BIG_MASK
 "40"

	)

1363 #–ià
defšed
(
CONFIG_SOC_EXYNOS7885
)

1364 
	#SCSC_NETIF_NAPI_CPU_BIG
 0

	)

1365 
	#SCSC_NETIF_RPS_CPUS_MASK
 "40"

	)

1366 
	#SCSC_NETIF_RPS_CPUS_BIG_MASK
 "0"

	)

1368 
	#SCSC_NETIF_NAPI_CPU_BIG
 0

	)

1369 
	#SCSC_NETIF_RPS_CPUS_MASK
 "0"

	)

1370 
	#SCSC_NETIF_RPS_CPUS_BIG_MASK
 "0"

	)

1373 #ià
defšed
(
CONFIG_SOC_EXYNOS3830
è|| defšed(
CONFIG_SOC_S5E3830
)

1374 
	#SCSC_NETIF_RPS_CPUS_MASK
 "ã"

	)

1376 
	#SCSC_NETIF_RPS_CPUS_MASK
 "0"

	)

1380 
	$¦si_Ãtif_½s_m­_ş—r
(
Ãt_deviû
 *
dev
)

1382 
½s_m­
 *
m­
;

1384 
m­
 = 
	`rcu_d”eã»nû_´Ùeùed
(
dev
->
_rx
->
½s_m­
, 1);

1385 ià(
m­
) {

1386 
	`RCU_INIT_POINTER
(
dev
->
_rx
->
½s_m­
, 
NULL
);

1387 
	`kä“_rcu
(
m­
, 
rcu
);

1388 
	`SLSI_NET_INFO
(
dev
, "clear„ps_cpus map\n");

1390 
	}
}

1392 
	$¦si_Ãtif_½s_m­_£t
(
Ãt_deviû
 *
dev
, *
buf
, 
size_t
 
Ën
)

1394 
½s_m­
 *
Şd_m­
, *
m­
;

1395 
ıumask_v¬_t
 
mask
;

1396 
”r
, 
ıu
, 
i
;

1397 
	`DEFINE_SPINLOCK
(
½s_m­_lock
);

1399 ià(!
	`®loc_ıumask_v¬
(&
mask
, 
GFP_KERNEL
))

1400  -
ENOMEM
;

1402 
”r
 = 
	`b™m­_·r£
(
buf
, 
Ën
, 
	`ıumask_b™s
(
mask
), 
Ä_ıumask_b™s
);

1403 ià(
”r
) {

1404 
	`ä“_ıumask_v¬
(
mask
);

1405 
	`SLSI_NET_WARN
(
dev
, "CPU bitmap…arse failed\n");

1406  
”r
;

1409 
m­
 = 
	`kz®loc
(
	`max_t
(, 
	`RPS_MAP_SIZE
(
	`ıumask_weight
(
mask
)), 
L1_CACHE_BYTES
), 
GFP_KERNEL
);

1410 ià(!
m­
) {

1411 
	`ä“_ıumask_v¬
(
mask
);

1412 
	`SLSI_NET_WARN
(
dev
, "CPU mask‡lloc failed\n");

1413  -
ENOMEM
;

1416 
i
 = 0;

1417 
	`fÜ_—ch_ıu_ªd
(
ıu
, 
mask
, 
ıu_Úlše_mask
)

1418 
m­
->
ıus
[
i
++] = 
ıu
;

1420 ià(
i
) {

1421 
m­
->
Ën
 = 
i
;

1423 
	`kä“
(
m­
);

1424 
m­
 = 
NULL
;

1427 
	`¥š_lock
(&
½s_m­_lock
);

1428 
Şd_m­
 = 
	`rcu_d”eã»nû_´Ùeùed
(
dev
->
_rx
->
½s_m­
, 
	`lockd•_is_h–d
(&
½s_m­_lock
));

1429 
	`rcu_assign_poš‹r
(
dev
->
_rx
->
½s_m­
, 
m­
);

1430 
	`¥š_uÆock
(&
½s_m­_lock
);

1432 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 4, 0))

1433 ià(
m­
)

1434 
	`¡©ic_b¿nch_šc
(&
½s_Ãeded
);

1435 ià(
Şd_m­
)

1436 
	`¡©ic_b¿nch_dec
(&
½s_Ãeded
);

1438 ià(
m­
)

1439 
	`¡©ic_key_¦ow_šc
(&
½s_Ãeded
);

1440 ià(
Şd_m­
)

1441 
	`¡©ic_key_¦ow_dec
(&
½s_Ãeded
);

1444 ià(
Şd_m­
)

1445 
	`kä“_rcu
(
Şd_m­
, 
rcu
);

1447 
	`ä“_ıumask_v¬
(
mask
);

1448 
	`SLSI_NET_INFO
(
dev
, "½s_ıu m­ s‘(%s)\n", 
buf
);

1449  
Ën
;

1450 
	}
}

1452 
	$¦si_£t_muÉiÿ¡_f‹r_wÜk
(
wÜk_¡ruù
 *
d©a
)

1454 
Ãtdev_vif
 *
ndev_vif
 = 
	`cÚš”_of
(
d©a
, Ãtdev_vif, 
£t_muÉiÿ¡_f‹r_wÜk
);

1455 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1457 ià(!
sdev
) {

1458 
	`SLSI_WARN_NODEV
("sdev is NULL\n");

1461 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1462 ià(!
ndev_vif
->
is_avaabË
 ||

1463 !
ndev_vif
->
aùiv©ed
 ||

1464 
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
)

1465 
ex™
;

1467 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

1468 
	`SLSI_INFO_NODEV
("STA is‚ot connected!\n");

1469 
ex™
;

1471 ià(
ndev_vif
->
iâum
 > 
CONFIG_SCSC_WLAN_MAX_INTERFACES
) {

1472 
	`SLSI_INFO_NODEV
("Im´İ” ifidx: %d\n", 
ndev_vif
->
iâum
);

1473 
ex™
;

1475 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1476 
	`SLSI_INFO_NODEV
("u£r_su¥’d_modğ%d\n", 
ndev_vif
->
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
);

1478 ià(
ndev_vif
->
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
 == 1) {

1479 
Ãt_deviû
 *
dev
 = 
NULL
;

1480 
»t
 = 0;

1482 
dev
 = 
sdev
->
Ãtdev
[
ndev_vif
->
iâum
];

1483 ià(!
dev
) {

1484 
	`SLSI_ERR_NODEV
("Dev i NULL iâum:%d\n", 
ndev_vif
->
iâum
);

1485 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1486 
ex™
;

1488 
»t
 = 
	`¦si_£t_muÉiÿ¡_·ck‘_f‹rs
(
ndev_vif
->
sdev
, 
dev
);

1489 ià(
»t
)

1490 
	`SLSI_NET_ERR
(
dev
, "Failedo update mcast filter\n");

1492 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1493 
ex™
:

1494 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1495 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

1496 
	}
}

1498 
	$¦si_upd©e_pkt_f‹r_wÜk
(
wÜk_¡ruù
 *
d©a
)

1500 
Ãtdev_vif
 *
ndev_vif
 = 
	`cÚš”_of
(
d©a
, Ãtdev_vif, 
upd©e_pkt_f‹r_wÜk
);

1501 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1502 
Ãt_deviû
 *
dev
 = 
NULL
;

1503 
»t
 = 0;

1505 ià(!
sdev
) {

1506 
	`SLSI_WARN_NODEV
("sdev is NULL\n");

1509 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1510 ià(!
ndev_vif
->
is_avaabË
 || !ndev_vif->
aùiv©ed
 ||

1511 
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
)

1512 
ex™
;

1514 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

1515 
	`SLSI_INFO_NODEV
("STA is‚ot connected!\n");

1516 
ex™
;

1518 ià(
ndev_vif
->
iâum
 > 
CONFIG_SCSC_WLAN_MAX_INTERFACES
) {

1519 
	`SLSI_INFO_NODEV
("Im´İ” ifidx: %d\n", 
ndev_vif
->
iâum
);

1520 
ex™
;

1523 
dev
 = 
sdev
->
Ãtdev
[
ndev_vif
->
iâum
];

1524 ià(!
dev
) {

1525 
	`SLSI_ERR_NODEV
("Dev i NULL iâum:%d\n", 
ndev_vif
->
iâum
);

1526 
ex™
;

1529 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1530 
	`SLSI_INFO_NODEV
("u£r_su¥’d_modğ%d, is_İt_ouˆğ%d\n", 
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
, 
ndev_vif
->
is_İt_out_·ck‘
);

1532 ià(
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
 =ğ1 && 
ndev_vif
->
is_İt_out_·ck‘
) {

1533 
»t
 = 
	`¦si_upd©e_·ck‘_f‹rs
(
sdev
, 
dev
);

1534 ià(
»t
)

1535 
	`SLSI_NET_ERR
(
dev
, "Failedo update_packet_filters\n");

1536 } ià(
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
 == 0) {

1537 
»t
 = 
	`¦si_upd©e_·ck‘_f‹rs
(
sdev
, 
dev
);

1538 ià(
»t
)

1539 
	`SLSI_NET_ERR
(
dev
, "Failedo update_packet_filters\n");

1541 
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
 = 1;

1542 
sdev
->
deviû_cÚfig
.
ho¡_¡©e
 &ğ~
SLSI_HOSTSTATE_LCD_ACTIVE
;

1544 
»t
 = 
	`¦si_mlme_£t_ho¡_¡©e
(
sdev
, 
dev
, sdev->
deviû_cÚfig
.
ho¡_¡©e
);

1545 ià(
»t
 != 0)

1546 
	`SLSI_NET_ERR
(
dev
, "E¼Ü iÀ£‰šghHo¡ S‹,„‘=%d", 
»t
);

1548 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1549 
ex™
:

1550 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1551 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

1552 
	}
}

1554 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


1555 
	$¦si_Ãtif_Œaffic_mÚ™Ü_wÜk
(
wÜk_¡ruù
 *
d©a
)

1557 
Ãt_deviû
 *
dev
;

1558 
Ãtdev_vif
 *
ndev_vif
 = 
	`cÚš”_of
(
d©a
, Ãtdev_vif, 
Œaffic_mÚ_wÜk
);

1559 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1561 ià(!
sdev
) {

1562 
	`WARN_ON
(1);

1566 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1568 ià(!
ndev_vif
->
is_avaabË
) {

1569 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1572 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
ndev_vif
->
iâum
);

1574 
	`SLSI_NET_INFO
(
dev
, "chªg¡©tØ%d\n", 
ndev_vif
->
Œaffic_mÚ_¡©e
);

1576 ià(
Çpi_ıu_big_ut_š_mbps
 || 
½s_’abË_ut_š_mbps
) {

1577 ià(
ndev_vif
->
Œaffic_mÚ_¡©e
 =ğ
TRAFFIC_MON_CLIENT_STATE_OVERRIDE
) {

1578 
	`¦si_Ãtif_½s_m­_£t
(
dev
, 
SCSC_NETIF_RPS_CPUS_BIG_MASK
, 
	`¡¾’
(SCSC_NETIF_RPS_CPUS_BIG_MASK));

1579 
	`¦si_h_£t_Çpi_ıu
(
sdev
, 
SCSC_NETIF_NAPI_CPU_BIG
, 
Œue
);

1581 ià((
Çpi_ıu_big_ut_š_mbps
è&& (
ndev_vif
->
throughput_rx
 > (napi_cpu_big_tput_in_mbps * 1000 * 1000))) {

1582 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "sw™ch RPSØ¨BIG CPU oth”hª NAPI (ut_rx:%d bps)\n", 
ndev_vif
->
throughput_rx
);

1583 
	`¦si_Ãtif_½s_m­_£t
(
dev
, 
SCSC_NETIF_RPS_CPUS_BIG_MASK
, 
	`¡¾’
(SCSC_NETIF_RPS_CPUS_BIG_MASK));

1584 } ià((
½s_’abË_ut_š_mbps
è&& (
ndev_vif
->
throughput_rx
 > (rps_enable_tput_in_mbps * 1000 * 1000))) {

1585 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "’abË RPS (ut_rx:%d bps)\n", 
ndev_vif
->
throughput_rx
);

1586 
	`¦si_Ãtif_½s_m­_£t
(
dev
, 
SCSC_NETIF_RPS_CPUS_MASK
, 
	`¡¾’
(SCSC_NETIF_RPS_CPUS_MASK));

1588 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "di§bË RPS (ut_rx:%d bps)\n", 
ndev_vif
->
throughput_rx
);

1589 
	`¦si_Ãtif_½s_m­_ş—r
(
dev
);

1593 ià((
Çpi_ıu_big_ut_š_mbps
è&& ((
sdev
->
agg_dev_throughput_rx
 + sdev->
agg_dev_throughput_tx
) > (napi_cpu_big_tput_in_mbps * 1000 * 1000)))

1594 
	`¦si_h_£t_Çpi_ıu
(
sdev
, 
SCSC_NETIF_NAPI_CPU_BIG
, 
Œue
);

1596 
	`¦si_h_£t_Çpi_ıu
(
sdev
, 0, 
çl£
);

1599 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1600 
	}
}

1602 
	$¦si_Ãtif_Œaffic_mÚ™Ü_cb
(*
ş›Á_ùx
, 
u32
 
¡©e
, u32 
ut_tx
, u32 
ut_rx
)

1604 
Ãt_deviû
 *
dev
 = (Ãt_deviû *)
ş›Á_ùx
;

1605 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1606 
¦si_dev
 *
sdev
 = 
ndev_vif
->sdev;

1607 
¦si_h4
 *
h
 = &(
sdev
->
h4_š¡
);

1608 
boŞ
 
chªge
 = 
çl£
;

1609 
u32
 
Şd_¡©e
 = 
ndev_vif
->
Œaffic_mÚ_¡©e
;

1611 ià(!
sdev
)

1614 
	`¦si_¥šlock_lock
(&
sdev
->
Ãtdev_lock
);

1616 ià(!
ndev_vif
->
is_avaabË
) {

1617 
	`¦si_¥šlock_uÆock
(&
sdev
->
Ãtdev_lock
);

1621 
	`SLSI_NET_INFO
(
dev
, "ŒaffiømÚ™Ü:ƒv’ˆ(cu¼’t:%d‚ew:%d,put_tx:%u bps,put_rx:%u bps)\n", 
ndev_vif
->
Œaffic_mÚ_¡©e
, 
¡©e
, 
ut_tx
, 
ut_rx
);

1623 
sdev
->
agg_dev_throughput_tx
 = 
ut_tx
;

1624 
sdev
->
agg_dev_throughput_rx
 = 
ut_rx
;

1626 ià(
¡©e
 !ğ
ndev_vif
->
Œaffic_mÚ_¡©e
) {

1628 ià(
¡©e
 >ğ
TRAFFIC_MON_CLIENT_STATE_HIGH
 &&

1629 
ndev_vif
->
Œaffic_mÚ_¡©e
 >ğ
TRAFFIC_MON_CLIENT_STATE_HIGH
) {

1630 
	`¦si_¥šlock_uÆock
(&
sdev
->
Ãtdev_lock
);

1633 
chªge
 = 
Œue
;

1634 
ndev_vif
->
Œaffic_mÚ_¡©e
 = 
¡©e
;

1637 
	`¦si_¥šlock_uÆock
(&
sdev
->
Ãtdev_lock
);

1639 ià(
chªge
) {

1640 ià(!
	`queue_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
Œaffic_mÚ_wÜk
)) {

1645 
	`SLSI_NET_WARN
(
dev
, "failedo queue work!„esetraffic stateo„etry\n");

1646 
h
->
h_´iv
->
Çpi_rx_§tu¿‹d
 = 0;

1647 
ndev_vif
->
Œaffic_mÚ_¡©e
 = 
Şd_¡©e
;

1648 
	`scsc_£rviû_mifšŒb™_b™_unmask
(
sdev
->
£rviû
, 
h
->
h_´iv
->
šŒ_toho¡_mul
[
HIP4_MIF_Q_TH_DAT
]);

1651 
	}
}

1653 
	$¦si_Ãtif_add_locked
(
¦si_dev
 *
sdev
, cÚ¡ *
Çme
, 
iâum
)

1655 
Ãt_deviû
 *
dev
 = 
NULL
;

1656 
Ãtdev_vif
 *
ndev_vif
;

1657 
wœ–ess_dev
 *
wdev
;

1658 
®loc_size
, 
txq_couÁ
 = 0, 
»t
;

1660 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
sdev
->
Ãtdev_add_»move_mu‹x
));

1662 ià(
	`WARN_ON
(!
sdev
 || 
iâum
 > 
CONFIG_SCSC_WLAN_MAX_INTERFACES
 || sdev->
Ãtdev
[ifnum]))

1663  -
EINVAL
;

1665 
®loc_size
 = (
Ãtdev_vif
);

1667 
txq_couÁ
 = 
SLSI_NETIF_Q_PEER_START
 + (
SLSI_NETIF_Q_PER_PEER
 * (
SLSI_ADHOC_PEER_CONNECTIONS_MAX
));

1669 
dev
 = 
	`®loc_Ãtdev_mqs
(
®loc_size
, 
Çme
, 
NET_NAME_PREDICTABLE
, 
¦si_if_£tup
, 
txq_couÁ
, 1);

1670 ià(!
dev
) {

1671 
	`SLSI_ERR
(
sdev
, "Failedo‡llocate…rivate data for‚etdev\n");

1672  -
ENOMEM
;

1676 
dev
->
Ãeded_h—droom
 = 
SLSI_NETIF_SKB_HEADROOM
;

1677 
dev
->
Ãeded_room
 = 
SLSI_NETIF_SKB_TAILROOM
;

1679 
»t
 = 
	`dev_®loc_Çme
(
dev
, dev->
Çme
);

1680 ià(
»t
 < 0)

1681 
ex™_w™h_”rÜ
;

1683 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1684 
	`mem£t
(
ndev_vif
, 0x00, (*ndev_vif));

1685 
	`SLSI_MUTEX_INIT
(
ndev_vif
->
vif_mu‹x
);

1686 
	`SLSI_MUTEX_INIT
(
ndev_vif
->
sÿn_mu‹x
);

1687 
	`SLSI_MUTEX_INIT
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

1688 
	`INIT_WORK
(&
ndev_vif
->
sched_sÿn_¡İ_wk
, 
¦si_sched_sÿn_¡İ³d
);

1689 
	`INIT_WORK
(&
ndev_vif
->
£t_muÉiÿ¡_f‹r_wÜk
, 
¦si_£t_muÉiÿ¡_f‹r_wÜk
);

1691 
ndev_vif
->
is_İt_out_·ck‘
 = 
çl£
;

1692 
	`INIT_WORK
(&
ndev_vif
->
upd©e_pkt_f‹r_wÜk
, 
¦si_upd©e_pkt_f‹r_wÜk
);

1693 
	`skb_queue_h—d_š™
(&
ndev_vif
->
ba_com¶‘e
);

1694 
	`¦si_sig_£nd_š™
(&
ndev_vif
->
sig_wa™
);

1695 
ndev_vif
->
sdev
 = sdev;

1696 
ndev_vif
->
iâum
 = ifnum;

1697 
ndev_vif
->
vif_ty³
 = 
SLSI_VIFTYPE_UNSPECIFIED
;

1698 #ià
	`IS_ENABLED
(
CONFIG_IPV6
)

1699 
	`¦si_¥šlock_ü—‹
(&
ndev_vif
->
v6addr_lock
);

1701 
	`¦si_¥šlock_ü—‹
(&
ndev_vif
->
³”_lock
);

1702 
	`¦si_¥šlock_ü—‹
(&
ndev_vif
->
ba_lock
);

1703 
	`©omic_£t
(&
ndev_vif
->
ba_æush
, 0);

1704 
	`¦si_¥šlock_ü—‹
(&
ndev_vif
->
¡a
.
»gd_mc_addr_lock
);

1707 ià(!(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
è|| 
	`SLSI_IS_VIF_INDEX_NAN
(ndev_vif))) {

1708 
queue£t
;

1710 
queue£t
 = 0; queue£ˆ< 
SLSI_ADHOC_PEER_CONNECTIONS_MAX
; queueset++) {

1711 
ndev_vif
->
³”_¡a_»cÜd
[
queue£t
] = 
	`kz®loc
((*ndev_vif->³”_¡a_»cÜd[queue£t]), 
GFP_KERNEL
);

1713 ià(!
ndev_vif
->
³”_¡a_»cÜd
[
queue£t
]) {

1714 
j
;

1716 
	`SLSI_NET_ERR
(
dev
, "Could‚Ù‡Îoÿ‹ memÜy fÜ…“¸’Œy (queue£t:%d)\n", 
queue£t
);

1719 
j
 = 0; j < 
queue£t
; j++) {

1720 
	`kä“
(
ndev_vif
->
³”_¡a_»cÜd
[
j
]);

1721 
ndev_vif
->
³”_¡a_»cÜd
[
j
] = 
NULL
;

1724 
»t
 = -
ENOMEM
;

1725 
ex™_w™h_”rÜ
;

1731 ià(
	`¦si_is_rf_‹¡_mode_’abËd
()) {

1732 
	`SLSI_NET_ERR
(
dev
, "*#rf#„fest mode set isƒnabled.\n");

1733 
ndev_vif
->
£t_pow”_mode
 = 
FAPI_POWERMANAGEMENTMODE_ACTIVE_MODE
;

1735 
ndev_vif
->
£t_pow”_mode
 = 
FAPI_POWERMANAGEMENTMODE_POWER_SAVE
;

1738 
	`INIT_LIST_HEAD
(&
ndev_vif
->
¡a
.
ÃtwÜk_m­
);

1739 
	`INIT_LIST_HEAD
(&
ndev_vif
->
aş_d©a_fw_li¡
);

1740 
	`INIT_LIST_HEAD
(&
ndev_vif
->
aş_d©a_ioùl_li¡
);

1741 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1742 
	`INIT_LIST_HEAD
(&
ndev_vif
->
¡a
.
ssid_šfo
);

1743 
	`INIT_LIST_HEAD
(&
ndev_vif
->
¡a
.
bÏckli¡_h—d
);

1745 
	`SLSI_DBG1
(
sdev
, 
SLSI_NETDEV
, "iâum=%d\n", 
ndev_vif
->
iâum
);

1748 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

1749 
sdev
->
wÏn_unsync_vif_¡©e
 = 
WLAN_UNSYNC_NO_VIF
;

1750 
	`SLSI_NET_INFO
(
dev
, "Initializing Hs2 Del Vif Work\n");

1751 
	`INIT_DELAYED_WORK
(&
ndev_vif
->
unsync
.
hs2_d–_vif_wÜk
, 
¦si_hs2_unsync_vif_d–‘e_wÜk
);

1752 } ià(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
)) {

1754 
»t
 = 
	`¦si_p2p_š™
(
sdev
, 
ndev_vif
);

1755 ià(
»t
)

1756 
ex™_w™h_”rÜ
;

1759 
	`INIT_DELAYED_WORK
(&
ndev_vif
->
sÿn_timeout_wÜk
, 
¦si_sÿn_šd_timeout_hªdË
);

1761 
	`INIT_DELAYED_WORK
(&
ndev_vif
->
bÏckli¡_d–_wÜk
, 
¦si_bÏckli¡_d–_wÜk_hªdË
);

1762 #iâdeà
CONFIG_SCSC_WLAN_RX_NAPI


1763 
»t
 = 
	`¦si_skb_wÜk_š™
(
sdev
, 
dev
, &
ndev_vif
->
rx_d©a
, "¦si_wÏn_rx_d©a", 
¦si_rx_Ãtdev_d©a_wÜk
);

1764 ià(
»t
)

1765 
ex™_w™h_”rÜ
;

1767 
»t
 = 
	`¦si_skb_wÜk_š™
(
sdev
, 
dev
, &
ndev_vif
->
rx_mlme
, "¦si_wÏn_rx_mlme", 
¦si_rx_Ãtdev_mlme_wÜk
);

1768 ià(
»t
) {

1769 #iâdeà
CONFIG_SCSC_WLAN_RX_NAPI


1770 
	`¦si_skb_wÜk_deš™
(&
ndev_vif
->
rx_d©a
);

1772 
ex™_w™h_”rÜ
;

1775 
wdev
 = &
ndev_vif
->wdev;

1777 
dev
->
›“80211_±r
 = 
wdev
;

1778 
wdev
->
why
 = 
sdev
->wiphy;

1779 
wdev
->
Ãtdev
 = 
dev
;

1780 
wdev
->
iáy³
 = 
NL80211_IFTYPE_STATION
;

1781 
	`SET_NETDEV_DEV
(
dev
, 
sdev
->dev);

1784 
	`Ãtif_ÿ¼›r_off
(
dev
);

1786 #ià
	`defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

1787 ià(
	`¡rcmp
(
Çme
, 
CONFIG_SCSC_AP_INTERFACE_NAME
) == 0)

1788 
	`SLSI_ETHER_COPY
(
dev
->
dev_addr
, 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2PX_SWLAN
]);

1790 
	`SLSI_ETHER_COPY
(
dev
->
dev_addr
, 
sdev
->
Ãtdev_add»s£s
[
iâum
]);

1792 
	`SLSI_ETHER_COPY
(
dev
->
dev_addr
, 
sdev
->
Ãtdev_add»s£s
[
iâum
]);

1794 
	`SLSI_DBG1
(
sdev
, 
SLSI_NETDEV
, "Add:%pM\n", 
dev
->
dev_addr
);

1795 
	`rcu_assign_poš‹r
(
sdev
->
Ãtdev
[
iâum
], 
dev
);

1796 
ndev_vif
->
d–‘e_´obe_»q_›s
 = 
çl£
;

1797 
ndev_vif
->
´obe_»q_›s
 = 
NULL
;

1798 
ndev_vif
->
´obe_»q_›_Ën
 = 0;

1799 
ndev_vif
->
drv_š_p2p_´oûdu»
 = 
çl£
;

1800 
sdev
->
»quœe_vif_d–‘e
[
ndev_vif
->
iâum
] = 
çl£
;

1802 ià(!(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
è|| 
	`SLSI_IS_VIF_INDEX_NAN
(ndev_vif))) {

1803 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


1804 ià(
Çpi_ıu_big_ut_š_mbps
 || 
½s_’abË_ut_š_mbps
) {

1805 
u32
 
mid_ut
;

1806 
u32
 
high_ut
;

1808 
ndev_vif
->
Œaffic_mÚ_¡©e
 = 
TRAFFIC_MON_CLIENT_STATE_LOW
;

1809 
	`INIT_WORK
(&
ndev_vif
->
Œaffic_mÚ_wÜk
, 
¦si_Ãtif_Œaffic_mÚ™Ü_wÜk
);

1811 
mid_ut
 = (
½s_’abË_ut_š_mbps
 * 1000 * 1000);

1812 
high_ut
 = (
Çpi_ıu_big_ut_š_mbps
 * 1000 * 1000);

1814 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "š™ŸlizRX¿ffiømÚ™Ü cl›Á (mid_ut:%d Mbps, high_ut:%d Mbps)\n", 
mid_ut
, 
high_ut
);

1815 ià(
	`¦si_Œaffic_mÚ_ş›Á_»gi¡”
(
sdev
, 
dev
, 
TRAFFIC_MON_CLIENT_MODE_EVENTS
, 
mid_ut
, 
high_ut
, 
¦si_Ãtif_Œaffic_mÚ™Ü_cb
))

1816 
	`SLSI_NET_WARN
(
dev
, "failedo‡dd‡ clientoraffic monitor\n");

1819 
	`¦si_Ãtif_½s_m­_£t
(
dev
, 
SCSC_NETIF_RPS_CPUS_MASK
, 
	`¡¾’
(SCSC_NETIF_RPS_CPUS_MASK));

1824 
ex™_w™h_”rÜ
:

1825 
	`mu‹x_lock
(&
sdev
->
Ãtdev_»move_mu‹x
);

1826 
	`ä“_Ãtdev
(
dev
);

1827 
	`mu‹x_uÆock
(&
sdev
->
Ãtdev_»move_mu‹x
);

1828  
»t
;

1829 
	}
}

1831 
	$¦si_Ãtif_dyÇmic_içû_add
(
¦si_dev
 *
sdev
, cÚ¡ *
Çme
)

1833 
šdex
 = -
EINVAL
;

1834 
”r
;

1836 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1838 #ià
	`defšed
(
CONFIG_SCSC_WLAN_MHS_STATIC_INTERFACE
è|| (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 9)

1839 ià(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
] =ğsdev->
Ãtdev_­
) {

1840 
	`rcu_assign_poš‹r
(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
], 
NULL
);

1841 
”r
 = 
	`¦si_Ãtif_add_locked
(
sdev
, 
Çme
, 
SLSI_NET_INDEX_P2PX_SWLAN
);

1842 
šdex
 = 
”r
 ?ƒ¼ : 
SLSI_NET_INDEX_P2PX_SWLAN
;

1845 
”r
 = 
	`¦si_Ãtif_add_locked
(
sdev
, 
Çme
, 
SLSI_NET_INDEX_P2PX_SWLAN
);

1846 
šdex
 = 
”r
 ?ƒ¼ : 
SLSI_NET_INDEX_P2PX_SWLAN
;

1849 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1850  
šdex
;

1851 
	}
}

1853 
	$¦si_Ãtif_š™
(
¦si_dev
 *
sdev
)

1855 
i
;

1857 
	`SLSI_DBG3
(
sdev
, 
SLSI_NETDEV
, "\n");

1859 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1862 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++)

1863 
	`RCU_INIT_POINTER
(
sdev
->
Ãtdev
[
i
], 
NULL
);

1865 ià(
	`¦si_Ãtif_add_locked
(
sdev
, "wÏn%d", 
SLSI_NET_INDEX_WLAN
) != 0) {

1866 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1867  -
EINVAL
;

1870 ià(
	`¦si_Ãtif_add_locked
(
sdev
, "p2p%d", 
SLSI_NET_INDEX_P2P
) != 0) {

1871 
	`¹Æ_lock
();

1872 
	`¦si_Ãtif_»move_locked
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_WLAN
]);

1873 
	`¹Æ_uÆock
();

1874 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1875  -
EINVAL
;

1877 #ià
	`defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

1878 #ià
	`defšed
(
CONFIG_SCSC_WLAN_MHS_STATIC_INTERFACE
è|| (defšed(
SCSC_SEP_VERSION
è&& SCSC_SEP_VERSION >ğ9è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

1879 
	`SLSI_ETHER_COPY
(
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2PX_SWLAN
], 
SLSI_DEFAULT_HW_MAC_ADDR
);

1880 ià(
	`¦si_Ãtif_add_locked
(
sdev
, 
CONFIG_SCSC_AP_INTERFACE_NAME
, 
SLSI_NET_INDEX_P2PX_SWLAN
) != 0) {

1881 
	`¹Æ_lock
();

1882 
	`¦si_Ãtif_»move_locked
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_WLAN
]);

1883 
	`¦si_Ãtif_»move_locked
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_P2P
]);

1884 
	`¹Æ_uÆock
();

1885 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1886  -
EINVAL
;

1890 #ià
CONFIG_SCSC_WLAN_MAX_INTERFACES
 >= 4

1891 ià(
	`¦si_Ãtif_add_locked
(
sdev
, "wifi-aw¬e%d", 
SLSI_NET_INDEX_NAN
) != 0) {

1892 
	`¹Æ_lock
();

1893 
	`¦si_Ãtif_»move_locked
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_WLAN
]);

1894 
	`¦si_Ãtif_»move_locked
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_P2P
]);

1895 #ià
	`defšed
(
CONFIG_SCSC_WLAN_WIFI_SHARING
è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

1896 #ià
	`defšed
(
CONFIG_SCSC_WLAN_MHS_STATIC_INTERFACE
è|| (defšed(
SCSC_SEP_VERSION
è&& SCSC_SEP_VERSION >ğ9è|| defšed(
CONFIG_SCSC_WLAN_DUAL_STATION
)

1897 
	`¦si_Ãtif_»move_locked
(
sdev
, sdev->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
]);

1900 
	`¹Æ_uÆock
();

1901 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1902  -
EINVAL
;

1905 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1907 
	}
}

1909 
	$¦si_Ãtif_»gi¡”_locked
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

1911 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1912 
”r
;

1914 
	`WARN_ON
(!
	`¹Æ_is_locked
());

1915 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
sdev
->
Ãtdev_add_»move_mu‹x
));

1916 ià(
	`©omic_»ad
(&
ndev_vif
->
is_»gi¡”ed
)) {

1917 
	`SLSI_NET_ERR
(
dev
, "Regi¡”:" 
MACSTR
 " Faed: AÌ—dy„egi¡”ed\n", 
	`MAC2STR
(dev->
dev_addr
));

1921 
”r
 = 
	`»gi¡”_Ãtdeviû
(
dev
);

1922 ià(
”r
)

1923 
	`SLSI_NET_ERR
(
dev
, "Regi¡”:" 
MACSTR
 " Faed\n", 
	`MAC2STR
(dev->
dev_addr
));

1925 
	`©omic_£t
(&
ndev_vif
->
is_»gi¡”ed
, 1);

1926  
”r
;

1927 
	}
}

1929 
	$¦si_Ãtif_»gi¡”_¹Êl_locked
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

1931 
”r
;

1933 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1934 
”r
 = 
	`¦si_Ãtif_»gi¡”_locked
(
sdev
, 
dev
);

1935 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1936  
”r
;

1937 
	}
}

1939 
	$¦si_Ãtif_»gi¡”
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

1941 
”r
;

1943 
	`¹Æ_lock
();

1944 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1945 
”r
 = 
	`¦si_Ãtif_»gi¡”_locked
(
sdev
, 
dev
);

1946 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1947 
	`¹Æ_uÆock
();

1948  
”r
;

1949 
	}
}

1951 
	$¦si_Ãtif_»move_locked
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

1953 
i
;

1954 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1955 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1956 
li¡_h—d
 *
pos
, *
q
;

1958 
li¡_h—d
 *
bÏckli¡_pos
, *
bÏckli¡_q
;

1960 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "UÄegi¡”:%pM\n", dev->
dev_addr
);

1962 
	`WARN_ON
(!
	`¹Æ_is_locked
());

1963 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
sdev
->
Ãtdev_add_»move_mu‹x
));

1965 ià(
	`©omic_»ad
(&
ndev_vif
->
is_»gi¡”ed
)) {

1966 
	`Ãtif_tx_di§bË
(
dev
);

1967 
	`Ãtif_ÿ¼›r_off
(
dev
);

1969 
	`¦si_¡İ_Ãt_dev
(
sdev
, 
dev
);

1972 
	`rcu_assign_poš‹r
(
sdev
->
Ãtdev
[
ndev_vif
->
iâum
], 
NULL
);

1973 
	`synchrÚize_rcu
();

1976 ià(!
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
)) {

1977 
queue£t
;

1979 
queue£t
 = 0; queue£ˆ< 
SLSI_ADHOC_PEER_CONNECTIONS_MAX
; queueset++) {

1980 
	`kä“
(
ndev_vif
->
³”_¡a_»cÜd
[
queue£t
]);

1981 
ndev_vif
->
³”_¡a_»cÜd
[
queue£t
] = 
NULL
;

1985 ià(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
)) {

1986 
	`¦si_p2p_deš™
(
sdev
, 
ndev_vif
);

1987 } ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

1988 
	`ÿnûl_d–ayed_wÜk_sync
(&
ndev_vif
->
bÏckli¡_d–_wÜk
);

1989 
sdev
->
wÏn_unsync_vif_¡©e
 = 
WLAN_UNSYNC_NO_VIF
;

1990 
ndev_vif
->
vif_ty³
 = 
SLSI_VIFTYPE_UNSPECIFIED
;

1992 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


1993 ià(
Çpi_ıu_big_ut_š_mbps
 || 
½s_’abË_ut_š_mbps
) {

1994 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "tear-down RXraffic monitor client\n");

1995 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
Œaffic_mÚ_wÜk
);

1996 
	`¦si_Œaffic_mÚ_ş›Á_uÄegi¡”
(
sdev
, 
dev
);

1999 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
sÿn_timeout_wÜk
);

2000 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
»queue_timeout_wÜk
 = 
çl£
;

2001 #iâdeà
CONFIG_SCSC_WLAN_RX_NAPI


2002 
	`¦si_skb_wÜk_deš™
(&
ndev_vif
->
rx_d©a
);

2004 
	`¦si_skb_wÜk_deš™
(&
ndev_vif
->
rx_mlme
);

2005 
i
 = 0; i < 
SLSI_SCAN_MAX
; i++)

2006 
	`¦si_purge_sÿn_»suÉs
(
ndev_vif
, 
i
);

2008 
	`kä“_skb
(
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
);

2009 
	`¦si_rßm_chªÃl_ÿche_´uÃ
(
dev
, 0, 
NULL
);

2011 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

2012 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

2013 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_NETDEV
, "Cleaning up scan†ist!\n");

2014 
	`li¡_fÜ_—ch_§ã
(
pos
, 
q
, &
ndev_vif
->
¡a
.
ssid_šfo
) {

2015 
¦si_ssid_šfo
 *
ssid_šfo
 = 
	`li¡_’Œy
(
pos
, ¦si_ssid_šfo, 
li¡
);

2016 
li¡_h—d
 *
bssid_pos
, *
p
;

2018 
	`li¡_fÜ_—ch_§ã
(
bssid_pos
, 
p
, &
ssid_šfo
->
bssid_li¡
) {

2019 
¦si_bssid_šfo
 *
bssid_šfo
 = 
	`li¡_’Œy
(
bssid_pos
, ¦si_bssid_šfo, 
li¡
);

2021 
	`li¡_d–
(
bssid_pos
);

2022 
	`kä“
(
bssid_šfo
);

2024 
	`li¡_d–
(
pos
);

2025 
	`kä“
(
ssid_šfo
);

2029 
	`kä“
(
ndev_vif
->
aş_d©a_suµliÿÁ
);

2030 
ndev_vif
->
aş_d©a_suµliÿÁ
 = 
NULL
;

2032 
	`kä“
(
ndev_vif
->
aş_d©a_h®
);

2033 
ndev_vif
->
aş_d©a_h®
 = 
NULL
;

2035 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_fw_li¡
) {

2036 
¦si_bssid_bÏckli¡_šfo
 *
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
,

2037 
¦si_bssid_bÏckli¡_šfo
, 
li¡
);

2039 
	`li¡_d–
(
bÏckli¡_pos
);

2040 
	`kä“
(
bÏckli¡_šfo
);

2043 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_ioùl_li¡
) {

2044 
¦si_ioùl_bÏckli¡_šfo
 *
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
,

2045 
¦si_ioùl_bÏckli¡_šfo
, 
li¡
);

2047 
	`li¡_d–
(
bÏckli¡_pos
);

2048 
	`kä“
(
bÏckli¡_šfo
);

2051 
	`kä“
(
ndev_vif
->
´obe_»q_›s
);

2052 
ndev_vif
->
´obe_»q_›s
 = 
NULL
;

2053 
ndev_vif
->
´obe_»q_›_Ën
 = 0;

2055 
	`¦si_Ãtif_½s_m­_ş—r
(
dev
);

2057 ià(
	`©omic_»ad
(&
ndev_vif
->
is_»gi¡”ed
)) {

2058 
	`©omic_£t
(&
ndev_vif
->
is_»gi¡”ed
, 0);

2059 
	`uÄegi¡”_Ãtdeviû
(
dev
);

2061 
	`mu‹x_lock
(&
sdev
->
Ãtdev_»move_mu‹x
);

2062 
	`ä“_Ãtdev
(
dev
);

2063 
	`mu‹x_uÆock
(&
sdev
->
Ãtdev_»move_mu‹x
);

2065 
	}
}

2067 
	$¦si_Ãtif_»move_¹Êl_locked
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

2069 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2070 
	`¦si_Ãtif_»move_locked
(
sdev
, 
dev
);

2071 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2072 
	}
}

2074 
	$¦si_Ãtif_»move
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

2076 
	`¹Æ_lock
();

2077 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2078 
	`¦si_Ãtif_»move_locked
(
sdev
, 
dev
);

2079 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2080 
	`¹Æ_uÆock
();

2081 
	}
}

2083 
	$¦si_Ãtif_»move_®l
(
¦si_dev
 *
sdev
)

2085 
i
;

2087 
	`SLSI_DBG1
(
sdev
, 
SLSI_NETDEV
, "\n");

2088 
	`¹Æ_lock
();

2089 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2090 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++)

2091 ià(
sdev
->
Ãtdev
[
i
])

2092 
	`¦si_Ãtif_»move_locked
(
sdev
, sdev->
Ãtdev
[
i
]);

2093 
	`rcu_assign_poš‹r
(
sdev
->
Ãtdev_­
, 
NULL
);

2094 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2095 
	`¹Æ_uÆock
();

2096 
	}
}

2098 
	$¦si_Ãtif_deš™
(
¦si_dev
 *
sdev
)

2100 
	`SLSI_DBG1
(
sdev
, 
SLSI_NETDEV
, "\n");

2101 
	`¦si_Ãtif_»move_®l
(
sdev
);

2102 
	}
}

2104 #iâdeà
CONFIG_ARM


2105 
	$¦si_Ãtif_tı_ack_suµ»ssiÚ_¡¬t
(
Ãt_deviû
 *
dev
)

2107 
šdex
;

2108 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2109 
¦si_tı_ack_s
 *
tı_ack
;

2111 
ndev_vif
->
Ï¡_tı_ack
 = 
NULL
;

2112 
šdex
 = 0; index < 
TCP_ACK_SUPPRESSION_RECORDS_MAX
; index++) {

2113 
tı_ack
 = &
ndev_vif
->
ack_suµ»ssiÚ
[
šdex
];

2114 
tı_ack
->
dpÜt
 = 0;

2115 
tı_ack
->
daddr
 = 0;

2116 
tı_ack
->
¥Üt
 = 0;

2117 
tı_ack
->
§ddr
 = 0;

2118 
tı_ack
->
ack_£q
 = 0;

2119 
tı_ack
->
couÁ
 = 0;

2120 
tı_ack
->
max
 = 0;

2121 
tı_ack
->
age
 = 0;

2122 
	`skb_queue_h—d_š™
(&
tı_ack
->
li¡
);

2123 #ià
	`KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


2124 
	`tim”_£tup
(&
tı_ack
->
tim”
, 
¦si_Ãtif_tı_ack_suµ»ssiÚ_timeout
, 0);

2126 
tı_ack
->
tim”
.
funùiÚ
 = 
¦si_Ãtif_tı_ack_suµ»ssiÚ_timeout
;

2127 
tı_ack
->
tim”
.
d©a
 = ()tcp_ack;

2128 
	`š™_tim”
(&
tı_ack
->
tim”
);

2130 
tı_ack
->
ndev_vif
 =‚dev_vif;

2131 
tı_ack
->
¡©e
 = 1;

2133 
	`¦si_¥šlock_ü—‹
(&
ndev_vif
->
tı_ack_lock
);

2134 
	`mem£t
(&
ndev_vif
->
tı_ack_¡©s
, 0, (
¦si_tı_ack_¡©s
));

2136 
	}
}

2138 
	$¦si_Ãtif_tı_ack_suµ»ssiÚ_¡İ
(
Ãt_deviû
 *
dev
)

2140 
šdex
;

2141 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2142 
¦si_tı_ack_s
 *
tı_ack
;

2144 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2145 
	`¦si_¥šlock_lock
(&
ndev_vif
->
tı_ack_lock
);

2146 
šdex
 = 0; index < 
TCP_ACK_SUPPRESSION_RECORDS_MAX
; index++) {

2147 
tı_ack
 = &
ndev_vif
->
ack_suµ»ssiÚ
[
šdex
];

2148 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2149 
	`d–_tim”_sync
(&
tı_ack
->
tim”
);

2150 
	`¦si_¥šlock_lock
(&
ndev_vif
->
tı_ack_lock
);

2151 
tı_ack
->
¡©e
 = 0;

2152 
	`skb_queue_purge
(&
tı_ack
->
li¡
);

2154 
ndev_vif
->
Ï¡_tı_ack
 = 
NULL
;

2155 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2156 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2158 
	}
}

2160 #ià
KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


2161 
	$¦si_Ãtif_tı_ack_suµ»ssiÚ_timeout
(
tim”_li¡
 *
t
)

2163 
	$¦si_Ãtif_tı_ack_suµ»ssiÚ_timeout
(
d©a
)

2166 #ià
	`KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


2167 
¦si_tı_ack_s
 *
tı_ack
 = 
	`äom_tim”
Ñı_ack, 
t
, 
tim”
);

2169 
¦si_tı_ack_s
 *
tı_ack
 = (¦si_tı_ack_ *)
d©a
;

2171 
sk_buff
 *
skb
;

2172 
Ãtdev_vif
 *
ndev_vif
;

2173 
¦si_dev
 *
sdev
;

2174 
r
;

2176 ià(!
tı_ack
)

2179 
ndev_vif
 = 
tı_ack
->ndev_vif;

2181 ià(!
ndev_vif
)

2184 
sdev
 = 
ndev_vif
->sdev;

2186 
	`¦si_¥šlock_lock
(&
ndev_vif
->
tı_ack_lock
);

2188 ià(!
tı_ack
->
¡©e
) {

2189 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2193 (
skb
 = 
	`skb_dequeue
(&
tı_ack
->
li¡
)) != 0) {

2194 
tı_ack
->
couÁ
 = 0;

2196 ià(!
skb
->
dev
) {

2197 
	`kä“_skb
(
skb
);

2198 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2202 
ndev_vif
->
tı_ack_¡©s
.
ck_timeout
++;

2204 
r
 = 
	`¦si_tx_d©a
(
sdev
, 
skb
->
dev
, skb);

2205 ià(
r
 == 0) {

2206 
ndev_vif
->
tı_ack_¡©s
.
ck_£Á
++;

2207 
tı_ack
->
Ï¡_£Á
 = 
	`ktime_g‘
();

2208 } ià(
r
 =ğ-
ENOSPC
) {

2209 
ndev_vif
->
tı_ack_¡©s
.
ck_drİ³d
++;

2210 
	`kä“_skb
(
skb
);

2212 
ndev_vif
->
tı_ack_¡©s
.
ck_drİ³d
++;

2215 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2216 
	}
}

2218 
	$¦si_Ãtif_tı_ack_suµ»ssiÚ_İtiÚ
(
sk_buff
 *
skb
, 
u32
 
İtiÚ
)

2220 *
İtiÚs
;

2221 
u32
 
İ’
 = 0, 
Ën
 = 0;

2223 ià(
	`tı_hdr
(
skb
)->
doff
 > 5)

2224 
İ’
 = (
	`tı_hdr
(
skb
)->
doff
 - 5) * 4;

2226 
İtiÚs
 = ((
u8
 *)
	`tı_hdr
(
skb
)è+ 
TCP_ACK_SUPPRESSION_OPTIONS_OFFSET
;

2228 
İ’
 > 0) {

2229 
İtiÚs
[0]) {

2230 
TCP_ACK_SUPPRESSION_OPTION_EOL
:

2232 
TCP_ACK_SUPPRESSION_OPTION_NOP
:

2233 
Ën
 = 1;

2235 
TCP_ACK_SUPPRESSION_OPTION_MSS
:

2236 ià(
İtiÚ
 =ğ
TCP_ACK_SUPPRESSION_OPTION_MSS
)

2237  ((
İtiÚs
[2] << 8) | options[3]);

2238 
Ën
 = 
İtiÚs
[1];

2240 
TCP_ACK_SUPPRESSION_OPTION_WINDOW
:

2241 ià(
İtiÚ
 =ğ
TCP_ACK_SUPPRESSION_OPTION_WINDOW
)

2242  
İtiÚs
[2];

2243 
Ën
 = 1;

2245 
TCP_ACK_SUPPRESSION_OPTION_SACK
:

2246 ià(
İtiÚ
 =ğ
TCP_ACK_SUPPRESSION_OPTION_SACK
)

2248 
Ën
 = 
İtiÚs
[1];

2251 
Ën
 = 
İtiÚs
[1];

2257 ià(
Ën
 =ğ0 ||†’ > 
İ’
) {

2258 
	`SLSI_DBG_HEX_NODEV
(
SLSI_TX
, 
skb
->
d©a
, skb->
Ën
 < 128 ? skb->len : 128, "SKB:\n");

2261 
İ’
 -ğ
Ën
;

2262 
İtiÚs
 +ğ
Ën
;

2265 
	}
}

2267 
	$¦si_Ãtif_tı_ack_suµ»ssiÚ_syn
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2269 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2270 
¦si_tı_ack_s
 *
tı_ack
;

2271 
šdex
;

2273 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_TX
, "\n");

2274 
	`¦si_¥šlock_lock
(&
ndev_vif
->
tı_ack_lock
);

2275 
šdex
 = 0; index < 
TCP_ACK_SUPPRESSION_RECORDS_MAX
; index++) {

2276 
tı_ack
 = &
ndev_vif
->
ack_suµ»ssiÚ
[
šdex
];

2278 ià(!
tı_ack
->
¡©e
) {

2279 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2283 ià(
tı_ack
->
daddr
) {

2284 ià(
	`ktime_to_ms
(
	`ktime_sub
(
	`ktime_g‘
(), 
tı_ack
->
Ï¡_£Á
)è>ğ
TCP_ACK_SUPPRESSION_RECORD_UNUSED_TIMEOUT
 * 1000) {

2285 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_TX
, "d–‘© %d (%pI4.%d > %pI4.%d)\n", 
šdex
, &
tı_ack
->
§ddr
, 
	`Áohs
Ñı_ack->
¥Üt
), &tı_ack->
daddr
,‚tohsÑı_ack->
dpÜt
));

2286 
	`skb_queue_purge
(&
tı_ack
->
li¡
);

2287 
tı_ack
->
dpÜt
 = 0;

2288 
tı_ack
->
¥Üt
 = 0;

2289 
tı_ack
->
daddr
 = 0;

2290 
tı_ack
->
§ddr
 = 0;

2291 
tı_ack
->
couÁ
 = 0;

2292 
tı_ack
->
ack_£q
 = 0;

2293 
	`d–_tim”
(&
tı_ack
->
tim”
);

2297 ià(
tı_ack
->
daddr
 == 0) {

2298 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_TX
, "add‡ˆ%d (%pI4.%d > %pI4.%d)\n", 
šdex
, &
	`_hdr
(
skb
)->
§ddr
, 
	`Áohs
(
	`tı_hdr
(skb)->
sourû
), &_hdr(skb)->
daddr
,‚tohsÑı_hdr(skb)->
de¡
));

2299 
tı_ack
->
daddr
 = 
	`_hdr
(
skb
)->daddr;

2300 
tı_ack
->
§ddr
 = 
	`_hdr
(
skb
)->saddr;

2301 
tı_ack
->
dpÜt
 = 
	`tı_hdr
(
skb
)->
de¡
;

2302 
tı_ack
->
¥Üt
 = 
	`tı_hdr
(
skb
)->
sourû
;

2303 
tı_ack
->
couÁ
 = 0;

2304 
tı_ack
->
ack_£q
 = 0;

2305 
tı_ack
->
¦ow_¡¬t_couÁ
 = 0;

2306 
tı_ack
->
tı_¦ow_¡¬t
 = 
Œue
;

2307 ià(
tı_ack_suµ»ssiÚ_mÚ™Ü
) {

2308 
tı_ack
->
max
 = 0;

2309 
tı_ack
->
age
 = 0;

2311 
tı_ack
->
max
 = 
tı_ack_suµ»ssiÚ_max
;

2312 
tı_ack
->
age
 = 
tı_ack_suµ»ssiÚ_timeout
;

2314 
tı_ack
->
Ï¡_£Á
 = 
	`ktime_g‘
();

2316 ià(
tı_ack_suµ»ssiÚ_mÚ™Ü
) {

2317 
tı_ack
->
Ï¡_§m¶e_time
 = 
	`ktime_g‘
();

2318 
tı_ack
->
Ï¡_ack_£q
 = 0;

2319 
tı_ack
->
Ï¡_tı_¿‹
 = 0;

2320 
tı_ack
->
num_by‹s
 = 0;

2321 
tı_ack
->
hy¡”esis
 = 0;

2323 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


2324 
tı_ack
->
¡»am_id
 = 
šdex
;

2327 
tı_ack
->
wšdow_muÉl›r
 = 
	`¦si_Ãtif_tı_ack_suµ»ssiÚ_İtiÚ
(
skb
, 
TCP_ACK_SUPPRESSION_OPTION_WINDOW
);

2328 ià(
tı_ack
->
wšdow_muÉl›r
 > 14)

2329 
tı_ack
->
wšdow_muÉl›r
 = 0;

2330 
tı_ack
->
mss
 = 
	`¦si_Ãtif_tı_ack_suµ»ssiÚ_İtiÚ
(
skb
, 
TCP_ACK_SUPPRESSION_OPTION_MSS
);

2331 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_TX
, "İtiÚs: mss:%u, wšdow:%u\n", 
tı_ack
->
mss
,ı_ack->
wšdow_muÉl›r
);

2332 
	`SCSC_HIP4_SAMPLER_TCP_SYN
(
ndev_vif
->
sdev
->
mšÜ_´of
, 
šdex
, 
tı_ack
->
mss
);

2333 
	`SCSC_HIP4_SAMPLER_TCP_DATA
(
ndev_vif
->
sdev
->
mšÜ_´of
, 
šdex
, 
	`be32_to_ıu
(
	`tı_hdr
(
skb
)->
£q
));

2334 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2338 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2339 
	}
}

2341 
	$¦si_Ãtif_tı_ack_suµ»ssiÚ_fš
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2343 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2344 
¦si_tı_ack_s
 *
tı_ack
;

2345 
šdex
;

2347 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_TX
, "\n");

2348 
	`¦si_¥šlock_lock
(&
ndev_vif
->
tı_ack_lock
);

2349 
šdex
 = 0; index < 
TCP_ACK_SUPPRESSION_RECORDS_MAX
; index++) {

2350 
tı_ack
 = &
ndev_vif
->
ack_suµ»ssiÚ
[
šdex
];

2352 ià((
tı_ack
->
dpÜt
 =ğ
	`tı_hdr
(
skb
)->
de¡
) &&

2353 (
tı_ack
->
daddr
 =ğ
	`_hdr
(
skb
)->daddr)) {

2354 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_TX
, "d–‘© %d (%pI4.%d > %pI4.%d)\n", 
šdex
, &
tı_ack
->
§ddr
, 
	`Áohs
Ñı_ack->
¥Üt
), &tı_ack->
daddr
,‚tohsÑı_ack->
dpÜt
));

2355 
	`skb_queue_purge
(&
tı_ack
->
li¡
);

2356 
tı_ack
->
dpÜt
 = 0;

2357 
tı_ack
->
¥Üt
 = 0;

2358 
tı_ack
->
daddr
 = 0;

2359 
tı_ack
->
§ddr
 = 0;

2360 
tı_ack
->
couÁ
 = 0;

2361 
tı_ack
->
ack_£q
 = 0;

2363 ià(
tı_ack_suµ»ssiÚ_mÚ™Ü
) {

2364 
tı_ack
->
Ï¡_ack_£q
 = 0;

2365 
tı_ack
->
Ï¡_tı_¿‹
 = 0;

2366 
tı_ack
->
num_by‹s
 = 0;

2367 
tı_ack
->
hy¡”esis
 = 0;

2370 
	`d–_tim”
(&
tı_ack
->
tim”
);

2371 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


2372 
tı_ack
->
¡»am_id
 = 0;

2374 
	`SCSC_HIP4_SAMPLER_TCP_FIN
(
ndev_vif
->
sdev
->
mšÜ_´of
, 
šdex
);

2375 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2379 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2380 
	}
}

2382 
boŞ
 
	$¦si_Ãtif_tı_ack_suµ»ssiÚ_is_possibË
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2384 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2386 ià(
tı_ack_suµ»ssiÚ_di§bË
 ||

2387 (
tı_ack_suµ»ssiÚ_di§bË_2g
 && !
	`SLSI_IS_VIF_CHANNEL_5G
(
ndev_vif
)))

2388  
çl£
;

2393 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && (
	`com·»_‘h”_addr
(
	`‘h_hdr
(
skb
)->
h_sourû
, 
dev
->
dev_addr
) != 0))

2394  
çl£
;

2397 ià(
	`be16_to_ıu
(
	`‘h_hdr
(
skb
)->
h_´Ùo
è!ğ
ETH_P_IP
 ||

2398 
	`_hdr
(
skb
)->
´ÙocŞ
 !ğ
IPPROTO_TCP
 ||

2399 !
	`skb_Œª¥Üt_h—d”_was_£t
(
skb
))

2400  
çl£
;

2402 ià(
	`tı_hdr
(
skb
)->
syn
) {

2403 
	`¦si_Ãtif_tı_ack_suµ»ssiÚ_syn
(
dev
, 
skb
);

2404  
çl£
;

2406 ià(
	`tı_hdr
(
skb
)->
fš
) {

2407 
	`¦si_Ãtif_tı_ack_suµ»ssiÚ_fš
(
dev
, 
skb
);

2408  
çl£
;

2410 ià(!
	`tı_hdr
(
skb
)->
ack
 ||ı_hdr(skb)->
r¡
 ||ı_hdr(skb)->
urg
)

2411  
çl£
;

2413  
Œue
;

2414 
	}
}

2416 
	$¦si_Ãtif_tı_ack_suµ»ssiÚ_¿‹_ÿl
(
Ãt_deviû
 *
dev
, 
¦si_tı_ack_s
 *
tı_ack
, 
sk_buff
 *
skb
)

2418 
u32
 
tı_»cv_wšdow_size
 = 0;

2423 ià(
tı_ack
->
Ï¡_ack_£q
)

2424 
tı_ack
->
num_by‹s
 +ğ((
u32
)
	`be32_to_ıu
(
	`tı_hdr
(
skb
)->
ack_£q
è-ı_ack->
Ï¡_ack_£q
);

2426 
tı_ack
->
Ï¡_ack_£q
 = 
	`be32_to_ıu
(
	`tı_hdr
(
skb
)->
ack_£q
);

2427 ià(
	`ktime_to_ms
(
	`ktime_sub
(
	`ktime_g‘
(), 
tı_ack
->
Ï¡_§m¶e_time
)è> 
tı_ack_suµ»ssiÚ_mÚ™Ü_š‹rv®
) {

2428 
u16
 
acks_max
;

2429 
u32
 
tı_¿‹
 = ((
tı_ack
->
num_by‹s
 * 8è/ (
tı_ack_suµ»ssiÚ_mÚ™Ü_š‹rv®
 * 1000));

2431 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_TX
, "hysteresis:%uotal_bytes:%llu„ate:%u Mbps\n",

2432 
tı_ack
->
hy¡”esis
,ı_ack->
num_by‹s
, 
tı_¿‹
);

2435 ià((
	`abs
(
tı_¿‹
 - 
tı_ack
->
Ï¡_tı_¿‹
)è>ı_ack->
hy¡”esis
) {

2436 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


2437 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2439 ià(
tı_¿‹
 >ğ
tı_ack_suµ»ssiÚ_¿‹_v”y_high
) {

2440 
tı_ack
->
max
 = 
tı_ack_suµ»ssiÚ_¿‹_v”y_high_acks
;

2441 
tı_ack
->
age
 = 
tı_ack_suµ»ssiÚ_¿‹_v”y_high_timeout
;

2442 } ià(
tı_¿‹
 >ğ
tı_ack_suµ»ssiÚ_¿‹_high
) {

2443 
tı_ack
->
max
 = 
tı_ack_suµ»ssiÚ_¿‹_high_acks
;

2444 
tı_ack
->
age
 = 
tı_ack_suµ»ssiÚ_¿‹_high_timeout
;

2445 } ià(
tı_¿‹
 >ğ
tı_ack_suµ»ssiÚ_¿‹_low
) {

2446 
tı_ack
->
max
 = 
tı_ack_suµ»ssiÚ_¿‹_low_acks
;

2447 
tı_ack
->
age
 = 
tı_ack_suµ»ssiÚ_¿‹_low_timeout
;

2449 
tı_ack
->
max
 = 0;

2450 
tı_ack
->
age
 = 0;

2457 ià(
tı_ack
->
wšdow_muÉl›r
)

2458 
tı_»cv_wšdow_size
 = 
	`be16_to_ıu
(
	`tı_hdr
(
skb
)->
wšdow
è* (2 << 
tı_ack
->
wšdow_muÉl›r
);

2460 
tı_»cv_wšdow_size
 = 
	`be16_to_ıu
(
	`tı_hdr
(
skb
)->
wšdow
);

2461 
	`SCSC_HIP4_SAMPLER_TCP_RWND
(
ndev_vif
->
sdev
->
mšÜ_´of
, 
tı_ack
->
¡»am_id
, 
tı_»cv_wšdow_size
);

2463 
acks_max
 = (
tı_»cv_wšdow_size
 / 5è/ (2 * 
tı_ack
->
mss
);

2464 ià(
tı_ack
->
max
 > 
acks_max
)

2465 
tı_ack
->
max
 = 
acks_max
;

2467 
tı_ack
->
hy¡”esis
 = 
tı_¿‹
 / 5;

2468 
tı_ack
->
Ï¡_tı_¿‹
 = 
tı_¿‹
;

2469 
tı_ack
->
num_by‹s
 = 0;

2470 
tı_ack
->
Ï¡_§m¶e_time
 = 
	`ktime_g‘
();

2472 
	}
}

2474 
sk_buff
 *
	$¦si_Ãtif_tı_ack_suµ»ssiÚ_pkt
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2476 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2477 
šdex
, 
found
;

2478 
¦si_tı_ack_s
 *
tı_ack
;

2479 
fÜw¬d_now
 = 0, 
æush
 = 0;

2480 
sk_buff
 *
cskb
 = 0;

2481 
u32
 
tı_»cv_wšdow_size
 = 0;

2483 ià(!
	`¦si_Ãtif_tı_ack_suµ»ssiÚ_is_possibË
(
dev
, 
skb
))

2484  
skb
;

2486 
	`¦si_¥šlock_lock
(&
ndev_vif
->
tı_ack_lock
);

2487 
ndev_vif
->
tı_ack_¡©s
.
ck_acks
++;

2489 
found
 = 0;

2490 ià(
ndev_vif
->
Ï¡_tı_ack
) {

2491 
tı_ack
 = 
ndev_vif
->
Ï¡_tı_ack
;

2492 ià(!
tı_ack
->
¡©e
) {

2493 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2494 
ndev_vif
->
tı_ack_¡©s
.
ck_£Á
++;

2495 
	`SLSI_ERR_NODEV
("last_tcp_ack„ecord‚otƒnabled\n");

2496  
skb
;

2498 ià((
tı_ack
->
dpÜt
 =ğ
	`tı_hdr
(
skb
)->
de¡
) &&

2499 (
tı_ack
->
¥Üt
 =ğ
	`tı_hdr
(
skb
)->
sourû
) &&

2500 (
tı_ack
->
daddr
 =ğ
	`_hdr
(
skb
)->daddr)) {

2501 
found
 = 1;

2502 
ndev_vif
->
tı_ack_¡©s
.
ck_Ï¡»cÜd
++;

2505 ià(
found
 == 0) {

2507 
šdex
 = 0; index < 
TCP_ACK_SUPPRESSION_RECORDS_MAX
; index++) {

2508 
tı_ack
 = &
ndev_vif
->
ack_suµ»ssiÚ
[
šdex
];

2510 ià(!
tı_ack
->
¡©e
) {

2511 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2512 
ndev_vif
->
tı_ack_¡©s
.
ck_£Á
++;

2513 
	`SLSI_ERR_NODEV
("tı_ack„ecÜd %d‚ÙƒÇbËd\n", 
šdex
);

2514  
skb
;

2516 ià((
tı_ack
->
dpÜt
 =ğ
	`tı_hdr
(
skb
)->
de¡
) &&

2517 (
tı_ack
->
¥Üt
 =ğ
	`tı_hdr
(
skb
)->
sourû
) &&

2518 (
tı_ack
->
daddr
 =ğ
	`_hdr
(
skb
)->daddr)) {

2519 
found
 = 1;

2520 
ndev_vif
->
tı_ack_¡©s
.
ck_£¬ch»cÜd
++;

2524 ià(
found
 == 0) {

2526 
ndev_vif
->
tı_ack_¡©s
.
ck_nÜecÜd
++;

2527 
ndev_vif
->
tı_ack_¡©s
.
ck_£Á
++;

2528 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2529  
skb
;

2531 
ndev_vif
->
Ï¡_tı_ack
 = 
tı_ack
;

2535 ià(
	`be32_to_ıu
(
	`tı_hdr
(
skb
)->
ack_£q
è< 
tı_ack
->ack_seq) {

2537 ià(((
s32
)((
u32
)
	`be32_to_ıu
(
	`tı_hdr
(
skb
)->
ack_£q
è- (u32)
tı_ack
->ack_seq)) < 0) {

2538 
ndev_vif
->
tı_ack_¡©s
.
ck_dacks
++;

2539 
ndev_vif
->
tı_ack_¡©s
.
ck_£Á
++;

2540 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2541  
skb
;

2546 ià(
	`be16_to_ıu
(
	`_hdr
(
skb
)->
tÙ_Ën
è> ((_hdr(skb)->
ihl
 * 4è+ (
	`tı_hdr
(skb)->
doff
 * 4))) {

2547 
	`SCSC_HIP4_SAMPLER_TCP_DATA
(
ndev_vif
->
sdev
->
mšÜ_´of
, 
tı_ack
->
¡»am_id
, 
	`be32_to_ıu
(
	`tı_hdr
(
skb
)->
£q
));

2548 
	`SCSC_HIP4_SAMPLER_TCP_CWND
(
ndev_vif
->
sdev
->
mšÜ_´of
, 
tı_ack
->
¡»am_id
, (
skb
->
sk
è? 
	`tı_sk
(skb->sk)->
¢d_cwnd
 : 0);

2549 
	`SCSC_HIP4_SAMPLER_TCP_SEND_BUF
(
ndev_vif
->
sdev
->
mšÜ_´of
, 
tı_ack
->
¡»am_id
, (
skb
->
sk
è? (skb->sk)->
sk_¢dbuf
 : 0);

2550 
ndev_vif
->
tı_ack_¡©s
.
ck_hasd©a
++;

2551 
fÜw¬d_now
 = 1;

2552 
_fÜw¬d_now
;

2556 ià(
	`tı_hdr
(
skb
)->
psh
) {

2557 
ndev_vif
->
tı_ack_¡©s
.
ck_psh
++;

2558 
fÜw¬d_now
 = 1;

2559 
_fÜw¬d_now
;

2565 ià(
	`tı_hdr
(
skb
)->
eû
) {

2566 
ndev_vif
->
tı_ack_¡©s
.
ck_eû
++;

2567 
fÜw¬d_now
 = 1;

2568 
_fÜw¬d_now
;

2571 ià(
tı_ack_suµ»ssiÚ_mÚ™Ü
)

2572 
	`¦si_Ãtif_tı_ack_suµ»ssiÚ_¿‹_ÿl
(
dev
, 
tı_ack
, 
skb
);

2575 ià(
	`¦si_Ãtif_tı_ack_suµ»ssiÚ_İtiÚ
(
skb
, 
TCP_ACK_SUPPRESSION_OPTION_SACK
)) {

2576 
ndev_vif
->
tı_ack_¡©s
.
ck_§cks
++;

2586 
tı_ack
->
¦ow_¡¬t_couÁ
 = 0;

2587 
tı_ack
->
tı_¦ow_¡¬t
 = 
Œue
;

2588 
fÜw¬d_now
 = 1;

2589 
_fÜw¬d_now
;

2592 ià(
	`be32_to_ıu
(
	`tı_hdr
(
skb
)->
ack_£q
è=ğ
tı_ack
->ack_seq) {

2593 
ndev_vif
->
tı_ack_¡©s
.
ck_dacks
++;

2594 
fÜw¬d_now
 = 1;

2595 
_fÜw¬d_now
;

2602 ià(
tı_ack
->
tı_¦ow_¡¬t
) {

2603 
tı_ack
->
¦ow_¡¬t_couÁ
++;

2604 ià(
tı_ack
->
¦ow_¡¬t_couÁ
 >ğ
tı_ack_suµ»ssiÚ_¦ow_¡¬t_acks
) {

2605 
tı_ack
->
¦ow_¡¬t_couÁ
 = 0;

2606 
tı_ack
->
tı_¦ow_¡¬t
 = 
çl£
;

2608 
fÜw¬d_now
 = 1;

2609 
_fÜw¬d_now
;

2613 ià(
tı_ack_suµ»ssiÚ_mÚ™Ü
 && (!
tı_ack
->
max
 || !tı_ack->
age
)) {

2614 
fÜw¬d_now
 = 1;

2615 
_fÜw¬d_now
;

2619 ià((!
tı_ack_suµ»ssiÚ_d–ay_acks_suµ»ss
) &&

2620 ((
u32
)
	`be32_to_ıu
(
	`tı_hdr
(
skb
)->
ack_£q
è- 
tı_ack
->ack_£q > (2 *ı_ack->
mss
))) {

2621 
ndev_vif
->
tı_ack_¡©s
.
ck_d–ay_acks
++;

2622 
fÜw¬d_now
 = 1;

2623 
_fÜw¬d_now
;

2633 ià(!
tı_ack_suµ»ssiÚ_mÚ™Ü
) {

2634 ià(
tı_ack
->
wšdow_muÉl›r
)

2635 
tı_»cv_wšdow_size
 = 
	`be16_to_ıu
(
	`tı_hdr
(
skb
)->
wšdow
è* (2 << 
tı_ack
->
wšdow_muÉl›r
);

2637 
tı_»cv_wšdow_size
 = 
	`be16_to_ıu
(
	`tı_hdr
(
skb
)->
wšdow
);

2638 ià(
tı_»cv_wšdow_size
 < 
tı_ack_suµ»ssiÚ_rcv_wšdow
 * 1024) {

2639 
ndev_vif
->
tı_ack_¡©s
.
ck_low_wšdow
++;

2640 
fÜw¬d_now
 = 1;

2641 
_fÜw¬d_now
;

2645 ià(!
tı_ack_suµ»ssiÚ_mÚ™Ü
 && 
	`ktime_to_ms
(
	`ktime_sub
(
	`ktime_g‘
(), 
tı_ack
->
Ï¡_£Á
)è>ğtı_ack->
age
) {

2646 
ndev_vif
->
tı_ack_¡©s
.
ck_ktime
++;

2647 
fÜw¬d_now
 = 1;

2648 
_fÜw¬d_now
;

2652 ià(!
	`skb_queue_Ën
(&
tı_ack
->
li¡
)) {

2653 
	`skb_queue_
(&
tı_ack
->
li¡
, 
skb
);

2654 
tı_ack
->
couÁ
 = 1;

2655 
tı_ack
->
ack_£q
 = 
	`be32_to_ıu
(
	`tı_hdr
(
skb
)->ack_seq);

2656 ià(
tı_ack
->
age
)

2657 
	`mod_tim”
(&
tı_ack
->
tim”
, 
jiff›s
 + 
	`m£cs_to_jiff›s
Ñı_ack->
age
));

2658 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2661 
_fÜw¬d_now
:

2662 
cskb
 = 
	`skb_dequeue
(&
tı_ack
->
li¡
);

2663 ià(
cskb
) {

2664 ià(
tı_ack_suµ»ssiÚ_mÚ™Ü
 && 
tı_ack
->
age
)

2665 
	`mod_tim”
(&
tı_ack
->
tim”
, 
jiff›s
 + 
	`m£cs_to_jiff›s
Ñı_ack->
age
));

2666 
ndev_vif
->
tı_ack_¡©s
.
ck_suµ»s£d
++;

2667 
	`cÚsume_skb
(
cskb
);

2669 
	`skb_queue_
(&
tı_ack
->
li¡
, 
skb
);

2670 
tı_ack
->
ack_£q
 = 
	`be32_to_ıu
(
	`tı_hdr
(
skb
)->ack_seq);

2671 
tı_ack
->
couÁ
++;

2672 ià(
fÜw¬d_now
) {

2673 
æush
 = 1;

2675 ià(
tı_ack
->
couÁ
 >ğtı_ack->
max
) {

2676 
æush
 = 1;

2677 
ndev_vif
->
tı_ack_¡©s
.
ck_max
++;

2680 ià(!
æush
) {

2681 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2685 
cskb
 = 
	`skb_dequeue
(&
tı_ack
->
li¡
);

2686 
tı_ack
->
couÁ
 = 0;

2688 ià(
tı_ack
->
age
)

2689 
	`d–_tim”
(&
tı_ack
->
tim”
);

2691 
tı_ack
->
Ï¡_£Á
 = 
	`ktime_g‘
();

2692 
ndev_vif
->
tı_ack_¡©s
.
ck_£Á
++;

2693 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2694  
cskb
;

2695 
	}
}

	@netif.h

7 
	~"dev.h
"

9 #iâdeà
__SLSI_NETIF_H__


10 
	#__SLSI_NETIF_H__


	)

40 #iâdeà
ETH_P_PAE


41 
	#ETH_P_PAE
 0x888e

	)

43 #iâdeà
ETH_P_WAI


44 
	#ETH_P_WAI
 0x88b4

	)

47 
	#SLSI_NETIF_Q_PRIORITY
 0

	)

48 
	#SLSI_NETIF_Q_DISCARD
 1

	)

49 
	#SLSI_NETIF_Q_MULTICAST_START
 2

	)

50 
	#SLSI_NETIF_Q_ARP
 6

	)

51 
	#SLSI_NETIF_Q_PEER_START
 7

	)

53 
	#SLSI_NETIF_Q_PER_PEER
 4

	)

56 
	#SLSI_NETIF_SKB_HEADROOM
 (68 + 160)

	)

57 
	#SLSI_NETIF_SKB_TAILROOM
 0

	)

58 
	#SLSI_SYS_ERROR_RECOVERY_TIMEOUT
 1000

	)

60 
šlše
 
u16
 
	$¦si_Ãtif_g‘_³”_queue
(
s16
 
queue£t
, s16 
ac
)

62 
	`WARN_ON
(
ac
 > 
SLSI_NETIF_Q_PER_PEER
);

63  
SLSI_NETIF_Q_PEER_START
 + (
queue£t
 * 
SLSI_NETIF_Q_PER_PEER
è+ 
ac
;

64 
	}
}

67 
šlše
 
	$¦si_Ãtif_g‘_qs_äom_queue
(
queue
, 
ac
)

69  ((
queue
 - 
ac
 - 
SLSI_NETIF_Q_PEER_START
è/ 
SLSI_NETIF_Q_PER_PEER
);

70 
	}
}

72 
šlše
 
u16
 
	$¦si_Ãtif_g‘_muÉiÿ¡_queue
(
s16
 
ac
)

74 
	`WARN_ON
(
ac
 > 
SLSI_NETIF_Q_PER_PEER
);

75  
SLSI_NETIF_Q_MULTICAST_START
 + 
ac
;

76 
	}
}

78 
	#MAP_QS_TO_AID
(
qs
è(q + 1)

	)

79 
	#MAP_AID_TO_QS
(
aid
è×id - 1)

	)

81 
	e¦si_Œaffic_q
 {

82 
	mSLSI_TRAFFIC_Q_BE
 = 0,

83 
	mSLSI_TRAFFIC_Q_BK
,

84 
	mSLSI_TRAFFIC_Q_VI
,

85 
	mSLSI_TRAFFIC_Q_VO
,

88 
¦si_Œaffic_q
 
¦si_äame_´iÜ™y_to_ac_queue
(
u16
 
´iÜ™y
);

89 
¦si_ac_to_tids
(
¦si_Œaffic_q
 
ac
, *
tids
);

91 
	g¦si_dev
;

92 
	g¦si_³”
;

94 
¦si_Ãtif_š™
(
¦si_dev
 *
sdev
);

96 
¦si_Ãtif_dyÇmic_içû_add
(
¦si_dev
 *
sdev
, cÚ¡ *
Çme
);

97 
¦si_Ãtif_»gi¡”
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

98 
¦si_Ãtif_»gi¡”_¹Êl_locked
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

99 
¦si_Ãtif_»move
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

100 
¦si_Ãtif_»move_¹Êl_locked
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

101 
¦si_Ãtif_»move_®l
(
¦si_dev
 *
sdev
);

102 
¦si_Ãtif_deš™
(
¦si_dev
 *
sdev
);

103 
¦si_tdls_move_·ck‘s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

104 
¦si_³”
 *
¡a_³”
, ¦si_³” *
tdls_³”
, 
boŞ
 
cÚÃùiÚ
);

105 
¦si_Ãtif_»move_locked
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

106 
¦si_Ãtif_add_locked
(
¦si_dev
 *
sdev
, cÚ¡ *
Çme
, 
iâum
);

107 
¦si_Ãtif_»gi¡”_locked
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

108 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


109 
¦si_Ãt_¿ndomize_nmi_ndi
(
¦si_dev
 *
sdev
);

111 
¦si_Ãtif_£t_tid_cÚfig
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 
mode
, 
u32
 
uid
, u8 
tid
);

	@nl80211_vendor.c

6 
	~<lšux/v”siÚ.h
>

7 
	~<Ãt/cfg80211.h
>

8 
	~<Ãt/.h
>

9 
	~<lšux/‘h”deviû.h
>

10 
	~"dev.h
"

11 
	~"cfg80211_İs.h
"

12 
	~"debug.h
"

13 
	~"mgt.h
"

14 
	~"mlme.h
"

15 
	~"Ãtif.h
"

16 
	~"unifiio.h
"

17 
	~"mib.h
"

18 
	~"Æ80211_v’dÜ.h
"

19 
	~<lšux/uacûss.h
>

21 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_LOGGING


22 
	~"scsc_wifogg”.h
"

23 
	~"scsc_wifogg”_ršgs.h
"

24 
	~"scsc_wifogg”_ty³s.h
"

27 
	#SLSI_WIFI_TAG_VENDOR_SPECIFIC
 0

	)

28 
	#SLSI_WIFI_TAG_BSSID
 1

	)

29 
	#SLSI_WIFI_TAG_SSID
 3

	)

30 
	#SLSI_WIFI_TAG_STATUS
 4

	)

31 
	#SLSI_WIFI_TAG_IE
 12

	)

32 
	#SLSI_WIFI_TAG_REASON_CODE
 14

	)

33 
	#SLSI_WIFI_TAG_RSSI
 21

	)

34 
	#SLSI_WIFI_TAG_CHANNEL
 22

	)

35 
	#SLSI_WIFI_TAG_EAPOL_MESSAGE_TYPE
 29

	)

37 
	#SLSI_GSCAN_INVALID_RSSI
 0x7FFF

	)

38 
	#SLSI_EPNO_AUTH_FIELD_WEP_OPEN
 1

	)

39 
	#SLSI_EPNO_AUTH_FIELD_WPA_PSK
 2

	)

40 
	#SLSI_EPNO_AUTH_FIELD_WPA_EAP
 4

	)

41 
	#WIFI_EVENT_FW_BTM_FRAME_REQUEST
 56

	)

42 
	#WIFI_EVENT_FW_BTM_FRAME_RESPONSE
 57

	)

43 
	#WIFI_EVENT_FW_NR_FRAME_REQUEST
 58

	)

44 
	#WIFI_EVENT_FW_RM_FRAME_RESPONSE
 59

	)

45 
	#WIFI_EVENT_FW_CONNECTION_ATTEMPT_ABORTED
 60

	)

46 
	#WIFI_EVENT_ROAM_AUTH_TIMEOUT
 61

	)

47 
	#WIFI_EVENT_ROAM_SCAN_RESULT
 62

	)

48 
	#WIFI_EVENT_ROAM_RSSI_THRESHOLD
 63

	)

49 
	#WIFI_EVENT_FW_BEACON_REPORT_REQUEST
 64

	)

50 
	#WIFI_EVENT_FW_FTM_RANGE_REQUEST
 65

	)

51 
	#WIFI_EVENT_FW_NAN_ROLE_TYPE
 66

	)

52 
	#WIFI_EVENT_FW_FRAME_TRANSMIT_FAILURE
 67

	)

53 
	#WIFI_EVENT_FW_NR_FRAME_RESPONSE
 68

	)

54 
	#WIFI_EVENT_NAN_AVAILABILITY_UPDATE
 69

	)

55 
	#WIFI_EVENT_NAN_ULW_UPDATE
 70

	)

56 
	#WIFI_EVENT_NAN_TRAFFIC_UPDATE
 71

	)

57 
	#WIFI_EVENT_ASSOCIATING_DEAUTH_RECEIVED
 72

	)

59 
	#SLSI_WIFI_TAG_VD_RETRY_COUNT
 0xf00f

	)

60 
	#SLSI_WIFI_TAG_VD_EAPOL_KEY_TYPE
 0xF008

	)

61 
	#SLSI_WIFI_TAG_VD_SCAN_TYPE
 0xf012

	)

62 
	#SLSI_WIFI_TAG_VD_ROAMING_REASON
 0xf019

	)

63 
	#SLSI_WIFI_TAG_VD_CHANNEL_UTILISATION
 0xf01a

	)

64 
	#SLSI_WIFI_TAG_VD_BTM_REQUEST_MODE
 0xf01b

	)

65 
	#SLSI_WIFI_TAG_VD_BTM_RESPONSE_STATUS
 0xf01c

	)

66 
	#SLSI_WIFI_TAG_VD_SCORE
 0xf01d

	)

67 
	#SLSI_WIFI_TAG_VD_RSSI_THRESHOLD
 0xf01e

	)

68 
	#SLSI_WIFI_TAG_VD_CANDIDATE_LIST_COUNT
 0xf021

	)

69 
	#SLSI_WIFI_TAG_VD_OPERATING_CLASS
 0xf022

	)

70 
	#SLSI_WIFI_TAG_VD_MEASUREMENT_MODE
 0xf023

	)

71 
	#SLSI_WIFI_TAG_VD_MEASUREMENT_DURATION
 0xf024

	)

72 
	#SLSI_WIFI_TAG_VD_MIN_AP_COUNT
 0xf025

	)

73 
	#SLSI_WIFI_TAG_VD_CLUSTER_ID
 0xf026

	)

74 
	#SLSI_WIFI_TAG_VD_NAN_ROLE
 0xf027

	)

75 
	#SLSI_WIFI_TAG_VD_NAN_AMR
 0xf028

	)

76 
	#SLSI_WIFI_TAG_VD_NAN_HOP_COUNT
 0xf029

	)

77 
	#SLSI_WIFI_TAG_VD_NAN_NMI
 0xf02a

	)

78 
	#SLSI_WIFI_TAG_VD_MESSAGE_TYPE
 0xf02b

	)

79 
	#SLSI_WIFI_TAG_VD_ESTIMATED_TP
 0xf02c

	)

80 
	#SLSI_WIFI_TAG_VD_EXPIRED_TIMER_VALUE
 0xf02d

	)

81 
	#SLSI_WIFI_TAG_VD_MASTER_TSF
 0xf030

	)

82 
	#SLSI_WIFI_TAG_VD_SCHEDULE_TYPE
 0xf031

	)

83 
	#SLSI_WIFI_TAG_VD_START_OFFSET
 0xf032

	)

84 
	#SLSI_WIFI_TAG_VD_SLOT_DURATION
 0xf033

	)

85 
	#SLSI_WIFI_TAG_VD_SLOT_PERIOD
 0xf034

	)

86 
	#SLSI_WIFI_TAG_VD_BITMAP
 0xf035

	)

87 
	#SLSI_WIFI_TAG_VD_CHANNEL_INFO
 0xf036

	)

88 
	#SLSI_WIFI_TAG_VD_ULW_REASON
 0xf037

	)

89 
	#SLSI_WIFI_TAG_VD_ULW_INDEX
 0xf038

	)

90 
	#SLSI_WIFI_TAG_VD_ULW_START_TIME
 0xf039

	)

91 
	#SLSI_WIFI_TAG_VD_ULW_PERIOD
 0xf03a

	)

92 
	#SLSI_WIFI_TAG_VD_ULW_DURATION
 0xf03b

	)

93 
	#SLSI_WIFI_TAG_VD_ULW_COUNT
 0xf03c

	)

94 
	#SLSI_WIFI_TAG_VD_NAN_RX_TOTAL
 0xf03d

	)

95 
	#SLSI_WIFI_TAG_VD_NAN_TX_TOTAL
 0xf03e

	)

96 
	#SLSI_WIFI_TAG_VD_NAN_RX_AVERAGE
 0xf03f

	)

97 
	#SLSI_WIFI_TAG_VD_NAN_TX_AVERAGE
 0xf040

	)

98 
	#SLSI_WIFI_TAG_VD_FULL_SCAN_COUNT
 0xf041

	)

99 
	#SLSI_WIFI_TAG_VD_CU_RSSI_THRESHOLD
 0xf042

	)

100 
	#SLSI_WIFI_TAG_VD_CU_THRESHOLD
 0xf043

	)

101 
	#SLSI_WIFI_TAG_VD_ROAMING_TYPE
 0xf044

	)

102 
	#SLSI_WIFI_TAG_VD_PARAMETER_SET
 0xff00

	)

104 
	#SLSI_WIFI_EAPOL_KEY_TYPE_GTK
 0x0000

	)

105 
	#SLSI_WIFI_EAPOL_KEY_TYPE_PTK
 0x0001

	)

106 
	#SLSI_WIFI_ROAMING_SEARCH_REASON_RESERVED
 0

	)

107 
	#SLSI_WIFI_ROAMING_SEARCH_REASON_LOW_RSSI
 1

	)

108 
	#SLSI_WIFI_ROAMING_SEARCH_REASON_LINK_LOSS
 2

	)

109 
	#SLSI_WIFI_ROAMING_SEARCH_REASON_BTM_REQ
 3

	)

110 
	#SLSI_WIFI_ROAMING_SEARCH_REASON_CU_TRIGGER
 4

	)

111 
	#SLSI_WIFI_ROAMING_SEARCH_REASON_EMERGENCY
 5

	)

112 
	#SLSI_WIFI_ROAMING_SEARCH_REASON_IDLE
 6

	)

113 
	#SLSI_WIFI_ROAMING_SEARCH_REASON_SCAN_TIMER1_EXPIRY
 7

	)

114 
	#SLSI_WIFI_ROAMING_SEARCH_REASON_SCAN_TIMER2_EXPIRY
 8

	)

115 
	#SLSI_WIFI_ROAMING_SEARCH_REASON_INACTIVE_TIMER_EXPIRY
 9

	)

117 
	#SLSI_PSID_UNIFI_AC_NO_ACKS
 0x0918

	)

119 
	#MAX_SSID_LEN
 100

	)

120 
	#SLSI_MAX_NUM_RING
 10

	)

122 
	#MIN
(
a
, 
b
è((×è< (b)è? (aè: (b))

	)

124 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_LOGGING


125 
	gmem_dump_bufãr_size
;

126 *
	gmem_dump_bufãr
;

128 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


129 *
	$¦si_´št_ev’t_Çme
(
ev’t_id
)

131 
ev’t_id
) {

132 
SLSI_NL80211_SCAN_RESULTS_AVAILABLE_EVENT
:

134 
SLSI_NL80211_FULL_SCAN_RESULT_EVENT
:

136 
SLSI_NL80211_SCAN_EVENT
:

138 #ifdeà
CONFIG_SCSC_WLAN_KEY_MGMT_OFFLOAD


139 
SLSI_NL80211_VENDOR_SUBCMD_KEY_MGMT_ROAM_AUTH
:

142 
SLSI_NL80211_VENDOR_HANGED_EVENT
:

144 
SLSI_NL80211_EPNO_EVENT
:

146 
SLSI_NL80211_HOTSPOT_MATCH
:

148 
SLSI_NL80211_RSSI_REPORT_EVENT
:

150 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_LOGGING


151 
SLSI_NL80211_LOGGER_RING_EVENT
:

153 
SLSI_NL80211_LOGGER_FW_DUMP_EVENT
:

156 
SLSI_NL80211_NAN_RESPONSE_EVENT
:

158 
SLSI_NL80211_NAN_PUBLISH_TERMINATED_EVENT
:

160 
SLSI_NL80211_NAN_MATCH_EVENT
:

162 
SLSI_NL80211_NAN_MATCH_EXPIRED_EVENT
:

164 
SLSI_NL80211_NAN_SUBSCRIBE_TERMINATED_EVENT
:

166 
SLSI_NL80211_NAN_FOLLOWUP_EVENT
:

168 
SLSI_NL80211_NAN_DISCOVERY_ENGINE_EVENT
:

170 
SLSI_NL80211_RTT_RESULT_EVENT
:

172 
SLSI_NL80211_RTT_COMPLETE_EVENT
:

174 
SLSI_NL80211_VENDOR_ACS_EVENT
:

176 
SLSI_NL80211_NAN_TRANSMIT_FOLLOWUP_STATUS
:

178 
SLSI_NAN_EVENT_NDP_REQ
:

180 
SLSI_NAN_EVENT_NDP_CFM
:

182 
SLSI_NAN_EVENT_NDP_END
:

187 
	}
}

190 
	$¦si_v’dÜ_ev’t
(
¦si_dev
 *
sdev
, 
ev’t_id
, cÚ¡ *
d©a
, 
Ën
)

192 
sk_buff
 *
skb
;

193 
»t
 = 0;

195 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


196 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "Event: %s(%d), data = %p,†en = %d\n",

197 
	`¦si_´št_ev’t_Çme
(
ev’t_id
),ƒv’t_id, 
d©a
, 
Ën
);

200 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

201 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
Ën
, 
ev’t_id
, 
GFP_KERNEL
);

203 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
Ën
, 
ev’t_id
, 
GFP_KERNEL
);

205 ià(!
skb
) {

206 
	`SLSI_ERR_NODEV
("FaedØ®loÿ‹ skb fÜ v’dÜƒv’t: %d\n", 
ev’t_id
);

207  -
ENOMEM
;

210 
»t
 = 
	`Æa_put_nohdr
(
skb
, 
Ën
, 
d©a
);

211 ià(
»t
) {

212 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»t
);

213 
	`kä“_skb
(
skb
);

214  -
EINVAL
;

217 
	`cfg80211_v’dÜ_ev’t
(
skb
, 
GFP_KERNEL
);

220 
	}
}

222 
	$¦si_v’dÜ_cmd_»¶y
(
why
 *why, cÚ¡ *
d©a
, 
Ën
)

224 
sk_buff
 *
skb
;

225 
»t
 = 0;

227 
skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 
Ën
);

228 ià(!
skb
) {

229 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb\n");

230  -
ENOMEM
;

233 
»t
 = 
	`Æa_put_nohdr
(
skb
, 
Ën
, 
d©a
);

234 ià(
»t
) {

235 
	`SLSI_ERR_NODEV
("E¼Ü iÀÆa_put_*:%x\n", 
»t
);

236 
	`kä“_skb
(
skb
);

237  -
EINVAL
;

239  
	`cfg80211_v’dÜ_cmd_»¶y
(
skb
);

240 
	}
}

242 
Ãt_deviû
 *
	$¦si_gsÿn_g‘_Ãtdev
(
¦si_dev
 *
sdev
)

244  
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

245 
	}
}

247 
Ãtdev_vif
 *
	$¦si_gsÿn_g‘_vif
(
¦si_dev
 *
sdev
)

249 
Ãt_deviû
 *
dev
;

251 
dev
 = 
	`¦si_gsÿn_g‘_Ãtdev
(
sdev
);

252 ià(!
dev
) {

253 
	`SLSI_WARN_NODEV
("Dev is NULL\n");

254  
NULL
;

257  
	`Ãtdev_´iv
(
dev
);

258 
	}
}

260 
	$¦si_numb”_dig™s
(
num
)

262 
dig
 = 0;

263 
num
) {

264 
dig
++;

265 
num
 =‚um / 10;

268  
dig
;

269 
	}
}

271 *
	$¦si_´št_chªÃl_li¡
(
chªÃl_li¡
[], 
chªÃl_couÁ
)

273 
i
, 
¦’
 = 0;

274 *
¡ršg
 = 
	`km®loc
((
chªÃl_couÁ
 * 4è+ 1, 
GFP_KERNEL
);

275 
max_size
 = (
chªÃl_couÁ
 * 4) + 1;

277 ià(!
¡ršg
) {

278 
	`SLSI_ERR_NODEV
("Failedo‡llocate channel string\n");

281 
i
 = 0; i < 
chªÃl_couÁ
 && 
¦’
 < 
max_size
; i++)

282 
¦’
 +ğ
	`¢´štf
(&
¡ršg
[¦’], 
max_size
 - sËn, "%d ", 
chªÃl_li¡
[
i
]);

284  
¡ršg
;

285 
	}
}

287 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


288 
	$¦si_gsÿn_add_dump_·¿ms
(
¦si_Æ_gsÿn_·¿m
 *
Æ_gsÿn_·¿m
)

290 
i
;

291 
j
;

293 
	`SLSI_DBG2_NODEV
(
SLSI_GSCAN
, "Parameters for SLSI_NL80211_VENDOR_SUBCMD_ADD_GSCAN sub-command:\n");

294 
	`SLSI_DBG2_NODEV
(
SLSI_GSCAN
, "base_period: %d max_ap_per_scan: %d„eport_threshold_percent: %d„eport_threshold_num_scans = %d‚um_buckets: %d\n",

295 
Æ_gsÿn_·¿m
->
ba£_³riod
,‚l_gsÿn_·¿m->
max_­_³r_sÿn
,

296 
Æ_gsÿn_·¿m
->
»pÜt_th»shŞd_³rûÁ
,‚l_gsÿn_·¿m->
»pÜt_th»shŞd_num_sÿns
,

297 
Æ_gsÿn_·¿m
->
num_buck‘s
);

299 
i
 = 0; i < 
Æ_gsÿn_·¿m
->
num_buck‘s
; i++) {

300 
	`SLSI_DBG2_NODEV
(
SLSI_GSCAN
, "Buck‘: %d\n", 
i
);

301 
	`SLSI_DBG2_NODEV
(
SLSI_GSCAN
, "\tbucket_index: %d band: %d…eriod: %d„eport_events: %d‚um_channels: %d\n",

302 
Æ_gsÿn_·¿m
->
Æ_buck‘
[
i
].
buck‘_šdex
,‚l_gsÿn_·¿m->Æ_buck‘[i].
bªd
,

303 
Æ_gsÿn_·¿m
->
Æ_buck‘
[
i
].
³riod
,‚l_gsÿn_·¿m->Æ_buck‘[i].
»pÜt_ev’ts
,

304 
Æ_gsÿn_·¿m
->
Æ_buck‘
[
i
].
num_chªÃls
);

306 
j
 = 0; j < 
Æ_gsÿn_·¿m
->
Æ_buck‘
[
i
].
num_chªÃls
; j++)

307 
	`SLSI_DBG2_NODEV
(
SLSI_GSCAN
, "\tchannel_list[%d]: %d\n",

308 
j
, 
Æ_gsÿn_·¿m
->
Æ_buck‘
[
i
].
chªÃls
[j].
chªÃl
);

310 
	}
}

312 
	$¦si_gsÿn_sÿn_»s_dump
(
¦si_gsÿn_»suÉ
 *
sÿn_d©a
)

314 
¦si_Æ_sÿn_»suÉ_·¿m
 *
Æ_sÿn_»s
 = &
sÿn_d©a
->nl_scan_res;

316 
	`SLSI_DBG3_NODEV
(
SLSI_GSCAN
, "TS:%llu SSID:%s BSSID:%pM Chan:%d RSSI:%d Bcn_Int:%d Capab:%#x IE_Len:%d\n",

317 
Æ_sÿn_»s
->
ts
,‚l_sÿn_»s->
ssid
,‚l_sÿn_»s->
bssid
,‚l_sÿn_»s->
chªÃl
,

318 
Æ_sÿn_»s
->
rssi
,‚l_sÿn_»s->
b—cÚ_³riod
,‚l_sÿn_»s->
ÿ·b™y
,‚l_sÿn_»s->
›_Ëngth
);

320 
	`SLSI_DBG_HEX_NODEV
(
SLSI_GSCAN
, &
Æ_sÿn_»s
->
›_d©a
[0],‚l_sÿn_»s->
›_Ëngth
, "IE_Data:\n");

321 ià(
sÿn_d©a
->
ªqp_Ëngth
) {

322 
	`SLSI_DBG3_NODEV
(
SLSI_GSCAN
, "ANQP_LENGTH:%d\n", 
sÿn_d©a
->
ªqp_Ëngth
);

323 
	`SLSI_DBG_HEX_NODEV
(
SLSI_GSCAN
, 
Æ_sÿn_»s
->
›_d©a
 +‚l_sÿn_»s->
›_Ëngth
, 
sÿn_d©a
->
ªqp_Ëngth
, "ANQP_info:\n");

325 
	}
}

328 
	$¦si_gsÿn_g‘_ÿ·b™›s
(
why
 *wiphy,

329 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

331 
¦si_Æ_gsÿn_ÿ·b™›s
 
Æ_ÿp
;

332 
»t
 = 0;

333 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

335 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "SUBCMD_GET_GSCAN_CAPABILITIES\n");

336 ià(!
	`¦si_dev_gsÿn_suµÜ‹d
())

337  -
ENOTSUPP
;

339 
	`mem£t
(&
Æ_ÿp
, 0, (
¦si_Æ_gsÿn_ÿ·b™›s
));

341 
»t
 = 
	`¦si_mib_g‘_gsÿn_ÿp
(
sdev
, &
Æ_ÿp
);

342 ià(
»t
 != 0) {

343 
	`SLSI_ERR
(
sdev
, "Failedo„ead mib\n");

344  
»t
;

347 
Æ_ÿp
.
max_sÿn_ÿche_size
 = 
SLSI_GSCAN_MAX_SCAN_CACHE_SIZE
;

348 
Æ_ÿp
.
max_­_ÿche_³r_sÿn
 = 
SLSI_GSCAN_MAX_AP_CACHE_PER_SCAN
;

349 
Æ_ÿp
.
max_sÿn_»pÜtšg_th»shŞd
 = 
SLSI_GSCAN_MAX_SCAN_REPORTING_THRESHOLD
;

351 
»t
 = 
	`¦si_v’dÜ_cmd_»¶y
(
why
, &
Æ_ÿp
, (
¦si_Æ_gsÿn_ÿ·b™›s
));

352 ià(
»t
)

353 
	`SLSI_ERR_NODEV
("gsÿn_g‘_ÿ·b™› v’dÜ cmd„•ly faed (”¸ğ%d)\n", 
»t
);

355  
»t
;

356 
	}
}

358 
u32
 
	$¦si_gsÿn_put_chªÃls
(
›“80211_suµÜ‹d_bªd
 *
chª_d©a
, 
boŞ
 
no_dfs
, boŞ 
Úly_dfs
, 
u32
 *
buf
)

360 
u32
 
chª_couÁ
 = 0;

361 
u32
 
chª_æags
;

362 
i
;

364 ià(
chª_d©a
 =ğ
NULL
) {

365 
	`SLSI_DBG3_NODEV
(
SLSI_GSCAN
, "Band‚ot supported\n");

368 
chª_æags
 = (
IEEE80211_CHAN_NO_IR
 | 
IEEE80211_CHAN_NO_OFDM
 | 
IEEE80211_CHAN_RADAR
);

370 
i
 = 0; i < 
chª_d©a
->
n_chªÃls
; i++) {

371 ià(
chª_d©a
->
chªÃls
[
i
].
æags
 & 
IEEE80211_CHAN_DISABLED
)

373 ià(
Úly_dfs
) {

374 ià(
chª_d©a
->
chªÃls
[
i
].
æags
 & 
chª_æags
)

375 
buf
[
chª_couÁ
++] = 
chª_d©a
->
chªÃls
[
i
].
ûÁ”_äeq
;

378 ià(
no_dfs
 && (
chª_d©a
->
chªÃls
[
i
].
æags
 & 
chª_æags
))

380 
buf
[
chª_couÁ
++] = 
chª_d©a
->
chªÃls
[
i
].
ûÁ”_äeq
;

382  
chª_couÁ
;

383 
	}
}

385 
	$¦si_gsÿn_g‘_v®id_chªÃl
(
why
 *wiphy,

386 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

388 
»t
 = 0, 
ty³
, 
bªd
;

389 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

390 
u32
 *
chª_li¡
;

391 
u32
 
chª_couÁ
 = 0, 
mem_Ën
 = 0;

392 
sk_buff
 *
»¶y
;

394 ià(
Ën
 < 
SLSI_NL_VENDOR_DATA_OVERHEAD
 || !
d©a
)

395  -
EINVAL
;

397 
ty³
 = 
	`Æa_ty³
(
d©a
);

399 ià(
ty³
 =ğ
GSCAN_ATTRIBUTE_BAND
) {

400 ià(
	`¦si_ut_Æa_g‘_u32
((
Æ©Œ
 *)
d©a
, (
u32
 *)(&
bªd
)))

401  -
EINVAL
;

403  -
EINVAL
;

405 ià(
bªd
 == 0) {

406 
	`SLSI_WARN
(
sdev
, "NO Bands.„eturn 0 channel\n");

407  
»t
;

410 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

411 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "bªd %d\n", 
bªd
);

412 ià(
why
->
bªds
[
NL80211_BAND_2GHZ
])

413 
mem_Ën
 +ğ
why
->
bªds
[
NL80211_BAND_2GHZ
]->
n_chªÃls
 * (
u32
);

415 ià(
why
->
bªds
[
NL80211_BAND_5GHZ
])

416 
mem_Ën
 +ğ
why
->
bªds
[
NL80211_BAND_5GHZ
]->
n_chªÃls
 * (
u32
);

418 ià(
mem_Ën
 == 0) {

419 
»t
 = -
ENOTSUPP
;

420 
ex™
;

423 
chª_li¡
 = 
	`km®loc
(
mem_Ën
, 
GFP_KERNEL
);

424 ià(
chª_li¡
 =ğ
NULL
) {

425 
»t
 = -
ENOMEM
;

426 
ex™
;

428 
mem_Ën
 +ğ
SLSI_NL_VENDOR_REPLY_OVERHEAD
 + (
SLSI_NL_ATTRIBUTE_U32_LEN
 * 2);

429 
»¶y
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 
mem_Ën
);

430 ià(
»¶y
 =ğ
NULL
) {

431 
»t
 = -
ENOMEM
;

432 
ex™_w™h_chª_li¡
;

434 
bªd
) {

435 
WIFI_BAND_BG
:

436 
chª_couÁ
 = 
	`¦si_gsÿn_put_chªÃls
(
why
->
bªds
[
NL80211_BAND_2GHZ
], 
çl£
, f®£, 
chª_li¡
);

438 
WIFI_BAND_A
:

439 
chª_couÁ
 = 
	`¦si_gsÿn_put_chªÃls
(
why
->
bªds
[
NL80211_BAND_5GHZ
], 
Œue
, 
çl£
, 
chª_li¡
);

441 
WIFI_BAND_A_DFS
:

442 
chª_couÁ
 = 
	`¦si_gsÿn_put_chªÃls
(
why
->
bªds
[
NL80211_BAND_5GHZ
], 
çl£
, 
Œue
, 
chª_li¡
);

444 
WIFI_BAND_A_WITH_DFS
:

445 
chª_couÁ
 = 
	`¦si_gsÿn_put_chªÃls
(
why
->
bªds
[
NL80211_BAND_5GHZ
], 
çl£
, f®£, 
chª_li¡
);

447 
WIFI_BAND_ABG
:

448 
chª_couÁ
 = 
	`¦si_gsÿn_put_chªÃls
(
why
->
bªds
[
NL80211_BAND_2GHZ
], 
Œue
, 
çl£
, 
chª_li¡
);

449 
chª_couÁ
 +ğ
	`¦si_gsÿn_put_chªÃls
(
why
->
bªds
[
NL80211_BAND_5GHZ
], 
Œue
, 
çl£
, 
chª_li¡
 + chan_count);

451 
WIFI_BAND_ABG_WITH_DFS
:

452 
chª_couÁ
 = 
	`¦si_gsÿn_put_chªÃls
(
why
->
bªds
[
NL80211_BAND_2GHZ
], 
çl£
, f®£, 
chª_li¡
);

453 
chª_couÁ
 +ğ
	`¦si_gsÿn_put_chªÃls
(
why
->
bªds
[
NL80211_BAND_5GHZ
], 
çl£
, f®£, 
chª_li¡
 + chan_count);

456 
chª_couÁ
 = 0;

457 
	`SLSI_WARN
(
sdev
, "Inv®id Bªd %d\n", 
bªd
);

459 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
GSCAN_ATTRIBUTE_NUM_CHANNELS
, 
chª_couÁ
);

460 
»t
 |ğ
	`Æa_put
(
»¶y
, 
GSCAN_ATTRIBUTE_CHANNEL_LIST
, 
chª_couÁ
 * (
u32
), 
chª_li¡
);

461 ià(
»t
) {

462 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»t
);

463 
	`kä“_skb
(
»¶y
);

464 
ex™_w™h_chª_li¡
;

466 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
»¶y
);

468 ià(
»t
)

469 
	`SLSI_ERR
(
sdev
, "FAILEDo„eply GET_VALID_CHANNELS\n");

471 
ex™_w™h_chª_li¡
:

472 
	`kä“
(
chª_li¡
);

473 
ex™
:

474 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

475  
»t
;

476 
	}
}

478 
¦si_gsÿn_»suÉ
 *
	$¦si_´•¬e_sÿn_»suÉ
(
sk_buff
 *
skb
, 
u16
 
ªqp_Ëngth
, 
hs2_id
)

480 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

481 
¦si_gsÿn_»suÉ
 *
sÿn_»s
;

482 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 6, 0))

483 
time¥ec64
 
ts
;

485 
time¥ec
 
ts
;

487 cÚ¡ 
u8
 *
ssid_›
;

488 
mem_»qd
;

489 
›_Ën
;

490 
u8
 *
›
;

492 
›
 = &
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
[0];

493 
›_Ën
 = 
	`çpi_g‘_d©®’
(
skb
è- (
›
 - (
u8
 *)
mgmt
è- 
ªqp_Ëngth
;

496 
mem_»qd
 = ((
¦si_gsÿn_»suÉ
è- 1è+ 
›_Ën
 + 
ªqp_Ëngth
 + (è+ (
u16
);

499 
sÿn_»s
 = 
	`km®loc
(
mem_»qd
, 
GFP_KERNEL
);

500 ià(
sÿn_»s
 =ğ
NULL
) {

501 
	`SLSI_ERR_NODEV
("Failedo‡llocate memory for scan„esult\n");

502  
NULL
;

506 
sÿn_»s
->
sÿn_»s_Ën
 = ((
¦si_Æ_sÿn_»suÉ_·¿m
è- 1è+ 
›_Ën
;

507 
sÿn_»s
->
ªqp_Ëngth
 = 0;

508 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 6, 0))

509 
ts
 = 
	`ktime_to_time¥ec64
(
	`ktime_g‘_boÙtime
());

510 #–ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 4, 0))

511 
ts
 = 
	`ktime_to_time¥ec
(
	`ktime_g‘_boÙtime
());

513 
	`g‘_mÚÙÚic_boÙtime
(&
ts
);

515 
sÿn_»s
->
Æ_sÿn_»s
.
ts
 = (
u64
)
	`TIMESPEC_TO_US
(ts);

517 
ssid_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, &
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
[0], 
›_Ën
);

518 ià((
ssid_›
 !ğ
NULL
è&& (ssid_›[1] > 0è&& (ssid_›[1] < 
IEEE80211_MAX_SSID_LEN
)) {

519 
	`memıy
(
sÿn_»s
->
Æ_sÿn_»s
.
ssid
, &
ssid_›
[2], ssid_ie[1]);

520 
sÿn_»s
->
Æ_sÿn_»s
.
ssid
[
ssid_›
[1]] = '\0';

522 
sÿn_»s
->
Æ_sÿn_»s
.
ssid
[0] = '\0';

525 
	`SLSI_ETHER_COPY
(
sÿn_»s
->
Æ_sÿn_»s
.
bssid
, 
mgmt
->bssid);

526 
sÿn_»s
->
Æ_sÿn_»s
.
chªÃl
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_sÿn_šd
.
chªÃl_äequ’cy
) / 2;

527 
sÿn_»s
->
Æ_sÿn_»s
.
rssi
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_sÿn_šd
.rssi);

528 
sÿn_»s
->
Æ_sÿn_»s
.
¹t
 = 
SLSI_GSCAN_RTT_UNSPECIFIED
;

529 
sÿn_»s
->
Æ_sÿn_»s
.
¹t_sd
 = 
SLSI_GSCAN_RTT_UNSPECIFIED
;

530 
sÿn_»s
->
Æ_sÿn_»s
.
b—cÚ_³riod
 = 
mgmt
->
u
.
b—cÚ
.
b—cÚ_št
;

531 
sÿn_»s
->
Æ_sÿn_»s
.
ÿ·b™y
 = 
mgmt
->
u
.
b—cÚ
.
ÿ·b_šfo
;

532 
sÿn_»s
->
Æ_sÿn_»s
.
›_Ëngth
 = 
›_Ën
;

533 
	`memıy
(
sÿn_»s
->
Æ_sÿn_»s
.
›_d©a
, 
›
, 
›_Ën
);

534 
	`memıy
(
sÿn_»s
->
Æ_sÿn_»s
.
›_d©a
 + 
›_Ën
, &
hs2_id
, ());

535 
	`memıy
(
sÿn_»s
->
Æ_sÿn_»s
.
›_d©a
 + 
›_Ën
 + (), &
ªqp_Ëngth
, (
u16
));

536 ià(
ªqp_Ëngth
) {

537 
	`memıy
(
sÿn_»s
->
Æ_sÿn_»s
.
›_d©a
 + 
›_Ën
 + (
u16
è+ (), 
›
 + ie_Ën, 
ªqp_Ëngth
);

538 
sÿn_»s
->
ªqp_Ëngth
 =‡nqp_Ëngth + (
u16
) + ();

541 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


542 
	`¦si_gsÿn_sÿn_»s_dump
(
sÿn_»s
);

545  
sÿn_»s
;

546 
	}
}

548 
	$¦si_gsÿn_hash_add
(
¦si_dev
 *
sdev
, 
¦si_gsÿn_»suÉ
 *
sÿn_»s
)

550 
u8
 
key
 = 
	`SLSI_GSCAN_GET_HASH_KEY
(
sÿn_»s
->
Æ_sÿn_»s
.
bssid
[5]);

551 
Ãtdev_vif
 *
ndev_vif
;

553 
ndev_vif
 = 
	`¦si_gsÿn_g‘_vif
(
sdev
);

554 ià(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
sÿn_mu‹x
))

555 
	`SLSI_WARN_NODEV
("ndev_vif->scan_mutex is‚ot†ocked\n");

557 
sÿn_»s
->
hÃxt
 = 
sdev
->
gsÿn_hash_bË
[
key
];

558 
sdev
->
gsÿn_hash_bË
[
key
] = 
sÿn_»s
;

561 
sdev
->
bufãr_cÚsumed
 +ğ
sÿn_»s
->
sÿn_»s_Ën
;

562 
sdev
->
num_gsÿn_»suÉs
++;

563 
	}
}

565 
¦si_gsÿn_»suÉ
 *
	$¦si_gsÿn_hash_g‘
(
¦si_dev
 *
sdev
, 
u8
 *
mac
)

567 
¦si_gsÿn_»suÉ
 *
‹mp
;

568 
Ãtdev_vif
 *
ndev_vif
;

569 
u8
 
key
 = 
	`SLSI_GSCAN_GET_HASH_KEY
(
mac
[5]);

571 
ndev_vif
 = 
	`¦si_gsÿn_g‘_vif
(
sdev
);

573 ià(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
sÿn_mu‹x
))

574 
	`SLSI_WARN_NODEV
("ndev_vif->scan_mutex is‚ot†ocked\n");

576 
‹mp
 = 
sdev
->
gsÿn_hash_bË
[
key
];

577 
‹mp
 !ğ
NULL
) {

578 ià(
	`memcmp
(
‹mp
->
Æ_sÿn_»s
.
bssid
, 
mac
, 
ETH_ALEN
) == 0)

579  
‹mp
;

580 
‹mp
 =emp->
hÃxt
;

583  
NULL
;

584 
	}
}

586 
	$¦si_gsÿn_hash_»move
(
¦si_dev
 *
sdev
, 
u8
 *
mac
)

588 
u8
 
key
 = 
	`SLSI_GSCAN_GET_HASH_KEY
(
mac
[5]);

589 
¦si_gsÿn_»suÉ
 *
cu¼
;

590 
¦si_gsÿn_»suÉ
 *
´ev
;

591 
Ãtdev_vif
 *
ndev_vif
;

592 
¦si_gsÿn_»suÉ
 *
sÿn_»s
 = 
NULL
;

594 
ndev_vif
 = 
	`¦si_gsÿn_g‘_vif
(
sdev
);

595 ià(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
sÿn_mu‹x
))

596 
	`SLSI_WARN_NODEV
("ndev_vif->scan_mutex is‚ot†ocked\n");

598 ià(
sdev
->
gsÿn_hash_bË
[
key
] =ğ
NULL
)

601 ià(
	`memcmp
(
sdev
->
gsÿn_hash_bË
[
key
]->
Æ_sÿn_»s
.
bssid
, 
mac
, 
ETH_ALEN
) == 0) {

602 
sÿn_»s
 = 
sdev
->
gsÿn_hash_bË
[
key
];

603 
sdev
->
gsÿn_hash_bË
[
key
] = sdev->gsÿn_hash_bË[key]->
hÃxt
;

605 
´ev
 = 
sdev
->
gsÿn_hash_bË
[
key
];

606 
cu¼
 = 
´ev
->
hÃxt
;

608 
cu¼
 !ğ
NULL
) {

609 ià(
	`memcmp
(
cu¼
->
Æ_sÿn_»s
.
bssid
, 
mac
, 
ETH_ALEN
) == 0) {

610 
sÿn_»s
 = 
cu¼
;

611 
´ev
->
hÃxt
 = 
cu¼
->hnext;

614 
´ev
 = 
cu¼
;

615 
cu¼
 = cu¼->
hÃxt
;

619 ià(
sÿn_»s
) {

621 
sdev
->
bufãr_cÚsumed
 -ğ
sÿn_»s
->
sÿn_»s_Ën
;

622 
sdev
->
num_gsÿn_»suÉs
--;

623 
	`kä“
(
sÿn_»s
);

626 ià(
sdev
->
num_gsÿn_»suÉs
 < 0)

627 
	`SLSI_ERR
(
sdev
, "WrÚg‚um_gsÿn_»suÉs: %d\n", sdev->
num_gsÿn_»suÉs
);

628 
	}
}

630 
	$¦si_check_sÿn_»suÉ
(
¦si_dev
 *
sdev
, 
¦si_buck‘
 *
buck‘
, 
¦si_gsÿn_»suÉ
 *
Ãw_sÿn_»s
)

632 
¦si_gsÿn_»suÉ
 *
sÿn_»s
;

635 
sÿn_»s
 = 
	`¦si_gsÿn_hash_g‘
(
sdev
, 
Ãw_sÿn_»s
->
Æ_sÿn_»s
.
bssid
);

636 ià(
sÿn_»s
 =ğ
NULL
) {

637 ià((
sdev
->
bufãr_cÚsumed
 + 
Ãw_sÿn_»s
->
sÿn_»s_Ën
è>ğ
SLSI_GSCAN_MAX_SCAN_CACHE_SIZE
) {

638 
	`SLSI_DBG2
(
sdev
, 
SLSI_GSCAN
,

640 
sdev
->
bufãr_cÚsumed
, sdev->
bufãr_th»shŞd
);

643  
SLSI_DISCARD_SCAN_RESULT
;

646  
SLSI_KEEP_SCAN_RESULT
;

650 ià(
sÿn_»s
->
sÿn_cyşe
 =ğ
buck‘
->scan_cycle)

652 ià(
Ãw_sÿn_»s
->
Æ_sÿn_»s
.
rssi
 < 
sÿn_»s
->nl_scan_res.rssi)

653  
SLSI_DISCARD_SCAN_RESULT
;

656 
	`¦si_gsÿn_hash_»move
(
sdev
, 
sÿn_»s
->
Æ_sÿn_»s
.
bssid
);

658  
SLSI_KEEP_SCAN_RESULT
;

659 
	}
}

661 
	$¦si_gsÿn_hªdË_sÿn_»suÉ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
u16
 
sÿn_id
, 
boŞ
 
sÿn_dÚe
)

663 
¦si_gsÿn_»suÉ
 *
sÿn_»s
 = 
NULL
;

664 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

665 
¦si_buck‘
 *
buck‘
;

666 
u16
 
buck‘_šdex
;

667 
ev’t_ty³
 = 
WIFI_SCAN_FAILED
;

668 
u16
 
ªqp_Ëngth
;

669 
hs2_ÃtwÜk_id
;

671 ià(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
sÿn_mu‹x
))

672 
	`SLSI_WARN_NODEV
("ndev_vif->scan_mutex is‚ot†ocked\n");

674 
	`SLSI_NET_DBG_HEX
(
dev
, 
SLSI_GSCAN
, 
skb
->
d©a
, skb->
Ën
, "mlme_scan_ind skb->len: %d\n", skb->len);

676 
buck‘_šdex
 = 
sÿn_id
 - 
SLSI_GSCAN_SCAN_ID_START
;

677 ià(
buck‘_šdex
 >ğ
SLSI_GSCAN_MAX_BUCKETS
) {

678 
	`SLSI_NET_ERR
(
dev
, "Inv®id buck‘ index: %d (sÿn_id = %#x)\n", 
buck‘_šdex
, 
sÿn_id
);

679 
out
;

682 
buck‘
 = &
sdev
->buck‘[
buck‘_šdex
];

683 ià(!
buck‘
->
u£d
) {

684 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_GSCAN
, "Buck‘ i nÙ‡ùive, index: %d (sÿn_id = %#x)\n", 
buck‘_šdex
, 
sÿn_id
);

685 
out
;

689 ià(
sÿn_dÚe
) {

690 
buck‘
->
sÿn_cyşe
++;

691 
buck‘
->
gsÿn
->
num_sÿns
++;

693 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_GSCAN
, "scan done, scan_cycle = %d,‚um_scans = %d\n",

694 
buck‘
->
sÿn_cyşe
, buck‘->
gsÿn
->
num_sÿns
);

696 ià(
buck‘
->
»pÜt_ev’ts
 & 
SLSI_REPORT_EVENTS_EACH_SCAN
)

697 
ev’t_ty³
 = 
WIFI_SCAN_RESULTS_AVAILABLE
;

698 ià(
buck‘
->
gsÿn
->
num_sÿns
 % buck‘->gsÿn->
»pÜt_th»shŞd_num_sÿns
 == 0)

699 
ev’t_ty³
 = 
WIFI_SCAN_THRESHOLD_NUM_SCANS
;

700 ià(
sdev
->
bufãr_cÚsumed
 >ğsdev->
bufãr_th»shŞd
)

701 
ev’t_ty³
 = 
WIFI_SCAN_THRESHOLD_PERCENT
;

703 ià(
ev’t_ty³
 !ğ
WIFI_SCAN_FAILED
)

704 
	`¦si_v’dÜ_ev’t
(
sdev
, 
SLSI_NL80211_SCAN_EVENT
, &
ev’t_ty³
, (event_type));

706 
out
;

709 
ªqp_Ëngth
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_sÿn_šd
.
ªqp_–em’ts_Ëngth
);

711 
hs2_ÃtwÜk_id
 = 1;

713 
sÿn_»s
 = 
	`¦si_´•¬e_sÿn_»suÉ
(
skb
, 
ªqp_Ëngth
, 
hs2_ÃtwÜk_id
);

714 ià(
sÿn_»s
 =ğ
NULL
) {

715 
	`SLSI_NET_ERR
(
dev
, "Failedo…repare scan„esult\n");

716 
out
;

720 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_sÿn_šd
.
´eã¼edÃtwÜk_­
)) {

721 ià(
ªqp_Ëngth
 == 0)

722 
	`¦si_v’dÜ_ev’t
(
sdev
, 
SLSI_NL80211_EPNO_EVENT
,

723 &
sÿn_»s
->
Æ_sÿn_»s
, sÿn_»s->
sÿn_»s_Ën
);

725 
	`¦si_v’dÜ_ev’t
(
sdev
, 
SLSI_NL80211_HOTSPOT_MATCH
,

726 &
sÿn_»s
->
Æ_sÿn_»s
, sÿn_»s->
sÿn_»s_Ën
 + sÿn_»s->
ªqp_Ëngth
);

729 ià(
buck‘
->
»pÜt_ev’ts
 & 
SLSI_REPORT_EVENTS_FULL_RESULTS
) {

730 
sk_buff
 *
Æev’t
;

732 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_GSCAN
, "report_events: SLSI_REPORT_EVENTS_FULL_RESULTS\n");

733 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

734 
Æev’t
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
sÿn_»s
->
sÿn_»s_Ën
 + 4, 
SLSI_NL80211_FULL_SCAN_RESULT_EVENT
, 
GFP_KERNEL
);

736 
Æev’t
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
sÿn_»s
->
sÿn_»s_Ën
 + 4, 
SLSI_NL80211_FULL_SCAN_RESULT_EVENT
, 
GFP_KERNEL
);

738 ià(!
Æev’t
) {

739 
	`SLSI_ERR
(
sdev
, "çedØ®loÿ‹ sbk oàsize:%d\n", 
sÿn_»s
->
sÿn_»s_Ën
 + 4);

740 
	`kä“
(
sÿn_»s
);

741 
out
;

743 ià(
	`Æa_put_u32
(
Æev’t
, 
GSCAN_ATTRIBUTE_SCAN_BUCKET_BIT
, (1 << 
buck‘_šdex
)) ||

744 
	`Æa_put
(
Æev’t
, 
GSCAN_ATTRIBUTE_SCAN_RESULTS
, 
sÿn_»s
->
sÿn_»s_Ën
, &sÿn_»s->
Æ_sÿn_»s
)) {

745 
	`SLSI_ERR
(
sdev
, "failedo…ut data\n");

746 
	`kä“_skb
(
Æev’t
);

747 
	`kä“
(
sÿn_»s
);

748 
out
;

750 
	`cfg80211_v’dÜ_ev’t
(
Æev’t
, 
GFP_KERNEL
);

753 ià(
	`¦si_check_sÿn_»suÉ
(
sdev
, 
buck‘
, 
sÿn_»s
è=ğ
SLSI_DISCARD_SCAN_RESULT
) {

754 
	`kä“
(
sÿn_»s
);

755 
out
;

757 
	`¦si_gsÿn_hash_add
(
sdev
, 
sÿn_»s
);

759 
out
:

760 
	`kä“_skb
(
skb
);

761 
	}
}

763 
u8
 
	$¦si_gsÿn_g‘_sÿn_pŞicy
(
wifi_bªd
 
bªd
)

765 
u8
 
sÿn_pŞicy
;

767 
bªd
) {

768 
WIFI_BAND_UNSPECIFIED
:

769 
sÿn_pŞicy
 = 
FAPI_SCANPOLICY_ANY_RA
;

771 
WIFI_BAND_BG
:

772 
sÿn_pŞicy
 = 
FAPI_SCANPOLICY_2_4GHZ
;

774 
WIFI_BAND_A
:

775 
sÿn_pŞicy
 = (
FAPI_SCANPOLICY_5GHZ
 |

776 
FAPI_SCANPOLICY_NON_DFS
);

778 
WIFI_BAND_A_DFS
:

779 
sÿn_pŞicy
 = (
FAPI_SCANPOLICY_5GHZ
 |

780 
FAPI_SCANPOLICY_DFS
);

782 
WIFI_BAND_A_WITH_DFS
:

783 
sÿn_pŞicy
 = (
FAPI_SCANPOLICY_5GHZ
 |

784 
FAPI_SCANPOLICY_NON_DFS
 |

785 
FAPI_SCANPOLICY_DFS
);

787 
WIFI_BAND_ABG
:

788 
sÿn_pŞicy
 = (
FAPI_SCANPOLICY_5GHZ
 |

789 
FAPI_SCANPOLICY_NON_DFS
 |

790 
FAPI_SCANPOLICY_2_4GHZ
);

792 
WIFI_BAND_ABG_WITH_DFS
:

793 
sÿn_pŞicy
 = (
FAPI_SCANPOLICY_5GHZ
 |

794 
FAPI_SCANPOLICY_NON_DFS
 |

795 
FAPI_SCANPOLICY_DFS
 |

796 
FAPI_SCANPOLICY_2_4GHZ
);

799 
sÿn_pŞicy
 = 
FAPI_SCANPOLICY_ANY_RA
;

803 
	`SLSI_DBG2_NODEV
(
SLSI_GSCAN
, "SÿÀPŞicy: %#x\n", 
sÿn_pŞicy
);

805  
sÿn_pŞicy
;

806 
	}
}

808 
	$¦si_gsÿn_add_»ad_·¿ms
(
¦si_Æ_gsÿn_·¿m
 *
Æ_gsÿn_·¿m
, cÚ¡ *
d©a
, 
Ën
)

810 
j
 = 0;

811 
ty³
, 
tmp
, 
tmp1
, 
tmp2
, 
k
 = 0;

812 cÚ¡ 
Æ©Œ
 *
™”
, *
™”1
, *
™”2
;

813 
¦si_Æ_buck‘_·¿m
 *
Æ_buck‘
;

814 
u32
 
v®
 = 0;

816 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

817 ià(!
™”
)

818  -
EINVAL
;

820 
ty³
 = 
	`Æa_ty³
(
™”
);

822 ià(
j
 >ğ
SLSI_GSCAN_MAX_BUCKETS
)

825 
ty³
) {

826 
GSCAN_ATTRIBUTE_BASE_PERIOD
:

827 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
Æ_gsÿn_·¿m
->
ba£_³riod
))

828  -
EINVAL
;

830 
GSCAN_ATTRIBUTE_NUM_AP_PER_SCAN
:

831 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
Æ_gsÿn_·¿m
->
max_­_³r_sÿn
))

832  -
EINVAL
;

834 
GSCAN_ATTRIBUTE_REPORT_THRESHOLD
:

835 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
Æ_gsÿn_·¿m
->
»pÜt_th»shŞd_³rûÁ
))

836  -
EINVAL
;

838 
GSCAN_ATTRIBUTE_REPORT_THRESHOLD_NUM_SCANS
:

839 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
Æ_gsÿn_·¿m
->
»pÜt_th»shŞd_num_sÿns
))

840  -
EINVAL
;

842 
GSCAN_ATTRIBUTE_NUM_BUCKETS
:

843 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
Æ_gsÿn_·¿m
->
num_buck‘s
))

844  -
EINVAL
;

846 
GSCAN_ATTRIBUTE_CH_BUCKET_1
:

847 
GSCAN_ATTRIBUTE_CH_BUCKET_2
:

848 
GSCAN_ATTRIBUTE_CH_BUCKET_3
:

849 
GSCAN_ATTRIBUTE_CH_BUCKET_4
:

850 
GSCAN_ATTRIBUTE_CH_BUCKET_5
:

851 
GSCAN_ATTRIBUTE_CH_BUCKET_6
:

852 
GSCAN_ATTRIBUTE_CH_BUCKET_7
:

853 
GSCAN_ATTRIBUTE_CH_BUCKET_8
:

854 
	`Æa_fÜ_—ch_Ã¡ed
(
™”1
, 
™”
, 
tmp1
) {

855 ià(!
™”1
)

856  -
EINVAL
;

858 
ty³
 = 
	`Æa_ty³
(
™”1
);

860 
Æ_buck‘
 = 
Æ_gsÿn_·¿m
->nl_bucket;

862 
ty³
) {

863 
GSCAN_ATTRIBUTE_BUCKET_ID
:

864 ià(
	`¦si_ut_Æa_g‘_u32
(
™”1
, &(
Æ_buck‘
[
j
].
buck‘_šdex
)))

865  -
EINVAL
;

867 
GSCAN_ATTRIBUTE_BUCKET_PERIOD
:

868 ià(
	`¦si_ut_Æa_g‘_u32
(
™”1
, &(
Æ_buck‘
[
j
].
³riod
)))

869  -
EINVAL
;

871 
GSCAN_ATTRIBUTE_BUCKET_NUM_CHANNELS
:

872 ià(
	`¦si_ut_Æa_g‘_u32
(
™”1
, &(
Æ_buck‘
[
j
].
num_chªÃls
)))

873  -
EINVAL
;

875 
GSCAN_ATTRIBUTE_BUCKET_CHANNELS
:

876 
	`Æa_fÜ_—ch_Ã¡ed
(
™”2
, 
™”1
, 
tmp2
) {

877 ià(
k
 >ğ
SLSI_GSCAN_MAX_CHANNELS
)

879 ià(
	`¦si_ut_Æa_g‘_u32
(
™”2
, &(
Æ_buck‘
[
j
].
chªÃls
[
k
].
chªÃl
)))

880  -
EINVAL
;

881 
k
++;

883 
k
 = 0;

885 
GSCAN_ATTRIBUTE_BUCKETS_BAND
:

886 ià(
	`¦si_ut_Æa_g‘_u32
(
™”1
, &(
Æ_buck‘
[
j
].
bªd
)))

887  -
EINVAL
;

889 
GSCAN_ATTRIBUTE_REPORT_EVENTS
:

890 ià(
	`¦si_ut_Æa_g‘_u32
(
™”1
, &
v®
))

891  -
EINVAL
;

892 
Æ_buck‘
[
j
].
»pÜt_ev’ts
 = (
u8
)
v®
;

894 
GSCAN_ATTRIBUTE_BUCKET_EXPONENT
:

895 ià(
	`¦si_ut_Æa_g‘_u32
(
™”1
, &(
Æ_buck‘
[
j
].
expÚ’t
)))

896  -
EINVAL
;

898 
GSCAN_ATTRIBUTE_BUCKET_STEP_COUNT
:

899 ià(
	`¦si_ut_Æa_g‘_u32
(
™”1
, &(
Æ_buck‘
[
j
].
¡•_couÁ
)))

900  -
EINVAL
;

902 
GSCAN_ATTRIBUTE_BUCKET_MAX_PERIOD
:

903 ià(
	`¦si_ut_Æa_g‘_u32
(
™”1
, &(
Æ_buck‘
[
j
].
max_³riod
)))

904  -
EINVAL
;

907 
	`SLSI_ERR_NODEV
("NØATTR_BUKTS_ty³ - %x\n", 
ty³
);

911 
j
++;

914 
	`SLSI_ERR_NODEV
("NØGSCAN_ATTR_CH_BUKT_ty³ - %x\n", 
ty³
);

920 
	}
}

922 
	$¦si_gsÿn_add_v”ify_·¿ms
(
¦si_Æ_gsÿn_·¿m
 *
Æ_gsÿn_·¿m
)

924 
i
;

926 ià((
Æ_gsÿn_·¿m
->
max_­_³r_sÿn
 < 0è|| (Æ_gsÿn_·¿m->max_­_³r_sÿÀ> 
SLSI_GSCAN_MAX_AP_CACHE_PER_SCAN
)) {

927 
	`SLSI_ERR_NODEV
("Inv®id max_­_³r_sÿn: %d\n", 
Æ_gsÿn_·¿m
->
max_­_³r_sÿn
);

928  -
EINVAL
;

931 ià((
Æ_gsÿn_·¿m
->
»pÜt_th»shŞd_³rûÁ
 < 0è|| (Æ_gsÿn_·¿m->»pÜt_th»shŞd_³rûÁ > 
SLSI_GSCAN_MAX_SCAN_REPORTING_THRESHOLD
)) {

932 
	`SLSI_ERR_NODEV
("Inv®id„•Üt_th»shŞd_³rûÁ: %d\n", 
Æ_gsÿn_·¿m
->
»pÜt_th»shŞd_³rûÁ
);

933  -
EINVAL
;

936 ià((
Æ_gsÿn_·¿m
->
num_buck‘s
 <ğ0è|| (Æ_gsÿn_·¿m->num_buck‘ > 
SLSI_GSCAN_MAX_BUCKETS
)) {

937 
	`SLSI_ERR_NODEV
("Inv®id‚um_buck‘s: %d\n", 
Æ_gsÿn_·¿m
->
num_buck‘s
);

938  -
EINVAL
;

941 
i
 = 0; i < 
Æ_gsÿn_·¿m
->
num_buck‘s
; i++) {

942 ià((
Æ_gsÿn_·¿m
->
Æ_buck‘
[
i
].
bªd
 =ğ
WIFI_BAND_UNSPECIFIED
è&& (Æ_gsÿn_·¿m->Æ_buck‘[i].
num_chªÃls
 == 0)) {

943 
	`SLSI_ERR_NODEV
("No band/channels…rovided for gscan: band = %d,‚um_channel = %d\n",

944 
Æ_gsÿn_·¿m
->
Æ_buck‘
[
i
].
bªd
,‚l_gsÿn_·¿m->Æ_buck‘[i].
num_chªÃls
);

945  -
EINVAL
;

948 ià(
Æ_gsÿn_·¿m
->
Æ_buck‘
[
i
].
»pÜt_ev’ts
 > 4) {

949 
	`SLSI_ERR_NODEV
("UnsuµÜ‹d„•Üˆev’t:„•Üt_ev’ˆğ%d\n", 
Æ_gsÿn_·¿m
->
Æ_buck‘
[
i
].
»pÜt_ev’ts
);

950  -
EINVAL
;

955 
	}
}

957 
	$¦si_gsÿn_add_to_li¡
(
¦si_gsÿn
 **
sdev_gsÿn
, ¦si_gsÿÀ*
gsÿn
)

959 
gsÿn
->
Ãxt
 = *
sdev_gsÿn
;

960 *
sdev_gsÿn
 = 
gsÿn
;

961 
	}
}

963 
	$¦si_gsÿn_®loc_buck‘s
(
¦si_dev
 *
sdev
, 
¦si_gsÿn
 *
gsÿn
, 
num_buck‘s
)

965 
i
;

966 
buck‘_šdex
 = 0;

967 
ä“_buck‘s
 = 0;

969 
i
 = 0; i < 
SLSI_GSCAN_MAX_BUCKETS
; i++)

970 ià(!
sdev
->
buck‘
[
i
].
u£d
)

971 
ä“_buck‘s
++;

973 ià(
num_buck‘s
 > 
ä“_buck‘s
) {

974 
	`SLSI_ERR_NODEV
("Notƒnough free buckets,‚um_buckets = %d, free_buckets = %d\n",

975 
num_buck‘s
, 
ä“_buck‘s
);

976  -
EINVAL
;

980 
i
 = 0; i < 
SLSI_GSCAN_MAX_BUCKETS
; i++)

981 ià(!
sdev
->
buck‘
[
i
].
u£d
) {

982 
sdev
->
buck‘
[
i
].
u£d
 = 
Œue
;

983 
sdev
->
buck‘
[
i
].
gsÿn
 = gscan;

984 
gsÿn
->
buck‘
[
buck‘_šdex
] = &
sdev
->buck‘[
i
];

985 
buck‘_šdex
++;

986 ià(
buck‘_šdex
 =ğ
num_buck‘s
)

991 
	}
}

993 
	$¦si_gsÿn_ä“_buck‘s
(
¦si_gsÿn
 *
gsÿn
)

995 
¦si_buck‘
 *
buck‘
;

996 
i
;

998 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "gsÿÀğ%p,‚um_buck‘ ğ%d\n", 
gsÿn
, gsÿn->
num_buck‘s
);

1000 
i
 = 0; i < 
gsÿn
->
num_buck‘s
; i++) {

1001 
buck‘
 = 
gsÿn
->buck‘[
i
];

1003 
	`SLSI_DBG2_NODEV
(
SLSI_GSCAN
, "bucket = %p, used = %d,„eport_events = %d, scan_id = %#x, gscan = %p\n",

1004 
buck‘
, buck‘->
u£d
, buck‘->
»pÜt_ev’ts
, buck‘->
sÿn_id
, buck‘->
gsÿn
);

1005 ià(
buck‘
->
u£d
) {

1006 
buck‘
->
u£d
 = 
çl£
;

1007 
buck‘
->
»pÜt_ev’ts
 = 0;

1008 
buck‘
->
gsÿn
 = 
NULL
;

1011 
	}
}

1013 
	$¦si_gsÿn_æush_sÿn_»suÉs
(
¦si_dev
 *
sdev
)

1015 
Ãtdev_vif
 *
ndev_vif
;

1016 
¦si_gsÿn_»suÉ
 *
‹mp
;

1017 
i
;

1019 
ndev_vif
 = 
	`¦si_gsÿn_g‘_vif
(
sdev
);

1020 ià(!
ndev_vif
) {

1021 
	`SLSI_WARN_NODEV
("ndev_vif is NULL");

1025 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

1026 
i
 = 0; i < 
SLSI_GSCAN_HASH_TABLE_SIZE
; i++)

1027 
sdev
->
gsÿn_hash_bË
[
i
]) {

1028 
‹mp
 = 
sdev
->
gsÿn_hash_bË
[
i
];

1029 
sdev
->
gsÿn_hash_bË
[
i
] = sdev->gsÿn_hash_bË[i]->
hÃxt
;

1030 
sdev
->
num_gsÿn_»suÉs
--;

1031 
sdev
->
bufãr_cÚsumed
 -ğ
‹mp
->
sÿn_»s_Ën
;

1032 
	`kä“
(
‹mp
);

1035 
	`SLSI_DBG2
(
sdev
, 
SLSI_GSCAN
, "num_gscan_results: %d, buffer_consumed = %d\n",

1036 
sdev
->
num_gsÿn_»suÉs
, sdev->
bufãr_cÚsumed
);

1038 ià(
sdev
->
num_gsÿn_»suÉs
 != 0)

1039 
	`SLSI_WARN_NODEV
("sdev->num_gscan_results is‚ot zero\n");

1041 ià(
sdev
->
bufãr_cÚsumed
 != 0)

1042 
	`SLSI_WARN_NODEV
("sdev->buffer_consumedis‚ot zero\n");

1044 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

1045 
	}
}

1047 
	$¦si_gsÿn_add_mlme
(
¦si_dev
 *
sdev
, 
¦si_Æ_gsÿn_·¿m
 *
Æ_gsÿn_·¿m
, 
¦si_gsÿn
 *
gsÿn
)

1049 
¦si_gsÿn_·¿m
 
gsÿn_·¿m
;

1050 
Ãt_deviû
 *
dev
;

1051 
»t
 = 0;

1052 
i
;

1053 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


1054 
j
;

1055 
u8
 
mac_addr_mask
[
ETH_ALEN
];

1058 
dev
 = 
	`¦si_gsÿn_g‘_Ãtdev
(
sdev
);

1060 ià(!
dev
) {

1061 
	`SLSI_WARN_NODEV
("dev is NULL\n");

1062  -
EINVAL
;

1065 
i
 = 0; i < 
Æ_gsÿn_·¿m
->
num_buck‘s
; i++) {

1066 
u16
 
»pÜt_mode
 = 0;

1068 
gsÿn_·¿m
.
Æ_buck‘
 = &
Æ_gsÿn_·¿m
->Æ_buck‘[
i
];

1069 
gsÿn_·¿m
.
buck‘
 = 
gsÿn
->buck‘[
i
];

1071 ià(
gsÿn_·¿m
.
buck‘
->
»pÜt_ev’ts
) {

1072 ià(
gsÿn_·¿m
.
buck‘
->
»pÜt_ev’ts
 & 
SLSI_REPORT_EVENTS_EACH_SCAN
)

1073 
»pÜt_mode
 |ğ
FAPI_REPORTMODE_END_OF_SCAN_CYCLE
;

1074 ià(
gsÿn_·¿m
.
buck‘
->
»pÜt_ev’ts
 & 
SLSI_REPORT_EVENTS_FULL_RESULTS
)

1075 
»pÜt_mode
 |ğ
FAPI_REPORTMODE_REAL_TIME
;

1076 ià(
gsÿn_·¿m
.
buck‘
->
»pÜt_ev’ts
 & 
SLSI_REPORT_EVENTS_NO_BATCH
)

1077 
»pÜt_mode
 |ğ
FAPI_REPORTMODE_NO_BATCH
;

1079 
»pÜt_mode
 = 
FAPI_REPORTMODE_RESERVED
;

1082 ià(
»pÜt_mode
 == 0) {

1083 
	`SLSI_NET_ERR
(
dev
, "Inv®id„•Üˆev’ˆv®ue: %d\n", 
gsÿn_·¿m
.
buck‘
->
»pÜt_ev’ts
);

1084  -
EINVAL
;

1088 ià(
sdev
->
•no_aùive
)

1089 
»pÜt_mode
 |ğ
FAPI_REPORTMODE_NO_BATCH
;

1091 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


1092 
	`mem£t
(
mac_addr_mask
, 0xFF, 
ETH_ALEN
);

1093 ià(
sdev
->
sÿn_addr_£t
 == 1) {

1094 
j
 = 3; j < 
ETH_ALEN
; j++)

1095 
mac_addr_mask
[
j
] = 0x00;

1096 
»t
 = 
	`¦si_£t_mac_¿ndomi§tiÚ_mask
(
sdev
, 
mac_addr_mask
);

1097 ià(
»t
)

1098 
sdev
->
sÿn_addr_£t
 = 0;

1100 
	`¦si_£t_mac_¿ndomi§tiÚ_mask
(
sdev
, 
mac_addr_mask
);

1102 
»t
 = 
	`¦si_mlme_add_sÿn
(
sdev
,

1103 
dev
,

1104 
FAPI_SCANTYPE_GSCAN
,

1105 
»pÜt_mode
,

1107 
NULL
,

1108 
Æ_gsÿn_·¿m
->
Æ_buck‘
[
i
].
num_chªÃls
,

1109 
NULL
,

1110 &
gsÿn_·¿m
,

1111 
NULL
,

1113 
çl£
 );

1115 ià(
»t
 != 0) {

1116 
	`SLSI_NET_ERR
(
dev
, "FaedØadd buck‘: %d\n", 
i
);

1119 
i
 = (i - 1); i >= 0; i--)

1120 
	`¦si_mlme_d–_sÿn
(
sdev
, 
dev
, 
gsÿn
->
buck‘
[
i
]->
sÿn_id
, 
çl£
);

1125  
»t
;

1126 
	}
}

1128 
	$¦si_gsÿn_add
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1130 
»t
 = 0;

1131 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1132 
¦si_Æ_gsÿn_·¿m
 *
Æ_gsÿn_·¿m
 = 
NULL
;

1133 
¦si_gsÿn
 *
gsÿn
;

1134 
Ãtdev_vif
 *
ndev_vif
;

1135 
bufãr_th»shŞd
;

1136 
i
;

1138 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "SUBCMD_ADD_GSCAN\n");

1140 ià(!
sdev
) {

1141 
	`SLSI_WARN_NODEV
("sdev is NULL\n");

1142  -
EINVAL
;

1145 ià(!
	`¦si_dev_gsÿn_suµÜ‹d
())

1146  -
ENOTSUPP
;

1148 
ndev_vif
 = 
	`¦si_gsÿn_g‘_vif
(
sdev
);

1150 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

1152 
Æ_gsÿn_·¿m
 = 
	`kz®loc
((*Æ_gsÿn_·¿m), 
GFP_KERNEL
);

1153 ià(
Æ_gsÿn_·¿m
 =ğ
NULL
) {

1154 
	`SLSI_ERR_NODEV
("Failed for‡llocate memory for gscan…arams\n");

1155 
»t
 = -
ENOMEM
;

1156 
ex™
;

1159 
	`¦si_gsÿn_add_»ad_·¿ms
(
Æ_gsÿn_·¿m
, 
d©a
, 
Ën
);

1161 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1162 
	`¦si_gsÿn_add_dump_·¿ms
(
Æ_gsÿn_·¿m
);

1165 
»t
 = 
	`¦si_gsÿn_add_v”ify_·¿ms
(
Æ_gsÿn_·¿m
);

1166 ià(
»t
) {

1168 ià(
Æ_gsÿn_·¿m
->
num_buck‘s
 == 0) {

1169 
	`kä“
(
Æ_gsÿn_·¿m
);

1170 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

1174 
ex™
;

1178 
gsÿn
 = 
	`kz®loc
((*gsÿn), 
GFP_KERNEL
);

1179 ià(
gsÿn
 =ğ
NULL
) {

1180 
	`SLSI_ERR_NODEV
("Failedo‡llocate memory for gscan\n");

1181 
»t
 = -
ENOMEM
;

1182 
ex™
;

1185 
gsÿn
->
num_buck‘s
 = 
Æ_gsÿn_·¿m
->num_buckets;

1186 
gsÿn
->
»pÜt_th»shŞd_³rûÁ
 = 
Æ_gsÿn_·¿m
->report_threshold_percent;

1187 
gsÿn
->
»pÜt_th»shŞd_num_sÿns
 = 
Æ_gsÿn_·¿m
->report_threshold_num_scans;

1188 
gsÿn
->
Æ_buck‘
 = 
Æ_gsÿn_·¿m
->nl_bucket[0];

1191 
bufãr_th»shŞd
 = (
SLSI_GSCAN_MAX_SCAN_CACHE_SIZE
 * 
Æ_gsÿn_·¿m
->
»pÜt_th»shŞd_³rûÁ
) / 100;

1192 ià((
sdev
->
bufãr_th»shŞd
 == 0) || (buffer_threshold < sdev->buffer_threshold))

1193 
sdev
->
bufãr_th»shŞd
 = buffer_threshold;

1195 
»t
 = 
	`¦si_gsÿn_®loc_buck‘s
(
sdev
, 
gsÿn
, 
Æ_gsÿn_·¿m
->
num_buck‘s
);

1196 ià(
»t
)

1197 
ex™_w™h_gsÿn_ä“
;

1199 
i
 = 0; i < 
Æ_gsÿn_·¿m
->
num_buck‘s
; i++)

1200 
gsÿn
->
buck‘
[
i
]->
»pÜt_ev’ts
 = 
Æ_gsÿn_·¿m
->
Æ_buck‘
[i].report_events;

1202 
»t
 = 
	`¦si_gsÿn_add_mlme
(
sdev
, 
Æ_gsÿn_·¿m
, 
gsÿn
);

1203 ià(
»t
) {

1205 
	`¦si_gsÿn_ä“_buck‘s
(
gsÿn
);

1207 
ex™_w™h_gsÿn_ä“
;

1210 
	`¦si_gsÿn_add_to_li¡
(&
sdev
->
gsÿn
, gscan);

1212 
ex™
;

1214 
ex™_w™h_gsÿn_ä“
:

1215 
	`kä“
(
gsÿn
);

1216 
ex™
:

1217 
	`kä“
(
Æ_gsÿn_·¿m
);

1219 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

1220  
»t
;

1221 
	}
}

1223 
	$¦si_gsÿn_d–
(
why
 *wiphy,

1224 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1226 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1227 
Ãt_deviû
 *
dev
;

1228 
Ãtdev_vif
 *
ndev_vif
;

1229 
¦si_gsÿn
 *
gsÿn
;

1230 
»t
 = 0;

1231 
i
;

1233 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "SUBCMD_DEL_GSCAN\n");

1235 
dev
 = 
	`¦si_gsÿn_g‘_Ãtdev
(
sdev
);

1236 ià(!
dev
) {

1237 
	`SLSI_WARN_NODEV
("dev is NULL\n");

1238  -
EINVAL
;

1241 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1243 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

1244 
sdev
->
gsÿn
 !ğ
NULL
) {

1245 
gsÿn
 = 
sdev
->gscan;

1247 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "gsÿÀğ%p,‚um_buck‘ ğ%d\n", 
gsÿn
, gsÿn->
num_buck‘s
);

1249 
i
 = 0; i < 
gsÿn
->
num_buck‘s
; i++)

1250 ià(
gsÿn
->
buck‘
[
i
]->
u£d
)

1251 
	`¦si_mlme_d–_sÿn
(
sdev
, 
dev
, 
gsÿn
->
buck‘
[
i
]->
sÿn_id
, 
çl£
);

1252 
	`¦si_gsÿn_ä“_buck‘s
(
gsÿn
);

1253 
sdev
->
gsÿn
 = gsÿn->
Ãxt
;

1254 
	`kä“
(
gsÿn
);

1256 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

1258 
	`¦si_gsÿn_æush_sÿn_»suÉs
(
sdev
);

1260 
sdev
->
bufãr_th»shŞd
 = 0;

1262  
»t
;

1263 
	}
}

1265 
	$¦si_gsÿn_g‘_sÿn_»suÉs
(
why
 *wiphy,

1266 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1268 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1269 
sk_buff
 *
skb
;

1270 
¦si_gsÿn_»suÉ
 *
sÿn_»s
;

1271 
Æ©Œ
 *
sÿn_hdr
;

1272 
Ãtdev_vif
 *
ndev_vif
;

1273 
num_»suÉs
 = 0;

1274 
mem_Ãeded
;

1275 cÚ¡ 
Æ©Œ
 *
©Œ
;

1276 
Æ_num_»suÉs
 = 0;

1277 
»t
 = 0;

1278 
‹mp
;

1279 
ty³
;

1280 
i
;

1282 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "SUBCMD_GET_SCAN_RESULTS\n");

1285 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

1286 
ty³
 = 
	`Æa_ty³
(
©Œ
);

1288 
ty³
) {

1289 
GSCAN_ATTRIBUTE_NUM_OF_RESULTS
:

1290 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
Æ_num_»suÉs
))

1291  -
EINVAL
;

1294 
	`SLSI_ERR_NODEV
("UnknowÀ©Œibu‹: %d\n", 
ty³
);

1299 
ndev_vif
 = 
	`¦si_gsÿn_g‘_vif
(
sdev
);

1300 ià(!
ndev_vif
) {

1301 
	`SLSI_WARN_NODEV
("ndev_vif is NULL\n");

1302  -
EINVAL
;

1305 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

1307 
num_»suÉs
 = 
sdev
->
num_gsÿn_»suÉs
;

1309 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "Æ_num_»suÉs: %d,‚um_»suÉ ğ%d\n", 
Æ_num_»suÉs
, sdev->
num_gsÿn_»suÉs
);

1311 ià(
num_»suÉs
 == 0) {

1312 
	`SLSI_DBG1
(
sdev
, 
SLSI_GSCAN
, "No scan„esults‡vailable\n");

1314 
ex™
;

1318 ià(
num_»suÉs
 > 
Æ_num_»suÉs
)

1319 
num_»suÉs
 = 
Æ_num_»suÉs
;

1322 
mem_Ãeded
 = 
num_»suÉs
 * (
¦si_Æ_sÿn_»suÉ_·¿m
) + 12;

1324 
skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 
mem_Ãeded
);

1325 ià(
skb
 =ğ
NULL
) {

1326 
	`SLSI_ERR_NODEV
("skb‡lloc failed");

1327 
»t
 = -
ENOMEM
;

1328 
ex™
;

1331 
sÿn_hdr
 = 
	`Æa_Ã¡_¡¬t
(
skb
, 
GSCAN_ATTRIBUTE_SCAN_RESULTS
);

1332 ià(
sÿn_hdr
 =ğ
NULL
) {

1333 
	`kä“_skb
(
skb
);

1334 
	`SLSI_ERR_NODEV
("scan_hdr is NULL.\n");

1335 
»t
 = -
ENOMEM
;

1336 
ex™
;

1339 
»t
 |ğ
	`Æa_put_u32
(
skb
, 
GSCAN_ATTRIBUTE_SCAN_ID
, 0);

1340 
»t
 |ğ
	`Æa_put_u8
(
skb
, 
GSCAN_ATTRIBUTE_SCAN_FLAGS
, 0);

1341 
»t
 |ğ
	`Æa_put_u32
(
skb
, 
GSCAN_ATTRIBUTE_NUM_OF_RESULTS
, 
num_»suÉs
);

1343 
i
 = 0; i < 
SLSI_GSCAN_HASH_TABLE_SIZE
; i++)

1344 
sdev
->
gsÿn_hash_bË
[
i
]) {

1345 
sÿn_»s
 = 
sdev
->
gsÿn_hash_bË
[
i
];

1346 
sdev
->
gsÿn_hash_bË
[
i
] = sdev->gsÿn_hash_bË[i]->
hÃxt
;

1347 
sdev
->
num_gsÿn_»suÉs
--;

1348 
sdev
->
bufãr_cÚsumed
 -ğ
sÿn_»s
->
sÿn_»s_Ën
;

1350 
»t
 |ğ
	`Æa_put
(
skb
, 
GSCAN_ATTRIBUTE_SCAN_RESULTS
, (
¦si_Æ_sÿn_»suÉ_·¿m
), &
sÿn_»s
->
Æ_sÿn_»s
);

1351 
	`kä“
(
sÿn_»s
);

1352 
num_»suÉs
--;

1353 ià(
num_»suÉs
 == 0)

1354 
out
;

1356 
out
:

1357 
	`Æa_Ã¡_’d
(
skb
, 
sÿn_hdr
);

1358 ià(
»t
) {

1359 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»t
);

1360 
	`kä“_skb
(
skb
);

1361 
ex™
;

1363 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
skb
);

1364 
ex™
:

1365 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

1366  
»t
;

1367 
	}
}

1369 
	$¦si_rx_rssi_»pÜt_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

1371 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1372 
¦si_rssi_mÚ™Ü_evt
 
ev’t_d©a
;

1374 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1375 
	`SLSI_ETHER_COPY
(
ev’t_d©a
.
bssid
, 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_rssi_»pÜt_šd
.bssid));

1376 
ev’t_d©a
.
rssi
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_rssi_»pÜt_šd
.rssi);

1377 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "RSSIh»shŞd b»ached, Cu¼’ˆRSSI fÜ %pMğ%d\n", 
ev’t_d©a
.
bssid
,ƒv’t_d©a.
rssi
);

1378 
	`¦si_v’dÜ_ev’t
(
sdev
, 
SLSI_NL80211_RSSI_REPORT_EVENT
, &
ev’t_d©a
, (event_data));

1379 
	`kä“_skb
(
skb
);

1380 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1381 
	}
}

1383 
	$¦si_£t_v’dÜ_›
(
why
 *wiphy,

1384 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1386 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1387 
Ãt_deviû
 *
Ãt_dev
;

1388 
Ãtdev_vif
 *
ndev_vif
;

1389 cÚ¡ 
Æ©Œ
 *
©Œ
;

1390 
r
 = 0;

1391 
‹mp
;

1392 
ty³
;

1393 
u8
 *
›_li¡
 = 
NULL
;

1394 
›_li¡_Ën
 = 0;

1396 
Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

1397 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãt_dev
);

1399 
	`SLSI_INFO
(
sdev
, "Vendor CMD SCAN_DEFAULT_IES\n");

1400 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

1401 ià(!
©Œ
)

1402  -
EINVAL
;

1403 
ty³
 = 
	`Æa_ty³
(
©Œ
);

1404 
ty³
) {

1405 
SLSI_SCAN_DEFAULT_IES
:

1407 ià(!
	`Æa_Ën
(
©Œ
))

1409 
	`kä“
(
›_li¡
);

1410 
›_li¡
 = 
	`km®loc
(
	`Æa_Ën
(
©Œ
), 
GFP_KERNEL
);

1411 ià(!
›_li¡
) {

1412 
	`SLSI_ERR
(
sdev
, "No memory for ie_list!");

1413  -
ENOMEM
;

1415 
	`memıy
(
›_li¡
, 
	`Æa_d©a
(
©Œ
), 
	`Æa_Ën
(attr));

1416 
›_li¡_Ën
 = 
	`Æa_Ën
(
©Œ
);

1417 
	`SLSI_INFO
(
sdev
, "SCAN_DEFAULT_IES L’:%d\n", 
›_li¡_Ën
);

1421 ià(
ty³
 > 
SLSI_SCAN_DEFAULT_MAX
)

1422 
	`SLSI_ERR
(
sdev
, "Inv®idy³ : %d\n", 
ty³
);

1427 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1428 
	`kä“
(
sdev
->
deçuÉ_sÿn_›s
);

1429 
sdev
->
deçuÉ_sÿn_›s_Ën
 = 
›_li¡_Ën
;

1430 
sdev
->
deçuÉ_sÿn_›s
 = (
u8
 *)
›_li¡
;

1431 ià(
ndev_vif
->
aùiv©ed
)

1432 
r
 = 
	`¦si_add_´obe_›s_»que¡
(
sdev
, 
Ãt_dev
);

1433 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1434  
r
;

1435 
	}
}

1437 #ifdeà
CONFIG_SCSC_WLAN_KEY_MGMT_OFFLOAD


1438 
	$¦si_key_mgmt_£t_pmk
(
why
 *wiphy,

1439 
wœ–ess_dev
 *
wdev
, cÚ¡ *
pmk
, 
pmkËn
)

1441 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1442 
Ãt_deviû
 *
Ãt_dev
;

1443 
Ãtdev_vif
 *
ndev_vif
;

1444 
r
 = 0;

1446 ià(
wdev
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_CLIENT
) {

1447 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "Not„equiredo set PMK for P2P client\n");

1448  
r
;

1450 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "SUBCMD_SET_PMK Received\n");

1452 
Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

1453 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãt_dev
);

1455 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1457 
r
 = 
	`¦si_mlme_£t_pmk
(
sdev
, 
Ãt_dev
, 
pmk
, (
u16
)
pmkËn
);

1459 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1460  
r
;

1461 
	}
}

1464 
	$¦si_£t_bssid_bÏckli¡
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1466 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1467 
Ãt_deviû
 *
Ãt_dev
;

1468 
Ãtdev_vif
 *
ndev_vif
;

1469 
‹mp1
;

1470 
ty³
;

1471 cÚ¡ 
Æ©Œ
 *
©Œ
;

1472 
u32
 
num_bssids
 = 0;

1473 
u8
 
i
 = 0;

1474 
u8
 
äom_suµliÿÁ
 = 0;

1475 
»t
 = 0;

1476 
u8
 *
bssid
 = 
NULL
;

1477 
cfg80211_aş_d©a
 *
aş_d©a
 = 
NULL
;

1479 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "SUBCMD_SET_BSSID_BLACK_LIST\n");

1481 
Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

1482 ià(!
Ãt_dev
) {

1483 
	`SLSI_WARN_NODEV
("net_dev is NULL\n");

1484  -
EINVAL
;

1487 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãt_dev
);

1489 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1490 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp1
) {

1491 ià(!
©Œ
) {

1492 
	`SLSI_ERR_NODEV
("A‰ribu‹ i nuÎ :†’ = %d\n", 
Ën
);

1493 
»t
 = -
EINVAL
;

1497 
ty³
 = 
	`Æa_ty³
(
©Œ
);

1499 
ty³
) {

1500 
GSCAN_ATTRIBUTE_NUM_BSSID
:

1501 ià(
aş_d©a
)

1504 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
num_bssids
)) {

1505 
»t
 = -
EINVAL
;

1506 
ex™
;

1508 ià(
num_bssids
 > (
u32
)((
ULONG_MAX
 - (*
aş_d©a
)è/ ((
mac_add»ss
)))) {

1509 
»t
 = -
EINVAL
;

1510 
ex™
;

1512 
aş_d©a
 = 
	`km®loc
((*aş_d©aè+ ((
mac_add»ss
è* 
num_bssids
), 
GFP_KERNEL
);

1513 ià(!
aş_d©a
) {

1514 
»t
 = -
ENOMEM
;

1515 
ex™
;

1517 
aş_d©a
->
n_aş_’Œ›s
 = 
num_bssids
;

1520 
GSCAN_ATTRIBUTE_BLACKLIST_BSSID
:

1521 ià(!
aş_d©a
) {

1522 
»t
 = -
EINVAL
;

1523 
ex™
;

1526 ià(
	`Æa_Ën
(
©Œ
) != 6) {

1527 
»t
 = -
EINVAL
;

1528 
ex™
;

1531 ià(
i
 >ğ
num_bssids
) {

1532 
»t
 = -
EINVAL
;

1533 
ex™
;

1536 ià(
	`Æa_Ën
(
©Œ
è< 
ETH_ALEN
) {

1537 
»t
 = -
EINVAL
;

1538 
ex™
;

1540 
bssid
 = (
u8
 *)
	`Æa_d©a
(
©Œ
);

1542 
	`SLSI_ETHER_COPY
(
aş_d©a
->
mac_addrs
[
i
].
addr
, 
bssid
);

1543 
	`SLSI_DBG3_NODEV
(
SLSI_GSCAN
, "mac_addrs[%d]:%pM)\n", 
i
, 
aş_d©a
->
mac_addrs
[i].
addr
);

1544 
i
++;

1546 
GSCAN_ATTRIBUTE_BLACKLIST_FROM_SUPPLICANT
:

1547 
äom_suµliÿÁ
 = 1;

1550 
	`SLSI_ERR_NODEV
("UnknowÀ©Œibu‹: %d\n", 
ty³
);

1551 
»t
 = -
EINVAL
;

1552 
ex™
;

1556 ià(
aş_d©a
) {

1557 ià(
äom_suµliÿÁ
) {

1558 
	`kä“
(
ndev_vif
->
aş_d©a_suµliÿÁ
);

1559 
ndev_vif
->
aş_d©a_suµliÿÁ
 = 
aş_d©a
;

1561 
	`kä“
(
ndev_vif
->
aş_d©a_h®
);

1562 
ndev_vif
->
aş_d©a_h®
 = 
aş_d©a
;

1564 
»t
 = 
	`¦si_£t_aş
(
sdev
, 
Ãt_dev
);

1565 
aş_d©a
 = 
NULL
;

1568 
ex™
:

1569 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1570 
	`kä“
(
aş_d©a
);

1571  
»t
;

1572 
	}
}

1574 
	$¦si_¡¬t_k“·live_ofæßd
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1576 #iâdeà
CONFIG_SCSC_WLAN_NAT_KEEPALIVE_DISABLE


1577 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1578 
Ãt_deviû
 *
Ãt_dev
;

1579 
Ãtdev_vif
 *
ndev_vif
;

1581 
‹mp
;

1582 
ty³
;

1583 cÚ¡ 
Æ©Œ
 *
©Œ
;

1584 
u16
 
_pkt_Ën
 = 0;

1585 
u8
 *
_pkt
 = 
NULL
, *
¤c_mac_addr
 = NULL, *
d¡_mac_addr
 = NULL;

1586 
u32
 
³riod
 = 0;

1587 
¦si_³”
 *
³”
;

1588 
sk_buff
 *
skb
;

1589 
‘hhdr
 *
ehdr
;

1590 
r
 = 0;

1591 
u16
 
ho¡_g
 = 0;

1592 
u8
 
šdex
 = 0;

1594 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "SUBCMD_START_KEEPALIVE_OFFLOAD„eceived\n");

1595 
Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

1596 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãt_dev
);

1598 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1599 ià(!
ndev_vif
->
aùiv©ed
) {

1600 
	`SLSI_WARN_NODEV
("ndev_vif is‚ot‡ctivated\n");

1601 
r
 = -
EINVAL
;

1602 
ex™
;

1604 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) {

1605 
	`SLSI_WARN_NODEV
("ndev_vif->vif_type is‚ot FAPI_VIFTYPE_STATION\n");

1606 
r
 = -
EINVAL
;

1607 
ex™
;

1609 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

1610 
	`SLSI_WARN_NODEV
("ndev_vif->sta.vif_status is‚ot SLSI_VIF_STATUS_CONNECTED\n");

1611 
r
 = -
EINVAL
;

1612 
ex™
;

1615 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
Ãt_dev
, 
SLSI_STA_PEER_QUEUESET
);

1616 ià(!
³”
) {

1617 
	`SLSI_WARN_NODEV
("peer is NULL\n");

1618 
r
 = -
EINVAL
;

1619 
ex™
;

1622 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

1623 
ty³
 = 
	`Æa_ty³
(
©Œ
);

1625 
ty³
) {

1626 
MKEEP_ALIVE_ATTRIBUTE_IP_PKT_LEN
:

1627 ià(
	`¦si_ut_Æa_g‘_u16
(
©Œ
, &
_pkt_Ën
)) {

1628 
r
 = -
EINVAL
;

1629 
ex™
;

1633 
MKEEP_ALIVE_ATTRIBUTE_IP_PKT
:

1634 ià(
	`Æa_Ën
(
©Œ
è< 
_pkt_Ën
) {

1635 
r
 = -
EINVAL
;

1636 
ex™
;

1638 
_pkt
 = (
u8
 *)
	`Æa_d©a
(
©Œ
);

1641 
MKEEP_ALIVE_ATTRIBUTE_PERIOD_MSEC
:

1642 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
³riod
)) {

1643 
r
 = -
EINVAL
;

1644 
ex™
;

1648 
MKEEP_ALIVE_ATTRIBUTE_DST_MAC_ADDR
:

1649 ià(
	`Æa_Ën
(
©Œ
è< 
ETH_ALEN
) {

1650 
r
 = -
EINVAL
;

1651 
ex™
;

1653 
d¡_mac_addr
 = (
u8
 *)
	`Æa_d©a
(
©Œ
);

1656 
MKEEP_ALIVE_ATTRIBUTE_SRC_MAC_ADDR
:

1657 ià(
	`Æa_Ën
(
©Œ
è< 
ETH_ALEN
) {

1658 
r
 = -
EINVAL
;

1659 
ex™
;

1661 
¤c_mac_addr
 = (
u8
 *)
	`Æa_d©a
(
©Œ
);

1664 
MKEEP_ALIVE_ATTRIBUTE_ID
:

1665 ià(
	`¦si_ut_Æa_g‘_u8
(
©Œ
, &
šdex
)) {

1666 
r
 = -
EINVAL
;

1667 
ex™
;

1669 ià(
šdex
 > 
SLSI_MAX_KEEPALIVE_ID
) {

1670 
r
 = -
EINVAL
;

1671 
ex™
;

1676 
	`SLSI_ERR_NODEV
("UnknowÀ©Œibu‹: %d\n", 
ty³
);

1677 
r
 = -
EINVAL
;

1678 
ex™
;

1685 ià(!
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
Ãt_dev
, 
NULL
, 0,

1686 
FAPI_DATAUNITDESCRIPTOR_IEEE802_3_FRAME
,

1687 
FAPI_MESSAGETYPE_ANY_OTHER
,

1688 
ndev_vif
->
¡a
.
k“·live_ho¡_g
[
šdex
 - 1], 0, 0, 0))

1689 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "slsi_mlme_send_frame_mgmt„eturned failure\n");

1690 
skb
 = 
	`®loc_skb
(
SLSI_NETIF_SKB_HEADROOM
 + 
SLSI_NETIF_SKB_TAILROOM
 + (
‘hhdr
è+ 
_pkt_Ën
, 
GFP_KERNEL
);

1691 ià(!
skb
) {

1692 
	`SLSI_WARN_NODEV
("memÜy‡ÎoÿtiÚ faed fÜ skb (size: %d)\n", 
SLSI_NETIF_SKB_HEADROOM
 + 
SLSI_NETIF_SKB_TAILROOM
 + (
‘hhdr
è+ 
_pkt_Ën
);

1693 
r
 = -
ENOMEM
;

1694 
ex™
;

1697 
	`skb_»£rve
(
skb
, 
SLSI_NETIF_SKB_HEADROOM
 - 
	`SLSI_SKB_GET_ALIGNMENT_OFFSET
(skb));

1698 
	`skb_»£t_mac_h—d”
(
skb
);

1699 
	`skb_£t_ÃtwÜk_h—d”
(
skb
, (
‘hhdr
));

1702 
ehdr
 = (
‘hhdr
 *)
	`skb_put
(
skb
, (ethhdr));

1704 ià(
d¡_mac_addr
)

1705 
	`SLSI_ETHER_COPY
(
ehdr
->
h_de¡
, 
d¡_mac_addr
);

1706 ià(
¤c_mac_addr
)

1707 
	`SLSI_ETHER_COPY
(
ehdr
->
h_sourû
, 
¤c_mac_addr
);

1708 
ehdr
->
h_´Ùo
 = 
	`ıu_to_be16
(
ETH_P_IP
);

1709 ià(
_pkt
)

1710 
	`memıy
(
	`skb_put
(
skb
, 
_pkt_Ën
), 
_pkt
, ip_pkt_len);

1712 
skb
->
dev
 = 
Ãt_dev
;

1713 
skb
->
´ÙocŞ
 = 
ETH_P_IP
;

1714 
skb
->
_summed
 = 
CHECKSUM_UNNECESSARY
;

1717 
skb
->
queue_m­pšg
 = 
	`¦si_Ãtif_g‘_³”_queue
(0, 0);

1720 
	`_hdr
(
skb
)->
äag_off
 |ğ
	`htÚs
(
IP_DF
);

1723 
	`_hdr
(
skb
)->
check
 = 0;

1724 
	`_£nd_check
(
	`_hdr
(
skb
));

1726 
ho¡_g
 = 
	`¦si_tx_mgmt_ho¡_g
(
sdev
);

1727 
r
 = 
	`¦si_mlme_£nd_äame_d©a
(
sdev
, 
Ãt_dev
, 
skb
, 
FAPI_MESSAGETYPE_ANY_OTHER
, 
ho¡_g
,

1728 0, (
³riod
 * 1000));

1729 ià(
r
 == 0)

1730 
ndev_vif
->
¡a
.
k“·live_ho¡_g
[
šdex
 - 1] = 
ho¡_g
;

1732 
	`kä“_skb
(
skb
);

1734 
ex™
:

1735 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1736  
r
;

1738 
	`SLSI_DBG3_NODEV
(
SLSI_MLME
, "SUBCMD_START_KEEPALIVE_OFFLOAD„eceived\n");

1739 
	`SLSI_DBG3_NODEV
(
SLSI_MLME
, "NAT Keep Alive Feature is disabled\n");

1740  -
EOPNOTSUPP
;

1743 
	}
}

1745 
	$¦si_¡İ_k“·live_ofæßd
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1747 #iâdeà
CONFIG_SCSC_WLAN_NAT_KEEPALIVE_DISABLE


1748 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1749 
Ãt_deviû
 *
Ãt_dev
;

1750 
Ãtdev_vif
 *
ndev_vif
;

1751 
r
 = 0;

1752 
‹mp
;

1753 
ty³
;

1754 cÚ¡ 
Æ©Œ
 *
©Œ
;

1755 
u8
 
šdex
 = 0;

1757 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "SUBCMD_STOP_KEEPALIVE_OFFLOAD„eceived\n");

1758 
Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

1759 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãt_dev
);

1761 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1762 ià(!
ndev_vif
->
aùiv©ed
) {

1763 
	`SLSI_WARN
(
sdev
, "VIF is‚ot‡ctivated\n");

1764 
r
 = -
EINVAL
;

1765 
ex™
;

1767 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) {

1768 
	`SLSI_WARN
(
sdev
, "Not‡ STA VIF\n");

1769 
r
 = -
EINVAL
;

1770 
ex™
;

1772 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

1773 
	`SLSI_WARN
(
sdev
, "VIF is‚ot connected\n");

1774 
r
 = -
EINVAL
;

1775 
ex™
;

1778 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

1779 
ty³
 = 
	`Æa_ty³
(
©Œ
);

1781 
ty³
) {

1782 
MKEEP_ALIVE_ATTRIBUTE_ID
:

1783 ià(
	`¦si_ut_Æa_g‘_u8
(
©Œ
, &
šdex
)) {

1784 
r
 = -
EINVAL
;

1785 
ex™
;

1787 ià(
šdex
 > 
SLSI_MAX_KEEPALIVE_ID
) {

1788 
r
 = -
EINVAL
;

1789 
ex™
;

1794 
	`SLSI_ERR_NODEV
("UnknowÀ©Œibu‹: %d\n", 
ty³
);

1795 
r
 = -
EINVAL
;

1796 
ex™
;

1800 
r
 = 
	`¦si_mlme_£nd_äame_mgmt
(
sdev
, 
Ãt_dev
, 
NULL
, 0, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_3_FRAME
,

1801 
FAPI_MESSAGETYPE_ANY_OTHER
, 
ndev_vif
->
¡a
.
k“·live_ho¡_g
[
šdex
 - 1], 0, 0, 0);

1802 
ndev_vif
->
¡a
.
k“·live_ho¡_g
[
šdex
 - 1] = 0;

1804 
ex™
:

1805 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1806  
r
;

1808 
	`SLSI_DBG3_NODEV
(
SLSI_MLME
, "SUBCMD_STOP_KEEPALIVE_OFFLOAD„eceived\n");

1809 
	`SLSI_DBG3_NODEV
(
SLSI_MLME
, "NAT Keep Alive Feature is disabled\n");

1810  -
EOPNOTSUPP
;

1813 
	}
}

1815 
šlše
 
	$¦si_•no_ssid_li¡_g‘
(
¦si_dev
 *
sdev
,

1816 
¦si_•no_ssid_·¿m
 *
•no_ssid_·¿ms
, cÚ¡ 
Æ©Œ
 *
ou‹r
)

1818 
ty³
, 
tmp
;

1819 
u8
 
•no_auth
;

1820 
u8
 
Ën
 = 0;

1821 
u16
 
v®
 = 0;

1822 cÚ¡ 
Æ©Œ
 *
šÃr
;

1824 
	`Æa_fÜ_—ch_Ã¡ed
(
šÃr
, 
ou‹r
, 
tmp
) {

1825 
ty³
 = 
	`Æa_ty³
(
šÃr
);

1826 
ty³
) {

1827 
SLSI_ATTRIBUTE_EPNO_FLAGS
:

1828 ià(
	`¦si_ut_Æa_g‘_u16
(
šÃr
, &
v®
))

1829  -
EINVAL
;

1830 
•no_ssid_·¿ms
->
æags
 |ğ
v®
;

1832 
SLSI_ATTRIBUTE_EPNO_AUTH
:

1833 ià(
	`¦si_ut_Æa_g‘_u8
(
šÃr
, &
•no_auth
))

1834  -
EINVAL
;

1835 ià(
•no_auth
 & 
SLSI_EPNO_AUTH_FIELD_WEP_OPEN
)

1836 
•no_ssid_·¿ms
->
æags
 |ğ
FAPI_EPNOPOLICY_AUTH_OPEN
;

1837 ià(
•no_auth
 & 
SLSI_EPNO_AUTH_FIELD_WPA_PSK
)

1838 
•no_ssid_·¿ms
->
æags
 |ğ
FAPI_EPNOPOLICY_AUTH_PSK
;

1839 ià(
•no_auth
 & 
SLSI_EPNO_AUTH_FIELD_WPA_EAP
)

1840 
•no_ssid_·¿ms
->
æags
 |ğ
FAPI_EPNOPOLICY_AUTH_EAPOL
;

1842 
SLSI_ATTRIBUTE_EPNO_SSID_LEN
:

1843 ià(
	`¦si_ut_Æa_g‘_u8
(
šÃr
, &
Ën
))

1844  -
EINVAL
;

1845 ià(
Ën
 <= 32) {

1846 
•no_ssid_·¿ms
->
ssid_Ën
 = 
Ën
;

1848 
	`SLSI_ERR
(
sdev
, "SSIDoØlÚg %d\n", 
Ën
);

1849  -
EINVAL
;

1852 
SLSI_ATTRIBUTE_EPNO_SSID
:

1853 ià(
	`¦si_ut_Æa_g‘_d©a
(
šÃr
, 
Ën
, 
•no_ssid_·¿ms
->
ssid
))

1854  -
EINVAL
;

1857 
	`SLSI_WARN
(
sdev
, "IgnÜšg unknowÀty³:%d\n", 
ty³
);

1861 
	}
}

1863 
	$¦si_£t_•no_ssid
(
why
 *wiphy,

1864 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1866 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1867 
Ãt_deviû
 *
Ãt_dev
;

1868 
Ãtdev_vif
 *
ndev_vif
;

1869 
r
 = 0;

1870 
tmp
, 
tmp1
, 
ty³
, 
num
 = 0;

1871 cÚ¡ 
Æ©Œ
 *
ou‹r
, *
™”
;

1872 
u8
 
i
 = 0, 
v®
 = 0;

1873 
¦si_•no_ssid_·¿m
 *
•no_ssid_·¿ms
;

1874 
¦si_•no_·¿m
 *
•no_·¿ms
;

1876 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "SUBCMD_SET_EPNO_LIST Received\n");

1878 ià(!
	`¦si_dev_•no_suµÜ‹d
())

1879  -
EOPNOTSUPP
;

1881 
•no_·¿ms
 = 
	`km®loc
(((*•no_·¿msè+ ((*
•no_ssid_·¿ms
è* 
SLSI_GSCAN_MAX_EPNO_SSIDS
)),

1882 
GFP_KERNEL
);

1883 ià(!
•no_·¿ms
) {

1884 
	`SLSI_ERR
(
sdev
, "Mem‡lloc fail\n");

1885  -
ENOMEM
;

1887 
Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

1888 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãt_dev
);

1889 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp1
) {

1890 
ty³
 = 
	`Æa_ty³
(
™”
);

1891 
ty³
) {

1892 
SLSI_ATTRIBUTE_EPNO_MINIMUM_5G_RSSI
:

1893 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
•no_·¿ms
->
mš_5g_rssi
)) {

1894 
r
 = -
EINVAL
;

1895 
ex™
;

1898 
SLSI_ATTRIBUTE_EPNO_MINIMUM_2G_RSSI
:

1899 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
•no_·¿ms
->
mš_2g_rssi
)) {

1900 
r
 = -
EINVAL
;

1901 
ex™
;

1904 
SLSI_ATTRIBUTE_EPNO_INITIAL_SCORE_MAX
:

1905 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
•no_·¿ms
->
š™Ÿl_scÜe_max
)) {

1906 
r
 = -
EINVAL
;

1907 
ex™
;

1910 
SLSI_ATTRIBUTE_EPNO_CUR_CONN_BONUS
:

1911 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
•no_·¿ms
->
cu¼’t_cÚÃùiÚ_bÚus
)) {

1912 
r
 = -
EINVAL
;

1913 
ex™
;

1916 
SLSI_ATTRIBUTE_EPNO_SAME_NETWORK_BONUS
:

1917 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
•no_·¿ms
->
§me_ÃtwÜk_bÚus
)) {

1918 
r
 = -
EINVAL
;

1919 
ex™
;

1922 
SLSI_ATTRIBUTE_EPNO_SECURE_BONUS
:

1923 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
•no_·¿ms
->
£cu»_bÚus
)) {

1924 
r
 = -
EINVAL
;

1925 
ex™
;

1928 
SLSI_ATTRIBUTE_EPNO_5G_BONUS
:

1929 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
•no_·¿ms
->
bªd_5g_bÚus
)) {

1930 
r
 = -
EINVAL
;

1931 
ex™
;

1934 
SLSI_ATTRIBUTE_EPNO_SSID_LIST
:

1935 
	`Æa_fÜ_—ch_Ã¡ed
(
ou‹r
, 
™”
, 
tmp
) {

1936 
•no_ssid_·¿ms
 = &
•no_·¿ms
->
•no_ssid
[
i
];

1937 
•no_ssid_·¿ms
->
æags
 = 0;

1938 
r
 = 
	`¦si_•no_ssid_li¡_g‘
(
sdev
, 
•no_ssid_·¿ms
, 
ou‹r
);

1939 ià(
r
)

1940 
ex™
;

1941 
i
++;

1944 
SLSI_ATTRIBUTE_EPNO_SSID_NUM
:

1945 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
v®
)) {

1946 
r
 = -
EINVAL
;

1947 
ex™
;

1949 
num
 = ()
v®
;

1950 ià(
num
 > 
SLSI_GSCAN_MAX_EPNO_SSIDS
) {

1951 
	`SLSI_ERR
(
sdev
, "CªnÙ suµÜˆ%d SSIDs. max %d\n", 
num
, 
SLSI_GSCAN_MAX_EPNO_SSIDS
);

1952 
r
 = -
EINVAL
;

1953 
ex™
;

1955 
•no_·¿ms
->
num_ÃtwÜks
 = 
num
;

1958 
	`SLSI_ERR
(
sdev
, "Inv®id‡‰ribu‹ %d\n", 
ty³
);

1959 
r
 = -
EINVAL
;

1960 
ex™
;

1964 ià(
i
 !ğ
num
) {

1965 
	`SLSI_ERR
(
sdev
, "num_ssid %d dÛ nÙ m©ch ssid £Á %d\n", 
num
, 
i
);

1966 
r
 = -
EINVAL
;

1967 
ex™
;

1969 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1970 
r
 = 
	`¦si_mlme_£t_²o_li¡
(
sdev
, 
num
, 
•no_·¿ms
, 
NULL
);

1971 ià(
r
 == 0)

1972 
sdev
->
•no_aùive
 = (
num
 != 0);

1974 
sdev
->
•no_aùive
 = 
çl£
;

1975 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1976 
ex™
:

1977 
	`kä“
(
•no_·¿ms
);

1978  
r
;

1979 
	}
}

1981 
	$¦si_£t_hs_·¿ms
(
why
 *wiphy,

1982 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1984 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1985 
Ãt_deviû
 *
Ãt_dev
;

1986 
Ãtdev_vif
 *
ndev_vif
;

1987 
r
 = 0;

1988 
tmp
, 
tmp1
, 
tmp2
, 
ty³
, 
num
 = 0;

1989 cÚ¡ 
Æ©Œ
 *
ou‹r
, *
šÃr
, *
™”
;

1990 
u8
 
i
 = 0, 
v®
 = 0;

1991 
¦si_•no_hs2_·¿m
 *
•no_hs2_·¿ms_¬¿y
;

1992 
¦si_•no_hs2_·¿m
 *
•no_hs2_·¿ms
;

1994 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "SUBCMD_SET_HS_LIST Received\n");

1996 ià(!
	`¦si_dev_•no_suµÜ‹d
())

1997  -
EOPNOTSUPP
;

1999 
•no_hs2_·¿ms_¬¿y
 = 
	`km®loc
((*•no_hs2_·¿ms_¬¿yè* 
SLSI_GSCAN_MAX_EPNO_HS2_PARAM
, 
GFP_KERNEL
);

2000 ià(!
•no_hs2_·¿ms_¬¿y
) {

2001 
	`SLSI_ERR
(
sdev
, "Mem‡lloc fail\n");

2002  -
ENOMEM
;

2005 
Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

2006 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãt_dev
);

2008 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp2
) {

2009 
ty³
 = 
	`Æa_ty³
(
™”
);

2010 
ty³
) {

2011 
SLSI_ATTRIBUTE_EPNO_HS_PARAM_LIST
:

2012 
	`Æa_fÜ_—ch_Ã¡ed
(
ou‹r
, 
™”
, 
tmp
) {

2013 ià(
i
 >ğ
SLSI_GSCAN_MAX_EPNO_HS2_PARAM
)

2015 
•no_hs2_·¿ms
 = &
•no_hs2_·¿ms_¬¿y
[
i
];

2016 
i
++;

2017 
	`Æa_fÜ_—ch_Ã¡ed
(
šÃr
, 
ou‹r
, 
tmp1
) {

2018 
ty³
 = 
	`Æa_ty³
(
šÃr
);

2020 
ty³
) {

2021 
SLSI_ATTRIBUTE_EPNO_HS_ID
:

2022 ià(
	`¦si_ut_Æa_g‘_u32
(
šÃr
, &
•no_hs2_·¿ms
->
id
)) {

2023 
r
 = -
EINVAL
;

2024 
ex™
;

2027 
SLSI_ATTRIBUTE_EPNO_HS_REALM
:

2028 ià(
	`¦si_ut_Æa_g‘_d©a
(
šÃr
, 256, 
•no_hs2_·¿ms
->
»®m
)) {

2029 
r
 = -
EINVAL
;

2030 
ex™
;

2033 
SLSI_ATTRIBUTE_EPNO_HS_CONSORTIUM_IDS
:

2034 ià(
	`¦si_ut_Æa_g‘_d©a
(
šÃr
, (16 * 8), 
•no_hs2_·¿ms
->
rßmšg_cÚsÜtium_ids
)) {

2035 
r
 = -
EINVAL
;

2036 
ex™
;

2039 
SLSI_ATTRIBUTE_EPNO_HS_PLMN
:

2040 ià(
	`¦si_ut_Æa_g‘_d©a
(
šÃr
, 3, 
•no_hs2_·¿ms
->
¶mn
)) {

2041 
r
 = -
EINVAL
;

2042 
ex™
;

2046 
	`SLSI_WARN
(
sdev
, "IgnÜšg unknowÀty³:%d\n", 
ty³
);

2051 
SLSI_ATTRIBUTE_EPNO_HS_NUM
:

2052 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
v®
)) {

2053 
r
 = -
EINVAL
;

2054 
ex™
;

2056 
num
 = ()
v®
;

2057 ià(
num
 > 
SLSI_GSCAN_MAX_EPNO_HS2_PARAM
) {

2058 
	`SLSI_ERR
(
sdev
, "CªnÙ suµÜˆ%d SSIDs. max %d\n", 
num
, 
SLSI_GSCAN_MAX_EPNO_SSIDS
);

2059 
r
 = -
EINVAL
;

2060 
ex™
;

2064 
	`SLSI_ERR
(
sdev
, "Inv®id‡‰ribu‹ %d\n", 
ty³
);

2065 
r
 = -
EINVAL
;

2066 
ex™
;

2069 ià(
i
 !ğ
num
) {

2070 
	`SLSI_ERR
(
sdev
, "num_ssid %d dÛ nÙ m©ch ssid £Á %d\n", 
num
, 
i
);

2071 
r
 = -
EINVAL
;

2072 
ex™
;

2075 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2076 
r
 = 
	`¦si_mlme_£t_²o_li¡
(
sdev
, 
num
, 
NULL
, 
•no_hs2_·¿ms_¬¿y
);

2077 ià(
r
 == 0)

2078 
sdev
->
•no_aùive
 = 
Œue
;

2079 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2080 
ex™
:

2081 
	`kä“
(
•no_hs2_·¿ms_¬¿y
);

2082  
r
;

2083 
	}
}

2085 
	$¦si_»£t_hs_·¿ms
(
why
 *wiphy,

2086 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2088 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2089 
Ãt_deviû
 *
Ãt_dev
;

2090 
Ãtdev_vif
 *
ndev_vif
;

2091 
r
;

2093 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "SUBCMD_RESET_HS_LIST Received\n");

2095 ià(!
	`¦si_dev_•no_suµÜ‹d
())

2096  -
EOPNOTSUPP
;

2098 
Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

2099 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãt_dev
);

2101 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2102 
r
 = 
	`¦si_mlme_£t_²o_li¡
(
sdev
, 0, 
NULL
, NULL);

2103 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2104 
sdev
->
•no_aùive
 = 
çl£
;

2105  
r
;

2106 
	}
}

2108 
	$¦si_£t_rssi_mÚ™Ü
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2110 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2111 
Ãt_deviû
 *
Ãt_dev
;

2112 
Ãtdev_vif
 *
ndev_vif
;

2113 
r
 = 0;

2114 
‹mp
;

2115 
ty³
;

2116 cÚ¡ 
Æ©Œ
 *
©Œ
;

2117 
s8
 
mš_rssi
 = 0, 
max_rssi
 = 0;

2118 
u16
 
’abË
 = 0;

2119 
u8
 
v®
 = 0;

2121 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "Recd RSSI monitor command\n");

2123 
Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

2124 ià(
Ãt_dev
 =ğ
NULL
) {

2125 
	`SLSI_ERR
(
sdev
, "netdev is NULL!!\n");

2126  -
ENODEV
;

2129 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãt_dev
);

2130 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2132 ià(!
ndev_vif
->
aùiv©ed
) {

2133 
	`SLSI_ERR
(
sdev
, "Vif‚ot‡ctivated\n");

2134 
r
 = -
EINVAL
;

2135 
ex™
;

2137 ià(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) {

2138 
	`SLSI_ERR
(
sdev
, "Not‡ STA vif\n");

2139 
r
 = -
EINVAL
;

2140 
ex™
;

2142 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
) {

2143 
	`SLSI_ERR
(
sdev
, "STA vif‚ot connected\n");

2144 
r
 = -
EINVAL
;

2145 
ex™
;

2148 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

2149 
ty³
 = 
	`Æa_ty³
(
©Œ
);

2150 
ty³
) {

2151 
SLSI_RSSI_MONITOR_ATTRIBUTE_START
:

2152 ià(
	`¦si_ut_Æa_g‘_u8
(
©Œ
, &
v®
)) {

2153 
r
 = -
EINVAL
;

2154 
ex™
;

2156 
’abË
 = (
u16
)
v®
;

2158 
SLSI_RSSI_MONITOR_ATTRIBUTE_MIN_RSSI
:

2159 ià(
	`¦si_ut_Æa_g‘_s8
(
©Œ
, &
mš_rssi
)) {

2160 
r
 = -
EINVAL
;

2161 
ex™
;

2164 
SLSI_RSSI_MONITOR_ATTRIBUTE_MAX_RSSI
:

2165 ià(
	`¦si_ut_Æa_g‘_s8
(
©Œ
, &
max_rssi
)) {

2166 
r
 = -
EINVAL
;

2167 
ex™
;

2171 
r
 = -
EINVAL
;

2172 
ex™
;

2175 ià(
mš_rssi
 > 
max_rssi
) {

2176 
	`SLSI_ERR
(
sdev
, "Inv®id…¬ams, mš_rssiğ%d ,max_rss˜ğ%d\n", 
mš_rssi
, 
max_rssi
);

2177 
r
 = -
EINVAL
;

2178 
ex™
;

2180 
r
 = 
	`¦si_mlme_£t_rssi_mÚ™Ü
(
sdev
, 
Ãt_dev
, 
’abË
, 
mš_rssi
, 
max_rssi
);

2181 
ex™
:

2182 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2183  
r
;

2184 
	}
}

2186 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


2187 
	$¦si_Îs_debug_dump_¡©s
(
¦si_dev
 *
sdev
, 
¦si_Îs_¿dio_¡©
 *
¿dio_¡©
,

2188 
¦si_Îs_içû_¡©
 *
içû_¡©
, 
u8
 *
buf
, 
buf_Ën
, 
num_of_¿dios
)

2190 
i
, 
j
;

2192 
j
 = 0; j < 
num_of_¿dios
; j++) {

2193 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "radio_stat====\n");

2194 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\tradio_id : %d, on_time : %d,x_time : %d,„x_time : %d,"

2195 "Ú_time_sÿÀ: %d,‚um_chªÃl : %d\n", 
¿dio_¡©
->
¿dio
,„adio_¡©->
Ú_time
,

2196 
¿dio_¡©
->
tx_time
,„adio_¡©->
rx_time
,„adio_¡©->
Ú_time_sÿn
,

2197 
¿dio_¡©
->
num_chªÃls
);

2199 
¿dio_¡©
 = (
¦si_Îs_¿dio_¡©
 *)((
u8
 *)radio_stat + (slsi_lls_radio_stat) +

2200 ((
¦si_Îs_chªÃl_¡©
è* 
¿dio_¡©
->
num_chªÃls
));

2202 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "iface_stat====\n");

2203 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\tiface %p info : (mode : %d, mac_addr : %pM, state : %d,„oaming : %d,"

2205 
içû_¡©
->
içû
, içû_¡©->
šfo
.
mode
, içû_¡©->šfo.
mac_addr
, içû_¡©->šfo.
¡©e
,

2206 
içû_¡©
->
šfo
.
rßmšg
, içû_¡©->šfo.
ÿ·b™›s
, içû_¡©->šfo.
ssid
,

2207 
içû_¡©
->
šfo
.
bssid
, içû_¡©->šfo.
­_couÁry_¡r
[0], iface_stat->info.ap_country_str[1],

2208 
içû_¡©
->
šfo
.
­_couÁry_¡r
[2], içû_¡©->
rssi_d©a
, içû_¡©->
rssi_mgmt
);

2210 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\Šum_³” %d\n", 
içû_¡©
->
num_³”s
);

2211 
i
 = 0; i < 
içû_¡©
->
num_³”s
; i++) {

2212 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\t\“r_mac_add»s %pM\n", 
içû_¡©
->
³”_šfo
[
i
].
³”_mac_add»ss
);

2215 
	`SLSI_DBG_HEX
(
sdev
, 
SLSI_GSCAN
, 
buf
, 
buf_Ën
, "return buffer\n");

2216 
	}
}

2219 
	$¦si_Îs_£t_¡©s
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2221 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2222 
Ãt_deviû
 *
Ãt_dev
 = 
NULL
;

2223 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

2224 
‹mp
;

2225 
ty³
;

2226 cÚ¡ 
Æ©Œ
 *
©Œ
;

2227 
u32
 
mpdu_size_th»shŞd
 = 0;

2228 
u32
 
aggr_¡©_g©h”šg
 = 0;

2229 
r
 = 0, 
i
;

2231 ià(!
	`¦si_dev_Îs_suµÜ‹d
())

2232  -
EOPNOTSUPP
;

2234 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

2235 
	`SLSI_WARN
(
sdev
, "not supported in WlanLite mode\n");

2236  -
EOPNOTSUPP
;

2239 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

2240 
ty³
 = 
	`Æa_ty³
(
©Œ
);

2242 
ty³
) {

2243 
LLS_ATTRIBUTE_SET_MPDU_SIZE_THRESHOLD
:

2244 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
mpdu_size_th»shŞd
))

2245  -
EINVAL
;

2248 
LLS_ATTRIBUTE_SET_AGGR_STATISTICS_GATHERING
:

2249 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
aggr_¡©_g©h”šg
))

2250  -
EINVAL
;

2254 
	`SLSI_ERR_NODEV
("UnknowÀ©Œibu‹: %d\n", 
ty³
);

2255 
r
 = -
EINVAL
;

2259 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2261 ()
	`¦si_mlme_¡¬t_lšk_¡©s_»q
(
sdev
, 
mpdu_size_th»shŞd
, 
aggr_¡©_g©h”šg
);

2263 
Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

2264 ià(
Ãt_dev
) {

2265 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãt_dev
);

2266 
i
 = 0; i < 
SLSI_LLS_AC_MAX
; i++) {

2267 
ndev_vif
->
rx_·ck‘s
[
i
] = 0;

2268 
ndev_vif
->
tx_·ck‘s
[
i
] = 0;

2269 
ndev_vif
->
tx_no_ack
[
i
] = 0;

2272 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2274 
	}
}

2276 
	$¦si_Îs_ş—r_¡©s
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2278 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2279 
‹mp
;

2280 
ty³
;

2281 cÚ¡ 
Æ©Œ
 *
©Œ
;

2282 
u32
 
¡©s_ş—r_»q_mask
 = 0;

2283 
u32
 
¡İ_»q
 = 0;

2284 
r
 = 0, 
i
;

2285 
Ãt_deviû
 *
Ãt_dev
 = 
NULL
;

2286 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

2288 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

2290 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

2291 
ty³
 = 
	`Æa_ty³
(
©Œ
);

2293 
ty³
) {

2294 
LLS_ATTRIBUTE_CLEAR_STOP_REQUEST_MASK
:

2295 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
¡©s_ş—r_»q_mask
))

2296  -
EINVAL
;

2297 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "¡©s_ş—r_»q_mask:%u\n", 
¡©s_ş—r_»q_mask
);

2300 
LLS_ATTRIBUTE_CLEAR_STOP_REQUEST
:

2301 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
¡İ_»q
))

2302  -
EINVAL
;

2303 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "¡İ_»q:%u\n", 
¡İ_»q
);

2307 
	`SLSI_ERR
(
sdev
, "UnknowÀ©Œibu‹:%d\n", 
ty³
);

2308 
r
 = -
EINVAL
;

2315 ià(!
¡İ_»q
)

2316 
¡©s_ş—r_»q_mask
 = ~stats_clear_req_mask;

2318 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2319 ()
	`¦si_mlme_¡İ_lšk_¡©s_»q
(
sdev
, 
¡©s_ş—r_»q_mask
);

2320 
Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

2321 ià(
Ãt_dev
) {

2322 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãt_dev
);

2323 
i
 = 0; i < 
SLSI_LLS_AC_MAX
; i++) {

2324 
ndev_vif
->
rx_·ck‘s
[
i
] = 0;

2325 
ndev_vif
->
tx_·ck‘s
[
i
] = 0;

2326 
ndev_vif
->
tx_no_ack
[
i
] = 0;

2329 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2331 
	}
}

2333 
u32
 
	$¦si_Îs_›_to_ÿp
(cÚ¡ 
u8
 *
›s
, 
›s_Ën
)

2335 
u32
 
ÿ·b™›s
 = 0;

2336 cÚ¡ 
u8
 *
›_d©a
;

2337 cÚ¡ 
u8
 *
›
;

2338 
›_Ën
;

2340 ià(!
›s
 || 
›s_Ën
 == 0) {

2341 
	`SLSI_ERR_NODEV
("nØ›[&%°%d]\n", 
›s
, 
›s_Ën
);

2344 
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_EXT_CAPABILITY
, 
›s
, 
›s_Ën
);

2345 ià(
›
) {

2346 
›_Ën
 = 
›
[1];

2347 
›_d©a
 = &
›
[2];

2348 ià((
›_Ën
 >ğ4è&& (
›_d©a
[3] & 
SLSI_WLAN_EXT_CAPA3_INTERWORKING_ENABLED
))

2349 
ÿ·b™›s
 |ğ
SLSI_LLS_CAPABILITY_INTERWORKING
;

2350 ià((
›_Ën
 >ğ7è&& (
›_d©a
[6] & 0x01))

2351 
ÿ·b™›s
 |ğ
SLSI_LLS_CAPABILITY_SSID_UTF8
;

2354 
›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_WFA
, 
SLSI_WLAN_OUI_TYPE_WFA_HS20_IND
, 
›s
, 
›s_Ën
);

2355 ià(
›
)

2356 
ÿ·b™›s
 |ğ
SLSI_LLS_CAPABILITY_HS20
;

2357  
ÿ·b™›s
;

2358 
	}
}

2360 
	$¦si_Îs_içû_¡a_¡©s
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

2361 
¦si_Îs_içû_¡©
 *
içû_¡©
)

2363 
i
;

2364 
¦si_Îs_š‹rçû_lšk_Ïy”_šfo
 *
Îs_šfo
 = &
içû_¡©
->
šfo
;

2365 
¦si_Îs_³”_ty³
 
³”_ty³
;

2366 
¦si_³”
 *
³”
;

2367 cÚ¡ 
u8
 *
›_d©a
, *
›
;

2368 
›_Ën
;

2370 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

2372 ià(
ndev_vif
->
iâum
 =ğ
SLSI_NET_INDEX_WLAN
) {

2373 
Îs_šfo
->
mode
 = 
SLSI_LLS_INTERFACE_STA
;

2374 
³”_ty³
 = 
SLSI_LLS_PEER_AP
;

2376 
Îs_šfo
->
mode
 = 
SLSI_LLS_INTERFACE_P2P_CLIENT
;

2377 
³”_ty³
 = 
SLSI_LLS_PEER_P2P_GO
;

2380 
ndev_vif
->
¡a
.
vif_¡©us
) {

2381 
SLSI_VIF_STATUS_CONNECTING
:

2382 
Îs_šfo
->
¡©e
 = 
SLSI_LLS_AUTHENTICATING
;

2384 
SLSI_VIF_STATUS_CONNECTED
:

2385 
Îs_šfo
->
¡©e
 = 
SLSI_LLS_ASSOCIATED
;

2388 
Îs_šfo
->
¡©e
 = 
SLSI_LLS_DISCONNECTED
;

2390 
Îs_šfo
->
rßmšg
 = 
ndev_vif
->
¡a
.
rßm_š_´og»ss
 ?

2391 
SLSI_LLS_ROAMING_ACTIVE
 : 
SLSI_LLS_ROAMING_IDLE
;

2393 
içû_¡©
->
šfo
.
ÿ·b™›s
 = 0;

2394 
Îs_šfo
->
ssid
[0] = 0;

2395 ià(
ndev_vif
->
¡a
.
¡a_bss
) {

2396 
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,

2397 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
Ën
);

2398 ià(
›
) {

2399 
›_Ën
 = 
›
[1];

2400 
›_d©a
 = &
›
[2];

2401 
	`memıy
(
Îs_šfo
->
ssid
, 
›_d©a
, 
›_Ën
);

2402 
Îs_šfo
->
ssid
[
›_Ën
] = 0;

2404 
	`SLSI_ETHER_COPY
(
Îs_šfo
->
bssid
, 
ndev_vif
->
¡a
.
¡a_bss
->bssid);

2405 
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_COUNTRY
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,

2406 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
Ën
);

2407 ià(
›
) {

2408 
›_d©a
 = &
›
[2];

2409 
	`memıy
(
Îs_šfo
->
­_couÁry_¡r
, 
›_d©a
, 3);

2410 
içû_¡©
->
³”_šfo
[0].
ÿ·b™›s
 |ğ
SLSI_LLS_CAPABILITY_COUNTRY
;

2414 
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
];

2415 ià(
³”
 &&…“r->
v®id
 &&…“r->
assoc_›
 &&…“r->
assoc_»¥_›
) {

2416 
içû_¡©
->
šfo
.
ÿ·b™›s
 |ğ
	`¦si_Îs_›_to_ÿp
(
³”
->
assoc_›
->
d©a
,…“r->assoc_›->
Ën
);

2417 ià(
³”
->
ÿ·b™›s
 & 
WLAN_CAPABILITY_PRIVACY
) {

2418 
içû_¡©
->
³”_šfo
[0].
ÿ·b™›s
 |ğ
SLSI_LLS_CAPABILITY_PROTECTED
;

2419 
içû_¡©
->
šfo
.
ÿ·b™›s
 |ğ
SLSI_LLS_CAPABILITY_PROTECTED
;

2421 ià(
³”
->
qos_’abËd
) {

2422 
içû_¡©
->
³”_šfo
[0].
ÿ·b™›s
 |ğ
SLSI_LLS_CAPABILITY_QOS
;

2423 
içû_¡©
->
šfo
.
ÿ·b™›s
 |ğ
SLSI_LLS_CAPABILITY_QOS
;

2425 
içû_¡©
->
³”_šfo
[0].
ÿ·b™›s
 |ğ
	`¦si_Îs_›_to_ÿp
(
³”
->
assoc_»¥_›
->
d©a
,…“r->assoc_»¥_›->
Ën
);

2427 
	`SLSI_ETHER_COPY
(
içû_¡©
->
³”_šfo
[0].
³”_mac_add»ss
, 
³”
->
add»ss
);

2428 
içû_¡©
->
³”_šfo
[0].
ty³
 = 
³”_ty³
;

2429 
içû_¡©
->
num_³”s
 = 1;

2432 
i
 = 
	`MAP_AID_TO_QS
(
SLSI_TDLS_PEER_INDEX_MIN
); i <ğMAP_AID_TO_QS(
SLSI_TDLS_PEER_INDEX_MAX
); i++) {

2433 
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
i
];

2434 ià(
³”
 &&…“r->
v®id
) {

2435 
	`SLSI_ETHER_COPY
(
içû_¡©
->
³”_šfo
[içû_¡©->
num_³”s
].
³”_mac_add»ss
, 
³”
->
add»ss
);

2436 
içû_¡©
->
³”_šfo
[içû_¡©->
num_³”s
].
ty³
 = 
SLSI_LLS_PEER_TDLS
;

2437 ià(
³”
->
qos_’abËd
)

2438 
içû_¡©
->
³”_šfo
[içû_¡©->
num_³”s
].
ÿ·b™›s
 |ğ
SLSI_LLS_CAPABILITY_QOS
;

2439 
içû_¡©
->
³”_šfo
[içû_¡©->
num_³”s
].
num_¿‹
 = 0;

2440 
içû_¡©
->
num_³”s
++;

2443 
	}
}

2445 
	$¦si_Îs_içû_­_¡©s
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
, 
¦si_Îs_içû_¡©
 *
içû_¡©
)

2447 
¦si_Îs_³”_ty³
 
³”_ty³
 = 
SLSI_LLS_PEER_INVALID
;

2448 
¦si_³”
 *
³”
;

2449 
i
;

2450 
Ãt_deviû
 *
dev
;

2452 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

2455 
	`memıy
(
içû_¡©
->
šfo
.
­_couÁry_¡r
, içû_¡©->šfo.
couÁry_¡r
, 3);

2457 ià(
ndev_vif
->
iâum
 =ğ
SLSI_NET_INDEX_WLAN
) {

2458 
içû_¡©
->
šfo
.
mode
 = 
SLSI_LLS_INTERFACE_SOFTAP
;

2459 
³”_ty³
 = 
SLSI_LLS_PEER_STA
;

2460 } ià(
ndev_vif
->
iâum
 =ğ
SLSI_NET_INDEX_P2PX_SWLAN
) {

2461 
dev
 = 
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2PX_SWLAN
];

2462 ià(
	`SLSI_IS_VIF_INDEX_P2P_GROUP
(
sdev
, 
ndev_vif
)) {

2463 
içû_¡©
->
šfo
.
mode
 = 
SLSI_LLS_INTERFACE_P2P_GO
;

2464 
³”_ty³
 = 
SLSI_LLS_PEER_P2P_CLIENT
;

2468 
i
 = 
	`MAP_AID_TO_QS
(
SLSI_PEER_INDEX_MIN
); i <ğMAP_AID_TO_QS(
SLSI_PEER_INDEX_MAX
); i++) {

2469 
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
i
];

2470 ià(
³”
 &&…“r->
v®id
) {

2471 
	`SLSI_ETHER_COPY
(
içû_¡©
->
³”_šfo
[içû_¡©->
num_³”s
].
³”_mac_add»ss
, 
³”
->
add»ss
);

2472 
içû_¡©
->
³”_šfo
[içû_¡©->
num_³”s
].
ty³
 = 
³”_ty³
;

2473 
içû_¡©
->
³”_šfo
[içû_¡©->
num_³”s
].
num_¿‹
 = 0;

2474 ià(
³”
->
qos_’abËd
)

2475 
içû_¡©
->
³”_šfo
[içû_¡©->
num_³”s
].
ÿ·b™›s
 = 
SLSI_LLS_CAPABILITY_QOS
;

2476 
içû_¡©
->
num_³”s
++;

2480 
	`memıy
(
içû_¡©
->
šfo
.
ssid
, 
ndev_vif
->
­
.ssid,‚dev_vif->­.
ssid_Ën
);

2481 
içû_¡©
->
šfo
.
ssid
[
ndev_vif
->
­
.
ssid_Ën
] = 0;

2482 ià(
ndev_vif
->
­
.
´ivacy
)

2483 
içû_¡©
->
šfo
.
ÿ·b™›s
 |ğ
SLSI_LLS_CAPABILITY_PROTECTED
;

2484 ià(
ndev_vif
->
­
.
qos_’abËd
)

2485 
içû_¡©
->
šfo
.
ÿ·b™›s
 |ğ
SLSI_LLS_CAPABILITY_QOS
;

2486 
	}
}

2488 
	$¦si_Îs_içû_¡©_fl
(
¦si_dev
 *
sdev
,

2489 
Ãt_deviû
 *
Ãt_dev
,

2490 
¦si_Îs_içû_¡©
 *
içû_¡©
)

2492 
i
;

2493 
Ãtdev_vif
 *
ndev_vif
;

2494 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

2495 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

2496 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = {{ 
SLSI_PSID_UNIFI_AC_RETRIES
, { 
SLSI_TRAFFIC_Q_BE
 + 1, 0 } },

2497 { 
SLSI_PSID_UNIFI_AC_RETRIES
, { 
SLSI_TRAFFIC_Q_BK
 + 1, 0 } },

2498 { 
SLSI_PSID_UNIFI_AC_RETRIES
, { 
SLSI_TRAFFIC_Q_VI
 + 1, 0 } },

2499 { 
SLSI_PSID_UNIFI_AC_RETRIES
, { 
SLSI_TRAFFIC_Q_VO
 + 1, 0 } },

2500 { 
SLSI_PSID_UNIFI_BEACON_RECEIVED
, {0, 0} },

2501 { 
SLSI_PSID_UNIFI_PS_LEAKY_AP
, {0, 0} },

2502 { 
SLSI_PSID_UNIFI_RSSI
, {0, 0} },

2503 { 
SLSI_PSID_UNIFI_AC_NO_ACKS
, { 
SLSI_TRAFFIC_Q_BE
 + 1, 0 } },

2504 { 
SLSI_PSID_UNIFI_AC_NO_ACKS
, { 
SLSI_TRAFFIC_Q_BK
 + 1, 0 } },

2505 { 
SLSI_PSID_UNIFI_AC_NO_ACKS
, { 
SLSI_TRAFFIC_Q_VI
 + 1, 0 } },

2506 { 
SLSI_PSID_UNIFI_AC_NO_ACKS
, { 
SLSI_TRAFFIC_Q_VO
 + 1, 0 } } };

2508 
içû_¡©
->
içû
 = 
NULL
;

2509 
içû_¡©
->
šfo
.
mode
 = 
SLSI_LLS_INTERFACE_UNKNOWN
;

2510 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2511 
içû_¡©
->
šfo
.
couÁry_¡r
[0] = 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->
®pha2
[0];

2512 
içû_¡©
->
šfo
.
couÁry_¡r
[1] = 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
->
®pha2
[1];

2513 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2514 
içû_¡©
->
šfo
.
couÁry_¡r
[2] = ' ';

2516 
i
 = 0; i < 
SLSI_LLS_AC_MAX
; i++)

2517 
içû_¡©
->
ac
[
i
].aøğ
SLSI_LLS_AC_MAX
;

2519 ià(!
Ãt_dev
)

2522 
ndev_vif
 = 
	`Ãtdev_´iv
(
Ãt_dev
);

2523 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2525 ià(!
ndev_vif
->
aùiv©ed
)

2526 
ex™
;

2528 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

2529 
	`¦si_Îs_içû_¡a_¡©s
(
sdev
, 
ndev_vif
, 
içû_¡©
);

2530 } ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
) {

2531 
	`¦si_Îs_içû_­_¡©s
(
sdev
, 
ndev_vif
, 
içû_¡©
);

2532 
	`SLSI_ETHER_COPY
(
içû_¡©
->
šfo
.
bssid
, 
Ãt_dev
->
dev_addr
);

2534 
	`SLSI_ETHER_COPY
(
içû_¡©
->
šfo
.
mac_addr
, 
Ãt_dev
->
dev_addr
);

2536 ià((
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
è&& (ndev_vif->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
)) {

2537 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2541 
mibr¥
.
d©aL’gth
 = 10 * (
g‘_v®ues
) / (get_values[0]);

2542 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

2543 ià(!
mibr¥
.
d©a
) {

2544 
	`SLSI_ERR
(
sdev
, "CªnÙ km®loø%d by‹ fÜ iÁ”çû MIBs\n", 
mibr¥
.
d©aL’gth
);

2545 
ex™
;

2548 
v®ues
 = 
	`¦si_»ad_mibs
(
sdev
, 
Ãt_dev
, 
g‘_v®ues
, (g‘_v®uesè/ (g‘_v®ues[0]), &
mibr¥
);

2549 ià(!
v®ues
)

2550 
ex™
;

2552 
i
 = 0; i < 
SLSI_LLS_AC_MAX
; i++) {

2553 ià(
v®ues
[
i
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
) {

2554 
içû_¡©
->
ac
[
i
].aøğ
	`¦si_çpi_to_ªdroid_Œaffic_q
(i);

2555 
içû_¡©
->
ac
[
i
].
»Œ›s
 = 
v®ues
[i].
u
.
uštV®ue
;

2556 
içû_¡©
->
ac
[
i
].
rx_mpdu
 = 
ndev_vif
->
rx_·ck‘s
[i];

2557 
içû_¡©
->
ac
[
i
].
tx_mpdu
 = 
ndev_vif
->
tx_·ck‘s
[i];

2558 
ndev_vif
->
tx_no_ack
[
i
] = 
v®ues
[i+7].
u
.
uštV®ue
;

2559 
içû_¡©
->
ac
[
i
].
mpdu_lo¡
 = 
ndev_vif
->
tx_no_ack
[i];

2563 ià(
v®ues
[4].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
)

2564 
içû_¡©
->
b—cÚ_rx
 = 
v®ues
[4].
u
.
uštV®ue
;

2566 ià(
v®ues
[5].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
) {

2567 
içû_¡©
->
Ëaky_­_d‘eùed
 = 
v®ues
[5].
u
.
uštV®ue
;

2568 
içû_¡©
->
Ëaky_­_gu¬d_time
 = 5;

2571 ià(
v®ues
[6].
ty³
 =ğ
SLSI_MIB_TYPE_INT
) {

2572 
içû_¡©
->
rssi_d©a
 = 
v®ues
[6].
u
.
štV®ue
;

2573 
içû_¡©
->
rssi_mgmt
 = 
v®ues
[6].
u
.
štV®ue
;

2576 
ex™
:

2577 
	`kä“
(
v®ues
);

2578 
	`kä“
(
mibr¥
.
d©a
);

2579 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2580 
	}
}

2582 
	$¦si_Îs_¿dio_¡©_fl
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

2583 
¦si_Îs_¿dio_¡©
 *
¿dio_¡©
,

2584 
max_chª_couÁ
, 
¿dio_šdex
, 
twoÜfive
)

2586 
Ãtdev_vif
 *
ndev_vif
;

2587 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

2588 
¦si_mib_d©a
 
suµÜ‹d_chª_mib
 = { 0, 
NULL
 };

2589 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

2590 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = {{ 
SLSI_PSID_UNIFI_RADIO_SCAN_TIME
, { 
¿dio_šdex
, 0 } },

2591 { 
SLSI_PSID_UNIFI_RADIO_RX_TIME
, { 
¿dio_šdex
, 0 } },

2592 { 
SLSI_PSID_UNIFI_RADIO_TX_TIME
, { 
¿dio_šdex
, 0 } },

2593 { 
SLSI_PSID_UNIFI_RADIO_ON_TIME
, { 
¿dio_šdex
, 0 } },

2594 { 
SLSI_PSID_UNIFI_SUPPORTED_CHANNELS
, { 0, 0 } } };

2595 
u32
 *
¿dio_d©a
[] = {&
¿dio_¡©
->
Ú_time_sÿn
, &¿dio_¡©->
rx_time
,

2596 &
¿dio_¡©
->
tx_time
, &¿dio_¡©->
Ú_time
};

2597 
i
, 
j
, 
chª_couÁ
, 
chª_¡¬t
, 
k
;

2599 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2600 
¿dio_¡©
->
¿dio
 = 
¿dio_šdex
;

2603 
mibr¥
.
d©aL’gth
 = 15 * (
g‘_v®ues
) / (get_values[0]);

2604 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

2605 ià(
mibr¥
.
d©a
 =ğ
NULL
) {

2606 
	`SLSI_ERR
(
sdev
, "CªnÙ km®loø%d by‹s\n", 
mibr¥
.
d©aL’gth
);

2609 
v®ues
 = 
	`¦si_»ad_mibs
(
sdev
, 
NULL
, 
g‘_v®ues
, (g‘_v®uesè/ (g‘_v®ues[0]), &
mibr¥
);

2610 ià(!
v®ues
)

2611 
ex™_w™h_mibr¥
;

2613 
i
 = 0; i < ((
g‘_v®ues
) / (get_values[0])) - 1; i++) {

2614 ià(
v®ues
[
i
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
) {

2615 *
¿dio_d©a
[
i
] = 
v®ues
[i].
u
.
uštV®ue
;

2617 
	`SLSI_ERR
(
sdev
, "šv®idy³. i‹r:%d", 
i
);

2620 ià(
v®ues
[4].
ty³
 !ğ
SLSI_MIB_TYPE_OCTET
) {

2621 
	`SLSI_ERR
(
sdev
, "Supported_Chan invalidype.");

2622 
ex™_w™h_v®ues
;

2625 
suµÜ‹d_chª_mib
 = 
v®ues
[4].
u
.
où‘V®ue
;

2626 ià(!
suµÜ‹d_chª_mib
.
d©a
)

2627 
ex™_w™h_v®ues
;

2628 
j
 = 0; j < 
suµÜ‹d_chª_mib
.
d©aL’gth
 / 2; j++) {

2629 
¦si_Îs_chªÃl_šfo
 *
¿dio_chª
;

2631 
chª_¡¬t
 = 
suµÜ‹d_chª_mib
.
d©a
[
j
 * 2];

2632 
chª_couÁ
 = 
suµÜ‹d_chª_mib
.
d©a
[
j
 * 2 + 1];

2633 ià(
¿dio_¡©
->
num_chªÃls
 + 
chª_couÁ
 > 
max_chª_couÁ
)

2634 
chª_couÁ
 = 
max_chª_couÁ
 - 
¿dio_¡©
->
num_chªÃls
;

2635 ià(
chª_¡¬t
 =ğ1 && (
twoÜfive
 & 
	`BIT
(0))) {

2636 
k
 = 0; k < 
chª_couÁ
; k++) {

2637 
¿dio_chª
 = &
¿dio_¡©
->
chªÃls
[¿dio_¡©->
num_chªÃls
 + 
k
].
chªÃl
;

2638 ià(
k
 + 
chª_¡¬t
 == 14)

2639 
¿dio_chª
->
ûÁ”_äeq
 = 2484;

2641 
¿dio_chª
->
ûÁ”_äeq
 = 2407 + (
chª_¡¬t
 + 
k
) * 5;

2642 
¿dio_chª
->
width
 = 
SLSI_LLS_CHAN_WIDTH_20
;

2643 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2644 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

2645 
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
) {

2646 ià(
ndev_vif
->
chª
->
hw_v®ue
 =ğ(
chª_¡¬t
 + 
k
))

2647 
¿dio_¡©
->
chªÃls
[¿dio_¡©->
num_chªÃls
 + 
k
].
Ú_time
 =

2648 
¿dio_¡©
->
Ú_time
;

2650 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2652 
¿dio_¡©
->
num_chªÃls
 +ğ
chª_couÁ
;

2653 } ià(
chª_¡¬t
 !ğ1 && (
twoÜfive
 & 
	`BIT
(1))) {

2655 
k
 = 0; k < 
chª_couÁ
; k++) {

2656 
¿dio_chª
 = &
¿dio_¡©
->
chªÃls
[¿dio_¡©->
num_chªÃls
 + 
k
].
chªÃl
;

2657 
¿dio_chª
->
ûÁ”_äeq
 = 5000 + (
chª_¡¬t
 + (
k
 * 4)) * 5;

2658 
¿dio_chª
->
width
 = 
SLSI_LLS_CHAN_WIDTH_20
;

2659 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2660 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

2661 
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
) {

2662 ià(
ndev_vif
->
chª
->
hw_v®ue
 =ğ(
chª_¡¬t
 + (
k
 * 4)))

2663 
¿dio_¡©
->
chªÃls
[¿dio_¡©->
num_chªÃls
 + 
k
].
Ú_time
 =

2664 
¿dio_¡©
->
Ú_time
;

2666 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2668 
¿dio_¡©
->
num_chªÃls
 +ğ
chª_couÁ
;

2671 
ex™_w™h_v®ues
:

2672 
	`kä“
(
v®ues
);

2673 
ex™_w™h_mibr¥
:

2674 
	`kä“
(
mibr¥
.
d©a
);

2675 
	}
}

2677 
	$¦si_Îs_fl
(
¦si_dev
 *
sdev
, 
u8
 **
¤c_buf
)

2679 
Ãt_deviû
 *
Ãt_dev
 = 
NULL
;

2680 
¦si_Îs_¿dio_¡©
 *
¿dio_¡©
;

2681 
¦si_Îs_¿dio_¡©
 *
¿dio_¡©_‹mp
;

2682 
¦si_Îs_içû_¡©
 *
içû_¡©
;

2683 
buf_Ën
 = 0;

2684 
max_chª_couÁ
 = 0;

2685 
u8
 *
buf
;

2686 
num_of_¿dios_suµÜ‹d
;

2687 
i
 = 0;

2688 
¿dio_ty³
[2] = {
	`BIT
(0), BIT(1)};

2690 ià(
sdev
->
Îs_num_¿dio
 == 0) {

2691 
	`SLSI_ERR
(
sdev
, "Number of„adios‡re zero forhis…latform\n");

2692  -
EIO
;

2694 
num_of_¿dios_suµÜ‹d
 = 
sdev
->
Îs_num_¿dio
;

2695 
Ãt_dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

2697 ià(
sdev
->
why
->
bªds
[
NL80211_BAND_2GHZ
])

2698 
max_chª_couÁ
 = 
sdev
->
why
->
bªds
[
NL80211_BAND_2GHZ
]->
n_chªÃls
;

2699 ià(
sdev
->
why
->
bªds
[
NL80211_BAND_5GHZ
])

2700 
max_chª_couÁ
 +ğ
sdev
->
why
->
bªds
[
NL80211_BAND_5GHZ
]->
n_chªÃls
;

2701 
buf_Ën
 = ()((
num_of_¿dios_suµÜ‹d
 * (
¦si_Îs_¿dio_¡©
))

2702 + (
¦si_Îs_içû_¡©
)

2703 + (
u8
)

2704 + ((
¦si_Îs_³”_šfo
è* 
SLSI_ADHOC_PEER_CONNECTIONS_MAX
)

2705 + ((
¦si_Îs_chªÃl_¡©
è* 
max_chª_couÁ
));

2706 
buf
 = 
	`kz®loc
(
buf_Ën
, 
GFP_KERNEL
);

2707 ià(!
buf
) {

2708 
	`SLSI_ERR
(
sdev
, "NØmem. Size:%d\n", 
buf_Ën
);

2709  -
ENOMEM
;

2711 
buf
[0] = 
num_of_¿dios_suµÜ‹d
;

2712 *
¤c_buf
 = 
buf
;

2713 
içû_¡©
 = (
¦si_Îs_içû_¡©
 *)(
buf
 + (
u8
));

2714 
	`¦si_Îs_içû_¡©_fl
(
sdev
, 
Ãt_dev
, 
içû_¡©
);

2716 
¿dio_¡©
 = (
¦si_Îs_¿dio_¡©
 *)(
buf
 + (
u8
è+ (
¦si_Îs_içû_¡©
) +

2717 ((
¦si_Îs_³”_šfo
è* 
içû_¡©
->
num_³”s
));

2718 
¿dio_¡©_‹mp
 = 
¿dio_¡©
;

2719 ià(
num_of_¿dios_suµÜ‹d
 == 1) {

2720 
¿dio_ty³
[0] = 
	`BIT
(0) | BIT(1);

2721 
	`¦si_Îs_¿dio_¡©_fl
(
sdev
, 
Ãt_dev
, 
¿dio_¡©
, 
max_chª_couÁ
, 0, 
¿dio_ty³
[0]);

2722 
¿dio_¡©
 = (
¦si_Îs_¿dio_¡©
 *)((
u8
 *)radio_stat + (slsi_lls_radio_stat) +

2723 ((
¦si_Îs_chªÃl_¡©
è* 
¿dio_¡©
->
num_chªÃls
));

2725 
i
 = 1; i <ğ
num_of_¿dios_suµÜ‹d
 ; i++) {

2726 
	`¦si_Îs_¿dio_¡©_fl
(
sdev
, 
Ãt_dev
, 
¿dio_¡©
, 
max_chª_couÁ
, 
i
, 
¿dio_ty³
[i - 1]);

2727 
¿dio_¡©
 = (
¦si_Îs_¿dio_¡©
 *)((
u8
 *)radio_stat +

2728 (
¦si_Îs_¿dio_¡©
è+ ((
¦si_Îs_chªÃl_¡©
)

2729 * 
¿dio_¡©
->
num_chªÃls
));

2732 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


2733 ià(
	`¦si_dev_Î¦ogs_suµÜ‹d
())

2734 
	`¦si_Îs_debug_dump_¡©s
(
sdev
, 
¿dio_¡©_‹mp
, 
içû_¡©
, 
buf
, 
buf_Ën
, 
num_of_¿dios_suµÜ‹d
);

2736  
buf_Ën
;

2737 
	}
}

2739 
	$¦si_Îs_g‘_¡©s
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2741 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2742 
»t
;

2743 
u8
 *
buf
 = 
NULL
;

2744 
buf_Ën
;

2746 ià(!
	`¦si_dev_Îs_suµÜ‹d
())

2747  -
EOPNOTSUPP
;

2749 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

2750 
	`SLSI_WARN
(
sdev
, "not supported in WlanLite mode\n");

2751  -
EOPNOTSUPP
;

2754 ià(!
sdev
) {

2755 
	`SLSI_ERR
(
sdev
, "sdev is Null\n");

2756  -
EINVAL
;

2760 ià(
sdev
->
mlme_blocked
)

2761 
buf_Ën
 = -
EIO
;

2763 
buf_Ën
 = 
	`¦si_Îs_fl
(
sdev
, &
buf
);

2765 ià(
buf_Ën
 > 0) {

2766 
»t
 = 
	`¦si_v’dÜ_cmd_»¶y
(
why
, 
buf
, 
buf_Ën
);

2767 ià(
»t
)

2768 
	`SLSI_ERR_NODEV
("v’dÜ cmd„•ly faed (”r:%d)\n", 
»t
);

2770 
»t
 = 
buf_Ën
;

2772 
	`kä“
(
buf
);

2773  
»t
;

2774 
	}
}

2776 
	$¦si_gsÿn_£t_oui
(
why
 *wiphy,

2777 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2779 
»t
 = 0;

2781 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


2783 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2784 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

2785 
Ãtdev_vif
 *
ndev_vif
;

2786 
‹mp
;

2787 
ty³
;

2788 cÚ¡ 
Æ©Œ
 *
©Œ
;

2789 
u8
 
sÿn_oui
[6];

2791 
	`mem£t
(&
sÿn_oui
, 0, 6);

2793 ià(!
dev
) {

2794 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

2795  -
EINVAL
;

2798 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2799 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

2800 
sdev
->
sÿn_addr_£t
 = 0;

2802 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

2803 ià(!
©Œ
) {

2804 
»t
 = -
EINVAL
;

2808 
ty³
 = 
	`Æa_ty³
(
©Œ
);

2809 
ty³
) {

2810 
SLSI_NL_ATTRIBUTE_PNO_RANDOM_MAC_OUI
:

2812 ià(
	`¦si_ut_Æa_g‘_d©a
(
©Œ
, 3, &
sÿn_oui
)) {

2813 
»t
 = -
EINVAL
;

2816 
	`memıy
(
sdev
->
sÿn_mac_addr
, 
sÿn_oui
, 6);

2817 
sdev
->
sÿn_addr_£t
 = 1;

2821 
»t
 = -
EINVAL
;

2822 
	`SLSI_ERR
(
sdev
, "Inv®idy³ : %d\n", 
ty³
);

2826 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

2828  
»t
;

2829 
	}
}

2831 
	$¦si_g‘_ã©u»_£t
(
why
 *wiphy,

2832 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2834 
u32
 
ã©u»_£t
 = 0;

2835 
»t
 = 0;

2836 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2838 
	`SLSI_DBG3_NODEV
(
SLSI_GSCAN
, "\n");

2840 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_INFRA
;

2841 ià(
sdev
->
bªd_5g_suµÜ‹d
)

2842 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_INFRA_5G
;

2843 #iâdeà
CONFIG_SCSC_WLAN_STA_ONLY


2844 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_P2P
;

2845 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_SOFT_AP
;

2847 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_RSSI_MONITOR
;

2848 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_CONTROL_ROAMING
;

2849 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_TDLS
 | 
SLSI_WIFI_HAL_FEATURE_TDLS_OFFCHANNEL
;

2850 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_HOTSPOT
;

2851 #iâdeà
CONFIG_SCSC_WLAN_NAT_KEEPALIVE_DISABLE


2852 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_MKEEP_ALIVE
;

2854 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_LOGGING


2855 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_LOGGER
;

2857 ià(
	`¦si_dev_gsÿn_suµÜ‹d
())

2858 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_GSCAN
;

2859 ià(
	`¦si_dev_Îs_suµÜ‹d
())

2860 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_LINK_LAYER_STATS
;

2861 ià(
	`¦si_dev_•no_suµÜ‹d
())

2862 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_HAL_EPNO
;

2863 ià(
	`¦si_dev_Çn_suµÜ‹d
(
	`SDEV_FROM_WIPHY
(
why
)))

2864 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_NAN
;

2865 ià(
	`¦si_dev_¹t_suµÜ‹d
()) {

2866 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_D2D_RTT
;

2867 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_D2AP_RTT
;

2870 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_BATCH_SCAN
;

2871 #ià!
	`defšed
(
SCSC_SEP_VERSION
) || (defined(SCSC_SEP_VERSION) && SCSC_SEP_VERSION >= 11)

2872 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_PNO
;

2874 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


2875 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_AP_STA
;

2877 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_CONFIG_NDO
;

2878 #ifdeà
CONFIG_SCSC_WLAN_ENABLE_MAC_RANDOMISATION


2879 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_SCAN_RAND
;

2881 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_LOW_LATENCY
;

2882 
ã©u»_£t
 |ğ
SLSI_WIFI_HAL_FEATURE_P2P_RAND_MAC
;

2884 
»t
 = 
	`¦si_v’dÜ_cmd_»¶y
(
why
, &
ã©u»_£t
, (feature_set));

2886  
»t
;

2887 
	}
}

2889 
	$¦si_£t_couÁry_code
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2891 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2892 
»t
 = 0;

2893 
‹mp
;

2894 
ty³
;

2895 cÚ¡ 
Æ©Œ
 *
©Œ
;

2896 
couÁry_code
[
SLSI_COUNTRY_CODE_LEN
];

2898 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "Received country code command\n");

2900 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

2901 
ty³
 = 
	`Æa_ty³
(
©Œ
);

2902 
ty³
) {

2903 
SLSI_NL_ATTRIBUTE_COUNTRY_CODE
:

2905 ià(
	`¦si_ut_Æa_g‘_d©a
(
©Œ
, (
SLSI_COUNTRY_CODE_LEN
 - 1), 
couÁry_code
)) {

2906 
»t
 = -
EINVAL
;

2907 
	`SLSI_ERR
(
sdev
, "Insuffic›Á CouÁry CodL’gth : %d\n", 
	`Æa_Ën
(
©Œ
));

2908  
»t
;

2913 
»t
 = -
EINVAL
;

2914 
	`SLSI_ERR
(
sdev
, "Inv®idy³ : %d\n", 
ty³
);

2915  
»t
;

2918 
»t
 = 
	`¦si_£t_couÁry_upd©e_»gd
(
sdev
, 
couÁry_code
, 
SLSI_COUNTRY_CODE_LEN
);

2919 ià(
»t
 < 0)

2920 
	`SLSI_ERR
(
sdev
, "S‘ couÁry faed„‘:%d\n", 
»t
);

2921  
»t
;

2922 
	}
}

2924 
	$¦si_­f_»ad_f‹r
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2926 
»t
 = 0;

2927 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2928 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

2929 
u8
 *
ho¡_d¡
;

2930 
d©®’
;

2932 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "SUBCMD_APF_READ_FILTER\n");

2933 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2934 ià(!
sdev
->
deviû_cÚfig
.
fw_­f_suµÜ‹d
) {

2935 
	`SLSI_WARN
(
sdev
, "APF‚ot supported byhe firmware.\n");

2936 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2937  -
ENOTSUPP
;

2940 
»t
 = 
	`¦si_mlme_»ad_­f_»que¡
(
sdev
, 
dev
, &
ho¡_d¡
, &
d©®’
);

2941 ià(!
»t
)

2942 
»t
 = 
	`¦si_v’dÜ_cmd_»¶y
(
why
, 
ho¡_d¡
, 
d©®’
);

2944 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2945  
»t
;

2946 
	}
}

2948 
	$¦si_­f_g‘_ÿ·b™›s
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2950 
»t
 = 0;

2951 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2952 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

2953 
sk_buff
 *
Æ_skb
;

2954 
Æ©Œ
 *
Æ©Œ_¡¬t
;

2956 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "SUBCMD_APF_GET_CAPABILITIES\n");

2957 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

2958 ià(!
sdev
->
deviû_cÚfig
.
fw_­f_suµÜ‹d
) {

2959 
	`SLSI_WARN
(
sdev
, "APF‚ot supported byhe firmware.\n");

2960 
»t
 = -
ENOTSUPP
;

2961 
ex™
;

2963 
	`mem£t
(&
sdev
->
deviû_cÚfig
.
­f_ÿp
, 0, (
¦si_­f_ÿ·b™›s
));

2965 
»t
 = 
	`¦si_mib_g‘_­f_ÿp
(
sdev
, 
dev
);

2966 ià(
»t
 != 0) {

2967 
	`SLSI_ERR
(
sdev
, "Failedo„ead mib\n");

2968 
ex™
;

2970 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "APF v”siÚ: %d Max_L’gth:%d\n", sdev->
deviû_cÚfig
.
­f_ÿp
.
v”siÚ
,

2971 
sdev
->
deviû_cÚfig
.
­f_ÿp
.
max_Ëngth
);

2972 
Æ_skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
);

2973 ià(!
Æ_skb
) {

2974 
	`SLSI_ERR
(
sdev
, "NO MEM for‚l_skb!!!\n");

2975 
»t
 = -
ENOMEM
;

2976 
ex™
;

2979 
Æ©Œ_¡¬t
 = 
	`Æa_Ã¡_¡¬t
(
Æ_skb
, 
NL80211_ATTR_VENDOR_DATA
);

2980 ià(!
Æ©Œ_¡¬t
) {

2981 
	`SLSI_ERR
(
sdev
, "failedo…ut NL80211_ATTR_VENDOR_DATA\n");

2983 
	`kä“_skb
(
Æ_skb
);

2984 
»t
 = -
EINVAL
;

2985 
ex™
;

2988 
»t
 = 
	`Æa_put_u16
(
Æ_skb
, 
SLSI_APF_ATTR_VERSION
, 
sdev
->
deviû_cÚfig
.
­f_ÿp
.
v”siÚ
);

2989 
»t
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_APF_ATTR_MAX_LEN
, 
sdev
->
deviû_cÚfig
.
­f_ÿp
.
max_Ëngth
);

2990 ià(
»t
) {

2991 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»t
);

2993 
	`kä“_skb
(
Æ_skb
);

2994 
ex™
;

2997 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
Æ_skb
);

2998 ià(
»t
)

2999 
	`SLSI_ERR
(
sdev
, "­f_g‘_ÿ·b™› cfg80211_v’dÜ_cmd_»¶y faed :%d\n", 
»t
);

3000 
ex™
:

3001 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3002  
»t
;

3003 
	}
}

3005 
	$¦si_­f_£t_f‹r
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

3007 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3008 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

3009 
»t
 = 0;

3010 
‹mp
;

3011 
ty³
;

3012 cÚ¡ 
Æ©Œ
 *
©Œ
;

3013 
u32
 
´og¿m_Ën
 = 0;

3014 
u8
 *
´og¿m
 = 
NULL
;

3016 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "Received‡pf_set_filter command\n");

3017 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3018 ià(!
sdev
->
deviû_cÚfig
.
fw_­f_suµÜ‹d
) {

3019 
	`SLSI_WARN
(
sdev
, "APF‚ot supported byhe firmware.\n");

3020 
»t
 = -
ENOTSUPP
;

3021 
ex™
;

3024 ià(!
dev
) {

3025 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

3026 
»t
 = -
EINVAL
;

3027 
ex™
;

3030 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

3031 
ty³
 = 
	`Æa_ty³
(
©Œ
);

3032 
ty³
) {

3033 
SLSI_APF_ATTR_PROGRAM_LEN
:

3035 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
´og¿m_Ën
)) {

3036 
»t
 = -
EINVAL
;

3037 
ex™
;

3039 
	`kä“
(
´og¿m
);

3040 
´og¿m
 = 
	`km®loc
(
´og¿m_Ën
, 
GFP_KERNEL
);

3041 ià(!
´og¿m
) {

3042 
»t
 = -
ENOMEM
;

3043 
ex™
;

3047 
SLSI_APF_ATTR_PROGRAM
:

3049 ià(!
´og¿m
) {

3050 
	`SLSI_ERR
(
sdev
, "Program†en is‚ot set!\n");

3051 
»t
 = -
EINVAL
;

3052 
ex™
;

3054 ià(
	`¦si_ut_Æa_g‘_d©a
(
©Œ
, 
´og¿m_Ën
, 
´og¿m
)) {

3055 
»t
 = -
EINVAL
;

3056 
ex™
;

3061 
	`SLSI_ERR
(
sdev
, "Inv®idy³ : %d\n", 
ty³
);

3062 
»t
 = -
EINVAL
;

3063 
ex™
;

3067 
»t
 = 
	`¦si_mlme_š¡®l_­f_»que¡
(
sdev
, 
dev
, 
´og¿m
, 
´og¿m_Ën
);

3068 ià(
»t
 < 0) {

3069 
	`SLSI_ERR
(
sdev
, "­f_£t_f‹¸çed„‘:%d\n", 
»t
);

3070 
»t
 = -
EINVAL
;

3071 
ex™
;

3073 
ex™
:

3074 
	`kä“
(
´og¿m
);

3075 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3076  
»t
;

3077 
	}
}

3079 
	$¦si_¹t_g‘_ÿ·b™›s
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

3081 
¦si_¹t_ÿ·b™›s
 
¹t_ÿp
;

3082 
»t
 = 0;

3083 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3084 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

3086 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "SUBCMD_GET_RTT_CAPABILITIES\n");

3087 ià(!
	`¦si_dev_¹t_suµÜ‹d
()) {

3088 
	`SLSI_WARN
(
sdev
, "RTT‚ot supported.\n");

3089  -
ENOTSUPP
;

3091 
	`mem£t
(&
¹t_ÿp
, 0, (
¦si_¹t_ÿ·b™›s
));

3093 
»t
 = 
	`¦si_mib_g‘_¹t_ÿp
(
sdev
, 
dev
, &
¹t_ÿp
);

3094 ià(
»t
 != 0) {

3095 
	`SLSI_ERR
(
sdev
, "Failedo„ead mib\n");

3096  
»t
;

3098 
»t
 = 
	`¦si_v’dÜ_cmd_»¶y
(
why
, &
¹t_ÿp
, (
¦si_¹t_ÿ·b™›s
));

3099 ià(
»t
)

3100 
	`SLSI_ERR_NODEV
("¹t_g‘_ÿ·b™› v’dÜ cmd„•ly faed (”¸ğ%d)\n", 
»t
);

3101  
»t
;

3102 
	}
}

3104 
	$¦si_¹t_´oûss_rg‘_šfo
(cÚ¡ 
Æ©Œ
 *
™”
, 
¦si_¹t_cÚfig
 *
Æ_¹t_·¿ms
,

3105 
u8
 *
¹t_³”
, 
num_deviûs
)

3107 
j
 = 0, 
tmp1
, 
tmp2
;

3108 
u16
 
chªÃl_äeq
 = 0;

3109 cÚ¡ 
Æ©Œ
 *
ou‹r
, *
šÃr
;

3111 
	`Æa_fÜ_—ch_Ã¡ed
(
ou‹r
, 
™”
, 
tmp1
) {

3112 
	`Æa_fÜ_—ch_Ã¡ed
(
šÃr
, 
ou‹r
, 
tmp2
) {

3113 
	`Æa_ty³
(
šÃr
)) {

3114 
SLSI_RTT_ATTRIBUTE_TARGET_MAC
:

3115 ià(
	`¦si_ut_Æa_g‘_d©a
(
šÃr
, 
ETH_ALEN
, 
Æ_¹t_·¿ms
[
j
].
³”_addr
))

3116  -
EINVAL
;

3118 
SLSI_RTT_ATTRIBUTE_TARGET_TYPE
:

3119 ià(
	`¦si_ut_Æa_g‘_u8
(
šÃr
, &
Æ_¹t_·¿ms
[
j
].
¹t_ty³
))

3120  -
EINVAL
;

3122 
SLSI_RTT_ATTRIBUTE_TARGET_PEER
:

3123 ià(
	`¦si_ut_Æa_g‘_u8
(
šÃr
, 
¹t_³”
))

3124  -
EINVAL
;

3125 
Æ_¹t_·¿ms
[
j
].
¹t_³”
 = *rtt_peer;

3127 
SLSI_RTT_ATTRIBUTE_TARGET_CHAN_FREQ
:

3128 ià(
	`¦si_ut_Æa_g‘_u16
(
šÃr
, &
chªÃl_äeq
))

3129  -
EINVAL
;

3130 
Æ_¹t_·¿ms
[
j
].
chªÃl_äeq
 = channel_freq * 2;

3132 
SLSI_RTT_ATTRIBUTE_TARGET_PERIOD
:

3133 ià(
	`¦si_ut_Æa_g‘_u8
(
šÃr
, &
Æ_¹t_·¿ms
[
j
].
bur¡_³riod
))

3134  -
EINVAL
;

3136 
SLSI_RTT_ATTRIBUTE_TARGET_NUM_BURST
:

3137 ià(
	`¦si_ut_Æa_g‘_u8
(
šÃr
, &
Æ_¹t_·¿ms
[
j
].
num_bur¡
))

3138  -
EINVAL
;

3140 
SLSI_RTT_ATTRIBUTE_TARGET_NUM_FTM_BURST
:

3141 ià(
	`¦si_ut_Æa_g‘_u8
(
šÃr
, &
Æ_¹t_·¿ms
[
j
].
num_äames_³r_bur¡
))

3142  -
EINVAL
;

3144 
SLSI_RTT_ATTRIBUTE_TARGET_NUM_RETRY_FTMR
:

3145 ià(
	`¦si_ut_Æa_g‘_u8
(
šÃr
, &
Æ_¹t_·¿ms
[
j
].
num_»Œ›s_³r_ámr
))

3146  -
EINVAL
;

3148 
SLSI_RTT_ATTRIBUTE_TARGET_BURST_DURATION
:

3149 ià(
	`¦si_ut_Æa_g‘_u8
(
šÃr
, &
Æ_¹t_·¿ms
[
j
].
bur¡_du¿tiÚ
))

3150  -
EINVAL
;

3152 
SLSI_RTT_ATTRIBUTE_TARGET_PREAMBLE
:

3153 ià(
	`¦si_ut_Æa_g‘_u16
(
šÃr
, &
Æ_¹t_·¿ms
[
j
].
´—mbË
))

3154  -
EINVAL
;

3156 
SLSI_RTT_ATTRIBUTE_TARGET_BW
:

3157 ià(
	`¦si_ut_Æa_g‘_u16
(
šÃr
, &
Æ_¹t_·¿ms
[
j
].
bw
))

3158  -
EINVAL
;

3160 
SLSI_RTT_ATTRIBUTE_TARGET_LCI
:

3161 ià(
	`¦si_ut_Æa_g‘_u16
(
šÃr
, &
Æ_¹t_·¿ms
[
j
].
LCI_»que¡
))

3162  -
EINVAL
;

3164 
SLSI_RTT_ATTRIBUTE_TARGET_LCR
:

3165 ià(
	`¦si_ut_Æa_g‘_u16
(
šÃr
, &
Æ_¹t_·¿ms
[
j
].
LCR_»que¡
))

3166  -
EINVAL
;

3172 
j
++;

3173 ià(
j
 > 
num_deviûs
)

3177 
	}
}

3179 
	$¦si_¹t_£t_cÚfig
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

3181 
r
 = -
EINVAL
, 
ty³
, 
¹t_id
, 
j
 = 0;

3182 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3183 
Ãtdev_vif
 *
ndev_vif
;

3184 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

3185 
¦si_¹t_cÚfig
 *
Æ_¹t_·¿ms
;

3186 
¦si_¹t_id_·¿ms
 *
¹t_id_·¿ms
 = 
NULL
;

3187 cÚ¡ 
Æ©Œ
 *
™”
;

3188 
u8
 
sourû_addr
[
ETH_ALEN
];

3189 
tmp
;

3190 
u16
 
»que¡_id
 = 0;

3191 
u8
 
num_deviûs
 = 0;

3192 
u8
 
¹t_³”
 = 
SLSI_RTT_PEER_AP
;

3194 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "SUBCMD_RTT_RANGE_START\n");

3195 ià(!
	`¦si_dev_¹t_suµÜ‹d
()) {

3196 
	`SLSI_ERR
(
sdev
, "RTT‚ot supported.\n");

3197  
WIFI_HAL_ERROR_NOT_SUPPORTED
;

3199 ià(!
dev
) {

3200 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

3201  
r
;

3204 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3205 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3206 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

3207 
ty³
 = 
	`Æa_ty³
(
™”
);

3208 
ty³
) {

3209 
SLSI_RTT_ATTRIBUTE_TARGET_CNT
:

3210 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
num_deviûs
))

3211 
ex™_w™h_mu‹x
;

3212 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "T¬g‘ cÁ %d\n", 
num_deviûs
);

3214 
SLSI_RTT_ATTRIBUTE_TARGET_ID
:

3215 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
»que¡_id
))

3216 
ex™_w™h_mu‹x
;

3217 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "Reque¡ ID: %d\n", 
»que¡_id
);

3224 ià(!
num_deviûs
) {

3225 
	`SLSI_ERR_NODEV
("No device found for„tt configuration!\n");

3226 
ex™_w™h_mu‹x
;

3229 
Æ_¹t_·¿ms
 = 
	`kÿÎoc
(
num_deviûs
, (*Æ_¹t_·¿ms), 
GFP_KERNEL
);

3230 ià(!
Æ_¹t_·¿ms
) {

3231 
	`SLSI_ERR_NODEV
("Failedo‡llocate memory for config„tt_param\n");

3232 
r
 = -
ENOMEM
;

3233 
ex™_w™h_mu‹x
;

3235 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

3236 
ty³
 = 
	`Æa_ty³
(
™”
);

3237 
ty³
) {

3238 
SLSI_RTT_ATTRIBUTE_TARGET_INFO
:

3239 
r
 = 
	`¦si_¹t_´oûss_rg‘_šfo
(
™”
, 
Æ_¹t_·¿ms
, &
¹t_³”
, 
num_deviûs
);

3240 ià(
r
)

3241 
ex™_w™h_Æ_¹t_·¿ms
;

3247 
	`SLSI_ETHER_COPY
(
sourû_addr
, 
dev
->
dev_addr
);

3249 
¹t_id
 = 
SLSI_MIN_RTT_ID
;„‰_id <ğ
SLSI_MAX_RTT_ID
;„tt_id++) {

3250 ià(!
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1]) {

3251 
¹t_id_·¿ms
 = 
	`kz®loc
((
¦si_¹t_id_·¿ms
è+ 
ETH_ALEN
 * 
num_deviûs
, 
GFP_KERNEL
);

3252 ià(!
¹t_id_·¿ms
) {

3253 
	`SLSI_INFO
(
sdev
, "Failedo‡llocate memory for„tt_id_params.\n");

3254 
r
 = -
ENOMEM
;

3255 
ex™_w™h_Æ_¹t_·¿ms
;

3257 
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1] =„tt_id_params;

3261 ià(
¹t_id
 > 
SLSI_MAX_RTT_ID
) {

3262 
	`SLSI_ERR_NODEV
("RTT_ID(1-7) is in use currently!!\n");

3263 
ex™_w™h_Æ_¹t_·¿ms
;

3265 
¹t_id_·¿ms
->
çpi_»q_id
 = 
¹t_id
;

3266 
¹t_id_·¿ms
->
h®_»que¡_id
 = 
»que¡_id
;

3267 
¹t_id_·¿ms
->
³”_couÁ
 = 
num_deviûs
;

3268 
¹t_id_·¿ms
->
³”_ty³
 = 
¹t_³”
;

3270 
j
 = 0; j < 
num_deviûs
; j++)

3271 
	`SLSI_ETHER_COPY
(&
¹t_id_·¿ms
->
³”s
[
j
 * 
ETH_ALEN
], 
Æ_¹t_·¿ms
[j].
³”_addr
);

3272 ià(
¹t_³”
 =ğ
SLSI_RTT_PEER_NAN
) {

3273 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


3274 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3275 
r
 = 
	`¦si_£nd_Çn_¿nge_cÚfig
(
sdev
, 
num_deviûs
, 
Æ_¹t_·¿ms
, 
¹t_id
);

3276 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3278 
	`SLSI_ERR_NODEV
("NAN‚otƒnabled\n");

3279 
r
 = -
ENOTSUPP
;

3282 
r
 = 
	`¦si_mlme_add_¿nge_»q
(
sdev
, 
dev
, 
num_deviûs
, 
Æ_¹t_·¿ms
, 
¹t_id
, 
sourû_addr
);

3283 ià(
r
) {

3284 
	`kä“
(
¹t_id_·¿ms
);

3285 
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1] = 
NULL
;

3286 
	`SLSI_ERR_NODEV
("Failedo set„tt config\n");

3289 
ex™_w™h_Æ_¹t_·¿ms
:

3290 
	`kä“
(
Æ_¹t_·¿ms
);

3292 
ex™_w™h_mu‹x
:

3293 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3294  
r
;

3295 
	}
}

3297 
	$¦si_tx_¿‹_ÿlc
(
sk_buff
 *
Æ_skb
, 
u16
 
fw_¿‹
, 
»s
, 
boŞ
 
tx_¿‹
)

3299 
u8
 
´—mbË
;

3300 cÚ¡ 
u32
 
fw_¿‹_idx_to_80211_¿‹
[] = { 0, 10, 20, 55, 60, 90, 110, 120, 180, 240, 360, 480, 540 };

3301 
u32
 
d©a_¿‹
 = 0;

3302 
u32
 
mcs
 = 0, 
nss
 = 0;

3303 
u32
 
chª_bw_idx
 = 0;

3304 
gi_idx
;

3306 
´—mbË
 = (
fw_¿‹
 & 
SLSI_FW_API_RATE_HT_SELECTOR_FIELD
) >> 14;

3307 ià((
fw_¿‹
 & 
SLSI_FW_API_RATE_HT_SELECTOR_FIELD
è=ğ
SLSI_FW_API_RATE_NON_HT_SELECTED
) {

3308 
u16
 
fw_¿‹_idx
 = 
fw_¿‹
 & 
SLSI_FW_API_RATE_INDEX_FIELD
;

3310 ià(
fw_¿‹
 > 0 && 
fw_¿‹_idx
 < 
	`ARRAY_SIZE
(
fw_¿‹_idx_to_80211_¿‹
))

3311 
d©a_¿‹
 = 
fw_¿‹_idx_to_80211_¿‹
[
fw_¿‹_idx
];

3312 } ià((
fw_¿‹
 & 
SLSI_FW_API_RATE_HT_SELECTOR_FIELD
è=ğ
SLSI_FW_API_RATE_HT_SELECTED
) {

3313 
nss
 = (
SLSI_FW_API_RATE_HT_NSS_FIELD
 & 
fw_¿‹
) >> 6;

3314 
chª_bw_idx
 = (
fw_¿‹
 & 
SLSI_FW_API_RATE_BW_FIELD
) >> 9;

3315 
gi_idx
 = ((
fw_¿‹
 & 
SLSI_FW_API_RATE_SGI
) == SLSI_FW_API_RATE_SGI) ? 1 : 0;

3316 
mcs
 = 
SLSI_FW_API_RATE_HT_MCS_FIELD
 & 
fw_¿‹
;

3317 ià(
chª_bw_idx
 < 2 && 
mcs
 <= 7) {

3318 
d©a_¿‹
 = (
nss
 + 1è* 
¦si_¿‹s_bË
[
chª_bw_idx
][
gi_idx
][
mcs
];

3319 } ià(
mcs
 =ğ32 && 
chª_bw_idx
 == 1) {

3320 ià(
gi_idx
 == 1)

3321 
d©a_¿‹
 = (
nss
 + 1) * 67;

3323 
d©a_¿‹
 = (
nss
 + 1) * 60;

3325 
	`SLSI_WARN_NODEV
("FW DATA RATE decodeƒrror fw_rate:%x, bw:%x, mcs_idx:%x,‚ss : %d\n",

3326 
fw_¿‹
, 
chª_bw_idx
, 
mcs
, 
nss
);

3328 } ià((
fw_¿‹
 & 
SLSI_FW_API_RATE_HT_SELECTOR_FIELD
è=ğ
SLSI_FW_API_RATE_VHT_SELECTED
) {

3332 
chª_bw_idx
 = (
fw_¿‹
 & 
SLSI_FW_API_RATE_BW_FIELD
) >> 9;

3333 
gi_idx
 = ((
fw_¿‹
 & 
SLSI_FW_API_RATE_SGI
) == SLSI_FW_API_RATE_SGI) ? 1 : 0;

3335 
nss
 = (
SLSI_FW_API_RATE_VHT_NSS_FIELD
 & 
fw_¿‹
) >> 4;

3336 
mcs
 = 
SLSI_FW_API_RATE_VHT_MCS_FIELD
 & 
fw_¿‹
;

3338 ià(
chª_bw_idx
 <ğ2 && 
mcs
 <= 11)

3339 
d©a_¿‹
 = (
nss
 + 1è* 
¦si_¿‹s_bË
[
chª_bw_idx
][
gi_idx
][
mcs
];

3341 
	`SLSI_WARN_NODEV
("FW DATA RATE decodeƒrror fw_rate:%x, bw:%x, mcs_idx:%x,nss : %d\n",

3342 
fw_¿‹
, 
chª_bw_idx
, 
mcs
, 
nss
);

3343 ià(
nss
 > 1)

3344 
nss
 += 1;

3347 ià(
tx_¿‹
) {

3348 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_TX_PREAMBLE
, 
´—mbË
);

3349 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_TX_NSS
, 
nss
);

3350 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_TX_BW
, 
chª_bw_idx
);

3351 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_TX_MCS
, 
mcs
);

3352 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_TX_RATE
, 
d©a_¿‹
);

3354 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RX_PREAMBLE
, 
´—mbË
);

3355 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RX_NSS
, 
nss
);

3356 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RX_BW
, 
chª_bw_idx
);

3357 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RX_MCS
, 
mcs
);

3358 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RX_RATE
, 
d©a_¿‹
);

3360  
»s
;

3361 
	}
}

3363 
	$¦si_rx_¿nge_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3365 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3366 
u32
 
i
, 
tm
;

3367 
u16
 
¹t_’Œy_couÁ
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_¿nge_šd
.
’Œ›s
);

3368 
u16
 
¹t_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_¿nge_šd
.rtt_id);

3369 
u16
 
»que¡_id
 = 
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1]->
h®_»que¡_id
;

3370 
u32
 
tmac
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
mlme_¿nge_šd
.
¥¬e_3
);

3371 
d©a_Ën
 = 
	`çpi_g‘_d©®’
(
skb
);

3372 
u8
 *
_±r
, *
¡¬t_±r
;

3373 
u16
 
tx_d©a
 = 0, 
rx_d©a
 = 0;

3374 
sk_buff
 *
Æ_skb
;

3375 
»s
 = 0;

3376 
Æ©Œ
 *
Æ©Œ_Ã¡ed
;

3377 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 6, 0))

3378 
time¥ec64
 
ts
;

3380 
time¥ec
 
ts
;

3382 
u64
 
tk”Ãl
;

3383 
u8
 
»p_út
 = 0;

3384 
__Ë16
 *
Ë16_±r
 = 
NULL
;

3385 
__Ë32
 *
Ë32_±r
 = 
NULL
;

3386 
u16
 
v®ue
;

3387 
u32
 
‹mp_v®ue
;

3389 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3390 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

3391 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
,

3392 
SLSI_NL80211_RTT_RESULT_EVENT
, 
GFP_KERNEL
);

3394 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NL80211_RTT_RESULT_EVENT
,

3395 
GFP_KERNEL
);

3397 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


3398 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "Event: %s(%d)\n",

3399 
	`¦si_´št_ev’t_Çme
(
SLSI_NL80211_RTT_RESULT_EVENT
), SLSI_NL80211_RTT_RESULT_EVENT);

3402 ià(!
Æ_skb
) {

3403 
	`SLSI_ERR
(
sdev
, "NO MEM for‚l_skb!!!\n");

3404 
ex™
;

3407 
_±r
 = 
	`çpi_g‘_d©a
(
skb
);

3408 
¡¬t_±r
 = 
	`çpi_g‘_d©a
(
skb
);

3409 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_ATTRIBUTE_RESULT_CNT
, 
¹t_’Œy_couÁ
);

3410 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_ATTRIBUTE_TARGET_ID
, 
»que¡_id
);

3411 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_ATTRIBUTE_RESULTS_PER_TARGET
, 1);

3412 
i
 = 0; i < 
¹t_’Œy_couÁ
; i++) {

3413 
Æ©Œ_Ã¡ed
 = 
	`Æa_Ã¡_¡¬t
(
Æ_skb
, 
SLSI_RTT_ATTRIBUTE_RESULT
);

3414 ià(!
Æ©Œ_Ã¡ed
) {

3415 
	`SLSI_ERR
(
sdev
, "Error in‚la_nest_start\n");

3417 
	`kä“_skb
(
Æ_skb
);

3418 
ex™
;

3420 
_±r
 += 7;

3421 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_ADDR
, 
ETH_ALEN
, 
_±r
);

3422 
_±r
 += 6;

3424 
Ë16_±r
 = (
__Ë16
 *)&
_±r
[
i
];

3425 
v®ue
 = 
	`Ë16_to_ıu
(*
Ë16_±r
);

3426 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_BURST_NUM
, 
v®ue
);

3427 
_±r
 += 2;

3429 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_MEASUREMENT_NUM
, *
_±r
++);

3430 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_SUCCESS_NUM
, *
_±r
++);

3431 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_NUM_PER_BURST_PEER
, *
_±r
++);

3433 
Ë16_±r
 = (
__Ë16
 *)&
_±r
[
i
];

3434 
v®ue
 = 
	`Ë16_to_ıu
(*
Ë16_±r
);

3435 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_STATUS
, 
v®ue
);

3436 
_±r
 += 2;

3437 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RETRY_AFTER_DURATION
, *
_±r
++);

3439 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_TYPE
, *
_±r
++);

3440 
Ë16_±r
 = (
__Ë16
 *)&
_±r
[
i
];

3441 
v®ue
 = 
	`Ë16_to_ıu
(*
Ë16_±r
);

3442 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RSSI
, 
v®ue
);

3443 
_±r
 += 2;

3445 
Ë16_±r
 = (
__Ë16
 *)&
_±r
[
i
];

3446 
v®ue
 = 
	`Ë16_to_ıu
(*
Ë16_±r
);

3447 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RSSI_SPREAD
, 
v®ue
);

3448 
_±r
 += 2;

3450 
	`memıy
(&
tx_d©a
, 
_±r
, 2);

3451 
»s
 = 
	`¦si_tx_¿‹_ÿlc
(
Æ_skb
, 
tx_d©a
,„es, 1);

3452 
_±r
 += 2;

3454 
	`memıy
(&
rx_d©a
, 
_±r
, 2);

3455 
»s
 = 
	`¦si_tx_¿‹_ÿlc
(
Æ_skb
, 
rx_d©a
,„es, 0);

3456 
_±r
 += 2;

3458 
Ë32_±r
 = (
__Ë32
 *)&
_±r
[
i
];

3459 
‹mp_v®ue
 = 
	`Ë32_to_ıu
(*
Ë32_±r
);

3460 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RTT
, 
‹mp_v®ue
);

3461 
_±r
 += 4;

3463 
Ë16_±r
 = (
__Ë16
 *)&
_±r
[
i
];

3464 
v®ue
 = 
	`Ë16_to_ıu
(*
Ë16_±r
);

3465 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RTT_SD
, 
v®ue
);

3466 
_±r
 += 2;

3468 
Ë16_±r
 = (
__Ë16
 *)&
_±r
[
i
];

3469 
v®ue
 = 
	`Ë16_to_ıu
(*
Ë16_±r
);

3470 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RTT_SPREAD
, 
v®ue
);

3471 
_±r
 += 2;

3473 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 6, 0))

3474 
ts
 = 
	`ktime_to_time¥ec64
(
	`ktime_g‘_boÙtime
());

3475 #–ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 4, 0))

3476 
ts
 = 
	`ktime_to_time¥ec
(
	`ktime_g‘_boÙtime
());

3478 
	`g‘_mÚÙÚic_boÙtime
(&
ts
);

3481 
tk”Ãl
 = (
u64
)
	`TIMESPEC_TO_US
(
ts
);

3482 
Ë32_±r
 = (
__Ë32
 *)&
_±r
[
i
];

3483 
‹mp_v®ue
 = 
	`Ë32_to_ıu
(*
Ë32_±r
);

3484 
tm
 = 
‹mp_v®ue
;

3485 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_TIMESTAMP_US
, 
tk”Ãl
 - (
tmac
 - 
tm
));

3486 
_±r
 += 4;

3488 
Ë32_±r
 = (
__Ë32
 *)&
_±r
[
i
];

3489 
‹mp_v®ue
 = 
	`Ë32_to_ıu
(*
Ë32_±r
);

3490 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_DISTANCE_MM
, 
‹mp_v®ue
);

3491 
_±r
 += 4;

3493 
Ë32_±r
 = (
__Ë32
 *)&
_±r
[
i
];

3494 
‹mp_v®ue
 = 
	`Ë32_to_ıu
(*
Ë32_±r
);

3495 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_DISTANCE_SD_MM
, 
‹mp_v®ue
);

3496 
_±r
 += 4;

3498 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_BURST_DURATION_MSN
, *
_±r
++);

3499 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_NEGOTIATED_BURST_NUM
, *
_±r
++);

3500 
»p_út
 = 0;„ep_cnt < 2;„ep_cnt++) {

3501 ià(
_±r
 - 
¡¬t_±r
 < 
d©a_Ën
 && ip_±r[0] =ğ
WLAN_EID_MEASURE_REPORT
) {

3502 ià(
_±r
[4] == 8)

3503 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_LCI
,

3504 
_±r
[1] + 2, ip_ptr);

3505 ià(
_±r
[4] == 11)

3506 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_LCR
,

3507 
_±r
[1] + 2, ip_ptr);

3508 
_±r
 += ip_ptr[1] + 2;

3511 
	`Æa_Ã¡_’d
(
Æ_skb
, 
Æ©Œ_Ã¡ed
);

3513 
	`SLSI_DBG_HEX
(
sdev
, 
SLSI_GSCAN
, 
	`çpi_g‘_d©a
(
skb
), 
	`çpi_g‘_d©®’
(skb), "range indication skb buffer:\n");

3514 ià(
»s
) {

3515 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»s
);

3516 
	`kä“_skb
(
Æ_skb
);

3517 
ex™
;

3519 
	`cfg80211_v’dÜ_ev’t
(
Æ_skb
, 
GFP_KERNEL
);

3520 
ex™
:

3521 
	`kä“_skb
(
skb
);

3522 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3523 
	}
}

3525 
	$¦si_rx_¿nge_dÚe_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3527 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3528 
u16
 
¹t_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_¿nge_šd
.rtt_id);

3529 
u16
 
»que¡_id
 = 
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1]->
h®_»que¡_id
;

3531 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3532 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


3533 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "Event: %s(%d)\n",

3534 
	`¦si_´št_ev’t_Çme
(
SLSI_NL80211_RTT_COMPLETE_EVENT
), SLSI_NL80211_RTT_COMPLETE_EVENT);

3536 
	`¦si_v’dÜ_ev’t
(
sdev
, 
SLSI_NL80211_RTT_COMPLETE_EVENT
, &
»que¡_id
, (request_id));

3538 
	`kä“
(
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1]);

3539 
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1] = 
NULL
;

3540 
	`kä“_skb
(
skb
);

3541 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3542 
	}
}

3545 
	$¦si_¹t_»move_³”
(
¦si_dev
 *
sdev
, 
u8
 *
addr
, u8 
¹t_id_idx
, u8 
couÁ_addr
)

3547 
i
 = 0, 
j
;

3548 
u8
 
z”o_addr
[
ETH_ALEN
];

3549 
u8
 
»move_id
 = 1;

3551 
	`mem£t
(
z”o_addr
, 0, 
ETH_ALEN
);

3553 
i
 = 0; i < 
sdev
->
¹t_id_·¿ms
[
¹t_id_idx
]->
³”_couÁ
; i++) {

3554 
j
 = 0; j < 
couÁ_addr
; j++)

3555 ià(
	`SLSI_ETHER_EQUAL
(&
sdev
->
¹t_id_·¿ms
[
¹t_id_idx
]->
³”s
[
i
 * 
ETH_ALEN
],

3556 &
addr
[
j
 * 
ETH_ALEN
]))

3557 
	`SLSI_ETHER_COPY
(&
sdev
->
¹t_id_·¿ms
[
¹t_id_idx
]->
³”s
[
i
 * 
ETH_ALEN
], 
z”o_addr
);

3559 ià(!
	`SLSI_ETHER_EQUAL
(&
sdev
->
¹t_id_·¿ms
[
¹t_id_idx
]->
³”s
[
i
 * 
ETH_ALEN
], 
z”o_addr
))

3560 
»move_id
 = 0;

3563 ià(
»move_id
) {

3564 
	`SLSI_INFO
(
sdev
, "Remov¹ˆid:%d\n", 
¹t_id_idx
 + 1);

3565 
	`kä“
(
sdev
->
¹t_id_·¿ms
[
¹t_id_idx
]);

3566 
sdev
->
¹t_id_·¿ms
[
¹t_id_idx
] = 
NULL
;

3568 
	}
}

3570 
	$¦si_¹t_ÿnûl_cÚfig
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

3572 
‹mp
, 
r
 = 1, 
j
 = 0, 
ty³
, 
couÁ
 = 0, 
i
 = 0, 
k
 = 0;

3573 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3574 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

3575 
Ãtdev_vif
 *
ndev_vif
;

3576 
u8
 *
addr
;

3578 
u8
 *
ÿnûl_addr_li¡
;

3579 cÚ¡ 
Æ©Œ
 *
™”
;

3580 
u16
 
num_deviûs
 = 0;

3581 
u8
 
couÁ_addr
 = 0, 
³”_couÁ
 = 0;

3583 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "RTT_SUBCMD_CANCEL_CONFIG\n");

3584 ià(!
	`¦si_dev_¹t_suµÜ‹d
()) {

3585 
	`SLSI_WARN
(
sdev
, "RTT‚ot supported.\n");

3586  -
ENOTSUPP
;

3588 ià(!
dev
) {

3589 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

3590  -
EINVAL
;

3593 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3594 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3595 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
‹mp
) {

3596 
ty³
 = 
	`Æa_ty³
(
™”
);

3597 
ty³
) {

3598 
SLSI_RTT_ATTRIBUTE_TARGET_CNT
:

3599 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
num_deviûs
)) {

3600 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3601  -
EINVAL
;

3603 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "T¬g‘ cÁ %d\n", 
num_deviûs
);

3606 
	`SLSI_ERR_NODEV
("NØATTRIBUTE_T¬g‘ cÁ - %d\n", 
ty³
);

3610 ià(!
num_deviûs
) {

3611 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3612  
r
;

3615 
addr
 = 
	`kz®loc
(
ETH_ALEN
 * 
num_deviûs
, 
GFP_KERNEL
);

3616 ià(!
addr
) {

3617 
	`SLSI_ERR_NODEV
("Failedo‡llocate memory for mac‡ddresses\n");

3618 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3619  -
ENOMEM
;

3621 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
‹mp
) {

3622 
ty³
 = 
	`Æa_ty³
(
™”
);

3623 ià(
ty³
 =ğ
SLSI_RTT_ATTRIBUTE_TARGET_MAC
) {

3624 ià(
couÁ
 >ğ
num_deviûs
)

3626 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
ETH_ALEN
, &
addr
[
j
]))

3628 
j
 = j + 
ETH_ALEN
;

3629 
couÁ
++;

3631 
	`SLSI_ERR_NODEV
("NØATTRIBUTE_MAC - %d\n", 
ty³
);

3634 
ÿnûl_addr_li¡
 = 
	`kz®loc
(
ETH_ALEN
 * 
num_deviûs
, 
GFP_KERNEL
);

3635 ià(!
ÿnûl_addr_li¡
) {

3636 
	`SLSI_INFO
(
sdev
, "Failedo‡llocate memory for cancel_addr_list.\n");

3637 
	`kä“
(
addr
);

3638 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3639  -
ENOMEM
;

3642 
i
 = 0; i < 
SLSI_MAX_RTT_ID
; i++) {

3643 
couÁ_addr
 = 0;

3644 ià(!
sdev
->
¹t_id_·¿ms
[
i
])

3646 
j
 = 0; j < 
num_deviûs
; j++) {

3647 
³”_couÁ
 = 
sdev
->
¹t_id_·¿ms
[
i
]->peer_count;

3648 
k
 = 0; k < 
³”_couÁ
; k++)

3649 ià(
	`SLSI_ETHER_EQUAL
(&
sdev
->
¹t_id_·¿ms
[
i
]->
³”s
[
k
 * 
ETH_ALEN
],

3650 &
addr
[
j
 * 
ETH_ALEN
])) {

3651 
	`SLSI_ETHER_COPY
(&
ÿnûl_addr_li¡
[
couÁ_addr
 * 
ETH_ALEN
], &
addr
[
j
 * ETH_ALEN]);

3652 
couÁ_addr
++;

3656 ià(!
couÁ_addr
)

3658 ià(
sdev
->
¹t_id_·¿ms
[
i
]->
³”_ty³
 =ğ
SLSI_RTT_PEER_NAN
) {

3659 
sdev
->
¹t_id_·¿ms
[
i
]->
³”_ty³
 = 0;

3660 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


3661 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3662 
r
 = 
	`¦si_£nd_Çn_¿nge_ÿnûl
(
sdev
);

3663 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3665 
	`SLSI_ERR_NODEV
("NAN‚otƒnabled\n");

3666 
r
 = -
ENOTSUPP
;

3669 
r
 = 
	`¦si_mlme_d–_¿nge_»q
(
sdev
, 
dev
, 
couÁ_addr
, 
ÿnûl_addr_li¡
, 
i
 + 1);

3671 
	`¦si_¹t_»move_³”
(
sdev
, 
ÿnûl_addr_li¡
, 
i
, 
couÁ_addr
);

3672 ià(
r
)

3673 
	`SLSI_ERR_NODEV
("FaedØÿnûÈ¹ˆcÚfig fÜ id:%d\n", 
i
 + 1);

3674 
	`mem£t
(
ÿnûl_addr_li¡
, 0, 
ETH_ALEN
 * 
num_deviûs
);

3676 
	`kä“
(
addr
);

3677 
	`kä“
(
ÿnûl_addr_li¡
);

3678 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3679  
r
;

3680 
	}
}

3682 #ià
IS_ENABLED
(
CONFIG_IPV6
)

3683 
	$¦si_cÚfigu»_nd_ofæßd
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

3685 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3686 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

3687 
Ãtdev_vif
 *
ndev_vif
;

3688 
»t
 = 0;

3689 
‹mp
;

3690 
ty³
;

3691 cÚ¡ 
Æ©Œ
 *
©Œ
;

3692 
u8
 
nd_ofæßd_’abËd
 = 0;

3694 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "Received‚d_offload command\n");

3696 ià(!
dev
) {

3697 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

3698  -
EINVAL
;

3701 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3702 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3704 ià(!
ndev_vif
->
aùiv©ed
 || (ndev_vif->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
) ||

3705 (
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTED
)) {

3706 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "vifƒrror\n");

3707 
»t
 = -
EPERM
;

3708 
ex™
;

3711 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

3712 
ty³
 = 
	`Æa_ty³
(
©Œ
);

3713 
ty³
) {

3714 
SLSI_NL_ATTRIBUTE_ND_OFFLOAD_VALUE
:

3716 ià(
	`¦si_ut_Æa_g‘_u8
(
©Œ
, &
nd_ofæßd_’abËd
)) {

3717 
»t
 = -
EINVAL
;

3718 
ex™
;

3723 
	`SLSI_ERR
(
sdev
, "Inv®idy³ : %d\n", 
ty³
);

3724 
»t
 = -
EINVAL
;

3725 
ex™
;

3729 
ndev_vif
->
¡a
.
nd_ofæßd_’abËd
 =‚d_offload_enabled;

3730 
»t
 = 
	`¦si_mlme_£t_v6_add»ss
(
sdev
, 
dev
);

3731 ià(
»t
 < 0) {

3732 
	`SLSI_ERR
(
sdev
, "CÚfigu»‚d_ofæßd faed„‘:%d‚d_ofæßd_’abËd: %d\n", 
»t
, 
nd_ofæßd_’abËd
);

3733 
»t
 = -
EINVAL
;

3734 
ex™
;

3736 
ex™
:

3737 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3738  
»t
;

3739 
	}
}

3742 
	$¦si_g‘_rßmšg_ÿ·b™›s
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

3744 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3745 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

3746 
Ãtdev_vif
 *
ndev_vif
;

3747 
»t
 = 0;

3748 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

3749 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

3750 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = {{ 
SLSI_PSID_UNIFI_ROAM_BLACKLIST_SIZE
, { 0, 0 } } };

3751 
u32
 
max_bÏckli¡_size
 = 0;

3752 
u32
 
max_wh™–i¡_size
 = 0;

3753 
sk_buff
 *
Æ_skb
;

3754 
Æ©Œ
 *
Æ©Œ_¡¬t
;

3756 ià(!
dev
) {

3757 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

3758  -
EINVAL
;

3761 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3763 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3765 
mibr¥
.
d©aL’gth
 = 10;

3766 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

3767 ià(!
mibr¥
.
d©a
) {

3768 
	`SLSI_ERR
(
sdev
, "CªnÙ km®loø%d by‹s\n", 
mibr¥
.
d©aL’gth
);

3769 
»t
 = -
ENOMEM
;

3770 
ex™
;

3772 
v®ues
 = 
	`¦si_»ad_mibs
(
sdev
, 
NULL
, 
g‘_v®ues
, 
	`ARRAY_SIZE
(g‘_v®ues), &
mibr¥
);

3773 ià(
v®ues
 && (v®ues[0].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
 || v®ues[0].ty³ =ğ
SLSI_MIB_TYPE_INT
))

3774 
max_bÏckli¡_size
 = 
v®ues
[0].
u
.
uštV®ue
;

3775 
Æ_skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
);

3776 ià(!
Æ_skb
) {

3777 
	`SLSI_ERR
(
sdev
, "NO MEM for‚l_skb!!!\n");

3778 
»t
 = -
ENOMEM
;

3779 
ex™_w™h_mib_»¥
;

3782 
Æ©Œ_¡¬t
 = 
	`Æa_Ã¡_¡¬t
(
Æ_skb
, 
NL80211_ATTR_VENDOR_DATA
);

3783 ià(!
Æ©Œ_¡¬t
) {

3784 
	`SLSI_ERR
(
sdev
, "failedo…ut NL80211_ATTR_VENDOR_DATA\n");

3786 
	`kä“_skb
(
Æ_skb
);

3787 
»t
 = -
EINVAL
;

3788 
ex™_w™h_mib_»¥
;

3791 
»t
 = 
	`Æa_put_u32
(
Æ_skb
, 
SLSI_NL_ATTR_MAX_BLACKLIST_SIZE
, 
max_bÏckli¡_size
);

3792 
»t
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_NL_ATTR_MAX_WHITELIST_SIZE
, 
max_wh™–i¡_size
);

3793 ià(
»t
) {

3794 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»t
);

3796 
	`kä“_skb
(
Æ_skb
);

3797 
ex™_w™h_mib_»¥
;

3800 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
Æ_skb
);

3801 ià(
»t
)

3802 
	`SLSI_ERR
(
sdev
, "cfg80211_v’dÜ_cmd_»¶y faed :%d\n", 
»t
);

3803 
ex™_w™h_mib_»¥
:

3804 
	`kä“
(
mibr¥
.
d©a
);

3805 
	`kä“
(
v®ues
);

3806 
ex™
:

3807 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3808  
»t
;

3809 
	}
}

3811 
	$¦si_£t_rßmšg_¡©e
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

3813 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

3814 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

3815 
‹mp
 = 0;

3816 
ty³
 = 0;

3817 cÚ¡ 
Æ©Œ
 *
©Œ
;

3818 
»t
 = 0;

3819 
rßm_¡©e
 = 0;

3820 
u8
 
v®
 = 0;

3822 ià(!
dev
) {

3823 
	`SLSI_WARN_NODEV
("net_dev is NULL\n");

3824  -
EINVAL
;

3827 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

3828 
ty³
 = 
	`Æa_ty³
(
©Œ
);

3829 
ty³
) {

3830 
SLSI_NL_ATTR_ROAM_STATE
:

3831 ià(
	`¦si_ut_Æa_g‘_u8
(
©Œ
, &
v®
)) {

3832 
»t
 = -
EINVAL
;

3833 
ex™
;

3835 
rßm_¡©e
 = ()
v®
;

3838 
	`SLSI_ERR_NODEV
("UnknowÀ©Œibu‹: %d\n", 
ty³
);

3839 
»t
 = -
EINVAL
;

3840 
ex™
;

3844 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "SUBCMD_SET_ROAMING_STATE„ßm_¡©ğ%d\n", 
rßm_¡©e
);

3845 
»t
 = 
	`¦si_£t_mib_rßm
(
sdev
, 
NULL
, 
SLSI_PSID_UNIFI_ROAMING_ACTIVATED
, 
rßm_¡©e
);

3846 ià(
»t
 < 0)

3847 
	`SLSI_ERR_NODEV
("Failedo set„oaming state\n");

3849 
ex™
:

3850  
»t
;

3851 
	}
}

3853 *
	$¦si_g‘_rßm_»asÚ_¡r
(
rßm_»asÚ
)

3855 
rßm_»asÚ
) {

3856 
SLSI_WIFI_ROAMING_SEARCH_REASON_RESERVED
:

3858 
SLSI_WIFI_ROAMING_SEARCH_REASON_LOW_RSSI
:

3860 
SLSI_WIFI_ROAMING_SEARCH_REASON_LINK_LOSS
:

3862 
SLSI_WIFI_ROAMING_SEARCH_REASON_BTM_REQ
:

3864 
SLSI_WIFI_ROAMING_SEARCH_REASON_CU_TRIGGER
:

3866 
SLSI_WIFI_ROAMING_SEARCH_REASON_EMERGENCY
:

3868 
SLSI_WIFI_ROAMING_SEARCH_REASON_IDLE
:

3870 
SLSI_WIFI_ROAMING_SEARCH_REASON_SCAN_TIMER1_EXPIRY
:

3872 
SLSI_WIFI_ROAMING_SEARCH_REASON_SCAN_TIMER2_EXPIRY
:

3874 
SLSI_WIFI_ROAMING_SEARCH_REASON_INACTIVE_TIMER_EXPIRY
:

3879 
	}
}

3881 *
	$¦si_g‘_Çn_rŞe_¡r
(
Çn_rŞe
)

3883 
Çn_rŞe
) {

3897 
	}
}

3899 *
	$¦si_äame_Œªsm™_çu»_mes§ge_ty³
(
mes§ge_ty³
)

3901 
mes§ge_ty³
) {

3921 
	}
}

3923 *
	$¦si_g‘_sÿn_ty³
(
sÿn_ty³
)

3925 
sÿn_ty³
) {

3926 
FAPI_SCANTYPE_SOFT_CACHED_ROAMING_SCAN
:

3928 
FAPI_SCANTYPE_SOFT_FULL_ROAMING_SCAN
:

3930 
FAPI_SCANTYPE_HARD_CACHED_ROAMING_SCAN
:

3932 
FAPI_SCANTYPE_HARD_FULL_ROAMING_SCAN
:

3937 
	}
}

3939 *
	$¦si_g‘_m—su»_mode
(
m—su»_mode
)

3941 
m—su»_mode
) {

3951 
	}
}

3953 *
	$¦si_g‘_Çn_scheduË_ty³_¡r
(
scheduË_ty³
)

3955 
scheduË_ty³
) {

3965 
	}
}

3967 *
	$¦si_g‘_Çn_ulw_»asÚ_¡r
(
ulw_»asÚ
)

3969 
ulw_»asÚ
) {

3985 
	}
}

3987 
	$¦si_hªdË_Çn_rx_ev’t_log_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3989 
u16
 
ev’t_id
 = 0;

3990 
u64
 
time¡amp
 = 0;

3991 
u8
 *
v_d©a
;

3992 
v_bufãr__Ën
 = 
	`çpi_g‘_d©®’
(
skb
), 
i
 = 0;

3993 
u16
 
v’dÜ_Ën
, 
g_id
, 
g_Ën
, 
vg_id
;

3994 
u32
 
g_v®ue
, 
vg_v®ue
;

3995 
boŞ
 
muÉi_·¿m
 = 
çl£
, 
·¿m_£t_avaabË
 = false;

3996 
u32
 
Çn_rŞe
 = 0, 
hİ_couÁ
 = 0, 
ma¡”_tsf
 = 0, 
chªÃl
 = 0;

3997 
u32
 
scheduË_ty³
 = 0, 
¡¬t_off£t
 = 0, 
¦Ù_du¿tiÚ
 = 0, 
¦Ù_b™m­
 = 0;

3998 
u32
 
ulw_»asÚ
 = 0, 
ulw_šdex
 = 0, 
ulw_¡¬t
 = 0, 
ulw_³riod
 = 0, 
ulw_du¿tiÚ
 = 0, 
ulw_couÁ
 = 0;

3999 
u32
 
tx_mpdu_tÙ®
 = 0, 
rx_mpdu_tÙ®
 = 0, 
¦Ù_avg_rx
 = 0, 
¦Ù_avg_tx
 = 0;

4000 
u8
 
Çn_şu¡”_id
[6] = {0}, 
Çn_nmi
[6] = {0}, 
width
 = 0, 
pos™iÚ
 = 0;

4001 
u32
 
Çn_amr_high”
 = 0, 
Çn_amr_low”
 = 0;

4002 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


4003 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4006 
ev’t_id
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_ev’t_log_šd
.
ev’t
);

4007 
time¡amp
 = 
	`çpi_g‘_u64
(
skb
, 
u
.
mlme_ev’t_log_šd
.timestamp);

4008 
v_d©a
 = 
	`çpi_g‘_d©a
(
skb
);

4009 
i
 + 4 < 
v_bufãr__Ën
) {

4010 
g_id
 = 
	`Ë16_to_ıu
(*((
__Ë16
 *)&
v_d©a
[
i
]));

4011 
g_Ën
 = 
	`Ë16_to_ıu
(*((
__Ë16
 *)&
v_d©a
[
i
 + 2]));

4012 
i
 += 4;

4013 ià(
i
 + 
g_Ën
 > 
v_bufãr__Ën
) {

4014 
	`SLSI_INFO
(
sdev
, "Incorrect fapi bulk data\n");

4017 
g_v®ue
 = 
	`¦si_cÚv”t_v_d©a_to_v®ue
(&
v_d©a
[
i
], 
g_Ën
);

4018 
muÉi_·¿m
 = 
çl£
;

4019 
g_id
) {

4020 
SLSI_WIFI_TAG_CHANNEL
:

4021 
chªÃl
 = 
g_v®ue
 / 2;

4023 
SLSI_WIFI_TAG_VENDOR_SPECIFIC
:

4024 
v’dÜ_Ën
 = 
g_Ën
 - 2;

4025 
vg_id
 = 
	`Ë16_to_ıu
(*((
__Ë16
 *)&
v_d©a
[
i
]));

4026 
vg_v®ue
 = 
	`¦si_cÚv”t_v_d©a_to_v®ue
(&
v_d©a
[
i
 + 2], 
v’dÜ_Ën
);

4027 
vg_id
) {

4028 
SLSI_WIFI_TAG_VD_CLUSTER_ID
:

4029 ià(
v’dÜ_Ën
 !ğ
ETH_ALEN
) {

4030 
	`mem£t
(
Çn_şu¡”_id
, 0, 
ETH_ALEN
);

4031 
	`SLSI_ERR
(
sdev
, "Clu£¸ID should boà6 by‹s,by‹ »ûived:%d\n", 
v’dÜ_Ën
);

4034 
	`memıy
(
Çn_şu¡”_id
, &
v_d©a
[
i
 + 2], 
v’dÜ_Ën
);

4036 
SLSI_WIFI_TAG_VD_NAN_ROLE
:

4037 
Çn_rŞe
 = 
vg_v®ue
;

4039 
SLSI_WIFI_TAG_VD_NAN_AMR
:

4040 ià(
v’dÜ_Ën
 != 8) {

4041 
	`SLSI_ERR
(
sdev
, "NAN AMR should boà8 by‹s,by‹ »ûived:%d\n", 
v’dÜ_Ën
);

4044 
	`¦si_cÚv”t_v_to_64b™_v®ue
(&
v_d©a
[
i
 + 2], 
v’dÜ_Ën
, &
Çn_amr_low”
, &
Çn_amr_high”
);

4046 
SLSI_WIFI_TAG_VD_NAN_NMI
:

4047 ià(
v’dÜ_Ën
 !ğ
ETH_ALEN
) {

4048 
	`mem£t
(
Çn_nmi
, 0, 
ETH_ALEN
);

4049 
	`SLSI_ERR
(
sdev
, "NAN NMI should boà6 by‹s,by‹ »ûived:%d\n", 
v’dÜ_Ën
);

4052 
	`memıy
(
Çn_nmi
, &
v_d©a
[
i
 + 2], 
v’dÜ_Ën
);

4054 
SLSI_WIFI_TAG_VD_NAN_HOP_COUNT
:

4055 
hİ_couÁ
 = 
vg_v®ue
;

4057 
SLSI_WIFI_TAG_VD_MASTER_TSF
:

4058 
ma¡”_tsf
 = 
vg_v®ue
;

4060 
SLSI_WIFI_TAG_VD_CHANNEL_INFO
:

4061 ià(
v’dÜ_Ën
 < 2) {

4062 
	`SLSI_ERR
(
sdev
, "Channel_info should be‡tleast 2 bytes!\n");

4065 
width
 = 
v_d©a
[
i
 + 2];

4066 
pos™iÚ
 = 
v_d©a
[
i
 + 3];

4068 
SLSI_WIFI_TAG_VD_SCHEDULE_TYPE
:

4069 
scheduË_ty³
 = 
vg_v®ue
;

4071 
SLSI_WIFI_TAG_VD_START_OFFSET
:

4072 
¡¬t_off£t
 = 
vg_v®ue
;

4074 
SLSI_WIFI_TAG_VD_SLOT_DURATION
:

4075 
¦Ù_du¿tiÚ
 = 
vg_v®ue
;

4077 
SLSI_WIFI_TAG_VD_BITMAP
:

4078 
¦Ù_b™m­
 = 
vg_v®ue
;

4080 
SLSI_WIFI_TAG_VD_ULW_REASON
:

4081 
ulw_»asÚ
 = 
vg_v®ue
;

4083 
SLSI_WIFI_TAG_VD_ULW_INDEX
:

4084 
ulw_šdex
 = 
vg_v®ue
;

4086 
SLSI_WIFI_TAG_VD_ULW_START_TIME
:

4087 
ulw_¡¬t
 = 
vg_v®ue
;

4089 
SLSI_WIFI_TAG_VD_ULW_PERIOD
:

4090 
ulw_³riod
 = 
vg_v®ue
;

4092 
SLSI_WIFI_TAG_VD_ULW_DURATION
:

4093 
ulw_du¿tiÚ
 = 
vg_v®ue
;

4095 
SLSI_WIFI_TAG_VD_ULW_COUNT
:

4096 
ulw_couÁ
 = 
vg_v®ue
;

4098 
SLSI_WIFI_TAG_VD_NAN_RX_TOTAL
:

4099 
rx_mpdu_tÙ®
 = 
vg_v®ue
;

4101 
SLSI_WIFI_TAG_VD_NAN_TX_TOTAL
:

4102 
tx_mpdu_tÙ®
 = 
vg_v®ue
;

4104 
SLSI_WIFI_TAG_VD_NAN_RX_AVERAGE
:

4105 
¦Ù_avg_rx
 = 
vg_v®ue
;

4107 
SLSI_WIFI_TAG_VD_NAN_TX_AVERAGE
:

4108 
¦Ù_avg_tx
 = 
vg_v®ue
;

4110 
SLSI_WIFI_TAG_VD_PARAMETER_SET
:

4111 
muÉi_·¿m
 = 
Œue
;

4112 ià(!
·¿m_£t_avaabË
) {

4113 
·¿m_£t_avaabË
 = 
Œue
;

4116 
ev’t_id
) {

4117 
WIFI_EVENT_NAN_AVAILABILITY_UPDATE
:

4118 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_NAN_AVAILABILITY_UPDATE, Master_TSF: %d,"

4121 
ma¡”_tsf
, 
chªÃl
, 
width
, 
pos™iÚ
,

4122 
	`¦si_g‘_Çn_scheduË_ty³_¡r
(
scheduË_ty³
), 
¡¬t_off£t
,

4123 
¦Ù_du¿tiÚ
, 
¦Ù_b™m­
);

4124 
·¿m_£t_avaabË
 = 
çl£
;

4126 
WIFI_EVENT_NAN_TRAFFIC_UPDATE
:

4127 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_NAN_TRAFFIC_UPDATE, Rx MPDUsotal: %d,"

4129 "SlÙ Av”agTx: %d\n", 
rx_mpdu_tÙ®
, 
tx_mpdu_tÙ®
, 
chªÃl
,

4130 
¦Ù_avg_rx
, 
¦Ù_avg_tx
);

4131 
·¿m_£t_avaabË
 = 
çl£
;

4138 ià(
muÉi_·¿m
)

4139 
i
 += 2;

4141 
i
 +ğ
g_Ën
;

4143 
ev’t_id
) {

4144 
WIFI_EVENT_FW_NAN_ROLE_TYPE
:

4145 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_NAN_ROLE_TYPE, Clu¡” Id:" 
MACSTR
 ", NAN Role:%s,"

4146 "AMR:0x%08x%08x, NMI:" 
MACSTR
 ", Hop Count:%d\n",

4147 
	`MAC2STR
(
Çn_şu¡”_id
), 
	`¦si_g‘_Çn_rŞe_¡r
(
Çn_rŞe
), 
Çn_amr_high”
, 
Çn_amr_low”
,

4148 
	`MAC2STR
(
Çn_nmi
), 
hİ_couÁ
);

4149 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


4150 
ndev_vif
->
Çn
.
amr_low”
 = 
Çn_amr_low”
;

4151 
ndev_vif
->
Çn
.
amr_high”
 = 
Çn_amr_high”
;

4152 
ndev_vif
->
Çn
.
hİcouÁ
 = 
hİ_couÁ
;

4153 
ndev_vif
->
Çn
.
rŞe
 = 
Çn_rŞe
;

4156 
WIFI_EVENT_NAN_AVAILABILITY_UPDATE
:

4157 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_NAN_AVAILABILITY_UPDATE, Master_TSF: %d, Channel: %d,"

4159 "SlÙ Du¿tiÚ: %d, SlÙ B™m­: %d\n", 
ma¡”_tsf
, 
chªÃl
, 
width
, 
pos™iÚ
,

4160 
	`¦si_g‘_Çn_scheduË_ty³_¡r
(
scheduË_ty³
), 
¡¬t_off£t
, 
¦Ù_du¿tiÚ
, 
¦Ù_b™m­
);

4162 
WIFI_EVENT_NAN_ULW_UPDATE
:

4163 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_NAN_ULW_UPDATE, Master_TSF: %d, ULW_Reason:%s, ULW_Index: %d,"

4165 
ma¡”_tsf
, 
	`¦si_g‘_Çn_ulw_»asÚ_¡r
(
ulw_»asÚ
), 
ulw_šdex
, 
ulw_¡¬t
,

4166 
ulw_³riod
, 
ulw_du¿tiÚ
, 
ulw_couÁ
, 
chªÃl
);

4168 
WIFI_EVENT_NAN_TRAFFIC_UPDATE
:

4169 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_NAN_TRAFFIC_UPDATE, Rx MPDUsotal: %d, Tx MPDUs Total: %d, channel: %d,"

4170 "SlÙ Av”agRx:%d, SlÙ Av”agTx: %d\n", 
rx_mpdu_tÙ®
, 
tx_mpdu_tÙ®
, 
chªÃl
,

4171 
¦Ù_avg_rx
, 
¦Ù_avg_tx
);

4174 
	}
}

4176 
	$¦si_rx_ev’t_log_šdiÿtiÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

4178 
u16
 
ev’t_id
 = 0;

4179 
u64
 
time¡amp
 = 0;

4180 
u8
 *
v_d©a
;

4181 
u8
 
fuÎ_sÿn_couÁ
 = 0;

4182 
u32
 
rßm_»asÚ
 = 0, 
chª_uti§tiÚ
 = 0, 
_scÜe_v®
 = 0;

4183 
u32
 
btm_»que¡_mode
 = 0, 
btm_»¥Ú£
 = 0, 
—pŞ_msg_ty³
 = 0;

4184 
u32
 
d—uth_»asÚ
 = 0, 
—pŞ_»Œy_couÁ
 = 0, 
¡©us_code
 = 0;

4185 
u16
 
v’dÜ_Ën
, 
g_id
, 
g_Ën
, 
vg_id
, 
—pŞ_key_ty³
 = 0, 
cu_th»sh
 = 0;

4186 
u32
 
g_v®ue
, 
vg_v®ue
, 
chª_äequ’cy
 = 0, 
sÿn_ty³
 = 0, 
rßmšg_ty³
 = 0;

4187 
scÜe_v®
 = 0, 
rssi_th»sh
 = 0, 
cu_rssi_th»sh
 = 0;

4188 
u32
 
İ”©šg_şass
 = 0, 
m—su»_mode
 = 0, 
m—su»_du¿tiÚ
 = 0, 
­_couÁ
 = 0, 
ÿndid©e_couÁ
 = 0;

4189 
u32
 
mes§ge_ty³
 = 0, 
expœed_tim”_v®ue
 = 0;

4190 
rßm_rssi_v®
 = 0;

4191 
u8
 
mac_addr
[6] = {0};

4192 
v_bufãr__Ën
 = 
	`çpi_g‘_d©®’
(
skb
), 
i
 = 0, 
chªÃl_v®
 = 0, 
™”
 = 0, 
chªÃl_couÁ
 = 0, 
lim
 = 0;

4193 
chªÃl_li¡
[
MAX_CHANNEL_COUNT
] = {0};

4194 
ssid
[
MAX_SSID_LEN
];

4195 *
¡ršg
 = 
NULL
;

4196 
boŞ
 
muÉi_·¿m
 = 
çl£
, 
cu¼’t_šfo
 = 
Œue
;

4198 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

4199 
ev’t_id
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_ev’t_log_šd
.
ev’t
);

4200 
time¡amp
 = 
	`çpi_g‘_u64
(
skb
, 
u
.
mlme_ev’t_log_šd
.timestamp);

4201 
v_d©a
 = 
	`çpi_g‘_d©a
(
skb
);

4203 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
,

4204 "¦si_rx_ev’t_log_šdiÿtiÚ,ƒv’ˆid = %d,†’ = %d\n", 
ev’t_id
, 
v_bufãr__Ën
);

4206 #ià
	`IS_ENABLED
(
CONFIG_SCSC_WIFILOGGER
)

4207 
	`SCSC_WLOG_FW_EVENT
(
WLOG_NORMAL
, 
ev’t_id
, 
time¡amp
, 
	`çpi_g‘_d©a
(
skb
), 
	`çpi_g‘_d©®’
(skb));

4209 
ev’t_id
) {

4210 
WIFI_EVENT_FW_NAN_ROLE_TYPE
:

4211 
WIFI_EVENT_NAN_AVAILABILITY_UPDATE
:

4212 
WIFI_EVENT_NAN_ULW_UPDATE
:

4213 
WIFI_EVENT_NAN_TRAFFIC_UPDATE
:

4214 
	`¦si_hªdË_Çn_rx_ev’t_log_šd
(
sdev
, 
dev
, 
skb
);

4215 
ex™
;

4217 
i
 + 4 < 
v_bufãr__Ën
) {

4218 
g_id
 = 
	`Ë16_to_ıu
(*((
__Ë16
 *)&
v_d©a
[
i
]));

4219 
g_Ën
 = 
	`Ë16_to_ıu
(*((
__Ë16
 *)&
v_d©a
[
i
 + 2]));

4220 
i
 += 4;

4221 ià(
i
 + 
g_Ën
 > 
v_bufãr__Ën
) {

4222 
	`SLSI_INFO
(
sdev
, "Incorrect fapi bulk data\n");

4223 
	`kä“_skb
(
skb
);

4224 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4227 
g_v®ue
 = 
	`¦si_cÚv”t_v_d©a_to_v®ue
(&
v_d©a
[
i
], 
g_Ën
);

4228 
muÉi_·¿m
 = 
çl£
;

4229 
g_id
) {

4230 
SLSI_WIFI_TAG_RSSI
:

4231 
rßm_rssi_v®
 = ()
g_v®ue
;

4233 
SLSI_WIFI_TAG_REASON_CODE
:

4234 
d—uth_»asÚ
 = 
g_v®ue
;

4236 
SLSI_WIFI_TAG_VENDOR_SPECIFIC
:

4237 
v’dÜ_Ën
 = 
g_Ën
 - 2;

4238 
vg_id
 = 
	`Ë16_to_ıu
(*((
__Ë16
 *)&
v_d©a
[
i
]));

4239 
vg_v®ue
 = 
	`¦si_cÚv”t_v_d©a_to_v®ue
(&
v_d©a
[
i
 + 2], 
v’dÜ_Ën
);

4240 
vg_id
) {

4241 
SLSI_WIFI_TAG_VD_CHANNEL_UTILISATION
:

4242 
chª_uti§tiÚ
 = 
vg_v®ue
;

4244 
SLSI_WIFI_TAG_VD_ROAMING_REASON
:

4245 
rßm_»asÚ
 = 
vg_v®ue
;

4247 
SLSI_WIFI_TAG_VD_BTM_REQUEST_MODE
:

4248 
btm_»que¡_mode
 = 
vg_v®ue
;

4250 
SLSI_WIFI_TAG_VD_BTM_RESPONSE_STATUS
:

4251 
btm_»¥Ú£
 = 
vg_v®ue
;

4253 
SLSI_WIFI_TAG_VD_RETRY_COUNT
:

4254 
—pŞ_»Œy_couÁ
 = 
vg_v®ue
;

4256 
SLSI_WIFI_TAG_VD_EAPOL_KEY_TYPE
:

4257 
—pŞ_key_ty³
 = 
vg_v®ue
;

4259 
SLSI_WIFI_TAG_VD_SCAN_TYPE
:

4260 
sÿn_ty³
 = 
vg_v®ue
;

4262 
SLSI_WIFI_TAG_VD_SCORE
:

4263 
scÜe_v®
 = ()
vg_v®ue
;

4265 
SLSI_WIFI_TAG_VD_RSSI_THRESHOLD
:

4266 
rssi_th»sh
 = ()
vg_v®ue
;

4268 
SLSI_WIFI_TAG_VD_OPERATING_CLASS
:

4269 
İ”©šg_şass
 = 
vg_v®ue
;

4271 
SLSI_WIFI_TAG_VD_MEASUREMENT_MODE
:

4272 
m—su»_mode
 = 
vg_v®ue
;

4274 
SLSI_WIFI_TAG_VD_MEASUREMENT_DURATION
:

4275 
m—su»_du¿tiÚ
 = 
vg_v®ue
;

4277 
SLSI_WIFI_TAG_VD_MIN_AP_COUNT
:

4278 
­_couÁ
 = 
vg_v®ue
;

4280 
SLSI_WIFI_TAG_VD_CANDIDATE_LIST_COUNT
:

4281 
ÿndid©e_couÁ
 = 
vg_v®ue
;

4283 
SLSI_WIFI_TAG_VD_MESSAGE_TYPE
:

4284 
mes§ge_ty³
 = 
vg_v®ue
;

4286 
SLSI_WIFI_TAG_VD_EXPIRED_TIMER_VALUE
:

4287 
expœed_tim”_v®ue
 = 
vg_v®ue
;

4289 
SLSI_WIFI_TAG_VD_ESTIMATED_TP
:

4290 
_scÜe_v®
 = 
vg_v®ue
;

4291 ià(
ev’t_id
 =ğ
WIFI_EVENT_ROAM_SCAN_RESULT
) {

4292 ià(
cu¼’t_šfo
) {

4293 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_ROAM_SCAN_RESULT, Cu¼’ˆAP, BSSID:" 
MACSTR
 ", RSSI:%d, CU:%d, Score:%d, TP Score:%d\n",

4294 
	`MAC2STR
(
mac_addr
), 
rßm_rssi_v®
, 
chª_uti§tiÚ
, 
scÜe_v®
, 
_scÜe_v®
);

4295 
cu¼’t_šfo
 = 
çl£
;

4298 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_ROAM_SCAN_RESULT, Cªdid©AP, BSSID:" 
MACSTR
 ", RSSI:%d, CU:%d, Score:%d, TP Score:%d\n",

4299 
	`MAC2STR
(
mac_addr
), 
rßm_rssi_v®
, 
chª_uti§tiÚ
, 
scÜe_v®
, 
_scÜe_v®
);

4302 
SLSI_WIFI_TAG_VD_PARAMETER_SET
:

4303 
muÉi_·¿m
 = 
Œue
;

4305 
SLSI_WIFI_TAG_VD_FULL_SCAN_COUNT
:

4306 
fuÎ_sÿn_couÁ
 = 
vg_v®ue
;

4308 
SLSI_WIFI_TAG_VD_CU_RSSI_THRESHOLD
:

4309 
cu_rssi_th»sh
 = ()
vg_v®ue
;

4311 
SLSI_WIFI_TAG_VD_CU_THRESHOLD
:

4312 
cu_th»sh
 = 
vg_v®ue
;

4314 
SLSI_WIFI_TAG_VD_ROAMING_TYPE
:

4315 
rßmšg_ty³
 = 
vg_v®ue
;

4319 
SLSI_WIFI_TAG_EAPOL_MESSAGE_TYPE
:

4320 
—pŞ_msg_ty³
 = 
g_v®ue
;

4322 
SLSI_WIFI_TAG_STATUS
:

4323 
¡©us_code
 = 
g_v®ue
;

4325 
SLSI_WIFI_TAG_BSSID
:

4326 
	`SLSI_ETHER_COPY
(
mac_addr
, &
v_d©a
[
i
]);

4328 
SLSI_WIFI_TAG_CHANNEL
:

4329 
chª_äequ’cy
 = 
g_v®ue
;

4331 
SLSI_WIFI_TAG_IE
:

4332 
™”
 = 
i
;

4333 
lim
 = 
™”
 + 
v_d©a
[iter + 1] + 2;

4334 
™”
 += 7;

4335 
™”
 < 
lim
 &&†im <ğ
i
 + 
g_Ën
) {

4336 ià(
chªÃl_couÁ
 >ğ
MAX_CHANNEL_COUNT
) {

4337 
	`SLSI_ERR
(
sdev
, "ERR: ChªÃÈli¡„eûived >ğ%d\n", 
MAX_CHANNEL_COUNT
);

4340 
chªÃl_v®
 = 
	`Ë16_to_ıu
(*((
__Ë16
 *)&
v_d©a
[
™”
]));

4341 
chªÃl_li¡
[
chªÃl_couÁ
] = 
	`›“80211_äequ’cy_to_chªÃl
(
chªÃl_v®
 / 2);

4342 ià(
chªÃl_li¡
[
chªÃl_couÁ
] < 1 || channel_list[channel_count] > 196) {

4343 
	`SLSI_ERR
(
sdev
, "ERR: Inv®id chªÃÈ»ûived %d\n", 
chªÃl_li¡
[
chªÃl_couÁ
]);

4345 
	`SCSC_BIN_TAG_INFO
(
BINARY
, &
v_d©a
[
i
],lv_data[i + 1] + 2);

4348 
™”
 += 3;

4349 
chªÃl_couÁ
 += 1;

4352 
SLSI_WIFI_TAG_SSID
:

4353 
	`mem£t
(
ssid
, '\0', (ssid));

4354 ià(
g_Ën
 > 
MAX_SSID_LEN
)

4355 
	`memıy
(
ssid
, &
v_d©a
[
i
], 
MAX_SSID_LEN
);

4357 
	`memıy
(
ssid
, &
v_d©a
[
i
], 
g_Ën
);

4360 ià(
muÉi_·¿m
)

4361 
i
 += 2;

4363 
i
 +ğ
g_Ën
;

4365 
ev’t_id
) {

4366 
FAPI_EVENT_WIFI_EVENT_FW_EAPOL_FRAME_TRANSMIT_START
:

4367 ià(
—pŞ_key_ty³
 =ğ
SLSI_WIFI_EAPOL_KEY_TYPE_GTK
)

4368 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_EAPOL_FRAME_TRANSMIT_START, S’d GTK, G%d\n", 
—pŞ_msg_ty³
);

4369 ià(
—pŞ_key_ty³
 =ğ
SLSI_WIFI_EAPOL_KEY_TYPE_PTK
)

4370 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_EAPOL_FRAME_TRANSMIT_START, Send 4way-H/S, M%d\n",

4371 
—pŞ_msg_ty³
);

4373 
FAPI_EVENT_WIFI_EVENT_FW_EAPOL_FRAME_TRANSMIT_STOP
:

4374 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_EAPOL_FRAME_TRANSMIT_STOP,Result Code:%d, Retry Count:%d\n",

4375 
¡©us_code
, 
—pŞ_»Œy_couÁ
);

4377 
FAPI_EVENT_WIFI_EVENT_FW_EAPOL_FRAME_RECEIVED
:

4378 ià(
—pŞ_key_ty³
 =ğ
SLSI_WIFI_EAPOL_KEY_TYPE_GTK
)

4379 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_EAPOL_FRAME_RECEIVED, Reûived GTK, G%d\n", 
—pŞ_msg_ty³
);

4380 ià(
—pŞ_key_ty³
 =ğ
SLSI_WIFI_EAPOL_KEY_TYPE_PTK
)

4381 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_EAPOL_FRAME_RECEIVED, Reûived 4way-H/S, M%d\n", 
—pŞ_msg_ty³
);

4383 
WIFI_EVENT_FW_BTM_FRAME_REQUEST
:

4384 
¡ršg
 = 
	`¦si_´št_chªÃl_li¡
(
chªÃl_li¡
, 
chªÃl_couÁ
);

4385 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_BTM_FRAME_REQUEST,Request Mode:%d, Candidate List Count:%d, "

4386 "ChªÃÈLi¡:%s\n", 
btm_»que¡_mode
, 
ÿndid©e_couÁ
, 
¡ršg
);

4387 
	`kä“
(
¡ršg
);

4389 
WIFI_EVENT_FW_BTM_FRAME_RESPONSE
:

4390 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_BTM_FRAME_RESPONSE,Stu code:%d, BSSID:" 
MACSTR
 "\n", 
btm_»¥Ú£
, 
	`MAC2STR
(
mac_addr
));

4392 
FAPI_EVENT_WIFI_EVENT_ROAM_SEARCH_STARTED
:

4393 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_ROAM_SEARCH_STARTED, Roaming Type : %s, RSSI:%d, Deauth Reason:0x%04x, "

4395 (
rßmšg_ty³
 =ğ0 ? "Legacy" : "NCHO"), 
rßm_rssi_v®
, 
d—uth_»asÚ
, 
rssi_th»sh
, 
chª_uti§tiÚ
,

4396 
	`¦si_g‘_rßm_»asÚ_¡r
(
rßm_»asÚ
), 
expœed_tim”_v®ue
);

4398 
FAPI_EVENT_WIFI_EVENT_FW_AUTH_STARTED
:

4399 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_AUTH_STARTED, BSSID:" 
MACSTR
 "\n", 
	`MAC2STR
(
mac_addr
));

4401 
FAPI_EVENT_WIFI_EVENT_AUTH_COMPLETE
:

4402 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_AUTH_COMPLETE,Stu code:%d\n", 
¡©us_code
);

4404 
FAPI_EVENT_WIFI_EVENT_ROAM_ASSOC_COMPLETE
:

4405 
	`SLSI_INFO
(
sdev
, "Received Association Response\n");

4407 
WIFI_EVENT_FW_NR_FRAME_REQUEST
:

4408 
	`SLSI_INFO
(
sdev
, "Send Radio Measurement Frame (Neighbor Report Req)\n");

4410 
WIFI_EVENT_FW_RM_FRAME_RESPONSE
:

4411 
	`SLSI_INFO
(
sdev
, "Received Radio Measurement Frame (Radio Measurement Rep)\n");

4413 
FAPI_EVENT_WIFI_EVENT_ROAM_AUTH_STARTED
:

4414 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_ROAM_AUTH_STARTED, BSSID:" 
MACSTR
 ", F»qu’cy:%d\n", 
	`MAC2STR
(
mac_addr
), 
chª_äequ’cy
 / 2);

4416 
WIFI_EVENT_FW_NR_FRAME_RESPONSE
:

4417 
¡ršg
 = 
	`¦si_´št_chªÃl_li¡
(
chªÃl_li¡
, 
chªÃl_couÁ
);

4418 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_NR_FRAME_RESPONSE, Candidate List Count:%d, Channel List:%s\n",

4419 
ÿndid©e_couÁ
, 
¡ršg
);

4420 
	`kä“
(
¡ršg
);

4422 
FAPI_EVENT_WIFI_EVENT_ROAM_AUTH_COMPLETE
:

4423 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_ROAM_AUTH_COMPLETE, BSSID:" 
MACSTR
 ", ResuÉ:%d\n", 
	`MAC2STR
(
mac_addr
), 
¡©us_code
);

4425 
FAPI_EVENT_WIFI_EVENT_AUTH_TIMEOUT
:

4426 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_AUTH_TIMEOUT, BSSID:" 
MACSTR
 ", ResuÉ:%d\n", 
	`MAC2STR
(
mac_addr
), 
¡©us_code
);

4428 
WIFI_EVENT_ROAM_AUTH_TIMEOUT
:

4429 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_AUTH_TIMEOUT, BSSID:" 
MACSTR
 ", ResuÉ:%d\n", 
	`MAC2STR
(
mac_addr
), 
¡©us_code
);

4431 
WIFI_EVENT_FW_CONNECTION_ATTEMPT_ABORTED
:

4432 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_CONNECTION_ATTEMPT_ABORTED, BSSID:" 
MACSTR
 ", ResuÉ:%d\n", 
	`MAC2STR
(
mac_addr
), 
¡©us_code
);

4434 
FAPI_EVENT_WIFI_EVENT_ROAM_SCAN_STARTED
:

4435 
¡ršg
 = 
	`¦si_´št_chªÃl_li¡
(
chªÃl_li¡
, 
chªÃl_couÁ
);

4436 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_ROAM_SCAN_STARTED, SSID:%s, Scan Type:%s, Channel List:%s\n",

4437 
ssid
, 
	`¦si_g‘_sÿn_ty³
(
sÿn_ty³
), 
¡ršg
);

4438 
	`kä“
(
¡ršg
);

4440 
WIFI_EVENT_ROAM_RSSI_THRESHOLD
:

4441 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_ROAM_RSSI_THRESHOLD, Full scan count:%d, RSSI Threshold:%d, "

4442 "CU RSSI Th»shŞd:%d, CU Th»shŞd:%d\n", 
fuÎ_sÿn_couÁ
, 
rssi_th»sh
, 
cu_rssi_th»sh
, 
cu_th»sh
);

4444 
FAPI_EVENT_WIFI_EVENT_ROAM_SCAN_COMPLETE
:

4445 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_ROAM_SCAN_COMPLETE, SÿÀTy³:%s\n", 
	`¦si_g‘_sÿn_ty³
(
sÿn_ty³
));

4447 
WIFI_EVENT_FW_BEACON_REPORT_REQUEST
:

4448 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_BEACON_REPORT_REQUEST, Operating Class:%d, Measurement Mode:%s,"

4449 "M—su»m’ˆDu¿tiÚ:%d\n", 
İ”©šg_şass
, 
	`¦si_g‘_m—su»_mode
(
m—su»_mode
), 
m—su»_du¿tiÚ
);

4451 
WIFI_EVENT_FW_FTM_RANGE_REQUEST
:

4452 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_FTM_RANGE_REQUEST, Min Ap Count:%d, Candidate List Count:%d\n",

4453 
­_couÁ
, 
ÿndid©e_couÁ
);

4455 
WIFI_EVENT_FW_FRAME_TRANSMIT_FAILURE
:

4456 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_FW_FRAME_TRANSMIT_FAILURE, Message Type:%s, Result:%d, Retry Count:%d\n",

4457 
	`¦si_äame_Œªsm™_çu»_mes§ge_ty³
(
mes§ge_ty³
), 
¡©us_code
, 
—pŞ_»Œy_couÁ
);

4459 
WIFI_EVENT_ASSOCIATING_DEAUTH_RECEIVED
:

4460 
	`SLSI_INFO
(
sdev
, "WIFI_EVENT_ASSOCIATING_DEAUTH_RECEIVED, BSSID:" 
MACSTR
 ", Reason:%d\n",

4461 
	`MAC2STR
(
mac_addr
), 
d—uth_»asÚ
);

4465 
ex™
:

4466 
	`kä“_skb
(
skb
);

4467 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4468 
	}
}

4470 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_LOGGING


4471 
	$¦si_Ú_ršg_bufãr_d©a
(*
ršg_Çme
, *
bufãr
, 
bufãr_size
,

4472 
scsc_wifi_ršg_bufãr_¡©us
 *
bufãr_¡©us
, *
ùx
)

4474 
sk_buff
 *
skb
;

4475 
ev’t_id
 = 
SLSI_NL80211_LOGGER_RING_EVENT
;

4476 
¦si_dev
 *
sdev
 = 
ùx
;

4478 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

4479 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

4480 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
bufãr_size
, 
ev’t_id
, 
GFP_KERNEL
);

4482 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
bufãr_size
, 
ev’t_id
, 
GFP_KERNEL
);

4484 ià(!
skb
) {

4485 
	`SLSI_ERR_NODEV
("FaedØ®loÿ‹ skb fÜ v’dÜƒv’t: %d\n", 
ev’t_id
);

4489 ià(
	`Æa_put
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_STATUS
, (*
bufãr_¡©us
), buffer_status) ||

4490 
	`Æa_put
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_DATA
, 
bufãr_size
, 
bufãr
)) {

4491 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

4492 
	`kä“_skb
(
skb
);

4495 
	`cfg80211_v’dÜ_ev’t
(
skb
, 
GFP_KERNEL
);

4496 
	}
}

4498 
	$¦si_Ú_®”t
(*
bufãr
, 
bufãr_size
, 
”r_code
, *
ùx
)

4500 
sk_buff
 *
skb
;

4501 
ev’t_id
 = 
SLSI_NL80211_LOGGER_FW_DUMP_EVENT
;

4502 
¦si_dev
 *
sdev
 = 
ùx
;

4504 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

4505 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

4506 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

4507 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
bufãr_size
, 
ev’t_id
, 
GFP_KERNEL
);

4509 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
bufãr_size
, 
ev’t_id
, 
GFP_KERNEL
);

4511 ià(!
skb
) {

4512 
	`SLSI_ERR_NODEV
("FaedØ®loÿ‹ skb fÜ v’dÜƒv’t: %d\n", 
ev’t_id
);

4513 
ex™
;

4516 ià(
	`Æa_put_u32
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_DUMP_LEN
, 
bufãr_size
) ||

4517 
	`Æa_put
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_DATA
, 
bufãr_size
, 
bufãr
)) {

4518 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

4519 
	`kä“_skb
(
skb
);

4520 
ex™
;

4522 
	`cfg80211_v’dÜ_ev’t
(
skb
, 
GFP_KERNEL
);

4523 
ex™
:

4524 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4525 
	}
}

4527 
	$¦si_Ú_fœmw¬e_memÜy_dump
(*
bufãr
, 
bufãr_size
, *
ùx
)

4529 
	`SLSI_ERR_NODEV
("slsi_on_firmware_memory_dump\n");

4530 
	`kä“
(
mem_dump_bufãr
);

4531 
mem_dump_bufãr
 = 
NULL
;

4532 
mem_dump_bufãr
 = 
	`km®loc
(
bufãr_size
, 
GFP_KERNEL
);

4533 ià(!
mem_dump_bufãr
) {

4534 
	`SLSI_ERR_NODEV
("Failedo‡llocate memory for mem_dump_buffer\n");

4537 
mem_dump_bufãr_size
 = 
bufãr_size
;

4538 
	`memıy
(
mem_dump_bufãr
, 
bufãr
, 
mem_dump_bufãr_size
);

4539 
	}
}

4541 
	$¦si_Ú_driv”_memÜy_dump
(*
bufãr
, 
bufãr_size
, *
ùx
)

4543 
	`SLSI_ERR_NODEV
("slsi_on_driver_memory_dump\n");

4544 
	`kä“
(
mem_dump_bufãr
);

4545 
mem_dump_bufãr
 = 
NULL
;

4546 
mem_dump_bufãr_size
 = 
bufãr_size
;

4547 
mem_dump_bufãr
 = 
	`km®loc
(
mem_dump_bufãr_size
, 
GFP_KERNEL
);

4548 ià(!
mem_dump_bufãr
) {

4549 
	`SLSI_ERR_NODEV
("Failedo‡llocate memory for mem_dump_buffer\n");

4552 
	`memıy
(
mem_dump_bufãr
, 
bufãr
, 
mem_dump_bufãr_size
);

4553 
	}
}

4555 
	$¦si_’abË_loggšg
(
¦si_dev
 *
sdev
, 
boŞ
 
’abË
)

4557 
¡©us
 = 0;

4558 #ifdeà
ENABLE_WIFI_LOGGER_MIB_WRITE


4559 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

4561 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "V®uoà’abË i : %d\n", 
’abË
);

4562 
¡©us
 = 
	`¦si_mib_’code_boŞ
(&
mib_d©a
, 
SLSI_PSID_UNIFI_LOGGER_ENABLED
, 
’abË
, 0);

4563 ià(
¡©us
 !ğ
SLSI_MIB_STATUS_SUCCESS
) {

4564 
	`SLSI_ERR
(
sdev
, "slsi_enable_logging failed:‚o mem for MIB\n");

4565 
¡©us
 = -
ENOMEM
;

4566 
ex™
;

4568 
¡©us
 = 
	`¦si_mlme_£t
(
sdev
, 
NULL
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

4569 
	`kä“
(
mib_d©a
.
d©a
);

4570 ià(
¡©us
)

4571 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg unifiLogg”EÇbËd MIB.ƒ¼Ü = %d\n", 
¡©us
);

4573 
ex™
:

4574  
¡©us
;

4576 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "UnifiLoggerEnabled MIB write disabled\n");

4577  
¡©us
;

4579 
	}
}

4581 
	$¦si_¡¬t_loggšg
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

4583 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

4584 
»t
 = 0;

4585 
‹mp
 = 0;

4586 
ty³
 = 0;

4587 
ršg_Çme
[32] = {0};

4588 
v”bo£_Ëv–
 = 0;

4589 
ršg_æags
 = 0;

4590 
max_š‹rv®_£c
 = 0;

4591 
mš_d©a_size
 = 0;

4592 cÚ¡ 
Æ©Œ
 *
©Œ
;

4594 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

4595 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

4596 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

4597 ià(!
©Œ
) {

4598 
»t
 = -
EINVAL
;

4599 
ex™
;

4602 
ty³
 = 
	`Æa_ty³
(
©Œ
);

4604 
ty³
) {

4605 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_NAME
:

4606 
	`¡ºıy
(
ršg_Çme
, 
	`Æa_d©a
(
©Œ
), 
	`MIN
(Ôšg_Çmeè- 1, 
	`Æa_Ën
(attr)));

4608 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_VERBOSE_LEVEL
:

4609 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
v”bo£_Ëv–
)) {

4610 
»t
 = -
EINVAL
;

4611 
ex™
;

4614 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_FLAGS
:

4615 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
ršg_æags
)) {

4616 
»t
 = -
EINVAL
;

4617 
ex™
;

4620 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_LOG_MAX_INTERVAL
:

4621 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
max_š‹rv®_£c
)) {

4622 
»t
 = -
EINVAL
;

4623 
ex™
;

4626 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_LOG_MIN_DATA_SIZE
:

4627 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
mš_d©a_size
)) {

4628 
»t
 = -
EINVAL
;

4629 
ex™
;

4633 
	`SLSI_ERR
(
sdev
, "UnknowÀty³: %d\n", 
ty³
);

4634 
»t
 = -
EINVAL
;

4635 
ex™
;

4638 
»t
 = 
	`scsc_wifi_£t_log_hªdËr
(
¦si_Ú_ršg_bufãr_d©a
, 
sdev
);

4639 ià(
»t
 < 0) {

4640 
	`SLSI_ERR
(
sdev
, "scsc_wifi_£t_log_hªdË¸çed„‘: %d\n", 
»t
);

4641 
ex™
;

4643 
»t
 = 
	`scsc_wifi_£t_®”t_hªdËr
(
¦si_Ú_®”t
, 
sdev
);

4644 ià(
»t
 < 0)

4645 
	`SLSI_ERR
(
sdev
, "W¬nšg : scsc_wifi_£t_®”t_hªdË¸çed„‘: %d\n", 
»t
);

4646 
»t
 = 
	`¦si_’abË_loggšg
(
sdev
, 1);

4647 ià(
»t
 < 0) {

4648 
	`SLSI_ERR
(
sdev
, "¦si_’abË_loggšg fÜƒÇbË = 1, faed„‘: %d\n", 
»t
);

4649 
ex™_w™h_»£t_®”t_hªdËr
;

4651 
»t
 = 
	`scsc_wifi_¡¬t_loggšg
(
v”bo£_Ëv–
, 
ršg_æags
, 
max_š‹rv®_£c
, 
mš_d©a_size
, 
ršg_Çme
);

4652 ià(
»t
 < 0) {

4653 
	`SLSI_ERR
(
sdev
, "scsc_wifi_¡¬t_loggšg faed„‘: %d\n", 
»t
);

4654 
ex™_w™h_di§bË_loggšg
;

4656 
ex™
;

4658 
ex™_w™h_di§bË_loggšg
:

4659 
»t
 = 
	`¦si_’abË_loggšg
(
sdev
, 0);

4660 ià(
»t
 < 0)

4661 
	`SLSI_ERR
(
sdev
, "¦si_’abË_loggšg fÜƒÇbË = 0, faed„‘: %d\n", 
»t
);

4662 
ex™_w™h_»£t_®”t_hªdËr
:

4663 
»t
 = 
	`scsc_wifi_»£t_®”t_hªdËr
();

4664 ià(
»t
 < 0)

4665 
	`SLSI_ERR
(
sdev
, "W¬nšg : scsc_wifi_»£t_®”t_hªdË¸çed„‘: %d\n", 
»t
);

4666 
»t
 = 
	`scsc_wifi_»£t_log_hªdËr
();

4667 ià(
»t
 < 0)

4668 
	`SLSI_ERR
(
sdev
, "scsc_wifi_»£t_log_hªdË¸çed„‘: %d\n", 
»t
);

4669 
ex™
:

4670 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4671  
»t
;

4672 
	}
}

4674 
	$¦si_»£t_loggšg
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

4676 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

4677 
»t
 = 0;

4679 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

4680 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

4681 
»t
 = 
	`¦si_’abË_loggšg
(
sdev
, 0);

4682 ià(
»t
 < 0)

4683 
	`SLSI_ERR
(
sdev
, "¦si_’abË_loggšg fÜƒÇbË = 0, faed„‘: %d\n", 
»t
);

4684 
»t
 = 
	`scsc_wifi_»£t_log_hªdËr
();

4685 ià(
»t
 < 0)

4686 
	`SLSI_ERR
(
sdev
, "scsc_wifi_»£t_log_hªdË¸çed„‘: %d\n", 
»t
);

4687 
»t
 = 
	`scsc_wifi_»£t_®”t_hªdËr
();

4688 ià(
»t
 < 0)

4689 
	`SLSI_ERR
(
sdev
, "W¬nšg : scsc_wifi_»£t_®”t_hªdË¸çed„‘: %d\n", 
»t
);

4690 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4691  
»t
;

4692 
	}
}

4694 
	$¦si_Œigg”_fw_mem_dump
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

4696 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

4697 
»t
 = 0;

4698 
sk_buff
 *
skb
 = 
NULL
;

4699 
Ëngth
 = 100;

4701 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

4702 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

4704 
»t
 = 
	`scsc_wifi_g‘_fœmw¬e_memÜy_dump
(
¦si_Ú_fœmw¬e_memÜy_dump
, 
sdev
);

4705 ià(
»t
) {

4706 
	`SLSI_ERR
(
sdev
, "scsc_wifi_g‘_fœmw¬e_memÜy_dum°çed : %d\n", 
»t
);

4707 
ex™
;

4711 
skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 
Ëngth
);

4712 ià(!
skb
) {

4713 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb for Vendorƒvent\n");

4714 
»t
 = -
ENOMEM
;

4715 
ex™
;

4718 ià(
	`Æa_put_u32
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_DUMP_LEN
, 
mem_dump_bufãr_size
)) {

4719 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

4720 
	`kä“_skb
(
skb
);

4721 
»t
 = -
EINVAL
;

4722 
ex™
;

4725 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
skb
);

4727 ià(
»t
)

4728 
	`SLSI_ERR
(
sdev
, "V’dÜ Commªd„•ly faed„‘:%d\n", 
»t
);

4730 
ex™
:

4731 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4732  
»t
;

4733 
	}
}

4735 
	$¦si_g‘_fw_mem_dump
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

4737 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

4738 
»t
 = 0;

4739 
‹mp
 = 0;

4740 
ty³
 = 0;

4741 
buf_Ën
 = 0;

4742 
__u£r
 *
u£r_buf
 = 
NULL
;

4743 cÚ¡ 
Æ©Œ
 *
©Œ
;

4744 
sk_buff
 *
skb
;

4745 
u64
 
v®
 = 0;

4747 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

4748 ià(!
d©a
)

4749  -
EINVAL
;

4751 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

4752 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

4753 
ty³
 = 
	`Æa_ty³
(
©Œ
);

4754 
ty³
) {

4755 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_DUMP_LEN
:

4756 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
buf_Ën
)) {

4757 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4758  -
EINVAL
;

4761 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_DUMP_DATA
:

4762 ià(
	`¦si_ut_Æa_g‘_u64
(
©Œ
, &
v®
)) {

4763 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4764  -
EINVAL
;

4766 
u£r_buf
 = (
__u£r
 *)()(
v®
);

4769 
	`SLSI_ERR
(
sdev
, "UnknowÀty³: %d\n", 
ty³
);

4770 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4771  -
EINVAL
;

4774 ià(
buf_Ën
 > 0 && 
u£r_buf
 && 
mem_dump_bufãr
) {

4775 ià(
buf_Ën
 > 
mem_dump_bufãr_size
)

4776 
buf_Ën
 = 
mem_dump_bufãr_size
;

4777 
»t
 = 
	`cİy_to_u£r
(
u£r_buf
, 
mem_dump_bufãr
, 
buf_Ën
);

4778 ià(
»t
) {

4779 
	`SLSI_ERR
(
sdev
, "çedØcİy memdum°štØu£¸bufã¸: %d\n", 
»t
);

4780 
ex™
;

4784 
skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 100);

4785 ià(!
skb
) {

4786 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb for Vendorƒvent\n");

4787 
»t
 = -
ENOMEM
;

4788 
ex™
;

4792 ià(
	`Æa_put
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_DUMP_DATA
, (
»t
), &ret)) {

4793 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

4794 
	`kä“_skb
(
skb
);

4795 
»t
 = -
EINVAL
;

4796 
ex™
;

4799 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
skb
);

4801 ià(
»t
)

4802 
	`SLSI_ERR
(
sdev
, "V’dÜ Commªd„•ly faed„‘:%d\n", 
»t
);

4805 
ex™
:

4806 
	`kä“
(
mem_dump_bufãr
);

4807 
mem_dump_bufãr
 = 
NULL
;

4808 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4809  
»t
;

4810 
	}
}

4812 
	$¦si_Œigg”_driv”_mem_dump
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

4814 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

4815 
»t
 = 0;

4816 
sk_buff
 *
skb
 = 
NULL
;

4817 
Ëngth
 = 100;

4819 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

4820 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

4822 
»t
 = 
	`scsc_wifi_g‘_driv”_memÜy_dump
(
¦si_Ú_driv”_memÜy_dump
, 
sdev
);

4823 ià(
»t
) {

4824 
	`SLSI_ERR
(
sdev
, "scsc_wifi_g‘_driv”_memÜy_dum°çed : %d\n", 
»t
);

4825 
ex™
;

4829 
skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 
Ëngth
);

4830 ià(!
skb
) {

4831 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb for Vendorƒvent\n");

4832 
»t
 = -
ENOMEM
;

4833 
ex™
;

4836 ià(
	`Æa_put_u32
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_DRIVER_DUMP_LEN
, 
mem_dump_bufãr_size
)) {

4837 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

4838 
	`kä“_skb
(
skb
);

4839 
»t
 = -
EINVAL
;

4840 
ex™
;

4843 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
skb
);

4845 ià(
»t
)

4846 
	`SLSI_ERR
(
sdev
, "V’dÜ Commªd„•ly faed„‘:%d\n", 
»t
);

4848 
ex™
:

4849 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4850  
»t
;

4851 
	}
}

4853 
	$¦si_g‘_driv”_mem_dump
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

4855 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

4856 
»t
 = 0;

4857 
‹mp
 = 0;

4858 
ty³
 = 0;

4859 
buf_Ën
 = 0;

4860 
__u£r
 *
u£r_buf
 = 
NULL
;

4861 cÚ¡ 
Æ©Œ
 *
©Œ
;

4862 
sk_buff
 *
skb
;

4863 
u64
 
v®
 = 0;

4865 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

4866 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

4867 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

4868 
ty³
 = 
	`Æa_ty³
(
©Œ
);

4869 
ty³
) {

4870 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_DRIVER_DUMP_LEN
:

4871 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
buf_Ën
)) {

4872 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4873  -
EINVAL
;

4876 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_DRIVER_DUMP_DATA
:

4877 ià(
	`¦si_ut_Æa_g‘_u64
(
©Œ
, &
v®
)) {

4878 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4879  -
EINVAL
;

4881 
u£r_buf
 = (
__u£r
 *)()(
v®
);

4884 
	`SLSI_ERR
(
sdev
, "UnknowÀty³: %d\n", 
ty³
);

4885 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4886  -
EINVAL
;

4889 ià(
buf_Ën
 > 0 && 
u£r_buf
 && 
mem_dump_bufãr_size
) {

4890 ià(
buf_Ën
 > 
mem_dump_bufãr_size
)

4891 
buf_Ën
 = 
mem_dump_bufãr_size
;

4892 
»t
 = 
	`cİy_to_u£r
(
u£r_buf
, 
mem_dump_bufãr
, 
buf_Ën
);

4893 ià(
»t
) {

4894 
	`SLSI_ERR
(
sdev
, "çedØcİy memdum°štØu£¸bufã¸: %d\n", 
»t
);

4895 
ex™
;

4899 
skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 100);

4900 ià(!
skb
) {

4901 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb for Vendorƒvent\n");

4902 
»t
 = -
ENOMEM
;

4903 
ex™
;

4907 ià(
	`Æa_put
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_DRIVER_DUMP_DATA
, (
»t
), &ret)) {

4908 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

4909 
	`kä“_skb
(
skb
);

4910 
»t
 = -
EINVAL
;

4911 
ex™
;

4914 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
skb
);

4916 ià(
»t
)

4917 
	`SLSI_ERR
(
sdev
, "V’dÜ Commªd„•ly faed„‘:%d\n", 
»t
);

4920 
ex™
:

4921 
	`kä“
(
mem_dump_bufãr
);

4922 
mem_dump_bufãr
 = 
NULL
;

4923 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4924  
»t
;

4925 
	}
}

4927 
	$¦si_g‘_v”siÚ
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

4929 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

4930 
»t
 = 0;

4931 
‹mp
 = 0;

4932 
ty³
 = 0;

4933 
bufãr_size
 = 1024;

4934 
boŞ
 
log_v”siÚ
 = 
çl£
;

4935 *
bufãr
;

4936 cÚ¡ 
Æ©Œ
 *
©Œ
;

4938 
bufãr
 = 
	`kz®loc
(
bufãr_size
, 
GFP_KERNEL
);

4939 ià(!
bufãr
) {

4940 
	`SLSI_ERR
(
sdev
, "NØmem. Size:%d\n", 
bufãr_size
);

4941  -
ENOMEM
;

4943 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

4944 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

4945 
ty³
 = 
	`Æa_ty³
(
©Œ
);

4946 
ty³
) {

4947 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_DRIVER_VERSION
:

4948 
log_v”siÚ
 = 
Œue
;

4950 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_VERSION
:

4951 
log_v”siÚ
 = 
çl£
;

4954 
	`SLSI_ERR
(
sdev
, "UnknowÀty³: %d\n", 
ty³
);

4955 
»t
 = -
EINVAL
;

4956 
ex™
;

4960 ià(
log_v”siÚ
)

4961 
»t
 = 
	`scsc_wifi_g‘_driv”_v”siÚ
(
bufãr
, 
bufãr_size
);

4963 
»t
 = 
	`scsc_wifi_g‘_fœmw¬e_v”siÚ
(
bufãr
, 
bufãr_size
);

4965 ià(
»t
 < 0) {

4966 
	`SLSI_ERR
(
sdev
, "çedØg‘hv”siÚ %d\n", 
»t
);

4967 
ex™
;

4970 
»t
 = 
	`¦si_v’dÜ_cmd_»¶y
(
why
, 
bufãr
, 
	`¡¾’
(buffer));

4971 
ex™
:

4972 
	`kä“
(
bufãr
);

4973 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

4974  
»t
;

4975 
	}
}

4977 
	$¦si_g‘_ršg_bufãrs_¡©us
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

4979 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

4980 
»t
 = 0;

4981 
num_ršgs
 = 
SLSI_MAX_NUM_RING
;

4982 
sk_buff
 *
skb
;

4983 
scsc_wifi_ršg_bufãr_¡©us
 
¡©us
[
SLSI_MAX_NUM_RING
];

4985 
	`SLSI_DBG1
(
sdev
, 
SLSI_GSCAN
, "\n");

4986 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

4987 
	`mem£t
(
¡©us
, 0, (
scsc_wifi_ršg_bufãr_¡©us
è* 
num_ršgs
);

4988 
»t
 = 
	`scsc_wifi_g‘_ršg_bufãrs_¡©us
(&
num_ršgs
, 
¡©us
);

4989 ià(
»t
 < 0) {

4990 
	`SLSI_ERR
(
sdev
, "scsc_wifi_g‘_ršg_bufãrs_¡©u çed„‘:%d\n", 
»t
);

4991 
ex™
;

4995 
skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 700);

4996 ià(!
skb
) {

4997 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb for Vendorƒvent\n");

4998 
»t
 = -
ENOMEM
;

4999 
ex™
;

5003 ià(
	`Æa_put_u8
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_NUM
, 
num_ršgs
) ||

5004 
	`Æa_put
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_STATUS
, (
¡©us
[0]è* 
num_ršgs
, status)) {

5005 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

5006 
	`kä“_skb
(
skb
);

5007 
»t
 = -
EINVAL
;

5008 
ex™
;

5011 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
skb
);

5013 ià(
»t
)

5014 
	`SLSI_ERR
(
sdev
, "V’dÜ Commªd„•ly faed„‘:%d\n", 
»t
);

5015 
ex™
:

5016 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

5017  
»t
;

5018 
	}
}

5020 
	$¦si_g‘_ršg_d©a
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

5022 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5023 
»t
 = 0;

5024 
‹mp
 = 0;

5025 
ty³
 = 0;

5026 
ršg_Çme
[32] = {0};

5027 cÚ¡ 
Æ©Œ
 *
©Œ
;

5029 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

5030 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

5031 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

5032 ià(!
©Œ
) {

5033 
»t
 = -
EINVAL
;

5034 
ex™
;

5036 
ty³
 = 
	`Æa_ty³
(
©Œ
);

5037 
ty³
) {

5038 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_NAME
:

5039 
	`¡ºıy
(
ršg_Çme
, 
	`Æa_d©a
(
©Œ
), 
	`MIN
(Ôšg_Çmeè- 1, 
	`Æa_Ën
(attr)));

5042 
	`SLSI_ERR
(
sdev
, "UnknowÀty³: %d\n", 
ty³
);

5043 
ex™
;

5047 
»t
 = 
	`scsc_wifi_g‘_ršg_d©a
(
ršg_Çme
);

5048 ià(
»t
 < 0)

5049 
	`SLSI_ERR
(
sdev
, "Œigg”_g‘_d©¨çed„‘:%d\n", 
»t
);

5050 
ex™
:

5051 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

5052  
»t
;

5053 
	}
}

5055 
	$¦si_g‘_logg”_suµÜ‹d_ã©u»_£t
(
why
 *why, 
wœ–ess_dev
 *
wdev
,

5056 cÚ¡ *
d©a
, 
Ën
)

5058 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5059 
»t
 = 0;

5060 
u32
 
suµÜ‹d_ã©u»s
 = 0;

5062 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

5063 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

5064 
»t
 = 
	`scsc_wifi_g‘_logg”_suµÜ‹d_ã©u»_£t
(&
suµÜ‹d_ã©u»s
);

5065 ià(
»t
 < 0) {

5066 
	`SLSI_ERR
(
sdev
, "scsc_wifi_g‘_logg”_suµÜ‹d_ã©u»_£ˆçed„‘:%d\n", 
»t
);

5067 
ex™
;

5069 
»t
 = 
	`¦si_v’dÜ_cmd_»¶y
(
why
, &
suµÜ‹d_ã©u»s
, (supported_features));

5070 
ex™
:

5071 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

5072  
»t
;

5073 
	}
}

5075 
	$¦si_¡¬t_pkt_ç‹_mÚ™Üšg
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

5077 
»t
 = 0;

5078 #ifdeà
ENABLE_WIFI_LOGGER_MIB_WRITE


5079 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5080 
¦si_mib_d©a
 
mib_d©a
 = { 0, 
NULL
 };

5082 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

5083 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

5084 
»t
 = 
	`¦si_mib_’code_boŞ
(&
mib_d©a
, 
SLSI_PSID_UNIFI_TX_DATA_CONFIRM
, 1, 0);

5085 ià(
»t
 !ğ
SLSI_MIB_STATUS_SUCCESS
) {

5086 
	`SLSI_ERR
(
sdev
, "Failedo set UnifiTxDataConfirm MIB :‚o mem for MIB\n");

5087 
»t
 = -
ENOMEM
;

5088 
ex™
;

5091 
»t
 = 
	`¦si_mlme_£t
(
sdev
, 
NULL
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

5093 ià(
»t
) {

5094 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg UnifiTxD©aCÚfœm MIB.ƒ¼Ü = %d\n", 
»t
);

5095 
ex™
;

5098 
»t
 = 
	`scsc_wifi_¡¬t_pkt_ç‹_mÚ™Üšg
();

5099 ià(
»t
 < 0) {

5100 
	`SLSI_ERR
(
sdev
, "scsc_wifi_¡¬t_pkt_ç‹_mÚ™Üšg faed,„‘=%d\n", 
»t
);

5103 
mib_d©a
.
d©aL’gth
 = 0;

5104 
mib_d©a
.
d©a
 = 
NULL
;

5105 
»t
 = 
	`¦si_mib_’code_boŞ
(&
mib_d©a
, 
SLSI_PSID_UNIFI_TX_DATA_CONFIRM
, 1, 0);

5106 ià(
»t
 !ğ
SLSI_MIB_STATUS_SUCCESS
) {

5107 
	`SLSI_ERR
(
sdev
, "Failedo set UnifiTxDataConfirm MIB :‚o mem for MIB\n");

5108 
»t
 = -
ENOMEM
;

5109 
ex™
;

5112 
»t
 = 
	`¦si_mlme_£t
(
sdev
, 
NULL
, 
mib_d©a
.
d©a
, mib_d©a.
d©aL’gth
);

5114 ià(
»t
) {

5115 
	`SLSI_ERR
(
sdev
, "E¼ s‘tšg UnifiTxD©aCÚfœm MIB.ƒ¼Ü = %d\n", 
»t
);

5116 
ex™
;

5119 
ex™
:

5120 
	`kä“
(
mib_d©a
.
d©a
);

5121 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

5122  
»t
;

5124 
	`SLSI_ERR_NODEV
("slsi_start_pkt_fate_monitoring : UnifiTxDataConfirm MIB write disabled\n");

5125  
»t
;

5127 
	}
}

5129 
	$¦si_g‘_tx_pkt_ç‹s
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

5131 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5132 
»t
 = 0;

5133 
‹mp
 = 0;

5134 
ty³
 = 0;

5135 
__u£r
 *
u£r_buf
 = 
NULL
;

5136 
u32
 
»q_couÁ
 = 0;

5137 
size_t
 
´ovided_couÁ
 = 0;

5138 
sk_buff
 *
skb
;

5139 cÚ¡ 
Æ©Œ
 *
©Œ
;

5140 
u64
 
v®
 = 0;

5142 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

5143 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

5144 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

5145 
ty³
 = 
	`Æa_ty³
(
©Œ
);

5146 
ty³
) {

5147 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_NUM
:

5148 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
»q_couÁ
)) {

5149 
»t
 = -
EINVAL
;

5150 
ex™
;

5152 ià(
»q_couÁ
 > 
MAX_FATE_LOG_LEN
) {

5153 
	`SLSI_ERR
(
sdev
, "Found inv®id„eq_couÁ %d fÜ SLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_NUM", 
»q_couÁ
);

5154 
»t
 = -
EINVAL
;

5155 
ex™
;

5158 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_DATA
:

5159 ià(
	`¦si_ut_Æa_g‘_u64
(
©Œ
, &
v®
)) {

5160 
»t
 = -
EINVAL
;

5161 
ex™
;

5163 
u£r_buf
 = (
__u£r
 *)()(
v®
);

5166 
	`SLSI_ERR
(
sdev
, "UnknowÀty³: %d\n", 
ty³
);

5167 
»t
 = -
EINVAL
;

5168 
ex™
;

5172 
»t
 = 
	`scsc_wifi_g‘_tx_pkt_ç‹s
(
u£r_buf
, 
»q_couÁ
, &
´ovided_couÁ
, 
Œue
);

5173 ià(
»t
 < 0) {

5174 
	`SLSI_ERR
(
sdev
, "scsc_wifi_g‘_tx_pkt_ç‹ çed„‘: %d\n", 
»t
);

5175 
ex™
;

5179 
skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 200);

5180 ià(!
skb
) {

5181 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb for Vendorƒvent\n");

5182 
»t
 = -
ENOMEM
;

5183 
ex™
;

5186 ià(
	`Æa_put
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_NUM
, (
´ovided_couÁ
), &provided_count)) {

5187 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

5188 
	`kä“_skb
(
skb
);

5189 
»t
 = -
EINVAL
;

5190 
ex™
;

5193 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
skb
);

5195 ià(
»t
)

5196 
	`SLSI_ERR
(
sdev
, "V’dÜ Commªd„•ly faed„‘:%d\n", 
»t
);

5197 
ex™
:

5198 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

5199  
»t
;

5200 
	}
}

5202 
	$¦si_g‘_rx_pkt_ç‹s
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

5204 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5205 
»t
 = 0;

5206 
‹mp
 = 0;

5207 
ty³
 = 0;

5208 
__u£r
 *
u£r_buf
 = 
NULL
;

5209 
u32
 
»q_couÁ
 = 0;

5210 
size_t
 
´ovided_couÁ
 = 0;

5211 
sk_buff
 *
skb
;

5212 cÚ¡ 
Æ©Œ
 *
©Œ
;

5213 
u64
 
v®
 = 0;

5215 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

5216 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

5217 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

5218 
ty³
 = 
	`Æa_ty³
(
©Œ
);

5219 
ty³
) {

5220 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_NUM
:

5221 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &
»q_couÁ
)) {

5222 
»t
 = -
EINVAL
;

5223 
ex™
;

5225 ià(
»q_couÁ
 > 
MAX_FATE_LOG_LEN
) {

5226 
	`SLSI_ERR
(
sdev
, "Found inv®id„eq_couÁ %d fÜ SLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_NUM", 
»q_couÁ
);

5227 
»t
 = -
EINVAL
;

5228 
ex™
;

5231 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_DATA
:

5232 ià(
	`¦si_ut_Æa_g‘_u64
(
©Œ
, &
v®
)) {

5233 
»t
 = -
EINVAL
;

5234 
ex™
;

5236 
u£r_buf
 = (
__u£r
 *)()(
v®
);

5239 
	`SLSI_ERR
(
sdev
, "UnknowÀty³: %d\n", 
ty³
);

5240 
»t
 = -
EINVAL
;

5241 
ex™
;

5245 
»t
 = 
	`scsc_wifi_g‘_rx_pkt_ç‹s
(
u£r_buf
, 
»q_couÁ
, &
´ovided_couÁ
, 
Œue
);

5246 ià(
»t
 < 0) {

5247 
	`SLSI_ERR
(
sdev
, "scsc_wifi_g‘_rx_pkt_ç‹ çed„‘: %d\n", 
»t
);

5248 
ex™
;

5252 
skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 200);

5253 ià(!
skb
) {

5254 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb for Vendorƒvent\n");

5255 
»t
 = -
ENOMEM
;

5256 
ex™
;

5259 ià(
	`Æa_put
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_NUM
, (
´ovided_couÁ
), &provided_count)) {

5260 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

5261 
	`kä“_skb
(
skb
);

5262 
»t
 = -
EINVAL
;

5263 
ex™
;

5266 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
skb
);

5268 ià(
»t
)

5269 
	`SLSI_ERR
(
sdev
, "V’dÜ Commªd„•ly faed„‘:%d\n", 
»t
);

5270 
ex™
:

5271 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

5272  
»t
;

5273 
	}
}

5275 
	$¦si_g‘_wake_»asÚ_¡©s
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

5277 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5278 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

5279 
¦si_wÏn_driv”_wake_»asÚ_út
 
wake_»asÚ_couÁ
;

5280 
»t
 = 0;

5281 
‹mp
 = 0;

5282 
ty³
 = 0;

5283 cÚ¡ 
Æ©Œ
 *
©Œ
;

5284 
sk_buff
 *
skb
;

5286 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

5288 
	`mem£t
(&
wake_»asÚ_couÁ
, 0, (
¦si_wÏn_driv”_wake_»asÚ_út
));

5290 ià(!
dev
) {

5291 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

5292  -
EINVAL
;

5295 
	`¦si_¥šlock_lock
(&
sdev
->
wake_¡©s_lock
);

5296 
wake_»asÚ_couÁ
 = 
sdev
->
wake_»asÚ_¡©s
;

5297 
	`¦si_¥šlock_uÆock
(&
sdev
->
wake_¡©s_lock
);

5298 
	`SLSI_MUTEX_LOCK
(
sdev
->
logg”_mu‹x
);

5299 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

5300 
ty³
 = 
	`Æa_ty³
(
©Œ
);

5301 
ty³
) {

5302 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_CMD_EVENT_WAKE_CNT_SZ
:

5303 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &(
wake_»asÚ_couÁ
.
cmd_ev’t_wake_út_sz
))) {

5304 
»t
 = -
EINVAL
;

5305 
ex™
;

5308 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_DRIVER_FW_LOCAL_WAKE_CNT_SZ
:

5309 ià(
	`¦si_ut_Æa_g‘_u32
(
©Œ
, &(
wake_»asÚ_couÁ
.
driv”_fw_loÿl_wake_út_sz
))) {

5310 
»t
 = -
EINVAL
;

5311 
ex™
;

5315 
	`SLSI_ERR
(
sdev
, "UnknowÀty³: %d\n", 
ty³
);

5316 
»t
 = -
EINVAL
;

5317 
ex™
;

5321 ià(
»t
 < 0) {

5322 
	`SLSI_ERR
(
sdev
, "FaedØg‘ wak»asÚ st : %d\n", 
»t
);

5323 
ex™
;

5327 
skb
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 700);

5328 ià(!
skb
) {

5329 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb for Vendorƒvent\n");

5330 
»t
 = -
ENOMEM
;

5331 
ex™
;

5334 ià(
	`Æa_put_u32
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_TOTAL_CMD_EVENT_WAKE
,

5335 
wake_»asÚ_couÁ
.
tÙ®_cmd_ev’t_wake
)) {

5336 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

5337 
	`kä“_skb
(
skb
);

5338 
»t
 = -
EINVAL
;

5339 
ex™
;

5341 ià(
	`Æa_put
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_CMD_EVENT_WAKE_CNT_PTR
, 0,

5342 
wake_»asÚ_couÁ
.
cmd_ev’t_wake_út
)) {

5343 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

5344 
	`kä“_skb
(
skb
);

5345 
»t
 = -
EINVAL
;

5346 
ex™
;

5348 ià(
	`Æa_put_u32
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_TOTAL_DRIVER_FW_LOCAL_WAKE
,

5349 
wake_»asÚ_couÁ
.
tÙ®_driv”_fw_loÿl_wake
)) {

5350 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

5351 
	`kä“_skb
(
skb
);

5352 
»t
 = -
EINVAL
;

5353 
ex™
;

5355 ià(
	`Æa_put
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_DRIVER_FW_LOCAL_WAKE_CNT_PTR
, 0,

5356 
wake_»asÚ_couÁ
.
driv”_fw_loÿl_wake_út
)) {

5357 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

5358 
	`kä“_skb
(
skb
);

5359 
»t
 = -
EINVAL
;

5360 
ex™
;

5362 ià(
	`Æa_put_u32
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_TOTAL_RX_DATA_WAKE
,

5363 
wake_»asÚ_couÁ
.
tÙ®_rx_d©a_wake
) ||

5364 
	`Æa_put_u32
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_RX_UNICAST_CNT
,

5365 
wake_»asÚ_couÁ
.
rx_wake_d‘as
.
rx_uniÿ¡_út
) ||

5366 
	`Æa_put_u32
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_RX_MULTICAST_CNT
,

5367 
wake_»asÚ_couÁ
.
rx_wake_d‘as
.
rx_muÉiÿ¡_út
) ||

5368 
	`Æa_put_u32
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_RX_BROADCAST_CNT
,

5369 
wake_»asÚ_couÁ
.
rx_wake_d‘as
.
rx_brßdÿ¡_út
) ||

5370 
	`Æa_put_u32
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_ICMP_PKT
,

5371 
wake_»asÚ_couÁ
.
rx_wake_pkt_şassifiÿtiÚ_šfo
.
icmp_pkt
) ||

5372 
	`Æa_put_u32
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_ICMP6_PKT
,

5373 
wake_»asÚ_couÁ
.
rx_wake_pkt_şassifiÿtiÚ_šfo
.
icmp6_pkt
) ||

5374 
	`Æa_put_u32
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_ICMP6_RA
,

5375 
wake_»asÚ_couÁ
.
rx_wake_pkt_şassifiÿtiÚ_šfo
.
icmp6_¿
) ||

5376 
	`Æa_put_u32
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_ICMP6_NA
,

5377 
wake_»asÚ_couÁ
.
rx_wake_pkt_şassifiÿtiÚ_šfo
.
icmp6_Ç
) ||

5378 
	`Æa_put_u32
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_ICMP6_NS
,

5379 
wake_»asÚ_couÁ
.
rx_wake_pkt_şassifiÿtiÚ_šfo
.
icmp6_ns
) ||

5380 
	`Æa_put_u32
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_ICMP4_RX_MULTICAST_CNT
,

5381 
wake_»asÚ_couÁ
.
rx_muÉiÿ¡_wake_pkt_šfo
.
v4_rx_muÉiÿ¡_addr_út
) ||

5382 
	`Æa_put_u32
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_ICMP6_RX_MULTICAST_CNT
,

5383 
wake_»asÚ_couÁ
.
rx_muÉiÿ¡_wake_pkt_šfo
.
v6_rx_muÉiÿ¡_addr_út
) ||

5384 
	`Æa_put_u32
(
skb
, 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_OTHER_RX_MULTICAST_CNT
,

5385 
wake_»asÚ_couÁ
.
rx_muÉiÿ¡_wake_pkt_šfo
.
Ùh”_rx_muÉiÿ¡_addr_út
)) {

5386 
	`SLSI_ERR_NODEV
("Failed‚la_put\n");

5387 
	`kä“_skb
(
skb
);

5388 
»t
 = -
EINVAL
;

5389 
ex™
;

5391 
»t
 = 
	`cfg80211_v’dÜ_cmd_»¶y
(
skb
);

5393 ià(
»t
)

5394 
	`SLSI_ERR
(
sdev
, "V’dÜ Commªd„•ly faed„‘:%d\n", 
»t
);

5395 
ex™
:

5396 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
logg”_mu‹x
);

5397  
»t
;

5398 
	}
}

5402 
	$¦si_acs_v®id©e_width_hw_mode
(
¦si_acs_»que¡
 *
»que¡
)

5404 ià(
»que¡
->
hw_mode
 !ğ
SLSI_ACS_MODE_IEEE80211A
 &&„eque¡->hw_mod!ğ
SLSI_ACS_MODE_IEEE80211B
 &&

5405 
»que¡
->
hw_mode
 !ğ
SLSI_ACS_MODE_IEEE80211G
 &&„eque¡->hw_mod!ğ
SLSI_ACS_MODE_IEEE80211ANY
)

5406  -
EINVAL
;

5407 ià(
»que¡
->
ch_width
 != 20 &&„equest->ch_width != 40 &&„equest->ch_width != 80)

5408  -
EINVAL
;

5410 
	}
}

5412 
	$¦si_acs_š™
(
why
 *wiphy,

5413 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

5415 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5416 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

5417 
Ãtdev_vif
 *
ndev_vif
;

5418 
¦si_acs_»que¡
 *
»que¡
;

5419 
‹mp
;

5420 
ty³
;

5421 cÚ¡ 
Æ©Œ
 *
©Œ
;

5422 
r
 = 0;

5423 
u32
 *
äeq_li¡
 = 
NULL
;

5424 
äeq_li¡_Ën
 = 0;

5426 
	`SLSI_INFO
(
sdev
, "SUBCMD_ACS_INIT Received\n");

5427 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

5428 
	`SLSI_ERR
(
sdev
, "Not supported in WlanLite mode\n");

5429  -
EOPNOTSUPP
;

5431 ià(
wdev
->
iáy³
 !ğ
NL80211_IFTYPE_AP
) {

5432 
	`SLSI_ERR
(
sdev
, "Inv®id iáy³: %d\n", 
wdev
->
iáy³
);

5433  -
EINVAL
;

5435 ià(!
dev
) {

5436 
	`SLSI_ERR
(
sdev
, "Dev‚ot found!\n");

5437  -
ENODEV
;

5439 
»que¡
 = 
	`kÿÎoc
(1, (*»que¡), 
GFP_KERNEL
);

5440 ià(!
»que¡
) {

5441 
	`SLSI_ERR
(
sdev
, "No memory for„equest!");

5442  -
ENOMEM
;

5444 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

5446 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

5447 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

5448 ià(!
©Œ
) {

5449 
	`kä“
(
»que¡
);

5450 
r
 = -
EINVAL
;

5451 
ex™
;

5454 
ty³
 = 
	`Æa_ty³
(
©Œ
);

5456 
ty³
) {

5457 
SLSI_ACS_ATTR_HW_MODE
:

5459 ià(
	`¦si_ut_Æa_g‘_u8
(
©Œ
, &(
»que¡
->
hw_mode
))) {

5460 
	`kä“
(
»que¡
);

5461 
r
 = -
EINVAL
;

5462 
ex™
;

5464 
	`SLSI_INFO
(
sdev
, "ACS hw mode: %d\n", 
»que¡
->
hw_mode
);

5467 
SLSI_ACS_ATTR_CHWIDTH
:

5469 ià(
	`¦si_ut_Æa_g‘_u16
(
©Œ
, &(
»que¡
->
ch_width
))) {

5470 
	`kä“
(
»que¡
);

5471 
r
 = -
EINVAL
;

5472 
ex™
;

5474 
	`SLSI_INFO
(
sdev
, "ACS ch_width: %d\n", 
»que¡
->
ch_width
);

5477 
SLSI_ACS_ATTR_FREQ_LIST
:

5479 ià(
äeq_li¡
)

5482 
äeq_li¡
 = 
	`km®loc
(
	`Æa_Ën
(
©Œ
), 
GFP_KERNEL
);

5483 ià(!
äeq_li¡
) {

5484 
	`SLSI_ERR
(
sdev
, "No memory for frequency†ist!");

5485 
	`kä“
(
»que¡
);

5486 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

5487  -
ENOMEM
;

5489 
	`memıy
(
äeq_li¡
, 
	`Æa_d©a
(
©Œ
), 
	`Æa_Ën
(attr));

5490 
äeq_li¡_Ën
 = 
	`Æa_Ën
(
©Œ
è/ (
u32
);

5491 
	`SLSI_INFO
(
sdev
, "ACS f»q_li¡_Ën: %d\n", 
äeq_li¡_Ën
);

5492 ià(
äeq_li¡_Ën
 > 
MAX_CHAN_VALUE_ACS
)

5493 
äeq_li¡_Ën
 = 
MAX_CHAN_VALUE_ACS
;

5497 ià(
ty³
 > 
SLSI_ACS_ATTR_MAX
)

5498 
	`SLSI_ERR
(
sdev
, "Inv®idy³ : %d\n", 
ty³
);

5503 
r
 = 
	`¦si_acs_v®id©e_width_hw_mode
(
»que¡
);

5504 ià(
r
 =ğ0 && 
äeq_li¡_Ën
) {

5505 
›“80211_chªÃl
 *
chªÃls
[
MAX_CHAN_VALUE_ACS
];

5506 
¦si_acs_chª_šfo
 
ch_šfo
[
MAX_CHAN_VALUE_ACS
];

5507 
¦si_acs_£Ëùed_chªÃls
 
acs_£Ëùed_chªÃls
;

5508 
i
 = 0, 
num_chªÃls
 = 0;

5509 
idx
;

5510 
u32
 
chª_æags
 = (
IEEE80211_CHAN_INDOOR_ONLY
 | 
IEEE80211_CHAN_RADAR
 |

5511 
IEEE80211_CHAN_DISABLED
 | 
IEEE80211_CHAN_NO_IR
);

5513 
	`mem£t
(
chªÃls
, 0, (channels));

5514 
	`mem£t
(&
ch_šfo
, 0, (ch_info));

5515 
i
 = 0; i < 
äeq_li¡_Ën
; i++) {

5516 
chªÃls
[
num_chªÃls
] = 
	`›“80211_g‘_chªÃl
(
why
, 
äeq_li¡
[
i
]);

5517 ià(!
chªÃls
[
num_chªÃls
]) {

5518 
	`SLSI_INFO
(
sdev
, "IgnÜšv®id f»q:%d iÀäeq†i¡\n", 
äeq_li¡
[
i
]);

5519 } ià(
chªÃls
[
num_chªÃls
]->
æags
 & 
chª_æags
) {

5520 
	`SLSI_INFO
(
sdev
, "Sk inv®id chªÃl:%d fÜ ACS\n", 
chªÃls
[
num_chªÃls
]->
hw_v®ue
);

5522 
idx
 = 
	`¦si_fšd_chª_idx
(
chªÃls
[
num_chªÃls
]->
hw_v®ue
, 
»que¡
->
hw_mode
);

5523 ià(
idx
 >ğ0 && idx < 
MAX_CHAN_VALUE_ACS
) {

5524 
ch_šfo
[
idx
].
chª
 = 
chªÃls
[
num_chªÃls
]->
hw_v®ue
;

5525 
num_chªÃls
++;

5530 ià(
num_chªÃls
 == 1) {

5531 
	`mem£t
(&
acs_£Ëùed_chªÃls
, 0, (acs_selected_channels));

5532 
acs_£Ëùed_chªÃls
.
ch_width
 = 20;

5533 
acs_£Ëùed_chªÃls
.
hw_mode
 = 
»que¡
->hw_mode;

5534 
acs_£Ëùed_chªÃls
.
´i_chªÃl
 = 
chªÃls
[0]->
hw_v®ue
;

5535 
r
 = 
	`¦si_£nd_acs_ev’t
(
sdev
, 
acs_£Ëùed_chªÃls
);

5536 
sdev
->
acs_chªÃl_sw™ched
 = 
Œue
;

5537 
	`kä“
(
äeq_li¡
);

5538 
	`kä“
(
»que¡
);

5539 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

5540  
r
;

5543 ià(
»que¡
->
hw_mode
 =ğ
SLSI_ACS_MODE_IEEE80211A
)

5544 
»que¡
->
ch_li¡_Ën
 = 
MAX_5G_CHANNELS
;

5545 ià(
»que¡
->
hw_mode
 =ğ
SLSI_ACS_MODE_IEEE80211B
 ||„eque¡->hw_mod=ğ
SLSI_ACS_MODE_IEEE80211G
)

5546 
»que¡
->
ch_li¡_Ën
 = 
MAX_24G_CHANNELS
;

5548 
»que¡
->
ch_li¡_Ën
 = 
MAX_CHAN_VALUE_ACS
;

5550 
	`memıy
(&
»que¡
->
acs_chª_šfo
[0], &
ch_šfo
[0], (ch_info));

5551 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
 = 
»que¡
;

5552 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
 = 
çl£
;

5553 
r
 = 
	`¦si_mlme_add_sÿn
(
sdev
,

5554 
dev
,

5555 
FAPI_SCANTYPE_AP_AUTO_CHANNEL_SELECTION
,

5556 
FAPI_REPORTMODE_REAL_TIME
,

5558 
NULL
,

5559 
num_chªÃls
,

5560 
chªÃls
,

5561 
NULL
,

5562 
NULL
,

5564 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
);

5566 
	`SLSI_ERR
(
sdev
, "Inv®id f»q_li¡†’:%d o¸ch_width:%d o¸hw_mode:%d\n", 
äeq_li¡_Ën
,

5567 
»que¡
->
ch_width
,„eque¡->
hw_mode
);

5568 
r
 = -
EINVAL
;

5569 
	`kä“
(
»que¡
);

5571 
ex™
:

5572 
	`kä“
(
äeq_li¡
);

5573 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

5574  
r
;

5575 
	}
}

5577 
	$¦si_cÚfigu»_Ï‹ncy_mode
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

5579 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5580 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

5581 
‹mp
 = 0;

5582 
ty³
 = 0;

5583 cÚ¡ 
Æ©Œ
 *
©Œ
;

5584 
»t
 = 0;

5585 
low_Ï‹ncy_mode
 = 0;

5586 
u8
 
v®
 = 0;

5588 ià(!
dev
) {

5589 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

5590  -
EINVAL
;

5593 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

5594 
ty³
 = 
	`Æa_ty³
(
©Œ
);

5595 
ty³
) {

5596 
SLSI_NL_ATTRIBUTE_LATENCY_MODE
:

5597 ià(
	`¦si_ut_Æa_g‘_u8
(
©Œ
, &
v®
)) {

5598 
»t
 = -
EINVAL
;

5599 
ex™
;

5601 
low_Ï‹ncy_mode
 = ()
v®
;

5604 
	`SLSI_ERR_NODEV
("UnknowÀ©Œibu‹: %d\n", 
ty³
);

5605 
»t
 = -
EINVAL
;

5606 
ex™
;

5610 
»t
 = 
	`¦si_£t_Ï‹ncy_mode
(
dev
, 
low_Ï‹ncy_mode
, 
Ën
);

5611 ià(
»t
)

5612 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀ£‰šg†ow†©’cy mod»t:%d\n", 
»t
);

5613 
ex™
:

5614  
»t
;

5615 
	}
}

5617 #ifdeà
CONFIG_SCSC_WLAN_SAR_SUPPORTED


5618 
	$¦si_£Ëù_tx_pow”_sûÇrio
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

5620 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5621 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

5622 
‹mp
 = 0;

5623 
ty³
 = 0;

5624 cÚ¡ 
Æ©Œ
 *
©Œ
;

5625 
»t
 = 0;

5626 
pow”_sûÇrio
 = 0;

5627 
u8
 
v®
 = 0;

5629 ià(!
dev
) {

5630 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

5631  -
EINVAL
;

5634 
	`Æa_fÜ_—ch_©Œ
(
©Œ
, 
d©a
, 
Ën
, 
‹mp
) {

5635 
ty³
 = 
	`Æa_ty³
(
©Œ
);

5636 
ty³
) {

5637 
SLSI_NL_ATTRIBUTE_TX_POWER_SCENARIO
:

5638 ià(
	`¦si_ut_Æa_g‘_u8
(
©Œ
, &
v®
)) {

5639 
»t
 = -
EINVAL
;

5640 
ex™
;

5642 
pow”_sûÇrio
 = ()
v®
;

5645 
	`SLSI_ERR_NODEV
("UnknowÀ©Œibu‹: %d\n", 
ty³
);

5646 
»t
 = -
ENOTSUPP
;

5647 
ex™
;

5650 ià(
pow”_sûÇrio
 < 0 ||…ower_scenario > 4) {

5651 
	`SLSI_ERR_NODEV
("UnknowÀpow”_sûÇrio: %d\n", 
pow”_sûÇrio
);

5652 
»t
 = -
EINVAL
;

5653 
ex™
;

5655 ià(
pow”_sûÇrio
 == 0) {

5656 
	`SLSI_INFO_NODEV
("SAR Scenario 0ƒquivalento 2 (Voice call)\n");

5657 
pow”_sûÇrio
 = 2;

5659 
»t
 = 
	`¦si_cÚfigu»_tx_pow”_§r_sûÇrio
(
dev
, 
pow”_sûÇrio
);

5660 ià(
»t
)

5661 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀ£‰šg SAR…ow” sûÇrio,„‘:%d\n", 
»t
);

5662 
ex™
:

5663  
»t
;

5664 
	}
}

5666 
	$¦si_»£t_tx_pow”_sûÇrio
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

5668 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

5669 
Ãt_deviû
 *
dev
 = 
wdev
->
Ãtdev
;

5670 
»t
 = 0;

5671 
mode
 = -1;

5673 ià(!
dev
) {

5674 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

5675  -
EINVAL
;

5678 
»t
 = 
	`¦si_cÚfigu»_tx_pow”_§r_sûÇrio
(
dev
, 
mode
);

5679 ià(
»t
)

5680 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀ»£ˆSAR…ow” sûÇrio,„‘:%d\n", 
»t
);

5681  
»t
;

5682 
	}
}

5685 cÚ¡ 
Æ80211_v’dÜ_cmd_šfo
 
	g¦si_v’dÜ_ev’ts
[] = {

5687 { 
OUI_GOOGLE
, 
SLSI_NL80211_SIGNIFICANT_CHANGE_EVENT
 },

5688 { 
OUI_GOOGLE
, 
SLSI_NL80211_HOTLIST_AP_FOUND_EVENT
 },

5690 { 
OUI_GOOGLE
, 
SLSI_NL80211_SCAN_RESULTS_AVAILABLE_EVENT
 },

5691 { 
OUI_GOOGLE
, 
SLSI_NL80211_FULL_SCAN_RESULT_EVENT
 },

5692 { 
OUI_GOOGLE
, 
SLSI_NL80211_SCAN_EVENT
 },

5694 { 
OUI_GOOGLE
, 
SLSI_NL80211_HOTLIST_AP_LOST_EVENT
 },

5696 { 
OUI_SAMSUNG
, 
SLSI_NL80211_VENDOR_SUBCMD_KEY_MGMT_ROAM_AUTH
 },

5697 { 
OUI_SAMSUNG
, 
SLSI_NL80211_VENDOR_HANGED_EVENT
 },

5698 { 
OUI_GOOGLE
, 
SLSI_NL80211_EPNO_EVENT
 },

5699 { 
OUI_GOOGLE
, 
SLSI_NL80211_HOTSPOT_MATCH
 },

5700 { 
OUI_GOOGLE
, 
SLSI_NL80211_RSSI_REPORT_EVENT
},

5701 { 
OUI_GOOGLE
, 
SLSI_NL80211_LOGGER_RING_EVENT
},

5702 { 
OUI_GOOGLE
, 
SLSI_NL80211_LOGGER_FW_DUMP_EVENT
},

5703 { 
OUI_GOOGLE
, 
SLSI_NL80211_NAN_RESPONSE_EVENT
},

5704 { 
OUI_GOOGLE
, 
SLSI_NL80211_NAN_PUBLISH_TERMINATED_EVENT
},

5705 { 
OUI_GOOGLE
, 
SLSI_NL80211_NAN_MATCH_EVENT
},

5706 { 
OUI_GOOGLE
, 
SLSI_NL80211_NAN_MATCH_EXPIRED_EVENT
},

5707 { 
OUI_GOOGLE
, 
SLSI_NL80211_NAN_SUBSCRIBE_TERMINATED_EVENT
},

5708 { 
OUI_GOOGLE
, 
SLSI_NL80211_NAN_FOLLOWUP_EVENT
},

5709 { 
OUI_GOOGLE
, 
SLSI_NL80211_NAN_DISCOVERY_ENGINE_EVENT
},

5710 { 
OUI_GOOGLE
, 
SLSI_NL80211_NAN_DISABLED_EVENT
},

5711 { 
OUI_GOOGLE
, 
SLSI_NL80211_RTT_RESULT_EVENT
},

5712 { 
OUI_GOOGLE
, 
SLSI_NL80211_RTT_COMPLETE_EVENT
},

5713 { 
OUI_SAMSUNG
, 
SLSI_NL80211_VENDOR_ACS_EVENT
},

5714 { 
OUI_SAMSUNG
, 
SLSI_NL80211_VENDOR_FORWARD_BEACON
},

5715 { 
OUI_SAMSUNG
, 
SLSI_NL80211_VENDOR_FORWARD_BEACON_ABORT
},

5716 { 
OUI_GOOGLE
, 
SLSI_NL80211_NAN_TRANSMIT_FOLLOWUP_STATUS
},

5717 { 
OUI_GOOGLE
, 
SLSI_NAN_EVENT_NDP_REQ
},

5718 { 
OUI_GOOGLE
, 
SLSI_NAN_EVENT_NDP_CFM
},

5719 { 
OUI_GOOGLE
, 
SLSI_NAN_EVENT_NDP_END
},

5720 { 
OUI_SAMSUNG
, 
SLSI_NL80211_VENDOR_RCL_CHANNEL_LIST_EVENT
},

5721 { 
OUI_SAMSUNG
, 
SLSI_NL80211_VENDOR_POWER_MEASUREMENT_EVENT
}

5724 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 3, 0))

5725 cÚ¡ 
Æa_pŞicy
 
	g¦si_no_pŞicy
[2] = {0};

5727 cÚ¡ 
Æa_pŞicy


5728 
	g¦si_wÏn_v’dÜ_acs_pŞicy
[
SLSI_ACS_ATTR_MAX
 + 1] = {

5729 [
SLSI_ACS_ATTR_HW_MODE
] = {.
ty³
 = 
NLA_U8
},

5730 [
SLSI_ACS_ATTR_HT_ENABLED
] = {.
ty³
 = 
NLA_FLAG
},

5731 [
SLSI_ACS_ATTR_HT40_ENABLED
] = {.
ty³
 = 
NLA_FLAG
},

5732 [
SLSI_ACS_ATTR_VHT_ENABLED
] = {.
ty³
 = 
NLA_FLAG
 },

5733 [
SLSI_ACS_ATTR_CHWIDTH
] = {.
ty³
 = 
NLA_U16
},

5734 [
SLSI_ACS_ATTR_FREQ_LIST
] = {.
ty³
 = 
NLA_BINARY
,

5735 .
	gËn
 = (
MAX_CHAN_VALUE_ACS
 * (
u32
)) },

5738 cÚ¡ 
Æa_pŞicy


5739 
	g¦si_wÏn_v’dÜ_deçuÉ_sÿn_pŞicy
[
SLSI_SCAN_DEFAULT_MAX
 + 1] = {

5740 [
SLSI_SCAN_DEFAULT_IE_LEN
] = {.
ty³
 = 
NLA_U32
},

5741 [
SLSI_SCAN_DEFAULT_IES
] = {.
ty³
 = 
NLA_BINARY
},

5744 cÚ¡ 
Æa_pŞicy


5745 
	g¦si_wÏn_v’dÜ_Îs_pŞicy
[
LLS_ATTRIBUTE_MAX
 + 1] = {

5746 [
LLS_ATTRIBUTE_SET_MPDU_SIZE_THRESHOLD
] = {.
ty³
 = 
NLA_U32
},

5747 [
LLS_ATTRIBUTE_SET_AGGR_STATISTICS_GATHERING
] = {.
ty³
 = 
NLA_U32
},

5748 [
LLS_ATTRIBUTE_CLEAR_STOP_REQUEST_MASK
] = {.
ty³
 = 
NLA_U32
},

5749 [
LLS_ATTRIBUTE_CLEAR_STOP_REQUEST
] = {.
ty³
 = 
NLA_U32
},

5752 cÚ¡ 
Æa_pŞicy


5753 
	g¦si_wÏn_v’dÜ_¡¬t_k“·live_ofæßd_pŞicy
[
MKEEP_ALIVE_ATTRIBUTE_MAX
 + 1] = {

5754 [
MKEEP_ALIVE_ATTRIBUTE_ID
] = {.
ty³
 = 
NLA_U8
},

5755 [
MKEEP_ALIVE_ATTRIBUTE_IP_PKT
] = {.
ty³
 = 
NLA_BINARY
},

5756 [
MKEEP_ALIVE_ATTRIBUTE_IP_PKT_LEN
] = {.
ty³
 = 
NLA_U16
},

5757 [
MKEEP_ALIVE_ATTRIBUTE_PERIOD_MSEC
] = {.
ty³
 = 
NLA_U32
},

5758 [
MKEEP_ALIVE_ATTRIBUTE_DST_MAC_ADDR
] = {.
ty³
 = 
NLA_BINARY
,

5759 .
	gËn
 = 
ETH_ALEN
},

5760 [
MKEEP_ALIVE_ATTRIBUTE_SRC_MAC_ADDR
] = {.
ty³
 = 
NLA_BINARY
,

5761 .
	gËn
 = 
ETH_ALEN
},

5764 cÚ¡ 
Æa_pŞicy


5765 
	g¦si_wÏn_v’dÜ_low_Ï‹ncy_pŞicy
[
SLSI_NL_ATTRIBUTE_LATENCY_MAX
 + 1] = {

5766 [
SLSI_NL_ATTRIBUTE_LATENCY_MODE
] = {.
ty³
 = 
NLA_U8
},

5769 #ifdeà
CONFIG_SCSC_WLAN_SAR_SUPPORTED


5770 cÚ¡ 
Æa_pŞicy


5771 
	g¦si_wÏn_v’dÜ_tx_pow”_sûÇrio_pŞicy
[
SLSI_NL_ATTRIBUTE_TX_POWER_SCENARIO_MAX
 + 1] = {

5772 [
SLSI_NL_ATTRIBUTE_TX_POWER_SCENARIO
] = {.
ty³
 = 
NLA_U8
},

5776 cÚ¡ 
Æa_pŞicy


5777 
	g¦si_wÏn_v’dÜ_couÁry_code_pŞicy
[
SLSI_NL_ATTRIBUTE_COUNTRY_CODE_MAX
 + 1] = {

5778 [
SLSI_NL_ATTRIBUTE_COUNTRY_CODE
] = {.
ty³
 = 
NLA_BINARY
},

5781 cÚ¡ 
Æa_pŞicy


5782 
	g¦si_wÏn_v’dÜ_rßm_¡©e_pŞicy
[
SLSI_NL_ATTR_ROAM_MAX
 + 1] = {

5783 [
SLSI_NL_ATTR_ROAM_STATE
] = {.
ty³
 = 
NLA_U8
},

5786 cÚ¡ 
Æa_pŞicy


5787 
	g¦si_wÏn_v’dÜ_rssi_mÚ™Ü
[
SLSI_RSSI_MONITOR_ATTRIBUTE_MAX
 + 1] = {

5788 [
SLSI_RSSI_MONITOR_ATTRIBUTE_START
] = {.
ty³
 = 
NLA_U8
},

5789 [
SLSI_RSSI_MONITOR_ATTRIBUTE_MIN_RSSI
] = {.
ty³
 = 
NLA_S8
},

5790 [
SLSI_RSSI_MONITOR_ATTRIBUTE_MAX_RSSI
] = {.
ty³
 = 
NLA_S8
},

5793 cÚ¡ 
Æa_pŞicy


5794 
	g¦si_wÏn_v’dÜ_¹t_pŞicy
[
SLSI_RTT_ATTRIBUTE_MAX
 + 1] = {

5795 [
SLSI_RTT_ATTRIBUTE_TARGET_CNT
] = {.
ty³
 = 
NLA_U8
},

5796 [
SLSI_RTT_ATTRIBUTE_TARGET_ID
] = {.
ty³
 = 
NLA_U16
},

5797 [
SLSI_RTT_ATTRIBUTE_TARGET_INFO
] = {.
ty³
 = 
NLA_NESTED_ARRAY
,

5798 .
	gËn
 = 
SLSI_RTT_ATTRIBUTE_MAX
,

5799 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

5800 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_¹t_pŞicy
},

5804 [
SLSI_RTT_ATTRIBUTE_TARGET_MAC
] = {.
ty³
 = 
NLA_BINARY
},

5805 [
SLSI_RTT_ATTRIBUTE_TARGET_TYPE
] = {.
ty³
 = 
NLA_U8
},

5806 [
SLSI_RTT_ATTRIBUTE_TARGET_PEER
] = {.
ty³
 = 
NLA_U8
},

5807 [
SLSI_RTT_ATTRIBUTE_TARGET_CHAN_FREQ
] = {.
ty³
 = 
NLA_U16
},

5808 [
SLSI_RTT_ATTRIBUTE_TARGET_PERIOD
] = {.
ty³
 = 
NLA_U8
},

5809 [
SLSI_RTT_ATTRIBUTE_TARGET_NUM_BURST
] = {.
ty³
 = 
NLA_U8
},

5810 [
SLSI_RTT_ATTRIBUTE_TARGET_NUM_FTM_BURST
] = {.
ty³
 = 
NLA_U8
},

5811 [
SLSI_RTT_ATTRIBUTE_TARGET_NUM_RETRY_FTM
] = {.
ty³
 = 
NLA_U8
},

5812 [
SLSI_RTT_ATTRIBUTE_TARGET_NUM_RETRY_FTMR
] = {.
ty³
 = 
NLA_U8
},

5813 [
SLSI_RTT_ATTRIBUTE_TARGET_BURST_DURATION
] = {.
ty³
 = 
NLA_U8
},

5814 [
SLSI_RTT_ATTRIBUTE_TARGET_PREAMBLE
] = {.
ty³
 = 
NLA_U16
},

5815 [
SLSI_RTT_ATTRIBUTE_TARGET_BW
] = {.
ty³
 = 
NLA_U16
},

5816 [
SLSI_RTT_ATTRIBUTE_TARGET_LCI
] = {.
ty³
 = 
NLA_U16
},

5817 [
SLSI_RTT_ATTRIBUTE_TARGET_LCR
] = {.
ty³
 = 
NLA_U16
},

5820 cÚ¡ 
Æa_pŞicy


5821 
	g¦si_wÏn_v’dÜ_­f_f‹r_pŞicy
[
SLSI_APF_ATTR_MAX
 + 1] = {

5822 [
SLSI_APF_ATTR_PROGRAM_LEN
] = {.
ty³
 = 
NLA_U32
},

5823 [
SLSI_APF_ATTR_PROGRAM
] = {.
ty³
 = 
NLA_BINARY
},

5826 cÚ¡ 
Æa_pŞicy


5827 
	g¦si_wÏn_v’dÜ_gsÿn_pŞicy
[
GSCAN_ATTRIBUTE_MAX
] = {

5828 [
GSCAN_ATTRIBUTE_NUM_BUCKETS
] = {.
ty³
 = 
NLA_U32
},

5829 [
GSCAN_ATTRIBUTE_BASE_PERIOD
] = {.
ty³
 = 
NLA_U32
},

5830 [
GSCAN_ATTRIBUTE_BUCKETS_BAND
] = {.
ty³
 = 
NLA_U32
},

5831 [
GSCAN_ATTRIBUTE_BUCKET_ID
] = {.
ty³
 = 
NLA_U32
},

5832 [
GSCAN_ATTRIBUTE_BUCKET_PERIOD
] = {.
ty³
 = 
NLA_U32
},

5833 [
GSCAN_ATTRIBUTE_BUCKET_NUM_CHANNELS
] = {.
ty³
 = 
NLA_U32
},

5834 [
GSCAN_ATTRIBUTE_BUCKET_CHANNELS
] = {.
ty³
 = 
NLA_NESTED
},

5835 [
GSCAN_ATTRIBUTE_NUM_AP_PER_SCAN
] = {.
ty³
 = 
NLA_U32
},

5836 [
GSCAN_ATTRIBUTE_REPORT_THRESHOLD
] = {.
ty³
 = 
NLA_U32
},

5837 [
GSCAN_ATTRIBUTE_REPORT_THRESHOLD_NUM_SCANS
] = {.
ty³
 = 
NLA_U32
},

5838 [
GSCAN_ATTRIBUTE_BUCKETS_BAND
] = {.
ty³
 = 
NLA_U32
},

5839 [
GSCAN_ATTRIBUTE_REPORT_EVENTS
] = {.
ty³
 = 
NLA_U32
},

5840 [
GSCAN_ATTRIBUTE_BUCKET_EXPONENT
] = {.
ty³
 = 
NLA_U32
},

5841 [
GSCAN_ATTRIBUTE_BUCKET_STEP_COUNT
] = {.
ty³
 = 
NLA_U32
},

5842 [
GSCAN_ATTRIBUTE_BUCKET_MAX_PERIOD
] = {.
ty³
 = 
NLA_U32
},

5843 [
GSCAN_ATTRIBUTE_CH_BUCKET_1
] = {.
ty³
 = 
NLA_NESTED
,

5844 .
	gËn
 = 
GSCAN_ATTRIBUTE_MAX
,

5845 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

5846 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_gsÿn_pŞicy
},

5850 [
GSCAN_ATTRIBUTE_CH_BUCKET_2
] = {.
ty³
 = 
NLA_NESTED
,

5851 .
	gËn
 = 
GSCAN_ATTRIBUTE_MAX
,

5852 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

5853 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_gsÿn_pŞicy
},

5857 [
GSCAN_ATTRIBUTE_CH_BUCKET_3
] = {.
ty³
 = 
NLA_NESTED
,

5858 .
	gËn
 = 
GSCAN_ATTRIBUTE_MAX
,

5859 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

5860 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_gsÿn_pŞicy
},

5864 [
GSCAN_ATTRIBUTE_CH_BUCKET_4
] = {.
ty³
 = 
NLA_NESTED
,

5865 .
	gËn
 = 
GSCAN_ATTRIBUTE_MAX
,

5866 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

5867 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_gsÿn_pŞicy
},

5871 [
GSCAN_ATTRIBUTE_CH_BUCKET_5
] = {.
ty³
 = 
NLA_NESTED
,

5872 .
	gËn
 = 
GSCAN_ATTRIBUTE_MAX
,

5873 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

5874 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_gsÿn_pŞicy
},

5878 [
GSCAN_ATTRIBUTE_CH_BUCKET_6
] = {.
ty³
 = 
NLA_NESTED
,

5879 .
	gËn
 = 
GSCAN_ATTRIBUTE_MAX
,

5880 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

5881 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_gsÿn_pŞicy
},

5885 [
GSCAN_ATTRIBUTE_CH_BUCKET_7
] = {.
ty³
 = 
NLA_NESTED
,

5886 .
	gËn
 = 
GSCAN_ATTRIBUTE_MAX
,

5887 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

5888 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_gsÿn_pŞicy
},

5892 [
GSCAN_ATTRIBUTE_CH_BUCKET_8
] = {.
ty³
 = 
NLA_NESTED
,

5893 .
	gËn
 = 
GSCAN_ATTRIBUTE_MAX
,

5894 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

5895 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_gsÿn_pŞicy
},

5899 [
GSCAN_ATTRIBUTE_NUM_OF_RESULTS
] = {.
ty³
 = 
NLA_U32
},

5900 [
GSCAN_ATTRIBUTE_NUM_BSSID
] = {.
ty³
 = 
NLA_U32
},

5901 [
GSCAN_ATTRIBUTE_BLACKLIST_BSSID
] = {.
ty³
 = 
NLA_BINARY
},

5902 [
GSCAN_ATTRIBUTE_BLACKLIST_FROM_SUPPLICANT
] = {.
ty³
 = 
NLA_U8
},

5905 cÚ¡ 
Æa_pŞicy


5906 
	g¦si_wÏn_v’dÜ_gsÿn_oui_pŞicy
[
SLSI_NL_ATTRIBUTE_MAC_OUI_MAX
] = {

5907 [
SLSI_NL_ATTRIBUTE_ND_OFFLOAD_VALUE
] = {.
ty³
 = 
NLA_U8
},

5908 [
SLSI_NL_ATTRIBUTE_PNO_RANDOM_MAC_OUI
] = {.
ty³
 = 
NLA_BINARY
},

5911 cÚ¡ 
Æa_pŞicy


5912 
	g¦si_wÏn_v’dÜ_•no_pŞicy
[
SLSI_ATTRIBUTE_EPNO_MAX
] = {

5913 [
SLSI_ATTRIBUTE_EPNO_MINIMUM_5G_RSSI
] = {.
ty³
 = 
NLA_U16
},

5914 [
SLSI_ATTRIBUTE_EPNO_MINIMUM_2G_RSSI
] = {.
ty³
 = 
NLA_U16
},

5915 [
SLSI_ATTRIBUTE_EPNO_INITIAL_SCORE_MAX
] = {.
ty³
 = 
NLA_U16
},

5916 [
SLSI_ATTRIBUTE_EPNO_CUR_CONN_BONUS
] = {.
ty³
 = 
NLA_U8
},

5917 [
SLSI_ATTRIBUTE_EPNO_SAME_NETWORK_BONUS
] = {.
ty³
 = 
NLA_U8
},

5918 [
SLSI_ATTRIBUTE_EPNO_SECURE_BONUS
] = {.
ty³
 = 
NLA_U8
},

5919 [
SLSI_ATTRIBUTE_EPNO_5G_BONUS
] = {.
ty³
 = 
NLA_U8
},

5920 [
SLSI_ATTRIBUTE_EPNO_SSID_LIST
] = {.
ty³
 = 
NLA_NESTED
},

5921 [
SLSI_ATTRIBUTE_EPNO_SSID_NUM
] = {.
ty³
 = 
NLA_U8
},

5924 cÚ¡ 
Æa_pŞicy


5925 
	g¦si_wÏn_v’dÜ_•no_hs_pŞicy
[
SLSI_ATTRIBUTE_EPNO_HS_MAX
] = {

5926 [
SLSI_ATTRIBUTE_EPNO_HS_PARAM_LIST
] = {.
ty³
 = 
NLA_NESTED_ARRAY
,

5927 .
	gËn
 = 
SLSI_ATTRIBUTE_EPNO_HS_MAX
,

5928 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

5929 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_•no_hs_pŞicy
},

5933 [
SLSI_ATTRIBUTE_EPNO_HS_NUM
] = {.
ty³
 = 
NLA_U8
},

5934 [
SLSI_ATTRIBUTE_EPNO_HS_ID
] = {.
ty³
 = 
NLA_U32
},

5935 [
SLSI_ATTRIBUTE_EPNO_HS_REALM
] = {.
ty³
 = 
NLA_BINARY
},

5936 [
SLSI_ATTRIBUTE_EPNO_HS_CONSORTIUM_IDS
] = {.
ty³
 = 
NLA_BINARY
},

5937 [
SLSI_ATTRIBUTE_EPNO_HS_PLMN
] = {.
ty³
 = 
NLA_BINARY
},

5940 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_LOGGING


5941 cÚ¡ 
Æa_pŞicy


5942 
	g¦si_wÏn_v’dÜ_’hªûd_loggšg_pŞicy
[
SLSI_ENHANCED_LOGGING_ATTRIBUTE_MAX
] = {

5943 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_NAME
] = {.
ty³
 = 
NLA_BINARY
},

5944 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_VERBOSE_LEVEL
] = {.
ty³
 = 
NLA_U32
},

5945 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_FLAGS
] = {.
ty³
 = 
NLA_U32
},

5946 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_LOG_MAX_INTERVAL
] = {.
ty³
 = 
NLA_U32
},

5947 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_LOG_MIN_DATA_SIZE
] = {.
ty³
 = 
NLA_U32
},

5948 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_DUMP_LEN
] = {.
ty³
 = 
NLA_U32
},

5949 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_DUMP_DATA
] = {.
ty³
 = 
NLA_U64
},

5950 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_DRIVER_DUMP_LEN
] = {.
ty³
 = 
NLA_U32
},

5951 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_DRIVER_DUMP_DATA
] = {.
ty³
 = 
NLA_U64
},

5952 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_DRIVER_VERSION
] = {.
ty³
 = 
NLA_BINARY
},

5953 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_VERSION
] = {.
ty³
 = 
NLA_BINARY
},

5954 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_NUM
] = {.
ty³
 = 
NLA_U32
},

5955 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_DATA
] = {.
ty³
 = 
NLA_U64
},

5958 cÚ¡ 
Æa_pŞicy


5959 
	g¦si_wÏn_v’dÜ_wake_»asÚ_¡©s_pŞicy
[
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_MAX
] = {

5960 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_CMD_EVENT_WAKE_CNT_SZ
] = {.
ty³
 = 
NLA_U32
},

5961 [
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_DRIVER_FW_LOCAL_WAKE_CNT_SZ
] = {.
ty³
 = 
NLA_U32
},

5965 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


5966 cÚ¡ 
Æa_pŞicy


5967 
	g¦si_wÏn_v’dÜ_Çn_pŞicy
[
NAN_REQ_ATTR_MAX
 + 1] = {

5968 [
NAN_REQ_ATTR_MASTER_PREF
] = {.
ty³
 = 
NLA_U8
},

5969 [
NAN_REQ_ATTR_CLUSTER_LOW
] = {.
ty³
 = 
NLA_U16
},

5970 [
NAN_REQ_ATTR_CLUSTER_HIGH
] = {.
ty³
 = 
NLA_U16
},

5971 [
NAN_REQ_ATTR_HOP_COUNT_LIMIT_VAL
] = {.
ty³
 = 
NLA_U8
},

5972 [
NAN_REQ_ATTR_SID_BEACON_VAL
] = {.
ty³
 = 
NLA_U8
},

5973 [
NAN_REQ_ATTR_SUPPORT_2G4_VAL
] = {.
ty³
 = 
NLA_U8
},

5974 [
NAN_REQ_ATTR_SUPPORT_5G_VAL
] = {.
ty³
 = 
NLA_U8
},

5975 [
NAN_REQ_ATTR_RSSI_CLOSE_2G4_VAL
] = {.
ty³
 = 
NLA_U8
},

5976 [
NAN_REQ_ATTR_RSSI_MIDDLE_2G4_VAL
] = {.
ty³
 = 
NLA_U8
},

5977 [
NAN_REQ_ATTR_RSSI_PROXIMITY_2G4_VAL
] = {.
ty³
 = 
NLA_U8
},

5978 [
NAN_REQ_ATTR_BEACONS_2G4_VAL
] = {.
ty³
 = 
NLA_U8
},

5979 [
NAN_REQ_ATTR_SDF_2G4_VAL
] = {.
ty³
 = 
NLA_U8
},

5980 [
NAN_REQ_ATTR_CHANNEL_2G4_MHZ_VAL
] = {.
ty³
 = 
NLA_U32
},

5981 [
NAN_REQ_ATTR_RSSI_PROXIMITY_VAL
] = {.
ty³
 = 
NLA_U32
},

5982 [
NAN_REQ_ATTR_RSSI_CLOSE_5G_VAL
] = {.
ty³
 = 
NLA_U8
},

5983 [
NAN_REQ_ATTR_RSSI_CLOSE_PROXIMITY_5G_VAL
] = {.
ty³
 = 
NLA_U8
},

5984 [
NAN_REQ_ATTR_RSSI_MIDDLE_5G_VAL
] = {.
ty³
 = 
NLA_U8
},

5985 [
NAN_REQ_ATTR_RSSI_PROXIMITY_5G_VAL
] = {.
ty³
 = 
NLA_U32
},

5986 [
NAN_REQ_ATTR_BEACON_5G_VAL
] = {.
ty³
 = 
NLA_U8
},

5987 [
NAN_REQ_ATTR_SDF_5G_VAL
] = {.
ty³
 = 
NLA_U8
},

5988 [
NAN_REQ_ATTR_CHANNEL_5G_MHZ_VAL
] = {.
ty³
 = 
NLA_U32
},

5989 [
NAN_REQ_ATTR_RSSI_WINDOW_SIZE_VAL
] = {.
ty³
 = 
NLA_U8
},

5990 [
NAN_REQ_ATTR_OUI_VAL
] = {.
ty³
 = 
NLA_U32
},

5991 [
NAN_REQ_ATTR_MAC_ADDR_VAL
] = {.
ty³
 = 
NLA_BINARY
,

5992 .
	gËn
 = 
ETH_ALEN
},

5993 [
NAN_REQ_ATTR_CLUSTER_VAL
] = {.
ty³
 = 
NLA_U8
},

5994 [
NAN_REQ_ATTR_SOCIAL_CH_SCAN_DWELL_TIME
] = {.
ty³
 = 
NLA_BINARY
,

5995 .
	gËn
 = 
SLSI_HAL_NAN_MAX_SOCIAL_CHANNELS
},

5996 [
NAN_REQ_ATTR_SOCIAL_CH_SCAN_PERIOD
] = {.
ty³
 = 
NLA_BINARY
,

5997 .
	gËn
 = 
SLSI_HAL_NAN_MAX_SOCIAL_CHANNELS
 * (
u16
)},

5998 [
NAN_REQ_ATTR_RANDOM_FACTOR_FORCE_VAL
] = {.
ty³
 = 
NLA_U8
},

5999 [
NAN_REQ_ATTR_HOP_COUNT_FORCE_VAL
] = {.
ty³
 = 
NLA_U8
},

6000 [
NAN_REQ_ATTR_CONN_CAPABILITY_PAYLOAD_TX
] = {.
ty³
 = 
NLA_U8
},

6001 [
NAN_REQ_ATTR_CONN_CAPABILITY_IBSS
] = {.
ty³
 = 
NLA_U8
},

6002 [
NAN_REQ_ATTR_CONN_CAPABILITY_WFD
] = {.
ty³
 = 
NLA_U8
},

6003 [
NAN_REQ_ATTR_CONN_CAPABILITY_WFDS
] = {.
ty³
 = 
NLA_U8
},

6004 [
NAN_REQ_ATTR_CONN_CAPABILITY_TDLS
] = {.
ty³
 = 
NLA_U8
},

6005 [
NAN_REQ_ATTR_CONN_CAPABILITY_MESH
] = {.
ty³
 = 
NLA_U8
},

6006 [
NAN_REQ_ATTR_CONN_CAPABILITY_WLAN_INFRA
] = {.
ty³
 = 
NLA_U8
},

6007 [
NAN_REQ_ATTR_DISCOVERY_ATTR_NUM_ENTRIES
] = {.
ty³
 = 
NLA_U8
},

6008 [
NAN_REQ_ATTR_DISCOVERY_ATTR_VAL
] = {.
ty³
 = 
NLA_NESTED
,

6009 .
	gËn
 = 
NAN_REQ_ATTR_MAX
,

6010 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

6011 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_Çn_pŞicy
},

6015 [
NAN_REQ_ATTR_CONN_TYPE
] = {.
ty³
 = 
NLA_U8
},

6016 [
NAN_REQ_ATTR_NAN_ROLE
] = {.
ty³
 = 
NLA_U8
},

6017 [
NAN_REQ_ATTR_TRANSMIT_FREQ
] = {.
ty³
 = 
NLA_U8
},

6018 [
NAN_REQ_ATTR_AVAILABILITY_DURATION
] = {.
ty³
 = 
NLA_U8
},

6019 [
NAN_REQ_ATTR_AVAILABILITY_INTERVAL
] = {.
ty³
 = 
NLA_U32
},

6020 [
NAN_REQ_ATTR_MESH_ID_LEN
] = {.
ty³
 = 
NLA_U16
},

6021 [
NAN_REQ_ATTR_MESH_ID
] = {.
ty³
 = 
NLA_BINARY
},

6022 [
NAN_REQ_ATTR_INFRASTRUCTURE_SSID_LEN
] = {.
ty³
 = 
NLA_U16
},

6023 [
NAN_REQ_ATTR_INFRASTRUCTURE_SSID
] = {.
ty³
 = 
NLA_BINARY
},

6024 [
NAN_REQ_ATTR_FURTHER_AVAIL_NUM_ENTRIES
] = {.
ty³
 = 
NLA_U8
},

6025 [
NAN_REQ_ATTR_FURTHER_AVAIL_VAL
] = {.
ty³
 = 
NLA_NESTED
,

6026 .
	gËn
 = 
NAN_REQ_ATTR_MAX
,

6027 #ià(
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(5, 8, 0))

6028 .
	gv®id©iÚ_d©a
 = 
¦si_wÏn_v’dÜ_Çn_pŞicy
},

6032 [
NAN_REQ_ATTR_FURTHER_AVAIL_ENTRY_CTRL
] = {.
ty³
 = 
NLA_U8
},

6033 [
NAN_REQ_ATTR_FURTHER_AVAIL_CHAN_CLASS
] = {.
ty³
 = 
NLA_U8
},

6034 [
NAN_REQ_ATTR_FURTHER_AVAIL_CHAN
] = {.
ty³
 = 
NLA_U8
},

6035 [
NAN_REQ_ATTR_FURTHER_AVAIL_CHAN_MAPID
] = {.
ty³
 = 
NLA_U8
},

6036 [
NAN_REQ_ATTR_FURTHER_AVAIL_INTERVAL_BITMAP
] = {.
ty³
 = 
NLA_U32
},

6037 [
NAN_REQ_ATTR_PUBLISH_ID
] = {.
ty³
 = 
NLA_U16
},

6038 [
NAN_REQ_ATTR_PUBLISH_TTL
] = {.
ty³
 = 
NLA_U16
},

6039 [
NAN_REQ_ATTR_PUBLISH_PERIOD
] = {.
ty³
 = 
NLA_U16
},

6040 [
NAN_REQ_ATTR_PUBLISH_TYPE
] = {.
ty³
 = 
NLA_U8
},

6041 [
NAN_REQ_ATTR_PUBLISH_TX_TYPE
] = {.
ty³
 = 
NLA_U8
},

6042 [
NAN_REQ_ATTR_PUBLISH_COUNT
] = {.
ty³
 = 
NLA_U8
},

6043 [
NAN_REQ_ATTR_PUBLISH_SERVICE_NAME_LEN
] = {.
ty³
 = 
NLA_U16
},

6044 [
NAN_REQ_ATTR_PUBLISH_SERVICE_NAME
] = {.
ty³
 = 
NLA_BINARY
},

6045 [
NAN_REQ_ATTR_PUBLISH_MATCH_ALGO
] = {.
ty³
 = 
NLA_U8
},

6046 [
NAN_REQ_ATTR_PUBLISH_SERVICE_INFO_LEN
] = {.
ty³
 = 
NLA_U16
},

6047 [
NAN_REQ_ATTR_PUBLISH_SERVICE_INFO
] = {.
ty³
 = 
NLA_BINARY
},

6048 [
NAN_REQ_ATTR_PUBLISH_RX_MATCH_FILTER_LEN
] = {.
ty³
 = 
NLA_U16
},

6049 [
NAN_REQ_ATTR_PUBLISH_RX_MATCH_FILTER
] = {.
ty³
 = 
NLA_BINARY
},

6050 [
NAN_REQ_ATTR_PUBLISH_TX_MATCH_FILTER_LEN
] = {.
ty³
 = 
NLA_U16
},

6051 [
NAN_REQ_ATTR_PUBLISH_TX_MATCH_FILTER
] = {.
ty³
 = 
NLA_BINARY
},

6052 [
NAN_REQ_ATTR_PUBLISH_RSSI_THRESHOLD_FLAG
] = {.
ty³
 = 
NLA_U8
},

6053 [
NAN_REQ_ATTR_PUBLISH_CONN_MAP
] = {.
ty³
 = 
NLA_U8
},

6054 [
NAN_REQ_ATTR_PUBLISH_RECV_IND_CFG
] = {.
ty³
 = 
NLA_U8
},

6055 [
NAN_REQ_ATTR_SUBSCRIBE_ID
] = {.
ty³
 = 
NLA_U16
},

6056 [
NAN_REQ_ATTR_SUBSCRIBE_TTL
] = {.
ty³
 = 
NLA_U16
},

6057 [
NAN_REQ_ATTR_SUBSCRIBE_PERIOD
] = {.
ty³
 = 
NLA_U16
},

6058 [
NAN_REQ_ATTR_SUBSCRIBE_TYPE
] = {.
ty³
 = 
NLA_U8
},

6059 [
NAN_REQ_ATTR_SUBSCRIBE_RESP_FILTER_TYPE
] = {.
ty³
 = 
NLA_U8
},

6060 [
NAN_REQ_ATTR_SUBSCRIBE_RESP_INCLUDE
] = {.
ty³
 = 
NLA_U8
},

6061 [
NAN_REQ_ATTR_SUBSCRIBE_USE_RESP_FILTER
] = {.
ty³
 = 
NLA_U8
},

6062 [
NAN_REQ_ATTR_SUBSCRIBE_SSI_REQUIRED
] = {.
ty³
 = 
NLA_U8
},

6063 [
NAN_REQ_ATTR_SUBSCRIBE_MATCH_INDICATOR
] = {.
ty³
 = 
NLA_U8
},

6064 [
NAN_REQ_ATTR_SUBSCRIBE_COUNT
] = {.
ty³
 = 
NLA_U8
},

6065 [
NAN_REQ_ATTR_SUBSCRIBE_SERVICE_NAME_LEN
] = {.
ty³
 = 
NLA_U16
},

6066 [
NAN_REQ_ATTR_SUBSCRIBE_SERVICE_NAME
] = {.
ty³
 = 
NLA_BINARY
},

6067 [
NAN_REQ_ATTR_SUBSCRIBE_SERVICE_INFO_LEN
] = {.
ty³
 = 
NLA_U16
},

6068 [
NAN_REQ_ATTR_SUBSCRIBE_SERVICE_INFO
] = {.
ty³
 = 
NLA_BINARY
},

6069 [
NAN_REQ_ATTR_SUBSCRIBE_RX_MATCH_FILTER_LEN
] = {.
ty³
 = 
NLA_U16
},

6070 [
NAN_REQ_ATTR_SUBSCRIBE_RX_MATCH_FILTER
] = {.
ty³
 = 
NLA_BINARY
},

6071 [
NAN_REQ_ATTR_SUBSCRIBE_TX_MATCH_FILTER_LEN
] = {.
ty³
 = 
NLA_U16
},

6072 [
NAN_REQ_ATTR_SUBSCRIBE_TX_MATCH_FILTER
] = {.
ty³
 = 
NLA_BINARY
},

6073 [
NAN_REQ_ATTR_SUBSCRIBE_RSSI_THRESHOLD_FLAG
] = {.
ty³
 = 
NLA_U8
},

6074 [
NAN_REQ_ATTR_SUBSCRIBE_CONN_MAP
] = {.
ty³
 = 
NLA_U8
},

6075 [
NAN_REQ_ATTR_SUBSCRIBE_NUM_INTF_ADDR_PRESENT
] = {.
ty³
 = 
NLA_U8
},

6076 [
NAN_REQ_ATTR_SUBSCRIBE_INTF_ADDR
] = {.
ty³
 = 
NLA_BINARY
,

6077 .
	gËn
 = 
SLSI_HAL_NAN_MAX_SUBSCRIBE_MAX_ADDRESS
 * 
ETH_ALEN
},

6078 [
NAN_REQ_ATTR_SUBSCRIBE_RECV_IND_CFG
] = {.
ty³
 = 
NLA_U8
},

6079 [
NAN_REQ_ATTR_FOLLOWUP_ID
] = {.
ty³
 = 
NLA_U16
},

6080 [
NAN_REQ_ATTR_FOLLOWUP_REQUESTOR_ID
] = {.
ty³
 = 
NLA_U32
},

6081 [
NAN_REQ_ATTR_FOLLOWUP_ADDR
] = {.
ty³
 = 
NLA_BINARY
,

6082 .
	gËn
 = 
ETH_ALEN
},

6083 [
NAN_REQ_ATTR_FOLLOWUP_PRIORITY
] = {.
ty³
 = 
NLA_U8
},

6084 [
NAN_REQ_ATTR_FOLLOWUP_SERVICE_NAME_LEN
] = {.
ty³
 = 
NLA_U16
},

6085 [
NAN_REQ_ATTR_FOLLOWUP_SERVICE_NAME
] = {.
ty³
 = 
NLA_BINARY
},

6086 [
NAN_REQ_ATTR_FOLLOWUP_TX_WINDOW
] = {.
ty³
 = 
NLA_U8
},

6087 [
NAN_REQ_ATTR_FOLLOWUP_RECV_IND_CFG
] = {.
ty³
 = 
NLA_U8
},

6088 [
NAN_REQ_ATTR_SUBSCRIBE_SID_BEACON_VAL
] = {.
ty³
 = 
NLA_U8
},

6089 [
NAN_REQ_ATTR_DW_2G4_INTERVAL
] = {.
ty³
 = 
NLA_U8
},

6090 [
NAN_REQ_ATTR_DW_5G_INTERVAL
] = {.
ty³
 = 
NLA_U8
},

6091 [
NAN_REQ_ATTR_DISC_MAC_ADDR_RANDOM_INTERVAL
] = {.
ty³
 = 
NLA_U32
},

6092 [
NAN_REQ_ATTR_PUBLISH_SDEA_LEN
] = {.
ty³
 = 
NLA_U16
},

6093 [
NAN_REQ_ATTR_PUBLISH_SDEA
] = {.
ty³
 = 
NLA_BINARY
},

6094 [
NAN_REQ_ATTR_RANGING_AUTO_RESPONSE
] = {.
ty³
 = 
NLA_U8
},

6095 [
NAN_REQ_ATTR_SDEA_PARAM_NDP_TYPE
] = {.
ty³
 = 
NLA_U8
},

6096 [
NAN_REQ_ATTR_SDEA_PARAM_SECURITY_CFG
] = {.
ty³
 = 
NLA_U8
},

6097 [
NAN_REQ_ATTR_SDEA_PARAM_RANGING_STATE
] = {.
ty³
 = 
NLA_U8
},

6098 [
NAN_REQ_ATTR_SDEA_PARAM_RANGE_REPORT
] = {.
ty³
 = 
NLA_U8
},

6099 [
NAN_REQ_ATTR_SDEA_PARAM_QOS_CFG
] = {.
ty³
 = 
NLA_U8
},

6100 [
NAN_REQ_ATTR_RANGING_CFG_INTERVAL
] = {.
ty³
 = 
NLA_U32
},

6101 [
NAN_REQ_ATTR_RANGING_CFG_INDICATION
] = {.
ty³
 = 
NLA_U32
},

6102 [
NAN_REQ_ATTR_RANGING_CFG_INGRESS_MM
] = {.
ty³
 = 
NLA_U32
},

6103 [
NAN_REQ_ATTR_RANGING_CFG_EGRESS_MM
] = {.
ty³
 = 
NLA_U32
},

6104 [
NAN_REQ_ATTR_CIPHER_TYPE
] = {.
ty³
 = 
NLA_U32
},

6105 [
NAN_REQ_ATTR_SCID_LEN
] = {.
ty³
 = 
NLA_U32
},

6106 [
NAN_REQ_ATTR_SCID
] = {.
ty³
 = 
NLA_BINARY
},

6107 [
NAN_REQ_ATTR_SECURITY_KEY_TYPE
] = {.
ty³
 = 
NLA_U32
},

6108 [
NAN_REQ_ATTR_SECURITY_PMK_LEN
] = {.
ty³
 = 
NLA_U32
},

6109 [
NAN_REQ_ATTR_SECURITY_PMK
] = {.
ty³
 = 
NLA_BINARY
},

6110 [
NAN_REQ_ATTR_SECURITY_PASSPHRASE_LEN
] = {.
ty³
 = 
NLA_U32
},

6111 [
NAN_REQ_ATTR_SECURITY_PASSPHRASE
] = {.
ty³
 = 
NLA_BINARY
},

6112 [
NAN_REQ_ATTR_RANGE_RESPONSE_CFG_PUBLISH_ID
] = {.
ty³
 = 
NLA_U16
},

6113 [
NAN_REQ_ATTR_RANGE_RESPONSE_CFG_REQUESTOR_ID
] = {.
ty³
 = 
NLA_U32
},

6114 [
NAN_REQ_ATTR_RANGE_RESPONSE_CFG_PEER_ADDR
] = {.
ty³
 = 
NLA_BINARY
,

6115 .
	gËn
 = 
ETH_ALEN
},

6116 [
NAN_REQ_ATTR_RANGE_RESPONSE_CFG_RANGING_RESPONSE
] = {.
ty³
 = 
NLA_U16
},

6117 [
NAN_REQ_ATTR_REQ_INSTANCE_ID
] = {.
ty³
 = 
NLA_U32
},

6118 [
NAN_REQ_ATTR_NDP_INSTANCE_ID
] = {.
ty³
 = 
NLA_U32
},

6119 [
NAN_REQ_ATTR_CHAN_REQ_TYPE
] = {.
ty³
 = 
NLA_U8
},

6120 [
NAN_REQ_ATTR_CHAN
] = {.
ty³
 = 
NLA_U32
},

6121 [
NAN_REQ_ATTR_DATA_INTERFACE_NAME_LEN
] = {.
ty³
 = 
NLA_U8
},

6122 [
NAN_REQ_ATTR_DATA_INTERFACE_NAME
] = {.
ty³
 = 
NLA_BINARY
},

6123 [
NAN_REQ_ATTR_APP_INFO_LEN
] = {.
ty³
 = 
NLA_U16
},

6124 [
NAN_REQ_ATTR_APP_INFO
] = {.
ty³
 = 
NLA_BINARY
},

6125 [
NAN_REQ_ATTR_SERVICE_NAME_LEN
] = {.
ty³
 = 
NLA_U32
},

6126 [
NAN_REQ_ATTR_SERVICE_NAME
] = {.
ty³
 = 
NLA_BINARY
},

6127 [
NAN_REQ_ATTR_NDP_RESPONSE_CODE
] = {.
ty³
 = 
NLA_U8
},

6128 [
NAN_REQ_ATTR_USE_NDPE_ATTR
] = {.
ty³
 = 
NLA_U32
},

6129 [
NAN_REQ_ATTR_HAL_TRANSACTION_ID
] = {.
ty³
 = 
NLA_U16
},

6130 [
NAN_REQ_ATTR_CONFIG_DISC_MAC_ADDR_RANDOM
] = {.
ty³
 = 
NLA_U8
},

6131 [
NAN_REQ_ATTR_DISCOVERY_BEACON_INT
] = {.
ty³
 = 
NLA_U32
},

6132 [
NAN_REQ_ATTR_NSS
] = {.
ty³
 = 
NLA_U32
},

6133 [
NAN_REQ_ATTR_ENABLE_RANGING
] = {.
ty³
 = 
NLA_U32
},

6134 [
NAN_REQ_ATTR_DW_EARLY_TERMINATION
] = {.
ty³
 = 
NLA_U32
},

6139 
why_v’dÜ_commªd
 
	g¦si_v’dÜ_cmd
[] = {

6142 .
v’dÜ_id
 = 
OUI_GOOGLE
,

6143 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_CAPABILITIES


6145 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6146 .
	gdo™
 = 
¦si_gsÿn_g‘_ÿ·b™›s


6150 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6151 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_VALID_CHANNELS


6153 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6154 .
	gdo™
 = 
¦si_gsÿn_g‘_v®id_chªÃl


6158 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6159 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_ADD_GSCAN


6161 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6162 .
	gdo™
 = 
¦si_gsÿn_add


6166 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6167 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_DEL_GSCAN


6169 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6170 .
	gdo™
 = 
¦si_gsÿn_d–


6174 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6175 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_SCAN_RESULTS


6177 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6178 .
	gdo™
 = 
¦si_gsÿn_g‘_sÿn_»suÉs


6182 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6183 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_SET_GSCAN_OUI


6185 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6186 .
	gdo™
 = 
¦si_gsÿn_£t_oui


6188 #ifdeà
CONFIG_SCSC_WLAN_KEY_MGMT_OFFLOAD


6191 .
	gv’dÜ_id
 = 
OUI_SAMSUNG
,

6192 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_KEY_MGMT_SET_KEY


6194 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6195 .
	gdo™
 = 
¦si_key_mgmt_£t_pmk


6200 .
	gv’dÜ_id
 = 
OUI_SAMSUNG
,

6201 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_DEFAULT_SCAN_IES


6203 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6204 .
	gdo™
 = 
¦si_£t_v’dÜ_›


6208 .
	gv’dÜ_id
 = 
OUI_SAMSUNG
,

6209 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_SET_BSSID_BLACKLIST


6211 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6212 .
	gdo™
 = 
¦si_£t_bssid_bÏckli¡


6216 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6217 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_SET_BSSID_BLACKLIST


6219 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6220 .
	gdo™
 = 
¦si_£t_bssid_bÏckli¡


6224 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6225 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_START_KEEP_ALIVE_OFFLOAD


6227 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6228 .
	gdo™
 = 
¦si_¡¬t_k“·live_ofæßd


6232 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6233 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_STOP_KEEP_ALIVE_OFFLOAD


6235 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6236 .
	gdo™
 = 
¦si_¡İ_k“·live_ofæßd


6240 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6241 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_SET_EPNO_LIST


6243 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6244 .
	gdo™
 = 
¦si_£t_•no_ssid


6248 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6249 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_SET_HS_LIST


6251 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6252 .
	gdo™
 = 
¦si_£t_hs_·¿ms


6256 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6257 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_RESET_HS_LIST


6259 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6260 .
	gdo™
 = 
¦si_»£t_hs_·¿ms


6264 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6265 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_SET_RSSI_MONITOR


6267 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6268 .
	gdo™
 = 
¦si_£t_rssi_mÚ™Ü


6272 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6273 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_LSTATS_SUBCMD_SET_STATS


6275 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6276 .
	gdo™
 = 
¦si_Îs_£t_¡©s


6280 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6281 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_LSTATS_SUBCMD_GET_STATS


6283 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6284 .
	gdo™
 = 
¦si_Îs_g‘_¡©s


6288 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6289 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_LSTATS_SUBCMD_CLEAR_STATS


6291 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6292 .
	gdo™
 = 
¦si_Îs_ş—r_¡©s


6296 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6297 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_FEATURE_SET


6299 .
	gæags
 = 0,

6300 .
	gdo™
 = 
¦si_g‘_ã©u»_£t


6304 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6305 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_SET_COUNTRY_CODE


6307 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6308 .
	gdo™
 = 
¦si_£t_couÁry_code


6310 #ià
IS_ENABLED
(
CONFIG_IPV6
)

6313 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6314 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_CONFIGURE_ND_OFFLOAD


6316 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6317 .
	gdo™
 = 
¦si_cÚfigu»_nd_ofæßd


6320 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_LOGGING


6323 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6324 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_START_LOGGING


6326 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6327 .
	gdo™
 = 
¦si_¡¬t_loggšg


6331 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6332 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_RESET_LOGGING


6334 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6335 .
	gdo™
 = 
¦si_»£t_loggšg


6339 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6340 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_TRIGGER_FW_MEM_DUMP


6342 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6343 .
	gdo™
 = 
¦si_Œigg”_fw_mem_dump


6347 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6348 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_FW_MEM_DUMP


6350 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6351 .
	gdo™
 = 
¦si_g‘_fw_mem_dump


6355 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6356 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_TRIGGER_DRIVER_MEM_DUMP


6358 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6359 .
	gdo™
 = 
¦si_Œigg”_driv”_mem_dump


6363 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6364 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_DRIVER_MEM_DUMP


6366 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6367 .
	gdo™
 = 
¦si_g‘_driv”_mem_dump


6371 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6372 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_VERSION


6374 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6375 .
	gdo™
 = 
¦si_g‘_v”siÚ


6379 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6380 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_RING_STATUS


6382 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6383 .
	gdo™
 = 
¦si_g‘_ršg_bufãrs_¡©us


6387 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6388 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_RING_DATA


6390 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6391 .
	gdo™
 = 
¦si_g‘_ršg_d©a


6395 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6396 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_FEATURE


6398 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6399 .
	gdo™
 = 
¦si_g‘_logg”_suµÜ‹d_ã©u»_£t


6403 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6404 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_START_PKT_FATE_MONITORING


6406 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6407 .
	gdo™
 = 
¦si_¡¬t_pkt_ç‹_mÚ™Üšg


6411 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6412 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_TX_PKT_FATES


6414 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6415 .
	gdo™
 = 
¦si_g‘_tx_pkt_ç‹s


6419 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6420 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_RX_PKT_FATES


6422 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6423 .
	gdo™
 = 
¦si_g‘_rx_pkt_ç‹s


6427 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6428 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_WAKE_REASON_STATS


6430 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6431 .
	gdo™
 = 
¦si_g‘_wake_»asÚ_¡©s


6434 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


6437 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6438 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_ENABLE


6440 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6441 .
	gdo™
 = 
¦si_Çn_’abË


6445 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6446 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DISABLE


6448 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6449 .
	gdo™
 = 
¦si_Çn_di§bË


6453 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6454 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_PUBLISH


6456 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6457 .
	gdo™
 = 
¦si_Çn_publish


6461 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6462 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_PUBLISHCANCEL


6464 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6465 .
	gdo™
 = 
¦si_Çn_publish_ÿnûl


6469 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6470 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_SUBSCRIBE


6472 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6473 .
	gdo™
 = 
¦si_Çn_subsüibe


6477 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6478 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_SUBSCRIBECANCEL


6480 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6481 .
	gdo™
 = 
¦si_Çn_subsüibe_ÿnûl


6485 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6486 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_TXFOLLOWUP


6488 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6489 .
	gdo™
 = 
¦si_Çn_Œªsm™_fŞlowup


6493 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6494 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_CONFIG


6496 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6497 .
	gdo™
 = 
¦si_Çn_£t_cÚfig


6501 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6502 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_CAPABILITIES


6504 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6505 .
	gdo™
 = 
¦si_Çn_g‘_ÿ·b™›s


6510 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6511 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_INTERFACE_CREATE


6513 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6514 .
	gdo™
 = 
¦si_Çn_d©a_içû_ü—‹


6518 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6519 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_INTERFACE_DELETE


6521 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6522 .
	gdo™
 = 
¦si_Çn_d©a_içû_d–‘e


6526 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6527 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_REQUEST_INITIATOR


6529 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6530 .
	gdo™
 = 
¦si_Çn_ndp_š™Ÿ‹


6534 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6535 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_INDICATION_RESPONSE


6537 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6538 .
	gdo™
 = 
¦si_Çn_ndp_»¥Úd


6542 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6543 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_END


6545 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6546 .
	gdo™
 = 
¦si_Çn_ndp_’d


6551 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6552 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_GET_ROAMING_CAPABILITIES


6554 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6555 .
	gdo™
 = 
¦si_g‘_rßmšg_ÿ·b™›s


6559 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6560 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_SET_ROAMING_STATE


6562 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6563 .
	gdo™
 = 
¦si_£t_rßmšg_¡©e


6567 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6568 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_RTT_GET_CAPABILITIES


6570 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6571 .
	gdo™
 = 
¦si_¹t_g‘_ÿ·b™›s


6575 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6576 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_RTT_RANGE_START


6578 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6579 .
	gdo™
 = 
¦si_¹t_£t_cÚfig


6583 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6584 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_RTT_RANGE_CANCEL


6586 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6587 .
	gdo™
 = 
¦si_¹t_ÿnûl_cÚfig


6591 .
	gv’dÜ_id
 = 
OUI_SAMSUNG
,

6592 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_ACS_INIT


6594 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6595 .
	gdo™
 = 
¦si_acs_š™


6599 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6600 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_APF_GET_CAPABILITIES


6602 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6603 .
	gdo™
 = 
¦si_­f_g‘_ÿ·b™›s


6607 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6608 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_APF_SET_FILTER


6610 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6611 .
	gdo™
 = 
¦si_­f_£t_f‹r


6615 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6616 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_APF_READ_FILTER


6618 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6619 .
	gdo™
 = 
¦si_­f_»ad_f‹r


6623 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6624 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_SET_LATENCY_MODE


6626 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6627 .
	gdo™
 = 
¦si_cÚfigu»_Ï‹ncy_mode


6629 #ifdeà
CONFIG_SCSC_WLAN_SAR_SUPPORTED


6632 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6633 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_SELECT_TX_POWER_SCENARIO


6635 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6636 .
	gdo™
 = 
¦si_£Ëù_tx_pow”_sûÇrio


6640 .
	gv’dÜ_id
 = 
OUI_GOOGLE
,

6641 .
	gsubcmd
 = 
SLSI_NL80211_VENDOR_SUBCMD_RESET_TX_POWER_SCENARIO


6643 .
	gæags
 = 
WIPHY_VENDOR_CMD_NEED_WDEV
 | 
WIPHY_VENDOR_CMD_NEED_NETDEV
,

6644 .
	gdo™
 = 
¦si_»£t_tx_pow”_sûÇrio


6649 
	$¦si_Æ80211_v’dÜ_deš™
(
¦si_dev
 *
sdev
)

6651 
	`SLSI_DBG2
(
sdev
, 
SLSI_GSCAN
, "De-initialise vendor command‡ndƒvents\n");

6652 
sdev
->
why
->
v’dÜ_commªds
 = 
NULL
;

6653 
sdev
->
why
->
n_v’dÜ_commªds
 = 0;

6654 
sdev
->
why
->
v’dÜ_ev’ts
 = 
NULL
;

6655 
sdev
->
why
->
n_v’dÜ_ev’ts
 = 0;

6657 
	`SLSI_DBG2
(
sdev
, 
SLSI_GSCAN
, "Gscan cleanup\n");

6658 
	`¦si_gsÿn_æush_sÿn_»suÉs
(
sdev
);

6659 
	}
}

6661 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 3, 0))

6662 
	$¦si_Æl80211_v’dÜ_š™_pŞicy
(
why_v’dÜ_commªd
 *
¦si_v’dÜ_cmd
, 
n_v’dÜ_commªds
)

6664 
i
;

6665 
why_v’dÜ_commªd
 *
vcmd
;

6667 
i
 = 0; i < 
n_v’dÜ_commªds
; i++) {

6668 
vcmd
 = &
¦si_v’dÜ_cmd
[
i
];

6669 
vcmd
->
šfo
.
subcmd
) {

6670 
SLSI_NL80211_VENDOR_SUBCMD_GET_CAPABILITIES
:

6671 
SLSI_NL80211_VENDOR_SUBCMD_DEL_GSCAN
:

6672 
vcmd
->
pŞicy
 = 
VENDOR_CMD_RAW_DATA
;

6673 
vcmd
->
max©Œ
 = 0;

6675 
SLSI_NL80211_VENDOR_SUBCMD_GET_VALID_CHANNELS
:

6676 
SLSI_NL80211_VENDOR_SUBCMD_ADD_GSCAN
:

6677 
SLSI_NL80211_VENDOR_SUBCMD_GET_SCAN_RESULTS
:

6678 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_gsÿn_pŞicy
;

6679 
vcmd
->
max©Œ
 = 
GSCAN_ATTRIBUTE_MAX
;

6681 
SLSI_NL80211_VENDOR_SUBCMD_SET_GSCAN_OUI
:

6682 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_gsÿn_oui_pŞicy
;

6683 
vcmd
->
max©Œ
 = 
SLSI_NL_ATTRIBUTE_MAC_OUI_MAX
;

6685 #ifdeà
CONFIG_SCSC_WLAN_KEY_MGMT_OFFLOAD


6686 
SLSI_NL80211_VENDOR_SUBCMD_KEY_MGMT_SET_KEY
:

6687 
vcmd
->
pŞicy
 = 
VENDOR_CMD_RAW_DATA
;

6688 
vcmd
->
max©Œ
 = 0;

6691 
SLSI_NL80211_VENDOR_SUBCMD_SET_BSSID_BLACKLIST
:

6692 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_gsÿn_pŞicy
;

6693 
vcmd
->
max©Œ
 = 
GSCAN_ATTRIBUTE_MAX
;

6695 
SLSI_NL80211_VENDOR_SUBCMD_START_KEEP_ALIVE_OFFLOAD
:

6696 
SLSI_NL80211_VENDOR_SUBCMD_STOP_KEEP_ALIVE_OFFLOAD
:

6697 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_¡¬t_k“·live_ofæßd_pŞicy
;

6698 
vcmd
->
max©Œ
 = 
MKEEP_ALIVE_ATTRIBUTE_MAX
;

6700 
SLSI_NL80211_VENDOR_SUBCMD_SET_EPNO_LIST
:

6701 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_•no_pŞicy
;

6702 
vcmd
->
max©Œ
 = 
SLSI_ATTRIBUTE_EPNO_MAX
;

6704 
SLSI_NL80211_VENDOR_SUBCMD_SET_HS_LIST
:

6705 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_•no_hs_pŞicy
;

6706 
vcmd
->
max©Œ
 = 
SLSI_ATTRIBUTE_EPNO_HS_MAX
;

6708 
SLSI_NL80211_VENDOR_SUBCMD_RESET_HS_LIST
:

6709 
vcmd
->
pŞicy
 = 
VENDOR_CMD_RAW_DATA
;

6710 
vcmd
->
max©Œ
 = 0;

6712 
SLSI_NL80211_VENDOR_SUBCMD_SET_RSSI_MONITOR
:

6713 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_rssi_mÚ™Ü
;

6714 
vcmd
->
max©Œ
 = 
SLSI_RSSI_MONITOR_ATTRIBUTE_MAX
;

6716 
SLSI_NL80211_VENDOR_SUBCMD_LSTATS_SUBCMD_SET_STATS
:

6717 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_Îs_pŞicy
;

6718 
vcmd
->
max©Œ
 = 
LLS_ATTRIBUTE_MAX
;

6720 
SLSI_NL80211_VENDOR_SUBCMD_LSTATS_SUBCMD_GET_STATS
:

6721 
vcmd
->
pŞicy
 = 
VENDOR_CMD_RAW_DATA
;

6722 
vcmd
->
max©Œ
 = 0;

6724 
SLSI_NL80211_VENDOR_SUBCMD_LSTATS_SUBCMD_CLEAR_STATS
:

6725 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_Îs_pŞicy
;

6726 
vcmd
->
max©Œ
 = 
LLS_ATTRIBUTE_MAX
;

6728 
SLSI_NL80211_VENDOR_SUBCMD_GET_FEATURE_SET
:

6729 
vcmd
->
pŞicy
 = 
VENDOR_CMD_RAW_DATA
;

6730 
vcmd
->
max©Œ
 = 0;

6732 
SLSI_NL80211_VENDOR_SUBCMD_SET_COUNTRY_CODE
:

6733 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_couÁry_code_pŞicy
;

6734 
vcmd
->
max©Œ
 = 
SLSI_NL_ATTRIBUTE_COUNTRY_CODE_MAX
;

6736 
SLSI_NL80211_VENDOR_SUBCMD_CONFIGURE_ND_OFFLOAD
:

6737 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_gsÿn_oui_pŞicy
;

6738 
vcmd
->
max©Œ
 = 
SLSI_NL_ATTRIBUTE_MAC_OUI_MAX
;

6740 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_LOGGING


6741 
SLSI_NL80211_VENDOR_SUBCMD_RESET_LOGGING
:

6742 
SLSI_NL80211_VENDOR_SUBCMD_TRIGGER_FW_MEM_DUMP
:

6743 
SLSI_NL80211_VENDOR_SUBCMD_TRIGGER_DRIVER_MEM_DUMP
:

6744 
SLSI_NL80211_VENDOR_SUBCMD_GET_RING_STATUS
:

6745 
SLSI_NL80211_VENDOR_SUBCMD_GET_FEATURE
:

6746 
SLSI_NL80211_VENDOR_SUBCMD_START_PKT_FATE_MONITORING
:

6747 
vcmd
->
pŞicy
 = 
VENDOR_CMD_RAW_DATA
;

6748 
vcmd
->
max©Œ
 = 0;

6750 
SLSI_NL80211_VENDOR_SUBCMD_START_LOGGING
:

6751 
SLSI_NL80211_VENDOR_SUBCMD_GET_FW_MEM_DUMP
:

6752 
SLSI_NL80211_VENDOR_SUBCMD_GET_DRIVER_MEM_DUMP
:

6753 
SLSI_NL80211_VENDOR_SUBCMD_GET_VERSION
:

6754 
SLSI_NL80211_VENDOR_SUBCMD_GET_RING_DATA
:

6755 
SLSI_NL80211_VENDOR_SUBCMD_GET_TX_PKT_FATES
:

6756 
SLSI_NL80211_VENDOR_SUBCMD_GET_RX_PKT_FATES
:

6757 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_’hªûd_loggšg_pŞicy
;

6758 
vcmd
->
max©Œ
 = 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_MAX
;

6760 
SLSI_NL80211_VENDOR_SUBCMD_GET_WAKE_REASON_STATS
:

6761 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_wake_»asÚ_¡©s_pŞicy
;

6762 
vcmd
->
max©Œ
 = 
SLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_MAX
;

6765 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


6766 
SLSI_NL80211_VENDOR_SUBCMD_NAN_ENABLE
:

6767 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DISABLE
:

6768 
SLSI_NL80211_VENDOR_SUBCMD_NAN_PUBLISH
:

6769 
SLSI_NL80211_VENDOR_SUBCMD_NAN_PUBLISHCANCEL
:

6770 
SLSI_NL80211_VENDOR_SUBCMD_NAN_SUBSCRIBE
:

6771 
SLSI_NL80211_VENDOR_SUBCMD_NAN_SUBSCRIBECANCEL
:

6772 
SLSI_NL80211_VENDOR_SUBCMD_NAN_TXFOLLOWUP
:

6773 
SLSI_NL80211_VENDOR_SUBCMD_NAN_CONFIG
:

6774 
SLSI_NL80211_VENDOR_SUBCMD_NAN_CAPABILITIES
:

6775 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_INTERFACE_CREATE
:

6776 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_INTERFACE_DELETE
:

6777 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_REQUEST_INITIATOR
:

6778 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_INDICATION_RESPONSE
:

6779 
SLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_END
:

6780 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_Çn_pŞicy
;

6781 
vcmd
->
max©Œ
 = 
NAN_REQ_ATTR_MAX
;

6784 
SLSI_NL80211_VENDOR_SUBCMD_GET_ROAMING_CAPABILITIES
:

6785 
vcmd
->
pŞicy
 = 
VENDOR_CMD_RAW_DATA
;

6786 
vcmd
->
max©Œ
 = 0;

6788 
SLSI_NL80211_VENDOR_SUBCMD_SET_ROAMING_STATE
:

6789 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_rßm_¡©e_pŞicy
;

6790 
vcmd
->
max©Œ
 = 
SLSI_NL_ATTR_ROAM_MAX
;

6792 
SLSI_NL80211_VENDOR_SUBCMD_RTT_GET_CAPABILITIES
:

6793 
vcmd
->
pŞicy
 = 
VENDOR_CMD_RAW_DATA
;

6794 
vcmd
->
max©Œ
 = 0;

6796 
SLSI_NL80211_VENDOR_SUBCMD_RTT_RANGE_START
:

6797 
SLSI_NL80211_VENDOR_SUBCMD_RTT_RANGE_CANCEL
:

6798 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_¹t_pŞicy
;

6799 
vcmd
->
max©Œ
 = 
SLSI_RTT_ATTRIBUTE_MAX
;

6801 
SLSI_NL80211_VENDOR_SUBCMD_ACS_INIT
:

6802 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_acs_pŞicy
;

6803 
vcmd
->
max©Œ
 = 
SLSI_ACS_ATTR_MAX
;

6805 
SLSI_NL80211_VENDOR_SUBCMD_DEFAULT_SCAN_IES
:

6806 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_deçuÉ_sÿn_pŞicy
;

6807 
vcmd
->
max©Œ
 = 
SLSI_SCAN_DEFAULT_MAX
;

6809 
SLSI_NL80211_VENDOR_SUBCMD_APF_GET_CAPABILITIES
:

6810 
vcmd
->
pŞicy
 = 
VENDOR_CMD_RAW_DATA
;

6811 
vcmd
->
max©Œ
 = 0;

6813 
SLSI_NL80211_VENDOR_SUBCMD_APF_SET_FILTER
:

6814 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_­f_f‹r_pŞicy
;

6815 
vcmd
->
max©Œ
 = 
SLSI_APF_ATTR_MAX
;

6817 
SLSI_NL80211_VENDOR_SUBCMD_APF_READ_FILTER
:

6818 
vcmd
->
pŞicy
 = 
VENDOR_CMD_RAW_DATA
;

6819 
vcmd
->
max©Œ
 = 0;

6821 
SLSI_NL80211_VENDOR_SUBCMD_SET_LATENCY_MODE
:

6822 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_low_Ï‹ncy_pŞicy
;

6823 
vcmd
->
max©Œ
 = 
SLSI_NL_ATTRIBUTE_LATENCY_MAX
;

6825 #ifdeà
CONFIG_SCSC_WLAN_SAR_SUPPORTED


6826 
SLSI_NL80211_VENDOR_SUBCMD_SELECT_TX_POWER_SCENARIO
:

6827 
vcmd
->
pŞicy
 = 
¦si_wÏn_v’dÜ_tx_pow”_sûÇrio_pŞicy
;

6828 
vcmd
->
max©Œ
 = 
SLSI_NL_ATTRIBUTE_TX_POWER_SCENARIO_MAX
;

6830 
SLSI_NL80211_VENDOR_SUBCMD_RESET_TX_POWER_SCENARIO
:

6831 
vcmd
->
pŞicy
 = 
VENDOR_CMD_RAW_DATA
;

6832 
vcmd
->
max©Œ
 = 0;

6837 
	}
}

6840 
	$¦si_Æ80211_v’dÜ_š™
(
¦si_dev
 *
sdev
)

6842 
i
;

6844 
	`SLSI_DBG2
(
sdev
, 
SLSI_GSCAN
, "Init vendor command‡ndƒvents\n");

6846 
sdev
->
why
->
v’dÜ_commªds
 = (cÚ¡ 
why_v’dÜ_commªd
 *)
¦si_v’dÜ_cmd
;

6847 
sdev
->
why
->
n_v’dÜ_commªds
 = 
	`ARRAY_SIZE
(
¦si_v’dÜ_cmd
);

6848 
sdev
->
why
->
v’dÜ_ev’ts
 = 
¦si_v’dÜ_ev’ts
;

6849 
sdev
->
why
->
n_v’dÜ_ev’ts
 = 
	`ARRAY_SIZE
(
¦si_v’dÜ_ev’ts
);

6851 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 3, 0))

6852 
	`¦si_Æl80211_v’dÜ_š™_pŞicy
(
¦si_v’dÜ_cmd
, 
sdev
->
why
->
n_v’dÜ_commªds
);

6855 
i
 = 0; i < 
SLSI_GSCAN_MAX_BUCKETS
; i++)

6856 
sdev
->
buck‘
[
i
].
sÿn_id
 = (
SLSI_GSCAN_SCAN_ID_START
 + i);

6858 
i
 = 0; i < 
SLSI_GSCAN_HASH_TABLE_SIZE
; i++)

6859 
sdev
->
gsÿn_hash_bË
[
i
] = 
NULL
;

6861 
	`INIT_LIST_HEAD
(&
sdev
->
hÙli¡_»suÉs
);

6862 
	}
}

	@nl80211_vendor.h

7 
	~"Æ80211_v’dÜ_Çn.h
"

9 #iâdeà
__SLSI_NL80211_VENDOR_H_


10 
	#__SLSI_NL80211_VENDOR_H_


	)

12 
	#OUI_GOOGLE
 0x001A11

	)

13 
	#OUI_SAMSUNG
 0x0000f0

	)

14 
	#SLSI_NL80211_GSCAN_SUBCMD_RANGE_START
 0x1000

	)

15 
	#SLSI_NL80211_GSCAN_EVENT_RANGE_START
 0x01

	)

16 
	#SLSI_NL80211_RTT_SUBCMD_RANGE_START
 0x1100

	)

17 
	#SLSI_NL80211_LOGGING_SUBCMD_RANGE_START
 0x1400

	)

18 
	#SLSI_NL80211_NAN_SUBCMD_RANGE_START
 0x1500

	)

19 
	#SLSI_NL80211_APF_SUBCMD_RANGE_START
 0x1600

	)

20 
	#SLSI_GSCAN_SCAN_ID_START
 0x410

	)

21 
	#SLSI_GSCAN_SCAN_ID_END
 0x500

	)

23 
	#SLSI_GSCAN_MAX_BUCKETS
 (8)

	)

24 
	#SLSI_GSCAN_MAX_CHANNELS
 (16è

	)

25 
	#SLSI_GSCAN_MAX_HOTLIST_APS
 (64)

	)

26 
	#SLSI_GSCAN_MAX_BUCKETS_PER_GSCAN
 (
SLSI_GSCAN_MAX_BUCKETS
)

	)

27 
	#SLSI_GSCAN_MAX_SCAN_CACHE_SIZE
 (12000)

	)

28 
	#SLSI_GSCAN_MAX_AP_CACHE_PER_SCAN
 (16)

	)

29 
	#SLSI_GSCAN_MAX_SCAN_REPORTING_THRESHOLD
 (100)

	)

30 
	#SLSI_GSCAN_MAX_SIGNIFICANT_CHANGE_APS
 (64)

	)

31 
	#SLSI_GSCAN_MAX_EPNO_SSIDS
 (32)

	)

32 
	#SLSI_GSCAN_MAX_EPNO_HS2_PARAM
 (8è

	)

34 
	#SLSI_REPORT_EVENTS_NONE
 (0)

	)

35 
	#SLSI_REPORT_EVENTS_EACH_SCAN
 (1)

	)

36 
	#SLSI_REPORT_EVENTS_FULL_RESULTS
 (2)

	)

37 
	#SLSI_REPORT_EVENTS_NO_BATCH
 (4)

	)

39 
	#SLSI_NL_ATTRIBUTE_U32_LEN
 (
NLA_HDRLEN
 + 4)

	)

41 
	#SLSI_NL_VENDOR_ID_OVERHEAD
 
SLSI_NL_ATTRIBUTE_U32_LEN


	)

42 
	#SLSI_NL_VENDOR_SUBCMD_OVERHEAD
 
SLSI_NL_ATTRIBUTE_U32_LEN


	)

43 
	#SLSI_NL_VENDOR_DATA_OVERHEAD
 (
NLA_HDRLEN
)

	)

45 
	#SLSI_NL_VENDOR_REPLY_OVERHEAD
 (
SLSI_NL_VENDOR_ID_OVERHEAD
 + \

46 
SLSI_NL_VENDOR_SUBCMD_OVERHEAD
 + \

47 
SLSI_NL_VENDOR_DATA_OVERHEAD
)

	)

49 
	#SLSI_GSCAN_RTT_UNSPECIFIED
 (-1)

	)

50 
	#SLSI_GSCAN_HASH_TABLE_SIZE
 (32)

	)

51 
	#SLSI_GSCAN_HASH_KEY_MASK
 (0x1F)

	)

52 
	#SLSI_GSCAN_GET_HASH_KEY
(
_key
è(_key & 
SLSI_GSCAN_HASH_KEY_MASK
)

	)

54 
	#SLSI_KEEP_SCAN_RESULT
 (0)

	)

55 
	#SLSI_DISCARD_SCAN_RESULT
 (1)

	)

57 
	#SLSI_GSCAN_MAX_BSSID_PER_IE
 (20)

	)

59 
	#SLSI_LLS_CAPABILITY_QOS
 0x00000001

	)

60 
	#SLSI_LLS_CAPABILITY_PROTECTED
 0x00000002

	)

61 
	#SLSI_LLS_CAPABILITY_INTERWORKING
 0x00000004

	)

62 
	#SLSI_LLS_CAPABILITY_HS20
 0x00000008

	)

63 
	#SLSI_LLS_CAPABILITY_SSID_UTF8
 0x00000010

	)

64 
	#SLSI_LLS_CAPABILITY_COUNTRY
 0x00000020

	)

66 
	#TIMESPEC_TO_US
(
ts
è(((
u64
)Ñs).
tv_£c
 * 
USEC_PER_SEC
è+ (ts).
tv_n£c
 / 
NSEC_PER_USEC
)

	)

69 
	#SLSI_WIFI_HAL_FEATURE_INFRA
 0x000001

	)

70 
	#SLSI_WIFI_HAL_FEATURE_INFRA_5G
 0x000002

	)

71 
	#SLSI_WIFI_HAL_FEATURE_HOTSPOT
 0x000004

	)

72 
	#SLSI_WIFI_HAL_FEATURE_P2P
 0x000008

	)

73 
	#SLSI_WIFI_HAL_FEATURE_SOFT_AP
 0x000010

	)

74 
	#SLSI_WIFI_HAL_FEATURE_GSCAN
 0x000020

	)

75 
	#SLSI_WIFI_HAL_FEATURE_NAN
 0x000040

	)

76 
	#SLSI_WIFI_HAL_FEATURE_D2D_RTT
 0x000080

	)

77 
	#SLSI_WIFI_HAL_FEATURE_D2AP_RTT
 0x000100

	)

78 
	#SLSI_WIFI_HAL_FEATURE_BATCH_SCAN
 0x000200

	)

79 
	#SLSI_WIFI_HAL_FEATURE_PNO
 0x000400

	)

80 
	#SLSI_WIFI_HAL_FEATURE_ADDITIONAL_STA
 0x000800

	)

81 
	#SLSI_WIFI_HAL_FEATURE_TDLS
 0x001000

	)

82 
	#SLSI_WIFI_HAL_FEATURE_TDLS_OFFCHANNEL
 0x002000

	)

83 
	#SLSI_WIFI_HAL_FEATURE_EPR
 0x004000

	)

84 
	#SLSI_WIFI_HAL_FEATURE_AP_STA
 0x008000

	)

85 
	#SLSI_WIFI_HAL_FEATURE_LINK_LAYER_STATS
 0x010000

	)

86 
	#SLSI_WIFI_HAL_FEATURE_LOGGER
 0x020000

	)

87 
	#SLSI_WIFI_HAL_FEATURE_HAL_EPNO
 0x040000

	)

88 
	#SLSI_WIFI_HAL_FEATURE_RSSI_MONITOR
 0x080000

	)

89 
	#SLSI_WIFI_HAL_FEATURE_MKEEP_ALIVE
 0x100000

	)

90 
	#SLSI_WIFI_HAL_FEATURE_CONFIG_NDO
 0x200000

	)

91 
	#SLSI_WIFI_HAL_FEATURE_CONTROL_ROAMING
 0x800000

	)

92 
	#SLSI_WIFI_HAL_FEATURE_SCAN_RAND
 0x2000000

	)

93 
	#SLSI_WIFI_HAL_FEATURE_LOW_LATENCY
 0x40000000

	)

94 
	#SLSI_WIFI_HAL_FEATURE_P2P_RAND_MAC
 0x80000000

	)

96 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 3, 0))

97 
	#SLSI_ATTRIBUTE_START_VAL
 1

	)

99 
	#SLSI_ATTRIBUTE_START_VAL
 0

	)

100 
	#SLSI_NL_ATTRIBUTE_COUNTRY_CODE
 4

	)

101 
	#SLSI_NL_ATTRIBUTE_LATENCY_MODE
 5

	)

102 
	#SLSI_NL_ATTRIBUTE_TX_POWER_SCENARIO
 6

	)

105 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 3, 0))

106 
	e¦si_low_Ï‹ncy_©Œ
 {

107 
	mSLSI_NL_ATTRIBUTE_LATENCY_MODE
 = 1,

108 
	mSLSI_NL_ATTRIBUTE_LATENCY_MAX


111 
	e¦si_couÁry_code_©Œ
 {

112 
	mSLSI_NL_ATTRIBUTE_COUNTRY_CODE
 = 1,

113 
	mSLSI_NL_ATTRIBUTE_COUNTRY_CODE_MAX


116 
	e¦si_tx_pow”_sûÇrio_©Œ
 {

117 
	mSLSI_NL_ATTRIBUTE_TX_POWER_SCENARIO
 = 1,

118 
	mSLSI_NL_ATTRIBUTE_TX_POWER_SCENARIO_MAX


122 
	e¦si_wifi_©Œ
 {

123 
	mSLSI_NL_ATTRIBUTE_ND_OFFLOAD_VALUE
 = 
SLSI_ATTRIBUTE_START_VAL
,

124 
	mSLSI_NL_ATTRIBUTE_PNO_RANDOM_MAC_OUI
,

125 
	mSLSI_NL_ATTRIBUTE_MAC_OUI_MAX


128 
	eSLSI_APF_ATTRIBUTES
 {

129 
	mSLSI_APF_ATTR_VERSION
 = 0,

130 
	mSLSI_APF_ATTR_MAX_LEN
,

131 
	mSLSI_APF_ATTR_PROGRAM
,

132 
	mSLSI_APF_ATTR_PROGRAM_LEN
,

133 
	mSLSI_APF_ATTR_MAX


136 
	eSLSI_ROAM_ATTRIBUTES
 {

137 
	mSLSI_NL_ATTR_MAX_BLACKLIST_SIZE
,

138 
	mSLSI_NL_ATTR_MAX_WHITELIST_SIZE
,

139 
	mSLSI_NL_ATTR_ROAM_STATE
,

140 
	mSLSI_NL_ATTR_ROAM_MAX


143 
	e¦si_acs_©Œ_ofæßd
 {

144 
	mSLSI_ACS_ATTR_CHANNEL_INVALID
 = 0,

145 
	mSLSI_ACS_ATTR_PRIMARY_CHANNEL
,

146 
	mSLSI_ACS_ATTR_SECONDARY_CHANNEL
,

147 
	mSLSI_ACS_ATTR_HW_MODE
,

148 
	mSLSI_ACS_ATTR_HT_ENABLED
,

149 
	mSLSI_ACS_ATTR_HT40_ENABLED
,

150 
	mSLSI_ACS_ATTR_VHT_ENABLED
,

151 
	mSLSI_ACS_ATTR_CHWIDTH
,

152 
	mSLSI_ACS_ATTR_CH_LIST
,

153 
	mSLSI_ACS_ATTR_VHT_SEG0_CENTER_CHANNEL
,

154 
	mSLSI_ACS_ATTR_VHT_SEG1_CENTER_CHANNEL
,

155 
	mSLSI_ACS_ATTR_FREQ_LIST
,

157 
	mSLSI_ACS_ATTR_AFTER_LAST
,

158 
	mSLSI_ACS_ATTR_MAX
 =

159 
SLSI_ACS_ATTR_AFTER_LAST
 - 1

162 
	e¦si_sÿn_©Œ_cÚfig
 {

163 
	mSLSI_SCAN_DEFAULT_IE_LEN
 = 1,

164 
	mSLSI_SCAN_DEFAULT_IES
,

166 
	mSLSI_SCAN_DEFAULT_AFTER_LAST
,

167 
	mSLSI_SCAN_DEFAULT_MAX
 =

168 
SLSI_SCAN_DEFAULT_AFTER_LAST
 - 1,

171 #ifdeà
CONFIG_SLSI_WLAN_STA_FWD_BEACON


172 
	e¦si_ws_©Œ
 {

173 
	mSLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_SSID
 = 0,

174 
	mSLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_BSSID
,

175 
	mSLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_CHANNEL
,

176 
	mSLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_BCN_INTERVAL
,

177 
	mSLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_TIME_STAMP1
,

178 
	mSLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_TIME_STAMP2
,

179 
	mSLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_SYS_TIME
,

180 
	mSLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_MAX


183 
	e¦si_ws_abÜt_©Œ
 {

184 
	mSLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_ABORT
 = 0,

185 
	mSLSI_WLAN_VENDOR_ATTR_FORWARD_BEACON_ABORT_MAX
,

188 
	e¦si_fÜw¬d_b—cÚ_abÜt_»asÚ
 {

189 
	mSLSI_FORWARD_BEACON_ABORT_REASON_UNSPECIFIED
 = 0,

190 
	mSLSI_FORWARD_BEACON_ABORT_REASON_SCANNING
,

191 
	mSLSI_FORWARD_BEACON_ABORT_REASON_ROAMING
,

192 
	mSLSI_FORWARD_BEACON_ABORT_REASON_SUSPENDED
,

193 
	mSLSI_FORWARD_BEACON_ABORT_REASON_OFFSET
 = 0x8007,

197 
	e¦si_acs_hw_mode
 {

198 
	mSLSI_ACS_MODE_IEEE80211B
,

199 
	mSLSI_ACS_MODE_IEEE80211G
,

200 
	mSLSI_ACS_MODE_IEEE80211A
,

201 
	mSLSI_ACS_MODE_IEEE80211AD
,

202 
	mSLSI_ACS_MODE_IEEE80211ANY
,

205 
	eGSCAN_ATTRIBUTE
 {

206 
	mGSCAN_ATTRIBUTE_NUM_BUCKETS
 = 10,

207 
	mGSCAN_ATTRIBUTE_BASE_PERIOD
,

208 
	mGSCAN_ATTRIBUTE_BUCKETS_BAND
,

209 
	mGSCAN_ATTRIBUTE_BUCKET_ID
,

210 
	mGSCAN_ATTRIBUTE_BUCKET_PERIOD
,

211 
	mGSCAN_ATTRIBUTE_BUCKET_NUM_CHANNELS
,

212 
	mGSCAN_ATTRIBUTE_BUCKET_CHANNELS
,

213 
	mGSCAN_ATTRIBUTE_NUM_AP_PER_SCAN
,

214 
	mGSCAN_ATTRIBUTE_REPORT_THRESHOLD
,

215 
	mGSCAN_ATTRIBUTE_NUM_SCANS_TO_CACHE
,

216 
	mGSCAN_ATTRIBUTE_REPORT_THRESHOLD_NUM_SCANS
,

217 
	mGSCAN_ATTRIBUTE_BAND
 = 
GSCAN_ATTRIBUTE_BUCKETS_BAND
,

219 
	mGSCAN_ATTRIBUTE_ENABLE_FEATURE
 = 20,

220 
	mGSCAN_ATTRIBUTE_SCAN_RESULTS_COMPLETE
,

221 
	mGSCAN_ATTRIBUTE_REPORT_EVENTS
,

224 
	mGSCAN_ATTRIBUTE_NUM_OF_RESULTS
 = 30,

225 
	mGSCAN_ATTRIBUTE_SCAN_RESULTS
,

226 
	mGSCAN_ATTRIBUTE_NUM_CHANNELS
,

227 
	mGSCAN_ATTRIBUTE_CHANNEL_LIST
,

228 
	mGSCAN_ATTRIBUTE_SCAN_ID
,

229 
	mGSCAN_ATTRIBUTE_SCAN_FLAGS
,

230 
	mGSCAN_ATTRIBUTE_SCAN_BUCKET_BIT
,

233 
	mGSCAN_ATTRIBUTE_RSSI_SAMPLE_SIZE
 = 60,

234 
	mGSCAN_ATTRIBUTE_LOST_AP_SAMPLE_SIZE
,

235 
	mGSCAN_ATTRIBUTE_MIN_BREACHING
,

236 
	mGSCAN_ATTRIBUTE_SIGNIFICANT_CHANGE_BSSIDS
,

238 
	mGSCAN_ATTRIBUTE_BUCKET_STEP_COUNT
 = 70,

239 
	mGSCAN_ATTRIBUTE_BUCKET_EXPONENT
,

240 
	mGSCAN_ATTRIBUTE_BUCKET_MAX_PERIOD
,

242 
	mGSCAN_ATTRIBUTE_NUM_BSSID
,

243 
	mGSCAN_ATTRIBUTE_BLACKLIST_BSSID
,

244 
	mGSCAN_ATTRIBUTE_BLACKLIST_FROM_SUPPLICANT
,

246 
	mGSCAN_ATTRIBUTE_MAX


249 
	e•no_ssid_©Œibu‹
 {

250 
	mSLSI_ATTRIBUTE_EPNO_MINIMUM_5G_RSSI
 = 
SLSI_ATTRIBUTE_START_VAL
,

251 
	mSLSI_ATTRIBUTE_EPNO_MINIMUM_2G_RSSI
,

252 
	mSLSI_ATTRIBUTE_EPNO_INITIAL_SCORE_MAX
,

253 
	mSLSI_ATTRIBUTE_EPNO_CUR_CONN_BONUS
,

254 
	mSLSI_ATTRIBUTE_EPNO_SAME_NETWORK_BONUS
,

255 
	mSLSI_ATTRIBUTE_EPNO_SECURE_BONUS
,

256 
	mSLSI_ATTRIBUTE_EPNO_5G_BONUS
,

257 
	mSLSI_ATTRIBUTE_EPNO_SSID_NUM
,

258 
	mSLSI_ATTRIBUTE_EPNO_SSID_LIST
,

259 
	mSLSI_ATTRIBUTE_EPNO_SSID
,

260 
	mSLSI_ATTRIBUTE_EPNO_SSID_LEN
,

261 
	mSLSI_ATTRIBUTE_EPNO_FLAGS
,

262 
	mSLSI_ATTRIBUTE_EPNO_AUTH
,

263 
	mSLSI_ATTRIBUTE_EPNO_MAX


266 
	e•no_hs_©Œibu‹
 {

267 
	mSLSI_ATTRIBUTE_EPNO_HS_PARAM_LIST
 = 
SLSI_ATTRIBUTE_START_VAL
,

268 
	mSLSI_ATTRIBUTE_EPNO_HS_NUM
,

269 
	mSLSI_ATTRIBUTE_EPNO_HS_ID
,

270 
	mSLSI_ATTRIBUTE_EPNO_HS_REALM
,

271 
	mSLSI_ATTRIBUTE_EPNO_HS_CONSORTIUM_IDS
,

272 
	mSLSI_ATTRIBUTE_EPNO_HS_PLMN
,

273 
	mSLSI_ATTRIBUTE_EPNO_HS_MAX


276 
	egsÿn_buck‘_©Œibu‹s
 {

277 
	mGSCAN_ATTRIBUTE_CH_BUCKET_1
,

278 
	mGSCAN_ATTRIBUTE_CH_BUCKET_2
,

279 
	mGSCAN_ATTRIBUTE_CH_BUCKET_3
,

280 
	mGSCAN_ATTRIBUTE_CH_BUCKET_4
,

281 
	mGSCAN_ATTRIBUTE_CH_BUCKET_5
,

282 
	mGSCAN_ATTRIBUTE_CH_BUCKET_6
,

283 
	mGSCAN_ATTRIBUTE_CH_BUCKET_7
,

284 
	mGSCAN_ATTRIBUTE_CH_BUCKET_8


287 
	ewifi_bªd
 {

288 
	mWIFI_BAND_UNSPECIFIED
,

289 
	mWIFI_BAND_BG
 = 1,

290 
	mWIFI_BAND_A
 = 2,

291 
	mWIFI_BAND_A_DFS
 = 4,

292 
	mWIFI_BAND_A_WITH_DFS
 = 6,

293 
	mWIFI_BAND_ABG
 = 3,

294 
	mWIFI_BAND_ABG_WITH_DFS
 = 7,

297 
	ewifi_sÿn_ev’t
 {

298 
	mWIFI_SCAN_RESULTS_AVAILABLE
,

299 
	mWIFI_SCAN_THRESHOLD_NUM_SCANS
,

300 
	mWIFI_SCAN_THRESHOLD_PERCENT
,

301 
	mWIFI_SCAN_FAILED
,

304 
	ewifi_mk“p_®ive_©Œibu‹
 {

305 
	mMKEEP_ALIVE_ATTRIBUTE_ID
 = 
SLSI_ATTRIBUTE_START_VAL
,

306 
	mMKEEP_ALIVE_ATTRIBUTE_IP_PKT
,

307 
	mMKEEP_ALIVE_ATTRIBUTE_IP_PKT_LEN
,

308 
	mMKEEP_ALIVE_ATTRIBUTE_SRC_MAC_ADDR
,

309 
	mMKEEP_ALIVE_ATTRIBUTE_DST_MAC_ADDR
,

310 
	mMKEEP_ALIVE_ATTRIBUTE_PERIOD_MSEC
,

311 
	mMKEEP_ALIVE_ATTRIBUTE_MAX


314 
	ewifi_rssi_mÚ™Ü_©Œ
 {

315 
	mSLSI_RSSI_MONITOR_ATTRIBUTE_MAX_RSSI
 = 
SLSI_ATTRIBUTE_START_VAL
,

316 
	mSLSI_RSSI_MONITOR_ATTRIBUTE_MIN_RSSI
,

317 
	mSLSI_RSSI_MONITOR_ATTRIBUTE_START
,

318 
	mSLSI_RSSI_MONITOR_ATTRIBUTE_MAX


321 
	eÎs_©Œibu‹
 {

322 
	mLLS_ATTRIBUTE_SET_MPDU_SIZE_THRESHOLD
 = 1,

323 
	mLLS_ATTRIBUTE_SET_AGGR_STATISTICS_GATHERING
,

324 
	mLLS_ATTRIBUTE_CLEAR_STOP_REQUEST_MASK
,

325 
	mLLS_ATTRIBUTE_CLEAR_STOP_REQUEST
,

326 
	mLLS_ATTRIBUTE_MAX


329 
	e¦si_h®_v’dÜ_subcmds
 {

330 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_CAPABILITIES
 = 
SLSI_NL80211_GSCAN_SUBCMD_RANGE_START
,

331 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_VALID_CHANNELS
,

332 
	mSLSI_NL80211_VENDOR_SUBCMD_ADD_GSCAN
,

333 
	mSLSI_NL80211_VENDOR_SUBCMD_DEL_GSCAN
,

334 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_SCAN_RESULTS
,

336 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_BSSID_HOTLIST
,

337 
	mSLSI_NL80211_VENDOR_SUBCMD_RESET_BSSID_HOTLIST
,

338 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_HOTLIST_RESULTS
,

339 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_SIGNIFICANT_CHANGE
,

340 
	mSLSI_NL80211_VENDOR_SUBCMD_RESET_SIGNIFICANT_CHANGE
,

342 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_GSCAN_OUI
,

343 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_NODFS
,

344 
	mSLSI_NL80211_VENDOR_SUBCMD_START_KEEP_ALIVE_OFFLOAD
,

345 
	mSLSI_NL80211_VENDOR_SUBCMD_STOP_KEEP_ALIVE_OFFLOAD
,

346 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_BSSID_BLACKLIST
,

347 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_EPNO_LIST
,

348 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_HS_LIST
,

349 
	mSLSI_NL80211_VENDOR_SUBCMD_RESET_HS_LIST
,

350 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_RSSI_MONITOR
,

351 
	mSLSI_NL80211_VENDOR_SUBCMD_LSTATS_SUBCMD_SET_STATS
,

352 
	mSLSI_NL80211_VENDOR_SUBCMD_LSTATS_SUBCMD_GET_STATS
,

353 
	mSLSI_NL80211_VENDOR_SUBCMD_LSTATS_SUBCMD_CLEAR_STATS
,

354 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_FEATURE_SET
,

355 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_COUNTRY_CODE
,

356 
	mSLSI_NL80211_VENDOR_SUBCMD_CONFIGURE_ND_OFFLOAD
,

357 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_ROAMING_CAPABILITIES
,

358 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_ROAMING_STATE
,

359 
	mSLSI_NL80211_VENDOR_SUBCMD_SET_LATENCY_MODE
,

360 
	mSLSI_NL80211_VENDOR_SUBCMD_SELECT_TX_POWER_SCENARIO
,

361 
	mSLSI_NL80211_VENDOR_SUBCMD_RESET_TX_POWER_SCENARIO
,

362 
	mSLSI_NL80211_VENDOR_SUBCMD_RTT_GET_CAPABILITIES
 = 
SLSI_NL80211_RTT_SUBCMD_RANGE_START
,

363 
	mSLSI_NL80211_VENDOR_SUBCMD_RTT_RANGE_START
,

364 
	mSLSI_NL80211_VENDOR_SUBCMD_RTT_RANGE_CANCEL
,

365 
	mSLSI_NL80211_VENDOR_SUBCMD_START_LOGGING
 = 
SLSI_NL80211_LOGGING_SUBCMD_RANGE_START
,

366 
	mSLSI_NL80211_VENDOR_SUBCMD_TRIGGER_FW_MEM_DUMP
,

367 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_FW_MEM_DUMP
,

368 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_VERSION
,

369 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_RING_STATUS
,

370 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_RING_DATA
,

371 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_FEATURE
,

372 
	mSLSI_NL80211_VENDOR_SUBCMD_RESET_LOGGING
,

373 
	mSLSI_NL80211_VENDOR_SUBCMD_TRIGGER_DRIVER_MEM_DUMP
,

374 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_DRIVER_MEM_DUMP
,

375 
	mSLSI_NL80211_VENDOR_SUBCMD_START_PKT_FATE_MONITORING
,

376 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_TX_PKT_FATES
,

377 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_RX_PKT_FATES
,

378 
	mSLSI_NL80211_VENDOR_SUBCMD_GET_WAKE_REASON_STATS
,

379 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_ENABLE
 = 
SLSI_NL80211_NAN_SUBCMD_RANGE_START
,

380 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_DISABLE
,

381 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_PUBLISH
,

382 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_PUBLISHCANCEL
,

383 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_SUBSCRIBE
,

384 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_SUBSCRIBECANCEL
,

385 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_TXFOLLOWUP
,

386 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_CONFIG
,

387 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_CAPABILITIES
,

388 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_INTERFACE_CREATE
,

389 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_INTERFACE_DELETE
,

390 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_REQUEST_INITIATOR
,

391 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_INDICATION_RESPONSE
,

392 
	mSLSI_NL80211_VENDOR_SUBCMD_NAN_DATA_END
,

393 
	mSLSI_NL80211_VENDOR_SUBCMD_APF_SET_FILTER
 = 
SLSI_NL80211_APF_SUBCMD_RANGE_START
,

394 
	mSLSI_NL80211_VENDOR_SUBCMD_APF_GET_CAPABILITIES
,

395 
	mSLSI_NL80211_VENDOR_SUBCMD_APF_READ_FILTER


398 
	e¦si_suµ_v’dÜ_subcmds
 {

399 
	mSLSI_NL80211_VENDOR_SUBCMD_UNSPEC
 = 0,

400 
	mSLSI_NL80211_VENDOR_SUBCMD_KEY_MGMT_SET_KEY
,

401 
	mSLSI_NL80211_VENDOR_SUBCMD_ACS_INIT
,

402 
	mSLSI_NL80211_VENDOR_SUBCMD_DEFAULT_SCAN_IES


405 
	e¦si_v’dÜ_ev’t_v®ues
 {

407 
	mSLSI_NL80211_SIGNIFICANT_CHANGE_EVENT
,

408 
	mSLSI_NL80211_HOTLIST_AP_FOUND_EVENT
,

410 
	mSLSI_NL80211_SCAN_RESULTS_AVAILABLE_EVENT
,

411 
	mSLSI_NL80211_FULL_SCAN_RESULT_EVENT
,

412 
	mSLSI_NL80211_SCAN_EVENT
,

414 
	mSLSI_NL80211_HOTLIST_AP_LOST_EVENT
,

416 
	mSLSI_NL80211_VENDOR_SUBCMD_KEY_MGMT_ROAM_AUTH
,

417 
	mSLSI_NL80211_VENDOR_HANGED_EVENT
,

418 
	mSLSI_NL80211_EPNO_EVENT
,

419 
	mSLSI_NL80211_HOTSPOT_MATCH
,

420 
	mSLSI_NL80211_RSSI_REPORT_EVENT
 = 10,

421 
	mSLSI_NL80211_LOGGER_RING_EVENT
,

422 
	mSLSI_NL80211_LOGGER_FW_DUMP_EVENT
,

423 
	mSLSI_NL80211_NAN_RESPONSE_EVENT
,

424 
	mSLSI_NL80211_NAN_PUBLISH_TERMINATED_EVENT
,

425 
	mSLSI_NL80211_NAN_MATCH_EVENT
,

426 
	mSLSI_NL80211_NAN_MATCH_EXPIRED_EVENT
,

427 
	mSLSI_NL80211_NAN_SUBSCRIBE_TERMINATED_EVENT
,

428 
	mSLSI_NL80211_NAN_FOLLOWUP_EVENT
,

429 
	mSLSI_NL80211_NAN_DISCOVERY_ENGINE_EVENT
,

430 
	mSLSI_NL80211_NAN_DISABLED_EVENT
 = 20,

431 
	mSLSI_NL80211_RTT_RESULT_EVENT
,

432 
	mSLSI_NL80211_RTT_COMPLETE_EVENT
,

433 
	mSLSI_NL80211_VENDOR_ACS_EVENT
,

434 
	mSLSI_NL80211_VENDOR_FORWARD_BEACON
,

435 
	mSLSI_NL80211_VENDOR_FORWARD_BEACON_ABORT
,

436 
	mSLSI_NL80211_NAN_TRANSMIT_FOLLOWUP_STATUS
,

437 
	mSLSI_NAN_EVENT_NDP_REQ
,

438 
	mSLSI_NAN_EVENT_NDP_CFM
,

439 
	mSLSI_NAN_EVENT_NDP_END
,

440 
	mSLSI_NL80211_VENDOR_RCL_CHANNEL_LIST_EVENT
 = 30,

441 
	mSLSI_NL80211_VENDOR_POWER_MEASUREMENT_EVENT


444 
	e¦si_Îs_š‹rçû_mode
 {

445 
	mSLSI_LLS_INTERFACE_STA
 = 0,

446 
	mSLSI_LLS_INTERFACE_SOFTAP
 = 1,

447 
	mSLSI_LLS_INTERFACE_IBSS
 = 2,

448 
	mSLSI_LLS_INTERFACE_P2P_CLIENT
 = 3,

449 
	mSLSI_LLS_INTERFACE_P2P_GO
 = 4,

450 
	mSLSI_LLS_INTERFACE_NAN
 = 5,

451 
	mSLSI_LLS_INTERFACE_MESH
 = 6,

452 
	mSLSI_LLS_INTERFACE_UNKNOWN
 = -1

455 
	e¦si_Îs_cÚÃùiÚ_¡©e
 {

456 
	mSLSI_LLS_DISCONNECTED
 = 0,

457 
	mSLSI_LLS_AUTHENTICATING
 = 1,

458 
	mSLSI_LLS_ASSOCIATING
 = 2,

459 
	mSLSI_LLS_ASSOCIATED
 = 3,

460 
	mSLSI_LLS_EAPOL_STARTED
 = 4,

461 
	mSLSI_LLS_EAPOL_COMPLETED
 = 5,

464 
	e¦si_Îs_rßm_¡©e
 {

465 
	mSLSI_LLS_ROAMING_IDLE
 = 0,

466 
	mSLSI_LLS_ROAMING_ACTIVE
 = 1,

470 
	e¦si_Îs_Œaffic_ac
 {

471 
	mSLSI_LLS_AC_VO
 = 0,

472 
	mSLSI_LLS_AC_VI
 = 1,

473 
	mSLSI_LLS_AC_BE
 = 2,

474 
	mSLSI_LLS_AC_BK
 = 3,

475 
	mSLSI_LLS_AC_MAX
 = 4,

479 
	e¦si_Îs_chªÃl_width
 {

480 
	mSLSI_LLS_CHAN_WIDTH_20
 = 0,

481 
	mSLSI_LLS_CHAN_WIDTH_40
 = 1,

482 
	mSLSI_LLS_CHAN_WIDTH_80
 = 2,

483 
	mSLSI_LLS_CHAN_WIDTH_160
 = 3,

484 
	mSLSI_LLS_CHAN_WIDTH_80P80
 = 4,

485 
	mSLSI_LLS_CHAN_WIDTH_5
 = 5,

486 
	mSLSI_LLS_CHAN_WIDTH_10
 = 6,

487 
	mSLSI_LLS_CHAN_WIDTH_INVALID
 = -1

491 
	e¦si_Îs_³”_ty³
 {

492 
	mSLSI_LLS_PEER_STA
,

493 
	mSLSI_LLS_PEER_AP
,

494 
	mSLSI_LLS_PEER_P2P_GO
,

495 
	mSLSI_LLS_PEER_P2P_CLIENT
,

496 
	mSLSI_LLS_PEER_NAN
,

497 
	mSLSI_LLS_PEER_TDLS
,

498 
	mSLSI_LLS_PEER_INVALID
,

502 
	e¦si_’hªûd_loggšg_©Œibu‹s
 {

503 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_DRIVER_VERSION
 = 
SLSI_ATTRIBUTE_START_VAL
,

504 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_VERSION
,

505 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_ID
,

506 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_NAME
,

507 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_FLAGS
,

508 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_VERBOSE_LEVEL
,

509 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_LOG_MAX_INTERVAL
,

510 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_LOG_MIN_DATA_SIZE
,

511 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_DUMP_LEN
,

512 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_FW_DUMP_DATA
,

513 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_DATA
,

514 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_STATUS
,

515 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_RING_NUM
,

516 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_DRIVER_DUMP_LEN
,

517 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_DRIVER_DUMP_DATA
,

518 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_NUM
,

519 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_PKT_FATE_DATA
,

520 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_MAX
,

521 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_INVALID
 = 0,

522 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_TOTAL_CMD_EVENT_WAKE
,

523 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_CMD_EVENT_WAKE_CNT_PTR
,

524 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_CMD_EVENT_WAKE_CNT_SZ
,

525 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_TOTAL_DRIVER_FW_LOCAL_WAKE
,

526 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_DRIVER_FW_LOCAL_WAKE_CNT_PTR
,

527 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_DRIVER_FW_LOCAL_WAKE_CNT_SZ
,

528 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_TOTAL_RX_DATA_WAKE
,

529 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_RX_UNICAST_CNT
,

530 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_RX_MULTICAST_CNT
,

531 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_RX_BROADCAST_CNT
,

532 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_ICMP_PKT
,

533 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_ICMP6_PKT
,

534 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_ICMP6_RA
,

535 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_ICMP6_NA
,

536 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_ICMP6_NS
,

537 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_ICMP4_RX_MULTICAST_CNT
,

538 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_ICMP6_RX_MULTICAST_CNT
,

539 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_OTHER_RX_MULTICAST_CNT
,

540 
	mSLSI_ENHANCED_LOGGING_ATTRIBUTE_WAKE_STATS_MAX
,

543 
	e¦si_¹t_ev’t_©Œibu‹s
 {

544 
	mSLSI_RTT_EVENT_ATTR_ADDR
 = 0,

545 
	mSLSI_RTT_EVENT_ATTR_BURST_NUM
,

546 
	mSLSI_RTT_EVENT_ATTR_MEASUREMENT_NUM
,

547 
	mSLSI_RTT_EVENT_ATTR_SUCCESS_NUM
,

548 
	mSLSI_RTT_EVENT_ATTR_NUM_PER_BURST_PEER
,

549 
	mSLSI_RTT_EVENT_ATTR_STATUS
,

550 
	mSLSI_RTT_EVENT_ATTR_RETRY_AFTER_DURATION
,

551 
	mSLSI_RTT_EVENT_ATTR_TYPE
,

552 
	mSLSI_RTT_EVENT_ATTR_RSSI
,

553 
	mSLSI_RTT_EVENT_ATTR_RSSI_SPREAD
,

554 
	mSLSI_RTT_EVENT_ATTR_TX_PREAMBLE
,

555 
	mSLSI_RTT_EVENT_ATTR_TX_NSS
,

556 
	mSLSI_RTT_EVENT_ATTR_TX_BW
,

557 
	mSLSI_RTT_EVENT_ATTR_TX_MCS
,

558 
	mSLSI_RTT_EVENT_ATTR_TX_RATE
,

559 
	mSLSI_RTT_EVENT_ATTR_RX_PREAMBLE
,

560 
	mSLSI_RTT_EVENT_ATTR_RX_NSS
,

561 
	mSLSI_RTT_EVENT_ATTR_RX_BW
,

562 
	mSLSI_RTT_EVENT_ATTR_RX_MCS
,

563 
	mSLSI_RTT_EVENT_ATTR_RX_RATE
,

564 
	mSLSI_RTT_EVENT_ATTR_RTT
,

565 
	mSLSI_RTT_EVENT_ATTR_RTT_SD
,

566 
	mSLSI_RTT_EVENT_ATTR_RTT_SPREAD
,

567 
	mSLSI_RTT_EVENT_ATTR_DISTANCE_MM
,

568 
	mSLSI_RTT_EVENT_ATTR_DISTANCE_SD_MM
,

569 
	mSLSI_RTT_EVENT_ATTR_DISTANCE_SPREAD_MM
,

570 
	mSLSI_RTT_EVENT_ATTR_TIMESTAMP_US
,

571 
	mSLSI_RTT_EVENT_ATTR_BURST_DURATION_MSN
,

572 
	mSLSI_RTT_EVENT_ATTR_NEGOTIATED_BURST_NUM
,

573 
	mSLSI_RTT_EVENT_ATTR_LCI
,

574 
	mSLSI_RTT_EVENT_ATTR_LCR
,

579 
	e¦si_¹t_³”_ty³
 {

580 
	mSLSI_RTT_PEER_AP
 = 0x1,

581 
	mSLSI_RTT_PEER_STA
,

582 
	mSLSI_RTT_PEER_P2P_GO
,

583 
	mSLSI_RTT_PEER_P2P_CLIENT
,

584 
	mSLSI_RTT_PEER_NAN
,

588 
	e¦si_wifi_¹t_bw
 {

589 
	mSLSI_WIFI_RTT_BW_5
 = 0x01,

590 
	mSLSI_WIFI_RTT_BW_10
 = 0x02,

591 
	mSLSI_WIFI_RTT_BW_20
 = 0x04,

592 
	mSLSI_WIFI_RTT_BW_40
 = 0x08,

593 
	mSLSI_WIFI_RTT_BW_80
 = 0x10,

594 
	mSLSI_WIFI_RTT_BW_160
 = 0x20

598 
	e¦si_wifi_¹t_´—mbË
 {

599 
	mSLSI_WIFI_RTT_PREAMBLE_LEGACY
 = 0x1,

600 
	mSLSI_WIFI_RTT_PREAMBLE_HT
 = 0x2,

601 
	mSLSI_WIFI_RTT_PREAMBLE_VHT
 = 0x4

605 
	e¦si_wifi_¹t_ty³
 {

606 
	mSLSI_RTT_TYPE_1_SIDED
 = 0x1,

607 
	mSLSI_RTT_TYPE_2_SIDED
,

610 
	e¦si_¹t_©Œibu‹
 {

611 
	mSLSI_RTT_ATTRIBUTE_TARGET_CNT
 = 
SLSI_ATTRIBUTE_START_VAL
,

612 
	mSLSI_RTT_ATTRIBUTE_TARGET_INFO
,

613 
	mSLSI_RTT_ATTRIBUTE_TARGET_MAC
,

614 
	mSLSI_RTT_ATTRIBUTE_TARGET_TYPE
,

615 
	mSLSI_RTT_ATTRIBUTE_TARGET_PEER
,

616 
	mSLSI_RTT_ATTRIBUTE_TARGET_CHAN_FREQ
,

617 
	mSLSI_RTT_ATTRIBUTE_TARGET_PERIOD
,

618 
	mSLSI_RTT_ATTRIBUTE_TARGET_NUM_BURST
,

619 
	mSLSI_RTT_ATTRIBUTE_TARGET_NUM_FTM_BURST
,

620 
	mSLSI_RTT_ATTRIBUTE_TARGET_NUM_RETRY_FTM
,

621 
	mSLSI_RTT_ATTRIBUTE_TARGET_NUM_RETRY_FTMR
,

622 
	mSLSI_RTT_ATTRIBUTE_TARGET_LCI
,

623 
	mSLSI_RTT_ATTRIBUTE_TARGET_LCR
,

624 
	mSLSI_RTT_ATTRIBUTE_TARGET_BURST_DURATION
,

625 
	mSLSI_RTT_ATTRIBUTE_TARGET_PREAMBLE
,

626 
	mSLSI_RTT_ATTRIBUTE_TARGET_BW
,

627 
	mSLSI_RTT_ATTRIBUTE_RESULTS_COMPLETE
 = 30,

628 
	mSLSI_RTT_ATTRIBUTE_RESULTS_PER_TARGET
,

629 
	mSLSI_RTT_ATTRIBUTE_RESULT_CNT
,

630 
	mSLSI_RTT_ATTRIBUTE_RESULT
,

631 
	mSLSI_RTT_ATTRIBUTE_TARGET_ID
,

632 
	mSLSI_RTT_ATTRIBUTE_MAX


636 
	e¦si_wifi_¹t_¡©us
 {

637 
	mSLSI_RTT_STATUS_SUCCESS
 = 0,

638 
	mSLSI_RTT_STATUS_FAILURE
,

639 
	mSLSI_RTT_STATUS_FAIL_NO_RSP
,

640 
	mSLSI_RTT_STATUS_FAIL_REJECTED
,

641 
	mSLSI_RTT_STATUS_FAIL_NOT_SCHEDULED_YET
,

642 
	mSLSI_RTT_STATUS_FAIL_TM_TIMEOUT
,

643 
	mSLSI_RTT_STATUS_FAIL_AP_ON_DIFF_CHANNEL
,

644 
	mSLSI_RTT_STATUS_FAIL_NO_CAPABILITY
,

645 
	mSLSI_RTT_STATUS_ABORTED
,

646 
	mSLSI_RTT_STATUS_FAIL_INVALID_TS
,

647 
	mSLSI_RTT_STATUS_FAIL_PROTOCOL
,

648 
	mSLSI_RTT_STATUS_FAIL_SCHEDULE
,

649 
	mSLSI_RTT_STATUS_FAIL_BUSY_TRY_LATER
,

650 
	mSLSI_RTT_STATUS_INVALID_REQ
,

651 
	mSLSI_RTT_STATUS_NO_WIFI
,

652 
	mSLSI_RTT_STATUS_FAIL_FTM_PARAM_OVERRIDE


656 
	s¦si_wifi_šfÜm©iÚ_–em’t
 {

657 
u8
 
	mid
;

658 
u8
 
	mËn
;

659 
u8
 
	md©a
[];

662 
	s¦si_Æ_gsÿn_ÿ·b™›s
 {

663 
	mmax_sÿn_ÿche_size
;

664 
	mmax_sÿn_buck‘s
;

665 
	mmax_­_ÿche_³r_sÿn
;

666 
	mmax_rssi_§m¶e_size
;

667 
	mmax_sÿn_»pÜtšg_th»shŞd
;

668 
	mmax_hÙli¡_­s
;

669 
	mmax_hÙli¡_ssids
;

670 
	mmax_signifiÿÁ_wifi_chªge_­s
;

671 
	mmax_bssid_hi¡Üy_’Œ›s
;

672 
	mmax_numb”_•no_ÃtwÜks
;

673 
	mmax_numb”_•no_ÃtwÜks_by_ssid
;

674 
	mmax_numb”_of_wh™e_li¡ed_ssid
;

677 
	s¦si_Æ_chªÃl_·¿m
 {

678 
	mchªÃl
;

679 
	mdw–l_time_ms
;

680 
	m·ssive
;

683 
	s¦si_Æ_buck‘_·¿m
 {

684 
	mbuck‘_šdex
;

685 
wifi_bªd
 
	mbªd
;

686 
	m³riod
;

687 
u8
 
	m»pÜt_ev’ts
;

688 
	mmax_³riod
;

689 
	mexpÚ’t
;

690 
	m¡•_couÁ
;

691 
	mnum_chªÃls
;

692 
¦si_Æ_chªÃl_·¿m
 
	mchªÃls
[
SLSI_GSCAN_MAX_CHANNELS
];

695 
	s¦si_Æ_gsÿn_·¿m
 {

696 
	mba£_³riod
;

697 
	mmax_­_³r_sÿn
;

698 
	m»pÜt_th»shŞd_³rûÁ
;

699 
	m»pÜt_th»shŞd_num_sÿns
;

700 
	mnum_buck‘s
;

701 
¦si_Æ_buck‘_·¿m
 
	mÆ_buck‘
[
SLSI_GSCAN_MAX_BUCKETS
];

704 
	s¦si_Æ_sÿn_»suÉ_·¿m
 {

705 
u64
 
	mts
;

706 
u8
 
	mssid
[
IEEE80211_MAX_SSID_LEN
 + 1];

707 
u8
 
	mbssid
[6];

708 
	mchªÃl
;

709 
	mrssi
;

710 
s64
 
	m¹t
;

711 
s64
 
	m¹t_sd
;

712 
u16
 
	mb—cÚ_³riod
;

713 
u16
 
	mÿ·b™y
;

714 
u32
 
	m›_Ëngth
;

715 
u8
 
	m›_d©a
[1];

718 
	s¦si_buck‘
 {

719 
boŞ
 
	mu£d
;

720 
boŞ
 
	mfÜ_chªge_Œackšg
;

721 
u8
 
	m»pÜt_ev’ts
;

722 
u16
 
	msÿn_id
;

723 
	msÿn_cyşe
;

724 
¦si_gsÿn
 *
	mgsÿn
;

727 
	s¦si_gsÿn
 {

728 
	mmax_­_³r_sÿn
;

729 
	m»pÜt_th»shŞd_³rûÁ
;

730 
	m»pÜt_th»shŞd_num_sÿns
;

731 
	mnum_sÿns
;

732 
	mnum_buck‘s
;

733 
¦si_Æ_buck‘_·¿m
 
	mÆ_buck‘
;

734 
¦si_buck‘
 *
	mbuck‘
[
SLSI_GSCAN_MAX_BUCKETS_PER_GSCAN
];

735 
¦si_gsÿn
 *
	mÃxt
;

738 
	s¦si_gsÿn_·¿m
 {

739 
¦si_Æ_buck‘_·¿m
 *
	mÆ_buck‘
;

740 
¦si_buck‘
 *
	mbuck‘
;

743 
	s¦si_gsÿn_»suÉ
 {

744 
¦si_gsÿn_»suÉ
 *
	mhÃxt
;

745 
	msÿn_cyşe
;

746 
	msÿn_»s_Ën
;

747 
	mªqp_Ëngth
;

748 
¦si_Æ_sÿn_»suÉ_·¿m
 
	mÆ_sÿn_»s
;

751 
	s¦si_•no_ssid_·¿m
 {

752 
u16
 
	mæags
;

753 
u8
 
	mssid_Ën
;

754 
u8
 
	mssid
[32];

757 
	s¦si_•no_·¿m
 {

758 
u16
 
	mmš_5g_rssi
;

759 
u16
 
	mmš_2g_rssi
;

760 
u16
 
	mš™Ÿl_scÜe_max
;

761 
u8
 
	mcu¼’t_cÚÃùiÚ_bÚus
;

764 
u8
 
	m§me_ÃtwÜk_bÚus
;

765 
u8
 
	m£cu»_bÚus
;

766 
u8
 
	mbªd_5g_bÚus
;

767 
u8
 
	mnum_ÃtwÜks
;

768 
¦si_•no_ssid_·¿m
 
	m•no_ssid
[];

771 
	s¦si_•no_hs2_·¿m
 {

772 
u32
 
	mid
;

773 
u8
 
	m»®m
[256];

774 
s64
 
	mrßmšg_cÚsÜtium_ids
[16];

775 
u8
 
	m¶mn
[3];

778 
	s¦si_rssi_mÚ™Ü_evt
 {

779 
s16
 
	mrssi
;

780 
u8
 
	mbssid
[
ETH_ALEN
];

784 
	s¦si_Îs_chªÃl_šfo
 {

785 
¦si_Îs_chªÃl_width
 
	mwidth
;

786 
	mûÁ”_äeq
;

787 
	mûÁ”_äeq0
;

788 
	mûÁ”_äeq1
;

792 
	s¦si_Îs_chªÃl_¡©
 {

793 
¦si_Îs_chªÃl_šfo
 
	mchªÃl
;

794 
u32
 
	mÚ_time
;

795 
u32
 
	mcÿ_busy_time
;

799 
	s¦si_Îs_¿‹
 {

800 
u32
 
	m´—mbË
 :3;

801 
u32
 
	mnss
 :2;

802 
u32
 
	mbw
 :3;

803 
u32
 
	m¿‹_mcs_idx
 :8;

804 
u32
 
	m»£rved
 :16;

805 
u32
 
	mb™¿‹
;

809 
	s¦si_Îs_¿‹_¡©
 {

810 
¦si_Îs_¿‹
 
	m¿‹
;

811 
u32
 
	mtx_mpdu
;

812 
u32
 
	mrx_mpdu
;

813 
u32
 
	mmpdu_lo¡
;

814 
u32
 
	m»Œ›s
;

815 
u32
 
	m»Œ›s_shÜt
;

816 
u32
 
	m»Œ›s_lÚg
;

820 
	s¦si_Îs_¿dio_¡©
 {

821 
	m¿dio
;

822 
u32
 
	mÚ_time
;

823 
u32
 
	mtx_time
;

824 
u32
 
	mrx_time
;

825 
u32
 
	mÚ_time_sÿn
;

826 
u32
 
	mÚ_time_nbd
;

827 
u32
 
	mÚ_time_gsÿn
;

828 
u32
 
	mÚ_time_rßm_sÿn
;

829 
u32
 
	mÚ_time_²o_sÿn
;

830 
u32
 
	mÚ_time_hs20
;

831 
u32
 
	mnum_chªÃls
;

832 
¦si_Îs_chªÃl_¡©
 
	mchªÃls
[];

835 
	s¦si_Îs_š‹rçû_lšk_Ïy”_šfo
 {

836 
¦si_Îs_š‹rçû_mode
 
	mmode
;

837 
u8
 
	mmac_addr
[6];

838 
¦si_Îs_cÚÃùiÚ_¡©e
 
	m¡©e
;

839 
¦si_Îs_rßm_¡©e
 
	mrßmšg
;

840 
u32
 
	mÿ·b™›s
;

841 
u8
 
	mssid
[33];

842 
u8
 
	mbssid
[6];

843 
u8
 
	m­_couÁry_¡r
[3];

844 
u8
 
	mcouÁry_¡r
[3];

848 
	s¦si_Îs_³”_šfo
 {

849 
¦si_Îs_³”_ty³
 
	mty³
;

850 
u8
 
	m³”_mac_add»ss
[6];

851 
u32
 
	mÿ·b™›s
;

852 
u32
 
	mnum_¿‹
;

853 
¦si_Îs_¿‹_¡©
 
	m¿‹_¡©s
[];

857 
	s¦si_Îs_wmm_ac_¡©
 {

858 
¦si_Îs_Œaffic_ac
 
	mac
;

859 
u32
 
	mtx_mpdu
;

860 
u32
 
	mrx_mpdu
;

861 
u32
 
	mtx_mÿ¡
;

862 
u32
 
	mrx_mÿ¡
;

863 
u32
 
	mrx_ampdu
;

864 
u32
 
	mtx_ampdu
;

865 
u32
 
	mmpdu_lo¡
;

866 
u32
 
	m»Œ›s
;

867 
u32
 
	m»Œ›s_shÜt
;

868 
u32
 
	m»Œ›s_lÚg
;

869 
u32
 
	mcÚ‹ÁiÚ_time_mš
;

870 
u32
 
	mcÚ‹ÁiÚ_time_max
;

871 
u32
 
	mcÚ‹ÁiÚ_time_avg
;

872 
u32
 
	mcÚ‹ÁiÚ_num_§m¶es
;

875 
	s¦si_rx_d©a_út_d‘as
 {

876 
	mrx_uniÿ¡_út
;

877 
	mrx_muÉiÿ¡_út
;

878 
	mrx_brßdÿ¡_út
;

881 
	s¦si_rx_wake_pkt_ty³_şassifiÿtiÚ
 {

882 
	micmp_pkt
;

883 
	micmp6_pkt
;

884 
	micmp6_¿
;

885 
	micmp6_Ç
;

886 
	micmp6_ns
;

889 
	s¦si_rx_muÉiÿ¡_út
 {

890 
	mv4_rx_muÉiÿ¡_addr_út
;

891 
	mv6_rx_muÉiÿ¡_addr_út
;

892 
	mÙh”_rx_muÉiÿ¡_addr_út
;

904 
	s¦si_wÏn_driv”_wake_»asÚ_út
 {

905 
	mtÙ®_cmd_ev’t_wake
;

906 *
	mcmd_ev’t_wake_út
;

907 
	mcmd_ev’t_wake_út_sz
;

908 
	mcmd_ev’t_wake_út_u£d
;

910 
	mtÙ®_driv”_fw_loÿl_wake
;

911 *
	mdriv”_fw_loÿl_wake_út
;

912 
	mdriv”_fw_loÿl_wake_út_sz
;

913 
	mdriv”_fw_loÿl_wake_út_u£d
;

915 
	mtÙ®_rx_d©a_wake
;

916 
¦si_rx_d©a_út_d‘as
 
	mrx_wake_d‘as
;

917 
¦si_rx_wake_pkt_ty³_şassifiÿtiÚ
 
	mrx_wake_pkt_şassifiÿtiÚ_šfo
;

918 
¦si_rx_muÉiÿ¡_út
 
	mrx_muÉiÿ¡_wake_pkt_šfo
;

922 
	s¦si_Îs_içû_¡©
 {

923 *
	miçû
;

924 
¦si_Îs_š‹rçû_lšk_Ïy”_šfo
 
	mšfo
;

925 
u32
 
	mb—cÚ_rx
;

926 
u64
 
	mav”age_tsf_off£t
;

927 
u32
 
	mËaky_­_d‘eùed
;

928 
u32
 
	mËaky_­_avg_num_äames_Ëaked
;

929 
u32
 
	mËaky_­_gu¬d_time
;

930 
u32
 
	mmgmt_rx
;

931 
u32
 
	mmgmt_aùiÚ_rx
;

932 
u32
 
	mmgmt_aùiÚ_tx
;

933 
	mrssi_mgmt
;

934 
	mrssi_d©a
;

935 
	mrssi_ack
;

936 
¦si_Îs_wmm_ac_¡©
 
	mac
[
SLSI_LLS_AC_MAX
];

937 
u32
 
	mnum_³”s
;

938 
¦si_Îs_³”_šfo
 
	m³”_šfo
[];

941 
	e¦si_wifi_h®_­i_»tuº_ty³s
 {

942 
	mWIFI_HAL_SUCCESS
 = 0,

943 
	mWIFI_HAL_ERROR_NONE
 = 0,

944 
	mWIFI_HAL_ERROR_UNKNOWN
 = -1,

945 
	mWIFI_HAL_ERROR_UNINITIALIZED
 = -2,

946 
	mWIFI_HAL_ERROR_NOT_SUPPORTED
 = -3,

947 
	mWIFI_HAL_ERROR_NOT_AVAILABLE
 = -4,

948 
	mWIFI_HAL_ERROR_INVALID_ARGS
 = -5,

949 
	mWIFI_HAL_ERROR_INVALID_REQUEST_ID
 = -6,

950 
	mWIFI_HAL_ERROR_TIMED_OUT
 = -7,

951 
	mWIFI_HAL_ERROR_TOO_MANY_REQUESTS
 = -8,

952 
	mWIFI_HAL_ERROR_OUT_OF_MEMORY
 = -9

955 
	s¦si_¹t_ÿ·b™›s
 {

956 
u8
 
	m¹t_Úe_sided_suµÜ‹d
;

957 
u8
 
	m¹t_ám_suµÜ‹d
;

958 
u8
 
	mlci_suµÜt
;

959 
u8
 
	mlü_suµÜt
;

960 
u8
 
	m´—mbË_suµÜt
;

961 
u8
 
	mbw_suµÜt
;

962 
u8
 
	m»¥Úd”_suµÜ‹d
;

963 
u8
 
	mmc_v”siÚ
;

969 
	s¦si_¹t_id_·¿ms
 {

970 
u8
 
	mçpi_»q_id
;

971 
u32
 
	mh®_»que¡_id
;

972 
u8
 
	m³”_ty³
;

973 
u32
 
	m³”_couÁ
;

974 
u8
 
	m³”s
[];

978 
	s¦si_¹t_cÚfig
 {

979 
u8
 
	m³”_addr
[
ETH_ALEN
];

980 
u8
 
	m¹t_³”
;

981 
u8
 
	m¹t_ty³
;

982 
u16
 
	mchªÃl_äeq
;

983 
u16
 
	mchªÃl_šfo
;

984 
u8
 
	mbur¡_³riod
;

988 
u8
 
	mnum_bur¡
;

999 
u8
 
	mnum_äames_³r_bur¡
;

1007 
u8
 
	mnum_»Œ›s_³r_ámr
;

1011 
u8
 
	mbur¡_du¿tiÚ
;

1020 
u16
 
	m´—mbË
;

1021 
u16
 
	mbw
;

1022 
u16
 
	mLCI_»que¡
;

1023 
u16
 
	mLCR_»que¡
;

1026 
	#MAX_24G_CHANNELS
 14

	)

1027 
	#MAX_5G_CHANNELS
 25

	)

1028 
	#MAX_CHAN_VALUE_ACS
 (
MAX_24G_CHANNELS
 + 
MAX_5G_CHANNELS
)

	)

1029 
	#MAX_AP_THRESHOLD
 10

	)

1031 
	s¦si_acs_chª_šfo
 {

1032 
u16
 
	mchª
;

1033 
u8
 
	mnum_­
;

1034 
u8
 
	mnum_bss_lßd_­
;

1035 
u8
 
	mtÙ®_chª_utiz©iÚ
;

1036 
u8
 
	mavg_chª_utiz©iÚ
;

1037 
	mrssi_çùÜ
;

1038 
	madj_rssi_çùÜ
;

1041 
	s¦si_acs_£Ëùed_chªÃls
 {

1042 
u8
 
	m´i_chªÃl
;

1043 
u8
 
	m£c_chªÃl
;

1044 
u8
 
	mvht_£g0_ûÁ”_ch
;

1045 
u8
 
	mvht_£g1_ûÁ”_ch
;

1046 
u16
 
	mch_width
;

1047 
¦si_acs_hw_mode
 
	mhw_mode
;

1050 
	s¦si_acs_»que¡
 {

1051 
¦si_acs_chª_šfo
 
	macs_chª_šfo
[
MAX_CHAN_VALUE_ACS
];

1052 
u8
 
	mhw_mode
;

1053 
u16
 
	mch_width
;

1054 
u8
 
	mch_li¡_Ën
;

1057 
¦si_Æ80211_v’dÜ_š™
(
¦si_dev
 *
sdev
);

1058 
¦si_Æ80211_v’dÜ_deš™
(
¦si_dev
 *
sdev
);

1059 
u8
 
¦si_gsÿn_g‘_sÿn_pŞicy
(
wifi_bªd
 
bªd
);

1060 
¦si_gsÿn_hªdË_sÿn_»suÉ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
u16
 
sÿn_id
, 
boŞ
 
sÿn_dÚe
);

1061 
¦si_gsÿn_hash_»move
(
¦si_dev
 *
sdev
, 
u8
 *
mac
);

1062 
¦si_rx_signifiÿÁ_chªge_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1063 
¦si_gsÿn_®loc_buck‘s
(
¦si_dev
 *
sdev
, 
¦si_gsÿn
 *
gsÿn
, 
num_buck‘s
);

1064 
¦si_v’dÜ_ev’t
(
¦si_dev
 *
sdev
, 
ev’t_id
, cÚ¡ *
d©a
, 
Ën
);

1065 
¦si_mib_g‘_gsÿn_ÿp
(
¦si_dev
 *
sdev
, 
¦si_Æ_gsÿn_ÿ·b™›s
 *
ÿp
);

1066 
¦si_rx_rssi_»pÜt_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1067 
¦si_mib_g‘_­f_ÿp
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
);

1068 
¦si_mib_g‘_¹t_ÿp
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_¹t_ÿ·b™›s
 *
ÿp
);

1069 
¦si_rx_¿nge_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1070 
¦si_rx_¿nge_dÚe_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1071 
¦si_tx_¿‹_ÿlc
(
sk_buff
 *
Æ_skb
, 
u16
 
fw_¿‹
, 
»s
, 
boŞ
 
tx_¿‹
);

1072 
¦si_rx_ev’t_log_šdiÿtiÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1073 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


1074 *
¦si_´št_ev’t_Çme
(
ev’t_id
);

1077 
šlše
 
boŞ
 
	$¦si_is_gsÿn_id
(
u16
 
sÿn_id
)

1079 ià((
sÿn_id
 >ğ
SLSI_GSCAN_SCAN_ID_START
è&& (sÿn_id <ğ
SLSI_GSCAN_SCAN_ID_END
))

1080  
Œue
;

1082  
çl£
;

1083 
	}
}

1085 
šlše
 
¦si_Îs_Œaffic_ac
 
	$¦si_çpi_to_ªdroid_Œaffic_q
(
¦si_Œaffic_q
 
çpi_q
)

1087 
çpi_q
) {

1088 
SLSI_TRAFFIC_Q_BE
:

1089  
SLSI_LLS_AC_BE
;

1090 
SLSI_TRAFFIC_Q_BK
:

1091  
SLSI_LLS_AC_BK
;

1092 
SLSI_TRAFFIC_Q_VI
:

1093  
SLSI_LLS_AC_VI
;

1094 
SLSI_TRAFFIC_Q_VO
:

1095  
SLSI_LLS_AC_VO
;

1097  
SLSI_LLS_AC_MAX
;

1099 
	}
}

	@nl80211_vendor_nan.c

7 
	~<lšux/time.h
>

8 
	~"cfg80211_İs.h
"

9 
	~"debug.h
"

10 
	~"mgt.h
"

11 
	~"mlme.h
"

13 
Ãt_deviû
 *
	$¦si_Çn_g‘_Ãtdev
(
¦si_dev
 *
sdev
)

15 #ià
CONFIG_SCSC_WLAN_MAX_INTERFACES
 >= 4

16  
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_NAN
);

18  
NULL
;

20 
	}
}

22 *
	$¦si_Çn_cÚv”t_by‹_to_¡ršg
(
Ëngth
, 
u8
 *
by‹_¡ršg
)

24 
šfo_¡ršg
[61] = {0};

25 
Ën
 = 
Ëngth
 > 20 ? 20 :†ength;

26 
i
 = 0, 
max_size
 = 61, 
¦’
 = 0;

28 
i
 = 0; i < 
Ën
 && 
¦’
 < 
max_size
 - 3; i++)

29 
¦’
 +ğ
	`¢´štf
(&
šfo_¡ršg
[¦’], 61 - sËn, "%02x ", 
by‹_¡ršg
[
i
]);

30 
šfo_¡ršg
[
¦’
] = '\0';

31  
šfo_¡ršg
;

32 
	}
}

34 
	$¦si_Çn_dump_vif_d©a
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
)

36 
¦si_vif_Çn
 
Çn
 = 
ndev_vif
->nan;

37 
¦si_Çn_discov”y_šfo
 *
disc_šfo
 = 
Çn
.disc_info;

38 
i
 = 0;

40 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

41 
	`SLSI_INFO
(
sdev
, "S”viû Id_M­: 0x%x, fŞlowup_id_m­: 0x%x,‚dp_š¡ªû_id_m­: 0x%x\n", 
Çn
.
£rviû_id_m­
,

42 
Çn
.
fŞlowup_id_m­
,‚ª.
ndp_š¡ªû_id_m­
);

43 
	`SLSI_INFO
(
sdev
, "Ãxt_£rviû_id: 0x%x,‚ext_ndp_š¡ªû_id: 0x%x\n", 
Çn
.
Ãxt_£rviû_id
,‚ª.
Ãxt_ndp_š¡ªû_id
);

44 
i
 = 0; i < 
SLSI_NAN_MAX_NDP_INSTANCES
; i++) {

45 
	`SLSI_INFO
(
sdev
, "NDL Li¡…“r_nmi: " 
MACSTR
 ",‚dp_couÁ:%d\n", 
	`MAC2STR
(
Çn
.
ndl_li¡
[
i
].
³”_nmi
),

46 
Çn
.
ndl_li¡
[
i
].
ndp_couÁ
);

47 
	`SLSI_INFO
(
sdev
, "ndp_ndi: " 
MACSTR
 ",‚dp_š¡ªû_id2ndl_vif: %d\n", 
	`MAC2STR
(
Çn
.
ndp_ndi
[
i
]),‚ª.
ndp_š¡ªû_id2ndl_vif
[i]);

48 
	`SLSI_INFO
(
sdev
, "ndp_loÿl_ndp_š¡ªû_id: %d,‚dp_¡©e: %d\n", 
Çn
.
ndp_loÿl_ndp_š¡ªû_id
[
i
],‚ª.
ndp_¡©e
[i]);

50 
	`SLSI_INFO
(
sdev
, "di§bË_şu¡”_m”ge: %d\n", 
Çn
.
di§bË_şu¡”_m”ge
);

51 
i
 = 0; i < 
SLSI_NAN_MAX_SERVICE_ID
 + 1; i++)

52 
	`SLSI_INFO
(
sdev
, "Çn_sdf_æags: %d\n", 
Çn
.
Çn_sdf_æags
[
i
]);

53 
	`SLSI_INFO
(
sdev
, "loÿl_nmi: " 
MACSTR
 ", clu¡”_id: " MACSTR "\n", 
	`MAC2STR
(
Çn
.
loÿl_nmi
), MAC2STRÒª.
şu¡”_id
));

54 
	`SLSI_INFO
(
sdev
, "¡©e: %d,„Şe: %d, o³¿tšg_chªÃl: %d, %d\n", 
Çn
.
¡©e
,‚ª.
rŞe
,

55 
Çn
.
İ”©šg_chªÃl
[0],‚an.operating_channel[1]);

56 
	`SLSI_INFO
(
sdev
, "master_pref_value: %d,‡mr: 0x%08x%08x, hopcount: %d\n",

57 
Çn
.
ma¡”_´ef_v®ue
,‚ª.
amr_high”
,‚ª.
amr_low”
,‚ª.
hİcouÁ
);

58 
	`SLSI_INFO
(
sdev
, "¿ndom_mac_š‹rv®_£c: %d\n", 
Çn
.
¿ndom_mac_š‹rv®_£c
);

59 
	`SLSI_INFO
(
sdev
, "m©chid: %d\n", 
Çn
.
m©chid
);

60 
disc_šfo
) {

61 
	`SLSI_INFO
(
sdev
, "Disc_InfØ³”_addr: " 
MACSTR
 ", sessiÚ_id: %d, m©ch_id: %d", 
	`MAC2STR
(
disc_šfo
->
³”_addr
),

62 
disc_šfo
->
£ssiÚ_id
, disc_šfo->
m©ch_id
);

63 
disc_šfo
 = disc_šfo->
Ãxt
;

65 
	}
}

67 
	$¦si_Çn_g‘_Ãw_id
(
u32
 
id_m­
, 
max_ids
, 
¡¬t_idx
)

69 
i
;

71 ià(
¡¬t_idx
 > 
max_ids
)

74 ià(!
¡¬t_idx
)

75 
¡¬t_idx
 = 1;

77 
i
 = 
¡¬t_idx
; i <ğ
max_ids
; i++) {

78 ià(!(
id_m­
 & 
	`BIT
(
i
)))

79  
i
;

81 
i
 = 1; i < 
¡¬t_idx
; i++) {

82 ià(!(
id_m­
 & 
	`BIT
(
i
)))

83  
i
;

86 
	}
}

88 
	$¦si_Çn_g‘_Ãw_publish_id
(
Ãtdev_vif
 *
ndev_vif
)

90 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

91  
	`¦si_Çn_g‘_Ãw_id
(
ndev_vif
->
Çn
.
£rviû_id_m­
, 
SLSI_NAN_MAX_SERVICE_ID
,

92 
ndev_vif
->
Çn
.
Ãxt_£rviû_id
);

93 
	}
}

95 
	$¦si_Çn_g‘_Ãw_subsüibe_id
(
Ãtdev_vif
 *
ndev_vif
)

97 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

98  
	`¦si_Çn_g‘_Ãw_id
(
ndev_vif
->
Çn
.
£rviû_id_m­
, 
SLSI_NAN_MAX_SERVICE_ID
,

99 
ndev_vif
->
Çn
.
Ãxt_£rviû_id
);

100 
	}
}

102 
boŞ
 
	$¦si_Çn_is_publish_id_aùive
(
Ãtdev_vif
 *
ndev_vif
, 
u32
 
id
)

104 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

105  
ndev_vif
->
Çn
.
£rviû_id_m­
 & 
	`BIT
(
id
);

106 
	}
}

108 
boŞ
 
	$¦si_Çn_is_subsüibe_id_aùive
(
Ãtdev_vif
 *
ndev_vif
, 
u32
 
id
)

110 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

111  
ndev_vif
->
Çn
.
£rviû_id_m­
 & 
	`BIT
(
id
);

112 
	}
}

114 
	$¦si_Çn_g‘_Ãw_ndp_š¡ªû_id
(
Ãtdev_vif
 *
ndev_vif
)

116 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

117  
	`¦si_Çn_g‘_Ãw_id
(
ndev_vif
->
Çn
.
ndp_š¡ªû_id_m­
, 
SLSI_NAN_MAX_NDP_INSTANCES
,

118 
ndev_vif
->
Çn
.
Ãxt_ndp_š¡ªû_id
);

119 
	}
}

121 
	$¦si_Çn_push_fŞlowup_ids
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
m©ch_id
, u16 
Œªs_id
)

123 
i
;

124 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

126 
i
 = 0; i < 
SLSI_NAN_MAX_HOST_FOLLOWUP_REQ
; i++) {

127 ià(!
ndev_vif
->
Çn
.
fŞlowup_Œªs_id_m­
[
i
][0]) {

128 
ndev_vif
->
Çn
.
fŞlowup_Œªs_id_m­
[
i
][0] = 
m©ch_id
;

129 
ndev_vif
->
Çn
.
fŞlowup_Œªs_id_m­
[
i
][1] = 
Œªs_id
;

130  
i
;

135 
	}
}

137 
	$¦si_Çn_pİ_fŞlowup_ids
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
m©ch_id
)

139 
i
;

140 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

142 
i
 = 0; i < 
SLSI_NAN_MAX_HOST_FOLLOWUP_REQ
; i++) {

143 ià(
ndev_vif
->
Çn
.
fŞlowup_Œªs_id_m­
[
i
][0] =ğ
m©ch_id
) {

144 
ndev_vif
->
Çn
.
fŞlowup_Œªs_id_m­
[
i
][0] = 0;

145 
ndev_vif
->
Çn
.
fŞlowup_Œªs_id_m­
[
i
][1] = 0;

149 
	}
}

151 
u16
 
	$¦si_Çn_g‘_fŞlowup_Œªs_id
(
Ãtdev_vif
 *
ndev_vif
, 
u16
 
m©ch_id
)

153 
i
;

155 
i
 = 0; i < 
SLSI_NAN_MAX_HOST_FOLLOWUP_REQ
; i++) {

156 ià(
ndev_vif
->
Çn
.
fŞlowup_Œªs_id_m­
[
i
][0] =ğ
m©ch_id
)

157  
ndev_vif
->
Çn
.
fŞlowup_Œªs_id_m­
[
i
][1];

160 
	}
}

162 
	$¦si_Çn_´e_check
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, *
»t
, *
»¶y_¡©us
)

164 *
»t
 = 
WIFI_HAL_SUCCESS
;

165 *
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

166 ià(!
dev
) {

167 
	`SLSI_ERR
(
sdev
, "No NAN interface\n");

168 *
»t
 = -
WIFI_HAL_ERROR_NOT_SUPPORTED
;

169 *
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NAN_NOT_ALLOWED
;

172 ià(!
	`¦si_dev_Çn_suµÜ‹d
(
sdev
)) {

173 
	`SLSI_ERR
(
sdev
, "NAN‚Ù‡Îowed(mib:%d)\n", sdev->
Çn_’abËd
);

174 *
»t
 = 
WIFI_HAL_ERROR_NOT_SUPPORTED
;

175 *
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NAN_NOT_ALLOWED
;

177 
	}
}

179 
	$¦si_Çn_ndp_Ãw_’Œy
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
ndp_š¡ªû_id
,

180 
u16
 
ndl_vif_id
, 
u8
 *
loÿl_ndi
, u8 *
³”_nmi
)

182 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

183 
u16
 
ndl_id
;

185 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

187 ià(
ndl_vif_id
 < 
SLSI_NAN_DATA_IFINDEX_START
 ||

188 
ndl_vif_id
 >ğ
SLSI_NAN_DATA_IFINDEX_START
 + 
SLSI_NAN_MAX_NDP_INSTANCES
) {

189 
	`SLSI_ERR
(
sdev
, "Inv®id‚dl_vif:%d\n", 
ndl_vif_id
);

193 ià(
ndp_š¡ªû_id
 =ğ0 ||‚dp_š¡ªû_id > 
SLSI_NAN_MAX_NDP_INSTANCES
) {

194 
	`SLSI_ERR
(
sdev
, "Inv®id‚dp:%d\n", 
ndp_š¡ªû_id
);

198 
ndl_id
 = 
ndl_vif_id
 - 
SLSI_NAN_DATA_IFINDEX_START
;

199 ià(
ndev_vif
->
Çn
.
ndl_li¡
[
ndl_id
].
ndp_couÁ
 < 0 ||

200 
ndev_vif
->
Çn
.
ndl_li¡
[
ndl_id
].
ndp_couÁ
 > 
SLSI_NAN_MAX_NDP_INSTANCES
) {

201 
	`SLSI_WARN
(
sdev
, "improper‚dp count(%d) for vif_id(%d)\n",

202 
ndev_vif
->
Çn
.
ndl_li¡
[
ndl_id
].
ndp_couÁ
, 
ndl_vif_id
);

205 
ndev_vif
->
Çn
.
ndp_š¡ªû_id_m­
 |ğ(
u32
)
	`BIT
(
ndp_š¡ªû_id
);

206 ià(
³”_nmi
)

207 
	`‘h”_addr_cİy
(
ndev_vif
->
Çn
.
ndl_li¡
[
ndl_id
].
³”_nmi
,…eer_nmi);

208 
ndev_vif
->
Çn
.
ndl_li¡
[
ndl_id
].
ndp_couÁ
++;

209 ià(
loÿl_ndi
)

210 
	`‘h”_addr_cİy
(
ndev_vif
->
Çn
.
ndp_ndi
[
ndp_š¡ªû_id
 - 1], 
loÿl_ndi
);

211 
ndev_vif
->
Çn
.
ndp_š¡ªû_id2ndl_vif
[
ndp_š¡ªû_id
 - 1] = 
ndl_vif_id
;

212 
ndev_vif
->
Çn
.
ndp_¡©e
[
ndp_š¡ªû_id
 - 1] = 
ndp_¦Ù_¡©us_š_u£
;

214 
	}
}

216 
	$¦si_Çn_ndp_d–_’Œy
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
ndp_š¡ªû_id
, cÚ¡ 
boŞ
 
ndl_vif_locked
)

218 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

219 
Ãtdev_vif
 *
ndev_d©a_vif
;

220 
Ãt_deviû
 *
d©a_dev
;

221 
u16
 
ndl_vif_id
, 
ndl_id
;

223 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

225 ià(
ndp_š¡ªû_id
 =ğ0 ||‚dp_š¡ªû_id > 
SLSI_NAN_MAX_NDP_INSTANCES
) {

226 
	`SLSI_WARN
(
sdev
, "Inv®id‚d°In¡ªû Id:%d\n", 
ndp_š¡ªû_id
);

230 
ndl_vif_id
 = 
ndev_vif
->
Çn
.
ndp_š¡ªû_id2ndl_vif
[
ndp_š¡ªû_id
 - 1];

231 ià(
ndl_vif_id
 < 
SLSI_NAN_DATA_IFINDEX_START
 ||

232 
ndl_vif_id
 >ğ
SLSI_NAN_DATA_IFINDEX_START
 + 
SLSI_NAN_MAX_NDP_INSTANCES
) {

233 
	`SLSI_WARN
(
sdev
, "Inv®id‚dl_vif:%d\n", 
ndl_vif_id
);

237 
ndl_id
 = 
ndl_vif_id
 - 
SLSI_NAN_DATA_IFINDEX_START
;

238 
ndev_vif
->
Çn
.
ndp_š¡ªû_id_m­
 &ğ~(
u32
)
	`BIT
(
ndp_š¡ªû_id
);

239 
ndev_vif
->
Çn
.
ndl_li¡
[
ndl_id
].
ndp_couÁ
--;

240 
d©a_dev
 = 
	`¦si_g‘_Ãtdev_by_mac_addr
(
sdev
, 
ndev_vif
->
Çn
.
ndp_ndi
[
ndp_š¡ªû_id
 - 1],

241 
SLSI_NAN_DATA_IFINDEX_START
);

242 ià(
d©a_dev
) {

243 
ndev_d©a_vif
 = 
	`Ãtdev_´iv
(
d©a_dev
);

244 ià(!
ndl_vif_locked
)

245 
	`SLSI_MUTEX_LOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

247 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_d©a_vif
->
vif_mu‹x
));

248 ià(
ndev_d©a_vif
->
Çn
.
ndp_couÁ
 == 0)

249 
ndev_d©a_vif
->
aùiv©ed
 = 
çl£
;

250 ià(!
ndl_vif_locked
)

251 
	`SLSI_MUTEX_UNLOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

253 ià(
ndev_vif
->
Çn
.
ndl_li¡
[
ndl_id
].
ndp_couÁ
 == 0)

254 
	`¦si_‘h_z”o_addr
(
ndev_vif
->
Çn
.
ndl_li¡
[
ndl_id
].
³”_nmi
);

255 
ndev_vif
->
Çn
.
ndp_š¡ªû_id2ndl_vif
[
ndp_š¡ªû_id
 - 1] = 0;

256 
	`¦si_‘h_z”o_addr
(
ndev_vif
->
Çn
.
ndp_ndi
[
ndp_š¡ªû_id
 - 1]);

257 ià(
ndev_vif
->
Çn
.
ndl_li¡
[
ndl_id
].
ndp_couÁ
 < 0)

258 
	`SLSI_WARN
(
sdev
, "ndp_count is‚egative %d for‚dl idx %d\n",

259 
ndev_vif
->
Çn
.
ndl_li¡
[
ndl_id
].
ndp_couÁ
,‚dl_id);

260 
ndev_vif
->
Çn
.
ndp_¡©e
[
ndp_š¡ªû_id
 - 1] = 
ndp_¦Ù_¡©us_ä“
;

261 
	}
}

263 
u16
 
	$¦si_Çn_ndp_g‘_ndl_vif_id
(
u8
 *
³”_mni
, 
¦si_Çn_ndl_šfo
 *
ndl_li¡
)

265 
u16
 
i
, 
ä“_idx
 = 
SLSI_NAN_MAX_NDP_INSTANCES
 + 
SLSI_NAN_DATA_IFINDEX_START
;

267 
i
 = 0; i < 
SLSI_NAN_MAX_NDP_INSTANCES
; i++) {

268 ià(
	`‘h”_addr_equ®
(
³”_mni
, 
ndl_li¡
[
i
].
³”_nmi
))

269  
i
 + 
SLSI_NAN_DATA_IFINDEX_START
;

270 ià(
ä“_idx
 =ğ
SLSI_NAN_MAX_NDP_INSTANCES
 + 
SLSI_NAN_DATA_IFINDEX_START
 &&

271 
ndl_li¡
[
i
].
ndp_couÁ
 == 0)

272 
ä“_idx
 = 
i
 + 
SLSI_NAN_DATA_IFINDEX_START
;

274  
ä“_idx
;

275 
	}
}

277 
	$¦si_Çn_g‘_mac
(
¦si_dev
 *
sdev
, *
Çn_mac_addr
)

279 
	`mem£t
(
Çn_mac_addr
, 0, 
ETH_ALEN
);

280 #ià
CONFIG_SCSC_WLAN_MAX_INTERFACES
 >= 4

281 ià(
	`¦si_dev_Çn_suµÜ‹d
(
sdev
))

282 
	`‘h”_addr_cİy
(
Çn_mac_addr
, 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_NAN
]);

284 
	}
}

286 
	$¦si_purge_Çn_discov”y_šfo
(
Ãtdev_vif
 *
ndev_vif
)

288 
¦si_Çn_discov”y_šfo
 *
discov”yšfo
;

289 
¦si_Çn_discov”y_šfo
 *
´ev
 = 
NULL
;

291 
discov”yšfo
 = 
ndev_vif
->
Çn
.
disc_šfo
;

292 
discov”yšfo
) {

293 
´ev
 = 
discov”yšfo
;

294 
discov”yšfo
 = discov”yšfo->
Ãxt
;

295 
	`kä“
(
´ev
);

297 
	}
}

299 
	$¦si_add_Çn_discov”y_šfo
(
Ãtdev_vif
 *
ndev_vif
, 
u8
 *
addr
, 
u16
 
publish_subsüibe_id
, 
u32
 
»q_š¡ªû_id
)

301 
¦si_Çn_discov”y_šfo
 *
discov”yšfo
;

302 
¦si_Çn_discov”y_šfo
 *
h—d
 = 
ndev_vif
->
Çn
.
disc_šfo
;

304 
discov”yšfo
 = 
	`kz®loc
((*discov”yšfo), 
GFP_KERNEL
);

305 ià(!
discov”yšfo
)

307 
	`‘h”_addr_cİy
(
discov”yšfo
->
³”_addr
, 
addr
);

308 
discov”yšfo
->
£ssiÚ_id
 = 
publish_subsüibe_id
;

309 
discov”yšfo
->
m©ch_id
 = 
»q_š¡ªû_id
;

310 
discov”yšfo
->
Ãxt
 = 
h—d
;

311 
ndev_vif
->
Çn
.
disc_šfo
 = 
discov”yšfo
;

312 
	}
}

314 
	$¦si_v’dÜ_Çn_commªd_»¶y
(
why
 *why, 
u32
 
¡©us
, u32 
”rÜ
, u32 
»¥Ú£_ty³
,

315 
u16
 
id
, 
¦si_h®_Çn_ÿ·b™›s
 *
ÿ·b™›s
, u16 
»q_id
, 
Ãtdev_vif
 *
ndev_vif
)

317 
sk_buff
 *
»¶y
;

318 
u8
 
mac_addr
[
ETH_ALEN
] = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };

319 
»t
 = 0;

321 
»¶y
 = 
	`cfg80211_v’dÜ_cmd_®loc_»¶y_skb
(
why
, 
NLMSG_DEFAULT_SIZE
);

322 ià(!
»¶y
) {

323 
	`SLSI_WARN_NODEV
("SKB‡lloc failed for vendor_cmd„eply\n");

327 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_STATUS_TYPE
, 
¡©us
);

328 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_VALUE
, 
”rÜ
);

329 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_RESPONSE_TYPE
, 
»¥Ú£_ty³
);

330 
»t
 |ğ
	`Æa_put_u16
(
»¶y
, 
NAN_REPLY_ATTR_HAL_TRANSACTION_ID
, 
»q_id
);

331 ià(
»¥Ú£_ty³
 =ğ
NAN_RESPONSE_ENABLED
) {

332 ià(
ndev_vif
)

333 
»t
 |ğ
	`Æa_put
(
»¶y
, 
NAN_EVT_ATTR_DISCOVERY_ENGINE_MAC_ADDR
, 
ETH_ALEN
, 
ndev_vif
->
Çn
.
loÿl_nmi
);

335 
»t
 |ğ
	`Æa_put
(
»¶y
, 
NAN_EVT_ATTR_DISCOVERY_ENGINE_MAC_ADDR
, 
ETH_ALEN
, 
mac_addr
);

337 ià(
ÿ·b™›s
) {

338 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_CONCURRENT_CLUSTER
,

339 
ÿ·b™›s
->
max_cÚcu¼’t_Çn_şu¡”s
);

340 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_PUBLISHES
, 
ÿ·b™›s
->
max_publishes
);

341 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_SUBSCRIBES
, 
ÿ·b™›s
->
max_subsüibes
);

342 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_SERVICE_NAME_LEN
, 
ÿ·b™›s
->
max_£rviû_Çme_Ën
);

343 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_MATCH_FILTER_LEN
, 
ÿ·b™›s
->
max_m©ch_f‹r_Ën
);

344 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_TOTAL_MATCH_FILTER_LEN
,

345 
ÿ·b™›s
->
max_tÙ®_m©ch_f‹r_Ën
);

346 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_SERVICE_SPECIFIC_INFO_LEN
,

347 
ÿ·b™›s
->
max_£rviû_¥ecific_šfo_Ën
);

348 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_VSA_DATA_LEN
, 
ÿ·b™›s
->
max_v§_d©a_Ën
);

349 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_MESH_DATA_LEN
, 
ÿ·b™›s
->
max_mesh_d©a_Ën
);

350 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_NDI_INTERFACES
, 
ÿ·b™›s
->
max_ndi_š‹rçûs
);

351 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_NDP_SESSIONS
, 
ÿ·b™›s
->
max_ndp_£ssiÚs
);

352 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_APP_INFO_LEN
, 
ÿ·b™›s
->
max_­p_šfo_Ën
);

353 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_QUEUED_TRANSMIT_FOLLOWUP_MGS
,

354 
ÿ·b™›s
->
max_queued_Œªsm™_fŞlowup_msgs
);

355 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_SUBSCRIBE_ADDRESS
,

356 
ÿ·b™›s
->
max_subsüibe_add»ss
);

357 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_CIPHER_SUITES_SUPPORTED
,

358 
ÿ·b™›s
->
ch”_su™es_suµÜ‹d
);

359 
»t
 |ğ
	`Æa_put_u32
(
»¶y
, 
NAN_REPLY_ATTR_CAP_MAX_SDEA_SERVICE_SPECIFIC_INFO_LEN
,

360 
ÿ·b™›s
->
max_sd—_£rviû_¥ecific_šfo_Ën
);

361 } ià(
id
) {

362 ià(
»¥Ú£_ty³
 < 
NAN_DP_INTERFACE_CREATE
)

363 
»t
 |ğ
	`Æa_put_u16
(
»¶y
, 
NAN_REPLY_ATTR_PUBLISH_SUBSCRIBE_TYPE
, 
id
);

365 
»t
 |ğ
	`Æa_put_u16
(
»¶y
, 
NAN_REPLY_ATTR_NDP_INSTANCE_ID
, 
id
);

368 ià(
»t
) {

369 
	`SLSI_ERR_NODEV
("E¼Ü iÀÆa_put:%x\n", 
»t
);

370 
	`kä“_skb
(
»¶y
);

371 } ià(
	`cfg80211_v’dÜ_cmd_»¶y
(
»¶y
)) {

372 
	`SLSI_ERR_NODEV
("FAILEDØ»¶y‚ª cßmmnd.„e¥Ú£_ty³:%d\n", 
»¥Ú£_ty³
);

374 
	}
}

376 
	$¦si_Çn_g‘_sd—_·¿ms_Æ
(
¦si_dev
 *
sdev
, 
¦si_Çn_sd—_ù¾_·¿ms
 *
sd—_·¿ms
,

377 cÚ¡ 
Æ©Œ
 *
™”
, 
Æ_©Œ_id
)

379 
Æ_©Œ_id
) {

380 
NAN_REQ_ATTR_SDEA_PARAM_NDP_TYPE
:

381 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
sd—_·¿ms
->
ndp_ty³
)) {

382 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
Æ_©Œ_id
);

383  -
EINVAL
;

385 
sd—_·¿ms
->
cÚfig_Çn_d©a_·th
 = 1;

387 
NAN_REQ_ATTR_SDEA_PARAM_SECURITY_CFG
:

388 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
sd—_·¿ms
->
£cur™y_cfg
)) {

389 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
Æ_©Œ_id
);

390  -
EINVAL
;

392 
sd—_·¿ms
->
cÚfig_Çn_d©a_·th
 = 1;

394 
NAN_REQ_ATTR_SDEA_PARAM_RANGING_STATE
:

395 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
sd—_·¿ms
->
¿ngšg_¡©e
)) {

396 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
Æ_©Œ_id
);

397  -
EINVAL
;

400 
NAN_REQ_ATTR_SDEA_PARAM_RANGE_REPORT
:

401 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
sd—_·¿ms
->
¿nge_»pÜt
)) {

402 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
Æ_©Œ_id
);

403  -
EINVAL
;

406 
NAN_REQ_ATTR_SDEA_PARAM_QOS_CFG
:

407 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
sd—_·¿ms
->
qos_cfg
)) {

408 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
Æ_©Œ_id
);

409  -
EINVAL
;

413  -
EINVAL
;

416 
	}
}

418 
	$¦si_Çn_g‘_¿ngšg_cfg_Æ
(
¦si_dev
 *
sdev
, 
¦si_Çn_¿ngšg_cfg
 *
¿ngšg_cfg
,

419 cÚ¡ 
Æ©Œ
 *
™”
, 
Æ_©Œ_id
)

421 
Æ_©Œ_id
) {

422 
NAN_REQ_ATTR_RANGING_CFG_INTERVAL
:

423 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
¿ngšg_cfg
->
¿ngšg_š‹rv®_m£c
)) {

424 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
Æ_©Œ_id
);

425  -
EINVAL
;

428 
NAN_REQ_ATTR_RANGING_CFG_INDICATION
:

429 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
¿ngšg_cfg
->
cÚfig_¿ngšg_šdiÿtiÚs
)) {

430 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
Æ_©Œ_id
);

431  -
EINVAL
;

434 
NAN_REQ_ATTR_RANGING_CFG_INGRESS_MM
:

435 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
¿ngšg_cfg
->
di¡ªû_šg»ss_mm
)) {

436 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
Æ_©Œ_id
);

437  -
EINVAL
;

440 
NAN_REQ_ATTR_RANGING_CFG_EGRESS_MM
:

441 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
¿ngšg_cfg
->
di¡ªû_eg»ss_mm
)) {

442 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
Æ_©Œ_id
);

443  -
EINVAL
;

447  -
EINVAL
;

450 
	}
}

452 
	$¦si_Çn_g‘_£cur™y_šfo_Æ
(
¦si_dev
 *
sdev
, 
¦si_Çn_£cur™y_šfo
 *
£c_šfo
,

453 cÚ¡ 
Æ©Œ
 *
™”
, 
Æ_©Œ_id
)

455 
u32
 
key_ty³
;

457 
Æ_©Œ_id
) {

458 
NAN_REQ_ATTR_CIPHER_TYPE
:

459 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
£c_šfo
->
ch”_ty³
))

460  -
EINVAL
;

462 
NAN_REQ_ATTR_SECURITY_KEY_TYPE
:

463 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
key_ty³
))

464  -
EINVAL
;

465 
£c_šfo
->
key_šfo
.
key_ty³
 = key_type;

467 
NAN_REQ_ATTR_SECURITY_PMK_LEN
:

468 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
£c_šfo
->
key_šfo
.
body
.
pmk_šfo
.
pmk_Ën
))

469  -
EINVAL
;

471 
NAN_REQ_ATTR_SECURITY_PMK
:

472 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
£c_šfo
->
key_šfo
.
body
.
pmk_šfo
.
pmk_Ën
, sec_šfo->key_šfo.body.pmk_šfo.
pmk
))

473  -
EINVAL
;

475 
NAN_REQ_ATTR_SECURITY_PASSPHRASE_LEN
:

476 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
£c_šfo
->
key_šfo
.
body
.
·s¥h¿£_šfo
.
·s¥h¿£_Ën
))

477  -
EINVAL
;

479 
NAN_REQ_ATTR_SECURITY_PASSPHRASE
:

480 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
£c_šfo
->
key_šfo
.
body
.
·s¥h¿£_šfo
.
·s¥h¿£_Ën
,

481 
£c_šfo
->
key_šfo
.
body
.
·s¥h¿£_šfo
.
·s¥h¿£
))

482  -
EINVAL
;

484 
NAN_REQ_ATTR_SCID_LEN
:

485 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
£c_šfo
->
scid_Ën
))

486  -
EINVAL
;

488 
NAN_REQ_ATTR_SCID
:

489 ià(
£c_šfo
->
scid_Ën
 > (£c_šfo->
scid
))

490 
£c_šfo
->
scid_Ën
 = (£c_šfo->
scid
);

491 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
£c_šfo
->
scid_Ën
, sec_šfo->
scid
))

492  -
EINVAL
;

495  -
EINVAL
;

498 
	}
}

500 
	$¦si_Çn_g‘_¿nge_»¥_cfg_Æ
(
¦si_dev
 *
sdev
, 
¦si_Çn_¿nge_»¥Ú£_cfg
 *
cfg
,

501 cÚ¡ 
Æ©Œ
 *
™”
, 
Æ_©Œ_id
)

503 
u16
 
¿nge_»¥Ú£
;

505 
Æ_©Œ_id
) {

506 
NAN_REQ_ATTR_RANGE_RESPONSE_CFG_PUBLISH_ID
:

507 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
cfg
->
publish_id
))

508  -
EINVAL
;

511 
NAN_REQ_ATTR_RANGE_RESPONSE_CFG_REQUESTOR_ID
:

512 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
cfg
->
»que¡Ü_š¡ªû_id
))

513  -
EINVAL
;

516 
NAN_REQ_ATTR_RANGE_RESPONSE_CFG_PEER_ADDR
:

517 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
ETH_ALEN
, 
cfg
->
³”_addr
))

518  -
EINVAL
;

521 
NAN_REQ_ATTR_RANGE_RESPONSE_CFG_RANGING_RESPONSE
:

522 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
¿nge_»¥Ú£
))

523  -
EINVAL
;

524 
cfg
->
¿ngšg_»¥Ú£
 = 
¿nge_»¥Ú£
;

528  -
EINVAL
;

531 
	}
}

535 
	$¦si_Çn_’abË_g‘_Æ_·¿ms
(
¦si_dev
 *
sdev
, 
¦si_h®_Çn_’abË_»q
 *
h®_»q
,

536 cÚ¡ *
d©a
, 
Ën
)

538 
ty³
, 
tmp
;

539 cÚ¡ 
Æ©Œ
 *
™”
;

540 
u8
 
v®
 = 0;

541 
u32
 
¿ndom_š‹rv®
 = 0, 
chªÃl_5g_v®
 = 0;

542 #ifdeà
SCSC_SEP_VERSION


543 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

544 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

547 
	`mem£t
(
h®_»q
, 0, (*hal_req));

548 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

549 
ty³
 = 
	`Æa_ty³
(
™”
);

550 
ty³
) {

551 
NAN_REQ_ATTR_MASTER_PREF
:

552 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
ma¡”_´ef
))

553  -
EINVAL
;

556 
NAN_REQ_ATTR_CLUSTER_LOW
:

557 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
şu¡”_low
))

558  -
EINVAL
;

561 
NAN_REQ_ATTR_CLUSTER_HIGH
:

562 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
şu¡”_high
))

563  -
EINVAL
;

566 
NAN_REQ_ATTR_SUPPORT_5G_VAL
:

567 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
suµÜt_5g_v®
))

568  -
EINVAL
;

569 
h®_»q
->
cÚfig_suµÜt_5g
 = 1;

572 
NAN_REQ_ATTR_SID_BEACON_VAL
:

573 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
sid_b—cÚ_v®
))

574  -
EINVAL
;

575 
h®_»q
->
cÚfig_sid_b—cÚ
 = 1;

578 
NAN_REQ_ATTR_RSSI_CLOSE_2G4_VAL
:

579 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
rssi_şo£_2dÙ4g_v®
))

580  -
EINVAL
;

581 
h®_»q
->
cÚfig_2dÙ4g_rssi_şo£
 = 1;

584 
NAN_REQ_ATTR_RSSI_MIDDLE_2G4_VAL
:

585 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
rssi_middË_2dÙ4g_v®
))

586  -
EINVAL
;

587 
h®_»q
->
cÚfig_2dÙ4g_rssi_middË
 = 1;

590 
NAN_REQ_ATTR_RSSI_PROXIMITY_2G4_VAL
:

591 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
rssi_´oxim™y_2dÙ4g_v®
))

592  -
EINVAL
;

593 
h®_»q
->
cÚfig_2dÙ4g_rssi_´oxim™y
 = 1;

596 
NAN_REQ_ATTR_HOP_COUNT_LIMIT_VAL
:

597 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
hİ_couÁ_lim™_v®
))

598  -
EINVAL
;

599 
h®_»q
->
cÚfig_hİ_couÁ_lim™
 = 1;

602 
NAN_REQ_ATTR_SUPPORT_2G4_VAL
:

603 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
suµÜt_2dÙ4g_v®
))

604  -
EINVAL
;

605 
h®_»q
->
cÚfig_2dÙ4g_suµÜt
 = 1;

608 
NAN_REQ_ATTR_BEACONS_2G4_VAL
:

609 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
b—cÚ_2dÙ4g_v®
))

610  -
EINVAL
;

611 
h®_»q
->
cÚfig_2dÙ4g_b—cÚs
 = 1;

614 
NAN_REQ_ATTR_SDF_2G4_VAL
:

615 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
sdf_2dÙ4g_v®
))

616  -
EINVAL
;

617 
h®_»q
->
cÚfig_2dÙ4g_sdf
 = 1;

620 
NAN_REQ_ATTR_BEACON_5G_VAL
:

621 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
b—cÚ_5g_v®
))

622  -
EINVAL
;

623 
h®_»q
->
cÚfig_5g_b—cÚs
 = 1;

626 
NAN_REQ_ATTR_SDF_5G_VAL
:

627 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
sdf_5g_v®
))

628  -
EINVAL
;

629 
h®_»q
->
cÚfig_5g_sdf
 = 1;

632 
NAN_REQ_ATTR_RSSI_CLOSE_5G_VAL
:

633 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
rssi_şo£_5g_v®
))

634  -
EINVAL
;

635 
h®_»q
->
cÚfig_5g_rssi_şo£
 = 1;

638 
NAN_REQ_ATTR_RSSI_MIDDLE_5G_VAL
:

639 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
rssi_middË_5g_v®
))

640  -
EINVAL
;

641 
h®_»q
->
cÚfig_5g_rssi_middË
 = 1;

644 
NAN_REQ_ATTR_RSSI_CLOSE_PROXIMITY_5G_VAL
:

645 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
rssi_şo£_´oxim™y_5g_v®
))

646  -
EINVAL
;

647 
h®_»q
->
cÚfig_5g_rssi_şo£_´oxim™y
 = 1;

650 
NAN_REQ_ATTR_RSSI_WINDOW_SIZE_VAL
:

651 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
rssi_wšdow_size_v®
))

652  -
EINVAL
;

653 
h®_»q
->
cÚfig_rssi_wšdow_size
 = 1;

656 
NAN_REQ_ATTR_OUI_VAL
:

657 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
oui_v®
))

658  -
EINVAL
;

659 
h®_»q
->
cÚfig_oui
 = 1;

662 
NAN_REQ_ATTR_MAC_ADDR_VAL
:

663 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
ETH_ALEN
, 
h®_»q
->
štf_addr_v®
))

664  -
EINVAL
;

665 
h®_»q
->
cÚfig_štf_addr
 = 1;

668 
NAN_REQ_ATTR_CLUSTER_VAL
:

669 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
cÚfig_şu¡”_©Œibu‹_v®
))

670  -
EINVAL
;

673 
NAN_REQ_ATTR_SOCIAL_CH_SCAN_DWELL_TIME
:

674 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, (
h®_»q
->
sÿn_·¿ms_v®
.
dw–l_time
), hal_req->scan_params_val.dwell_time))

675  -
EINVAL
;

676 
h®_»q
->
cÚfig_sÿn_·¿ms
 = 1;

679 
NAN_REQ_ATTR_SOCIAL_CH_SCAN_PERIOD
:

680 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, (
h®_»q
->
sÿn_·¿ms_v®
.
sÿn_³riod
), hal_req->scan_params_val.scan_period))

681  -
EINVAL
;

682 
h®_»q
->
cÚfig_sÿn_·¿ms
 = 1;

685 
NAN_REQ_ATTR_RANDOM_FACTOR_FORCE_VAL
:

686 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
¿ndom_çùÜ_fÜû_v®
))

687  -
EINVAL
;

688 
h®_»q
->
cÚfig_¿ndom_çùÜ_fÜû
 = 1;

691 
NAN_REQ_ATTR_HOP_COUNT_FORCE_VAL
:

692 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
hİ_couÁ_fÜû_v®
))

693  -
EINVAL
;

694 
h®_»q
->
cÚfig_hİ_couÁ_fÜû
 = 1;

697 
NAN_REQ_ATTR_CHANNEL_2G4_MHZ_VAL
:

698 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
chªÃl_24g_v®
))

699  -
EINVAL
;

700 
h®_»q
->
cÚfig_24g_chªÃl
 = 1;

703 
NAN_REQ_ATTR_CHANNEL_5G_MHZ_VAL
:

704 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
chªÃl_5g_v®
))

705  -
EINVAL
;

706 
h®_»q
->
chªÃl_5g_v®
 = ()channel_5g_val;

707 
h®_»q
->
cÚfig_5g_chªÃl
 = 1;

710 
NAN_REQ_ATTR_SUBSCRIBE_SID_BEACON_VAL
:

711 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
v®
))

712  -
EINVAL
;

713 
h®_»q
->
subsüibe_sid_b—cÚ_v®
 = (
u32
)
v®
;

714 
h®_»q
->
cÚfig_subsüibe_sid_b—cÚ
 = 1;

717 
NAN_REQ_ATTR_DW_2G4_INTERVAL
:

718 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
v®
))

719  -
EINVAL
;

720 
h®_»q
->
dw_2dÙ4g_š‹rv®_v®
 = (
u32
)
v®
;

722 ià(
h®_»q
->
dw_2dÙ4g_š‹rv®_v®
 > 0 && hal_req->dw_2dot4g_interval_val < 5)

723 
h®_»q
->
cÚfig_2dÙ4g_dw_bªd
 = 1;

726 
NAN_REQ_ATTR_DW_5G_INTERVAL
:

727 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
v®
))

728  -
EINVAL
;

729 
h®_»q
->
dw_5g_š‹rv®_v®
 = (
u32
)
v®
;

731 ià(
h®_»q
->
dw_5g_š‹rv®_v®
 < 5)

732 
h®_»q
->
cÚfig_5g_dw_bªd
 = 1;

735 
NAN_REQ_ATTR_DISC_MAC_ADDR_RANDOM_INTERVAL
:

736 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
¿ndom_š‹rv®
))

737  -
EINVAL
;

738 ià(
	`¦si_g‘_Çn_mac_¿ndom
())

739 
h®_»q
->
disc_mac_addr_¿nd_š‹rv®_£c
 = 
¿ndom_š‹rv®
;

741 
h®_»q
->
disc_mac_addr_¿nd_š‹rv®_£c
 = 0;

742 #ifdeà
SCSC_SEP_VERSION


743 
¿ndom_š‹rv®
 =„ªdom_š‹rv® & 
SLSI_NAN_CLUSTER_MERGE_ENABLE_MASK
;

744 ià(
¿ndom_š‹rv®
 =ğ
SLSI_NAN_CLUSTER_MERGE_ENABLE_MASK
) {

745 
ndev_vif
->
Çn
.
di§bË_şu¡”_m”ge
 = 0;

746 
h®_»q
->
disc_mac_addr_¿nd_š‹rv®_£c
 &ğ
SLSI_NAN_MAC_RANDOM_INTERVAL_MASK
;

747 } ià(
¿ndom_š‹rv®
 =ğ
SLSI_NAN_CLUSTER_MERGE_DISABLE_MASK
) {

748 
ndev_vif
->
Çn
.
di§bË_şu¡”_m”ge
 = 1;

749 
h®_»q
->
disc_mac_addr_¿nd_š‹rv®_£c
 &ğ
SLSI_NAN_MAC_RANDOM_INTERVAL_MASK
;

754 
NAN_REQ_ATTR_HAL_TRANSACTION_ID
:

755 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
Œª§ùiÚ_id
))

756  -
EINVAL
;

758 
NAN_REQ_ATTR_DISCOVERY_BEACON_INT
:

759 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
discov”y_b—cÚ_š‹rv®_ms
))

760  -
EINVAL
;

762 
NAN_REQ_ATTR_NSS
:

763 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
nss_discov”y
))

764  -
EINVAL
;

766 
NAN_REQ_ATTR_ENABLE_RANGING
:

767 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
’abË_¿ngšg
))

768  -
EINVAL
;

770 
NAN_REQ_ATTR_DW_EARLY_TERMINATION
:

771 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
’abË_dw_—¾y_‹rmš©iÚ
))

772  -
EINVAL
;

775 
	`SLSI_ERR
(
sdev
, "UÃx³ùed NANƒÇbË‡‰ribu‹ TYPE:%d\n", 
ty³
);

778  
SLSI_HAL_NAN_STATUS_SUCCESS
;

779 
	}
}

781 
	$¦si_Çn_’abË
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

783 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

784 
¦si_h®_Çn_’abË_»q
 
h®_»q
;

785 
»t
;

786 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

787 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

788 
u8
 
Çn_vif_mac_add»ss
[
ETH_ALEN
];

789 
u8
 
brßdÿ¡_mac
[
ETH_ALEN
] = {0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF};

790 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

792 
h®_»q
.
Œª§ùiÚ_id
 = 0;

793 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

794 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

795 
ex™
;

797 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

799 
»¶y_¡©us
 = 
	`¦si_Çn_’abË_g‘_Æ_·¿ms
(
sdev
, &
h®_»q
, 
d©a
, 
Ën
);

800 ià(
»¶y_¡©us
 !ğ
SLSI_HAL_NAN_STATUS_SUCCESS
) {

801 
»t
 = -
EINVAL
;

802 
ex™
;

805 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

806 ià(
ndev_vif
->
aùiv©ed
) {

807 
»t
 = -
EINVAL
;

808 
	`SLSI_DBG1
(
sdev
, 
SLSI_GSCAN
, "Already Enabled. Req Rejected\n");

809 
ex™_w™h_mu‹x
;

811 
ndev_vif
->
vif_ty³
 = 
FAPI_VIFTYPE_NAN
;

812 ià(
	`¦si_g‘_Çn_mac_¿ndom
())

813 
	`¦si_Ãt_¿ndomize_nmi_ndi
(
sdev
);

815 ià(
h®_»q
.
cÚfig_štf_addr
)

816 
	`‘h”_addr_cİy
(
Çn_vif_mac_add»ss
, 
h®_»q
.
štf_addr_v®
);

818 
	`¦si_Çn_g‘_mac
(
sdev
, 
Çn_vif_mac_add»ss
);

820 
»t
 = 
	`¦si_mlme_add_vif
(
sdev
, 
dev
, 
Çn_vif_mac_add»ss
, 
brßdÿ¡_mac
);

821 ià(
»t
) {

822 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

823 
	`SLSI_ERR
(
sdev
, "failedo‡dd‚an vif. Cannot start NAN\n");

825 
»t
 = 
	`¦si_mlme_Çn_’abË
(
sdev
, 
dev
, &
h®_»q
);

826 ià(
»t
) {

827 
	`SLSI_ERR
(
sdev
, "failedoƒnable NAN.\n");

828 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

829 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

830 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

831 
ndev_vif
->
aùiv©ed
 = 
çl£
;

832 
ndev_vif
->
Çn
.
£rviû_id_m­
 = 0;

834 ià(
	`¦si_vif_aùiv©ed
(
sdev
, 
dev
) != 0)

835 
	`SLSI_NET_ERR
(
dev
, "slsi_vif_activated failed\n");

836 
ndev_vif
->
Çn
.
ma¡”_´ef_v®ue
 = 
h®_»q
.
ma¡”_´ef
;

837 
	`‘h”_addr_cİy
(
ndev_vif
->
Çn
.
loÿl_nmi
, 
Çn_vif_mac_add»ss
);

838 
ndev_vif
->
Çn
.
¡©e
 = 1;

839 ià(
h®_»q
.
cÚfig_24g_chªÃl
)

840 
ndev_vif
->
Çn
.
İ”©šg_chªÃl
[0] = 
h®_»q
.
chªÃl_24g_v®
;

841 ià(
h®_»q
.
cÚfig_5g_chªÃl
)

842 
ndev_vif
->
Çn
.
İ”©šg_chªÃl
[1] = 
h®_»q
.
chªÃl_5g_v®
;

843 ià(
h®_»q
.
cÚfig_hİ_couÁ_lim™
)

844 
ndev_vif
->
Çn
.
hİcouÁ
 = 
h®_»q
.
hİ_couÁ_lim™_v®
;

845 
	`¦si_‘h_z”o_addr
(
ndev_vif
->
Çn
.
şu¡”_id
);

846 
ndev_vif
->
Çn
.
¿ndom_mac_š‹rv®_£c
 = 
h®_»q
.
disc_mac_addr_¿nd_š‹rv®_£c
;

847 
	`SLSI_INFO
(
sdev
,

849 
h®_»q
.
Œª§ùiÚ_id
, h®_»q.
ma¡”_´ef
, h®_»q.
chªÃl_24g_v®
,

850 
h®_»q
.
chªÃl_5g_v®
, h®_»q.
disc_mac_addr_¿nd_š‹rv®_£c
);

853 
	`‘h”_addr_cİy
(
ndev_vif
->
Çn
.
loÿl_nmi
, 
Çn_vif_mac_add»ss
);

854 
	`š™_com¶‘iÚ
(&
ndev_vif
->
Çn
.
ndp_d–ay
);

855 
ex™_w™h_mu‹x
:

856 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

857 
ex™
:

858 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_RESPONSE_ENABLED
, 0, 
NULL
, 
h®_»q
.
Œª§ùiÚ_id
, 
ndev_vif
);

859  
»t
;

860 
	}
}

862 
	$¦si_Çn_di§bË
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

864 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

865 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

866 
Ãt_deviû
 *
d©a_dev
;

867 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
, *
d©a_ndev_vif
;

868 
u8
 
i
;

869 
ty³
, 
tmp
;

870 cÚ¡ 
Æ©Œ
 *
™”
;

871 
u16
 
Œª§ùiÚ_id
 = 0;

873 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

874 
ty³
 = 
	`Æa_ty³
(
™”
);

875 
ty³
) {

876 
NAN_REQ_ATTR_HAL_TRANSACTION_ID
:

877 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
Œª§ùiÚ_id
))

878  -
EINVAL
;

885 ià(
dev
) {

886 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

887 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

888 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

890 ià(
ndev_vif
->
aùiv©ed
) {

891 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

892 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

893 
ndev_vif
->
aùiv©ed
 = 
çl£
;

894 
	`SLSI_INFO
(
sdev
, "Œª§ùiÚ_id:%d\n", 
Œª§ùiÚ_id
);

896 
	`SLSI_INFO
(
sdev
, "Œª§ùiÚ_id:%d NAN‚Ù‡ùive\n", 
Œª§ùiÚ_id
);

898 
i
 = 
SLSI_NAN_DATA_IFINDEX_START
; i < 
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1; i++) {

899 
d©a_dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
i
);

900 ià(
d©a_dev
) {

901 
d©a_ndev_vif
 = 
	`Ãtdev_´iv
(
d©a_dev
);

902 
	`SLSI_MUTEX_LOCK
(
d©a_ndev_vif
->
vif_mu‹x
);

903 
	`¦si_vif_ş—nup
(
sdev
, 
d©a_dev
, 
Œue
, 0);

904 
	`SLSI_MUTEX_UNLOCK
(
d©a_ndev_vif
->
vif_mu‹x
);

907 
	`¦si_purge_Çn_discov”y_šfo
(
ndev_vif
);

908 
	`mem£t
(&
ndev_vif
->
Çn
, 0, (ndev_vif->nan));

909 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

910 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

912 
	`SLSI_WARN
(
sdev
, "No NAN interface!!");

915 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
SLSI_HAL_NAN_STATUS_SUCCESS
, 0, 
NAN_RESPONSE_DISABLED
, 0, 
NULL
, 
Œª§ùiÚ_id
, 
ndev_vif
);

918 
	}
}

920 
	$¦si_Çn_publish_g‘_Æ_·¿ms
(
¦si_dev
 *
sdev
, 
¦si_h®_Çn_publish_»q
 *
h®_»q
,

921 cÚ¡ *
d©a
, 
Ën
)

923 
ty³
, 
tmp
, 
r
;

924 cÚ¡ 
Æ©Œ
 *
™”
;

926 
	`mem£t
(
h®_»q
, 0, (*hal_req));

927 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

928 
ty³
 = 
	`Æa_ty³
(
™”
);

929 
ty³
) {

930 
NAN_REQ_ATTR_PUBLISH_ID
:

931 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
publish_id
)) {

932 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
ty³
);

933  -
EINVAL
;

936 
NAN_REQ_ATTR_PUBLISH_TTL
:

937 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
‰l
)) {

938 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
ty³
);

939  -
EINVAL
;

943 
NAN_REQ_ATTR_PUBLISH_PERIOD
:

944 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
³riod
)) {

945 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
ty³
);

946  -
EINVAL
;

950 
NAN_REQ_ATTR_PUBLISH_TYPE
:

951 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
publish_ty³
)) {

952 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
ty³
);

953  -
EINVAL
;

957 
NAN_REQ_ATTR_PUBLISH_TX_TYPE
:

958 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
tx_ty³
)) {

959 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
ty³
);

960  -
EINVAL
;

964 
NAN_REQ_ATTR_PUBLISH_COUNT
:

965 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
publish_couÁ
)) {

966 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
ty³
);

967  -
EINVAL
;

971 
NAN_REQ_ATTR_PUBLISH_SERVICE_NAME_LEN
:

972 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
£rviû_Çme_Ën
)) {

973 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
ty³
);

974  -
EINVAL
;

978 
NAN_REQ_ATTR_PUBLISH_SERVICE_NAME
:

979 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
£rviû_Çme_Ën
, h®_»q->
£rviû_Çme
)) {

980 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
ty³
);

981  -
EINVAL
;

985 
NAN_REQ_ATTR_PUBLISH_MATCH_ALGO
:

986 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
publish_m©ch_šdiÿtÜ
)) {

987 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
ty³
);

988  -
EINVAL
;

992 
NAN_REQ_ATTR_PUBLISH_SERVICE_INFO_LEN
:

993 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
£rviû_¥ecific_šfo_Ën
)) {

994 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
ty³
);

995  -
EINVAL
;

999 
NAN_REQ_ATTR_PUBLISH_SERVICE_INFO
:

1000 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
£rviû_¥ecific_šfo_Ën
, h®_»q->
£rviû_¥ecific_šfo
)) {

1001 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
ty³
);

1002  -
EINVAL
;

1006 
NAN_REQ_ATTR_PUBLISH_RX_MATCH_FILTER_LEN
:

1007 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
rx_m©ch_f‹r_Ën
)) {

1008 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
ty³
);

1009  -
EINVAL
;

1013 
NAN_REQ_ATTR_PUBLISH_RX_MATCH_FILTER
:

1014 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
rx_m©ch_f‹r_Ën
, h®_»q->
rx_m©ch_f‹r
)) {

1015 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
ty³
);

1016  -
EINVAL
;

1020 
NAN_REQ_ATTR_PUBLISH_TX_MATCH_FILTER_LEN
:

1021 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
tx_m©ch_f‹r_Ën
)) {

1022 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
ty³
);

1023  -
EINVAL
;

1027 
NAN_REQ_ATTR_PUBLISH_TX_MATCH_FILTER
:

1028 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
tx_m©ch_f‹r_Ën
, h®_»q->
tx_m©ch_f‹r
)) {

1029 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
ty³
);

1030  -
EINVAL
;

1034 
NAN_REQ_ATTR_PUBLISH_RSSI_THRESHOLD_FLAG
:

1035 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
rssi_th»shŞd_æag
)) {

1036 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
ty³
);

1037  -
EINVAL
;

1041 
NAN_REQ_ATTR_PUBLISH_CONN_MAP
:

1042 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
cÚnm­
)) {

1043 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
ty³
);

1044  -
EINVAL
;

1048 
NAN_REQ_ATTR_PUBLISH_RECV_IND_CFG
:

1049 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
»cv_šdiÿtiÚ_cfg
)) {

1050 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
ty³
);

1051  -
EINVAL
;

1055 
NAN_REQ_ATTR_PUBLISH_SDEA_LEN
:

1056 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
)) {

1057 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
ty³
);

1058  -
EINVAL
;

1062 
NAN_REQ_ATTR_PUBLISH_SDEA
:

1063 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
, h®_»q->
sd—_£rviû_¥ecific_šfo
)) {

1064 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
ty³
);

1065  -
EINVAL
;

1069 
NAN_REQ_ATTR_RANGING_AUTO_RESPONSE
:

1070 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
¿ngšg_auto_»¥Ú£
)) {

1071 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
ty³
);

1072  -
EINVAL
;

1075 
NAN_REQ_ATTR_HAL_TRANSACTION_ID
:

1076 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
Œª§ùiÚ_id
)) {

1077 
	`SLSI_ERR
(
sdev
, "R‘uºšg EINVAL TYPE:%d\n", 
ty³
);

1078  -
EINVAL
;

1083 
r
 = 
	`¦si_Çn_g‘_sd—_·¿ms_Æ
(
sdev
, &
h®_»q
->
sd—_·¿ms
, 
™”
, 
ty³
);

1084 ià(
r
)

1085 
r
 = 
	`¦si_Çn_g‘_¿ngšg_cfg_Æ
(
sdev
, &
h®_»q
->
¿ngšg_cfg
, 
™”
, 
ty³
);

1086 ià(
r
)

1087 
r
 = 
	`¦si_Çn_g‘_£cur™y_šfo_Æ
(
sdev
, &
h®_»q
->
£c_šfo
, 
™”
, 
ty³
);

1088 ià(
r
)

1089 
r
 = 
	`¦si_Çn_g‘_¿nge_»¥_cfg_Æ
(
sdev
, &
h®_»q
->
¿nge_»¥Ú£_cfg
, 
™”
, 
ty³
);

1090 ià(
r
) {

1091 
	`SLSI_ERR
(
sdev
, "UÃx³ùed NAN…ublish‡‰ribu‹ TYPE:%d\n", 
ty³
);

1092  
SLSI_HAL_NAN_STATUS_INVALID_PARAM
;

1096  
SLSI_HAL_NAN_STATUS_SUCCESS
;

1097 
	}
}

1099 
	$¦si_Çn_publish
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1101 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1102 
¦si_h®_Çn_publish_»q
 *
h®_»q
;

1103 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

1104 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

1105 
»t
;

1106 
u32
 
»¶y_¡©us
;

1107 
u32
 
publish_id
 = 0;

1108 
u16
 
Œª§ùiÚ_id
 = 0;

1110 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

1111 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

1112 
ex™
;

1114 
h®_»q
 = 
	`km®loc
((*h®_»q), 
GFP_KERNEL
);

1115 ià(!
h®_»q
) {

1116 
	`SLSI_ERR
(
sdev
, "failedo‡lloc hal_req\n");

1117 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NO_RESOURCE_AVAILABLE
;

1118 
»t
 = -
ENOMEM
;

1119 
ex™
;

1122 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1123 
»¶y_¡©us
 = 
	`¦si_Çn_publish_g‘_Æ_·¿ms
(
sdev
, 
h®_»q
, 
d©a
, 
Ën
);

1124 
Œª§ùiÚ_id
 = 
h®_»q
->transaction_id;

1125 ià(
»¶y_¡©us
 !ğ
SLSI_HAL_NAN_STATUS_SUCCESS
) {

1126 
	`kä“
(
h®_»q
);

1127 
»t
 = -
EINVAL
;

1128 
ex™
;

1131 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1133 ià(!
ndev_vif
->
aùiv©ed
) {

1134 
	`SLSI_WARN
(
sdev
, "NAN vif‚ot‡ctivated\n");

1135 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NAN_NOT_ALLOWED
;

1136 
»t
 = 
WIFI_HAL_ERROR_NOT_AVAILABLE
;

1137 
ex™_w™h_lock
;

1140 ià(!
h®_»q
->
publish_id
) {

1141 
h®_»q
->
publish_id
 = 
	`¦si_Çn_g‘_Ãw_publish_id
(
ndev_vif
);

1142 
ndev_vif
->
Çn
.
Ãxt_£rviû_id
 = (
h®_»q
->
publish_id
 + 1è% (
SLSI_NAN_MAX_SERVICE_ID
 + 1);

1143 } ià(!
	`¦si_Çn_is_publish_id_aùive
(
ndev_vif
, 
h®_»q
->
publish_id
)) {

1144 
	`SLSI_WARN
(
sdev
, "Publish id %d‚Ù found. m­:%x\n", 
h®_»q
->
publish_id
,

1145 
ndev_vif
->
Çn
.
£rviû_id_m­
);

1146 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PUBLISH_SUBSCRIBE_ID
;

1147 
»t
 = -
EINVAL
;

1148 
ex™_w™h_lock
;

1151 ià(
h®_»q
->
publish_id
) {

1152 
»t
 = 
	`¦si_mlme_Çn_publish
(
sdev
, 
dev
, 
h®_»q
, h®_»q->
publish_id
);

1153 ià(
»t
) {

1154 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

1155 
	`SLSI_INFO
(
sdev
, "transId:%d,…ubId:%d failed\n",

1156 
h®_»q
->
Œª§ùiÚ_id
, h®_»q->
publish_id
);

1158 
publish_id
 = 
h®_»q
->publish_id;

1159 
	`SLSI_INFO
(
sdev
,

1161 
h®_»q
->
Œª§ùiÚ_id
, h®_»q->
publish_id
, h®_»q->
publish_ty³
,

1162 
h®_»q
->
»cv_šdiÿtiÚ_cfg
, h®_»q->
£rviû_Çme
);

1163 ià(
h®_»q
->
£rviû_¥ecific_šfo_Ën
)

1164 
	`SLSI_INFO_HEX
(
sdev
, 
h®_»q
->
£rviû_¥ecific_šfo
, h®_»q->
£rviû_¥ecific_šfo_Ën
,

1168 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PUBLISH_SUBSCRIBE_ID
;

1169 
	`SLSI_WARN
(
sdev
, "Too Many PUBLISH REQ(map:%x)\n",

1170 
ndev_vif
->
Çn
.
£rviû_id_m­
);

1171 
»t
 = -
ENOTSUPP
;

1173 
ex™_w™h_lock
:

1174 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1175 
	`kä“
(
h®_»q
);

1176 
ex™
:

1177 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_RESPONSE_PUBLISH
, 
publish_id
, 
NULL
, 
Œª§ùiÚ_id
, 
ndev_vif
);

1178  
»t
;

1179 
	}
}

1181 
	$¦si_Çn_publish_ÿnûl
(
why
 *why, 
wœ–ess_dev
 *
wdev
,

1182 cÚ¡ *
d©a
, 
Ën
)

1184 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1185 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

1186 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

1187 
ty³
, 
tmp
, 
»t
 = 0;

1188 
u16
 
publish_id
 = 0, 
Œª§ùiÚ_id
 = 0;

1189 cÚ¡ 
Æ©Œ
 *
™”
;

1190 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

1192 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

1193 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

1194 
ex™
;

1196 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1197 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

1198 
ty³
 = 
	`Æa_ty³
(
™”
);

1199 
ty³
) {

1200 
NAN_REQ_ATTR_PUBLISH_ID
:

1201 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &(
publish_id
)))

1202  -
EINVAL
;

1204 
NAN_REQ_ATTR_HAL_TRANSACTION_ID
:

1205 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &(
Œª§ùiÚ_id
)))

1206  -
EINVAL
;

1210 
	`SLSI_ERR
(
sdev
, "UÃx³ùed NAN…ublishÿnûÈ©Œibu‹ TYPE:%d\n", 
ty³
);

1214 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1215 ià(!
ndev_vif
->
aùiv©ed
) {

1216 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NAN_NOT_ALLOWED
;

1217 
»t
 = 
WIFI_HAL_ERROR_NOT_AVAILABLE
;

1218 
ex™_w™h_lock
;

1220 ià(!
publish_id
 || !
	`¦si_Çn_is_publish_id_aùive
(
ndev_vif
,…ublish_id)) {

1221 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PUBLISH_SUBSCRIBE_ID
;

1222 
	`SLSI_WARN
(
sdev
, "pubId(%d)‚ot‡ctive. map:%x\n",

1223 
publish_id
, 
ndev_vif
->
Çn
.
£rviû_id_m­
);

1225 
»t
 = 
	`¦si_mlme_Çn_publish
(
sdev
, 
dev
, 
NULL
, 
publish_id
);

1226 ià(
»t
) {

1227 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

1228 
	`SLSI_INFO
(
sdev
, "ŒªsId:%d…ubId:%d faed\n", 
Œª§ùiÚ_id
, 
publish_id
);

1230 
	`SLSI_INFO
(
sdev
, "ŒªsId:%d…ubId:%d\n", 
Œª§ùiÚ_id
, 
publish_id
);

1233 
ex™_w™h_lock
:

1234 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1235 
ex™
:

1236 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_RESPONSE_PUBLISH_CANCEL
, 
publish_id
, 
NULL
, 
Œª§ùiÚ_id
, 
ndev_vif
);

1237  
»t
;

1238 
	}
}

1240 
	$¦si_Çn_subsüibe_g‘_Æ_·¿ms
(
¦si_dev
 *
sdev
, 
¦si_h®_Çn_subsüibe_»q
 *
h®_»q
,

1241 cÚ¡ *
d©a
, 
Ën
)

1243 
ty³
, 
tmp
, 
r
;

1244 cÚ¡ 
Æ©Œ
 *
™”
;

1246 
	`mem£t
(
h®_»q
, 0, (*hal_req));

1247 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

1248 
ty³
 = 
	`Æa_ty³
(
™”
);

1249 
ty³
) {

1250 
NAN_REQ_ATTR_SUBSCRIBE_ID
:

1251 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
subsüibe_id
))

1252  -
EINVAL
;

1255 
NAN_REQ_ATTR_SUBSCRIBE_TTL
:

1256 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
‰l
))

1257  -
EINVAL
;

1260 
NAN_REQ_ATTR_SUBSCRIBE_PERIOD
:

1261 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
³riod
))

1262  -
EINVAL
;

1265 
NAN_REQ_ATTR_SUBSCRIBE_TYPE
:

1266 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
subsüibe_ty³
))

1267  -
EINVAL
;

1270 
NAN_REQ_ATTR_SUBSCRIBE_RESP_FILTER_TYPE
:

1271 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
£rviû_»¥Ú£_f‹r
))

1272  -
EINVAL
;

1275 
NAN_REQ_ATTR_SUBSCRIBE_RESP_INCLUDE
:

1276 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
£rviû_»¥Ú£_šşude
))

1277  -
EINVAL
;

1280 
NAN_REQ_ATTR_SUBSCRIBE_USE_RESP_FILTER
:

1281 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
u£_£rviû_»¥Ú£_f‹r
))

1282  -
EINVAL
;

1285 
NAN_REQ_ATTR_SUBSCRIBE_SSI_REQUIRED
:

1286 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
ssi_»quœed_fÜ_m©ch_šdiÿtiÚ
))

1287  -
EINVAL
;

1290 
NAN_REQ_ATTR_SUBSCRIBE_MATCH_INDICATOR
:

1291 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
subsüibe_m©ch_šdiÿtÜ
))

1292  -
EINVAL
;

1295 
NAN_REQ_ATTR_SUBSCRIBE_COUNT
:

1296 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
subsüibe_couÁ
))

1297  -
EINVAL
;

1300 
NAN_REQ_ATTR_SUBSCRIBE_SERVICE_NAME_LEN
:

1301 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
£rviû_Çme_Ën
))

1302  -
EINVAL
;

1305 
NAN_REQ_ATTR_SUBSCRIBE_SERVICE_NAME
:

1306 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
£rviû_Çme_Ën
, h®_»q->
£rviû_Çme
))

1307  -
EINVAL
;

1310 
NAN_REQ_ATTR_SUBSCRIBE_SERVICE_INFO_LEN
:

1311 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
£rviû_¥ecific_šfo_Ën
))

1312  -
EINVAL
;

1315 
NAN_REQ_ATTR_SUBSCRIBE_SERVICE_INFO
:

1316 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
£rviû_¥ecific_šfo_Ën
, h®_»q->
£rviû_¥ecific_šfo
))

1317  -
EINVAL
;

1320 
NAN_REQ_ATTR_SUBSCRIBE_RX_MATCH_FILTER_LEN
:

1321 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
rx_m©ch_f‹r_Ën
))

1322  -
EINVAL
;

1325 
NAN_REQ_ATTR_SUBSCRIBE_RX_MATCH_FILTER
:

1326 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
rx_m©ch_f‹r_Ën
, h®_»q->
rx_m©ch_f‹r
))

1327  -
EINVAL
;

1330 
NAN_REQ_ATTR_SUBSCRIBE_TX_MATCH_FILTER_LEN
:

1331 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
tx_m©ch_f‹r_Ën
))

1332  -
EINVAL
;

1335 
NAN_REQ_ATTR_SUBSCRIBE_TX_MATCH_FILTER
:

1336 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
tx_m©ch_f‹r_Ën
, h®_»q->
tx_m©ch_f‹r
))

1337  -
EINVAL
;

1340 
NAN_REQ_ATTR_SUBSCRIBE_RSSI_THRESHOLD_FLAG
:

1341 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
rssi_th»shŞd_æag
))

1342  -
EINVAL
;

1345 
NAN_REQ_ATTR_SUBSCRIBE_CONN_MAP
:

1346 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
cÚnm­
))

1347  -
EINVAL
;

1350 
NAN_REQ_ATTR_SUBSCRIBE_NUM_INTF_ADDR_PRESENT
:

1351 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
num_štf_addr_´e£Á
))

1352  -
EINVAL
;

1355 
NAN_REQ_ATTR_SUBSCRIBE_INTF_ADDR
:

1356 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, (
h®_»q
->
num_štf_addr_´e£Á
 * 
ETH_ALEN
), h®_»q->
štf_addr
))

1357  -
EINVAL
;

1360 
NAN_REQ_ATTR_SUBSCRIBE_RECV_IND_CFG
:

1361 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
»cv_šdiÿtiÚ_cfg
))

1362  -
EINVAL
;

1365 
NAN_REQ_ATTR_PUBLISH_SDEA_LEN
:

1366 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
))

1367  -
EINVAL
;

1370 
NAN_REQ_ATTR_PUBLISH_SDEA
:

1371 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
,

1372 
h®_»q
->
sd—_£rviû_¥ecific_šfo
))

1373  -
EINVAL
;

1376 
NAN_REQ_ATTR_RANGING_AUTO_RESPONSE
:

1377 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
¿ngšg_auto_»¥Ú£
))

1378  -
EINVAL
;

1381 
NAN_REQ_ATTR_HAL_TRANSACTION_ID
:

1382 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
Œª§ùiÚ_id
))

1383  -
EINVAL
;

1387 
r
 = 
	`¦si_Çn_g‘_sd—_·¿ms_Æ
(
sdev
, &
h®_»q
->
sd—_·¿ms
, 
™”
, 
ty³
);

1388 ià(
r
)

1389 
r
 = 
	`¦si_Çn_g‘_¿ngšg_cfg_Æ
(
sdev
, &
h®_»q
->
¿ngšg_cfg
, 
™”
, 
ty³
);

1390 ià(
r
)

1391 
r
 = 
	`¦si_Çn_g‘_£cur™y_šfo_Æ
(
sdev
, &
h®_»q
->
£c_šfo
, 
™”
, 
ty³
);

1392 ià(
r
)

1393 
r
 = 
	`¦si_Çn_g‘_¿nge_»¥_cfg_Æ
(
sdev
, &
h®_»q
->
¿nge_»¥Ú£_cfg
, 
™”
, 
ty³
);

1394 ià(
r
) {

1395 
	`SLSI_ERR
(
sdev
, "UÃx³ùed NAN subsüib©Œibu‹ TYPE:%d\n", 
ty³
);

1396  
SLSI_HAL_NAN_STATUS_INVALID_PARAM
;

1400  
SLSI_HAL_NAN_STATUS_SUCCESS
;

1401 
	}
}

1403 
	$¦si_Çn_subsüibe
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1405 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1406 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

1407 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

1408 
¦si_h®_Çn_subsüibe_»q
 *
h®_»q
;

1409 
»t
;

1410 
u32
 
»¶y_¡©us
;

1411 
u32
 
subsüibe_id
 = 0;

1412 
u16
 
Œª§ùiÚ_id
 = 0;

1414 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

1415 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

1416 
ex™
;

1418 
h®_»q
 = 
	`km®loc
((*h®_»q), 
GFP_KERNEL
);

1419 ià(!
h®_»q
) {

1420 
	`SLSI_ERR
(
sdev
, "Failedo‡lloc hal_req structure!!!\n");

1421 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NO_RESOURCE_AVAILABLE
;

1422 
»t
 = -
ENOMEM
;

1423 
ex™
;

1426 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1427 
»¶y_¡©us
 = 
	`¦si_Çn_subsüibe_g‘_Æ_·¿ms
(
sdev
, 
h®_»q
, 
d©a
, 
Ën
);

1428 
Œª§ùiÚ_id
 = 
h®_»q
->transaction_id;

1429 ià(
»¶y_¡©us
 !ğ
SLSI_HAL_NAN_STATUS_SUCCESS
) {

1430 
	`kä“
(
h®_»q
);

1431 
»t
 = -
EINVAL
;

1432 
ex™
;

1434 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1435 ià(!
ndev_vif
->
aùiv©ed
) {

1436 
	`SLSI_WARN
(
sdev
, "NAN vif‚ot‡ctivated\n");

1437 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NAN_NOT_ALLOWED
;

1438 
»t
 = 
WIFI_HAL_ERROR_NOT_AVAILABLE
;

1439 
ex™_w™h_lock
;

1442 ià(!
h®_»q
->
subsüibe_id
) {

1443 
h®_»q
->
subsüibe_id
 = 
	`¦si_Çn_g‘_Ãw_subsüibe_id
(
ndev_vif
);

1444 
ndev_vif
->
Çn
.
Ãxt_£rviû_id
 = (
h®_»q
->
subsüibe_id
 + 1è% (
SLSI_NAN_MAX_SERVICE_ID
 + 1);

1445 } ià(!
	`¦si_Çn_is_subsüibe_id_aùive
(
ndev_vif
, 
h®_»q
->
subsüibe_id
)) {

1446 
	`SLSI_WARN
(
sdev
, "subId %d‚Ù found. m­:%x\n", 
h®_»q
->
subsüibe_id
,

1447 
ndev_vif
->
Çn
.
£rviû_id_m­
);

1448 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PUBLISH_SUBSCRIBE_ID
;

1449 
»t
 = -
EINVAL
;

1450 
ex™_w™h_lock
;

1453 
»t
 = 
	`¦si_mlme_Çn_subsüibe
(
sdev
, 
dev
, 
h®_»q
, h®_»q->
subsüibe_id
);

1454 ià(
»t
) {

1455 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

1456 
	`SLSI_INFO
(
sdev
, "transId:%d subId:%dype:%d Failed\n",

1457 
h®_»q
->
Œª§ùiÚ_id
, h®_»q->
subsüibe_id
, h®_»q->
subsüibe_ty³
);

1459 
	`SLSI_INFO
(
sdev
, "ŒªsId:%d subId:%dy³:%d\ÀÇme:%s", 
h®_»q
->
Œª§ùiÚ_id
,

1460 
h®_»q
->
subsüibe_id
, h®_»q->
subsüibe_ty³
, h®_»q->
£rviû_Çme
);

1461 ià(
h®_»q
->
£rviû_¥ecific_šfo_Ën
)

1462 
	`SLSI_INFO_HEX
(
sdev
, 
h®_»q
->
£rviû_¥ecific_šfo
, h®_»q->
£rviû_¥ecific_šfo_Ën
,

1464 
subsüibe_id
 = 
h®_»q
->subscribe_id;

1467 
ex™_w™h_lock
:

1468 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1469 
	`kä“
(
h®_»q
);

1470 
ex™
:

1471 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_RESPONSE_SUBSCRIBE
, 
subsüibe_id
, 
NULL
,

1472 
Œª§ùiÚ_id
, 
ndev_vif
);

1473  
»t
;

1474 
	}
}

1476 
	$¦si_Çn_subsüibe_ÿnûl
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1478 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1479 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

1480 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

1481 
ty³
, 
tmp
, 
»t
 = 
WIFI_HAL_ERROR_UNKNOWN
;

1482 
u16
 
subsüibe_id
 = 0, 
Œª§ùiÚ_id
 = 0;

1483 cÚ¡ 
Æ©Œ
 *
™”
;

1484 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

1486 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

1487 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

1488 
ex™
;

1490 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1492 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

1493 
ty³
 = 
	`Æa_ty³
(
™”
);

1494 
ty³
) {

1495 
NAN_REQ_ATTR_SUBSCRIBE_ID
:

1496 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &(
subsüibe_id
))) {

1497 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PARAM
;

1498 
ex™
;

1501 
NAN_REQ_ATTR_HAL_TRANSACTION_ID
:

1502 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &(
Œª§ùiÚ_id
))) {

1503 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PARAM
;

1504 
ex™
;

1508 
	`SLSI_ERR
(
sdev
, "UÃx³ùed NAN subsüibeÿnûÈ©Œibu‹ TYPE:%d\n", 
ty³
);

1509 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PARAM
;

1510 
ex™
;

1514 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1515 ià(
ndev_vif
->
aùiv©ed
) {

1516 ià(!
subsüibe_id
 || !
	`¦si_Çn_is_subsüibe_id_aùive
(
ndev_vif
, subscribe_id)) {

1517 
	`SLSI_WARN
(
sdev
, "subId(%d)‚ot‡ctive. map:%x\n",

1518 
subsüibe_id
, 
ndev_vif
->
Çn
.
£rviû_id_m­
);

1519 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PUBLISH_SUBSCRIBE_ID
;

1521 
»t
 = 
	`¦si_mlme_Çn_subsüibe
(
sdev
, 
dev
, 
NULL
, 
subsüibe_id
);

1522 ià(
»t
) {

1523 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

1524 
	`SLSI_INFO
(
sdev
, "ŒªsId:%d subId:%d Faed\n", 
Œª§ùiÚ_id
, 
subsüibe_id
);

1526 
	`SLSI_INFO
(
sdev
, "ŒªsId:%d subId:%d\n", 
Œª§ùiÚ_id
, 
subsüibe_id
);

1530 
	`SLSI_ERR
(
sdev
, "vif‚ot‡ctivated\n");

1531 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NAN_NOT_ALLOWED
;

1532 
»t
 = 
WIFI_HAL_ERROR_NOT_AVAILABLE
;

1534 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1535 
ex™
:

1536 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_RESPONSE_SUBSCRIBE_CANCEL
, 
subsüibe_id
, 
NULL
,

1537 
Œª§ùiÚ_id
, 
ndev_vif
);

1538  
»t
;

1539 
	}
}

1541 
	$¦si_Çn_fŞlowup_g‘_Æ_·¿ms
(
¦si_dev
 *
sdev
, 
¦si_h®_Çn_Œªsm™_fŞlowup_»q
 *
h®_»q
,

1542 cÚ¡ *
d©a
, 
Ën
)

1544 
ty³
, 
tmp
;

1545 cÚ¡ 
Æ©Œ
 *
™”
;

1547 
	`mem£t
(
h®_»q
, 0, (*hal_req));

1548 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

1549 
ty³
 = 
	`Æa_ty³
(
™”
);

1550 
ty³
) {

1551 
NAN_REQ_ATTR_FOLLOWUP_ID
:

1552 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
publish_subsüibe_id
))

1553  -
EINVAL
;

1556 
NAN_REQ_ATTR_FOLLOWUP_REQUESTOR_ID
:

1557 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
»que¡Ü_š¡ªû_id
))

1558  -
EINVAL
;

1561 
NAN_REQ_ATTR_FOLLOWUP_ADDR
:

1562 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
ETH_ALEN
, 
h®_»q
->
addr
))

1563  -
EINVAL
;

1566 
NAN_REQ_ATTR_FOLLOWUP_PRIORITY
:

1567 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
´iÜ™y
))

1568  -
EINVAL
;

1571 
NAN_REQ_ATTR_FOLLOWUP_TX_WINDOW
:

1572 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
dw_Ü_çw
))

1573  -
EINVAL
;

1576 
NAN_REQ_ATTR_FOLLOWUP_SERVICE_NAME_LEN
:

1577 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
£rviû_¥ecific_šfo_Ën
))

1578  -
EINVAL
;

1581 
NAN_REQ_ATTR_FOLLOWUP_SERVICE_NAME
:

1582 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
£rviû_¥ecific_šfo_Ën
, h®_»q->
£rviû_¥ecific_šfo
))

1583  -
EINVAL
;

1586 
NAN_REQ_ATTR_FOLLOWUP_RECV_IND_CFG
:

1587 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
»cv_šdiÿtiÚ_cfg
))

1588  -
EINVAL
;

1591 
NAN_REQ_ATTR_PUBLISH_SDEA_LEN
:

1592 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
))

1593  -
EINVAL
;

1596 
NAN_REQ_ATTR_PUBLISH_SDEA
:

1597 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
sd—_£rviû_¥ecific_šfo_Ën
,

1598 
h®_»q
->
sd—_£rviû_¥ecific_šfo
))

1599  -
EINVAL
;

1602 
NAN_REQ_ATTR_HAL_TRANSACTION_ID
:

1603 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
Œª§ùiÚ_id
))

1604  -
EINVAL
;

1608 
	`SLSI_ERR
(
sdev
, "UÃx³ùed NAN fŞlowu°©Œibu‹ TYPE:%d\n", 
ty³
);

1609  
SLSI_HAL_NAN_STATUS_INVALID_PARAM
;

1612  
SLSI_HAL_NAN_STATUS_SUCCESS
;

1613 
	}
}

1615 
	$¦si_Çn_Œªsm™_fŞlowup
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1617 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1618 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

1619 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

1620 
¦si_h®_Çn_Œªsm™_fŞlowup_»q
 
h®_»q
;

1621 
»t
 = 0;

1622 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

1624 
h®_»q
.
Œª§ùiÚ_id
 = 0;

1625 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

1626 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

1627 
ex™
;

1629 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1630 
»¶y_¡©us
 = 
	`¦si_Çn_fŞlowup_g‘_Æ_·¿ms
(
sdev
, &
h®_»q
, 
d©a
, 
Ën
);

1631 ià(
»¶y_¡©us
) {

1632 
»t
 = -
EINVAL
;

1633 
ex™
;

1636 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1637 ià(!
ndev_vif
->
aùiv©ed
) {

1638 
	`SLSI_WARN
(
sdev
, "NAN vif‚ot‡ctivated\n");

1639 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NAN_NOT_ALLOWED
;

1640 
»t
 = 
WIFI_HAL_ERROR_NOT_AVAILABLE
;

1641 
ex™_w™h_lock
;

1644 ià(!
h®_»q
.
publish_subsüibe_id
 ||

1645 !(
	`¦si_Çn_is_subsüibe_id_aùive
(
ndev_vif
, 
h®_»q
.
publish_subsüibe_id
) ||

1646 
	`¦si_Çn_is_publish_id_aùive
(
ndev_vif
, 
h®_»q
.
publish_subsüibe_id
))) {

1647 
	`SLSI_WARN
(
sdev
, "publish/Subsüibid %d‚Ù found. m­:%x\n", 
h®_»q
.
publish_subsüibe_id
,

1648 
ndev_vif
->
Çn
.
£rviû_id_m­
);

1649 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PUBLISH_SUBSCRIBE_ID
;

1650 
»t
 = -
EINVAL
;

1651 
ex™_w™h_lock
;

1654 ià(!
	`¦si_Çn_g‘_fŞlowup_Œªs_id
(
ndev_vif
, 
h®_»q
.
»que¡Ü_š¡ªû_id
))

1655 
»t
 = 
	`¦si_mlme_Çn_tx_fŞlowup
(
sdev
, 
dev
, &
h®_»q
);

1657 
»t
 = 
SLSI_HAL_NAN_STATUS_FOLLOWUP_QUEUE_FULL
;

1659 ià(
»t
) {

1660 ià(
»t
 =ğ
SLSI_HAL_NAN_STATUS_FOLLOWUP_QUEUE_FULL
) {

1661 
»¶y_¡©us
 = 
»t
;

1662 
»t
 = 0;

1664 
»¶y_¡©us
 = 
»t
 =ğ
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

1667 
	`SLSI_INFO
(
sdev
,

1669 
h®_»q
.
Œª§ùiÚ_id
, h®_»q.
publish_subsüibe_id
, h®_»q.
»que¡Ü_š¡ªû_id
);

1672 
ex™_w™h_lock
:

1673 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1674 
ex™
:

1675 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_RESPONSE_TRANSMIT_FOLLOWUP
, 0, 
NULL
, 
h®_»q
.
Œª§ùiÚ_id
, 
ndev_vif
);

1676  
»t
;

1677 
	}
}

1679 
	$¦si_Çn_cÚfig_g‘_Æ_·¿ms
(
¦si_dev
 *
sdev
, 
¦si_h®_Çn_cÚfig_»q
 *
h®_»q
,

1680 cÚ¡ *
d©a
, 
Ën
)

1682 
ty³
, 
ty³1
, 
tmp
, 
tmp1
, 
disc_©Œ_idx
 = 0, 
çmchª_idx
 = 0;

1683 cÚ¡ 
Æ©Œ
 *
™”
, *
™”1
;

1684 
¦si_h®_Çn_po¡_discov”y_·¿m
 *
disc_©Œ
;

1685 
¦si_h®_Çn_fu¹h”_avaab™y_chªÃl
 *
çmchª
;

1686 #ifdeà
SCSC_SEP_VERSION


1687 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

1688 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1690 
u8
 
v®
 = 0;

1691 
u32
 
¿ndom_š‹rv®
 = 0;

1693 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

1694 
ty³
 = 
	`Æa_ty³
(
™”
);

1695 
ty³
) {

1696 
NAN_REQ_ATTR_SID_BEACON_VAL
:

1697 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
sid_b—cÚ
))

1698  -
EINVAL
;

1699 
h®_»q
->
cÚfig_sid_b—cÚ
 = 1;

1702 
NAN_REQ_ATTR_RSSI_PROXIMITY_2G4_VAL
:

1703 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
rssi_´oxim™y
))

1704  -
EINVAL
;

1705 
h®_»q
->
cÚfig_rssi_´oxim™y
 = 1;

1708 
NAN_REQ_ATTR_MASTER_PREF
:

1709 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
ma¡”_´ef
))

1710  -
EINVAL
;

1711 
h®_»q
->
cÚfig_ma¡”_´ef
 = 1;

1714 
NAN_REQ_ATTR_RSSI_CLOSE_PROXIMITY_5G_VAL
:

1715 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
rssi_şo£_´oxim™y_5g_v®
))

1716  -
EINVAL
;

1717 
h®_»q
->
cÚfig_5g_rssi_şo£_´oxim™y
 = 1;

1720 
NAN_REQ_ATTR_RSSI_WINDOW_SIZE_VAL
:

1721 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
v®
))

1722  -
EINVAL
;

1723 
h®_»q
->
rssi_wšdow_size_v®
 = (
u16
)
v®
;

1724 
h®_»q
->
cÚfig_rssi_wšdow_size
 = 1;

1727 
NAN_REQ_ATTR_CLUSTER_VAL
:

1728 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
cÚfig_şu¡”_©Œibu‹_v®
))

1729  -
EINVAL
;

1732 
NAN_REQ_ATTR_SOCIAL_CH_SCAN_DWELL_TIME
:

1733 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, (
h®_»q
->
sÿn_·¿ms_v®
.
dw–l_time
),

1734 
h®_»q
->
sÿn_·¿ms_v®
.
dw–l_time
))

1735  -
EINVAL
;

1736 
h®_»q
->
cÚfig_sÿn_·¿ms
 = 1;

1739 
NAN_REQ_ATTR_SOCIAL_CH_SCAN_PERIOD
:

1740 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, (
h®_»q
->
sÿn_·¿ms_v®
.
sÿn_³riod
),

1741 
h®_»q
->
sÿn_·¿ms_v®
.
sÿn_³riod
))

1742  -
EINVAL
;

1743 
h®_»q
->
cÚfig_sÿn_·¿ms
 = 1;

1746 
NAN_REQ_ATTR_RANDOM_FACTOR_FORCE_VAL
:

1747 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
¿ndom_çùÜ_fÜû_v®
))

1748  -
EINVAL
;

1749 
h®_»q
->
cÚfig_¿ndom_çùÜ_fÜû
 = 1;

1752 
NAN_REQ_ATTR_HOP_COUNT_FORCE_VAL
:

1753 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
hİ_couÁ_fÜû_v®
))

1754  -
EINVAL
;

1755 
h®_»q
->
cÚfig_hİ_couÁ_fÜû
 = 1;

1758 
NAN_REQ_ATTR_CONN_CAPABILITY_PAYLOAD_TX
:

1759 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
cÚn_ÿ·b™y_v®
.
·ylßd_Œªsm™_æag
))

1760  -
EINVAL
;

1761 
h®_»q
->
cÚfig_cÚn_ÿ·b™y
 = 1;

1764 
NAN_REQ_ATTR_CONN_CAPABILITY_WFD
:

1765 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
cÚn_ÿ·b™y_v®
.
is_wfd_suµÜ‹d
))

1766  -
EINVAL
;

1767 
h®_»q
->
cÚfig_cÚn_ÿ·b™y
 = 1;

1770 
NAN_REQ_ATTR_CONN_CAPABILITY_WFDS
:

1771 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
cÚn_ÿ·b™y_v®
.
is_wfds_suµÜ‹d
))

1772  -
EINVAL
;

1773 
h®_»q
->
cÚfig_cÚn_ÿ·b™y
 = 1;

1776 
NAN_REQ_ATTR_CONN_CAPABILITY_TDLS
:

1777 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
cÚn_ÿ·b™y_v®
.
is_tdls_suµÜ‹d
))

1778  -
EINVAL
;

1779 
h®_»q
->
cÚfig_cÚn_ÿ·b™y
 = 1;

1782 
NAN_REQ_ATTR_CONN_CAPABILITY_MESH
:

1783 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
cÚn_ÿ·b™y_v®
.
is_mesh_suµÜ‹d
))

1784  -
EINVAL
;

1785 
h®_»q
->
cÚfig_cÚn_ÿ·b™y
 = 1;

1788 
NAN_REQ_ATTR_CONN_CAPABILITY_IBSS
:

1789 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
cÚn_ÿ·b™y_v®
.
is_ibss_suµÜ‹d
))

1790  -
EINVAL
;

1791 
h®_»q
->
cÚfig_cÚn_ÿ·b™y
 = 1;

1794 
NAN_REQ_ATTR_CONN_CAPABILITY_WLAN_INFRA
:

1795 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
cÚn_ÿ·b™y_v®
.
wÏn_šäa_f›ld
))

1796  -
EINVAL
;

1797 
h®_»q
->
cÚfig_cÚn_ÿ·b™y
 = 1;

1800 
NAN_REQ_ATTR_DISCOVERY_ATTR_NUM_ENTRIES
:

1801 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
num_cÚfig_discov”y_©Œ
))

1802  -
EINVAL
;

1805 
NAN_REQ_ATTR_DISCOVERY_ATTR_VAL
:

1806 ià(
disc_©Œ_idx
 >ğ
h®_»q
->
num_cÚfig_discov”y_©Œ
) {

1807 
	`SLSI_ERR
(
sdev
,

1809 
disc_©Œ_idx
 + 1, 
h®_»q
->
num_cÚfig_discov”y_©Œ
);

1810  -
EINVAL
;

1812 
disc_©Œ
 = &
h®_»q
->
discov”y_©Œ_v®
[
disc_©Œ_idx
];

1813 
disc_©Œ_idx
++;

1814 
	`Æa_fÜ_—ch_Ã¡ed
(
™”1
, 
™”
, 
tmp1
) {

1815 
ty³1
 = 
	`Æa_ty³
(
™”1
);

1816 
ty³1
) {

1817 
NAN_REQ_ATTR_CONN_TYPE
:

1818 ià(
	`¦si_ut_Æa_g‘_u8
(
™”1
, &
disc_©Œ
->
ty³
))

1819  -
EINVAL
;

1822 
NAN_REQ_ATTR_NAN_ROLE
:

1823 ià(
	`¦si_ut_Æa_g‘_u8
(
™”1
, &
disc_©Œ
->
rŞe
))

1824  -
EINVAL
;

1827 
NAN_REQ_ATTR_TRANSMIT_FREQ
:

1828 ià(
	`¦si_ut_Æa_g‘_u8
(
™”1
, &
disc_©Œ
->
Œªsm™_äeq
))

1829  -
EINVAL
;

1832 
NAN_REQ_ATTR_AVAILABILITY_DURATION
:

1833 ià(
	`¦si_ut_Æa_g‘_u8
(
™”1
, &
disc_©Œ
->
du¿tiÚ
))

1834  -
EINVAL
;

1837 
NAN_REQ_ATTR_AVAILABILITY_INTERVAL
:

1838 ià(
	`¦si_ut_Æa_g‘_u32
(
™”1
, &
disc_©Œ
->
ava_š‹rv®_b™m­
))

1839  -
EINVAL
;

1842 
NAN_REQ_ATTR_MAC_ADDR_VAL
:

1843 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”1
, 
ETH_ALEN
, 
disc_©Œ
->
addr
))

1844  -
EINVAL
;

1847 
NAN_REQ_ATTR_MESH_ID_LEN
:

1848 ià(
	`¦si_ut_Æa_g‘_u16
(
™”1
, &
disc_©Œ
->
mesh_id_Ën
))

1849  -
EINVAL
;

1852 
NAN_REQ_ATTR_MESH_ID
:

1853 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”1
, 
disc_©Œ
->
mesh_id_Ën
, disc_©Œ->
mesh_id
))

1854  -
EINVAL
;

1857 
NAN_REQ_ATTR_INFRASTRUCTURE_SSID_LEN
:

1858 ià(
	`¦si_ut_Æa_g‘_u16
(
™”1
, &
disc_©Œ
->
šäa¡ruùu»_ssid_Ën
))

1859  -
EINVAL
;

1862 
NAN_REQ_ATTR_INFRASTRUCTURE_SSID
:

1863 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”1
, 
disc_©Œ
->
šäa¡ruùu»_ssid_Ën
,

1864 
disc_©Œ
->
šäa¡ruùu»_ssid_v®
))

1865  -
EINVAL
;

1871 
NAN_REQ_ATTR_FURTHER_AVAIL_NUM_ENTRIES
:

1872 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
çm_v®
.
numchªs
))

1873  -
EINVAL
;

1874 
h®_»q
->
cÚfig_çm
 = 1;

1877 
NAN_REQ_ATTR_FURTHER_AVAIL_VAL
:

1878 
h®_»q
->
cÚfig_çm
 = 1;

1879 ià(
çmchª_idx
 >ğ
h®_»q
->
çm_v®
.
numchªs
) {

1880 
	`SLSI_ERR
(
sdev
,

1882 
çmchª_idx
 + 1, 
h®_»q
->
çm_v®
.
numchªs
);

1883  -
EINVAL
;

1885 
çmchª
 = &
h®_»q
->
çm_v®
.çmchª[
çmchª_idx
];

1886 
çmchª_idx
++;

1887 
	`Æa_fÜ_—ch_Ã¡ed
(
™”1
, 
™”
, 
tmp1
) {

1888 
ty³1
 = 
	`Æa_ty³
(
™”1
);

1889 
ty³1
) {

1890 
NAN_REQ_ATTR_FURTHER_AVAIL_ENTRY_CTRL
:

1891 ià(
	`¦si_ut_Æa_g‘_u8
(
™”1
, &
çmchª
->
’Œy_cÚŒŞ
))

1892  -
EINVAL
;

1895 
NAN_REQ_ATTR_FURTHER_AVAIL_CHAN_CLASS
:

1896 ià(
	`¦si_ut_Æa_g‘_u8
(
™”1
, &
çmchª
->
şass_v®
))

1897  -
EINVAL
;

1900 
NAN_REQ_ATTR_FURTHER_AVAIL_CHAN
:

1901 ià(
	`¦si_ut_Æa_g‘_u8
(
™”1
, &
çmchª
->
chªÃl
))

1902  -
EINVAL
;

1905 
NAN_REQ_ATTR_FURTHER_AVAIL_CHAN_MAPID
:

1906 ià(
	`¦si_ut_Æa_g‘_u8
(
™”1
, &
çmchª
->
m­id
))

1907  -
EINVAL
;

1910 
NAN_REQ_ATTR_FURTHER_AVAIL_INTERVAL_BITMAP
:

1911 ià(
	`¦si_ut_Æa_g‘_u32
(
™”1
, &
çmchª
->
ava_š‹rv®_b™m­
))

1912  -
EINVAL
;

1918 
NAN_REQ_ATTR_SUBSCRIBE_SID_BEACON_VAL
:

1919 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
v®
))

1920  -
EINVAL
;

1921 
h®_»q
->
subsüibe_sid_b—cÚ_v®
 = (
u32
)
v®
;

1922 
h®_»q
->
cÚfig_subsüibe_sid_b—cÚ
 = 1;

1925 
NAN_REQ_ATTR_DW_2G4_INTERVAL
:

1926 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
v®
))

1927  -
EINVAL
;

1928 
h®_»q
->
dw_2dÙ4g_š‹rv®_v®
 = (
u32
)
v®
;

1930 ià(
h®_»q
->
dw_2dÙ4g_š‹rv®_v®
 > 0 && hal_req->dw_2dot4g_interval_val < 6)

1931 
h®_»q
->
cÚfig_2dÙ4g_dw_bªd
 = 1;

1934 
NAN_REQ_ATTR_DW_5G_INTERVAL
:

1935 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
v®
))

1936  -
EINVAL
;

1937 
h®_»q
->
dw_5g_š‹rv®_v®
 = (
u32
)
v®
;

1939 ià(
h®_»q
->
dw_5g_š‹rv®_v®
 < 6)

1940 
h®_»q
->
cÚfig_5g_dw_bªd
 = 1;

1942 
NAN_REQ_ATTR_DISC_MAC_ADDR_RANDOM_INTERVAL
:

1943 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
¿ndom_š‹rv®
))

1944  -
EINVAL
;

1945 ià(
	`¦si_g‘_Çn_mac_¿ndom
())

1946 
h®_»q
->
disc_mac_addr_¿nd_š‹rv®_£c
 = 
¿ndom_š‹rv®
;

1948 
h®_»q
->
disc_mac_addr_¿nd_š‹rv®_£c
 = 0;

1949 #ifdeà
SCSC_SEP_VERSION


1950 
¿ndom_š‹rv®
 =„ªdom_š‹rv® & 
SLSI_NAN_CLUSTER_MERGE_ENABLE_MASK
;

1951 ià(
¿ndom_š‹rv®
 =ğ
SLSI_NAN_CLUSTER_MERGE_ENABLE_MASK
) {

1952 
ndev_vif
->
Çn
.
di§bË_şu¡”_m”ge
 = 0;

1953 
h®_»q
->
disc_mac_addr_¿nd_š‹rv®_£c
 &ğ
SLSI_NAN_MAC_RANDOM_INTERVAL_MASK
;

1954 } ià(
¿ndom_š‹rv®
 =ğ
SLSI_NAN_CLUSTER_MERGE_DISABLE_MASK
) {

1955 
ndev_vif
->
Çn
.
di§bË_şu¡”_m”ge
 = 1;

1956 
h®_»q
->
disc_mac_addr_¿nd_š‹rv®_£c
 &ğ
SLSI_NAN_MAC_RANDOM_INTERVAL_MASK
;

1960 
NAN_REQ_ATTR_HAL_TRANSACTION_ID
:

1961 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
Œª§ùiÚ_id
))

1962  -
EINVAL
;

1964 
NAN_REQ_ATTR_DISCOVERY_BEACON_INT
:

1965 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
discov”y_b—cÚ_š‹rv®_ms
))

1966  -
EINVAL
;

1968 
NAN_REQ_ATTR_NSS
:

1969 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
nss_discov”y
))

1970  -
EINVAL
;

1972 
NAN_REQ_ATTR_ENABLE_RANGING
:

1973 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
’abË_¿ngšg
))

1974  -
EINVAL
;

1976 
NAN_REQ_ATTR_DW_EARLY_TERMINATION
:

1977 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
’abË_dw_—¾y_‹rmš©iÚ
))

1978  -
EINVAL
;

1981 
	`SLSI_ERR
(
sdev
, "UÃx³ùed NAN cÚfig‡‰ribu‹ TYPE:%d\n", 
ty³
);

1984  
SLSI_HAL_NAN_STATUS_SUCCESS
;

1985 
	}
}

1987 
	$¦si_Çn_£t_cÚfig
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

1989 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

1990 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

1991 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

1992 
u16
 
Œª§ùiÚ_id
 = 0;

1993 
»t
;

1994 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

1996 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

1997 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

1998 
ex™
;

2000 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2002 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2003 
»¶y_¡©us
 = 
	`¦si_Çn_cÚfig_g‘_Æ_·¿ms
(
sdev
, &
ndev_vif
->
Çn
.
cÚfig
, 
d©a
, 
Ën
);

2004 
Œª§ùiÚ_id
 = 
ndev_vif
->
Çn
.
cÚfig
.transaction_id;

2005 ià(
»¶y_¡©us
) {

2006 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2007 
»t
 = -
EINVAL
;

2008 
ex™
;

2010 ià(!
ndev_vif
->
aùiv©ed
) {

2011 
	`SLSI_WARN
(
sdev
, "NAN vif‚ot‡ctivated\n");

2012 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NAN_NOT_ALLOWED
;

2013 
»t
 = 
WIFI_HAL_ERROR_NOT_AVAILABLE
;

2015 
»t
 = 
	`¦si_mlme_Çn_£t_cÚfig
(
sdev
, 
dev
, &
ndev_vif
->
Çn
.
cÚfig
);

2016 ià(
»t
) {

2017 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

2019 ià(
ndev_vif
->
Çn
.
cÚfig
.
cÚfig_ma¡”_´ef
)

2020 
ndev_vif
->
Çn
.
ma¡”_´ef_v®ue
 =‚dev_vif->Çn.
cÚfig
.
ma¡”_´ef
;

2021 
ndev_vif
->
Çn
.
¿ndom_mac_š‹rv®_£c
 =‚dev_vif->Çn.
cÚfig
.
disc_mac_addr_¿nd_š‹rv®_£c
;

2022 
	`SLSI_INFO
(
sdev
, "transId:%d masterPref:%d\n",

2023 
ndev_vif
->
Çn
.
cÚfig
.
Œª§ùiÚ_id
,‚dev_vif->Çn.cÚfig.
ma¡”_´ef
);

2026 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2027 
ex™
:

2028 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_RESPONSE_CONFIG
, 0, 
NULL
, 
Œª§ùiÚ_id
, 
ndev_vif
);

2029  
»t
;

2030 
	}
}

2032 
	$¦si_Çn_g‘_ÿ·b™›s
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2034 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2035 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

2036 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

2037 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

2038 
¦si_h®_Çn_ÿ·b™›s
 
Çn_ÿ·b™›s
;

2039 
»t
 = 0, 
i
;

2040 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

2041 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

2042 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = {{ 
SLSI_PSID_UNIFI_NAN_MAX_CONCURRENT_CLUSTERS
, { 0, 0 } },

2043 { 
SLSI_PSID_UNIFI_NAN_MAX_CONCURRENT_PUBLISHES
, { 0, 0 } },

2044 { 
SLSI_PSID_UNIFI_NAN_MAX_CONCURRENT_SUBSCRIBES
, { 0, 0 } },

2045 { 
SLSI_PSID_UNIFI_NAN_MAX_SERVICE_NAME_LENGTH
, { 0, 0 } },

2046 { 
SLSI_PSID_UNIFI_NAN_MAX_MATCH_FILTER_LENGTH
, { 0, 0 } },

2047 { 
SLSI_PSID_UNIFI_NAN_MAX_TOTAL_MATCH_FILTER_LENGTH
, { 0, 0 } },

2048 { 
SLSI_PSID_UNIFI_NAN_MAX_SERVICE_SPECIFIC_INFO_LENGTH
, { 0, 0 } },

2049 { 
SLSI_PSID_UNIFI_NAN_MAX_NDI_INTERFACES
, { 0, 0 } },

2050 { 
SLSI_PSID_UNIFI_NAN_MAX_NDP_SESSIONS
, { 0, 0 } },

2051 { 
SLSI_PSID_UNIFI_NAN_MAX_APP_INFO_LENGTH
, { 0, 0 } },

2052 { 
SLSI_PSID_UNIFI_NAN_MAX_QUEUED_FOLLOWUPS
, { 0, 0 } },

2053 { 
SLSI_PSID_UNIFI_NAN_MAX_SUBSCRIBE_INTERFACE_ADDRESSES
, { 0, 0 } },

2054 { 
SLSI_PSID_UNIFI_NAN_SUPPORTED_CIPHER_SUITES
, { 0, 0 }, },

2055 { 
SLSI_PSID_UNIFI_NAN_MAX_EXTENDED_SERVICE_SPECIFIC_INFO_LEN
, { 0, 0} } };

2056 
u32
 *
ÿ·b™›s_mib_v®
[] = { &
Çn_ÿ·b™›s
.
max_cÚcu¼’t_Çn_şu¡”s
,

2057 &
Çn_ÿ·b™›s
.
max_publishes
,

2058 &
Çn_ÿ·b™›s
.
max_subsüibes
,

2059 &
Çn_ÿ·b™›s
.
max_£rviû_Çme_Ën
,

2060 &
Çn_ÿ·b™›s
.
max_m©ch_f‹r_Ën
,

2061 &
Çn_ÿ·b™›s
.
max_tÙ®_m©ch_f‹r_Ën
,

2062 &
Çn_ÿ·b™›s
.
max_£rviû_¥ecific_šfo_Ën
,

2063 &
Çn_ÿ·b™›s
.
max_ndi_š‹rçûs
,

2064 &
Çn_ÿ·b™›s
.
max_ndp_£ssiÚs
,

2065 &
Çn_ÿ·b™›s
.
max_­p_šfo_Ën
,

2066 &
Çn_ÿ·b™›s
.
max_queued_Œªsm™_fŞlowup_msgs
,

2067 &
Çn_ÿ·b™›s
.
max_subsüibe_add»ss
,

2068 &
Çn_ÿ·b™›s
.
ch”_su™es_suµÜ‹d
,

2069 &
Çn_ÿ·b™›s
.
max_sd—_£rviû_¥ecific_šfo_Ën
 };

2070 
ty³
, 
tmp
;

2071 cÚ¡ 
Æ©Œ
 *
™”
;

2072 
u16
 
Œª§ùiÚ_id
 = 0;

2074 
	`mem£t
(&
Çn_ÿ·b™›s
, 0, (nan_capabilities));

2075 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

2076 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

2077 
ex™
;

2079 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

2080 
ty³
 = 
	`Æa_ty³
(
™”
);

2081 
ty³
) {

2082 
NAN_REQ_ATTR_HAL_TRANSACTION_ID
:

2083 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &(
Œª§ùiÚ_id
))) {

2084 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀ»adšg‡‰ribu‹ %d\n", 
ty³
);

2085 
ex™
;

2093 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2096 
mibr¥
.
d©aL’gth
 = 11 * 
	`ARRAY_SIZE
(
g‘_v®ues
);

2097 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

2098 ià(!
mibr¥
.
d©a
) {

2099 
	`SLSI_ERR
(
sdev
, "CªnÙ km®loø%d by‹s\n", 
mibr¥
.
d©aL’gth
);

2100 
ex™
;

2103 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2105 
v®ues
 = 
	`¦si_»ad_mibs
(
sdev
, 
NULL
, 
g‘_v®ues
, 
	`ARRAY_SIZE
(g‘_v®ues), &
mibr¥
);

2106 ià(!
v®ues
)

2107 
ex™_w™h_mibr¥
;

2109 
i
 = 0; i < ()
	`ARRAY_SIZE
(
g‘_v®ues
); i++) {

2110 ià(
v®ues
[
i
].
ty³
 =ğ
SLSI_MIB_TYPE_UINT
) {

2111 *
ÿ·b™›s_mib_v®
[
i
] = 
v®ues
[i].
u
.
uštV®ue
;

2112 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "MIB v®uğ%u\n", *
ÿ·b™›s_mib_v®
[
i
]);

2114 
	`SLSI_ERR
(
sdev
, "šv®idy³(%d). i‹r:%d\n", 
v®ues
[
i
].
ty³
, i);

2115 *
ÿ·b™›s_mib_v®
[
i
] = 0;

2119 ià(!
Çn_ÿ·b™›s
.
max_ndi_š‹rçûs
)

2120 
Çn_ÿ·b™›s
.
max_ndi_š‹rçûs
 = 
	`¦si_g‘_Çn_max_ndi_içûs
();

2121 ià(!
Çn_ÿ·b™›s
.
max_ndp_£ssiÚs
)

2122 
Çn_ÿ·b™›s
.
max_ndp_£ssiÚs
 = 
	`¦si_g‘_Çn_max_ndp_š¡ªûs
();

2124 ià(
Çn_ÿ·b™›s
.
max_ndi_š‹rçûs
 > 
SLSI_NAN_MAX_NDP_INSTANCES
) {

2125 
	`SLSI_ERR
(
sdev
, "max‚d°if's:%d buˆsuµÜ‹d:%d\n", 
Çn_ÿ·b™›s
.
max_ndi_š‹rçûs
,

2126 
SLSI_NAN_MAX_NDP_INSTANCES
);

2127 
Çn_ÿ·b™›s
.
max_ndi_š‹rçûs
 = 
SLSI_NAN_MAX_NDP_INSTANCES
;

2130 ià(
Çn_ÿ·b™›s
.
max_ndp_£ssiÚs
 > 
SLSI_NAN_MAX_NDP_INSTANCES
) {

2131 
	`SLSI_ERR
(
sdev
, "max‚d°if's:%d buˆsuµÜ‹d:%d\n", 
Çn_ÿ·b™›s
.
max_ndp_£ssiÚs
,

2132 
SLSI_NAN_MAX_NDP_INSTANCES
);

2133 
Çn_ÿ·b™›s
.
max_ndp_£ssiÚs
 = 
SLSI_NAN_MAX_NDP_INSTANCES
;

2136 
	`SLSI_INFO
(
sdev
, "ŒªsId:%d\n", 
Œª§ùiÚ_id
);

2138 
	`kä“
(
v®ues
);

2139 
ex™_w™h_mibr¥
:

2140 
	`kä“
(
mibr¥
.
d©a
);

2141 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2142 
ex™
:

2144 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
SLSI_HAL_NAN_STATUS_SUCCESS
, 0, 
NAN_RESPONSE_GET_CAPABILITIES
, 0, &
Çn_ÿ·b™›s
, 
Œª§ùiÚ_id
, 
ndev_vif
);

2146 
	}
}

2148 
	$¦si_Çn_d©a_içû_ü—‹
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2150 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2151 
u8
 *
içû_Çme
 = 
NULL
;

2152 
»t
 = 0, 
if_idx
, 
ty³
, 
tmp
, 
”r
;

2153 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

2154 
Ãt_deviû
 *
dev_ndp
 = 
NULL
;

2155 
Ãtdev_vif
 *
ndev_d©a_vif
 = 
NULL
;

2156 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

2157 cÚ¡ 
Æ©Œ
 *
™”
;

2158 
u16
 
Œª§ùiÚ_id
 = 0;

2160 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

2161 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

2162 
ex™
;

2164 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

2165 
ty³
 = 
	`Æa_ty³
(
™”
);

2166 ià(
ty³
 =ğ
NAN_REQ_ATTR_DATA_INTERFACE_NAME
) {

2170 ià(
	`Æa_Ën
(
™”
è> 
IFNAMSIZ
)

2171  -
EINVAL
;

2172 
içû_Çme
 = 
	`Æa_d©a
(
™”
);

2173 } ià(
ty³
 =ğ
NAN_REQ_ATTR_HAL_TRANSACTION_ID
)

2174 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
Œª§ùiÚ_id
))

2175  -
EINVAL
;

2177 ià(!
içû_Çme
) {

2178 
	`SLSI_ERR
(
sdev
, "No NAN data interface‚ame\n");

2179 
»t
 = 
WIFI_HAL_ERROR_INVALID_ARGS
;

2180 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PARAM
;

2181 
ex™
;

2184 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2186 
if_idx
 = 
SLSI_NAN_DATA_IFINDEX_START
; if_idx < 
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1; if_idx++) {

2187 
dev_ndp
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
if_idx
);

2188 ià(!
dev_ndp
)

2192 ià(
if_idx
 >ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1) {

2193 
	`SLSI_ERR
(
sdev
, "NAN‚o free NAN data interfaces\n");

2194 
»t
 = 
WIFI_HAL_ERROR_TOO_MANY_REQUESTS
;

2195 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PARAM
;

2196 
ex™_w™h_lock
;

2199 
”r
 = 
	`¦si_Ãtif_add_locked
(
sdev
, 
içû_Çme
, 
if_idx
);

2200 ià(
”r
) {

2201 
	`SLSI_ERR
(
sdev
, "NAN fa‚‘_if_add if_Çme:%s, if_idx:%d\n", 
içû_Çme
, 
if_idx
);

2202 
»t
 = 
WIFI_HAL_ERROR_OUT_OF_MEMORY
;

2203 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NO_RESOURCE_AVAILABLE
;

2204 
ex™_w™h_lock
;

2207 
dev_ndp
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
if_idx
);

2208 ià(!
dev_ndp
)

2209 
ex™_w™h_lock
;

2211 
”r
 = 
	`¦si_Ãtif_»gi¡”_locked
(
sdev
, 
dev_ndp
);

2212 ià(
”r
) {

2213 
	`SLSI_ERR
(
sdev
, "NAN fa‚‘devƒ¼:%d if_Çme:%s, if_idx:%d\n", 
”r
);

2214 
»t
 = 
WIFI_HAL_ERROR_UNKNOWN
;

2215 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NO_RESOURCE_AVAILABLE
;

2217 
	`SLSI_INFO
(
sdev
, "Œªs_id:%d, if_Çme:%s, if_idx:%d\n", 
Œª§ùiÚ_id
, 
içû_Çme
, 
if_idx
);

2218 
ndev_d©a_vif
 = 
	`Ãtdev_´iv
(
dev_ndp
);

2219 
	`SLSI_MUTEX_LOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

2220 
ndev_d©a_vif
->
vif_ty³
 = 
SLSI_NAN_VIF_TYPE_NDP
;

2221 
	`SLSI_MUTEX_UNLOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

2224 
ex™_w™h_lock
:

2225 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2226 
ex™
:

2227 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_DP_INTERFACE_CREATE
, 0, 
NULL
, 
Œª§ùiÚ_id
, 
ndev_d©a_vif
);

2228  
»t
;

2229 
	}
}

2231 
	$¦si_Çn_d©a_içû_d–‘e
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2233 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2234 
u8
 *
içû_Çme
 = 
NULL
;

2235 
»t
 = 0, 
if_idx
, 
ty³
, 
tmp
;

2236 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

2237 
Ãt_deviû
 *
dev_ndp
 = 
NULL
;

2238 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

2239 cÚ¡ 
Æ©Œ
 *
™”
;

2240 
u16
 
Œª§ùiÚ_id
 = 0;

2242 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

2243 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

2244 
ex™
;

2246 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

2247 
ty³
 = 
	`Æa_ty³
(
™”
);

2248 ià(
ty³
 =ğ
NAN_REQ_ATTR_DATA_INTERFACE_NAME
) {

2252 ià(
	`Æa_Ën
(
™”
è> 
IFNAMSIZ
)

2253  -
EINVAL
;

2254 
içû_Çme
 = 
	`Æa_d©a
(
™”
);

2255 } ià(
ty³
 =ğ
NAN_REQ_ATTR_HAL_TRANSACTION_ID
)

2256 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &(
Œª§ùiÚ_id
)))

2257  -
EINVAL
;

2259 ià(!
içû_Çme
) {

2260 
	`SLSI_ERR
(
sdev
, "No NAN data interface‚ame\n");

2261 
»t
 = 
WIFI_HAL_ERROR_INVALID_ARGS
;

2262 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INVALID_PARAM
;

2263 
ex™
;

2266 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2267 
if_idx
 = 
SLSI_NAN_DATA_IFINDEX_START
; if_idx < 
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1; if_idx++) {

2268 
dev_ndp
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
if_idx
);

2269 ià(
dev_ndp
 && 
	`¡rcmp
(
içû_Çme
, dev_ndp->
Çme
) == 0)

2271 
dev_ndp
 = 
NULL
;

2274 ià(
dev_ndp
) {

2275 
	`¦si_Ãtif_»move_locked
(
sdev
, 
dev_ndp
);

2276 
	`SLSI_INFO
(
sdev
, "Sucûs ŒªsId:%d içûName:%s\n", 
Œª§ùiÚ_id
, 
içû_Çme
);

2279 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

2280 
ex™
:

2281 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_DP_INTERFACE_DELETE
, 0, 
NULL
, 
Œª§ùiÚ_id
, NULL);

2282  
»t
;

2283 
	}
}

2285 
	$¦si_Çn_ndp_š™Ÿ‹_g‘_Æ_·¿ms
(
¦si_dev
 *
sdev
, 
¦si_h®_Çn_d©a_·th_š™ŸtÜ_»q
 *
h®_»q
,

2286 cÚ¡ *
d©a
, 
Ën
)

2288 
ty³
, 
tmp
, 
r
;

2289 cÚ¡ 
Æ©Œ
 *
™”
;

2291 
	`mem£t
(
h®_»q
, 0, (*hal_req));

2292 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

2293 
ty³
 = 
	`Æa_ty³
(
™”
);

2294 
ty³
) {

2295 
NAN_REQ_ATTR_REQ_INSTANCE_ID
:

2296 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
»que¡Ü_š¡ªû_id
))

2297  -
EINVAL
;

2300 
NAN_REQ_ATTR_CHAN_REQ_TYPE
:

2301 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
chªÃl_»que¡_ty³
))

2302  -
EINVAL
;

2305 
NAN_REQ_ATTR_CHAN
:

2306 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
chªÃl
))

2307  -
EINVAL
;

2310 
NAN_REQ_ATTR_MAC_ADDR_VAL
:

2311 ià(
	`Æa_Ën
(
™”
è< 
ETH_ALEN
)

2312  -
EINVAL
;

2313 
	`‘h”_addr_cİy
(
h®_»q
->
³”_disc_mac_addr
, 
	`Æa_d©a
(
™”
));

2316 
NAN_REQ_ATTR_DATA_INTERFACE_NAME
:

2317 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
IFNAMSIZ
, 
h®_»q
->
ndp_içû
))

2318  -
EINVAL
;

2321 
NAN_REQ_ATTR_DATA_INTERFACE_NAME_LEN
:

2324 
NAN_REQ_ATTR_SDEA_PARAM_SECURITY_CFG
:

2325 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
ndp_cfg
.
£cur™y_cfg
))

2326  -
EINVAL
;

2329 
NAN_REQ_ATTR_SDEA_PARAM_QOS_CFG
:

2330 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
ndp_cfg
.
qos_cfg
))

2331  -
EINVAL
;

2334 
NAN_REQ_ATTR_APP_INFO_LEN
:

2335 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
))

2336  -
EINVAL
;

2339 
NAN_REQ_ATTR_APP_INFO
:

2340 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
, h®_»q->­p_šfo.
ndp_­p_šfo
))

2341  -
EINVAL
;

2344 
NAN_REQ_ATTR_SERVICE_NAME_LEN
:

2345 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
£rviû_Çme_Ën
))

2346  -
EINVAL
;

2349 
NAN_REQ_ATTR_SERVICE_NAME
:

2350 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
£rviû_Çme_Ën
, h®_»q->
£rviû_Çme
))

2351  -
EINVAL
;

2354 
NAN_REQ_ATTR_HAL_TRANSACTION_ID
:

2355 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
Œª§ùiÚ_id
))

2356  -
EINVAL
;

2360 
r
 = 
	`¦si_Çn_g‘_£cur™y_šfo_Æ
(
sdev
, &
h®_»q
->
key_šfo
, 
™”
, 
ty³
);

2361 ià(
r
)

2362 
	`SLSI_ERR
(
sdev
, "UÃx³ùed NAN‚d°©Œibu‹ TYPE:%d\n", 
ty³
);

2365  
SLSI_HAL_NAN_STATUS_SUCCESS
;

2366 
	}
}

2368 
	$¦si_Çn_ndp_š™Ÿ‹
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2370 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2371 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

2372 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

2373 
¦si_h®_Çn_d©a_·th_š™ŸtÜ_»q
 *
h®_»q
 = 
NULL
;

2374 
»t
;

2375 
u32
 
ndp_š¡ªû_id
 = 0;

2376 
u16
 
ndl_vif_id
, 
Œª§ùiÚ_id
 = 0;

2377 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

2379 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

2380 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

2381 
ex™
;

2383 
h®_»q
 = 
	`km®loc
((*h®_»q), 
GFP_KERNEL
);

2384 ià(!
h®_»q
) {

2385 
	`SLSI_ERR
(
sdev
, "Failedo‡lloc hal_req structure!!!\n");

2386 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NO_RESOURCE_AVAILABLE
;

2387 
»t
 = 
WIFI_HAL_ERROR_OUT_OF_MEMORY
;

2388 
ex™
;

2391 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2392 
»¶y_¡©us
 = 
	`¦si_Çn_ndp_š™Ÿ‹_g‘_Æ_·¿ms
(
sdev
, 
h®_»q
, 
d©a
, 
Ën
);

2393 
Œª§ùiÚ_id
 = 
h®_»q
->transaction_id;

2394 ià(
»¶y_¡©us
) {

2395 
»t
 = 
WIFI_HAL_ERROR_INVALID_ARGS
;

2396 
ex™
;

2399 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2400 ià(!
ndev_vif
->
aùiv©ed
) {

2401 
	`SLSI_WARN
(
sdev
, "NAN vif‚ot‡ctivated\n");

2402 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NAN_NOT_ALLOWED
;

2403 
»t
 = 
WIFI_HAL_ERROR_NOT_AVAILABLE
;

2404 
ex™_w™h_lock
;

2407 
ndp_š¡ªû_id
 = 
	`¦si_Çn_g‘_Ãw_ndp_š¡ªû_id
(
ndev_vif
);

2409 ià(!
ndp_š¡ªû_id
) {

2410 
	`SLSI_WARN
(
sdev
, "NAN‚o free‚dp slots\n");

2411 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NO_RESOURCE_AVAILABLE
;

2412 
»t
 = 
WIFI_HAL_ERROR_TOO_MANY_REQUESTS
;

2413 
ex™_w™h_lock
;

2416 
ndev_vif
->
Çn
.
Ãxt_ndp_š¡ªû_id
 = (
ndp_š¡ªû_id
 + 1è% (
SLSI_NAN_MAX_NDP_INSTANCES
 + 1);

2417 
ndl_vif_id
 = 
	`¦si_Çn_ndp_g‘_ndl_vif_id
(
h®_»q
->
³”_disc_mac_addr
, 
ndev_vif
->
Çn
.
ndl_li¡
);

2418 ià(
ndl_vif_id
 >ğ
SLSI_NAN_MAX_NDP_INSTANCES
 + 
SLSI_NAN_DATA_IFINDEX_START
) {

2419 
	`SLSI_WARN
(
sdev
, "NAN‚o free‚dl slots\n");

2420 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NO_RESOURCE_AVAILABLE
;

2421 
»t
 = 
WIFI_HAL_ERROR_TOO_MANY_REQUESTS
;

2422 
ex™_w™h_lock
;

2424 
»t
 = 
	`¦si_mlme_ndp_»que¡
(
sdev
, 
dev
, 
h®_»q
, 
ndp_š¡ªû_id
, 
ndl_vif_id
);

2425 ià(
»t
) {

2426 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

2427 
»t
 = 
WIFI_HAL_ERROR_UNKNOWN
;

2429 
	`SLSI_INFO
(
sdev
, "TId:%d‚dp_ins_id:%d‚dlVif:%d iface:%s\n",

2430 
h®_»q
->
Œª§ùiÚ_id
, 
ndp_š¡ªû_id
, 
ndl_vif_id
, h®_»q->
ndp_içû
);

2431 
ndev_vif
->
Çn
.
ndp_¡¬t_time
 = 
jiff›s
;

2432 
»t
 = 
WIFI_HAL_SUCCESS
;

2435 
ex™_w™h_lock
:

2436 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2437 
ex™
:

2438 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_DP_INITIATOR_RESPONSE
, (
u16
)
ndp_š¡ªû_id
, 
NULL
, 
Œª§ùiÚ_id
, 
ndev_vif
);

2439 
	`kä“
(
h®_»q
);

2440  
»t
;

2441 
	}
}

2443 
	$¦si_Çn_ndp_»¥Úd_g‘_Æ_·¿m
(
¦si_dev
 *
sdev
, 
¦si_h®_Çn_d©a_·th_šdiÿtiÚ_»¥Ú£
 *
h®_»q
,

2444 cÚ¡ *
d©a
, 
Ën
)

2446 
ty³
, 
tmp
, 
r
;

2447 cÚ¡ 
Æ©Œ
 *
™”
;

2448 
u8
 
v®
 = 0;

2449 
u32
 
v®ue
 = 0;

2451 
	`mem£t
(
h®_»q
, 0, (*hal_req));

2452 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

2453 
ty³
 = 
	`Æa_ty³
(
™”
);

2454 
ty³
) {

2455 
NAN_REQ_ATTR_NDP_INSTANCE_ID
:

2456 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
h®_»q
->
ndp_š¡ªû_id
))

2457  -
EINVAL
;

2460 
NAN_REQ_ATTR_DATA_INTERFACE_NAME
:

2461 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
IFNAMSIZ
, 
h®_»q
->
ndp_içû
))

2462  -
EINVAL
;

2464 
NAN_REQ_ATTR_DATA_INTERFACE_NAME_LEN
:

2467 
NAN_REQ_ATTR_SDEA_PARAM_SECURITY_CFG
:

2468 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
ndp_cfg
.
£cur™y_cfg
))

2469  -
EINVAL
;

2472 
NAN_REQ_ATTR_SDEA_PARAM_QOS_CFG
:

2473 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
h®_»q
->
ndp_cfg
.
qos_cfg
))

2474  -
EINVAL
;

2477 
NAN_REQ_ATTR_APP_INFO_LEN
:

2478 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
))

2479  -
EINVAL
;

2482 
NAN_REQ_ATTR_APP_INFO
:

2483 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
­p_šfo
.
ndp_­p_šfo_Ën
, h®_»q->­p_šfo.
ndp_­p_šfo
))

2484  -
EINVAL
;

2487 
NAN_REQ_ATTR_NDP_RESPONSE_CODE
:

2488 ià(
	`¦si_ut_Æa_g‘_u8
(
™”
, &
v®
))

2489  -
EINVAL
;

2490 
h®_»q
->
r¥_code
 = (
u32
)
v®
;

2493 
NAN_REQ_ATTR_SERVICE_NAME_LEN
:

2494 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
v®ue
))

2495  -
EINVAL
;

2496 
h®_»q
->
£rviû_Çme_Ën
 = (
u8
)
v®ue
;

2499 
NAN_REQ_ATTR_SERVICE_NAME
:

2500 ià(
	`¦si_ut_Æa_g‘_d©a
(
™”
, 
h®_»q
->
£rviû_Çme_Ën
, h®_»q->
£rviû_Çme
))

2501  -
EINVAL
;

2504 
NAN_REQ_ATTR_HAL_TRANSACTION_ID
:

2505 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
Œª§ùiÚ_id
))

2506  -
EINVAL
;

2510 
r
 = 0;

2511 
r
 = 
	`¦si_Çn_g‘_£cur™y_šfo_Æ
(
sdev
, &
h®_»q
->
key_šfo
, 
™”
, 
ty³
);

2512 ià(
r
)

2513 
	`SLSI_ERR
(
sdev
, "UÃx³ùed NAN‚d°©Œibu‹ TYPE:%d\n", 
ty³
);

2516  
SLSI_HAL_NAN_STATUS_SUCCESS
;

2517 
	}
}

2519 
	$¦si_Çn_ndp_»¥Úd
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2521 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2522 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

2523 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

2524 
¦si_h®_Çn_d©a_·th_šdiÿtiÚ_»¥Ú£
 *
h®_»q
 = 
NULL
;

2525 
»t
;

2526 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

2527 
u16
 
Œª§ùiÚ_id
 = 0, 
ndp_š¡ªû_id
 = 0, 
loÿl_ndp_š¡ªû_id
;

2529 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

2530 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

2531 
ex™
;

2533 
h®_»q
 = 
	`km®loc
((*h®_»q), 
GFP_KERNEL
);

2534 ià(!
h®_»q
) {

2535 
	`SLSI_ERR
(
sdev
, "Failedo‡lloc hal_req structure!!!\n");

2536 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NO_RESOURCE_AVAILABLE
;

2537 
»t
 = 
WIFI_HAL_ERROR_OUT_OF_MEMORY
;

2538 
ex™
;

2541 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2542 
»¶y_¡©us
 = 
	`¦si_Çn_ndp_»¥Úd_g‘_Æ_·¿m
(
sdev
, 
h®_»q
, 
d©a
, 
Ën
);

2543 
Œª§ùiÚ_id
 = 
h®_»q
->transaction_id;

2544 
ndp_š¡ªû_id
 = 
h®_»q
->ndp_instance_id;

2545 ià(
»¶y_¡©us
) {

2546 
»t
 = 
WIFI_HAL_ERROR_INVALID_ARGS
;

2547 
ex™
;

2550 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2551 ià(!
ndev_vif
->
aùiv©ed
) {

2552 
	`SLSI_WARN
(
sdev
, "NAN vif‚ot‡ctivated\n");

2553 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_NAN_NOT_ALLOWED
;

2554 
»t
 = 
WIFI_HAL_ERROR_NOT_AVAILABLE
;

2555 
ex™_w™h_lock
;

2558 ià(
h®_»q
->
ndp_š¡ªû_id
 > 0 && h®_»q->ndp_š¡ªû_id <ğ
SLSI_NAN_MAX_NDP_INSTANCES
) {

2559 
loÿl_ndp_š¡ªû_id
 = 
ndev_vif
->
Çn
.
ndp_loÿl_ndp_š¡ªû_id
[
h®_»q
->
ndp_š¡ªû_id
 - 1];

2561 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

2562 
»t
 = 
WIFI_HAL_ERROR_UNKNOWN
;

2563 
ex™_w™h_lock
;

2565 
»t
 = 
	`¦si_mlme_ndp_»¥Ú£
(
sdev
, 
dev
, 
h®_»q
, 
loÿl_ndp_š¡ªû_id
);

2566 ià(
»t
) {

2567 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

2568 
»t
 = 
WIFI_HAL_ERROR_UNKNOWN
;

2570 
	`SLSI_INFO
(
sdev
, "transId:%d‚dpId:%d iface:%s\n",

2571 
h®_»q
->
Œª§ùiÚ_id
, h®_»q->
ndp_š¡ªû_id
, h®_»q->
ndp_içû
);

2572 
»t
 = 
WIFI_HAL_SUCCESS
;

2575 
ex™_w™h_lock
:

2576 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2577 
ex™
:

2578 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_DP_RESPONDER_RESPONSE
,

2579 
ndp_š¡ªû_id
, 
NULL
, 
Œª§ùiÚ_id
, 
ndev_vif
);

2580 
	`kä“
(
h®_»q
);

2581  
»t
;

2582 
	}
}

2584 
	$¦si_Çn_ndp_’d_g‘_Æ_·¿ms
(
¦si_dev
 *
sdev
, 
¦si_h®_Çn_d©a_’d
 *
h®_»q
,

2585 cÚ¡ *
d©a
, 
Ën
)

2587 
ty³
, 
tmp
;

2588 cÚ¡ 
Æ©Œ
 *
™”
;

2589 
u32
 
v®
 = 0;

2591 
	`mem£t
(
h®_»q
, 0, (*hal_req));

2592 
	`Æa_fÜ_—ch_©Œ
(
™”
, 
d©a
, 
Ën
, 
tmp
) {

2593 
ty³
 = 
	`Æa_ty³
(
™”
);

2594 ià(
ty³
 =ğ
NAN_REQ_ATTR_NDP_INSTANCE_ID
 && 
h®_»q
->
num_ndp_š¡ªûs
 < 
SLSI_NAN_MAX_NDP_INSTANCES
) {

2595 ià(
	`¦si_ut_Æa_g‘_u32
(
™”
, &
v®
))

2596  -
EINVAL
;

2597 
h®_»q
->
ndp_š¡ªû_id
[h®_»q->
num_ndp_š¡ªûs
++] = 
v®
;

2598 } ià(
ty³
 =ğ
NAN_REQ_ATTR_HAL_TRANSACTION_ID
) {

2599 ià(
	`¦si_ut_Æa_g‘_u16
(
™”
, &
h®_»q
->
Œª§ùiÚ_id
))

2600  -
EINVAL
;

2603  
SLSI_HAL_NAN_STATUS_SUCCESS
;

2604 
	}
}

2606 
	$¦si_Çn_ndp_’d
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
)

2608 
¦si_dev
 *
sdev
 = 
	`SDEV_FROM_WIPHY
(
why
);

2609 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

2610 
Ãtdev_vif
 *
ndev_vif
 = 
NULL
;

2611 
¦si_h®_Çn_d©a_’d
 
h®_»q
;

2612 
»t
, 
i
;

2613 
u32
 
»¶y_¡©us
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

2615 
h®_»q
.
Œª§ùiÚ_id
 = 0;

2616 
	`¦si_Çn_´e_check
(
sdev
, 
dev
, &
»t
, &
»¶y_¡©us
);

2617 ià(
»t
 !ğ
WIFI_HAL_SUCCESS
)

2618 
ex™
;

2620 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2621 
»¶y_¡©us
 = 
	`¦si_Çn_ndp_’d_g‘_Æ_·¿ms
(
sdev
, &
h®_»q
, 
d©a
, 
Ën
);

2623 ià(
»¶y_¡©us
) {

2624 
»t
 = 
WIFI_HAL_ERROR_INVALID_ARGS
;

2625 
ex™
;

2628 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2629 ià(!
ndev_vif
->
aùiv©ed
) {

2630 
	`SLSI_WARN
(
sdev
, "NAN vif‚ot‡ctivated\n");

2631 
	`¦si_Çn_ndp_‹rmš©iÚ_hªdËr
(
sdev
, 
dev
, 0, 
NULL
);

2632 
»t
 = 
WIFI_HAL_SUCCESS
;

2633 
ex™_w™h_lock
;

2635 
i
 = 0; i < 
h®_»q
.
num_ndp_š¡ªûs
; i++)

2636 ià(
h®_»q
.
ndp_š¡ªû_id
[
i
] > 0 && h®_»q.ndp_š¡ªû_id[i] <ğ
SLSI_NAN_MAX_NDP_INSTANCES
) {

2637 
»t
 = 
	`¦si_mlme_ndp_‹rmš©e
(
sdev
, 
dev
, 
h®_»q
.
ndp_š¡ªû_id
[
i
], h®_»q.
Œª§ùiÚ_id
);

2638 
	`SLSI_INFO
(
sdev
,

2640 
h®_»q
.
Œª§ùiÚ_id
, h®_»q.
ndp_š¡ªû_id
[
i
], i + 1, h®_»q.
num_ndp_š¡ªûs
, 
»t
);

2641 ià(!
»t
)

2642 
ndev_vif
->
Çn
.
ndp_¡©e
[
h®_»q
.
ndp_š¡ªû_id
[
i
] - 1] = 
ndp_¦Ù_¡©us_‹rmš©šg
;

2644 
	`SLSI_ERR
(
sdev
, "IgnÜšv®id‚dp_š¡ªû_id:%d\n", 
h®_»q
.
ndp_š¡ªû_id
[
i
]);

2647 
ex™_w™h_lock
:

2648 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2649 
ex™
:

2650 
	`¦si_v’dÜ_Çn_commªd_»¶y
(
why
, 
»¶y_¡©us
, 
»t
, 
NAN_DP_END
, 0, 
NULL
, 
h®_»q
.
Œª§ùiÚ_id
, 
ndev_vif
);

2651  
»t
;

2652 
	}
}

2656 
	$¦si_Çn_ev’t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2658 
sk_buff
 *
Æ_skb
 = 
NULL
;

2659 
»s
 = 0;

2660 
u16
 
ev’t
, 
id’tif›r
, 
evt_»asÚ
, 
fŞlowup_Œªs_id
, 
m©ch_id
;

2661 
u8
 *
mac_addr
;

2662 
u16
 
h®_ev’t
, 
»asÚ_code
;

2663 
Ãtdev_vif
 *
ndev_vif
;

2664 
¦si_Çn_disc_ev’t_ty³
 
disc_ev’t_ty³
 = 0;

2666 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2667 
ev’t
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_Çn_ev’t_šd
.event);

2668 
id’tif›r
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_Çn_ev’t_šd
.identifier);

2669 
mac_addr
 = 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_Çn_ev’t_šd
.
add»ss_Ü_id’tif›r
);

2670 
»asÚ_code
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_Çn_ev’t_šd
.reason_code);

2672 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2674 
	`SLSI_INFO
(
sdev
, "Id’tif›r:%d, mac_addr:%pM,„—sÚ_code:%d\n", 
id’tif›r
, 
mac_addr
, 
»asÚ_code
);

2675 
»asÚ_code
) {

2676 
FAPI_REASONCODE_NAN_SERVICE_TERMINATED_TIMEOUT
:

2677 
FAPI_REASONCODE_NAN_SERVICE_TERMINATED_COUNT_REACHED
:

2678 
FAPI_REASONCODE_NAN_SERVICE_TERMINATED_DISCOVERY_SHUTDOWN
:

2679 
FAPI_REASONCODE_NAN_SERVICE_TERMINATED_USER_REQUEST
:

2680 
FAPI_REASONCODE_NAN_TRANSMIT_FOLLOWUP_SUCCESS
:

2681 
evt_»asÚ
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

2683 
FAPI_REASONCODE_NAN_TRANSMIT_FOLLOWUP_FAILURE
:

2684 
evt_»asÚ
 = 
SLSI_HAL_NAN_STATUS_PROTOCOL_FAILURE
;

2687 
evt_»asÚ
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

2691 
ev’t
) {

2692 
FAPI_EVENT_WIFI_EVENT_NAN_PUBLISH_TERMINATED
:

2693 
FAPI_EVENT_WIFI_EVENT_NAN_SUBSCRIBE_TERMINATED
:

2694 ià(
id’tif›r
 > 
SLSI_NAN_MAX_SERVICE_ID
) {

2695 
	`SLSI_WARN
(
sdev
, "£rviûId(%dè> max(%d)\n", 
id’tif›r
, 
SLSI_NAN_MAX_SERVICE_ID
);

2696 
ex™
;

2698 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "map:%d sdf_flags:0x%x\n",

2699 
ndev_vif
->
Çn
.
£rviû_id_m­
,‚dev_vif->Çn.
Çn_sdf_æags
[
id’tif›r
]);

2700 ià(!(
ndev_vif
->
Çn
.
£rviû_id_m­
 & 
	`BIT
(
id’tif›r
)))

2701 
ex™
;

2702 
ndev_vif
->
Çn
.
£rviû_id_m­
 &ğ(
u32
)~
	`BIT
(
id’tif›r
);

2703 ià(
ev’t
 =ğ
FAPI_EVENT_WIFI_EVENT_NAN_PUBLISH_TERMINATED
) {

2704 ià(
ndev_vif
->
Çn
.
Çn_sdf_æags
[
id’tif›r
] & 
FAPI_NANSDFCONTROL_PUBLISH_END_EVENT
) {

2705 
ndev_vif
->
Çn
.
Çn_sdf_æags
[
id’tif›r
] = 0;

2706 
ex™
;

2709 ià(
ndev_vif
->
Çn
.
Çn_sdf_æags
[
id’tif›r
] & 
FAPI_NANSDFCONTROL_SUBSCRIBE_END_EVENT
) {

2710 
ndev_vif
->
Çn
.
Çn_sdf_æags
[
id’tif›r
] = 0;

2711 
ex™
;

2714 
ndev_vif
->
Çn
.
Çn_sdf_æags
[
id’tif›r
] = 0;

2715 
h®_ev’t
 = 
ev’t
 =ğ
FAPI_EVENT_WIFI_EVENT_NAN_PUBLISH_TERMINATED
 ?

2716 
SLSI_NL80211_NAN_PUBLISH_TERMINATED_EVENT
 : 
SLSI_NL80211_NAN_SUBSCRIBE_TERMINATED_EVENT
;

2718 
FAPI_EVENT_WIFI_EVENT_NAN_MATCH_EXPIRED
:

2719 ià(
ndev_vif
->
Çn
.
Çn_sdf_æags
[
id’tif›r
] & 
FAPI_NANSDFCONTROL_MATCH_EXPIRED_EVENT
)

2720 
ex™
;

2721 
h®_ev’t
 = 
SLSI_NL80211_NAN_MATCH_EXPIRED_EVENT
;

2723 
FAPI_EVENT_WIFI_EVENT_NAN_ADDRESS_CHANGED
:

2724 
disc_ev’t_ty³
 = 
NAN_EVENT_ID_DISC_MAC_ADDR
;

2725 
h®_ev’t
 = 
SLSI_NL80211_NAN_DISCOVERY_ENGINE_EVENT
;

2726 
	`‘h”_addr_cİy
(
ndev_vif
->
Çn
.
loÿl_nmi
, 
mac_addr
);

2728 
FAPI_EVENT_WIFI_EVENT_NAN_CLUSTER_STARTED
:

2729 
disc_ev’t_ty³
 = 
NAN_EVENT_ID_STARTED_CLUSTER
;

2730 
h®_ev’t
 = 
SLSI_NL80211_NAN_DISCOVERY_ENGINE_EVENT
;

2731 
	`‘h”_addr_cİy
(
ndev_vif
->
Çn
.
şu¡”_id
, 
mac_addr
);

2733 
FAPI_EVENT_WIFI_EVENT_NAN_CLUSTER_JOINED
:

2734 
disc_ev’t_ty³
 = 
NAN_EVENT_ID_JOINED_CLUSTER
;

2735 
h®_ev’t
 = 
SLSI_NL80211_NAN_DISCOVERY_ENGINE_EVENT
;

2736 
	`‘h”_addr_cİy
(
ndev_vif
->
Çn
.
şu¡”_id
, 
mac_addr
);

2738 
FAPI_EVENT_WIFI_EVENT_NAN_TRANSMIT_FOLLOWUP
:

2739 
m©ch_id
 = 
mac_addr
[0] | (mac_addr[1] << 8);

2740 
fŞlowup_Œªs_id
 = 
	`¦si_Çn_g‘_fŞlowup_Œªs_id
(
ndev_vif
, 
m©ch_id
);

2741 
	`¦si_Çn_pİ_fŞlowup_ids
(
sdev
, 
dev
, 
m©ch_id
);

2742 ià(
ndev_vif
->
Çn
.
Çn_sdf_æags
[
m©ch_id
] & 
FAPI_NANSDFCONTROL_FOLLOWUP_TRANSMIT_STATUS
)

2743 
ex™
;

2744 
h®_ev’t
 = 
SLSI_NL80211_NAN_TRANSMIT_FOLLOWUP_STATUS
;

2745 
	`SLSI_INFO
(
sdev
, "m©ch_id:%d, fŞlowup_Œªs_id:%d\n", 
m©ch_id
, 
fŞlowup_Œªs_id
);

2748 
ex™
;

2751 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


2752 
	`SLSI_INFO
(
sdev
, "Event: %s(%d)\n",

2753 
	`¦si_´št_ev’t_Çme
(
h®_ev’t
), hal_event);

2756 #ià(
	`KERNEL_VERSION
(4, 1, 0è<ğ
LINUX_VERSION_CODE
)

2757 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
, 
h®_ev’t
, 
GFP_KERNEL
);

2759 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
, 
h®_ev’t
, 
GFP_KERNEL
);

2761 ià(!
Æ_skb
) {

2762 
	`SLSI_ERR
(
sdev
, "NO MEM for‚l_skb!!!\n");

2763 
ex™
;

2766 
»s
 |ğ
	`Æa_put_be16
(
Æ_skb
, 
NAN_EVT_ATTR_STATUS
, 
evt_»asÚ
);

2767 
h®_ev’t
) {

2768 
SLSI_NL80211_NAN_PUBLISH_TERMINATED_EVENT
:

2769 
»s
 |ğ
	`Æa_put_be16
(
Æ_skb
, 
NAN_EVT_ATTR_PUBLISH_ID
, 
id’tif›r
);

2771 
SLSI_NL80211_NAN_MATCH_EXPIRED_EVENT
:

2772 
»s
 |ğ
	`Æa_put_be16
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_PUBLISH_SUBSCRIBE_ID
, 
id’tif›r
);

2774 
SLSI_NL80211_NAN_SUBSCRIBE_TERMINATED_EVENT
:

2775 
»s
 |ğ
	`Æa_put_be16
(
Æ_skb
, 
NAN_EVT_ATTR_SUBSCRIBE_ID
, 
id’tif›r
);

2777 
SLSI_NL80211_NAN_DISCOVERY_ENGINE_EVENT
:

2778 
»s
 |ğ
	`Æa_put_be16
(
Æ_skb
, 
NAN_EVT_ATTR_DISCOVERY_ENGINE_EVT_TYPE
, 
disc_ev’t_ty³
);

2779 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_DISCOVERY_ENGINE_MAC_ADDR
, 
ETH_ALEN
, 
mac_addr
);

2781 
SLSI_NL80211_NAN_TRANSMIT_FOLLOWUP_STATUS
:

2782 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
NAN_EVT_ATTR_HAL_TRANSACTION_ID
, 
fŞlowup_Œªs_id
);

2786 ià(
»s
) {

2787 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»s
);

2789 
	`kä“_skb
(
Æ_skb
);

2790 
ex™
;

2793 
	`cfg80211_v’dÜ_ev’t
(
Æ_skb
, 
GFP_KERNEL
);

2795 
ex™
:

2796 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2797 
	`kä“_skb
(
skb
);

2798 
	}
}

2800 
	$¦si_Çn_£nd_di§bËd_ev’t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
»asÚ
)

2802 
sk_buff
 *
Æ_skb
 = 
NULL
;

2803 
»s
 = 0;

2804 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2806 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2807 #ià(
	`KERNEL_VERSION
(4, 1, 0è<ğ
LINUX_VERSION_CODE
)

2808 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NL80211_NAN_DISABLED_EVENT
,

2809 
GFP_KERNEL
);

2811 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NL80211_NAN_DISABLED_EVENT
,

2812 
GFP_KERNEL
);

2814 ià(!
Æ_skb
) {

2815 
	`SLSI_ERR
(
sdev
, "NO MEM for‚l_skb!!!\n");

2818 
»s
 = 
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_DISABLED_REASON
, 
»asÚ
);

2819 ià(
»s
) {

2820 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»s
);

2821 
	`kä“_skb
(
Æ_skb
);

2824 
	`cfg80211_v’dÜ_ev’t
(
Æ_skb
, 
GFP_KERNEL
);

2825 
	}
}

2827 
	$¦si_Çn_fŞlowup_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2829 
u16
 
g_id
, 
g_Ën
;

2830 
u8
 *
±r
;

2831 
¦si_h®_Çn_fŞlowup_šd
 *
h®_evt
;

2832 
sk_buff
 *
Æ_skb
;

2833 
»s
;

2834 
sig_d©a_Ën
;

2835 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2836 *
šfo_¡ršg
 = 
NULL
;

2838 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

2840 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2841 
sig_d©a_Ën
 = 
	`çpi_g‘_d©®’
(
skb
);

2843 
h®_evt
 = 
	`km®loc
((*h®_evt), 
GFP_KERNEL
);

2844 ià(!
h®_evt
) {

2845 
	`SLSI_ERR
(
sdev
, "No memory for followup_ind\n");

2846 
ex™
;

2848 
	`mem£t
(
h®_evt
, 0, (*hal_evt));

2850 
h®_evt
->
publish_subsüibe_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_Çn_fŞlowup_šd
.
£ssiÚ_id
);

2851 
h®_evt
->
»que¡Ü_š¡ªû_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_Çn_fŞlowup_šd
.
m©ch_id
);

2852 
	`‘h”_addr_cİy
(
h®_evt
->
addr
,

2853 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_Çn_fŞlowup_šd
.
³”_Çn_mªagem’t_š‹rçû_add»ss
));

2855 
	`SLSI_INFO
(
sdev
, "pub_sub_id:%d,„eq_š¡ªû_id:%d,…“r_addr:%pM\n", 
h®_evt
->
publish_subsüibe_id
,

2856 
h®_evt
->
»que¡Ü_š¡ªû_id
, h®_evt->
addr
);

2857 
±r
 = 
	`çpi_g‘_d©a
(
skb
);

2858 ià(
±r
) {

2859 
g_id
 = 
	`Ë16_to_ıu
(*(
u16
 *)
±r
);

2860 
g_Ën
 = 
	`Ë16_to_ıu
(*(
u16
 *)(
±r
 + 2));

2862 
sig_d©a_Ën
 >ğ
g_Ën
 + 4) {

2863 ià(
g_id
 =ğ
SLSI_NAN_TLV_TAG_SERVICE_SPECIFIC_INFO
) {

2864 
h®_evt
->
£rviû_¥ecific_šfo_Ën
 = 
g_Ën
 > 
SLSI_HAL_NAN_MAX_SERVICE_SPECIFIC_INFO_LEN
 ?

2865 
SLSI_HAL_NAN_MAX_SERVICE_SPECIFIC_INFO_LEN
 : 
g_Ën
;

2866 
	`memıy
(
h®_evt
->
£rviû_¥ecific_šfo
, 
±r
 + 4, h®_evt->
£rviû_¥ecific_šfo_Ën
);

2867 
šfo_¡ršg
 = 
	`¦si_Çn_cÚv”t_by‹_to_¡ršg
(
h®_evt
->
£rviû_¥ecific_šfo_Ën
,

2868 
h®_evt
->
£rviû_¥ecific_šfo
);

2869 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "service_specific_info_len:%d, service_specific_info:%s\n",

2870 
h®_evt
->
£rviû_¥ecific_šfo_Ën
, 
šfo_¡ršg
);

2871 } ià(
g_id
 =ğ
SLSI_NAN_TLV_TAG_EXT_SERVICE_SPECIFIC_INFO
) {

2872 ià(
g_Ën
 > 
SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
)

2873 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
 = 
SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
;

2875 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
 = 
g_Ën
;

2876 
	`memıy
(
h®_evt
->
sd—_£rviû_¥ecific_šfo
, 
±r
 + 4,

2877 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
);

2878 
šfo_¡ršg
 = 
	`¦si_Çn_cÚv”t_by‹_to_¡ršg
(
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
,

2879 
h®_evt
->
sd—_£rviû_¥ecific_šfo
);

2880 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
,

2882 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
, 
šfo_¡ršg
);

2884 
	`SLSI_WARN
(
sdev
, "Sk…roûssšg TLV %d\n", 
g_id
);

2886 
sig_d©a_Ën
 -ğ
g_Ën
 + 4;

2887 
±r
 +ğ
g_Ën
 + 4;

2888 ià(
sig_d©a_Ën
 > 4) {

2889 
g_id
 = 
	`Ë16_to_ıu
(*(
u16
 *)
±r
);

2890 
g_Ën
 = 
	`Ë16_to_ıu
(*(
u16
 *)(
±r
 + 2));

2892 
g_id
 = 0;

2893 
g_Ën
 = 0;

2898 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


2899 
	`SLSI_INFO
(
sdev
, "Event: %s(%d)\n",

2900 
	`¦si_´št_ev’t_Çme
(
SLSI_NL80211_NAN_FOLLOWUP_EVENT
), SLSI_NL80211_NAN_FOLLOWUP_EVENT);

2902 #ià(
	`KERNEL_VERSION
(4, 1, 0è<ğ
LINUX_VERSION_CODE
)

2903 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NL80211_NAN_FOLLOWUP_EVENT
,

2904 
GFP_KERNEL
);

2906 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NL80211_NAN_FOLLOWUP_EVENT
,

2907 
GFP_KERNEL
);

2910 ià(!
Æ_skb
) {

2911 
	`SLSI_ERR
(
sdev
, "NO MEM for‚l_skb!!!\n");

2912 
	`kä“
(
h®_evt
);

2913 
ex™
;

2916 
»s
 = 
	`Æa_put_be16
(
Æ_skb
, 
NAN_EVT_ATTR_FOLLOWUP_PUBLISH_SUBSCRIBE_ID
,

2917 
	`ıu_to_Ë16
(
h®_evt
->
publish_subsüibe_id
));

2918 
»s
 |ğ
	`Æa_put_be16
(
Æ_skb
, 
NAN_EVT_ATTR_FOLLOWUP_REQUESTOR_INSTANCE_ID
,

2919 
	`ıu_to_Ë16
(
h®_evt
->
»que¡Ü_š¡ªû_id
));

2920 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_FOLLOWUP_ADDR
, 
ETH_ALEN
, 
h®_evt
->
addr
);

2921 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
NAN_EVT_ATTR_FOLLOWUP_DW_OR_FAW
, 
h®_evt
->
dw_Ü_çw
);

2922 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
NAN_EVT_ATTR_FOLLOWUP_SERVICE_SPECIFIC_INFO_LEN
, 
h®_evt
->
£rviû_¥ecific_šfo_Ën
);

2923 ià(
h®_evt
->
£rviû_¥ecific_šfo_Ën
)

2924 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_FOLLOWUP_SERVICE_SPECIFIC_INFO
, 
h®_evt
->
£rviû_¥ecific_šfo_Ën
,

2925 
h®_evt
->
£rviû_¥ecific_šfo
);

2926 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
NAN_EVT_ATTR_SDEA_LEN
, 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
);

2927 ià(
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
)

2928 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_SDEA
, 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
,

2929 
h®_evt
->
sd—_£rviû_¥ecific_šfo
);

2931 ià(
»s
) {

2932 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»s
);

2933 
	`kä“
(
h®_evt
);

2935 
	`kä“_skb
(
Æ_skb
);

2936 
ex™
;

2939 
	`cfg80211_v’dÜ_ev’t
(
Æ_skb
, 
GFP_KERNEL
);

2940 
	`kä“
(
h®_evt
);

2941 
ex™
:

2942 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2943 
	`kä“_skb
(
skb
);

2944 
	}
}

2946 
	$¦si_Çn_£rviû_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2948 
u16
 
g_id
, 
g_Ën
;

2949 
u8
 *
±r
;

2950 cÚ¡ 
u8
 *
g_d©a_±r
;

2951 
sig_d©a_Ën
;

2952 
¦si_h®_Çn_m©ch_šd
 *
h®_evt
;

2953 
sk_buff
 *
Æ_skb
;

2954 
»s
;

2955 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2956 *
šfo_¡ršg
 = 
NULL
;

2958 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

2959 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2960 
sig_d©a_Ën
 = 
	`çpi_g‘_d©®’
(
skb
);

2961 ià(
sig_d©a_Ën
 <= 4) {

2962 
	`SLSI_ERR
(
sdev
, "Inv®id d©¨Ën(%d)\n", 
sig_d©a_Ën
);

2963 
ex™
;

2966 
h®_evt
 = 
	`km®loc
((*h®_evt), 
GFP_KERNEL
);

2967 ià(!
h®_evt
) {

2968 
	`SLSI_ERR
(
sdev
, "No memory for service_ind\n");

2969 
ex™
;

2972 
	`mem£t
(
h®_evt
, 0, (*hal_evt));

2973 
h®_evt
->
publish_subsüibe_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_Çn_£rviû_šd
.
£ssiÚ_id
);

2974 
h®_evt
->
»que¡Ü_š¡ªû_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_Çn_£rviû_šd
.
m©ch_id
);

2976 
	`SLSI_INFO
(
sdev
, "pub_sub_id:%d,„eq_instance_id:%d,„anging_event:%d,„ange_measurement_mm:%d\n",

2977 
h®_evt
->
publish_subsüibe_id
, h®_evt->
»que¡Ü_š¡ªû_id
, h®_evt->
¿ngšg_ev’t_ty³
,

2978 
h®_evt
->
¿nge_m—su»m’t_mm
);

2979 
±r
 = 
	`çpi_g‘_d©a
(
skb
);

2980 
g_id
 = 
	`Ë16_to_ıu
(*(
u16
 *)
±r
);

2981 
g_Ën
 = 
	`Ë16_to_ıu
(*(
u16
 *)(
±r
 + 2));

2982 
g_d©a_±r
 = 
±r
 + 4;

2984 
sig_d©a_Ën
 >ğ
g_Ën
 + 4) {

2985 
g_id
) {

2986 
SLSI_NAN_TLV_TAG_MATCH_IND
:

2987 ià(
g_Ën
 < 0x15) {

2988 
	`SLSI_WARN
(
sdev
, "Inv®idagËn(%dèfÜ SLSI_NAN_TLV_TAG_MATCH_IND\n", 
g_Ën
);

2991 
	`‘h”_addr_cİy
(
h®_evt
->
addr
, 
g_d©a_±r
);

2993 
	`¦si_add_Çn_discov”y_šfo
(
ndev_vif
, 
h®_evt
->
addr
, h®_evt->
publish_subsüibe_id
, h®_evt->
»que¡Ü_š¡ªû_id
);

2994 
g_d©a_±r
 +ğ
ETH_ALEN
;

2995 
h®_evt
->
m©ch_occu¼ed_æag
 = 
	`Ë16_to_ıu
(*(
u16
 *)
g_d©a_±r
);

2996 
g_d©a_±r
 += 2;

2997 
h®_evt
->
out_of_»sourû_æag
 = 
	`Ë16_to_ıu
(*(
u16
 *)
g_d©a_±r
);

2998 
g_d©a_±r
 += 2;

2999 
h®_evt
->
rssi_v®ue
 = *
g_d©a_±r
;

3000 
g_d©a_±r
++;

3001 
h®_evt
->
£c_šfo
.
ch”_ty³
 = *
g_d©a_±r
;

3002 
g_d©a_±r
++;

3003 
h®_evt
->
³”_sd—_·¿ms
.
£cur™y_cfg
 = 
	`Ë16_to_ıu
(*(
u16
 *)
g_d©a_±r
);

3004 
g_d©a_±r
 += 2;

3005 
h®_evt
->
³”_sd—_·¿ms
.
¿ngšg_¡©e
 = 
	`Ë16_to_ıu
(*(
u16
 *)
g_d©a_±r
);

3006 
g_d©a_±r
 += 2;

3007 
h®_evt
->
¿nge_m—su»m’t_mm
 = 
	`Ë32_to_ıu
(*(
u32
 *)
g_d©a_±r
) * 10;

3008 
g_d©a_±r
 += 4;

3009 
h®_evt
->
¿ngšg_ev’t_ty³
 = *
g_d©a_±r
;

3010 
g_d©a_±r
++;

3012 
SLSI_NAN_TLV_TAG_SERVICE_SPECIFIC_INFO
:

3013 
h®_evt
->
£rviû_¥ecific_šfo_Ën
 = 
g_Ën
 > 
SLSI_HAL_NAN_MAX_SERVICE_SPECIFIC_INFO_LEN
 ?

3014 
SLSI_HAL_NAN_MAX_SERVICE_SPECIFIC_INFO_LEN
 : 
g_Ën
;

3015 
	`memıy
(
h®_evt
->
£rviû_¥ecific_šfo
, 
g_d©a_±r
, h®_evt->
£rviû_¥ecific_šfo_Ën
);

3016 
šfo_¡ršg
 = 
	`¦si_Çn_cÚv”t_by‹_to_¡ršg
(
h®_evt
->
£rviû_¥ecific_šfo_Ën
,

3017 
h®_evt
->
£rviû_¥ecific_šfo
);

3018 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "service_specific_info_len:%d, service_specific_info:%s\n",

3019 
h®_evt
->
£rviû_¥ecific_šfo_Ën
, 
šfo_¡ršg
);

3021 
SLSI_NAN_TLV_TAG_EXT_SERVICE_SPECIFIC_INFO
:

3022 ià(
g_Ën
 > 
SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
)

3023 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
 = 
SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
;

3025 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
 = 
g_Ën
;

3026 
	`memıy
(
h®_evt
->
sd—_£rviû_¥ecific_šfo
, 
g_d©a_±r
,

3027 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
);

3028 
šfo_¡ršg
 = 
	`¦si_Çn_cÚv”t_by‹_to_¡ršg
(
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
,

3029 
h®_evt
->
sd—_£rviû_¥ecific_šfo
);

3030 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
,

3032 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
, 
šfo_¡ršg
);

3034 
SLSI_NAN_TLV_TAG_DATA_PATH_SECURITY
:

3035 ià(
g_Ën
 < 7) {

3036 
	`SLSI_WARN
(
sdev
, "Inv®idagËn(%dèfÜ SLSI_NAN_TLV_TAG_DATA_PATH_SECURITY\n", 
g_Ën
);

3039 
h®_evt
->
£c_šfo
.
key_šfo
.
key_ty³
 = *
g_d©a_±r
;

3040 
g_d©a_±r
++;

3041 
h®_evt
->
£c_šfo
.
ch”_ty³
 = *
g_d©a_±r
;

3042 
g_d©a_±r
++;

3044 
SLSI_NAN_TLV_TAG_MATCH_FILTER
:

3045 ià(
g_Ën
 > 
SLSI_HAL_NAN_MAX_MATCH_FILTER_LEN
)

3046 
h®_evt
->
sdf_m©ch_f‹r_Ën
 = 
SLSI_HAL_NAN_MAX_MATCH_FILTER_LEN
;

3048 
h®_evt
->
sdf_m©ch_f‹r_Ën
 = 
g_Ën
;

3049 
	`memıy
(
h®_evt
->
sdf_m©ch_f‹r
, 
g_d©a_±r
, h®_evt->
sdf_m©ch_f‹r_Ën
);

3050 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "sdf_match_filter_len:%d, sdf_match_filter:%*.s\n",

3051 
h®_evt
->
sdf_m©ch_f‹r_Ën
, hal_evt->sdf_match_filter_len > 20 ? 20

3052 : 
h®_evt
->
sdf_m©ch_f‹r_Ën
, h®_evt->
sdf_m©ch_f‹r
);

3055 
	`SLSI_WARN
(
sdev
, "Sk…roûssšg TLV %d\n", 
g_id
);

3059 
sig_d©a_Ën
 -ğ
g_Ën
 + 4;

3060 
±r
 +ğ
g_Ën
 + 4;

3061 ià(
sig_d©a_Ën
 > 4) {

3062 
g_id
 = 
	`Ë16_to_ıu
(*(
u16
 *)
±r
);

3063 
g_Ën
 = 
	`Ë16_to_ıu
(*(
u16
 *)(
±r
 + 2));

3064 
g_d©a_±r
 = 
±r
 + 4;

3066 
g_id
 = 0;

3067 
g_Ën
 = 0;

3070 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
,

3072 
h®_evt
->
addr
, h®_evt->
m©ch_occu¼ed_æag
, h®_evt->
out_of_»sourû_æag
, h®_evt->
rssi_v®ue
,

3073 
h®_evt
->
£c_šfo
.
ch”_ty³
);

3074 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


3075 
	`SLSI_INFO
(
sdev
, "Event: %s(%d)\n",

3076 
	`¦si_´št_ev’t_Çme
(
SLSI_NL80211_NAN_MATCH_EVENT
), SLSI_NL80211_NAN_MATCH_EVENT);

3078 #ià(
	`KERNEL_VERSION
(4, 1, 0è<ğ
LINUX_VERSION_CODE
)

3079 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NL80211_NAN_MATCH_EVENT
,

3080 
GFP_KERNEL
);

3082 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NL80211_NAN_MATCH_EVENT
, 
GFP_KERNEL
);

3084 ià(!
Æ_skb
) {

3085 
	`SLSI_ERR
(
sdev
, "NO MEM for‚l_skb!!!\n");

3086 
	`kä“
(
h®_evt
);

3087 
ex™
;

3089 
»s
 = 
	`Æa_put_u16
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_PUBLISH_SUBSCRIBE_ID
, 
h®_evt
->
publish_subsüibe_id
);

3090 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_REQUESTOR_INSTANCE_ID
, 
h®_evt
->
»que¡Ü_š¡ªû_id
);

3091 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_ADDR
, 
ETH_ALEN
, 
h®_evt
->
addr
);

3092 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_SERVICE_SPECIFIC_INFO_LEN
, 
h®_evt
->
£rviû_¥ecific_šfo_Ën
);

3093 ià(
h®_evt
->
£rviû_¥ecific_šfo_Ën
)

3094 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_SERVICE_SPECIFIC_INFO
, 
h®_evt
->
£rviû_¥ecific_šfo_Ën
,

3095 
h®_evt
->
£rviû_¥ecific_šfo
);

3096 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_SDF_MATCH_FILTER_LEN
, 
h®_evt
->
sdf_m©ch_f‹r_Ën
);

3097 ià(
h®_evt
->
sdf_m©ch_f‹r_Ën
)

3098 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_SDF_MATCH_FILTER
, 
h®_evt
->
sdf_m©ch_f‹r_Ën
,

3099 
h®_evt
->
sdf_m©ch_f‹r
);

3100 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
NAN_EVT_ATTR_SDEA_LEN
, 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
);

3101 ià(
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
)

3102 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_SDEA
, 
h®_evt
->
sd—_£rviû_¥ecific_šfo_Ën
,

3103 
h®_evt
->
sd—_£rviû_¥ecific_šfo
);

3105 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_MATCH_OCCURRED_FLAG
, 
h®_evt
->
m©ch_occu¼ed_æag
);

3106 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_OUT_OF_RESOURCE_FLAG
, 
h®_evt
->
out_of_»sourû_æag
);

3107 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_RSSI_VALUE
, 
h®_evt
->
rssi_v®ue
);

3108 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
NAN_EVT_ATTR_SDEA_PARAM_SECURITY_CONFIG
, 
h®_evt
->
³”_sd—_·¿ms
.
£cur™y_cfg
);

3109 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
NAN_EVT_ATTR_SDEA_PARAM_RANGE_STATE
, 
h®_evt
->
³”_sd—_·¿ms
.
¿ngšg_¡©e
);

3110 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_RANGE_MEASUREMENT_MM
, 
h®_evt
->
¿nge_m—su»m’t_mm
);

3111 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_RANGEING_EVENT_TYPE
, 
h®_evt
->
¿ngšg_ev’t_ty³
);

3112 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_SECURITY_CIPHER_TYPE
, 
h®_evt
->
£c_šfo
.
ch”_ty³
);

3114 ià(
»s
) {

3115 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»s
);

3117 
	`kä“_skb
(
Æ_skb
);

3118 
	`kä“
(
h®_evt
);

3119 
ex™
;

3122 
	`cfg80211_v’dÜ_ev’t
(
Æ_skb
, 
GFP_KERNEL
);

3123 
	`kä“
(
h®_evt
);

3124 
ex™
:

3125 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3126 
	`kä“_skb
(
skb
);

3127 
	}
}

3129 
	$¦si_Çn_g‘_»¥_¡©us_code
(
u16
 
çpi_»suÉ_code
, u16 *
»¥_code
, u16 *
¡©us_code
)

3131 
çpi_»suÉ_code
) {

3132 
FAPI_RESULTCODE_SUCCESS
:

3133 *
»¥_code
 = 
NAN_DP_REQUEST_ACCEPT
;

3134 *
¡©us_code
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

3136 
FAPI_RESULTCODE_NDP_REJECTED
:

3137 *
»¥_code
 = 
NAN_DP_REQUEST_REJECT
;

3138 *
¡©us_code
 = 
SLSI_HAL_NAN_STATUS_SUCCESS
;

3140 
FAPI_RESULTCODE_NAN_NO_OTA_ACK
:

3141 *
»¥_code
 = 
NAN_DP_REQUEST_REJECT
;

3142 *
¡©us_code
 = 
SLSI_HAL_NAN_STATUS_NO_OTA_ACK
;

3144 
FAPI_RESULTCODE_NAN_INVALID_AVAILABILITY
:

3145 
FAPI_RESULTCODE_NAN_IMMUTABLE_UNACCEPTABLE
:

3146 
FAPI_RESULTCODE_NAN_REJECTED_SECURITY_POLICY
:

3147 
FAPI_RESULTCODE_NDL_UNACCEPTABLE
:

3148 *
»¥_code
 = 
NAN_DP_REQUEST_REJECT
;

3149 *
¡©us_code
 = 
SLSI_HAL_NAN_STATUS_PROTOCOL_FAILURE
;

3151 
FAPI_RESULTCODE_TRANSMISSION_FAILURE
:

3153 *
»¥_code
 = 
NAN_DP_REQUEST_REJECT
;

3154 *
¡©us_code
 = 
SLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
;

3156 
	}
}

3158 
u32
 
	$¦si_Çn_g‘_ndp_äom_ndl_loÿl_ndi
(
Ãt_deviû
 *
dev
, 
u16
 
ndl_vif_id
, 
u8
 *
loÿl_ndi
)

3160 
j
;

3161 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3163 
j
 = 0; j < 
SLSI_NAN_MAX_NDP_INSTANCES
; j++) {

3164 ià(
ndev_vif
->
Çn
.
ndp_š¡ªû_id2ndl_vif
[
j
] =ğ
ndl_vif_id
) {

3165 ià(
	`‘h”_addr_equ®
(
ndev_vif
->
Çn
.
ndp_ndi
[
j
], 
loÿl_ndi
))

3166  
j
 + 1;

3169  
SLSI_NAN_MAX_NDP_INSTANCES
 + 1;

3170 
	}
}

3172 
	$¦si_Çn_put_ndp_»q_šd_·¿ms
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
,

3173 
sk_buff
 *
Æ_skb
, 
u8
 **
³”_ndi
, 
u16
 *
»¥_code
, u16 *
ndp_š¡ªû_id
)

3175 
»s
;

3176 
u16
 
¡©us_code
;

3178 *
³”_ndi
 = 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_ndp_»que¡_šd
.
³”_ndp_š‹rçû_add»ss
);

3179 
	`¦si_Çn_g‘_»¥_¡©us_code
(
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_»que¡_šd
.
»suÉ_code
), 
»¥_code
, &
¡©us_code
);

3180 *
ndp_š¡ªû_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_»que¡_šd
.ndp_instance_id);

3182 
»s
 = 
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_NDP_INSTANCE_ID
, *
ndp_š¡ªû_id
);

3183 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_ADDR
, 
ETH_ALEN
, *
³”_ndi
);

3185 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_NDP_RSP_CODE
, *
»¥_code
);

3186 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_STATUS_CODE
, 
¡©us_code
);

3187  
»s
;

3188 
	}
}

3190 
	$¦si_Çn_put_ndp_»¥_šd_·¿ms
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
,

3191 
sk_buff
 *
Æ_skb
, 
u8
 **
³”_ndi
, 
u16
 *
»¥_code
, u16 *
ndp_š¡ªû_id
)

3193 
»s
;

3194 
u16
 
¡©us_code
;

3196 *
³”_ndi
 = 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_ndp_»¥Ú£_šd
.
³”_ndp_š‹rçû_add»ss
);

3197 
	`¦si_Çn_g‘_»¥_¡©us_code
(
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_»¥Ú£_šd
.
»suÉ_code
), 
»¥_code
, &
¡©us_code
);

3198 *
ndp_š¡ªû_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_»¥Ú£_šd
.ndp_instance_id);

3200 
»s
 = 
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_NDP_INSTANCE_ID
, *
ndp_š¡ªû_id
);

3201 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_ADDR
, 
ETH_ALEN
, *
³”_ndi
);

3203 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_NDP_RSP_CODE
, *
»¥_code
);

3204 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_STATUS_CODE
, 
¡©us_code
);

3206  
»s
;

3207 
	}
}

3209 
	$¦si_Çn_ndp_£tup_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
boŞ
 
is_»q_šd
)

3211 
u16
 
g_id
, 
g_Ën
;

3212 
u8
 *
±r
;

3213 cÚ¡ 
u8
 *
g_d©a_±r
;

3214 
sig_d©a_Ën
;

3215 
sk_buff
 *
Æ_skb
;

3216 
»s
;

3217 
u8
 *
³”_ndi
;

3218 
u16
 
ndp_£tup_»¥Ú£
, 
ndp_š¡ªû_id
;

3219 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3220 
d–ay_š_ms
 = 0;

3221 
ndp_£tup_time
 = 0;

3222 *
šfo_¡ršg
 = 
NULL
;

3224 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

3225 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3226 
sig_d©a_Ën
 = 
	`çpi_g‘_d©®’
(
skb
);

3228 #ià(
	`KERNEL_VERSION
(4, 1, 0è<ğ
LINUX_VERSION_CODE
)

3229 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NAN_EVENT_NDP_CFM
,

3230 
GFP_KERNEL
);

3232 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NAN_EVENT_NDP_CFM
, 
GFP_KERNEL
);

3234 ià(!
Æ_skb
) {

3235 
	`SLSI_ERR
(
sdev
, "NO MEM for‚l_skb!!!\n");

3236 
ex™
;

3239 ià(
is_»q_šd
)

3240 
»s
 = 
	`¦si_Çn_put_ndp_»q_šd_·¿ms
(
sdev
, 
dev
, 
skb
, 
Æ_skb
, &
³”_ndi
, &
ndp_£tup_»¥Ú£
, &
ndp_š¡ªû_id
);

3242 
»s
 = 
	`¦si_Çn_put_ndp_»¥_šd_·¿ms
(
sdev
, 
dev
, 
skb
, 
Æ_skb
, &
³”_ndi
, &
ndp_£tup_»¥Ú£
, &
ndp_š¡ªû_id
);

3244 
	`SLSI_INFO
(
sdev
, "is_req_ind:%d,…eer_ndi:%pM, setup_response:%d, instance_id:%d\n",

3245 
is_»q_šd
, 
³”_ndi
, 
ndp_£tup_»¥Ú£
, 
ndp_š¡ªû_id
);

3246 ià(
ndp_£tup_»¥Ú£
 !ğ
NAN_DP_REQUEST_ACCEPT
)

3247 
	`¦si_Çn_ndp_d–_’Œy
(
sdev
, 
dev
, 
ndp_š¡ªû_id
, 
çl£
);

3249 
±r
 = 
	`çpi_g‘_d©a
(
skb
);

3250 ià(
±r
) {

3251 
g_id
 = 
	`Ë16_to_ıu
(*(
u16
 *)
±r
);

3252 
g_Ën
 = 
	`Ë16_to_ıu
(*(
u16
 *)(
±r
 + 2));

3253 
g_d©a_±r
 = 
±r
 + 4;

3254 
sig_d©a_Ën
 >ğ
g_Ën
 + 4) {

3255 ià(
g_id
 =ğ
SLSI_NAN_TLV_TAG_APP_INFO
) {

3256 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
NAN_EVT_ATTR_APP_INFO_LEN
, 
g_Ën
);

3257 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_APP_INFO
, 
g_Ën
, 
g_d©a_±r
);

3258 
šfo_¡ršg
 = 
	`¦si_Çn_cÚv”t_by‹_to_¡ršg
(
g_Ën
, (
u8
 *)
g_d©a_±r
);

3259 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "­p_šfo_Ën:%d,‡µ_šfo:%s\n", 
g_Ën
, 
šfo_¡ršg
);

3261 } ià(
g_id
 =ğ
SLSI_NAN_TLV_WFA_SERVICE_INFO
) {

3262 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
NAN_EVT_ATTR_APP_INFO_LEN
, 
g_Ën
 + 3);

3263 
±r
[1] =…tr[0];

3264 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_APP_INFO
, 
g_Ën
 + 3, &
±r
[1]);

3265 
šfo_¡ršg
 = 
	`¦si_Çn_cÚv”t_by‹_to_¡ršg
(
g_Ën
 + 3, &
±r
[1]);

3266 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "£rviû_­p_šfo_Ën:%d,‡µ_šfo:%s\n", 
g_Ën
 + 3,

3267 
šfo_¡ršg
);

3270 
sig_d©a_Ën
 -ğ
g_Ën
 + 4;

3271 
±r
 +ğ
g_Ën
 + 4;

3272 ià(
sig_d©a_Ën
 > 4) {

3273 
g_id
 = 
	`Ë16_to_ıu
(*(
u16
 *)
±r
);

3274 
g_Ën
 = 
	`Ë16_to_ıu
(*(
u16
 *)(
±r
 + 2));

3275 
g_d©a_±r
 = 
±r
 + 4;

3277 
g_id
 = 0;

3278 
g_Ën
 = 0;

3283 ià(
»s
) {

3284 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»s
);

3286 
	`kä“_skb
(
Æ_skb
);

3287 
ex™
;

3290 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


3291 
	`SLSI_INFO
(
sdev
, "Event: %s(%d)\n",

3292 
	`¦si_´št_ev’t_Çme
(
SLSI_NAN_EVENT_NDP_CFM
), SLSI_NAN_EVENT_NDP_CFM);

3294 ià(
ndp_£tup_»¥Ú£
 =ğ
NAN_DP_REQUEST_ACCEPT
) {

3295 
Ãtdev_vif
 *
ndev_d©a_vif
;

3296 
Ãt_deviû
 *
d©a_dev
;

3297 
¦si_³”
 *
³”
 = 
NULL
;

3299 ià(
ndp_š¡ªû_id
 =ğ0 ||‚dp_š¡ªû_id > 
SLSI_NAN_MAX_NDP_INSTANCES
) {

3300 
	`SLSI_ERR
(
sdev
, "Inv®id‚dp_š¡ªû_id:%d\n", 
ndp_š¡ªû_id
);

3301 
ex™
;

3304 
d©a_dev
 = 
	`¦si_g‘_Ãtdev_by_mac_addr
(
sdev
, 
ndev_vif
->
Çn
.
ndp_ndi
[
ndp_š¡ªû_id
 - 1],

3305 
SLSI_NAN_DATA_IFINDEX_START
);

3307 ià(!
d©a_dev
) {

3308 
	`SLSI_ERR
(
sdev
, "nØd©a_dev fÜ‚dp_š¡ªû_id:%d‚di[" 
MACSTR
 "]\n", 
ndp_š¡ªû_id
, 
	`MAC2STR
(
ndev_vif
->
Çn
.
ndp_ndi
[ndp_instance_id - 1]));

3309 
ex™
;

3311 
ndev_d©a_vif
 = 
	`Ãtdev_´iv
(
d©a_dev
);

3312 
	`SLSI_MUTEX_LOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

3319 
ndev_d©a_vif
->
aùiv©ed
 = 
Œue
;

3320 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
d©a_dev
, 
³”_ndi
);

3321 ià(
³”
) {

3322 
³”
->
ndp_couÁ
++;

3324 
³”
 = 
	`¦si_³”_add
(
sdev
, 
d©a_dev
, 
³”_ndi
, 
ndp_š¡ªû_id
);

3325 ià(
³”
) {

3326 
³”
->
cÚÃùed_¡©e
 = 
SLSI_STA_CONN_STATE_CONNECTED
;

3327 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
d©a_dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

3328 
³”
->
ndl_vif
 = 
ndev_vif
->
Çn
.
ndp_š¡ªû_id2ndl_vif
[
ndp_š¡ªû_id
 - 1];

3329 
³”
->
qos_’abËd
 = 
Œue
;

3331 
	`SLSI_ERR
(
sdev
, "nØ³” fÜ‚dp_š¡ªû_id:%d‚di[%d]\n", 
ndp_š¡ªû_id
, 
ndev_vif
->
Çn
.
ndp_ndi
[ndp_instance_id - 1]);

3334 ià(
ndev_d©a_vif
->
iâum
 >ğ
SLSI_NAN_DATA_IFINDEX_START
) {

3335 
dev
->
æags
 |ğ
IFF_NOARP
;

3336 
	`Ãtif_ÿ¼›r_Ú
(
d©a_dev
);

3337 
ndp_£tup_time
 = 
jiff›s
;

3338 ià(
ndp_£tup_time
 > 
ndev_vif
->
Çn
.
ndp_¡¬t_time
)

3339 
d–ay_š_ms
 = 
	`jiff›s_to_m£cs
(
ndp_£tup_time
 - 
ndev_vif
->
Çn
.
ndp_¡¬t_time
);

3341 
d–ay_š_ms
 = 
	`jiff›s_to_m£cs
(
MAX_JIFFY_OFFSET
 - 
ndev_vif
->
Çn
.
ndp_¡¬t_time
 + 
ndp_£tup_time
);

3342 ià(
d–ay_š_ms
 < 
	`¦si_g‘_Çn_ndp_d–ay
())

3343 
	`m¦“p
(
	`¦si_g‘_Çn_ndp_max_time
(è- 
d–ay_š_ms
);

3345 
	`SLSI_MUTEX_UNLOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

3347 
	`cfg80211_v’dÜ_ev’t
(
Æ_skb
, 
GFP_KERNEL
);

3348 
ex™
:

3349 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3350 
	`kä“_skb
(
skb
);

3351 
	}
}

3353 
	$¦si_Çn_ndp_»que¡ed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3355 
u16
 
g_id
, 
g_Ën
 = 0, 
ndl_vif_id
, 
loÿl_ndp_š¡ªû_id
;

3356 
u8
 *
±r
, *
³”_nmi
;

3357 cÚ¡ 
u8
 *
g_d©a_±r
;

3358 
sig_d©a_Ën
, 
»s
;

3359 
sk_buff
 *
Æ_skb
;

3360 
u32
 
ndp_š¡ªû_id
;

3361 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3362 *
šfo_¡ršg
 = 
NULL
;

3364 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "\n");

3365 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3366 
sig_d©a_Ën
 = 
	`çpi_g‘_d©®’
(
skb
);

3367 
ndev_vif
->
Çn
.
ndp_¡¬t_time
 = 
jiff›s
;

3369 #ià(
	`KERNEL_VERSION
(4, 1, 0è<ğ
LINUX_VERSION_CODE
)

3370 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NAN_EVENT_NDP_REQ
,

3371 
GFP_KERNEL
);

3373 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NAN_EVENT_NDP_REQ
, 
GFP_KERNEL
);

3375 ià(!
Æ_skb
) {

3376 
	`SLSI_ERR
(
sdev
, "NO MEM for‚l_skb!!!\n");

3377 
ex™
;

3380 
loÿl_ndp_š¡ªû_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_»que¡ed_šd
.
»que¡_id
);

3381 
ndp_š¡ªû_id
 = 
	`¦si_Çn_g‘_Ãw_ndp_š¡ªû_id
(
ndev_vif
);

3382 
ndev_vif
->
Çn
.
Ãxt_ndp_š¡ªû_id
 = (
ndp_š¡ªû_id
 + 1è% (
SLSI_NAN_MAX_NDP_INSTANCES
 + 1);

3383 
³”_nmi
 = 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_ndp_»que¡ed_šd
.
³”_Çn_mªagem’t_š‹rçû_add»ss
);

3384 
»s
 = 
	`Æa_put_u16
(
Æ_skb
, 
NAN_EVT_ATTR_SERVICE_INSTANCE_ID
,

3385 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_»que¡ed_šd
.
£ssiÚ_id
));

3386 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_MATCH_ADDR
, 
ETH_ALEN
, 
³”_nmi
);

3387 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_NDP_INSTANCE_ID
, 
ndp_š¡ªû_id
);

3388 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_SDEA_PARAM_SECURITY_CONFIG
,

3389 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_»que¡ed_šd
.
£cur™y_»quœed
));

3391 
	`SLSI_INFO
(
sdev
, "session_id:%d,…eer_nmi:%pM,‚dp_instance_id:%d, security_req:%d\n",

3392 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_»que¡ed_šd
.
£ssiÚ_id
), 
³”_nmi
, 
ndp_š¡ªû_id
,

3393 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_»que¡ed_šd
.
£cur™y_»quœed
));

3394 
±r
 = 
	`çpi_g‘_d©a
(
skb
);

3395 ià(
±r
) {

3396 
g_id
 = 
	`Ë16_to_ıu
(*(
u16
 *)
±r
);

3397 
g_Ën
 = 
	`Ë16_to_ıu
(*(
u16
 *)(
±r
 + 2));

3398 
g_d©a_±r
 = 
±r
 + 4;

3400 
sig_d©a_Ën
 >ğ
g_Ën
 + 4) {

3401 ià(
g_id
 =ğ
SLSI_NAN_TLV_TAG_APP_INFO
) {

3402 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
NAN_EVT_ATTR_APP_INFO_LEN
, 
g_Ën
);

3403 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
NAN_EVT_ATTR_APP_INFO
, 
g_Ën
, 
g_d©a_±r
);

3404 
šfo_¡ršg
 = 
	`¦si_Çn_cÚv”t_by‹_to_¡ršg
(
g_Ën
, (
u8
 *)
g_d©a_±r
);

3405 
	`SLSI_DBG3
(
sdev
, 
SLSI_GSCAN
, "­p_šfo_Ën:%d,‡µ_šfo:%s\n", 
g_Ën
, 
šfo_¡ršg
);

3408 
sig_d©a_Ën
 -ğ
g_Ën
 + 4;

3409 
±r
 +ğ
g_Ën
 + 4;

3410 ià(
sig_d©a_Ën
 > 4) {

3411 
g_id
 = 
	`Ë16_to_ıu
(*(
u16
 *)
±r
);

3412 
g_Ën
 = 
	`Ë16_to_ıu
(*(
u16
 *)(
±r
 + 2));

3413 
g_d©a_±r
 = 
±r
 + 4;

3415 
g_id
 = 0;

3416 
g_Ën
 = 0;

3421 ià(
»s
) {

3422 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»s
);

3424 
	`kä“_skb
(
Æ_skb
);

3425 
ex™
;

3428 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


3429 
	`SLSI_INFO
(
sdev
, "Event: %s(%d)\n",

3430 
	`¦si_´št_ev’t_Çme
(
SLSI_NAN_EVENT_NDP_REQ
), SLSI_NAN_EVENT_NDP_REQ);

3432 
ndl_vif_id
 = 
	`¦si_Çn_ndp_g‘_ndl_vif_id
(
³”_nmi
, 
ndev_vif
->
Çn
.
ndl_li¡
);

3433 ià(
	`¦si_Çn_ndp_Ãw_’Œy
(
sdev
, 
dev
, 
ndp_š¡ªû_id
, 
ndl_vif_id
, 
NULL
, 
³”_nmi
) == 0) {

3434 
	`cfg80211_v’dÜ_ev’t
(
Æ_skb
, 
GFP_KERNEL
);

3435 
ndev_vif
->
Çn
.
ndp_loÿl_ndp_š¡ªû_id
[
ndp_š¡ªû_id
 - 1] = 
loÿl_ndp_š¡ªû_id
;

3437 
¦si_h®_Çn_d©a_·th_šdiÿtiÚ_»¥Ú£
 
»¥Ú£_»q
;

3439 
	`kä“_skb
(
Æ_skb
);

3440 
	`SLSI_ERR
(
sdev
, "šv®id‚dl_vifid:%d‚dp_š¡ªû_id:%d\n", 
ndl_vif_id
, 
ndp_š¡ªû_id
);

3441 
	`mem£t
(&
»¥Ú£_»q
, 0, (response_req));

3442 
»¥Ú£_»q
.
r¥_code
 = 
NAN_DP_REQUEST_REJECT
;

3443 
	`¦si_mlme_ndp_»¥Ú£
(
sdev
, 
dev
, &
»¥Ú£_»q
, 
loÿl_ndp_š¡ªû_id
);

3446 
ex™
:

3447 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3448 
	`kä“_skb
(
skb
);

3449 
	}
}

3451 
	$¦si_Çn_d–_³”
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
loÿl_ndi
, 
u16
 
ndp_š¡ªû_id
)

3453 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3454 
Ãt_deviû
 *
d©a_dev
;

3455 
Ãtdev_vif
 *
ndev_d©a_vif
;

3456 
¦si_³”
 *
³”
 = 
NULL
;

3458 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

3460 ià(!
loÿl_ndi
)

3463 
d©a_dev
 = 
	`¦si_g‘_Ãtdev_by_mac_addr_locked
(
sdev
, 
loÿl_ndi
, 
SLSI_NAN_DATA_IFINDEX_START
);

3464 ià(!
d©a_dev
)

3467 ià(
ndp_š¡ªû_id
 =ğ0 ||‚dp_š¡ªû_id > 
SLSI_NAN_MAX_NDP_INSTANCES
)

3470 
ndev_d©a_vif
 = 
	`Ãtdev_´iv
(
d©a_dev
);

3471 
	`SLSI_MUTEX_LOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

3472 
³”
 = 
ndev_d©a_vif
->
³”_¡a_»cÜd
[
ndp_š¡ªû_id
 - 1];

3473 ià(
³”
) {

3474 
³”
->
ndp_couÁ
--;

3475 ià(
³”
->
ndp_couÁ
 == 0) {

3476 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
d©a_dev
, 
³”
, 
SLSI_STA_CONN_STATE_DISCONNECTED
);

3477 
	`¦si_¥šlock_lock
(&
ndev_d©a_vif
->
³”_lock
);

3478 
	`¦si_³”_»move
(
sdev
, 
d©a_dev
, 
³”
);

3479 
	`¦si_¥šlock_uÆock
(&
ndev_d©a_vif
->
³”_lock
);

3482 
	`SLSI_ERR
(
sdev
, "nØ³” fÜ‚dp_š¡ªû_id:%d‚di[" 
MACSTR
 "]\n", 
ndp_š¡ªû_id
, 
	`MAC2STR
(
ndev_vif
->
Çn
.
ndp_ndi
[ndp_instance_id - 1]));

3484 
	`SLSI_MUTEX_UNLOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

3485 
	}
}

3487 
	$¦si_Çn_ndp_‹rmš©iÚ_hªdËr
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
ndp_š¡ªû_id
, 
u8
 *
ndi
)

3489 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3490 
sk_buff
 *
Æ_skb
;

3491 
Ãtdev_vif
 *
ndev_d©a_vif
 = 
NULL
;

3492 
Ãt_deviû
 *
d©a_dev
 = 
NULL
;

3494 ià(
ndp_š¡ªû_id
)

3495 
d©a_dev
 = 
	`¦si_g‘_Ãtdev_by_mac_addr
(
sdev
, 
ndev_vif
->
Çn
.
ndp_ndi
[
ndp_š¡ªû_id
 - 1],

3496 
SLSI_NAN_DATA_IFINDEX_START
);

3497 ià(
d©a_dev
) {

3498 
ndev_d©a_vif
 = 
	`Ãtdev_´iv
(
d©a_dev
);

3499 
	`SLSI_MUTEX_LOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

3500 ià(
ndev_d©a_vif
->
Çn
.
ndp_couÁ
 > 0)

3501 
ndev_d©a_vif
->
Çn
.
ndp_couÁ
--;

3502 
	`SLSI_MUTEX_UNLOCK
(
ndev_d©a_vif
->
vif_mu‹x
);

3505 
	`¦si_Çn_ndp_d–_’Œy
(
sdev
, 
dev
, 
ndp_š¡ªû_id
, 
çl£
);

3506 
	`¦si_Çn_d–_³”
(
sdev
, 
dev
, 
ndi
, 
ndp_š¡ªû_id
);

3508 #ià(
	`KERNEL_VERSION
(4, 1, 0è<ğ
LINUX_VERSION_CODE
)

3509 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NAN_EVENT_NDP_END
,

3510 
GFP_KERNEL
);

3512 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NAN_EVENT_NDP_END
, 
GFP_KERNEL
);

3514 ià(!
Æ_skb
) {

3515 
	`SLSI_ERR
(
sdev
, "NO MEM for‚l_skb!!!\n");

3519 ià(
	`Æa_put_u32
(
Æ_skb
, 
NAN_EVT_ATTR_NDP_INSTANCE_ID
, 
ndp_š¡ªû_id
)) {

3520 
	`SLSI_ERR
(
sdev
, "Error in‚la_put_u32\n");

3522 
	`kä“_skb
(
Æ_skb
);

3525 
	`SLSI_INFO
(
sdev
, "ndp_š¡ªû_id:%d\n", 
ndp_š¡ªû_id
);

3526 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


3527 
	`SLSI_INFO
(
sdev
, "Event: %s(%d)\n",

3528 
	`¦si_´št_ev’t_Çme
(
SLSI_NAN_EVENT_NDP_END
), SLSI_NAN_EVENT_NDP_END);

3530 
	`cfg80211_v’dÜ_ev’t
(
Æ_skb
, 
GFP_KERNEL
);

3531 
	}
}

3533 
	$¦si_Çn_ndp_‹rmš©iÚ_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3535 
u16
 
ndp_š¡ªû_id
;

3536 
u16
 
»asÚ
;

3537 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3539 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3541 
ndp_š¡ªû_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_‹rmš©ed_šd
.ndp_instance_id);

3542 
»asÚ
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_ndp_‹rmš©ed_šd
.
¥¬e_1
);

3544 
	`SLSI_INFO
(
sdev
, "ndp_id:%d,„—sÚ:%d\n", 
ndp_š¡ªû_id
, 
»asÚ
);

3546 ià(
ndp_š¡ªû_id
 <ğ
SLSI_NAN_MAX_NDP_INSTANCES
)

3547 
	`¦si_Çn_ndp_‹rmš©iÚ_hªdËr
(
sdev
, 
dev
, 
ndp_š¡ªû_id
, 
ndev_vif
->
Çn
.
ndp_ndi
[ndp_instance_id - 1]);

3549 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3550 
	`kä“_skb
(
skb
);

3551 
	}
}

3553 
	$¦si_£nd_Çn_¿nge_cÚfig
(
¦si_dev
 *
sdev
, 
u8
 
couÁ
, 
¦si_¹t_cÚfig
 *
Æ_¹t_·¿ms
, 
¹t_id
)

3555 
Ãt_deviû
 *
Çn_dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

3556 
Ãtdev_vif
 *
Çn_ndev_vif
;

3557 
r
 = 0;

3558 
boŞ
 
is_locked
 = 
çl£
;

3560 ià(!
	`¦si_dev_Çn_suµÜ‹d
(
sdev
)) {

3561 
	`SLSI_ERR
(
sdev
, "NAN‚Ù suµÜ‹d(mib:%d)\n", sdev->
Çn_’abËd
);

3562 
r
 = 
WIFI_HAL_ERROR_NOT_SUPPORTED
;

3563 
ex™
;

3565 ià(!
Çn_dev
) {

3566 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

3567 
r
 = -
EINVAL
;

3568 
ex™
;

3570 
Çn_ndev_vif
 = 
	`Ãtdev_´iv
(
Çn_dev
);

3571 
	`SLSI_MUTEX_LOCK
(
Çn_ndev_vif
->
vif_mu‹x
);

3572 
is_locked
 = 
Œue
;

3573 #iâdeà
SLSI_TEST_DEV


3574 ià(!
Çn_ndev_vif
->
aùiv©ed
) {

3575 
	`SLSI_ERR
(
sdev
, "NAN vif‚ot‡ctivated\n");

3576 
r
 = -
EINVAL
;

3577 
ex™
;

3580 ià(
r
 == 0)

3581 
r
 = 
	`¦si_mlme_Çn_¿nge_»q
(
sdev
, 
Çn_dev
, 
couÁ
, 
Æ_¹t_·¿ms
);

3582 
ex™
:

3583 ià(
r
) {

3584 
	`kä“
(
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1]);

3585 
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1] = 
NULL
;

3586 
	`SLSI_ERR_NODEV
("Failedo set‚an„ange config\n");

3588 ià(
is_locked
)

3589 
	`SLSI_MUTEX_UNLOCK
(
Çn_ndev_vif
->
vif_mu‹x
);

3590  
r
;

3591 
	}
}

3593 
	$¦si_£nd_Çn_¿nge_ÿnûl
(
¦si_dev
 *
sdev
)

3595 
Ãt_deviû
 *
Çn_dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

3596 
Ãtdev_vif
 *
Çn_ndev_vif
;

3597 
r
 = -
EINVAL
;

3599 ià(!
	`¦si_dev_Çn_suµÜ‹d
(
sdev
)) {

3600 
	`SLSI_ERR
(
sdev
, "NAN‚Ù suµÜ‹d(mib:%d)\n", sdev->
Çn_’abËd
);

3601  
WIFI_HAL_ERROR_NOT_SUPPORTED
;

3603 ià(!
Çn_dev
) {

3604 
	`SLSI_ERR
(
sdev
, "dev is NULL!!\n");

3605  
r
;

3607 
Çn_ndev_vif
 = 
	`Ãtdev_´iv
(
Çn_dev
);

3608 
	`SLSI_MUTEX_LOCK
(
Çn_ndev_vif
->
vif_mu‹x
);

3609 #iâdeà
SLSI_TEST_DEV


3610 ià(!
Çn_ndev_vif
->
aùiv©ed
) {

3611 
	`SLSI_ERR
(
sdev
, "NAN vif‚ot‡ctivated\n");

3612 
	`SLSI_MUTEX_UNLOCK
(
Çn_ndev_vif
->
vif_mu‹x
);

3613  
r
;

3616 
r
 = 
	`¦si_mlme_Çn_¿nge_ÿnûl_»q
(
sdev
, 
Çn_dev
);

3617 
	`SLSI_MUTEX_UNLOCK
(
Çn_ndev_vif
->
vif_mu‹x
);

3618  
r
;

3619 
	}
}

3621 
	$¦si_Çn_Œigg”_¹t_com¶‘e_ev’t
(
¦si_dev
 *
sdev
, 
u16
 
»que¡_id
, 
u8
 
¹t_id
)

3623 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


3624 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "Event: %s(%d)\n",

3625 
	`¦si_´št_ev’t_Çme
(
SLSI_NL80211_RTT_COMPLETE_EVENT
), SLSI_NL80211_RTT_COMPLETE_EVENT);

3627 
	`¦si_v’dÜ_ev’t
(
sdev
, 
SLSI_NL80211_RTT_COMPLETE_EVENT
, &
»que¡_id
, (request_id));

3629 
	`kä“
(
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1]);

3630 
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1] = 
NULL
;

3631 
	}
}

3633 
	$¦si_rx_Çn_¿nge_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3635 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3636 
u32
 
tm
;

3637 
d©a_Ën
 = 
	`çpi_g‘_d©®’
(
skb
);

3638 
u32
 
tmac
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
mlme_Çn_¿nge_šd
.
¥¬e_3
);

3639 
u8
 *
_±r
;

3640 
sk_buff
 *
Æ_skb
;

3641 
»s
 = 0;

3642 
Æ©Œ
 *
Æ©Œ_Ã¡ed
;

3643 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 6, 0))

3644 
time¥ec64
 
ts
;

3646 
time¥ec
 
ts
;

3648 
u64
 
tk”Ãl
;

3649 
u16
 
v®ue
;

3650 
u32
 
‹mp_v®ue
;

3651 
Ëngth
 = 0;

3652 
u8
 
¹t_id
 = 0;

3653 
u16
 
»que¡_id
 = 0;

3655 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3656 
¹t_id
 = 
SLSI_MIN_RTT_ID
;„‰_id <ğ
SLSI_MAX_RTT_ID
;„tt_id++)

3657 ià(
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1] && sdev->¹t_id_·¿ms[¹t_id - 1]->
³”_ty³
 =ğ
SLSI_RTT_PEER_NAN
)

3659 ià(
¹t_id
 > 
SLSI_MAX_RTT_ID
) {

3660 
	`kä“_skb
(
skb
);

3661 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3664 
»que¡_id
 = 
sdev
->
¹t_id_·¿ms
[
¹t_id
 - 1]->
h®_»que¡_id
;

3665 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

3666 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
,

3667 
SLSI_NL80211_RTT_RESULT_EVENT
, 
GFP_KERNEL
);

3669 
Æ_skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
, 
SLSI_NL80211_RTT_RESULT_EVENT
,

3670 
GFP_KERNEL
);

3672 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


3673 
	`SLSI_DBG1_NODEV
(
SLSI_GSCAN
, "Event: %s(%d)\n",

3674 
	`¦si_´št_ev’t_Çme
(
SLSI_NL80211_RTT_RESULT_EVENT
), SLSI_NL80211_RTT_RESULT_EVENT);

3677 ià(!
Æ_skb
) {

3678 
	`SLSI_ERR
(
sdev
, "NO MEM for‚l_skb!!!\n");

3679 
ex™
;

3682 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_ATTRIBUTE_TARGET_ID
, 
»que¡_id
);

3683 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_ATTRIBUTE_RESULTS_PER_TARGET
, 1);

3684 
_±r
 = 
	`çpi_g‘_d©a
(
skb
);

3685 
Ëngth
 + 
SLSI_NAN_TLV_NAN_RTT_RESULT_LEN
 + 4 <ğ
d©a_Ën
) {

3686 
Æ©Œ_Ã¡ed
 = 
	`Æa_Ã¡_¡¬t
(
Æ_skb
, 
SLSI_RTT_ATTRIBUTE_RESULT
);

3687 ià(!
Æ©Œ_Ã¡ed
) {

3688 
	`SLSI_ERR
(
sdev
, "Error in‚la_nest_start\n");

3690 
	`kä“_skb
(
Æ_skb
);

3691 
ex™
;

3694 
v®ue
 = 
	`Ë16_to_ıu
(*(
__Ë16
 *)&
_±r
);

3695 
_±r
 += 2;

3697 ià(
v®ue
 !ğ
SLSI_NAN_TLV_NAN_RTT_RESULT
) {

3698 
	`SLSI_ERR
(
sdev
, "Inv®id TLVag:%x\n", 
v®ue
);

3700 
	`kä“_skb
(
Æ_skb
);

3701 
ex™
;

3704 
v®ue
 = 
	`Ë16_to_ıu
(*(
__Ë16
 *)&
_±r
);

3705 
_±r
 += 2;

3707 ià(
v®ue
 !ğ
SLSI_NAN_TLV_NAN_RTT_RESULT_LEN
) {

3708 
	`SLSI_ERR
(
sdev
, "Inv®id TLV†’:%d\n", 
v®ue
);

3710 
	`kä“_skb
(
Æ_skb
);

3711 
ex™
;

3714 
»s
 |ğ
	`Æa_put
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_ADDR
, 
ETH_ALEN
, 
_±r
);

3715 
_±r
 += 6;

3717 
v®ue
 = 
	`Ë16_to_ıu
(*(
__Ë16
 *)&
_±r
);

3718 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_STATUS
, 
v®ue
);

3719 
_±r
 += 2;

3721 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_NUM_PER_BURST_PEER
, *
_±r
);

3722 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_MEASUREMENT_NUM
, *
_±r
++);

3723 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_SUCCESS_NUM
, *
_±r
++);

3724 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_BURST_NUM
, 0);

3726 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RETRY_AFTER_DURATION
, 0);

3727 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_TYPE
, 2);

3729 
v®ue
 = 
	`Ë16_to_ıu
(*(
__Ë16
 *)&
_±r
);

3730 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RSSI
, 
v®ue
);

3731 
_±r
 += 2;

3733 
v®ue
 = 
	`Ë16_to_ıu
(*(
__Ë16
 *)&
_±r
);

3734 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RSSI_SPREAD
, 
v®ue
);

3735 
_±r
 += 2;

3737 
‹mp_v®ue
 = 
	`Ë32_to_ıu
(*(
__Ë32
 *)&
_±r
);

3738 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RTT
, 
‹mp_v®ue
);

3739 
_±r
 += 4;

3741 
v®ue
 = 
	`Ë16_to_ıu
(*(
__Ë16
 *)&
_±r
);

3742 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RTT_SD
, 
v®ue
);

3743 
_±r
 += 2;

3745 
v®ue
 = 
	`Ë16_to_ıu
(*(
__Ë16
 *)&
_±r
);

3746 
»s
 |ğ
	`Æa_put_u16
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_RTT_SPREAD
, 
v®ue
);

3747 
_±r
 += 2;

3749 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 6, 0))

3750 
ts
 = 
	`ktime_to_time¥ec64
(
	`ktime_g‘_boÙtime
());

3751 #–ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 4, 0))

3752 
ts
 = 
	`ktime_to_time¥ec
(
	`ktime_g‘_boÙtime
());

3754 
	`g‘_mÚÙÚic_boÙtime
(&
ts
);

3756 
tk”Ãl
 = (
u64
)
	`TIMESPEC_TO_US
(
ts
);

3757 
‹mp_v®ue
 = 
	`Ë32_to_ıu
(*(
__Ë32
 *)&
_±r
);

3758 
tm
 = 
‹mp_v®ue
;

3759 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_TIMESTAMP_US
, 
tk”Ãl
 - (
tmac
 - 
tm
));

3760 
_±r
 += 4;

3762 
‹mp_v®ue
 = 
	`Ë32_to_ıu
(*(
__Ë32
 *)&
_±r
);

3763 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_DISTANCE_MM
, 
‹mp_v®ue
);

3764 
_±r
 += 4;

3766 
‹mp_v®ue
 = 
	`Ë32_to_ıu
(*(
__Ë32
 *)&
_±r
);

3767 
»s
 |ğ
	`Æa_put_u32
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_DISTANCE_SD_MM
, 
‹mp_v®ue
);

3768 
_±r
 += 4;

3770 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_BURST_DURATION_MSN
, *
_±r
++);

3771 
»s
 |ğ
	`Æa_put_u8
(
Æ_skb
, 
SLSI_RTT_EVENT_ATTR_NEGOTIATED_BURST_NUM
, 0);

3772 
	`Æa_Ã¡_’d
(
Æ_skb
, 
Æ©Œ_Ã¡ed
);

3773 
Ëngth
 +ğ
SLSI_NAN_TLV_NAN_RTT_RESULT_LEN
 + 4;

3775 ià(
Ëngth
 !ğ
d©a_Ën
 || data_len == 0) {

3776 
	`SLSI_ERR
(
sdev
, "IncÜ»ù†’gth bulk d©¨Ëngth:%d\n", 
d©a_Ën
);

3777 
	`kä“_skb
(
Æ_skb
);

3778 
ex™
;

3780 
	`SLSI_DBG_HEX
(
sdev
, 
SLSI_GSCAN
, 
	`çpi_g‘_d©a
(
skb
), 
	`çpi_g‘_d©®’
(skb), "nan_range indication skb buffer:\n");

3781 ià(
»s
) {

3782 
	`SLSI_ERR
(
sdev
, "E¼Ü iÀÆa_put*:%x\n", 
»s
);

3783 
	`kä“_skb
(
Æ_skb
);

3784 
ex™
;

3786 
	`cfg80211_v’dÜ_ev’t
(
Æ_skb
, 
GFP_KERNEL
);

3787 
ex™
:

3788 
	`¦si_Çn_Œigg”_¹t_com¶‘e_ev’t
(
sdev
, 
»que¡_id
, 
¹t_id
);

3789 
	`kä“_skb
(
skb
);

3790 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3791 
	}
}

	@nl80211_vendor_nan.h

6 #iâdeà
__SLSI_NL80211_VENDOR_NAN_H_


7 
	#__SLSI_NL80211_VENDOR_NAN_H_


	)

9 
	#SLSI_NAN_VIF_TYPE_NDP
 0x00FF

	)

11 
	#SLSI_NAN_TLV_TAG_CONFIGURATION
 0x0101

	)

12 
	#SLSI_NAN_TLV_TAG_2G4_BAND_SPECIFIC_CONFIG
 0x0102

	)

13 
	#SLSI_NAN_TLV_TAG_5G_BAND_SPECIFIC_CONFIG
 0x0103

	)

14 
	#SLSI_NAN_TLV_TAG_SUBSCRIBE_SPECIFIC
 0x0104

	)

15 
	#SLSI_NAN_TLV_TAG_DISCOVERY_COMMON_SPECIFIC
 0x0105

	)

16 
	#SLSI_NAN_TLV_TAG_SERVICE_NAME
 0x0106

	)

17 
	#SLSI_NAN_TLV_TAG_SERVICE_SPECIFIC_INFO
 0x0107

	)

18 
	#SLSI_NAN_TLV_TAG_EXT_SERVICE_SPECIFIC_INFO
 0x0108

	)

19 
	#SLSI_NAN_TLV_TAG_RX_MATCH_FILTER
 0x0109

	)

20 
	#SLSI_NAN_TLV_TAG_TX_MATCH_FILTER
 0x010a

	)

21 
	#SLSI_NAN_TLV_TAG_MATCH_FILTER
 0x010b

	)

22 
	#SLSI_NAN_TLV_TAG_INTERFACE_ADDRESS_SET
 0x010c

	)

23 
	#SLSI_NAN_TLV_TAG_MATCH_IND
 0x010d

	)

24 
	#SLSI_NAN_TLV_TAG_DATA_PATH_SECURITY
 0x010e

	)

25 
	#SLSI_NAN_TLV_TAG_APP_INFO
 0x010f

	)

26 
	#SLSI_NAN_TLV_TAG_RANGING
 0x0110

	)

27 
	#SLSI_NAN_TLV_TAG_CONFIG_SUPPLEMENTAL
 0x0111

	)

28 
	#SLSI_NAN_TLV_WFA_IPV6_LOCAL_LINK
 0x0000

	)

29 
	#SLSI_NAN_TLV_WFA_SERVICE_INFO
 0x0001

	)

30 
	#SLSI_NAN_TLV_NAN_RTT_CONFIG
 0x0112

	)

31 
	#SLSI_NAN_TLV_NAN_RTT_CONFIG_LEN
 0x0009

	)

32 
	#SLSI_NAN_TLV_NAN_RTT_RESULT
 0x0113

	)

33 
	#SLSI_NAN_TLV_NAN_RTT_RESULT_LEN
 0x0023

	)

35 
	#SLSI_NAN_MAX_SERVICE_ID
 16

	)

36 
	#SLSI_NAN_MAX_HOST_FOLLOWUP_REQ
 20

	)

37 
	#SLSI_NAN_MAX_NDP_INSTANCES
 8

	)

38 
	#SLSI_NAN_DATA_IFINDEX_START
 5

	)

39 
	#SLSI_NAN_CLUSTER_MERGE_ENABLE_MASK
 0xC0000000

	)

40 
	#SLSI_NAN_CLUSTER_MERGE_DISABLE_MASK
 0x80000000

	)

41 
	#SLSI_NAN_MAC_RANDOM_INTERVAL_MASK
 0x3fffffff

	)

43 
	eSLSI_NAN_REPLY_ATTRIBUTES
 {

44 
	mNAN_REPLY_ATTR_STATUS_TYPE
,

45 
	mNAN_REPLY_ATTR_VALUE
,

46 
	mNAN_REPLY_ATTR_RESPONSE_TYPE
,

47 
	mNAN_REPLY_ATTR_PUBLISH_SUBSCRIBE_TYPE
,

48 
	mNAN_REPLY_ATTR_CAP_MAX_CONCURRENT_CLUSTER
,

49 
	mNAN_REPLY_ATTR_CAP_MAX_PUBLISHES
,

50 
	mNAN_REPLY_ATTR_CAP_MAX_SUBSCRIBES
,

51 
	mNAN_REPLY_ATTR_CAP_MAX_SERVICE_NAME_LEN
,

52 
	mNAN_REPLY_ATTR_CAP_MAX_MATCH_FILTER_LEN
,

53 
	mNAN_REPLY_ATTR_CAP_MAX_TOTAL_MATCH_FILTER_LEN
,

54 
	mNAN_REPLY_ATTR_CAP_MAX_SERVICE_SPECIFIC_INFO_LEN
,

55 
	mNAN_REPLY_ATTR_CAP_MAX_VSA_DATA_LEN
,

56 
	mNAN_REPLY_ATTR_CAP_MAX_MESH_DATA_LEN
,

57 
	mNAN_REPLY_ATTR_CAP_MAX_NDI_INTERFACES
,

58 
	mNAN_REPLY_ATTR_CAP_MAX_NDP_SESSIONS
,

59 
	mNAN_REPLY_ATTR_CAP_MAX_APP_INFO_LEN
,

60 
	mNAN_REPLY_ATTR_NDP_INSTANCE_ID
,

61 
	mNAN_REPLY_ATTR_CAP_MAX_QUEUED_TRANSMIT_FOLLOWUP_MGS
,

62 
	mNAN_REPLY_ATTR_CAP_MAX_NDP_SUPPORTED_BANDS
,

63 
	mNAN_REPLY_ATTR_CAP_MAX_CIPHER_SUITES_SUPPORTED
,

64 
	mNAN_REPLY_ATTR_CAP_MAX_SCID_LEN
,

65 
	mNAN_REPLY_ATTR_CAP_NDP_SECURITY_SUPPORTED
,

66 
	mNAN_REPLY_ATTR_CAP_MAX_SDEA_SERVICE_SPECIFIC_INFO_LEN
,

67 
	mNAN_REPLY_ATTR_CAP_MAX_SUBSCRIBE_ADDRESS
,

68 
	mNAN_REPLY_ATTR_CAP_NDPE_ATTR_SUPPORTED
,

69 
	mNAN_REPLY_ATTR_HAL_TRANSACTION_ID


72 
	eSLSI_NAN_REQ_ATTRIBUTES
 {

73 
	mNAN_REQ_ATTR_MASTER_PREF
 = 1,

74 
	mNAN_REQ_ATTR_CLUSTER_LOW
,

75 
	mNAN_REQ_ATTR_CLUSTER_HIGH
,

76 
	mNAN_REQ_ATTR_HOP_COUNT_LIMIT_VAL
,

77 
	mNAN_REQ_ATTR_SID_BEACON_VAL
,

78 
	mNAN_REQ_ATTR_SUPPORT_2G4_VAL
,

79 
	mNAN_REQ_ATTR_SUPPORT_5G_VAL
,

80 
	mNAN_REQ_ATTR_RSSI_CLOSE_2G4_VAL
,

81 
	mNAN_REQ_ATTR_RSSI_MIDDLE_2G4_VAL
,

82 
	mNAN_REQ_ATTR_RSSI_PROXIMITY_2G4_VAL
,

83 
	mNAN_REQ_ATTR_BEACONS_2G4_VAL
 = 11,

84 
	mNAN_REQ_ATTR_SDF_2G4_VAL
,

85 
	mNAN_REQ_ATTR_CHANNEL_2G4_MHZ_VAL
,

86 
	mNAN_REQ_ATTR_RSSI_PROXIMITY_VAL
,

87 
	mNAN_REQ_ATTR_RSSI_CLOSE_5G_VAL
,

88 
	mNAN_REQ_ATTR_RSSI_CLOSE_PROXIMITY_5G_VAL
,

89 
	mNAN_REQ_ATTR_RSSI_MIDDLE_5G_VAL
,

90 
	mNAN_REQ_ATTR_RSSI_PROXIMITY_5G_VAL
,

91 
	mNAN_REQ_ATTR_BEACON_5G_VAL
,

92 
	mNAN_REQ_ATTR_SDF_5G_VAL
,

93 
	mNAN_REQ_ATTR_CHANNEL_5G_MHZ_VAL
 = 21,

94 
	mNAN_REQ_ATTR_RSSI_WINDOW_SIZE_VAL
,

95 
	mNAN_REQ_ATTR_OUI_VAL
,

96 
	mNAN_REQ_ATTR_MAC_ADDR_VAL
,

97 
	mNAN_REQ_ATTR_CLUSTER_VAL
,

98 
	mNAN_REQ_ATTR_SOCIAL_CH_SCAN_DWELL_TIME
,

99 
	mNAN_REQ_ATTR_SOCIAL_CH_SCAN_PERIOD
,

100 
	mNAN_REQ_ATTR_RANDOM_FACTOR_FORCE_VAL
,

101 
	mNAN_REQ_ATTR_HOP_COUNT_FORCE_VAL
,

102 
	mNAN_REQ_ATTR_CONN_CAPABILITY_PAYLOAD_TX
,

103 
	mNAN_REQ_ATTR_CONN_CAPABILITY_IBSS
 = 31,

104 
	mNAN_REQ_ATTR_CONN_CAPABILITY_WFD
,

105 
	mNAN_REQ_ATTR_CONN_CAPABILITY_WFDS
,

106 
	mNAN_REQ_ATTR_CONN_CAPABILITY_TDLS
,

107 
	mNAN_REQ_ATTR_CONN_CAPABILITY_MESH
,

108 
	mNAN_REQ_ATTR_CONN_CAPABILITY_WLAN_INFRA
,

109 
	mNAN_REQ_ATTR_DISCOVERY_ATTR_NUM_ENTRIES
,

110 
	mNAN_REQ_ATTR_DISCOVERY_ATTR_VAL
,

111 
	mNAN_REQ_ATTR_CONN_TYPE
,

112 
	mNAN_REQ_ATTR_NAN_ROLE
,

113 
	mNAN_REQ_ATTR_TRANSMIT_FREQ
 = 41,

114 
	mNAN_REQ_ATTR_AVAILABILITY_DURATION
,

115 
	mNAN_REQ_ATTR_AVAILABILITY_INTERVAL
,

116 
	mNAN_REQ_ATTR_MESH_ID_LEN
,

117 
	mNAN_REQ_ATTR_MESH_ID
,

118 
	mNAN_REQ_ATTR_INFRASTRUCTURE_SSID_LEN
,

119 
	mNAN_REQ_ATTR_INFRASTRUCTURE_SSID
,

120 
	mNAN_REQ_ATTR_FURTHER_AVAIL_NUM_ENTRIES
,

121 
	mNAN_REQ_ATTR_FURTHER_AVAIL_VAL
,

122 
	mNAN_REQ_ATTR_FURTHER_AVAIL_ENTRY_CTRL
,

123 
	mNAN_REQ_ATTR_FURTHER_AVAIL_CHAN_CLASS
 = 51,

124 
	mNAN_REQ_ATTR_FURTHER_AVAIL_CHAN
,

125 
	mNAN_REQ_ATTR_FURTHER_AVAIL_CHAN_MAPID
,

126 
	mNAN_REQ_ATTR_FURTHER_AVAIL_INTERVAL_BITMAP
,

127 
	mNAN_REQ_ATTR_PUBLISH_ID
,

128 
	mNAN_REQ_ATTR_PUBLISH_TTL
,

129 
	mNAN_REQ_ATTR_PUBLISH_PERIOD
,

130 
	mNAN_REQ_ATTR_PUBLISH_TYPE
,

131 
	mNAN_REQ_ATTR_PUBLISH_TX_TYPE
,

132 
	mNAN_REQ_ATTR_PUBLISH_COUNT
,

133 
	mNAN_REQ_ATTR_PUBLISH_SERVICE_NAME_LEN
 = 61,

134 
	mNAN_REQ_ATTR_PUBLISH_SERVICE_NAME
,

135 
	mNAN_REQ_ATTR_PUBLISH_MATCH_ALGO
,

136 
	mNAN_REQ_ATTR_PUBLISH_SERVICE_INFO_LEN
,

137 
	mNAN_REQ_ATTR_PUBLISH_SERVICE_INFO
,

138 
	mNAN_REQ_ATTR_PUBLISH_RX_MATCH_FILTER_LEN
,

139 
	mNAN_REQ_ATTR_PUBLISH_RX_MATCH_FILTER
,

140 
	mNAN_REQ_ATTR_PUBLISH_TX_MATCH_FILTER_LEN
,

141 
	mNAN_REQ_ATTR_PUBLISH_TX_MATCH_FILTER
,

142 
	mNAN_REQ_ATTR_PUBLISH_RSSI_THRESHOLD_FLAG
,

143 
	mNAN_REQ_ATTR_PUBLISH_CONN_MAP
 = 71,

144 
	mNAN_REQ_ATTR_PUBLISH_RECV_IND_CFG
,

145 
	mNAN_REQ_ATTR_SUBSCRIBE_ID
,

146 
	mNAN_REQ_ATTR_SUBSCRIBE_TTL
,

147 
	mNAN_REQ_ATTR_SUBSCRIBE_PERIOD
,

148 
	mNAN_REQ_ATTR_SUBSCRIBE_TYPE
,

149 
	mNAN_REQ_ATTR_SUBSCRIBE_RESP_FILTER_TYPE
,

150 
	mNAN_REQ_ATTR_SUBSCRIBE_RESP_INCLUDE
,

151 
	mNAN_REQ_ATTR_SUBSCRIBE_USE_RESP_FILTER
,

152 
	mNAN_REQ_ATTR_SUBSCRIBE_SSI_REQUIRED
,

153 
	mNAN_REQ_ATTR_SUBSCRIBE_MATCH_INDICATOR
 = 81,

154 
	mNAN_REQ_ATTR_SUBSCRIBE_COUNT
,

155 
	mNAN_REQ_ATTR_SUBSCRIBE_SERVICE_NAME_LEN
,

156 
	mNAN_REQ_ATTR_SUBSCRIBE_SERVICE_NAME
,

157 
	mNAN_REQ_ATTR_SUBSCRIBE_SERVICE_INFO_LEN
,

158 
	mNAN_REQ_ATTR_SUBSCRIBE_SERVICE_INFO
,

159 
	mNAN_REQ_ATTR_SUBSCRIBE_RX_MATCH_FILTER_LEN
,

160 
	mNAN_REQ_ATTR_SUBSCRIBE_RX_MATCH_FILTER
,

161 
	mNAN_REQ_ATTR_SUBSCRIBE_TX_MATCH_FILTER_LEN
,

162 
	mNAN_REQ_ATTR_SUBSCRIBE_TX_MATCH_FILTER
,

163 
	mNAN_REQ_ATTR_SUBSCRIBE_RSSI_THRESHOLD_FLAG
 = 91,

164 
	mNAN_REQ_ATTR_SUBSCRIBE_CONN_MAP
,

165 
	mNAN_REQ_ATTR_SUBSCRIBE_NUM_INTF_ADDR_PRESENT
,

166 
	mNAN_REQ_ATTR_SUBSCRIBE_INTF_ADDR
,

167 
	mNAN_REQ_ATTR_SUBSCRIBE_RECV_IND_CFG
,

168 
	mNAN_REQ_ATTR_FOLLOWUP_ID
,

169 
	mNAN_REQ_ATTR_FOLLOWUP_REQUESTOR_ID
,

170 
	mNAN_REQ_ATTR_FOLLOWUP_ADDR
,

171 
	mNAN_REQ_ATTR_FOLLOWUP_PRIORITY
,

172 
	mNAN_REQ_ATTR_FOLLOWUP_SERVICE_NAME_LEN
,

173 
	mNAN_REQ_ATTR_FOLLOWUP_SERVICE_NAME
 = 101,

174 
	mNAN_REQ_ATTR_FOLLOWUP_TX_WINDOW
,

175 
	mNAN_REQ_ATTR_FOLLOWUP_RECV_IND_CFG
,

176 
	mNAN_REQ_ATTR_SUBSCRIBE_SID_BEACON_VAL
,

177 
	mNAN_REQ_ATTR_DW_2G4_INTERVAL
,

178 
	mNAN_REQ_ATTR_DW_5G_INTERVAL
,

179 
	mNAN_REQ_ATTR_DISC_MAC_ADDR_RANDOM_INTERVAL
,

180 
	mNAN_REQ_ATTR_PUBLISH_SDEA_LEN
,

181 
	mNAN_REQ_ATTR_PUBLISH_SDEA
,

182 
	mNAN_REQ_ATTR_RANGING_AUTO_RESPONSE
,

183 
	mNAN_REQ_ATTR_SDEA_PARAM_NDP_TYPE
 = 111,

184 
	mNAN_REQ_ATTR_SDEA_PARAM_SECURITY_CFG
,

185 
	mNAN_REQ_ATTR_SDEA_PARAM_RANGING_STATE
,

186 
	mNAN_REQ_ATTR_SDEA_PARAM_RANGE_REPORT
,

187 
	mNAN_REQ_ATTR_SDEA_PARAM_QOS_CFG
,

188 
	mNAN_REQ_ATTR_RANGING_CFG_INTERVAL
,

189 
	mNAN_REQ_ATTR_RANGING_CFG_INDICATION
,

190 
	mNAN_REQ_ATTR_RANGING_CFG_INGRESS_MM
,

191 
	mNAN_REQ_ATTR_RANGING_CFG_EGRESS_MM
,

192 
	mNAN_REQ_ATTR_CIPHER_TYPE
,

193 
	mNAN_REQ_ATTR_SCID_LEN
 = 121,

194 
	mNAN_REQ_ATTR_SCID
,

195 
	mNAN_REQ_ATTR_SECURITY_KEY_TYPE
,

196 
	mNAN_REQ_ATTR_SECURITY_PMK_LEN
,

197 
	mNAN_REQ_ATTR_SECURITY_PMK
,

198 
	mNAN_REQ_ATTR_SECURITY_PASSPHRASE_LEN
,

199 
	mNAN_REQ_ATTR_SECURITY_PASSPHRASE
,

200 
	mNAN_REQ_ATTR_RANGE_RESPONSE_CFG_PUBLISH_ID
,

201 
	mNAN_REQ_ATTR_RANGE_RESPONSE_CFG_REQUESTOR_ID
,

202 
	mNAN_REQ_ATTR_RANGE_RESPONSE_CFG_PEER_ADDR
,

203 
	mNAN_REQ_ATTR_RANGE_RESPONSE_CFG_RANGING_RESPONSE
 = 131,

204 
	mNAN_REQ_ATTR_REQ_INSTANCE_ID
,

205 
	mNAN_REQ_ATTR_NDP_INSTANCE_ID
,

206 
	mNAN_REQ_ATTR_CHAN_REQ_TYPE
,

207 
	mNAN_REQ_ATTR_CHAN
,

208 
	mNAN_REQ_ATTR_DATA_INTERFACE_NAME_LEN
,

209 
	mNAN_REQ_ATTR_DATA_INTERFACE_NAME
,

210 
	mNAN_REQ_ATTR_APP_INFO_LEN
,

211 
	mNAN_REQ_ATTR_APP_INFO
,

212 
	mNAN_REQ_ATTR_SERVICE_NAME_LEN
,

213 
	mNAN_REQ_ATTR_SERVICE_NAME
 = 141,

214 
	mNAN_REQ_ATTR_NDP_RESPONSE_CODE
,

215 
	mNAN_REQ_ATTR_USE_NDPE_ATTR
,

216 
	mNAN_REQ_ATTR_HAL_TRANSACTION_ID
,

217 
	mNAN_REQ_ATTR_CONFIG_DISC_MAC_ADDR_RANDOM
,

218 
	mNAN_REQ_ATTR_DISCOVERY_BEACON_INT
,

219 
	mNAN_REQ_ATTR_NSS
,

220 
	mNAN_REQ_ATTR_ENABLE_RANGING
,

221 
	mNAN_REQ_ATTR_DW_EARLY_TERMINATION
,

222 
	mNAN_REQ_ATTR_MAX


225 
	eSLSI_NAN_RESP_ATTRIBUTES
 {

226 
	mNAN_RESP_ATTR_MAX_CONCURRENT_NAN_CLUSTERS
,

227 
	mNAN_RESP_ATTR_MAX_PUBLISHES
,

228 
	mNAN_RESP_ATTR_MAX_SUBSCRIBES
,

229 
	mNAN_RESP_ATTR_MAX_SERVICE_NAME_LEN
,

230 
	mNAN_RESP_ATTR_MAX_MATCH_FILTER_LEN
,

231 
	mNAN_RESP_ATTR_MAX_TOTAL_MATCH_FILTER_LEN
,

232 
	mNAN_RESP_ATTR_MAX_SERVICE_SPECIFIC_INFO_LEN
,

233 
	mNAN_RESP_ATTR_MAX_VSA_DATA_LEN
,

234 
	mNAN_RESP_ATTR_MAX_MESH_DATA_LEN
,

235 
	mNAN_RESP_ATTR_MAX_NDI_INTERFACES
,

236 
	mNAN_RESP_ATTR_MAX_NDP_SESSIONS
,

237 
	mNAN_RESP_ATTR_MAX_APP_INFO_LEN
,

238 
	mNAN_RESP_ATTR_SUBSCRIBE_ID
,

239 
	mNAN_RESP_ATTR_PUBLISH_ID


242 
	eSLSI_NAN_EVT_ATTRIBUTES
 {

243 
	mNAN_EVT_ATTR_MATCH_PUBLISH_SUBSCRIBE_ID
,

244 
	mNAN_EVT_ATTR_MATCH_REQUESTOR_INSTANCE_ID
,

245 
	mNAN_EVT_ATTR_MATCH_ADDR
,

246 
	mNAN_EVT_ATTR_MATCH_SERVICE_SPECIFIC_INFO_LEN
,

247 
	mNAN_EVT_ATTR_MATCH_SERVICE_SPECIFIC_INFO
,

248 
	mNAN_EVT_ATTR_MATCH_SDF_MATCH_FILTER_LEN
,

249 
	mNAN_EVT_ATTR_MATCH_SDF_MATCH_FILTER
,

250 
	mNAN_EVT_ATTR_MATCH_MATCH_OCCURRED_FLAG
,

251 
	mNAN_EVT_ATTR_MATCH_OUT_OF_RESOURCE_FLAG
,

252 
	mNAN_EVT_ATTR_MATCH_RSSI_VALUE
,

253 
	mNAN_EVT_ATTR_MATCH_CONN_CAPABILITY_IS_WFD_SUPPORTED
 = 10,

254 
	mNAN_EVT_ATTR_MATCH_CONN_CAPABILITY_IS_WFDS_SUPPORTED
,

255 
	mNAN_EVT_ATTR_MATCH_CONN_CAPABILITY_IS_TDLS_SUPPORTED
,

256 
	mNAN_EVT_ATTR_MATCH_CONN_CAPABILITY_IS_IBSS_SUPPORTED
,

257 
	mNAN_EVT_ATTR_MATCH_CONN_CAPABILITY_IS_MESH_SUPPORTED
,

258 
	mNAN_EVT_ATTR_MATCH_CONN_CAPABILITY_WLAN_INFRA_FIELD
,

259 
	mNAN_EVT_ATTR_MATCH_NUM_RX_DISCOVERY_ATTR
,

260 
	mNAN_EVT_ATTR_MATCH_RX_DISCOVERY_ATTR
,

261 
	mNAN_EVT_ATTR_MATCH_DISC_ATTR_TYPE
,

262 
	mNAN_EVT_ATTR_MATCH_DISC_ATTR_ROLE
,

263 
	mNAN_EVT_ATTR_MATCH_DISC_ATTR_DURATION
 = 20,

264 
	mNAN_EVT_ATTR_MATCH_DISC_ATTR_AVAIL_INTERVAL_BITMAP
,

265 
	mNAN_EVT_ATTR_MATCH_DISC_ATTR_MAPID
,

266 
	mNAN_EVT_ATTR_MATCH_DISC_ATTR_ADDR
,

267 
	mNAN_EVT_ATTR_MATCH_DISC_ATTR_MESH_ID_LEN
,

268 
	mNAN_EVT_ATTR_MATCH_DISC_ATTR_MESH_ID
,

269 
	mNAN_EVT_ATTR_MATCH_DISC_ATTR_INFRASTRUCTURE_SSID_LEN
,

270 
	mNAN_EVT_ATTR_MATCH_DISC_ATTR_INFRASTRUCTURE_SSID_VAL
,

271 
	mNAN_EVT_ATTR_MATCH_NUM_CHANS
,

272 
	mNAN_EVT_ATTR_MATCH_FAMCHAN
,

273 
	mNAN_EVT_ATTR_MATCH_FAM_ENTRY_CONTROL
 = 30,

274 
	mNAN_EVT_ATTR_MATCH_FAM_CLASS_VAL
,

275 
	mNAN_EVT_ATTR_MATCH_FAM_CHANNEL
,

276 
	mNAN_EVT_ATTR_MATCH_FAM_MAPID
,

277 
	mNAN_EVT_ATTR_MATCH_FAM_AVAIL_INTERVAL_BITMAP
,

278 
	mNAN_EVT_ATTR_MATCH_CLUSTER_ATTRIBUTE_LEN
,

279 
	mNAN_EVT_ATTR_MATCH_CLUSTER_ATTRIBUTE
,

280 
	mNAN_EVT_ATTR_PUBLISH_ID
,

281 
	mNAN_EVT_ATTR_PUBLISH_REASON
,

282 
	mNAN_EVT_ATTR_SUBSCRIBE_ID
,

283 
	mNAN_EVT_ATTR_SUBSCRIBE_REASON
 = 40,

284 
	mNAN_EVT_ATTR_DISABLED_REASON
,

285 
	mNAN_EVT_ATTR_FOLLOWUP_PUBLISH_SUBSCRIBE_ID
,

286 
	mNAN_EVT_ATTR_FOLLOWUP_REQUESTOR_INSTANCE_ID
,

287 
	mNAN_EVT_ATTR_FOLLOWUP_ADDR
,

288 
	mNAN_EVT_ATTR_FOLLOWUP_DW_OR_FAW
,

289 
	mNAN_EVT_ATTR_FOLLOWUP_SERVICE_SPECIFIC_INFO_LEN
,

290 
	mNAN_EVT_ATTR_FOLLOWUP_SERVICE_SPECIFIC_INFO
,

291 
	mNAN_EVT_ATTR_DISCOVERY_ENGINE_EVT_TYPE
,

292 
	mNAN_EVT_ATTR_DISCOVERY_ENGINE_MAC_ADDR
,

293 
	mNAN_EVT_ATTR_DISCOVERY_ENGINE_CLUSTER
 = 50,

294 
	mNAN_EVT_ATTR_SDEA
,

295 
	mNAN_EVT_ATTR_SDEA_LEN
,

296 
	mNAN_EVT_ATTR_SCID
,

297 
	mNAN_EVT_ATTR_SCID_LEN
,

298 
	mNAN_EVT_ATTR_SDEA_PARAM_CONFIG_NAN_DATA_PATH
,

299 
	mNAN_EVT_ATTR_SDEA_PARAM_NDP_TYPE
,

300 
	mNAN_EVT_ATTR_SDEA_PARAM_SECURITY_CONFIG
,

301 
	mNAN_EVT_ATTR_SDEA_PARAM_RANGE_STATE
,

302 
	mNAN_EVT_ATTR_SDEA_PARAM_RANGE_REPORT
,

303 
	mNAN_EVT_ATTR_SDEA_PARAM_QOS_CFG
 = 60,

304 
	mNAN_EVT_ATTR_RANGE_MEASUREMENT_MM
,

305 
	mNAN_EVT_ATTR_RANGEING_EVENT_TYPE
,

306 
	mNAN_EVT_ATTR_SECURITY_CIPHER_TYPE
,

307 
	mNAN_EVT_ATTR_STATUS
,

308 
	mNAN_EVT_ATTR_SERVICE_INSTANCE_ID
,

309 
	mNAN_EVT_ATTR_NDP_INSTANCE_ID
,

310 
	mNAN_EVT_ATTR_NDP_RSP_CODE
,

311 
	mNAN_EVT_ATTR_STATUS_CODE
,

312 
	mNAN_EVT_ATTR_CHANNEL_INFO
,

313 
	mNAN_EVT_ATTR_APP_INFO_LEN
 = 70,

314 
	mNAN_EVT_ATTR_APP_INFO
,

315 
	mNAN_EVT_ATTR_CHANNEL
,

316 
	mNAN_EVT_ATTR_CHANNEL_BW
,

317 
	mNAN_EVT_ATTR_CHANNEL_NSS
,

318 
	mNAN_EVT_ATTR_HAL_TRANSACTION_ID


321 
	#SLSI_FAPI_NAN_CONFIG_PARAM_SID_BEACON
 0X0003

	)

322 
	#SLSI_FAPI_NAN_CONFIG_PARAM_2_4_RSSI_CLOSE
 0X0004

	)

323 
	#SLSI_FAPI_NAN_CONFIG_PARAM_2_4_RSSI_MIDDLE
 0X0005

	)

324 
	#SLSI_FAPI_NAN_CONFIG_PARAM_2_4_RSSI_PROXIMITY
 0X0006

	)

325 
	#SLSI_FAPI_NAN_CONFIG_PARAM_BAND_USAGE
 0X0007

	)

326 
	#SLSI_FAPI_NAN_CONFIG_PARAM_5_RSSI_CLOSE
 0X0008

	)

327 
	#SLSI_FAPI_NAN_CONFIG_PARAM_5_RSSI_MIDDLE
 0X0009

	)

328 
	#SLSI_FAPI_NAN_CONFIG_PARAM_5_RSSI_PROXIMITY
 0X000A

	)

329 
	#SLSI_FAPI_NAN_CONFIG_PARAM_HOP_COUNT_LIMIT
 0X000B

	)

330 
	#SLSI_FAPI_NAN_CONFIG_PARAM_RSSI_WINDOW_SIZE
 0X000C

	)

331 
	#SLSI_FAPI_NAN_CONFIG_PARAM_SCAN_PARAMETER_2_4
 0X000D

	)

332 
	#SLSI_FAPI_NAN_CONFIG_PARAM_SCAN_PARAMETER_5
 0X000E

	)

333 
	#SLSI_FAPI_NAN_CONFIG_PARAM_MASTER_PREFERENCE
 0X000F

	)

334 
	#SLSI_FAPI_NAN_CONFIG_PARAM_CONNECTION_CAPAB
 0X0010

	)

335 
	#SLSI_FAPI_NAN_CONFIG_PARAM_POST_DISCOVER_PARAM
 0X0011

	)

336 
	#SLSI_FAPI_NAN_CONFIG_PARAM_FURTHER_AVAIL_CHANNEL_MAP
 0X0012

	)

337 
	#SLSI_FAPI_NAN_CONFIG_PARAM_ADDR_RANDOM_INTERVAL
 0X0013

	)

338 
	#SLSI_FAPI_NAN_SERVICE_NAME
 0X0020

	)

339 
	#SLSI_FAPI_NAN_SERVICE_SPECIFIC_INFO
 0X0021

	)

340 
	#SLSI_FAPI_NAN_RX_MATCH_FILTER
 0X0022

	)

341 
	#SLSI_FAPI_NAN_TX_MATCH_FILTER
 0X0023

	)

342 
	#SLSI_FAPI_NAN_SDF_MATCH_FILTER
 0X0024

	)

343 
	#SLSI_FAPI_NAN_CLUSTER_ATTRIBUTE
 0X0025

	)

344 
	#SLSI_FAPI_NAN_INTERFACE_ADDRESS_SET
 0X0026

	)

345 
	#SLSI_FAPI_NAN_SDEA
 0X0027

	)

347 
	#SLSI_HAL_NAN_MAX_SOCIAL_CHANNELS
 3

	)

348 
	#SLSI_HAL_NAN_MAX_SERVICE_NAME_LEN
 255

	)

349 
	#SLSI_HAL_NAN_MAX_SERVICE_SPECIFIC_INFO_LEN
 1024

	)

350 
	#SLSI_HAL_NAN_MAX_MATCH_FILTER_LEN
 255

	)

351 
	#SLSI_HAL_NAN_MAX_SUBSCRIBE_MAX_ADDRESS
 42

	)

352 
	#SLSI_HAL_NAN_MAX_POSTDISCOVERY_LEN
 5

	)

353 
	#SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
 1024

	)

354 
	#SLSI_HAL_NAN_DP_MAX_APP_INFO_LEN
 512

	)

356 
	e¦si_wifi_h®_Çn_¡©us_ty³
 {

358 
	mSLSI_HAL_NAN_STATUS_SUCCESS
 = 0,

360 
	mSLSI_HAL_NAN_STATUS_INTERNAL_FAILURE
 = 1,

362 
	mSLSI_HAL_NAN_STATUS_PROTOCOL_FAILURE
 = 2,

364 
	mSLSI_HAL_NAN_STATUS_INVALID_PUBLISH_SUBSCRIBE_ID
 = 3,

366 
	mSLSI_HAL_NAN_STATUS_NO_RESOURCE_AVAILABLE
 = 4,

368 
	mSLSI_HAL_NAN_STATUS_INVALID_PARAM
 = 5,

370 
	mSLSI_HAL_NAN_STATUS_INVALID_REQUESTOR_INSTANCE_ID
 = 6,

372 
	mSLSI_HAL_NAN_STATUS_INVALID_NDP_ID
 = 7,

374 
	mSLSI_HAL_NAN_STATUS_NAN_NOT_ALLOWED
 = 8,

376 
	mSLSI_HAL_NAN_STATUS_NO_OTA_ACK
 = 9,

378 
	mSLSI_HAL_NAN_STATUS_ALREADY_ENABLED
 = 10,

380 
	mSLSI_HAL_NAN_STATUS_FOLLOWUP_QUEUE_FULL
 = 11,

382 
	mSLSI_HAL_NAN_STATUS_UNSUPPORTED_CONCURRENCY_NAN_DISABLED
 = 12

385 
	e¦si_Çn_¡©us_ty³
 {

387 
	mNAN_STATUS_SUCCESS
 = 0,

388 
	mNAN_STATUS_TIMEOUT
 = 1,

389 
	mNAN_STATUS_DE_FAILURE
 = 2,

390 
	mNAN_STATUS_INVALID_MSG_VERSION
 = 3,

391 
	mNAN_STATUS_INVALID_MSG_LEN
 = 4,

392 
	mNAN_STATUS_INVALID_MSG_ID
 = 5,

393 
	mNAN_STATUS_INVALID_HANDLE
 = 6,

394 
	mNAN_STATUS_NO_SPACE_AVAILABLE
 = 7,

395 
	mNAN_STATUS_INVALID_PUBLISH_TYPE
 = 8,

396 
	mNAN_STATUS_INVALID_TX_TYPE
 = 9,

397 
	mNAN_STATUS_INVALID_MATCH_ALGORITHM
 = 10,

398 
	mNAN_STATUS_DISABLE_IN_PROGRESS
 = 11,

399 
	mNAN_STATUS_INVALID_TLV_LEN
 = 12,

400 
	mNAN_STATUS_INVALID_TLV_TYPE
 = 13,

401 
	mNAN_STATUS_MISSING_TLV_TYPE
 = 14,

402 
	mNAN_STATUS_INVALID_TOTAL_TLVS_LEN
 = 15,

403 
	mNAN_STATUS_INVALID_MATCH_HANDLE
 = 16,

404 
	mNAN_STATUS_INVALID_TLV_VALUE
 = 17,

405 
	mNAN_STATUS_INVALID_TX_PRIORITY
 = 18,

406 
	mNAN_STATUS_INVALID_CONNECTION_MAP
 = 19,

407 
	mNAN_STATUS_INVALID_TCA_ID
 = 20,

408 
	mNAN_STATUS_INVALID_STATS_ID
 = 21,

409 
	mNAN_STATUS_NAN_NOT_ALLOWED
 = 22,

410 
	mNAN_STATUS_NO_OTA_ACK
 = 23,

411 
	mNAN_STATUS_TX_FAIL
 = 24,

414 
	mNAN_STATUS_INVALID_RSSI_CLOSE_VALUE
 = 4096,

415 
	mNAN_STATUS_INVALID_RSSI_MIDDLE_VALUE
 = 4097,

416 
	mNAN_STATUS_INVALID_HOP_COUNT_LIMIT
 = 4098,

417 
	mNAN_STATUS_INVALID_MASTER_PREFERENCE_VALUE
 = 4099,

418 
	mNAN_STATUS_INVALID_LOW_CLUSTER_ID_VALUE
 = 4100,

419 
	mNAN_STATUS_INVALID_HIGH_CLUSTER_ID_VALUE
 = 4101,

420 
	mNAN_STATUS_INVALID_BACKGROUND_SCAN_PERIOD
 = 4102,

421 
	mNAN_STATUS_INVALID_RSSI_PROXIMITY_VALUE
 = 4103,

422 
	mNAN_STATUS_INVALID_SCAN_CHANNEL
 = 4104,

423 
	mNAN_STATUS_INVALID_POST_NAN_CONNECTIVITY_CAPABILITIES_BITMAP
 = 4105,

424 
	mNAN_STATUS_INVALID_FURTHER_AVAILABILITY_MAP_NUMCHAN_VALUE
 = 4106,

425 
	mNAN_STATUS_INVALID_FURTHER_AVAILABILITY_MAP_DURATION_VALUE
 = 4107,

426 
	mNAN_STATUS_INVALID_FURTHER_AVAILABILITY_MAP_CLASS_VALUE
 = 4108,

427 
	mNAN_STATUS_INVALID_FURTHER_AVAILABILITY_MAP_CHANNEL_VALUE
 = 4109,

428 
	mNAN_STATUS_INVALID_FURTHER_AVAILABILITY_MAP_AVAILABILITY_INTERVAL_BITMAP_VALUE
 = 4110,

429 
	mNAN_STATUS_INVALID_FURTHER_AVAILABILITY_MAP_MAP_ID
 = 4111,

430 
	mNAN_STATUS_INVALID_POST_NAN_DISCOVERY_CONN_TYPE_VALUE
 = 4112,

431 
	mNAN_STATUS_INVALID_POST_NAN_DISCOVERY_DEVICE_ROLE_VALUE
 = 4113,

432 
	mNAN_STATUS_INVALID_POST_NAN_DISCOVERY_DURATION_VALUE
 = 4114,

433 
	mNAN_STATUS_INVALID_POST_NAN_DISCOVERY_BITMAP_VALUE
 = 4115,

434 
	mNAN_STATUS_MISSING_FUTHER_AVAILABILITY_MAP
 = 4116,

435 
	mNAN_STATUS_INVALID_BAND_CONFIG_FLAGS
 = 4117,

436 
	mNAN_STATUS_INVALID_RANDOM_FACTOR_UPDATE_TIME_VALUE
 = 4118,

437 
	mNAN_STATUS_INVALID_ONGOING_SCAN_PERIOD
 = 4119,

438 
	mNAN_STATUS_INVALID_DW_INTERVAL_VALUE
 = 4120,

439 
	mNAN_STATUS_INVALID_DB_INTERVAL_VALUE
 = 4121,

441 
	mNAN_TERMINATED_REASON_INVALID
 = 8192,

442 
	mNAN_TERMINATED_REASON_TIMEOUT
 = 8193,

443 
	mNAN_TERMINATED_REASON_USER_REQUEST
 = 8194,

444 
	mNAN_TERMINATED_REASON_FAILURE
 = 8195,

445 
	mNAN_TERMINATED_REASON_COUNT_REACHED
 = 8196,

446 
	mNAN_TERMINATED_REASON_DE_SHUTDOWN
 = 8197,

447 
	mNAN_TERMINATED_REASON_DISABLE_IN_PROGRESS
 = 8198,

448 
	mNAN_TERMINATED_REASON_POST_DISC_ATTR_EXPIRED
 = 8199,

449 
	mNAN_TERMINATED_REASON_POST_DISC_LEN_EXCEEDED
 = 8200,

450 
	mNAN_TERMINATED_REASON_FURTHER_AVAIL_MAP_EMPTY
 = 8201

453 
	e¦si_Çn_»¥Ú£_ty³
 {

454 
	mNAN_RESPONSE_ENABLED
 = 0,

455 
	mNAN_RESPONSE_DISABLED
 = 1,

456 
	mNAN_RESPONSE_PUBLISH
 = 2,

457 
	mNAN_RESPONSE_PUBLISH_CANCEL
 = 3,

458 
	mNAN_RESPONSE_TRANSMIT_FOLLOWUP
 = 4,

459 
	mNAN_RESPONSE_SUBSCRIBE
 = 5,

460 
	mNAN_RESPONSE_SUBSCRIBE_CANCEL
 = 6,

461 
	mNAN_RESPONSE_STATS
 = 7,

462 
	mNAN_RESPONSE_CONFIG
 = 8,

463 
	mNAN_RESPONSE_TCA
 = 9,

464 
	mNAN_RESPONSE_ERROR
 = 10,

465 
	mNAN_RESPONSE_BEACON_SDF_PAYLOAD
 = 11,

466 
	mNAN_RESPONSE_GET_CAPABILITIES
 = 12,

467 
	mNAN_DP_INTERFACE_CREATE
 = 13,

468 
	mNAN_DP_INTERFACE_DELETE
 = 14,

469 
	mNAN_DP_INITIATOR_RESPONSE
 = 15,

470 
	mNAN_DP_RESPONDER_RESPONSE
 = 16,

471 
	mNAN_DP_END
 = 17

474 
	e¦si_Çn_disc_ev’t_ty³
 {

475 
	mNAN_EVENT_ID_DISC_MAC_ADDR
 = 0,

476 
	mNAN_EVENT_ID_STARTED_CLUSTER
,

477 
	mNAN_EVENT_ID_JOINED_CLUSTER


480 
	e¦si_Çn_d©a_·th_»¥Ú£_code
 {

481 
	mNAN_DP_REQUEST_ACCEPT
 = 0,

482 
	mNAN_DP_REQUEST_REJECT


485 
	g¦si_¹t_cÚfig
;

487 
	s¦si_h®_Çn_socŸl_chªÃl_sÿn_·¿ms
 {

488 
u8
 
	mdw–l_time
[
SLSI_HAL_NAN_MAX_SOCIAL_CHANNELS
];

489 
u16
 
	msÿn_³riod
[
SLSI_HAL_NAN_MAX_SOCIAL_CHANNELS
];

492 
	s¦si_h®_Çn_cÚÃùiv™y_ÿ·b™y
 {

493 
u8
 
	m·ylßd_Œªsm™_æag
;

494 
u8
 
	mis_wfd_suµÜ‹d
;

495 
u8
 
	mis_wfds_suµÜ‹d
;

496 
u8
 
	mis_tdls_suµÜ‹d
;

497 
u8
 
	mis_ibss_suµÜ‹d
;

498 
u8
 
	mis_mesh_suµÜ‹d
;

499 
u8
 
	mwÏn_šäa_f›ld
;

502 
	s¦si_h®_Çn_po¡_discov”y_·¿m
 {

503 
u8
 
	mty³
;

504 
u8
 
	mrŞe
;

505 
u8
 
	mŒªsm™_äeq
;

506 
u8
 
	mdu¿tiÚ
;

507 
u32
 
	mava_š‹rv®_b™m­
;

508 
u8
 
	maddr
[
ETH_ALEN
];

509 
u16
 
	mmesh_id_Ën
;

510 
u8
 
	mmesh_id
[32];

511 
u16
 
	mšäa¡ruùu»_ssid_Ën
;

512 
u8
 
	mšäa¡ruùu»_ssid_v®
[32];

515 
	s¦si_h®_Çn_fu¹h”_avaab™y_chªÃl
 {

517 
u8
 
	m’Œy_cÚŒŞ
;

518 
u8
 
	mşass_v®
;

519 
u8
 
	mchªÃl
;

520 
u8
 
	mm­id
;

521 
u32
 
	mava_š‹rv®_b™m­
;

524 
	s¦si_h®_Çn_fu¹h”_avaab™y_m­
 {

525 
u8
 
	mnumchªs
;

526 
¦si_h®_Çn_fu¹h”_avaab™y_chªÃl
 
	mçmchª
[32];

529 
	s¦si_h®_Çn_»ûive_po¡_discov”y
 {

530 
u8
 
	mty³
;

531 
u8
 
	mrŞe
;

532 
u8
 
	mdu¿tiÚ
;

533 
u32
 
	mava_š‹rv®_b™m­
;

534 
u8
 
	mm­id
;

535 
u8
 
	maddr
[
ETH_ALEN
];

536 
u16
 
	mmesh_id_Ën
;

537 
u8
 
	mmesh_id
[32];

538 
u16
 
	mšäa¡ruùu»_ssid_Ën
;

539 
u8
 
	mšäa¡ruùu»_ssid_v®
[32];

542 
	s¦si_Çn_sd—_ù¾_·¿ms
 {

543 
u8
 
	mcÚfig_Çn_d©a_·th
;

544 
u8
 
	mndp_ty³
;

545 
u8
 
	m£cur™y_cfg
;

546 
u8
 
	m¿ngšg_¡©e
;

547 
u8
 
	m¿nge_»pÜt
;

548 
u8
 
	mqos_cfg
;

551 
	s¦si_Çn_¿ngšg_cfg
 {

552 
u32
 
	m¿ngšg_š‹rv®_m£c
;

553 
u32
 
	mcÚfig_¿ngšg_šdiÿtiÚs
;

554 
u32
 
	mdi¡ªû_šg»ss_mm
;

555 
u32
 
	mdi¡ªû_eg»ss_mm
;

558 
	s¦si_Çn_¿nge_»¥Ú£_cfg
 {

559 
u16
 
	mpublish_id
;

560 
u32
 
	m»que¡Ü_š¡ªû_id
;

561 
u8
 
	m³”_addr
[
ETH_ALEN
];

562 
u8
 
	m¿ngšg_»¥Ú£
;

565 
	#SLSI_NAN_PMK_INFO_LEN
 32

	)

566 
	#SLSI_NAN_SECURITY_MAX_PASSPHRASE_LEN
 63

	)

567 
	#SLSI_NAN_MAX_SCID_BUF_LEN
 1024

	)

568 
	s¦si_Çn_£cur™y_pmk
 {

569 
u32
 
	mpmk_Ën
;

570 
u8
 
	mpmk
[
SLSI_NAN_PMK_INFO_LEN
];

573 
	s¦si_Çn_£cur™y_·s¥h¿£
 {

574 
u32
 
	m·s¥h¿£_Ën
;

575 
u8
 
	m·s¥h¿£
[
SLSI_NAN_SECURITY_MAX_PASSPHRASE_LEN
];

578 
	s¦si_Çn_£cur™y_key_šfo
 {

579 
u8
 
	mkey_ty³
;

581 
¦si_Çn_£cur™y_pmk
 
	mpmk_šfo
;

582 
¦si_Çn_£cur™y_·s¥h¿£
 
	m·s¥h¿£_šfo
;

583 } 
	mbody
;

586 
	s¦si_Çn_£cur™y_šfo
 {

587 
u32
 
	mch”_ty³
;

588 
u32
 
	mscid_Ën
;

589 
u8
 
	mscid
[
SLSI_NAN_MAX_SCID_BUF_LEN
];

590 
¦si_Çn_£cur™y_key_šfo
 
	mkey_šfo
;

593 
	s¦si_h®_Çn_’abË_»q
 {

594 
u16
 
	mŒª§ùiÚ_id
;

596 
u8
 
	mma¡”_´ef
;

597 
u16
 
	mşu¡”_low
;

598 
u16
 
	mşu¡”_high
;

600 
u8
 
	mcÚfig_suµÜt_5g
;

601 
u8
 
	msuµÜt_5g_v®
;

602 
u8
 
	mcÚfig_sid_b—cÚ
;

603 
u8
 
	msid_b—cÚ_v®
;

604 
u8
 
	mcÚfig_2dÙ4g_rssi_şo£
;

605 
u8
 
	mrssi_şo£_2dÙ4g_v®
;

607 
u8
 
	mcÚfig_2dÙ4g_rssi_middË
;

608 
u8
 
	mrssi_middË_2dÙ4g_v®
;

610 
u8
 
	mcÚfig_2dÙ4g_rssi_´oxim™y
;

611 
u8
 
	mrssi_´oxim™y_2dÙ4g_v®
;

613 
u8
 
	mcÚfig_hİ_couÁ_lim™
;

614 
u8
 
	mhİ_couÁ_lim™_v®
;

616 
u8
 
	mcÚfig_2dÙ4g_suµÜt
;

617 
u8
 
	msuµÜt_2dÙ4g_v®
;

619 
u8
 
	mcÚfig_2dÙ4g_b—cÚs
;

620 
u8
 
	mb—cÚ_2dÙ4g_v®
;

621 
u8
 
	mcÚfig_2dÙ4g_sdf
;

622 
u8
 
	msdf_2dÙ4g_v®
;

623 
u8
 
	mcÚfig_5g_b—cÚs
;

624 
u8
 
	mb—cÚ_5g_v®
;

625 
u8
 
	mcÚfig_5g_sdf
;

626 
u8
 
	msdf_5g_v®
;

627 
u8
 
	mcÚfig_5g_rssi_şo£
;

628 
u8
 
	mrssi_şo£_5g_v®
;

629 
u8
 
	mcÚfig_5g_rssi_middË
;

630 
u8
 
	mrssi_middË_5g_v®
;

631 
u8
 
	mcÚfig_5g_rssi_şo£_´oxim™y
;

632 
u8
 
	mrssi_şo£_´oxim™y_5g_v®
;

633 
u8
 
	mcÚfig_rssi_wšdow_size
;

634 
u8
 
	mrssi_wšdow_size_v®
;

636 
u8
 
	mcÚfig_oui
;

637 
u32
 
	moui_v®
;

638 
u8
 
	mcÚfig_štf_addr
;

639 
u8
 
	mštf_addr_v®
[
ETH_ALEN
];

641 
u8
 
	mcÚfig_şu¡”_©Œibu‹_v®
;

642 
u8
 
	mcÚfig_sÿn_·¿ms
;

643 
¦si_h®_Çn_socŸl_chªÃl_sÿn_·¿ms
 
	msÿn_·¿ms_v®
;

644 
u8
 
	mcÚfig_¿ndom_çùÜ_fÜû
;

645 
u8
 
	m¿ndom_çùÜ_fÜû_v®
;

646 
u8
 
	mcÚfig_hİ_couÁ_fÜû
;

647 
u8
 
	mhİ_couÁ_fÜû_v®
;

650 
u8
 
	mcÚfig_24g_chªÃl
;

651 
u32
 
	mchªÃl_24g_v®
;

653 
u8
 
	mcÚfig_5g_chªÃl
;

654 
	mchªÃl_5g_v®
;

655 
u8
 
	mcÚfig_subsüibe_sid_b—cÚ
;

656 
u32
 
	msubsüibe_sid_b—cÚ_v®
;

659 
u8
 
	mcÚfig_2dÙ4g_dw_bªd
;

660 
u32
 
	mdw_2dÙ4g_š‹rv®_v®
;

661 
u8
 
	mcÚfig_5g_dw_bªd
;

662 
u32
 
	mdw_5g_š‹rv®_v®
;

663 
u32
 
	mdisc_mac_addr_¿nd_š‹rv®_£c
;

665 
u32
 
	mdiscov”y_b—cÚ_š‹rv®_ms
;

666 
u32
 
	mnss_discov”y
;

667 
u32
 
	m’abË_dw_—¾y_‹rmš©iÚ
;

668 
u32
 
	m’abË_¿ngšg
;

671 
	s¦si_h®_Çn_publish_»q
 {

672 
u16
 
	mŒª§ùiÚ_id
;

674 
u16
 
	mpublish_id
;

676 
u16
 
	m‰l
;

680 
u16
 
	m³riod
;

681 
u8
 
	mpublish_ty³
;

682 
u8
 
	mtx_ty³
;

684 
u8
 
	mpublish_couÁ
;

685 
u16
 
	m£rviû_Çme_Ën
;

686 
u8
 
	m£rviû_Çme
[
SLSI_HAL_NAN_MAX_SERVICE_NAME_LEN
];

687 
u8
 
	mpublish_m©ch_šdiÿtÜ
;

689 
u16
 
	m£rviû_¥ecific_šfo_Ën
;

690 
u8
 
	m£rviû_¥ecific_šfo
[
SLSI_HAL_NAN_MAX_SERVICE_SPECIFIC_INFO_LEN
];

692 
u16
 
	mrx_m©ch_f‹r_Ën
;

693 
u8
 
	mrx_m©ch_f‹r
[
SLSI_HAL_NAN_MAX_MATCH_FILTER_LEN
];

695 
u16
 
	mtx_m©ch_f‹r_Ën
;

696 
u8
 
	mtx_m©ch_f‹r
[
SLSI_HAL_NAN_MAX_MATCH_FILTER_LEN
];

698 
u8
 
	mrssi_th»shŞd_æag
;

711 
u8
 
	mcÚnm­
;

718 
u8
 
	m»cv_šdiÿtiÚ_cfg
;

720 
u8
 
	m£rviû_»¥Úd”_pŞicy
;

721 
¦si_Çn_£cur™y_šfo
 
	m£c_šfo
;

722 
¦si_Çn_sd—_ù¾_·¿ms
 
	msd—_·¿ms
;

723 
¦si_Çn_¿ngšg_cfg
 
	m¿ngšg_cfg
;

724 
u8
 
	m¿ngšg_auto_»¥Ú£
;

725 
¦si_Çn_¿nge_»¥Ú£_cfg
 
	m¿nge_»¥Ú£_cfg
;

727 
u16
 
	msd—_£rviû_¥ecific_šfo_Ën
;

728 
u8
 
	msd—_£rviû_¥ecific_šfo
[
SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
];

731 
	s¦si_h®_Çn_subsüibe_»q
 {

732 
u16
 
	mŒª§ùiÚ_id
;

734 
u16
 
	msubsüibe_id
;

736 
u16
 
	m‰l
;

740 
u16
 
	m³riod
;

743 
u8
 
	msubsüibe_ty³
;

748 
u8
 
	m£rviû_»¥Ú£_f‹r
;

754 
u8
 
	m£rviû_»¥Ú£_šşude
;

760 
u8
 
	mu£_£rviû_»¥Ú£_f‹r
;

765 
u8
 
	mssi_»quœed_fÜ_m©ch_šdiÿtiÚ
;

774 
u8
 
	msubsüibe_m©ch_šdiÿtÜ
;

780 
u8
 
	msubsüibe_couÁ
;

784 
u16
 
	m£rviû_Çme_Ën
;

785 
u8
 
	m£rviû_Çme
[
SLSI_HAL_NAN_MAX_SERVICE_NAME_LEN
];

790 
u16
 
	m£rviû_¥ecific_šfo_Ën
;

791 
u8
 
	m£rviû_¥ecific_šfo
[
SLSI_HAL_NAN_MAX_SERVICE_SPECIFIC_INFO_LEN
];

797 
u16
 
	mrx_m©ch_f‹r_Ën
;

798 
u8
 
	mrx_m©ch_f‹r
[
SLSI_HAL_NAN_MAX_MATCH_FILTER_LEN
];

803 
u16
 
	mtx_m©ch_f‹r_Ën
;

804 
u8
 
	mtx_m©ch_f‹r
[
SLSI_HAL_NAN_MAX_MATCH_FILTER_LEN
];

805 
u8
 
	mrssi_th»shŞd_æag
;

807 
u8
 
	mcÚnm­
;

811 
u8
 
	mnum_štf_addr_´e£Á
;

812 
u8
 
	mštf_addr
[
SLSI_HAL_NAN_MAX_SUBSCRIBE_MAX_ADDRESS
][
ETH_ALEN
];

819 
u8
 
	m»cv_šdiÿtiÚ_cfg
;

821 
¦si_Çn_£cur™y_šfo
 
	m£c_šfo
;

822 
¦si_Çn_sd—_ù¾_·¿ms
 
	msd—_·¿ms
;

823 
¦si_Çn_¿ngšg_cfg
 
	m¿ngšg_cfg
;

824 
u8
 
	m¿ngšg_auto_»¥Ú£
;

825 
¦si_Çn_¿nge_»¥Ú£_cfg
 
	m¿nge_»¥Ú£_cfg
;

827 
u16
 
	msd—_£rviû_¥ecific_šfo_Ën
;

828 
u8
 
	msd—_£rviû_¥ecific_šfo
[
SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
];

831 
	s¦si_h®_Çn_Œªsm™_fŞlowup_»q
 {

832 
u16
 
	mŒª§ùiÚ_id
;

834 
u16
 
	mpublish_subsüibe_id
;

839 
u32
 
	m»que¡Ü_š¡ªû_id
;

840 
u8
 
	maddr
[
ETH_ALEN
];

841 
u8
 
	m´iÜ™y
;

842 
u8
 
	mdw_Ü_çw
;

847 
u16
 
	m£rviû_¥ecific_šfo_Ën
;

848 
u8
 
	m£rviû_¥ecific_šfo
[
SLSI_HAL_NAN_MAX_SERVICE_SPECIFIC_INFO_LEN
];

853 
u8
 
	m»cv_šdiÿtiÚ_cfg
;

855 
u16
 
	msd—_£rviû_¥ecific_šfo_Ën
;

856 
u8
 
	msd—_£rviû_¥ecific_šfo
[
SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
];

859 
	s¦si_h®_Çn_cÚfig_»q
 {

860 
u16
 
	mŒª§ùiÚ_id
;

861 
u8
 
	mcÚfig_sid_b—cÚ
;

862 
u8
 
	msid_b—cÚ
;

863 
u8
 
	mcÚfig_rssi_´oxim™y
;

864 
u8
 
	mrssi_´oxim™y
;

865 
u8
 
	mcÚfig_ma¡”_´ef
;

866 
u8
 
	mma¡”_´ef
;

873 
u8
 
	mcÚfig_5g_rssi_şo£_´oxim™y
;

874 
u8
 
	mrssi_şo£_´oxim™y_5g_v®
;

875 
u8
 
	mcÚfig_rssi_wšdow_size
;

876 
u16
 
	mrssi_wšdow_size_v®
;

881 
u8
 
	mcÚfig_şu¡”_©Œibu‹_v®
;

882 
u8
 
	mcÚfig_sÿn_·¿ms
;

883 
¦si_h®_Çn_socŸl_chªÃl_sÿn_·¿ms
 
	msÿn_·¿ms_v®
;

887 
u8
 
	mcÚfig_¿ndom_çùÜ_fÜû
;

888 
u8
 
	m¿ndom_çùÜ_fÜû_v®
;

893 
u8
 
	mcÚfig_hİ_couÁ_fÜû
;

894 
u8
 
	mhİ_couÁ_fÜû_v®
;

896 
u8
 
	mcÚfig_cÚn_ÿ·b™y
;

897 
¦si_h®_Çn_cÚÃùiv™y_ÿ·b™y
 
	mcÚn_ÿ·b™y_v®
;

899 
u8
 
	mnum_cÚfig_discov”y_©Œ
;

900 
¦si_h®_Çn_po¡_discov”y_·¿m
 
	mdiscov”y_©Œ_v®
[
SLSI_HAL_NAN_MAX_POSTDISCOVERY_LEN
];

902 
u8
 
	mcÚfig_çm
;

903 
¦si_h®_Çn_fu¹h”_avaab™y_m­
 
	mçm_v®
;

905 
	mchªÃl_5g_v®
;

906 
u8
 
	mcÚfig_subsüibe_sid_b—cÚ
;

907 
u32
 
	msubsüibe_sid_b—cÚ_v®
;

910 
u8
 
	mcÚfig_2dÙ4g_dw_bªd
;

911 
u32
 
	mdw_2dÙ4g_š‹rv®_v®
;

912 
u8
 
	mcÚfig_5g_dw_bªd
;

913 
u32
 
	mdw_5g_š‹rv®_v®
;

914 
u32
 
	mdisc_mac_addr_¿nd_š‹rv®_£c
;

917 
u16
 
	mşu¡”_low
;

918 
u16
 
	mşu¡”_high
;

920 
u8
 
	mcÚfig_suµÜt_5g
;

921 
u8
 
	msuµÜt_5g_v®
;

923 
u8
 
	mcÚfig_2dÙ4g_rssi_şo£
;

924 
u8
 
	mrssi_şo£_2dÙ4g_v®
;

926 
u8
 
	mcÚfig_2dÙ4g_rssi_middË
;

927 
u8
 
	mrssi_middË_2dÙ4g_v®
;

928 
u8
 
	mcÚfig_hİ_couÁ_lim™
;

929 
u8
 
	mhİ_couÁ_lim™_v®
;

931 
u8
 
	mcÚfig_2dÙ4g_suµÜt
;

932 
u8
 
	msuµÜt_2dÙ4g_v®
;

934 
u8
 
	mcÚfig_2dÙ4g_b—cÚs
;

935 
u8
 
	mb—cÚ_2dÙ4g_v®
;

936 
u8
 
	mcÚfig_2dÙ4g_sdf
;

937 
u8
 
	msdf_2dÙ4g_v®
;

938 
u8
 
	mcÚfig_5g_b—cÚs
;

939 
u8
 
	mb—cÚ_5g_v®
;

940 
u8
 
	mcÚfig_5g_sdf
;

941 
u8
 
	msdf_5g_v®
;

942 
u8
 
	mcÚfig_5g_rssi_şo£
;

943 
u8
 
	mrssi_şo£_5g_v®
;

944 
u8
 
	mcÚfig_5g_rssi_middË
;

945 
u8
 
	mrssi_middË_5g_v®
;

948 
u8
 
	mcÚfig_oui
;

949 
u32
 
	moui_v®
;

950 
u8
 
	mcÚfig_štf_addr
;

951 
u8
 
	mštf_addr_v®
[
ETH_ALEN
];

954 
u8
 
	mcÚfig_24g_chªÃl
;

955 
u32
 
	mchªÃl_24g_v®
;

957 
u32
 
	mdiscov”y_b—cÚ_š‹rv®_ms
;

958 
u32
 
	mnss_discov”y
;

959 
u32
 
	m’abË_dw_—¾y_‹rmš©iÚ
;

960 
u32
 
	m’abË_¿ngšg
;

963 
	s¦si_h®_Çn_d©a_·th_cfg
 {

964 
u8
 
	m£cur™y_cfg
;

965 
u8
 
	mqos_cfg
;

968 
	s¦si_h®_Çn_d©a_·th_­p_šfo
 {

969 
u16
 
	mndp_­p_šfo_Ën
;

970 
u8
 
	mndp_­p_šfo
[
SLSI_HAL_NAN_DP_MAX_APP_INFO_LEN
];

973 
	s¦si_h®_Çn_d©a_·th_š™ŸtÜ_»q
 {

974 
u16
 
	mŒª§ùiÚ_id
;

975 
u32
 
	m»que¡Ü_š¡ªû_id
;

976 
u8
 
	mchªÃl_»que¡_ty³
;

977 
u32
 
	mchªÃl
;

978 
u8
 
	m³”_disc_mac_addr
[
ETH_ALEN
];

979 
	mndp_içû
[
IFNAMSIZ
 + 1];

980 
¦si_h®_Çn_d©a_·th_cfg
 
	mndp_cfg
;

981 
¦si_h®_Çn_d©a_·th_­p_šfo
 
	m­p_šfo
;

982 
¦si_Çn_£cur™y_šfo
 
	mkey_šfo
;

983 
u32
 
	m£rviû_Çme_Ën
;

984 
u8
 
	m£rviû_Çme
[
SLSI_HAL_NAN_MAX_SERVICE_NAME_LEN
];

987 
	s¦si_h®_Çn_d©a_·th_šdiÿtiÚ_»¥Ú£
 {

988 
u16
 
	mŒª§ùiÚ_id
;

989 
u32
 
	mndp_š¡ªû_id
;

990 
	mndp_içû
[
IFNAMSIZ
 + 1];

991 
¦si_h®_Çn_d©a_·th_cfg
 
	mndp_cfg
;

992 
¦si_h®_Çn_d©a_·th_­p_šfo
 
	m­p_šfo
;

993 
u32
 
	mr¥_code
;

994 
¦si_Çn_£cur™y_šfo
 
	mkey_šfo
;

995 
u8
 
	m£rviû_Çme_Ën
;

996 
u8
 
	m£rviû_Çme
[
SLSI_HAL_NAN_MAX_SERVICE_NAME_LEN
];

999 
	s¦si_h®_Çn_d©a_’d
 {

1000 
u16
 
	mŒª§ùiÚ_id
;

1001 
u8
 
	mnum_ndp_š¡ªûs
;

1002 
u32
 
	mndp_š¡ªû_id
[
SLSI_NAN_MAX_NDP_INSTANCES
];

1005 
	s¦si_h®_Çn_ÿ·b™›s
 {

1006 
u32
 
	mmax_cÚcu¼’t_Çn_şu¡”s
;

1007 
u32
 
	mmax_publishes
;

1008 
u32
 
	mmax_subsüibes
;

1009 
u32
 
	mmax_£rviû_Çme_Ën
;

1010 
u32
 
	mmax_m©ch_f‹r_Ën
;

1011 
u32
 
	mmax_tÙ®_m©ch_f‹r_Ën
;

1012 
u32
 
	mmax_£rviû_¥ecific_šfo_Ën
;

1013 
u32
 
	mmax_v§_d©a_Ën
;

1014 
u32
 
	mmax_mesh_d©a_Ën
;

1015 
u32
 
	mmax_ndi_š‹rçûs
;

1016 
u32
 
	mmax_ndp_£ssiÚs
;

1017 
u32
 
	mmax_­p_šfo_Ën
;

1018 
u32
 
	mmax_queued_Œªsm™_fŞlowup_msgs
;

1019 
u32
 
	mndp_suµÜ‹d_bªds
;

1020 
u32
 
	mch”_su™es_suµÜ‹d
;

1021 
u32
 
	mmax_scid_Ën
;

1022 
boŞ
 
	mis_ndp_£cur™y_suµÜ‹d
;

1023 
u32
 
	mmax_sd—_£rviû_¥ecific_šfo_Ën
;

1024 
u32
 
	mmax_subsüibe_add»ss
;

1025 
u32
 
	mnd³_©Œ_suµÜ‹d
;

1028 
	s¦si_h®_Çn_fŞlowup_šd
 {

1029 
u16
 
	mpublish_subsüibe_id
;

1030 
u32
 
	m»que¡Ü_š¡ªû_id
;

1031 
u8
 
	maddr
[
ETH_ALEN
];

1032 
u8
 
	mdw_Ü_çw
;

1033 
u16
 
	m£rviû_¥ecific_šfo_Ën
;

1034 
u8
 
	m£rviû_¥ecific_šfo
[
SLSI_HAL_NAN_MAX_SERVICE_SPECIFIC_INFO_LEN
];

1035 
u16
 
	msd—_£rviû_¥ecific_šfo_Ën
;

1036 
u8
 
	msd—_£rviû_¥ecific_šfo
[
SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
];

1039 
	s¦si_h®_Çn_m©ch_šd
 {

1040 
u16
 
	mpublish_subsüibe_id
;

1041 
u32
 
	m»que¡Ü_š¡ªû_id
;

1042 
u8
 
	maddr
[
ETH_ALEN
];

1043 
u16
 
	m£rviû_¥ecific_šfo_Ën
;

1044 
u8
 
	m£rviû_¥ecific_šfo
[
SLSI_HAL_NAN_MAX_SERVICE_SPECIFIC_INFO_LEN
];

1045 
u16
 
	msdf_m©ch_f‹r_Ën
;

1046 
u8
 
	msdf_m©ch_f‹r
[
SLSI_HAL_NAN_MAX_MATCH_FILTER_LEN
];

1047 
u8
 
	mm©ch_occu¼ed_æag
;

1048 
u8
 
	mout_of_»sourû_æag
;

1049 
u8
 
	mrssi_v®ue
;

1050 
u8
 
	mis_cÚn_ÿ·b™y_v®id
;

1051 
¦si_h®_Çn_cÚÃùiv™y_ÿ·b™y
 
	mcÚn_ÿ·b™y
;

1052 
u8
 
	mnum_rx_discov”y_©Œ
;

1053 
¦si_h®_Çn_»ûive_po¡_discov”y
 
	mdiscov”y_©Œ
[
SLSI_HAL_NAN_MAX_POSTDISCOVERY_LEN
];

1054 
u8
 
	mnum_chªs
;

1055 
¦si_h®_Çn_fu¹h”_avaab™y_chªÃl
 
	mçmchª
[32];

1056 
u8
 
	mşu¡”_©Œibu‹_Ën
;

1057 
u8
 
	mşu¡”_©Œibu‹
[32];

1058 
¦si_Çn_£cur™y_šfo
 
	m£c_šfo
;

1059 
¦si_Çn_sd—_ù¾_·¿ms
 
	m³”_sd—_·¿ms
;

1060 
u32
 
	m¿nge_m—su»m’t_mm
;

1061 
u32
 
	m¿ngšg_ev’t_ty³
;

1062 
u16
 
	msd—_£rviû_¥ecific_šfo_Ën
;

1063 
u8
 
	msd—_£rviû_¥ecific_šfo
[
SLSI_HAL_NAN_MAX_SDEA_SERVICE_SPEC_INFO_LEN
];

1066 
	s¦si_h®_Çn_chªÃl_šfo
 {

1067 
u32
 
	mchªÃl
;

1068 
u32
 
	mbªdwidth
;

1069 
u32
 
	mnss
;

1072 
	s¦si_Çn_d©a_·th_»que¡_šd
 {

1073 
u16
 
	m£rviû_š¡ªû_id
;

1074 
u8
 
	m³”_disc_mac_addr
[
ETH_ALEN
];

1075 
u32
 
	mndp_š¡ªû_id
;

1076 
¦si_h®_Çn_d©a_·th_cfg
 
	mndp_cfg
;

1077 
¦si_h®_Çn_d©a_·th_­p_šfo
 
	m­p_šfo
;

1080 
	#SLSI_HAL_NAN_MAX_CHANNEL_INFO_SUPPORTED
 4

	)

1081 
	s¦si_h®_Çn_d©a_·th_cÚfœm_šd
 {

1082 
u32
 
	mndp_š¡ªû_id
;

1083 
u8
 
	m³”_ndi_mac_addr
[
ETH_ALEN
];

1084 
¦si_h®_Çn_d©a_·th_­p_šfo
 
	m­p_šfo
;

1085 
u32
 
	mr¥_code
;

1086 
u32
 
	m»asÚ_code
;

1087 
u32
 
	mnum_chªÃls
;

1088 
¦si_h®_Çn_chªÃl_šfo
 
	mchªÃl_šfo
[
SLSI_HAL_NAN_MAX_CHANNEL_INFO_SUPPORTED
];

1091 
	s¦si_h®_Çn_d©a_·th_’d_šd
 {

1092 
u8
 
	mnum_ndp_š¡ªûs
;

1093 
u32
 
	mndp_š¡ªû_id
[
SLSI_NAN_MAX_NDP_INSTANCES
];

1096 
¦si_Çn_ev’t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1097 
¦si_Çn_fŞlowup_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1098 
¦si_Çn_£rviû_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1099 
¦si_Çn_g‘_mac
(
¦si_dev
 *
sdev
, *
Çn_mac_addr
);

1100 
Ãt_deviû
 *
¦si_Çn_g‘_Ãtdev
(
¦si_dev
 *
sdev
);

1101 
¦si_Çn_’abË
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1102 
¦si_Çn_di§bË
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1103 
¦si_Çn_publish
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1104 
¦si_Çn_publish_ÿnûl
(
why
 *why, 
wœ–ess_dev
 *
wdev
,

1105 cÚ¡ *
d©a
, 
Ën
);

1106 
¦si_Çn_subsüibe
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1107 
¦si_Çn_subsüibe_ÿnûl
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1108 
¦si_Çn_Œªsm™_fŞlowup
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1109 
¦si_Çn_£t_cÚfig
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1110 
¦si_Çn_g‘_ÿ·b™›s
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1111 
¦si_Çn_£nd_di§bËd_ev’t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
»asÚ
);

1112 
¦si_Çn_d©a_içû_ü—‹
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1113 
¦si_Çn_d©a_içû_d–‘e
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1114 
¦si_Çn_ndp_š™Ÿ‹
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1115 
¦si_Çn_ndp_»¥Úd
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1116 
¦si_Çn_ndp_’d
(
why
 *why, 
wœ–ess_dev
 *
wdev
, cÚ¡ *
d©a
, 
Ën
);

1117 
¦si_Çn_ndp_Ãw_’Œy
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
ndp_š¡ªû_id
,

1118 
u16
 
ndl_vif_id
, 
u8
 *
loÿl_ndi
, u8 *
³”_nmi
);

1119 
¦si_Çn_ndp_d–_’Œy
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u32
 
ndp_š¡ªû_id
, cÚ¡ 
boŞ
 
ndl_vif_locked
);

1120 
¦si_Çn_ndp_£tup_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
boŞ
 
is_»q_šd
);

1121 
¦si_Çn_ndp_»que¡ed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1122 
¦si_Çn_ndp_‹rmš©iÚ_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1123 
u32
 
¦si_Çn_g‘_ndp_äom_ndl_loÿl_ndi
(
Ãt_deviû
 *
dev
, 
u16
 
ndl_vif_id
, 
u8
 *
loÿl_ndi
);

1124 
¦si_Çn_d–_³”
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
loÿl_ndi
, 
u16
 
ndp_š¡ªû_id
);

1125 
¦si_Çn_ndp_‹rmš©iÚ_hªdËr
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
ndp_š¡ªû_id
, 
u8
 *
ndi
);

1126 
¦si_Çn_push_fŞlowup_ids
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
m©ch_id
, u16 
Œªs_id
);

1127 
¦si_Çn_pİ_fŞlowup_ids
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
m©ch_id
);

1128 
¦si_rx_Çn_¿nge_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

1129 
¦si_£nd_Çn_¿nge_ÿnûl
(
¦si_dev
 *
sdev
);

1130 
¦si_£nd_Çn_¿nge_cÚfig
(
¦si_dev
 *
sdev
, 
u8
 
couÁ
, 
¦si_¹t_cÚfig
 *
Æ_¹t_·¿ms
, 
¹t_id
);

	@porting_imx.h

9 #iâdeà
_PORTING_IMX__H__


10 
	#_PORTING_IMX__H__


	)

19 
šlše
 
	$‘h”_addr_cİy
(
u8
 *
d¡
, cÚ¡ u8 *
¤c
)

21 #ià
	`defšed
(
CONFIG_HAVE_EFFICIENT_UNALIGNED_ACCESS
)

22 *(
u32
 *)
d¡
 = *(cÚ¡ u32 *)
¤c
;

23 *(
u16
 *)(
d¡
 + 4èğ*(cÚ¡ u16 *)(
¤c
 + 4);

25 
u16
 *
a
 = (u16 *)
d¡
;

26 cÚ¡ 
u16
 *
b
 = (cÚ¡ u16 *)
¤c
;

28 
a
[0] = 
b
[0];

29 
a
[1] = 
b
[1];

30 
a
[2] = 
b
[2];

32 
	}
}

34 
šlše
 
ktime_t
 
	$ktime_add_ms
(cÚ¡ 
ktime_t
 
kt
, cÚ¡ 
u64
 
m£c
)

36  
	`ktime_add_ns
(
kt
, 
m£c
 * 
NSEC_PER_MSEC
);

37 
	}
}

	@procfs.c

7 
	~"dev.h
"

8 
	~"´ocfs.h
"

9 
	~"debug.h
"

10 
	~"mlme.h
"

11 
	~"mgt.h
"

12 
	~"mib.h
"

13 
	~"ÿc.h
"

14 
	~"h.h
"

15 
	~"Ãtif.h
"

16 
	~"ioùl.h
"

17 
	~"Æ80211_v’dÜ.h
"

19 
	~"mib.h
"

21 
	$¦si_´ocfs_İ’_fe_g’”ic
(
šode
 *šode, 
fe
 *file)

23 
fe
->
´iv©e_d©a
 = 
	`SLSI_PDE_DATA
(
šode
);

25 
	}
}

27 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


28 
	$¦si_´štf_mu‹x_¡©s
(*
buf
, cÚ¡ 
size_t
 
bufsz
, cÚ¡ *
´štf_·ddšg
, 
¦si_mu‹x
 *
mu‹x_p
)

30 
pos
 = 0;

31 cÚ¡ *
f’ame
;

32 
boŞ
 
is_locked
;

34 ià(
mu‹x_p
->
v®id
) {

35 
is_locked
 = 
	`SLSI_MUTEX_IS_LOCKED
(*
mu‹x_p
);

36 
pos
 +ğ
	`sú´štf
(
buf
, 
bufsz
, "INFO:†ock:%d\n", 
is_locked
);

37 ià(
is_locked
) {

38 
f’ame
 = 
	`¡¼chr
(
mu‹x_p
->
fe_Çme_befÜe
, '/');

39 ià(
f’ame
)

40 
f’ame
++;

42 
f’ame
 = 
mu‹x_p
->
fe_Çme_befÜe
;

43 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\t%sTryšgToAcquœe:%s:%d\n", 
´štf_·ddšg
,

44 
f’ame
, 
mu‹x_p
->
lše_no_befÜe
);

45 
f’ame
 = 
	`¡¼chr
(
mu‹x_p
->
fe_Çme_aá”
, '/');

46 ià(
f’ame
)

47 
f’ame
++;

49 
f’ame
 = 
mu‹x_p
->
fe_Çme_aá”
;

50 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\t%sAcquœed:%s:%d:%s\n", 
´štf_·ddšg
,

51 
f’ame
, 
mu‹x_p
->
lše_no_aá”
, mu‹x_p->
funùiÚ
);

52 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\t%sProûssName:%s\n", 
´štf_·ddšg
, 
mu‹x_p
->
owÃr
->
comm
);

55 
pos
 +ğ
	`sú´štf
(
buf
, 
bufsz
, "NoInit\n");

57  
pos
;

58 
	}
}

60 
ssize_t
 
	$¦si_´ocfs_mu‹x_¡©s_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

62 
buf
[76 + (200 * 
CONFIG_SCSC_WLAN_MAX_INTERFACES
)];

63 
pos
 = 0;

64 
i
;

65 cÚ¡ 
size_t
 
bufsz
 = (
buf
);

66 
¦si_dev
 *
sdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

67 
Ãt_deviû
 *
dev
;

68 
Ãtdev_vif
 *
ndev_vif
;

70 
	`SLSI_UNUSED_PARAMETER
(
fe
);

72 
pos
 +ğ
	`sú´štf
(
buf
, 
bufsz
, "sdev\n");

73 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\tnetdev_add_remove_mutex ");

74 
pos
 +ğ
	`¦si_´štf_mu‹x_¡©s
(
buf
 +…os, 
bufsz
 -…os, "\t", &
sdev
->
Ãtdev_add_»move_mu‹x
);

75 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\tstart_stop_mutex ");

76 
pos
 +ğ
	`¦si_´štf_mu‹x_¡©s
(
buf
 +…os, 
bufsz
 -…os, "\t", &
sdev
->
¡¬t_¡İ_mu‹x
);

77 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\tdevice_config_mutex ");

78 
pos
 +ğ
	`¦si_´štf_mu‹x_¡©s
(
buf
 +…os, 
bufsz
 -…os, "\t", &
sdev
->
deviû_cÚfig_mu‹x
);

79 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\tsig_wait.mutex ");

80 
pos
 +ğ
	`¦si_´štf_mu‹x_¡©s
(
buf
 +…os, 
bufsz
 -…os, "\t", &
sdev
->
sig_wa™
.
mu‹x
);

81 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_LOGGING


82 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\tlogger_mutex ");

83 
pos
 +ğ
	`¦si_´štf_mu‹x_¡©s
(
buf
 +…os, 
bufsz
 -…os, "\t", &
sdev
->
logg”_mu‹x
);

86 
i
 = 1; i < 
CONFIG_SCSC_WLAN_MAX_INTERFACES
 + 1; i++) {

87 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "Ãtdevvià%d\n", 
i
);

88 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
i
);

89 ià(!
dev
)

91 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

92 ià(
ndev_vif
->
is_avaabË
) {

93 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\tvif_mutex ");

94 
pos
 +ğ
	`¦si_´štf_mu‹x_¡©s
(
buf
 +…os, 
bufsz
 -…os, "\t\t", &
ndev_vif
->
vif_mu‹x
);

95 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\tsig_wait.mutex ");

96 
pos
 +ğ
	`¦si_´štf_mu‹x_¡©s
(
buf
 +…os, 
bufsz
 -…os, "\t\t", &
ndev_vif
->
sig_wa™
.
mu‹x
);

97 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\tscan_mutex ");

98 
pos
 +ğ
	`¦si_´štf_mu‹x_¡©s
(
buf
 +…os, 
bufsz
 -…os, "\t\t", &
ndev_vif
->
sÿn_mu‹x
);

100 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "\tvif UNAVAILABLE\n");

103  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
buf
, 
pos
);

104 
	}
}

107 
ssize_t
 
	$¦si_´ocfs_throughput_¡©s_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

109 
buf
[5 * 25];

110 
pos
 = 0;

111 cÚ¡ 
size_t
 
bufsz
 = (
buf
);

112 
¦si_dev
 *
sdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

113 
Ãt_deviû
 *
dev
;

114 
Ãtdev_vif
 *
ndev_vif
;

115 
¦si_mib_d©a
 
mibr¥
 = { 0, 
NULL
 };

116 
¦si_mib_v®ue
 *
v®ues
 = 
NULL
;

117 
¦si_mib_g‘_’Œy
 
g‘_v®ues
[] = {{ 
SLSI_PSID_UNIFI_THROUGHPUT_DEBUG
, { 3, 0 } },

118 { 
SLSI_PSID_UNIFI_THROUGHPUT_DEBUG
, { 4, 0 } },

119 { 
SLSI_PSID_UNIFI_THROUGHPUT_DEBUG
, { 5, 0 } },

120 { 
SLSI_PSID_UNIFI_THROUGHPUT_DEBUG
, { 25, 0 } },

121 { 
SLSI_PSID_UNIFI_THROUGHPUT_DEBUG
, { 30, 0 } } };

123 
	`SLSI_UNUSED_PARAMETER
(
fe
);

125 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 1);

126 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

128 ià(
ndev_vif
->
aùiv©ed
) {

129 
mibr¥
.
d©aL’gth
 = 15 * 
	`ARRAY_SIZE
(
g‘_v®ues
);

130 
mibr¥
.
d©a
 = 
	`km®loc
(mibr¥.
d©aL’gth
, 
GFP_KERNEL
);

131 ià(!
mibr¥
.
d©a
)

132 
	`SLSI_ERR
(
sdev
, "CªnÙ km®loø%d by‹s\n", 
mibr¥
.
d©aL’gth
);

133 
v®ues
 = 
	`¦si_»ad_mibs
(
sdev
, 
dev
, 
g‘_v®ues
, 
	`ARRAY_SIZE
(g‘_v®ues), &
mibr¥
);

134 ià(!
v®ues
) {

135 
	`kä“
(
mibr¥
.
d©a
);

136  -
EINVAL
;

138 ià(
v®ues
[0].
ty³
 !ğ
SLSI_MIB_TYPE_UINT
)

139 
	`SLSI_ERR
(
sdev
, "invalidype. iter:%d", 0);

140 ià(
v®ues
[1].
ty³
 !ğ
SLSI_MIB_TYPE_UINT
)

141 
	`SLSI_ERR
(
sdev
, "invalidype. iter:%d", 1);

142 ià(
v®ues
[2].
ty³
 !ğ
SLSI_MIB_TYPE_UINT
)

143 
	`SLSI_ERR
(
sdev
, "invalidype. iter:%d", 2);

144 ià(
v®ues
[3].
ty³
 !ğ
SLSI_MIB_TYPE_UINT
)

145 
	`SLSI_ERR
(
sdev
, "invalidype. iter:%d", 3);

146 ià(
v®ues
[4].
ty³
 !ğ
SLSI_MIB_TYPE_UINT
)

147 
	`SLSI_ERR
(
sdev
, "invalidype. iter:%d", 4);

149 
pos
 +ğ
	`sú´štf
(
buf
, 
bufsz
, "RX FCS: %d\n", 
v®ues
[0].
u
.
uštV®ue
);

150 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "RX bad SIG: %d\n", 
v®ues
[3].
u
.
uštV®ue
);

151 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "RX dÙ11ƒ¼Ü: %d\n", 
v®ues
[4].
u
.
uštV®ue
);

152 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "TX MPDU‚ØACK: %d\n", 
v®ues
[2].
u
.
uštV®ue
);

153 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "TX A-MPDU‚ØACK: %d\n", 
v®ues
[1].
u
.
uštV®ue
);

155 
	`kä“
(
v®ues
);

156 
	`kä“
(
mibr¥
.
d©a
);

158 
pos
 +ğ
	`sú´štf
(
buf
, 
bufsz
, "RX FCS: %d\n", 0);

159 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "RX bad SIG: %d\n", 0);

160 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "RX dot11ƒrror: %d\n", 0);

161 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "TX MPDU‚o ACK: %d\n", 0);

162 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "TX A-MPDU‚o ACK: %d\n", 0);

165  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
buf
, 
pos
);

166 
	}
}

168 
ssize_t
 
	$¦si_´ocfs_¡a_bss_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

170 
buf
[100];

171 
pos
;

172 cÚ¡ 
size_t
 
bufsz
 = (
buf
);

173 
¦si_dev
 *
sdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

174 
Ãt_deviû
 *
dev
;

175 
Ãtdev_vif
 *
ndev_vif
;

176 
cfg80211_bss
 *
¡a_bss
;

177 
chªÃl
 = 0, 
ûÁ”_äeq
 = 0;

178 
u8
 
no_mac
[] = {0, 0, 0, 0, 0, 0};

179 
u8
 *
mac_±r
;

180 
u8
 
ssid
[33];

181 
s32
 
sigÇl
 = 0;

183 
	`SLSI_UNUSED_PARAMETER
(
fe
);

185 
mac_±r
 = 
no_mac
;

186 
ssid
[0] = 0;

188 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 1);

189 ià(!
dev
)

190 
ex™
;

192 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

194 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

195 
¡a_bss
 = 
ndev_vif
->
¡a
.sta_bss;

196 ià(
¡a_bss
 && 
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

197 
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
) {

198 cÚ¡ 
u8
 *
ssid_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
¡a_bss
->
›s
->
d©a
, s_bss->›s->
Ën
);

200 ià(
ssid_›
) {

201 
	`memıy
(
ssid
, &
ssid_›
[2], ssid_ie[1]);

202 
ssid
[
ssid_›
[1]] = 0;

205 ià(
¡a_bss
->
chªÃl
) {

206 
chªÃl
 = 
¡a_bss
->chªÃl->
hw_v®ue
;

207 
ûÁ”_äeq
 = 
¡a_bss
->
chªÃl
->center_freq;

209 
mac_±r
 = 
¡a_bss
->
bssid
;

210 
sigÇl
 = 
¡a_bss
->signal;

212 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

214 
ex™
:

215 
pos
 = 
	`sú´štf
(
buf
, 
bufsz
, "%pM,%s,%d,%d,%d", 
mac_±r
, 
ssid
, 
chªÃl
, 
ûÁ”_äeq
, 
sigÇl
);

216  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
buf
, 
pos
);

217 
	}
}

219 
ssize_t
 
	$¦si_´ocfs_big_d©a_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

221 
buf
[100];

222 
pos
;

223 cÚ¡ 
size_t
 
bufsz
 = (
buf
);

224 
¦si_dev
 *
sdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

225 
Ãt_deviû
 *
dev
;

227 
	`SLSI_UNUSED_PARAMETER
(
fe
);

228 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 1);

229 ià(!
dev
)

230 
ex™
;

232 
pos
 = 
	`¦si_g‘_¡a_šfo
(
dev
, 
buf
, 
bufsz
);

233 ià(
pos
 >= 0)

234  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
buf
, 
pos
);

235 
ex™
:

237 
	}
}

239 
	$¦si_´ocfs_¡©us_show
(
£q_fe
 *
m
, *
v
)

241 
¦si_dev
 *
sdev
 = (¦si_dev *)
m
->
´iv©e
;

242 cÚ¡ *
¡©e
;

243 
u32
 
cÚf_h4_v”
 = 0;

244 
i
;

246 
	`SLSI_UNUSED_PARAMETER
(
v
);

248 
sdev
->
deviû_¡©e
) {

249 
SLSI_DEVICE_STATE_ATTACHING
:

250 
¡©e
 = "Attaching";

252 
SLSI_DEVICE_STATE_STOPPED
:

253 
¡©e
 = "Stopped";

255 
SLSI_DEVICE_STATE_STARTING
:

256 
¡©e
 = "Starting";

258 
SLSI_DEVICE_STATE_STARTED
:

259 
¡©e
 = "Started";

261 
SLSI_DEVICE_STATE_STOPPING
:

262 
¡©e
 = "Stopping";

265 
¡©e
 = "UNKNOWN";

269 
	`£q_´štf
(
m
, "Driv” FAPI V”siÚ: MA SAP : %d.%d.%d\n", 
	`FAPI_MAJOR_VERSION
(
FAPI_DATA_SAP_VERSION
),

270 
	`FAPI_MINOR_VERSION
(
FAPI_DATA_SAP_VERSION
), 
FAPI_DATA_SAP_ENG_VERSION
);

271 
	`£q_´štf
(
m
, "Driv” FAPI V”siÚ: MLME SAP : %d.%d.%d\n", 
	`FAPI_MAJOR_VERSION
(
FAPI_CONTROL_SAP_VERSION
),

272 
	`FAPI_MINOR_VERSION
(
FAPI_CONTROL_SAP_VERSION
), 
FAPI_CONTROL_SAP_ENG_VERSION
);

273 
	`£q_´štf
(
m
, "Driv” FAPI V”siÚ: DEBUG SAP : %d.%d.%d\n", 
	`FAPI_MAJOR_VERSION
(
FAPI_DEBUG_SAP_VERSION
),

274 
	`FAPI_MINOR_VERSION
(
FAPI_DEBUG_SAP_VERSION
), 
FAPI_DEBUG_SAP_ENG_VERSION
);

275 
	`£q_´štf
(
m
, "Driv” FAPI V”siÚ: TEST SAP : %d.%d.%d\n", 
	`FAPI_MAJOR_VERSION
(
FAPI_TEST_SAP_VERSION
),

276 
	`FAPI_MINOR_VERSION
(
FAPI_TEST_SAP_VERSION
), 
FAPI_TEST_SAP_ENG_VERSION
);

278 ià(
	`©omic_»ad
(&
sdev
->
h
.
h_¡©e
è=ğ
SLSI_HIP_STATE_STARTED
) {

279 
cÚf_h4_v”
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
š™
);

280 
	`£q_´štf
(
m
, "HIP4 V”siÚ : %d\n", 
cÚf_h4_v”
);

281 ià(
cÚf_h4_v”
 == 4) {

282 
	`£q_´štf
(
m
, "Chip FAPI Version (v4): MA SAP : %d.%d\n",

283 
	`FAPI_MAJOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_ma_v”
)),

284 
	`FAPI_MINOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_ma_v”
)));

285 
	`£q_´štf
(
m
, "Chip FAPI Version (v4): MLME SAP : %d.%d\n",

286 
	`FAPI_MAJOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_mlme_v”
)),

287 
	`FAPI_MINOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_mlme_v”
)));

288 
	`£q_´štf
(
m
, "Chip FAPI Version (v4): DEBUG SAP : %d.%d\n",

289 
	`FAPI_MAJOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_debug_v”
)),

290 
	`FAPI_MINOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_debug_v”
)));

291 
	`£q_´štf
(
m
, "Chip FAPI Version (v4): TEST SAP : %d.%d\n",

292 
	`FAPI_MAJOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_‹¡_v”
)),

293 
	`FAPI_MINOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_‹¡_v”
)));

294 } ià(
cÚf_h4_v”
 == 5) {

295 
	`£q_´štf
(
m
, "Chip FAPI Version (v5): MA SAP : %d.%d\n",

296 
	`FAPI_MAJOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_ma_v”
)),

297 
	`FAPI_MINOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_ma_v”
)));

298 
	`£q_´štf
(
m
, "Chip FAPI Version (v5): MLME SAP : %d.%d\n",

299 
	`FAPI_MAJOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_mlme_v”
)),

300 
	`FAPI_MINOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_mlme_v”
)));

301 
	`£q_´štf
(
m
, "Chip FAPI Version (v5): DEBUG SAP : %d.%d\n",

302 
	`FAPI_MAJOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_debug_v”
)),

303 
	`FAPI_MINOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_debug_v”
)));

304 
	`£q_´štf
(
m
, "Chip FAPI Version (v5): TEST SAP : %d.%d\n",

305 
	`FAPI_MAJOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_‹¡_v”
)),

306 
	`FAPI_MINOR_VERSION
(
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_5_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v5
, 
§p_‹¡_v”
)));

310 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


311 
	`£q_puts
(
m
, "Driver Debug : Enabled\n");

313 
	`£q_puts
(
m
, "Driver Debug : Disabled\n");

315 
	`£q_´štf
(
m
, "Driv” S‹ : %s\n", 
¡©e
);

317 
	`£q_´štf
(
m
, "HW V”siÚ [MIB] : 0x%.4X (%u)\n", 
sdev
->
ch_šfo_mib
.
ch_v”siÚ
, sdev->chip_info_mib.chip_version);

318 
	`£q_´štf
(
m
, "PÏtfÜm Bud [MIB] : 0x%.4X (%u)\n", 
sdev
->
¶©_šfo_mib
.
¶©_bud
, sdev->plat_info_mib.plat_build);

319 
i
 = 0; i < 
SLSI_WLAN_MAX_MIB_FILE
; i++) {

320 
	`£q_´štf
(
m
, "Hash [MIB%2d] : 0x%.4X (%u)\n", 
i
, 
sdev
->
mib
[i].
mib_hash
, sdev->mib[i].mib_hash);

321 
	`£q_´štf
(
m
, "PÏtfÜm: [MIB%2d] : %s\n", 
i
, 
sdev
->
mib
[i].
¶©fÜm
);

323 
	`£q_´štf
(
m
, "Hash [loÿl_MIB] : 0x%.4X (%u)\n", 
sdev
->
loÿl_mib
.
mib_hash
, sdev->local_mib.mib_hash);

324 
	`£q_´štf
(
m
, "PÏtfÜm: [loÿl_MIB] : %s\n", 
sdev
->
loÿl_mib
.
¶©fÜm
);

327 
	}
}

329 
	$¦si_´ocfs_bud_show
(
£q_fe
 *
m
, *
v
)

331 
	`SLSI_UNUSED_PARAMETER
(
v
);

332 
	`£q_´štf
(
m
, "FAPI_DATA_SAP_VERSION : %d.%d.%d\n",

333 
	`FAPI_MAJOR_VERSION
(
FAPI_DATA_SAP_VERSION
),

334 
	`FAPI_MINOR_VERSION
(
FAPI_DATA_SAP_VERSION
),

335 
FAPI_DATA_SAP_ENG_VERSION
);

336 
	`£q_´štf
(
m
, "FAPI_CONTROL_SAP_VERSION : %d.%d.%d\n",

337 
	`FAPI_MAJOR_VERSION
(
FAPI_CONTROL_SAP_VERSION
),

338 
	`FAPI_MINOR_VERSION
(
FAPI_CONTROL_SAP_VERSION
),

339 
FAPI_CONTROL_SAP_ENG_VERSION
);

340 
	`£q_´štf
(
m
, "FAPI_DEBUG_SAP_VERSION : %d.%d.%d\n",

341 
	`FAPI_MAJOR_VERSION
(
FAPI_DEBUG_SAP_VERSION
),

342 
	`FAPI_MINOR_VERSION
(
FAPI_DEBUG_SAP_VERSION
),

343 
FAPI_DEBUG_SAP_ENG_VERSION
);

344 
	`£q_´štf
(
m
, "FAPI_TEST_SAP_VERSION : %d.%d.%d\n",

345 
	`FAPI_MAJOR_VERSION
(
FAPI_TEST_SAP_VERSION
),

346 
	`FAPI_MINOR_VERSION
(
FAPI_TEST_SAP_VERSION
),

347 
FAPI_TEST_SAP_ENG_VERSION
);

348 
	`£q_´štf
(
m
, "CONFIG_SCSC_WLAN_MAX_INTERFACES : %d\n", 
CONFIG_SCSC_WLAN_MAX_INTERFACES
);

349 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


350 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_RX_NAPI : y\n");

352 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_RX_NAPI :‚\n");

354 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI_GRO


355 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_RX_NAPI_GRO : y\n");

357 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_RX_NAPI_GRO :‚\n");

359 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


360 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_ANDROID : y\n");

362 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_ANDROID :‚\n");

364 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


365 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_GSCAN_ENABLE : y\n");

367 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_GSCAN_ENABLE :‚\n");

369 #ifdeà
CONFIG_SCSC_WLAN_KEY_MGMT_OFFLOAD


370 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_KEY_MGMT_OFFLOAD : y\n");

372 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_KEY_MGMT_OFFLOAD :‚\n");

374 #ifdeà
CONFIG_SCSC_WLAN_PRIORITISE_IMP_FRAMES


375 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_PRIORITISE_IMP_FRAMES : y\n");

377 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_PRIORITISE_IMP_FRAMES :‚\n");

379 
	`£q_puts
(
m
, "-------------------------------------------------\n");

380 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


381 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_DEBUG : y\n");

383 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_DEBUG :‚\n");

385 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


386 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_MUTEX_DEBUG : y\n");

388 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_MUTEX_DEBUG :‚\n");

390 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_LOGGING


391 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_ENHANCED_LOGGING : y\n");

393 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_ENHANCED_LOGGING :‚\n");

395 #ifdeà
CONFIG_SCSC_WLAN_WIFI_SHARING


396 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_WIFI_SHARING : y\n");

398 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_WIFI_SHARING :‚\n");

400 #ifdeà
CONFIG_SCSC_WLAN_SINGLE_ANTENNA


401 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_SINGLE_ANTENNA : y\n");

403 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_SINGLE_ANTENNA :‚\n");

405 #ifdeà
CONFIG_SCSC_AP_INTERFACE_NAME


406 
	`£q_´štf
(
m
, "CONFIG_SCSC_AP_INTERFACE_NAME : %s\n", 
CONFIG_SCSC_AP_INTERFACE_NAME
);

408 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


409 
	`£q_puts
(
m
, "CONFIG_SCSC_WIFI_NAN_ENABLE : y\n");

411 
	`£q_puts
(
m
, "CONFIG_SCSC_WIFI_NAN_ENABLE :‚\n");

413 #ifdeà
CONFIG_SCSC_WLAN_RTT


414 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_RTT : y\n");

416 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_RTT :‚\n");

418 #ifdeà
CONFIG_SCSC_WLAN_SET_PREFERRED_ANTENNA


419 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_SET_PREFERRED_ANTENNA : y\n");

421 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_SET_PREFERRED_ANTENNA :‚\n");

423 #ià
	`defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

424 
	`£q_puts
(
m
, "CONFIG_SLSI_WLAN_STA_FWD_BEACON : y\n");

426 
	`£q_puts
(
m
, "CONFIG_SLSI_WLAN_STA_FWD_BEACON :‚\n");

428 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


429 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT : y\n");

431 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT :‚\n");

433 #ifdeà
CONFIG_SCSC_WLAN_DYNAMIC_ITO


434 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_DYNAMIC_ITO : y\n");

436 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_DYNAMIC_ITO :‚\n");

438 #ifdeà
CONFIG_SCSC_WLAN_AP_AUTO_RECOVERY


439 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_AP_AUTO_RECOVERY : y\n");

441 
	`£q_puts
(
m
, "CONFIG_SCSC_WLAN_AP_AUTO_RECOVERY :‚\n");

446 
	}
}

448 cÚ¡ *
	$¦si_´ocfs_vif_ty³_to_¡r
(
u16
 
ty³
)

450 
ty³
) {

451 
FAPI_VIFTYPE_STATION
:

453 
FAPI_VIFTYPE_AP
:

455 
FAPI_VIFTYPE_UNSYNCHRONISED
:

460 
	}
}

462 
	$¦si_´ocfs_vifs_show
(
£q_fe
 *
m
, *
v
)

464 
¦si_dev
 *
sdev
 = (¦si_dev *)
m
->
´iv©e
;

465 
u16
 
vif
;

466 
u16
 
³”_šdex
;

468 
	`SLSI_UNUSED_PARAMETER
(
v
);

470 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

471 
vif
 = 1; vià<ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; vif++) {

472 
Ãt_deviû
 *
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
vif
);

473 
Ãtdev_vif
 *
ndev_vif
;

475 ià(!
dev
)

478 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

479 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

481 ià(!
ndev_vif
->
aùiv©ed
) {

482 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

485 
	`£q_´štf
(
m
, "vif:%d %pM %s\n", 
vif
, 
dev
->
dev_addr
, 
	`¦si_´ocfs_vif_ty³_to_¡r
(
ndev_vif
->
vif_ty³
));

486 
³”_šdex
 = 0;…“r_šdex < 
SLSI_ADHOC_PEER_CONNECTIONS_MAX
;…eer_index++) {

487 
¦si_³”
 *
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
³”_šdex
];

489 ià(
³”
 &&…“r->
v®id
)

490 
	`£q_´štf
(
m
, "vif:%d %pM…“r[%d] %pM \n", 
vif
, 
dev
->
dev_addr
, 
³”_šdex
, 
³”
->
add»ss
);

492 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

494 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

497 
	}
}

499 
ssize_t
 
	$¦si_´ocfs_»ad_št
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
, 
v®ue
, cÚ¡ *
exŒa
)

501 
buf
[128];

502 
pos
 = 0;

503 cÚ¡ 
size_t
 
bufsz
 = (
buf
);

505 
	`SLSI_UNUSED_PARAMETER
(
fe
);

507 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%d\n", 
v®ue
);

508 ià(
exŒa
)

509 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%s", 
exŒa
);

510 
	`SLSI_INFO
((
¦si_dev
 *)
fe
->
´iv©e_d©a
, "%s", 
buf
);

511  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
buf
, 
pos
);

512 
	}
}

514 
ssize_t
 
	$¦si_´ocfs_u­sd_wr™e
(
fe
 *file,

515 cÚ¡ 
__u£r
 *
u£r_buf
,

516 
size_t
 
couÁ
, 
loff_t
 *
µos
)

518 
¦si_dev
 *
sdev
 = 
fe
->
´iv©e_d©a
;

519 
Ãt_deviû
 *
dev
 = 
NULL
;

520 
qos_šfo
 = 0;

521 
off£t
 = 0;

522 *
»ad_¡ršg
;

524 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

526 ià(!
dev
) {

527 
	`SLSI_ERR
(
sdev
, "Dev‚ot found\n");

528  -
EINVAL
;

531 ià(!
couÁ
)

532  -
EINVAL
;

534 
»ad_¡ršg
 = 
	`km®loc
(
couÁ
 + 1, 
GFP_KERNEL
);

535 ià(!
»ad_¡ršg
) {

536 
	`SLSI_ERR
(
sdev
, "Malloc for„ead_string failed\n");

537  -
ENOMEM
;

539 
	`mem£t
(
»ad_¡ršg
, 0, (
couÁ
 + 1));

541 
	`sim¶e_wr™e_to_bufãr
(
»ad_¡ršg
, 
couÁ
, 
µos
, 
u£r_buf
, count);

542 
»ad_¡ršg
[
couÁ
] = '\0';

544 
off£t
 = 
	`¦si_¡r_to_št
(
»ad_¡ršg
, &
qos_šfo
);

545 ià(!
off£t
) {

546 
	`SLSI_ERR
(
sdev
, "qos info : failedo„ead‡‚umeric value");

547 
	`kä“
(
»ad_¡ršg
);

548  -
EINVAL
;

552 
sdev
->
deviû_cÚfig
.
qos_šfo
 = qos_info;

553 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "£ˆqos_šfo:%d\n", sdev->
deviû_cÚfig
.
qos_šfo
);

555 
	`kä“
(
»ad_¡ršg
);

556  
couÁ
;

557 
	}
}

559 
ssize_t
 
	$¦si_´ocfs_­_û¹_di§bË_ht_vht_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
,

560 
size_t
 
couÁ
, 
loff_t
 *
µos
)

562 
¦si_dev
 *
sdev
 = 
fe
->
´iv©e_d©a
;

563 
off£t
 = 0;

564 
width
 = 0;

565 *
»ad_¡ršg
;

567 ià(!
couÁ
)

568  -
EINVAL
;

570 
»ad_¡ršg
 = 
	`km®loc
(
couÁ
 + 1, 
GFP_KERNEL
);

571 ià(!
»ad_¡ršg
) {

572 
	`SLSI_ERR
(
sdev
, "Malloc for„ead_string failed\n");

573  -
ENOMEM
;

575 
	`mem£t
(
»ad_¡ršg
, 0, (
couÁ
 + 1));

577 
	`sim¶e_wr™e_to_bufãr
(
»ad_¡ršg
, 
couÁ
, 
µos
, 
u£r_buf
, count);

578 
»ad_¡ršg
[
couÁ
] = '\0';

580 
off£t
 = 
	`¦si_¡r_to_št
(
»ad_¡ršg
, &
width
);

581 ià(!
off£t
) {

582 
	`SLSI_ERR
(
sdev
, "Failedo„ead‡‚umeric value");

583 
	`kä“
(
»ad_¡ršg
);

584  -
EINVAL
;

588 ià(
width
 == 80)

589 
sdev
->
®low_sw™ch_80_mhz
 = 
çl£
;

590 ià(
width
 == 40)

591 
sdev
->
®low_sw™ch_40_mhz
 = 
çl£
;

593 
	`kä“
(
»ad_¡ršg
);

594  
couÁ
;

595 
	}
}

597 
ssize_t
 
	$¦si_´ocfs_p2p_û¹if_wr™e
(
fe
 *file,

598 cÚ¡ 
__u£r
 *
u£r_buf
,

599 
size_t
 
couÁ
, 
loff_t
 *
µos
)

601 
¦si_dev
 *
sdev
 = 
fe
->
´iv©e_d©a
;

602 *
»ad_¡ršg
;

603 
û¹_šfo
 = 0;

604 
off£t
 = 0;

606 
»ad_¡ršg
 = 
	`km®loc
(
couÁ
 + 1, 
GFP_KERNEL
);

607 ià(!
»ad_¡ršg
) {

608 
	`SLSI_ERR
(
sdev
, "Malloc for„ead_string failed\n");

609  -
ENOMEM
;

611 
	`mem£t
(
»ad_¡ršg
, 0, (
couÁ
 + 1));

613 
	`sim¶e_wr™e_to_bufãr
(
»ad_¡ršg
, 
couÁ
, 
µos
, 
u£r_buf
, count);

614 
»ad_¡ršg
[
couÁ
] = '\0';

616 
off£t
 = 
	`¦si_¡r_to_št
(
»ad_¡ršg
, &
û¹_šfo
);

617 ià(!
off£t
) {

618 
	`SLSI_ERR
(
sdev
, "qos info : failedo„ead‡‚umeric value");

619 
	`kä“
(
»ad_¡ršg
);

620  -
EINVAL
;

622 
sdev
->
p2p_û¹if
 = 
û¹_šfo
;

623 
	`kä“
(
»ad_¡ršg
);

624  
couÁ
;

625 
	}
}

627 
ssize_t
 
	$¦si_´ocfs_p2p_û¹if_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

629 
¦si_dev
 *
sdev
 = 
fe
->
´iv©e_d©a
;

630 
buf
[128];

631 
pos
 = 0;

632 cÚ¡ 
size_t
 
bufsz
 = (
buf
);

634 
	`SLSI_UNUSED_PARAMETER
(
fe
);

636 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%d\n", 
sdev
->
p2p_û¹if
);

638  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
buf
, 
pos
);

639 
	}
}

641 
	$¦si_´ocfs_mac_addr_show
(
£q_fe
 *
m
, *
v
)

643 
¦si_dev
 *
sdev
 = (¦si_dev *)
m
->
´iv©e
;

645 
	`SLSI_UNUSED_PARAMETER
(
v
);

647 
	`£q_´štf
(
m
, "%pM", 
sdev
->
hw_addr
);

649 
	}
}

651 
ssize_t
 
	$¦si_´ocfs_ü—‹_t¥ec_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

653 
¦si_dev
 *
sdev
 = 
fe
->
´iv©e_d©a
;

654 cÚ¡ *
exŒa_šfo
 = "";

656  
	`¦si_´ocfs_»ad_št
(
fe
, 
u£r_buf
, 
couÁ
, 
µos
, 
sdev
->
cu¼’t_t¥ec_id
, 
exŒa_šfo
);

657 
	}
}

659 
ssize_t
 
	$¦si_´ocfs_ü—‹_t¥ec_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

661 
¦si_dev
 *
sfdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

662 *
»ad_¡ršg
 = 
	`km®loc
(
couÁ
 + 1, 
GFP_KERNEL
);

664 ià(!
»ad_¡ršg
) {

665 
	`SLSI_ERR
(
sfdev
, "Malloc for„ead_string failed\n");

666  -
ENOMEM
;

669 ià(!
couÁ
) {

670 
	`kä“
(
»ad_¡ršg
);

674 
	`sim¶e_wr™e_to_bufãr
(
»ad_¡ršg
, 
couÁ
, 
µos
, 
u£r_buf
, count);

675 
»ad_¡ršg
[
couÁ
] = '\0';

677 
sfdev
->
cu¼’t_t¥ec_id
 = 
	`ÿc_ù¾_ü—‹_t¥ec
(sfdev, 
»ad_¡ršg
);

678 ià(
sfdev
->
cu¼’t_t¥ec_id
 < 0) {

679 
	`SLSI_ERR
(
sfdev
, "createspec: No…arameters or‚ot valid…arameters\n");

680 
	`kä“
(
»ad_¡ršg
);

681  -
EINVAL
;

683 
	`kä“
(
»ad_¡ršg
);

685  
couÁ
;

686 
	}
}

688 
ssize_t
 
	$¦si_´ocfs_cÚfg_t¥ec_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

690 cÚ¡ *
exŒa_šfo
 = "Not implemented yet";

691 
v®ue
 = 10;

693  
	`¦si_´ocfs_»ad_št
(
fe
, 
u£r_buf
, 
couÁ
, 
µos
, 
v®ue
, 
exŒa_šfo
);

694 
	}
}

696 
ssize_t
 
	$¦si_´ocfs_cÚfg_t¥ec_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

698 
¦si_dev
 *
sfdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

699 *
»ad_¡ršg
 = 
	`km®loc
(
couÁ
 + 1, 
GFP_KERNEL
);

701 ià(!
»ad_¡ršg
) {

702 
	`SLSI_ERR
(
sfdev
, "Malloc for„ead_string failed\n");

703  -
ENOMEM
;

706 ià(!
couÁ
) {

707 
	`kä“
(
»ad_¡ršg
);

711 
	`sim¶e_wr™e_to_bufãr
(
»ad_¡ršg
, 
couÁ
, 
µos
, 
u£r_buf
, count);

712 
»ad_¡ršg
[
couÁ
] = '\0';

715 ià(
	`ÿc_ù¾_cÚfig_t¥ec
(
sfdev
, 
»ad_¡ršg
) < 0) {

716 
	`SLSI_ERR
(
sfdev
, "configspecƒrror\n");

717 
	`kä“
(
»ad_¡ršg
);

718  -
EINVAL
;

721 
	`kä“
(
»ad_¡ršg
);

723  
couÁ
;

724 
	}
}

726 
ssize_t
 
	$¦si_´ocfs_£nd_addts_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

728 
¦si_dev
 *
sdev
 = 
fe
->
´iv©e_d©a
;

729 cÚ¡ *
exŒa_šfo
 = "";

731  
	`¦si_´ocfs_»ad_št
(
fe
, 
u£r_buf
, 
couÁ
, 
µos
, 
sdev
->
t¥ec_”rÜ_code
, 
exŒa_šfo
);

732 
	}
}

734 
ssize_t
 
	$¦si_´ocfs_£nd_addts_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

736 
¦si_dev
 *
sfdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

737 *
»ad_¡ršg
 = 
	`km®loc
(
couÁ
 + 1, 
GFP_KERNEL
);

739 ià(!
»ad_¡ršg
) {

740 
	`SLSI_ERR
(
sfdev
, "Malloc for„ead_string failed\n");

741  -
ENOMEM
;

744 
sfdev
->
t¥ec_”rÜ_code
 = -1;

745 ià(!
couÁ
) {

746 
	`kä“
(
»ad_¡ršg
);

750 
	`sim¶e_wr™e_to_bufãr
(
»ad_¡ršg
, 
couÁ
, 
µos
, 
u£r_buf
, count);

751 
»ad_¡ršg
[
couÁ
] = '\0';

754 ià(
	`ÿc_ù¾_£nd_addts
(
sfdev
, 
»ad_¡ršg
) < 0) {

755 
	`SLSI_ERR
(
sfdev
, "send‡ddtsƒrror\n");

756 
	`kä“
(
»ad_¡ršg
);

757  -
EINVAL
;

759 
	`kä“
(
»ad_¡ršg
);

760  
couÁ
;

761 
	}
}

763 
ssize_t
 
	$¦si_´ocfs_£nd_d–ts_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

765 
¦si_dev
 *
sdev
 = 
fe
->
´iv©e_d©a
;

766 cÚ¡ *
exŒa_šfo
 = "";

768  
	`¦si_´ocfs_»ad_št
(
fe
, 
u£r_buf
, 
couÁ
, 
µos
, 
sdev
->
t¥ec_”rÜ_code
, 
exŒa_šfo
);

769 
	}
}

771 
ssize_t
 
	$¦si_´ocfs_£nd_d–ts_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

773 
¦si_dev
 *
sfdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

774 *
»ad_¡ršg
 = 
	`km®loc
(
couÁ
 + 1, 
GFP_KERNEL
);

776 ià(!
»ad_¡ršg
) {

777 
	`SLSI_ERR
(
sfdev
, "Malloc for„ead_string failed\n");

778  -
ENOMEM
;

781 
sfdev
->
t¥ec_”rÜ_code
 = -1;

783 ià(!
couÁ
) {

784 
	`kä“
(
»ad_¡ršg
);

788 
	`sim¶e_wr™e_to_bufãr
(
»ad_¡ršg
, 
couÁ
, 
µos
, 
u£r_buf
, count);

789 
»ad_¡ršg
[
couÁ
] = '\0';

792 ià(
	`ÿc_ù¾_£nd_d–ts
(
sfdev
, 
»ad_¡ršg
) < 0) {

793 
	`SLSI_ERR
(
sfdev
, "send deltsƒrror\n");

794 
	`kä“
(
»ad_¡ršg
);

795  -
EINVAL
;

797 
	`kä“
(
»ad_¡ršg
);

798  
couÁ
;

799 
	}
}

801 
ssize_t
 
	$¦si_´ocfs_d–_t¥ec_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

803 cÚ¡ *
exŒa_šfo
 = "Not implemented yet";

804 
v®ue
 = 10;

806  
	`¦si_´ocfs_»ad_št
(
fe
, 
u£r_buf
, 
couÁ
, 
µos
, 
v®ue
, 
exŒa_šfo
);

807 
	}
}

809 
ssize_t
 
	$¦si_´ocfs_d–_t¥ec_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

811 
¦si_dev
 *
sfdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

812 *
»ad_¡ršg
 = 
	`km®loc
(
couÁ
 + 1, 
GFP_KERNEL
);

814 ià(!
»ad_¡ršg
) {

815 
	`SLSI_ERR
(
sfdev
, "Malloc for„ead_string failed\n");

816  -
ENOMEM
;

819 ià(!
couÁ
) {

820 
	`kä“
(
»ad_¡ršg
);

824 
	`sim¶e_wr™e_to_bufãr
(
»ad_¡ršg
, 
couÁ
, 
µos
, 
u£r_buf
, count);

825 
»ad_¡ršg
[
couÁ
] = '\0';

828 ià(
	`ÿc_ù¾_d–‘e_t¥ec
(
sfdev
, 
»ad_¡ršg
) < 0) {

829 
	`SLSI_ERR
(
sfdev
, "configspecƒrror\n");

830 
	`kä“
(
»ad_¡ršg
);

831  -
EINVAL
;

833 
	`kä“
(
»ad_¡ršg
);

834  
couÁ
;

835 
	}
}

837 
ssize_t
 
	$¦si_´ocfs_ut_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

839 
¦si_dev
 *
sdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

840 
Ãt_deviû
 *
dev
;

841 
Ãtdev_vif
 *
ndev_vif
;

842 
i
;

843 
buf
[256];

844 
pos
 = 0;

845 cÚ¡ 
size_t
 
bufsz
 = (
buf
);

847 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

848 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

849 
dev
 = 
sdev
->
Ãtdev
[
i
];

850 ià(
dev
) {

851 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

852 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%s:\t", 
dev
->
Çme
);

853 ià(
ndev_vif
->
throughput_tx_bps
 < 1000)

854 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "TX:%u bps\t", 
ndev_vif
->
throughput_tx_bps
);

855 ià((
ndev_vif
->
throughput_tx_bps
 >= 1000) && (ndev_vif->throughput_tx_bps < (1000 * 1000)))

856 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "TX:%u Kbps\t", (
ndev_vif
->
throughput_tx_bps
 / 1000));

858 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "TX:%u Mbps\t", (
ndev_vif
->
throughput_tx_bps
 / (1000 * 1000)));

860 ià(
ndev_vif
->
throughput_rx_bps
 < 1000)

861 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "RX:%u bps\n", 
ndev_vif
->
throughput_rx_bps
);

862 ià((
ndev_vif
->
throughput_rx_bps
 >= 1000) && (ndev_vif->throughput_rx_bps < (1000 * 1000)))

863 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "RX:%u Kbps\n", (
ndev_vif
->
throughput_rx_bps
 / 1000));

865 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "RX:%u Mbps\n", (
ndev_vif
->
throughput_rx_bps
 / (1000 * 1000)));

868 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

869  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
buf
, 
pos
);

870 
	}
}

872 
ssize_t
 
	$¦si_´ocfs_ut_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
Ën
, 
loff_t
 *
µos
)

874 
¦si_dev
 *
sdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

875 
»ad_buf
[2];

877 ià(!
sdev
) {

878 
	`SLSI_ERR
(
sdev
, "invalid sdev\n");

879  -
ENOMEM
;

882 ià(!
Ën
 || (ËÀ> (
»ad_buf
))) {

883 
	`SLSI_ERR
(
sdev
, "invalid†en\n");

884  -
EINVAL
;

887 
	`sim¶e_wr™e_to_bufãr
(
»ad_buf
, 
Ën
, 
µos
, 
u£r_buf
,†en);

889 
»ad_buf
[0]) {

891 ià(!
	`¦si_Œaffic_mÚ_is_ruÂšg
(
sdev
)) {

892 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "start Traffic monitor\n");

893 
	`¦si_Œaffic_mÚ_ş›Á_»gi¡”
(
sdev
, sdev, 0, 0, 0, 
NULL
);

897 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "stop Traffic monitor\n");

898 
	`¦si_Œaffic_mÚ_ş›Á_uÄegi¡”
(
sdev
, sdev);

901 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "šv®id v®u%c\n", 
»ad_buf
[0]);

902  -
EINVAL
;

904  
Ën
;

905 
	}
}

907 
©omic_t
 
	gfd_İ’ed_couÁ
;

909 
	$¦si_´ocfs_šc_node
()

911 
	`©omic_šc
(&
fd_İ’ed_couÁ
);

912 
	}
}

914 
	$¦si_´ocfs_dec_node
()

916 ià(0 =ğ
	`©omic_»ad
(&
fd_İ’ed_couÁ
)) {

917 
	`WARN_ON
(1);

920 
	`©omic_dec
(&
fd_İ’ed_couÁ
);

921 
	}
}

923 
ssize_t
 
	$¦si_´ocfs_fd_İ’ed_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

925 
buf
[128];

926 
pos
 = 0;

927 cÚ¡ 
size_t
 
bufsz
 = (
buf
);

929 
	`SLSI_UNUSED_PARAMETER
(
fe
);

931 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%d\n", 
	`©omic_»ad
(&
fd_İ’ed_couÁ
));

933  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
buf
, 
pos
);

934 
	}
}

936 
	$¦si_´ocfs_fcq_show
(
£q_fe
 *
m
, *
v
)

938 
¦si_dev
 *
sdev
 = (¦si_dev *)
m
->
´iv©e
;

939 
ac
;

940 
s32
 
vif
, 
i
;

942 
	`SLSI_UNUSED_PARAMETER
(
v
);

944 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

945 
vif
 = 1; vià<ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; vif++) {

946 
Ãt_deviû
 *
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
vif
);

947 
Ãtdev_vif
 *
ndev_vif
;

949 ià(!
dev
)

952 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

953 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

956 
i
 = 0; i < 
SLSI_ADHOC_PEER_CONNECTIONS_MAX
; i++) {

957 
¦si_³”
 *
³”
 = 
ndev_vif
->
³”_¡a_»cÜd
[
i
];

958 
smod
 = 0, 
scod
 = 0, 
qmod
 = 0, 
qcod
 = 0;

959 
scsc_wifi_fcq_q_¡©
 
queue_¡©
;

960 
u32
 
³”_ps_¡©e_Œªs™iÚs
 = 0;

961 
scsc_wifi_fcq_8021x_¡©e
 
ı_¡©e
;

963 ià(!
³”
 || !³”->
v®id
)

966 ià(
	`scsc_wifi_fcq_¡©_queue£t
(&
³”
->
d©a_qs
, &
queue_¡©
, &
smod
, &
scod
, &
ı_¡©e
, &
³”_ps_¡©e_Œªs™iÚs
) != 0)

969 
	`£q_´štf
(
m
, "Interface: %-12s (vif: %d,ype: %s)\n#%d\t|peer: %pM, qs: %2d, smod: %u, scod: %u,‚et_q_stops:%u,‚et_q_resumes:%u, PSransitions: %u, Controlled…ort: %s\n",

970 
	`Ãtdev_Çme
(
dev
),

971 
vif
,

973 
i
 + 1,

974 
³”
->
add»ss
,

975 
³”
->
queue£t
,

976 
smod
,

977 
scod
,

978 
queue_¡©
.
Ãtq_¡İs
,

979 
queue_¡©
.
Ãtq_»sumes
,

980 
³”_ps_¡©e_Œªs™iÚs
,

981 
ı_¡©e
 =ğ
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
 ? "Blocked" : "Opened");

983 
	`£q_´štf
(
m
, "\t|%8s|%8s|%8s|%8s|%8s|%8s|%8s|\n",

988 
ac
 = 0;‡ø< 
SLSI_NETIF_Q_PER_PEER
;‡c++) {

989 ià(
	`scsc_wifi_fcq_¡©_queue
(&
³”
->
d©a_qs
.
ac_q
[
ac
].
h—d
,

990 &
queue_¡©
,

991 &
qmod
, &
qcod
) == 0)

992 
	`£q_´štf
(
m
, "\t|%8d|%8u|%8u|%8u|%8u|%8u|%8u%%\n",

993 
ac
,

994 
qcod
,

995 
qmod
,

996 
queue_¡©
.
Ãtq_¡©e
,

997 
queue_¡©
.
Ãtq_¡İs
,

998 
queue_¡©
.
Ãtq_»sumes
,

999 
queue_¡©
.
Ãtq_¡İ_³rûÁ
);

1006 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
) {

1007 
smod
 = 0, 
scod
 = 0, 
qmod
 = 0, 
qcod
 = 0;

1008 
scsc_wifi_fcq_q_¡©
 
queue_¡©
;

1009 
u32
 
³”_ps_¡©e_Œªs™iÚs
 = 0;

1010 
scsc_wifi_fcq_8021x_¡©e
 
ı_¡©e
;

1012 ià(
	`scsc_wifi_fcq_¡©_queue£t
(&
ndev_vif
->
­
.
group_d©a_qs
, &
queue_¡©
, &
smod
, &
scod
, &
ı_¡©e
, &
³”_ps_¡©e_Œªs™iÚs
) != 0) {

1013 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1017 
	`£q_´štf
(
m
, "|%-12s|%-6d|%-6s|\n%d). smod:%u, scod:%u,‚etq stops :%u,‚etq„esumes :%u, PSransitions :%u Controlled…ort :%s\n",

1018 
	`Ãtdev_Çme
(
dev
),

1019 
vif
,

1021 
i
 + 1,

1022 
smod
,

1023 
scod
,

1024 
queue_¡©
.
Ãtq_¡İs
,

1025 
queue_¡©
.
Ãtq_»sumes
,

1026 
³”_ps_¡©e_Œªs™iÚs
,

1027 
ı_¡©e
 =ğ
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
 ? "Blocked" : "Opened");

1029 
	`£q_´štf
(
m
, " |%-12s|%4s|%8s|%8s|%8s|%8s|%10s|%8s|\n",

1035 
ac
 = 0;‡ø< 
SLSI_NETIF_Q_PER_PEER
;‡c++) {

1036 ià(
	`scsc_wifi_fcq_¡©_queue
(&
ndev_vif
->
­
.
group_d©a_qs
.
ac_q
[
ac
].
h—d
,

1037 &
queue_¡©
,

1038 &
qmod
, &
qcod
) == 0)

1039 
	`£q_´štf
(
m
, " |%-12s|%4d|%8u|%8u|%8u|%8u\n",

1040 
	`Ãtdev_Çme
(
dev
),

1041 
ac
,

1042 
qcod
,

1043 
qmod
,

1044 
queue_¡©
.
Ãtq_¡İs
,

1045 
queue_¡©
.
Ãtq_»sumes
);

1050 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1053 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1056 
	}
}

1058 
	$¦si_´ocfs_tı_ack_suµ»ssiÚ_show
(
£q_fe
 *
m
, *
v
)

1060 
¦si_dev
 *
sdev
 = (¦si_dev *)
m
->
´iv©e
;

1061 
Ãt_deviû
 *
dev
;

1062 
Ãtdev_vif
 *
ndev_vif
;

1063 
i
;

1065 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1066 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

1067 
dev
 = 
sdev
->
Ãtdev
[
i
];

1068 ià(
dev
) {

1069 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1071 
	`£q_´štf
(
m
, "%s:ack_acks=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_acks
);

1072 
	`£q_´štf
(
m
, "%s:ack_suµ»s£d=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_suµ»s£d
);

1073 
	`£q_´štf
(
m
, "%s:ack_£Á=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_£Á
);

1074 
	`£q_´štf
(
m
, "%s:ack_max=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_max
);

1075 
	`£q_´štf
(
m
, "%s:ack_timeout=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_timeout
);

1076 
	`£q_´štf
(
m
, "%s:ack_aged=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_ktime
);

1077 
	`£q_´štf
(
m
, "%s:ack_dacks=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_dacks
);

1078 
	`£q_´štf
(
m
, "%s:ack_§cks=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_§cks
);

1079 
	`£q_´štf
(
m
, "%s:ack_d–ay_acks=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_d–ay_acks
);

1080 
	`£q_´štf
(
m
, "%s:ack_low_wšdow=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_low_wšdow
);

1081 
	`£q_´štf
(
m
, "%s:ack_eû=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_eû
);

1082 
	`£q_´štf
(
m
, "%s:ack_noÿche=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_noÿche
);

1083 
	`£q_´štf
(
m
, "%s:ack_nÜecÜd=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_nÜecÜd
);

1084 
	`£q_´štf
(
m
, "%s:ack_Ï¡»cÜd=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_Ï¡»cÜd
);

1085 
	`£q_´štf
(
m
, "%s:ack_£¬ch»cÜd=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_£¬ch»cÜd
);

1086 
	`£q_´štf
(
m
, "%s:ack_hasd©a=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_hasd©a
);

1087 
	`£q_´štf
(
m
, "%s:ack_psh=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_psh
);

1088 
	`£q_´štf
(
m
, "%s:ack_drİ³d=%u\n", 
dev
->
Çme
, 
ndev_vif
->
tı_ack_¡©s
.
ck_drİ³d
);

1091 
	`mem£t
(&
ndev_vif
->
tı_ack_¡©s
, 0, (
¦si_tı_ack_¡©s
));

1094 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

1096 
	}
}

1098 
ssize_t
 
	$¦si_´ocfs_Çn_mac_addr_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

1100 
buf
[20];

1101 
Çn_mac
[
ETH_ALEN
];

1102 
pos
 = 0;

1103 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1104 
¦si_dev
 *
sdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

1106 
	`¦si_Çn_g‘_mac
(
sdev
, 
Çn_mac
);

1109 
	`SLSI_UNUSED_PARAMETER
(
fe
);

1110 
	`mem£t
(
Çn_mac
, 0, 
ETH_ALEN
);

1112 
pos
 = 
	`sú´štf
(
buf
, (buf), "%pM", 
Çn_mac
);

1113  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
buf
, 
pos
);

1114 
	}
}

1116 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1117 
ssize_t
 
	$¦si_´ocfs_Çn_šfo_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

1119 
buf
[300];

1120 
pos
 = 0;

1121 cÚ¡ 
size_t
 
bufsz
 = (
buf
);

1122 
¦si_dev
 *
sdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

1123 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

1124 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1125 
¦si_vif_Çn
 *
Çn_d©a
;

1127 
	`SLSI_UNUSED_PARAMETER
(
fe
);

1129 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1130 
Çn_d©a
 = &
ndev_vif
->
Çn
;

1131 
	`mem£t
(
buf
, 0, (buf));

1133 
pos
 +ğ
	`sú´štf
(
buf
, 
bufsz
, "NANMACADDRESS,");

1134 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%pM", 
Çn_d©a
->
loÿl_nmi
);

1135 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
, ",CLUSTERID,");

1136 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%pM", 
Çn_d©a
->
şu¡”_id
);

1137 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
, ",OPERATINGCHANNEL,");

1138 ià(
Çn_d©a
->
İ”©šg_chªÃl
[0])

1139 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%d ", 
Çn_d©a
->
İ”©šg_chªÃl
[0]);

1140 ià(
Çn_d©a
->
İ”©šg_chªÃl
[1])

1141 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%d", 
Çn_d©a
->
İ”©šg_chªÃl
[1]);

1142 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
, ",ROLE,");

1143 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%d", 
Çn_d©a
->
rŞe
);

1144 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
, ",STATE,");

1145 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%d", 
Çn_d©a
->
¡©e
);

1146 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
, ",MASTERPREFVAL,");

1147 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%d", 
Çn_d©a
->
ma¡”_´ef_v®ue
);

1148 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
, ",AMR,");

1149 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "0x%08x%08x", 
Çn_d©a
->
amr_high”
,

1150 
Çn_d©a
->
amr_low”
);

1151 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
, ",HOPCOUNT,");

1152 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%d", 
Çn_d©a
->
hİcouÁ
);

1153 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
, ",NMIRANDOMINTERVAL,");

1154 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%d", 
Çn_d©a
->
¿ndom_mac_š‹rv®_£c
);

1156 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1157  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
buf
, 
pos
);

1158 
	}
}

1160 
ssize_t
 
	$¦si_´ocfs_Çn_di§bË_şu¡”_m”ge_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
Ën
,

1161 
loff_t
 *
µos
)

1163 
¦si_dev
 *
sdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

1164 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

1165 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1166 
»ad_¡ršg
[3];

1167 
v®
, 
»t
;

1169 
	`sim¶e_wr™e_to_bufãr
(
»ad_¡ršg
, Ô—d_¡ršg), 
µos
, 
u£r_buf
, (read_string) - 1);

1170 
»ad_¡ršg
[(read_string) - 1] = '\0';

1172 ià(
	`¡¹ošt
(
»ad_¡ršg
, &
v®
)) {

1173 
	`SLSI_ERR
(
sdev
, "šv®id iÅuˆ%s\n", 
»ad_¡ršg
);

1174 
»t
 = -
EINVAL
;

1176 
ndev_vif
->
Çn
.
di§bË_şu¡”_m”ge
 = 
v®
 ? 1 : 0;

1177 
»t
 = (
»ad_¡ršg
) - 1;

1180  
»t
;

1181 
	}
}

1183 
ssize_t
 
	$¦si_´ocfs_Çn_discov”y_d©a_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

1185 
buf
[500];

1186 
pos
 = 0;

1187 cÚ¡ 
size_t
 
bufsz
 = (
buf
);

1188 
¦si_dev
 *
sdev
 = (¦si_dev *)
fe
->
´iv©e_d©a
;

1189 
Ãt_deviû
 *
dev
 = 
	`¦si_Çn_g‘_Ãtdev
(
sdev
);

1190 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1191 
¦si_vif_Çn
 *
Çn_d©a
;

1192 
¦si_Çn_discov”y_šfo
 *
Œav”£
;

1194 
	`SLSI_UNUSED_PARAMETER
(
fe
);

1196 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1197 
Çn_d©a
 = &
ndev_vif
->
Çn
;

1198 
	`mem£t
(
buf
, 0, (buf));

1199 
Œav”£
 = 
Çn_d©a
->
disc_šfo
;

1201 
Œav”£
) {

1202 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%pM,", 
Çn_d©a
->
disc_šfo
->
³”_addr
);

1203 
pos
 +ğ
	`sú´štf
(
buf
 +…os, 
bufsz
 -…os, "%d\n", 
Çn_d©a
->
disc_šfo
->
m©ch_id
);

1204 
Œav”£
 =¿v”£->
Ãxt
;

1206 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1207  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
buf
, 
pos
);

1208 
	}
}

1212 
ssize_t
 
	$¦si_´ocfs_dsı_m­pšg_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
)

1214 #ià(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

1215 
	#DSCP_MAP
 "0,8,40,56"

	)

1217 
	#DSCP_MAP
 "24,8,40,56"

	)

1219  
	`sim¶e_»ad_äom_bufãr
(
u£r_buf
, 
couÁ
, 
µos
, 
DSCP_MAP
, 
	`¡¾’
(DSCP_MAP));

1220 
	}
}

1222 
SLSI_PROCFS_SEQ_FILE_OPS
(
vifs
);

1223 
SLSI_PROCFS_SEQ_FILE_OPS
(
mac_addr
);

1224 
SLSI_PROCFS_WRITE_FILE_OPS
(
u­sd
);

1225 
SLSI_PROCFS_WRITE_FILE_OPS
(
­_û¹_di§bË_ht_vht
);

1226 
SLSI_PROCFS_RW_FILE_OPS
(
p2p_û¹if
);

1227 
SLSI_PROCFS_RW_FILE_OPS
(
ü—‹_t¥ec
);

1228 
SLSI_PROCFS_RW_FILE_OPS
(
cÚfg_t¥ec
);

1229 
SLSI_PROCFS_RW_FILE_OPS
(
£nd_addts
);

1230 
SLSI_PROCFS_RW_FILE_OPS
(
£nd_d–ts
);

1231 
SLSI_PROCFS_RW_FILE_OPS
(
d–_t¥ec
);

1232 
SLSI_PROCFS_RW_FILE_OPS
(
ut
);

1233 
SLSI_PROCFS_READ_FILE_OPS
(
fd_İ’ed
);

1234 
SLSI_PROCFS_SEQ_FILE_OPS
(
bud
);

1235 
SLSI_PROCFS_SEQ_FILE_OPS
(
¡©us
);

1236 
SLSI_PROCFS_SEQ_FILE_OPS
(
fcq
);

1237 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


1238 
SLSI_PROCFS_READ_FILE_OPS
(
mu‹x_¡©s
);

1240 
SLSI_PROCFS_READ_FILE_OPS
(
¡a_bss
);

1241 
SLSI_PROCFS_READ_FILE_OPS
(
big_d©a
);

1242 
SLSI_PROCFS_READ_FILE_OPS
(
throughput_¡©s
);

1243 
SLSI_PROCFS_SEQ_FILE_OPS
(
tı_ack_suµ»ssiÚ
);

1244 
SLSI_PROCFS_READ_FILE_OPS
(
Çn_mac_addr
);

1245 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1246 
SLSI_PROCFS_READ_FILE_OPS
(
Çn_šfo
);

1247 
SLSI_PROCFS_WRITE_FILE_OPS
(
Çn_di§bË_şu¡”_m”ge
);

1248 
SLSI_PROCFS_READ_FILE_OPS
(
Çn_discov”y_d©a
);

1251 
SLSI_PROCFS_READ_FILE_OPS
(
dsı_m­pšg
);

1253 
	$¦si_ü—‹_´oc_dœ
(
¦si_dev
 *
sdev
)

1255 
dœ
[16];

1256 
´oc_dœ_’Œy
 *
·»Á
;

1258 ()
	`¢´štf
(
dœ
, (dœ), "driv”/unifi%d", 
sdev
->
´ocfs_š¡ªû
);

1259 
·»Á
 = 
	`´oc_mkdœ
(
dœ
, 
NULL
);

1260 ià(
·»Á
) {

1261 
sdev
->
´ocfs_dœ
 = 
·»Á
;

1263 
	`SLSI_PROCFS_SEQ_ADD_FILE
(
sdev
, 
bud
, 
·»Á
, 
S_IRUSR
 | 
S_IRGRP
 | 
S_IROTH
);

1264 
	`SLSI_PROCFS_SEQ_ADD_FILE
(
sdev
, 
¡©us
, 
·»Á
, 
S_IRUSR
 | 
S_IRGRP
 | 
S_IROTH
);

1265 
	`SLSI_PROCFS_SEQ_ADD_FILE
(
sdev
, 
fcq
, 
·»Á
, 
S_IRUSR
 | 
S_IRGRP
 | 
S_IROTH
);

1266 
	`SLSI_PROCFS_SEQ_ADD_FILE
(
sdev
, 
vifs
, 
·»Á
, 
S_IRUSR
 | 
S_IRGRP
);

1267 
	`SLSI_PROCFS_SEQ_ADD_FILE
(
sdev
, 
mac_addr
, 
·»Á
, 
S_IRUSR
 | 
S_IRGRP
 | 
S_IROTH
);

1268 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
u­sd
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1269 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
­_û¹_di§bË_ht_vht
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1270 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
p2p_û¹if
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1271 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
ü—‹_t¥ec
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1272 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
cÚfg_t¥ec
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1273 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
£nd_addts
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1274 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
£nd_d–ts
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1275 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
d–_t¥ec
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1276 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
ut
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1277 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
fd_İ’ed
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1278 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


1279 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
mu‹x_¡©s
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1281 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
¡a_bss
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1282 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
big_d©a
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1283 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
throughput_¡©s
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1284 
	`SLSI_PROCFS_SEQ_ADD_FILE
(
sdev
, 
tı_ack_suµ»ssiÚ
, sdev->
´ocfs_dœ
, 
S_IRUSR
 | 
S_IRGRP
);

1285 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
Çn_mac_addr
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1286 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1287 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
Çn_šfo
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1288 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
Çn_di§bË_şu¡”_m”ge
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1289 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
Çn_discov”y_d©a
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1291 
	`SLSI_PROCFS_ADD_FILE
(
sdev
, 
dsı_m­pšg
, 
·»Á
, 
S_IRUSR
 | 
S_IWUSR
 | 
S_IRGRP
 | 
S_IWGRP
);

1295 
”r
:

1296 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "Failure in creation of…roc directories\n");

1297  -
EINVAL
;

1298 
	}
}

1300 
	$¦si_»move_´oc_dœ
(
¦si_dev
 *
sdev
)

1302 ià(
sdev
->
´ocfs_dœ
) {

1303 
dœ
[32];

1305 
	`SLSI_PROCFS_REMOVE_FILE
(
bud
, 
sdev
->
´ocfs_dœ
);

1306 
	`SLSI_PROCFS_REMOVE_FILE
(
¡©us
, 
sdev
->
´ocfs_dœ
);

1307 
	`SLSI_PROCFS_REMOVE_FILE
(
vifs
, 
sdev
->
´ocfs_dœ
);

1308 
	`SLSI_PROCFS_REMOVE_FILE
(
mac_addr
, 
sdev
->
´ocfs_dœ
);

1309 
	`SLSI_PROCFS_REMOVE_FILE
(
fcq
, 
sdev
->
´ocfs_dœ
);

1310 
	`SLSI_PROCFS_REMOVE_FILE
(
u­sd
, 
sdev
->
´ocfs_dœ
);

1311 
	`SLSI_PROCFS_REMOVE_FILE
(
­_û¹_di§bË_ht_vht
, 
sdev
->
´ocfs_dœ
);

1312 
	`SLSI_PROCFS_REMOVE_FILE
(
p2p_û¹if
, 
sdev
->
´ocfs_dœ
);

1313 
	`SLSI_PROCFS_REMOVE_FILE
(
ü—‹_t¥ec
, 
sdev
->
´ocfs_dœ
);

1314 
	`SLSI_PROCFS_REMOVE_FILE
(
cÚfg_t¥ec
, 
sdev
->
´ocfs_dœ
);

1315 
	`SLSI_PROCFS_REMOVE_FILE
(
£nd_addts
, 
sdev
->
´ocfs_dœ
);

1316 
	`SLSI_PROCFS_REMOVE_FILE
(
£nd_d–ts
, 
sdev
->
´ocfs_dœ
);

1317 
	`SLSI_PROCFS_REMOVE_FILE
(
d–_t¥ec
, 
sdev
->
´ocfs_dœ
);

1318 
	`SLSI_PROCFS_REMOVE_FILE
(
ut
, 
sdev
->
´ocfs_dœ
);

1319 
	`SLSI_PROCFS_REMOVE_FILE
(
fd_İ’ed
, 
sdev
->
´ocfs_dœ
);

1320 #ifdeà
CONFIG_SCSC_WLAN_MUTEX_DEBUG


1321 
	`SLSI_PROCFS_REMOVE_FILE
(
mu‹x_¡©s
, 
sdev
->
´ocfs_dœ
);

1323 
	`SLSI_PROCFS_REMOVE_FILE
(
¡a_bss
, 
sdev
->
´ocfs_dœ
);

1324 
	`SLSI_PROCFS_REMOVE_FILE
(
big_d©a
, 
sdev
->
´ocfs_dœ
);

1325 
	`SLSI_PROCFS_REMOVE_FILE
(
throughput_¡©s
, 
sdev
->
´ocfs_dœ
);

1326 
	`SLSI_PROCFS_REMOVE_FILE
(
tı_ack_suµ»ssiÚ
, 
sdev
->
´ocfs_dœ
);

1327 
	`SLSI_PROCFS_REMOVE_FILE
(
Çn_mac_addr
, 
sdev
->
´ocfs_dœ
);

1328 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


1329 
	`SLSI_PROCFS_REMOVE_FILE
(
Çn_šfo
, 
sdev
->
´ocfs_dœ
);

1330 
	`SLSI_PROCFS_REMOVE_FILE
(
Çn_di§bË_şu¡”_m”ge
, 
sdev
->
´ocfs_dœ
);

1331 
	`SLSI_PROCFS_REMOVE_FILE
(
Çn_discov”y_d©a
, 
sdev
->
´ocfs_dœ
);

1333 
	`SLSI_PROCFS_REMOVE_FILE
(
dsı_m­pšg
, 
sdev
->
´ocfs_dœ
);

1334 ()
	`¢´štf
(
dœ
, (dœ), "driv”/unifi%d", 
sdev
->
´ocfs_š¡ªû
);

1335 
	`»move_´oc_’Œy
(
dœ
, 
NULL
);

1336 
sdev
->
´ocfs_dœ
 = 
NULL
;

1338 
	}
}

	@procfs.h

7 #iâdeà
__SLSI_PROCFS_H__


8 
	#__SLSI_PROCFS_H__


	)

10 
	~<lšux/v”siÚ.h
>

11 
	~<lšux/´oc_fs.h
>

12 
	~<lšux/£q_fe.h
>

13 
	~<lšux/”ºo.h
>

15 
	g¦si_dev
;

16 
	g¦si_vif
;

18 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


19 #iâdeà
AID_WIFI


20 
	#AID_WIFI
 1010

	)

23 
	#SLSI_PROCFS_SET_UID_GID
(
_’Œy
) \

25 
kuid_t
 
´oc_kuid
 = 
	`KUIDT_INIT
(
AID_WIFI
); \

26 
kgid_t
 
´oc_kgid
 = 
	`KGIDT_INIT
(
AID_WIFI
); \

27 
	`´oc_£t_u£r
(
_’Œy
, 
´oc_kuid
, 
´oc_kgid
); \

28 } 0)

	)

30 
	#SLSI_PROCFS_SET_UID_GID
(
’Œy
)

	)

33 
	#SLSI_PDE_DATA
(
šode
è
	`PDE_DATA
(šode)

	)

36 
¦si_ü—‹_´oc_dœ
(
¦si_dev
 *
sdev
);

37 
¦si_»move_´oc_dœ
(
¦si_dev
 *
sdev
);

39 
¦si_´ocfs_İ’_fe_g’”ic
(
šode
 *šode, 
fe
 *file);

41 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 6, 0))

42 
	#SLSI_PROCFS_SEQ_FILE_OPS
(
Çme
) \

43 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_show
(
£q_fe
 *
m
, *
v
); \

44 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_İ’
(
šode
 *šode, 
fe
 *file) \

46  
	`sšgË_İ’
(
fe
, 
¦si_´ocfs_
 ## 
Çme
 ## 
_show
, 
	`SLSI_PDE_DATA
(
šode
)); \

48 cÚ¡ 
´oc_İs
 
¦si_´ocfs_
 ## 
Çme
 ## 
_fİs
 = { \

49 .
´oc_İ’
 = 
¦si_´ocfs_
 ## 
Çme
 ## 
_İ’
, \

50 .
´oc_»ad
 = 
£q_»ad
, \

51 .
´oc_l£ek
 = 
£q_l£ek
, \

52 .
´oc_»Ëa£
 = 
sšgË_»Ëa£
, \

53 }

	)

55 
	#SLSI_PROCFS_SEQ_FILE_OPS
(
Çme
) \

56 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_show
(
£q_fe
 *
m
, *
v
); \

57 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_İ’
(
šode
 *šode, 
fe
 *file) \

59  
	`sšgË_İ’
(
fe
, 
¦si_´ocfs_
 ## 
Çme
 ## 
_show
, 
	`SLSI_PDE_DATA
(
šode
)); \

61 cÚ¡ 
fe_İ”©iÚs
 
¦si_´ocfs_
 ## 
Çme
 ## 
_fİs
 = { \

62 .
İ’
 = 
¦si_´ocfs_
 ## 
Çme
 ## 
_İ’
, \

63 .
»ad
 = 
£q_»ad
, \

64 .
Î£ek
 = 
£q_l£ek
, \

65 .
»Ëa£
 = 
sšgË_»Ëa£
, \

66 }

	)

68 
	#SLSI_PROCFS_SEQ_ADD_FILE
(
_sdev
, 
Çme
, 
·»Á
, 
mode
) \

70 
´oc_dœ_’Œy
 *
’Œy
; \

71 
’Œy
 = 
	`´oc_ü—‹_d©a
(#Çme, 
mode
, 
·»Á
, &
¦si_´ocfs_
 ## 
Çme
 ## 
_fİs
, 
_sdev
); \

72 ià(!
’Œy
) { \

73 
”r
; \

75 
	`SLSI_PROCFS_SET_UID_GID
(
’Œy
); \

76 } 0)

	)

78 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 6, 0))

79 
	#SLSI_PROCFS_READ_FILE_OPS
(
Çme
) \

80 
ssize_t
 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
); \

81 cÚ¡ 
´oc_İs
 
¦si_´ocfs_
 ## 
Çme
 ## 
_fİs
 = { \

82 .
´oc_»ad
 = 
¦si_´ocfs_
 ## 
Çme
 ## 
_»ad
, \

83 .
´oc_İ’
 = 
¦si_´ocfs_İ’_fe_g’”ic
, \

84 .
´oc_l£ek
 = 
g’”ic_fe_Î£ek
 \

85 }

	)

87 
	#SLSI_PROCFS_WRITE_FILE_OPS
(
Çme
) \

88 
ssize_t
 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
); \

89 cÚ¡ 
´oc_İs
 
¦si_´ocfs_
 ## 
Çme
 ## 
_fİs
 = { \

90 .
´oc_wr™e
 = 
¦si_´ocfs_
 ## 
Çme
 ## 
_wr™e
, \

91 .
´oc_İ’
 = 
¦si_´ocfs_İ’_fe_g’”ic
, \

92 .
´oc_l£ek
 = 
g’”ic_fe_Î£ek
 \

93 }

	)

95 
	#SLSI_PROCFS_RW_FILE_OPS
(
Çme
) \

96 
ssize_t
 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
); \

97 
ssize_t
 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
); \

98 cÚ¡ 
´oc_İs
 
¦si_´ocfs_
 ## 
Çme
 ## 
_fİs
 = { \

99 .
´oc_»ad
 = 
¦si_´ocfs_
 ## 
Çme
 ## 
_»ad
, \

100 .
´oc_wr™e
 = 
¦si_´ocfs_
 ## 
Çme
 ## 
_wr™e
, \

101 .
´oc_İ’
 = 
¦si_´ocfs_İ’_fe_g’”ic
, \

102 .
´oc_l£ek
 = 
g’”ic_fe_Î£ek
 \

103 }

	)

105 
	#SLSI_PROCFS_READ_FILE_OPS
(
Çme
) \

106 
ssize_t
 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
); \

107 cÚ¡ 
fe_İ”©iÚs
 
¦si_´ocfs_
 ## 
Çme
 ## 
_fİs
 = { \

108 .
»ad
 = 
¦si_´ocfs_
 ## 
Çme
 ## 
_»ad
, \

109 .
İ’
 = 
¦si_´ocfs_İ’_fe_g’”ic
, \

110 .
Î£ek
 = 
g’”ic_fe_Î£ek
 \

111 }

	)

113 
	#SLSI_PROCFS_WRITE_FILE_OPS
(
Çme
) \

114 
ssize_t
 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
); \

115 cÚ¡ 
fe_İ”©iÚs
 
¦si_´ocfs_
 ## 
Çme
 ## 
_fİs
 = { \

116 .
wr™e
 = 
¦si_´ocfs_
 ## 
Çme
 ## 
_wr™e
, \

117 .
İ’
 = 
¦si_´ocfs_İ’_fe_g’”ic
, \

118 .
Î£ek
 = 
g’”ic_fe_Î£ek
 \

119 }

	)

121 
	#SLSI_PROCFS_RW_FILE_OPS
(
Çme
) \

122 
ssize_t
 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_wr™e
(
fe
 *fe, cÚ¡ 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
); \

123 
ssize_t
 
¦si_´ocfs_
 ## 
Çme
 ## 
	`_»ad
(
fe
 *fe, 
__u£r
 *
u£r_buf
, 
size_t
 
couÁ
, 
loff_t
 *
µos
); \

124 cÚ¡ 
fe_İ”©iÚs
 
¦si_´ocfs_
 ## 
Çme
 ## 
_fİs
 = { \

125 .
»ad
 = 
¦si_´ocfs_
 ## 
Çme
 ## 
_»ad
, \

126 .
wr™e
 = 
¦si_´ocfs_
 ## 
Çme
 ## 
_wr™e
, \

127 .
İ’
 = 
¦si_´ocfs_İ’_fe_g’”ic
, \

128 .
Î£ek
 = 
g’”ic_fe_Î£ek
 \

129 }

	)

131 
	#SLSI_PROCFS_ADD_FILE
(
_sdev
, 
Çme
, 
·»Á
, 
mode
) \

133 
´oc_dœ_’Œy
 *
’Œy
 = 
	`´oc_ü—‹_d©a
(#Çme, 
mode
, 
·»Á
, &
¦si_´ocfs_
 ## 
Çme
 ## 
_fİs
, 
_sdev
); \

134 
	`SLSI_PROCFS_SET_UID_GID
(
’Œy
); \

135 } 0)

	)

136 
	#SLSI_PROCFS_REMOVE_FILE
(
Çme
, 
·»Á
è
	`»move_´oc_’Œy
(#Çme,…¬’t)

	)

138 
¦si_´ocfs_šc_node
();

139 
¦si_´ocfs_dec_node
();

	@reg_info.c

6 
	~"dev.h
"

7 
	~"»g_šfo.h
"

8 
	~"debug.h
"

9 
	~<lšux/fs.h
>

10 
	~<lšux/fœmw¬e.h
>

12 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 4, 0))

13 
MODULE_IMPORT_NS
(
VFS_š‹º®_I_am_»®ly_a_fesy¡em_ªd_am_NOT_a_driv”
);

16 
	$¦si_»gd_š™
(
¦si_dev
 *
sdev
)

18 
›“80211_»gdomaš
 *
¦si_wÜld_»gdom_cu¡om
 = 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
»gdomaš
;

19 
›“80211_»g_ruË
 
»g_ruËs
[] = {

21 
	`REG_RULE
(2412 - 10, 2462 + 10, 40, 0, 20, 0),

23 
	`REG_RULE
(2467 - 10, 2472 + 10, 40, 0, 20, 
NL80211_RRF_NO_IR
),

25 
	`REG_RULE
(5180 - 10, 5240 + 10, 80, 0, 20, 0),

27 
	`REG_RULE
(5260 - 10, 5320 + 10, 80, 0, 20, 
NL80211_RRF_DFS
),

29 
	`REG_RULE
(5500 - 10, 5720 + 10, 80, 0, 20, 
NL80211_RRF_DFS
),

31 
	`REG_RULE
(5745 - 10, 5825 + 10, 80, 0, 20, 0),

34 
i
;

36 
	`SLSI_DBG1_NODEV
(
SLSI_INIT_DEINIT
, "regulatory init\n");

37 
sdev
->
»gdb
.
»gdb_¡©e
 = 
SLSI_REG_DB_NOT_SET
;

38 
¦si_wÜld_»gdom_cu¡om
->
n_»g_ruËs
 = ((
»g_ruËs
)) / (reg_rules[0]);

39 
i
 = 0; i < 
¦si_wÜld_»gdom_cu¡om
->
n_»g_ruËs
; i++)

40 
¦si_wÜld_»gdom_cu¡om
->
»g_ruËs
[
i
] =„eg_rules[i];

43 
¦si_wÜld_»gdom_cu¡om
->
®pha2
[0] = '0';

44 
¦si_wÜld_»gdom_cu¡om
->
®pha2
[1] = '0';

46 
	`why_­¶y_cu¡om_»guÏtÜy
(
sdev
->
why
, 
¦si_wÜld_»gdom_cu¡om
);

47 
	}
}

49 
	$¦si_»gd_deš™
(
¦si_dev
 *
sdev
)

51 
	`SLSI_DBG1
(
sdev
, 
SLSI_INIT_DEINIT
, "slsi_regd_deinit\n");

53 
	`kä“
(
sdev
->
deviû_cÚfig
.
domaš_šfo
.
couÁryli¡
);

54 
sdev
->
deviû_cÚfig
.
domaš_šfo
.
couÁryli¡
 = 
NULL
;

55 
	`kä“
(
sdev
->
»gdb
.
äeq_¿nges
);

56 
sdev
->
»gdb
.
äeq_¿nges
 = 
NULL
;

57 
	`kä“
(
sdev
->
»gdb
.
»g_ruËs
);

58 
sdev
->
»gdb
.
»g_ruËs
 = 
NULL
;

59 
	`kä“
(
sdev
->
»gdb
.
ruËs_cŞËùiÚ
);

60 
sdev
->
»gdb
.
ruËs_cŞËùiÚ
 = 
NULL
;

61 
	`kä“
(
sdev
->
»gdb
.
couÁry
);

62 
sdev
->
»gdb
.
couÁry
 = 
NULL
;

63 
	}
}

65 
	$fœmw¬e_»ad
(cÚ¡ 
fœmw¬e
 *
fœm
, *
de¡
, 
size_t
 
size
, *
off£t
)

67 ià(
fœm
->
size
 - *
off£t
 < size) {

68 
	`SLSI_INFO_NODEV
("file size isoo smallo„ead data!\n");

69  -
EINVAL
;

71 
	`memıy
(
de¡
, 
fœm
->
d©a
 + *
off£t
, 
size
);

72 *
off£t
 = *off£ˆ+ 
size
;

73  
size
;

74 
	}
}

76 
	$¦si_»ad_»guÏtÜy
(
¦si_dev
 *
sdev
)

78 #ià(
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(5, 4, 0))

79 *
»g_fe_t
 = "/vendor/etc/wifi/slsi_reg_database.bin";

81 *
»g_fe_t
 = "../etc/wifi/slsi_reg_database.bin";

84 
i
 = 0, 
j
 = 0, 
šdex
 = 0;

85 
ušt32_t
 
num_äeqbªds
 = 0, 
num_ruËs
 = 0, 
num_cŞËùiÚs
 = 0;

86 
süt_v”siÚ
 = 0;

87 
r
 = 0, 
off£t
 = 0;

88 cÚ¡ 
fœmw¬e
 *
fœm
;

90 ià(
sdev
->
»gdb
.
»gdb_¡©e
 =ğ
SLSI_REG_DB_SET
) {

91 
	`SLSI_INFO
(
sdev
, "Regulatory is‡lready set\n");

95 
r
 = 
	`mx140_»que¡_fe
(
sdev
->
maxw–l_cÜe
, 
»g_fe_t
, &
fœm
);

96 ià(
r
) {

97 
	`SLSI_INFO
(
sdev
, "E¼Ü Lßdšg % f%d\n", 
»g_fe_t
, 
r
);

98 
sdev
->
»gdb
.
»gdb_¡©e
 = 
SLSI_REG_DB_ERROR
;

99  -
EINVAL
;

102 ià(
	`fœmw¬e_»ad
(
fœm
, &
süt_v”siÚ
, (
ušt32_t
), &
off£t
) < 0) {

103 
	`SLSI_INFO
(
sdev
, "Failedo„ead script version\n");

104 
ex™
;

106 ià(
	`fœmw¬e_»ad
(
fœm
, &
sdev
->
»gdb
.
db_majÜ_v”siÚ
, (
ušt32_t
), &
off£t
) < 0) {

107 
	`SLSI_INFO
(
sdev
, "FaedØ»ad„egdb majÜ v”siÚ %u\n", sdev->
»gdb
.
db_majÜ_v”siÚ
);

108 
ex™
;

110 ià(
	`fœmw¬e_»ad
(
fœm
, &
sdev
->
»gdb
.
db_mšÜ_v”siÚ
, (
ušt32_t
), &
off£t
) < 0) {

111 
	`SLSI_INFO
(
sdev
, "FaedØ»ad„egdb mšÜ v”siÚ %u\n", sdev->
»gdb
.
db_mšÜ_v”siÚ
);

112 
ex™
;

114 ià(
	`fœmw¬e_»ad
(
fœm
, &
num_äeqbªds
, (
ušt32_t
), &
off£t
) < 0) {

115 
	`SLSI_INFO
(
sdev
, "FaedØ»ad Numb” oàF»qu’cy bªd %u\n", 
num_äeqbªds
);

116 
ex™
;

119 
sdev
->
»gdb
.
äeq_¿nges
 = 
	`km®loc
((*sdev->»gdb.äeq_¿ngesè* 
num_äeqbªds
, 
GFP_KERNEL
);

120 ià(!
sdev
->
»gdb
.
äeq_¿nges
) {

121 
	`SLSI_ERR
(
sdev
, "kmalloc of sdev->regdb->freq_ranges failed\n");

122 
ex™
;

124 
i
 = 0; i < 
num_äeqbªds
; i++) {

125 ià(
	`fœmw¬e_»ad
(
fœm
, &
sdev
->
»gdb
.
äeq_¿nges
[
i
], (
»gdb_fe_äeq_¿nge
), &
off£t
) < 0) {

126 
	`SLSI_ERR
(
sdev
, "Failedo„ead„egdb freq_ranges\n");

127 
ex™_äeq_¿nges
;

131 ià(
	`fœmw¬e_»ad
(
fœm
, &
num_ruËs
, (
ušt32_t
), &
off£t
) < 0) {

132 
	`SLSI_ERR
(
sdev
, "Failedo„ead‚um_rules\n");

133 
ex™_äeq_¿nges
;

136 
sdev
->
»gdb
.
»g_ruËs
 = 
	`km®loc
((*sdev->»gdb.»g_ruËsè* 
num_ruËs
, 
GFP_KERNEL
);

137 ià(!
sdev
->
»gdb
.
»g_ruËs
) {

138 
	`SLSI_ERR
(
sdev
, "kmalloc of sdev->regdb->reg_rules failed\n");

139 
ex™_äeq_¿nges
;

141 
i
 = 0; i < 
num_ruËs
; i++) {

142 ià(
	`fœmw¬e_»ad
(
fœm
, &
šdex
, (
ušt32_t
), &
off£t
) < 0) {

143 
	`SLSI_ERR
(
sdev
, "Failedo„ead index\n");

144 
ex™_»g_ruËs
;

146 
sdev
->
»gdb
.
»g_ruËs
[
i
].
äeq_¿nge
 = &sdev->»gdb.
äeq_¿nges
[
šdex
];

147 ià(
	`fœmw¬e_»ad
(
fœm
, &
sdev
->
»gdb
.
»g_ruËs
[
i
].
max_eœp
, (
ušt32_t
), &
off£t
) < 0) {

148 
	`SLSI_ERR
(
sdev
, "Failedo„ead„egdb„eg_rules\n");

149 
ex™_»g_ruËs
;

151 ià(
	`fœmw¬e_»ad
(
fœm
, &
sdev
->
»gdb
.
»g_ruËs
[
i
].
æags
, (
ušt32_t
), &
off£t
) < 0) {

152 
	`SLSI_ERR
(
sdev
, "Failedo„ead„egdb flags\n");

153 
ex™_»g_ruËs
;

157 ià(
	`fœmw¬e_»ad
(
fœm
, &
num_cŞËùiÚs
, (
ušt32_t
), &
off£t
) < 0) {

158 
	`SLSI_ERR
(
sdev
, "Failedo„ead‚um_collections\n");

159 
ex™_»g_ruËs
;

162 
sdev
->
»gdb
.
ruËs_cŞËùiÚ
 = 
	`km®loc
((*sdev->»gdb.ruËs_cŞËùiÚè* 
num_cŞËùiÚs
, 
GFP_KERNEL
);

163 ià(!
sdev
->
»gdb
.
ruËs_cŞËùiÚ
) {

164 
	`SLSI_ERR
(
sdev
, "kmalloc of sdev->regdb->rules_collection failed\n");

165 
ex™_»g_ruËs
;

167 
i
 = 0; i < 
num_cŞËùiÚs
; i++) {

168 ià(
	`fœmw¬e_»ad
(
fœm
, &
sdev
->
»gdb
.
ruËs_cŞËùiÚ
[
i
].
»g_ruË_num
, (
ušt32_t
), &
off£t
) < 0) {

169 
	`SLSI_ERR
(
sdev
, "Failedo„ead„egdb„ules_collection„eg_rule_num\n");

170 
ex™_ruËs_cŞËùiÚ
;

172 
j
 = 0; j < 
sdev
->
»gdb
.
ruËs_cŞËùiÚ
[
i
].
»g_ruË_num
; j++) {

173 ià(
	`fœmw¬e_»ad
(
fœm
, &
šdex
, (
ušt32_t
), &
off£t
) < 0) {

174 
	`SLSI_ERR
(
sdev
, "Failedo„ead„egdb„ules collections index\n");

175 
ex™_ruËs_cŞËùiÚ
;

177 
sdev
->
»gdb
.
ruËs_cŞËùiÚ
[
i
].
»g_ruË
[
j
] = &sdev->»gdb.
»g_ruËs
[
šdex
];

181 ià(
	`fœmw¬e_»ad
(
fœm
, &
sdev
->
»gdb
.
num_couÁr›s
, (
ušt32_t
), &
off£t
) < 0) {

182 
	`SLSI_ERR
(
sdev
, "Failedo„ead„egdb‚umber of countries\n");

183 
ex™_ruËs_cŞËùiÚ
;

185 
	`SLSI_INFO
(
sdev
, "Regulatory Version: %d.%d , Script Version: %d , Number of Countries: %d\n",

186 
sdev
->
»gdb
.
db_majÜ_v”siÚ
, sdev->»gdb.
db_mšÜ_v”siÚ
, 
süt_v”siÚ
,

187 
sdev
->
»gdb
.
num_couÁr›s
);

189 
sdev
->
»gdb
.
couÁry
 = 
	`km®loc
((*sdev->»gdb.couÁryè* sdev->»gdb.
num_couÁr›s
, 
GFP_KERNEL
);

190 ià(!
sdev
->
»gdb
.
couÁry
) {

191 
	`SLSI_ERR
(
sdev
, "kmalloc of sdev->regdb->country failed\n");

192 
ex™_ruËs_cŞËùiÚ
;

194 
i
 = 0; i < 
sdev
->
»gdb
.
num_couÁr›s
; i++) {

195 ià(
	`fœmw¬e_»ad
(
fœm
, &
sdev
->
»gdb
.
couÁry
[
i
].
®pha2
, 2 * (
ušt8_t
), &
off£t
) < 0) {

196 
	`SLSI_ERR
(
sdev
, "Failedo„ead„egdb country‡lpha2\n");

197 
ex™_couÁry
;

199 ià(
	`fœmw¬e_»ad
(
fœm
, &
sdev
->
»gdb
.
couÁry
[
i
].
·d_by‹
, (
ušt8_t
), &
off£t
) < 0) {

200 
	`SLSI_ERR
(
sdev
, "Failedo„ead„egdb country…ad_byte\n");

201 
ex™_couÁry
;

203 ià(
	`fœmw¬e_»ad
(
fœm
, &
sdev
->
»gdb
.
couÁry
[
i
].
dfs_»giÚ
, (
ušt8_t
), &
off£t
) < 0) {

204 
	`SLSI_ERR
(
sdev
, "Failedo„ead„egdb country dfs_region\n");

205 
ex™_couÁry
;

207 ià(
	`fœmw¬e_»ad
(
fœm
, &
šdex
, (
ušt32_t
), &
off£t
) < 0) {

208 
	`SLSI_ERR
(
sdev
, "Failedo„ead„egdb country index\n");

209 
ex™_couÁry
;

211 
sdev
->
»gdb
.
couÁry
[
i
].
cŞËùiÚ
 = &sdev->»gdb.
ruËs_cŞËùiÚ
[
šdex
];

214 
	`mx140_»Ëa£_fe
(
sdev
->
maxw–l_cÜe
, 
fœm
);

215 
sdev
->
»gdb
.
»gdb_¡©e
 = 
SLSI_REG_DB_SET
;

218 
ex™_couÁry
:

219 
	`kä“
(
sdev
->
»gdb
.
couÁry
);

220 
sdev
->
»gdb
.
couÁry
 = 
NULL
;

222 
ex™_ruËs_cŞËùiÚ
:

223 
	`kä“
(
sdev
->
»gdb
.
ruËs_cŞËùiÚ
);

224 
sdev
->
»gdb
.
ruËs_cŞËùiÚ
 = 
NULL
;

226 
ex™_»g_ruËs
:

227 
	`kä“
(
sdev
->
»gdb
.
»g_ruËs
);

228 
sdev
->
»gdb
.
»g_ruËs
 = 
NULL
;

230 
ex™_äeq_¿nges
:

231 
	`kä“
(
sdev
->
»gdb
.
äeq_¿nges
);

232 
sdev
->
»gdb
.
äeq_¿nges
 = 
NULL
;

233 
ex™
:

234 
sdev
->
»gdb
.
»gdb_¡©e
 = 
SLSI_REG_DB_ERROR
;

235 
	`mx140_»Ëa£_fe
(
sdev
->
maxw–l_cÜe
, 
fœm
);

236  -
EINVAL
;

237 
	}
}

	@reg_info.h

6 #iâdeà
__SLSI_REGINFO_H__


7 
	#__SLSI_REGINFO_H__


	)

9 
¦si_»ad_»guÏtÜy
(
¦si_dev
 *
sdev
);

10 
¦si_»gd_deš™
(
¦si_dev
 *
sdev
);

11 
¦si_»gd_š™
(
¦si_dev
 *
sdev
);

13 
	e¦si_»gdb_¡©e
 {

14 
	mSLSI_REG_DB_NOT_SET
,

15 
	mSLSI_REG_DB_ERROR
,

16 
	mSLSI_REG_DB_SET
,

19 
	s»g_d©aba£
 {

20 
¦si_»gdb_¡©e
 
	m»gdb_¡©e
;

21 
ušt32_t
 
	mdb_majÜ_v”siÚ
;

22 
ušt32_t
 
	mdb_mšÜ_v”siÚ
;

23 
ušt32_t
 
	mnum_couÁr›s
;

24 
»gdb_fe_»g_ruË
 *
	m»g_ruËs
;

25 
»gdb_fe_äeq_¿nge
 *
	mäeq_¿nges
;

26 
»gdb_fe_»g_ruËs_cŞËùiÚ
 *
	mruËs_cŞËùiÚ
;

27 
»gdb_fe_»g_couÁry
 *
	mcouÁry
;

30 
	s»gdb_fe_äeq_¿nge
 {

31 
ušt32_t
 
	m¡¬t_äeq
;

32 
ušt32_t
 
	m’d_äeq
;

33 
ušt32_t
 
	mmax_bªdwidth
;

36 
	s»gdb_fe_»g_ruË
 {

37 
»gdb_fe_äeq_¿nge
 *
	mäeq_¿nge
;

38 
ušt32_t
 
	mmax_eœp
;

39 
ušt32_t
 
	mæags
;

42 
	s»gdb_fe_»g_ruËs_cŞËùiÚ
 {

43 
ušt32_t
 
	m»g_ruË_num
;

45 
»gdb_fe_»g_ruË
 *
	m»g_ruË
[12];

48 
	s»gdb_fe_»g_couÁry
 {

49 
ušt8_t
 
	m®pha2
[2];

50 
ušt8_t
 
	m·d_by‹
;

51 
ušt8_t
 
	mdfs_»giÚ
;

53 
»gdb_fe_»g_ruËs_cŞËùiÚ
 *
	mcŞËùiÚ
;

	@rx.c

6 
	~<lšux/‘h”deviû.h
>

7 
	~<lšux/time.h
>

8 
	~<lšux/š‹¼u±.h
>

10 
	~"debug.h
"

11 
	~"dev.h
"

12 
	~"mgt.h
"

13 
	~"mlme.h
"

14 
	~"¤c_sšk.h
"

15 
	~"cÚ¡.h
"

16 
	~"ba.h
"

17 
	~"mib.h
"

18 
	~"ÿc.h
"

19 
	~"Æ80211_v’dÜ.h
"

20 
	~"§p.h
"

22 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


23 
	~"scsc_wifogg”_ršgs.h
"

26 #ià
IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

27 
	~<scsc/scsc_log_cŞËùÜ.h
>

30 
›“80211_chªÃl
 *
	$¦si_fšd_sÿn_chªÃl
(
¦si_dev
 *
sdev
, 
›“80211_mgmt
 *
mgmt
, 
size_t
 
mgmt_Ën
, 
u16
 
äeq
)

32 
›Ën
 = 
mgmt_Ën
 - (
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
 - (
u8
 *)mgmt);

33 cÚ¡ 
u8
 *
sÿn_ds
 = 
	`cfg80211_fšd_›
(
WLAN_EID_DS_PARAMS
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
, 
›Ën
);

34 cÚ¡ 
u8
 *
sÿn_ht
 = 
	`cfg80211_fšd_›
(
WLAN_EID_HT_OPERATION
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
, 
›Ën
);

35 
u8
 
chª
 = 0;

38 ià(
sÿn_ds
)

39 
chª
 = 
sÿn_ds
[2];

40 ià(
sÿn_ht
)

41 
chª
 = 
sÿn_ht
[2];

43 ià(
chª
) {

44 
Æ80211_bªd
 
bªd
 = 
NL80211_BAND_2GHZ
;

46 ià(
chª
 > 14)

47 
bªd
 = 
NL80211_BAND_5GHZ
;

48 
äeq
 = (
u16
)
	`›“80211_chªÃl_to_äequ’cy
(
chª
, 
bªd
);

50 ià(!
äeq
)

51  
NULL
;

53  
	`›“80211_g‘_chªÃl
(
sdev
->
why
, 
äeq
);

54 
	}
}

56 
›“80211_mgmt
 *
	$¦si_rx_sÿn_upd©e_ssid
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
,

57 
›“80211_mgmt
 *
mgmt
, 
size_t
 
mgmt_Ën
, size_ˆ*
Ãw_Ën
,

58 
u16
 
äeq
)

60 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

61 
u8
 *
Ãw_mgmt
;

62 
size_t
 
off£t
;

63 cÚ¡ 
u8
 *
mgmt_pos
;

64 cÚ¡ 
u8
 *
ssid
;

65 
i
;

66 
bªd
;

68 ià(!
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
))

69  
NULL
;

72 ià(!
	`›“80211_is_b—cÚ
(
mgmt
->
äame_cÚŒŞ
))

73  
NULL
;

75 
ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
,

76 
mgmt_Ën
 - (
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
 - (
u8
 *)mgmt));

77 ià(!
ssid
) {

78 
	`SLSI_WARN
(
sdev
, "beacon with NO SSID IE\n");

79  
NULL
;

82 ià(
ssid
[1] > 0 && ssid[2] != '\0')

83  
NULL
;

85 
bªd
 = (
äeq
 / 1000è=ğ2 ? 
SLSI_FREQ_BAND_2GHZ
 : 
SLSI_FREQ_BAND_5GHZ
;

88 
i
 = 0; i < 
SLSI_SCAN_SSID_MAP_MAX
; i++) {

89 ià(
	`SLSI_ETHER_EQUAL
(
sdev
->
ssid_m­
[
i
].
bssid
, 
mgmt
->bssidè&& sdev->ssid_m­[i].
bªd
 == band) {

90 
Ãw_mgmt
 = 
	`km®loc
(
mgmt_Ën
 + 34, 
GFP_KERNEL
);

91 ià(!
Ãw_mgmt
) {

92 
	`SLSI_ERR_NODEV
("m®loøçedÖ’:%ld)\n", 
mgmt_Ën
 + 34);

93  
NULL
;

97 
	`memıy
(
Ãw_mgmt
, 
mgmt
, 
ssid
 - (
u8
 *)mgmt);

98 
off£t
 = 
ssid
 - (
u8
 *)
mgmt
;

100 
Ãw_mgmt
[
off£t
++] = 
WLAN_EID_SSID
;

101 
Ãw_mgmt
[
off£t
++] = 
sdev
->
ssid_m­
[
i
].
ssid_Ën
;

102 
	`memıy
(
Ãw_mgmt
 + 
off£t
, 
sdev
->
ssid_m­
[
i
].
ssid
, sdev->ssid_m­[i].
ssid_Ën
);

103 
off£t
 +ğ
sdev
->
ssid_m­
[
i
].
ssid_Ën
;

105 
mgmt_pos
 = 
ssid
 + ssid[1] + 2;

106 
	`memıy
(
Ãw_mgmt
 + 
off£t
, 
mgmt_pos
, 
mgmt_Ën
 - (mgmt_po - (
u8
 *)
mgmt
));

107 
off£t
 +ğ
mgmt_Ën
 - (
mgmt_pos
 - (
u8
 *)
mgmt
);

108 *
Ãw_Ën
 = 
off£t
;

110  (
›“80211_mgmt
 *)
Ãw_mgmt
;

113  
NULL
;

114 
	}
}

116 
›“80211_chªÃl
 *
	$¦si_rx_sÿn_·ss_to_cfg80211
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

118 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

119 
size_t
 
mgmt_Ën
 = 
	`çpi_g‘_mgm’
(
skb
);

120 
s32
 
sigÇl
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_sÿn_šd
.
rssi
) * 100;

121 
u16
 
äeq
 = 
	`SLSI_FREQ_FW_TO_HOST
(
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_sÿn_šd
.
chªÃl_äequ’cy
));

122 
›“80211_chªÃl
 *
chªÃl
 = 
	`¦si_fšd_sÿn_chªÃl
(
sdev
, 
mgmt
, 
mgmt_Ën
, 
äeq
);

123 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 6, 0))

124 
time¥ec64
 
u±ime
;

126 
time¥ec
 
u±ime
;

129 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 6, 0))

130 
u±ime
 = 
	`ktime_to_time¥ec64
(
	`ktime_g‘_boÙtime
());

131 #–ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 4, 0))

132 
u±ime
 = 
	`ktime_to_time¥ec
(
	`ktime_g‘_boÙtime
());

134 
	`g‘_mÚÙÚic_boÙtime
(&
u±ime
);

136 
	`SLSI_UNUSED_PARAMETER
(
dev
);

139 
mgmt
->
u
.
b—cÚ
.
time¡amp
 = (
u±ime
.
tv_£c
 * 1000000è+ (u±ime.
tv_n£c
 / 1000);

141 ià(
chªÃl
) {

142 
cfg80211_bss
 *
bss
;

143 
›“80211_mgmt
 *
mgmt_Ãw
;

144 
size_t
 
mgmt_Ãw_Ën
 = 0;

146 
mgmt_Ãw
 = 
	`¦si_rx_sÿn_upd©e_ssid
(
sdev
, 
dev
, 
mgmt
, 
mgmt_Ën
, &
mgmt_Ãw_Ën
, 
äeq
);

147 ià(
mgmt_Ãw
)

148 
bss
 = 
	`cfg80211_šfÜm_bss_äame
(
sdev
->
why
, 
chªÃl
, 
mgmt_Ãw
, 
mgmt_Ãw_Ën
, 
sigÇl
, 
GFP_KERNEL
);

150 
bss
 = 
	`cfg80211_šfÜm_bss_äame
(
sdev
->
why
, 
chªÃl
, 
mgmt
, 
mgmt_Ën
, 
sigÇl
, 
GFP_KERNEL
);

152 
	`¦si_cfg80211_put_bss
(
sdev
->
why
, 
bss
);

153 
	`kä“
(
mgmt_Ãw
);

155 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "NØChªÃÈšfØfound fÜ f»q:%d\n", 
äeq
);

158 
	`kä“_skb
(
skb
);

159  
chªÃl
;

160 
	}
}

162 #ià!(
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

163 
	$¦si_pİuÏ‹_bssid_šfo
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

164 
sk_buff
 *
skb
, 
li¡_h—d
 *
bssid_li¡
)

166 
li¡_h—d
 *
pos
;

167 
¦si_bssid_šfo
 *
cu¼’t_»suÉ
;

168 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

169 
cu¼’t_rssi
;

170 
u16
 
cu¼’t_äeq
;

172 
cu¼’t_rssi
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_sÿn_šd
.
rssi
);

173 
cu¼’t_äeq
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_sÿn_šd
.
chªÃl_äequ’cy
);

175 
	`li¡_fÜ_—ch
(
pos
, 
bssid_li¡
) {

176 
¦si_bssid_šfo
 *
bssid_šfo
 = 
	`li¡_’Œy
(
pos
, ¦si_bssid_šfo, 
li¡
);

178 ià(
	`SLSI_ETHER_EQUAL
(
bssid_šfo
->
bssid
, 
mgmt
->bssid)) {

180 
bssid_šfo
->
rssi
 = 
cu¼’t_rssi
;

181 
bssid_šfo
->
äeq
 = 
cu¼’t_äeq
;

186 
cu¼’t_»suÉ
 = 
	`kz®loc
((*cu¼’t_»suÉ), 
GFP_KERNEL
);

187 ià(!
cu¼’t_»suÉ
) {

188 
	`SLSI_ERR
(
sdev
, "Failedo‡llocate‚ode for bssid info\n");

191 
	`SLSI_ETHER_COPY
(
cu¼’t_»suÉ
->
bssid
, 
mgmt
->bssid);

192 
cu¼’t_»suÉ
->
rssi
 = 
cu¼’t_rssi
;

193 
cu¼’t_»suÉ
->
äeq
 = 
cu¼’t_äeq
;

194 
cu¼’t_»suÉ
->
cÚÃù_©‹m±ed
 = 
çl£
;

195 
	`li¡_add_
(&
cu¼’t_»suÉ
->
li¡
, 
bssid_li¡
);

198 
	}
}

200 
šlše
 
	$¦si_g’_Ãw_bssid
(cÚ¡ 
u8
 *
bssid
, u8 
max_bssid
,

201 
u8
 
mbssid_šdex
, u8 *
Ãw_bssid
)

203 
u64
 
bssid_u64
 = 
	`‘h”_addr_to_u64
(
bssid
);

204 
u64
 
mask
 = 
	`GENMASK_ULL
(
max_bssid
 - 1, 0);

205 
u64
 
Ãw_bssid_u64
;

207 
Ãw_bssid_u64
 = 
bssid_u64
 & ~
mask
;

209 
Ãw_bssid_u64
 |ğ((
bssid_u64
 & 
mask
è+ 
mbssid_šdex
) & mask;

211 
	`u64_to_‘h”_addr
(
Ãw_bssid_u64
, 
Ãw_bssid
);

212 
	}
}

214 
	$¦si_mbssid_to_ssid_li¡
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

215 
u8
 *
sÿn_ssid
, 
ssid_Ën
,

216 
u8
 *
bssid
, 
äeq
, 
rssi
, u8 
akm_ty³
)

218 
li¡_h—d
 *
pos
;

219 
found
 = 0;

221 
	`li¡_fÜ_—ch
(
pos
, &
ndev_vif
->
¡a
.
ssid_šfo
) {

222 
¦si_ssid_šfo
 *
ssid_šfo
 = 
	`li¡_’Œy
(
pos
, ¦si_ssid_šfo, 
li¡
);

223 
li¡_h—d
 *
pos_bssid
;

224 
¦si_bssid_šfo
 *
cu¼’t_»suÉ
;

226 ià(
ssid_šfo
->
ssid
.
ssid_Ën
 == ssid_len &&

227 
	`memcmp
(
ssid_šfo
->
ssid
.ssid, 
sÿn_ssid
, 
ssid_Ën
) == 0 &&

228 
ssid_šfo
->
akm_ty³
 &‡km_type) {

229 
found
 = 1;

231 
	`li¡_fÜ_—ch
(
pos_bssid
, &
ssid_šfo
->
bssid_li¡
) {

232 
¦si_bssid_šfo
 *
bssid_šfo
 = 
	`li¡_’Œy
(
pos_bssid
, ¦si_bssid_šfo, 
li¡
);

234 ià(
	`SLSI_ETHER_EQUAL
(
bssid_šfo
->
bssid
, bssid)) {

236 
bssid_šfo
->
rssi
 =„ssi;

237 
bssid_šfo
->
äeq
 = freq;

241 
cu¼’t_»suÉ
 = 
	`kz®loc
((*cu¼’t_»suÉ), 
GFP_KERNEL
);

242 ià(!
cu¼’t_»suÉ
) {

243 
	`SLSI_ERR
(
sdev
, "Failedo‡llocate‚ode for bssid info\n");

246 
	`SLSI_ETHER_COPY
(
cu¼’t_»suÉ
->
bssid
, bssid);

247 
	`SLSI_DBG3_NODEV
(
SLSI_MLME
, "BSSID EÁry : %pM\n", 
bssid
);

248 
cu¼’t_»suÉ
->
rssi
 =„ssi;

249 
cu¼’t_»suÉ
->
äeq
 = freq;

250 
cu¼’t_»suÉ
->
cÚÃù_©‹m±ed
 = 
çl£
;

251 
	`li¡_add_
(&
cu¼’t_»suÉ
->
li¡
, &
ssid_šfo
->
bssid_li¡
);

255 ià(!
found
) {

256 
¦si_ssid_šfo
 *
ssid_šfo
;

257 
¦si_bssid_šfo
 *
cu¼’t_»suÉ
;

259 
	`SLSI_DBG3_NODEV
(
SLSI_MLME
, "SSID EÁry : %.*s\n", 
ssid_Ën
, 
sÿn_ssid
);

260 
ssid_šfo
 = 
	`km®loc
((*ssid_šfo), 
GFP_KERNEL
);

261 ià(
ssid_šfo
) {

262 
ssid_šfo
->
ssid
.
ssid_Ën
 = ssid_len;

263 
	`memıy
(
ssid_šfo
->
ssid
.ssid, 
sÿn_ssid
, 
ssid_Ën
);

264 
ssid_šfo
->
akm_ty³
 =‡km_type;

265 
	`INIT_LIST_HEAD
(&
ssid_šfo
->
bssid_li¡
);

266 
cu¼’t_»suÉ
 = 
	`kz®loc
((*cu¼’t_»suÉ), 
GFP_KERNEL
);

267 ià(!
cu¼’t_»suÉ
) {

268 
	`SLSI_ERR
(
sdev
, "Failedo‡llocate‚ode for bssid info\n");

271 
	`SLSI_ETHER_COPY
(
cu¼’t_»suÉ
->
bssid
, bssid);

272 
	`SLSI_DBG3_NODEV
(
SLSI_MLME
, "New BSSID EÁry : %pM\n", 
bssid
);

273 
cu¼’t_»suÉ
->
rssi
 =„ssi;

274 
cu¼’t_»suÉ
->
äeq
 = freq;

275 
cu¼’t_»suÉ
->
cÚÃù_©‹m±ed
 = 
çl£
;

276 
	`li¡_add_
(&
cu¼’t_»suÉ
->
li¡
, &
ssid_šfo
->
bssid_li¡
);

277 
	`li¡_add
(&
ssid_šfo
->
li¡
, &
ndev_vif
->
¡a
.ssid_info);

279 
	`SLSI_ERR
(
sdev
, "Failedo‡llocate‚ode for ssid info\n");

284 
	}
}

286 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(5, 1, 0))

287 
	$¦si_exŒaù_mbssids
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

288 cÚ¡ 
›“80211_mgmt
 *
mgmt
,

289 
sk_buff
 *
skb
, 
u8
 
akm_ty³
)

291 
u8
 *
Œªsm™‹r_bssid
;

292 cÚ¡ 
u8
 *
´obe_b—cÚ
;

293 cÚ¡ 
u8
 *
›
;

294 
›_Ën
;

295 
cu¼’t_rssi
;

296 
u16
 
cu¼’t_äeq
;

297 
size_t
 
mgmt_Ën
;

298 cÚ¡ 
–em’t
 *
–em
, *
sub_–em
;

300 
mgmt_Ën
 = 
	`çpi_g‘_mgm’
(
skb
);

301 
cu¼’t_rssi
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_sÿn_šd
.
rssi
);

302 
cu¼’t_äeq
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_sÿn_šd
.
chªÃl_äequ’cy
);

304 
Œªsm™‹r_bssid
 = (
u8
 *)
mgmt
->
bssid
;

305 ià(
	`›“80211_is_b—cÚ
(
mgmt
->
äame_cÚŒŞ
)) {

306 
´obe_b—cÚ
 = (
u8
 *)
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
;

307 
›_Ën
 = 
mgmt_Ën
 - (
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
 - (
u8
 *)mgmt);

309 
´obe_b—cÚ
 = (
u8
 *)
mgmt
->
u
.
´obe_»¥
.
v¬ŸbË
;

310 
›_Ën
 = 
mgmt_Ën
 - (
mgmt
->
u
.
´obe_»¥
.
v¬ŸbË
 - (
u8
 *)mgmt);

312 
›
 = 
´obe_b—cÚ
;

314 
	`fÜ_—ch_–em’t_id
(
–em
, 
WLAN_EID_MULTIPLE_BSSID
, 
›
, 
›_Ën
) {

315 ià((
–em
->
d©a
 - 
›
è+ƒËm->
d©®’
 > 
›_Ën
) {

316 
	`SLSI_WARN
(
sdev
, "Invalid ie†ength found\n");

320 ià(
–em
->
d©®’
 < 4)

323 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "MBSSID IE Found\n");

324 
	`fÜ_—ch_–em’t
(
sub_–em
, 
–em
->
d©a
 + 1,ƒËm->
d©®’
 - 1) {

325 
u8
 
Ãw_bssid
[
ETH_ALEN
];

326 cÚ¡ 
u8
 *
sÿn_ssid
;

327 cÚ¡ 
u8
 *
šdex
;

328 cÚ¡ 
u8
 *
ssid_›
;

329 
ssid_Ën
 = 0;

331 ià((
sub_–em
->
d©a
 - (
u8
 *)
–em
è+ sub_–em->
d©®’
 >ƒlem->datalen) {

332 
	`SLSI_WARN
(
sdev
, "Invalid mbssid set†ength found\n");

337 ià(
sub_–em
->
id
 !ğ0 || sub_–em->
d©®’
 < 4) {

342 ià(
sub_–em
->
d©a
[0] !ğ
WLAN_EID_NON_TX_BSSID_CAP
 ||

343 
sub_–em
->
d©a
[1] != 2) {

353 
šdex
 = 
	`cfg80211_fšd_›
(
WLAN_EID_MULTI_BSSID_IDX
,

354 
sub_–em
->
d©a
, sub_–em->
d©®’
);

355 ià(!
šdex
 || index[1] < 1 || index[2] == 0) {

359 
ssid_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
sub_–em
->
d©a
, sub_–em->
d©®’
);

360 ià(!
ssid_›
 || ssid_›[1] >ğ
IEEE80211_MAX_SSID_LEN
)

362 
ssid_Ën
 = 
ssid_›
[1];

363 
sÿn_ssid
 = &
ssid_›
[2];

364 
	`¦si_g’_Ãw_bssid
(
Œªsm™‹r_bssid
,

365 
–em
->
d©a
[0], 
šdex
[2], 
Ãw_bssid
);

366 
	`¦si_mbssid_to_ssid_li¡
(
sdev
, 
ndev_vif
, (
u8
 *)
sÿn_ssid
, 
ssid_Ën
, 
Ãw_bssid
, 
cu¼’t_äeq
,

367 
cu¼’t_rssi
, 
akm_ty³
);

372 
	}
}

374 
	$¦si_exŒaù_mbssids
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

375 cÚ¡ 
›“80211_mgmt
 *
mgmt
,

376 
sk_buff
 *
skb
, 
u8
 
akm_ty³
)

378 
u8
 *
Œªsm™‹r_bssid
;

379 cÚ¡ 
u8
 *
sub_–em
;

380 
–’
;

381 cÚ¡ 
u8
 *
pos
;

382 cÚ¡ 
u8
 *
´obe_b—cÚ
;

383 cÚ¡ 
u8
 *
›
;

384 
›_Ën
;

385 
cu¼’t_rssi
;

386 
u16
 
cu¼’t_äeq
;

387 
size_t
 
mgmt_Ën
;

388 
couÁ
 = 0;

390 
mgmt_Ën
 = 
	`çpi_g‘_mgm’
(
skb
);

391 
cu¼’t_rssi
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_sÿn_šd
.
rssi
);

392 
cu¼’t_äeq
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_sÿn_šd
.
chªÃl_äequ’cy
);

394 
Œªsm™‹r_bssid
 = (
u8
 *)
mgmt
->
bssid
;

395 ià(
	`›“80211_is_b—cÚ
(
mgmt
->
äame_cÚŒŞ
)) {

396 
´obe_b—cÚ
 = (
u8
 *)
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
;

397 
›_Ën
 = 
mgmt_Ën
 - (
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
 - (
u8
 *)mgmt);

399 
´obe_b—cÚ
 = (
u8
 *)
mgmt
->
u
.
´obe_»¥
.
v¬ŸbË
;

400 
›_Ën
 = 
mgmt_Ën
 - (
mgmt
->
u
.
´obe_»¥
.
v¬ŸbË
 - (
u8
 *)mgmt);

402 
›
 = 
´obe_b—cÚ
;

404 
›
 && (
›_Ën
 > i- 
´obe_b—cÚ
)) {

405 
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_MULTIPLE_BSSID
, ie, 
›_Ën
 - (› - 
´obe_b—cÚ
));

406 ià(!
›
)

409 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "MBSSID IE Found\n");

410 
pos
 = &
›
[2];

411 
–’
 = 
›
[1];

412 
sub_–em
 = 
pos
 + 1; sub_–em <…o + 
–’
 - 1;

413 
sub_–em
 += 2 + sub_elem[1]) {

414 
u8
 
sub_Ën
 = 
sub_–em
[1];

415 
u8
 
Ãw_bssid
[
ETH_ALEN
];

416 cÚ¡ 
u8
 *
sÿn_ssid
;

417 cÚ¡ 
u8
 *
šdex
;

418 cÚ¡ 
u8
 *
ssid_›
;

419 
ssid_Ën
 = 0;

421 
couÁ
++;

422 ià(
couÁ
 > 127) {

423 
	`SLSI_INFO_NODEV
("Infinite Loop\n");

426 ià(
sub_–em
[0] != 0 || sub_elem[1] < 4) {

431 ià(
sub_–em
[2] !ğ
WLAN_EID_NON_TX_BSSID_CAP
 ||

432 
sub_–em
[3] != 2) {

442 
šdex
 = 
	`cfg80211_fšd_›
(
WLAN_EID_MULTI_BSSID_IDX
,

443 
sub_–em
 + 2, 
sub_Ën
);

444 ià(!
šdex
 || index[1] < 1 || index[2] == 0) {

448 
ssid_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
sub_–em
 + 2, 
sub_Ën
);

449 ià(!
ssid_›
 || ssid_›[1] >ğ
IEEE80211_MAX_SSID_LEN
)

451 
ssid_Ën
 = 
ssid_›
[1];

452 
sÿn_ssid
 = &
ssid_›
[2];

453 
	`¦si_g’_Ãw_bssid
(
Œªsm™‹r_bssid
,

454 
pos
[0], 
šdex
[2], 
Ãw_bssid
);

455 
	`¦si_mbssid_to_ssid_li¡
(
sdev
, 
ndev_vif
, (
u8
 *)
sÿn_ssid
, 
ssid_Ën
, 
Ãw_bssid
, 
cu¼’t_äeq
,

456 
cu¼’t_rssi
, 
akm_ty³
);

458 
›
 += ie[1] + 2;

461 
	}
}

464 
	$¦si_»move_assoc_di§Îowed_bssid
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

465 
¦si_sÿn_»suÉ
 *
sÿn_»suÉ
)

467 
li¡_h—d
 *
pos
;

469 
	`li¡_fÜ_—ch
(
pos
, &
ndev_vif
->
¡a
.
ssid_šfo
) {

470 
¦si_ssid_šfo
 *
ssid_šfo
 = 
	`li¡_’Œy
(
pos
, ¦si_ssid_šfo, 
li¡
);

471 
li¡_h—d
 *
pos_bssid
;

473 ià(
ssid_šfo
->
ssid
.
ssid_Ën
 !ğ
sÿn_»suÉ
->
ssid_Ëngth
 ||

474 
	`memcmp
(
ssid_šfo
->
ssid
.ssid, &
sÿn_»suÉ
->ssid, sÿn_»suÉ->
ssid_Ëngth
) != 0 ||

475 !(
ssid_šfo
->
akm_ty³
 & 
sÿn_»suÉ
->akm_type))

478 
	`li¡_fÜ_—ch
(
pos_bssid
, &
ssid_šfo
->
bssid_li¡
) {

479 
¦si_bssid_šfo
 *
bssid_šfo
 = 
	`li¡_’Œy
(
pos_bssid
, ¦si_bssid_šfo, 
li¡
);

481 ià(!
	`SLSI_ETHER_EQUAL
(
bssid_šfo
->
bssid
, 
sÿn_»suÉ
->bssid))

483 
	`li¡_d–
(
pos_bssid
);

484 
	`kä“
(
bssid_šfo
);

488 
	}
}

490 
	$¦si_»jeù_­_fÜ_sÿn_šfo
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

491 cÚ¡ 
›“80211_mgmt
 *
mgmt
,

492 
size_t
 
mgmt_Ën
, 
¦si_sÿn_»suÉ
 *
sÿn_»suÉ
)

494 cÚ¡ 
u8
 *
v’dÜ_›
;

495 
u8
 
›_Ëngth
;

496 
boŞ
 
di§ssoc_©Œ
 = 
çl£
;

498 ià(
	`›“80211_is_b—cÚ
(
mgmt
->
äame_cÚŒŞ
))

499 
v’dÜ_›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_WFA
, 
SLSI_WLAN_OUI_TYPE_WFA_MBO
,

500 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
,

501 
mgmt_Ën
 - (
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
 - (
u8
 *)mgmt));

503 
v’dÜ_›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_WFA
, 
SLSI_WLAN_OUI_TYPE_WFA_MBO
,

504 
mgmt
->
u
.
´obe_»¥
.
v¬ŸbË
,

505 
mgmt_Ën
 - (
mgmt
->
u
.
´obe_»¥
.
v¬ŸbË
 - (
u8
 *)mgmt));

507 ià(
v’dÜ_›
)

508 
›_Ëngth
 = 
v’dÜ_›
[1];

511 
di§ssoc_©Œ
 = 
	`cfg80211_fšd_›
(
SLSI_MBO_ASSOC_DISALLOWED_ATTR_ID
, 
v’dÜ_›
 + 6, 
›_Ëngth
 - 2);

512 ià(
di§ssoc_©Œ
) {

513 
	`¦si_»move_assoc_di§Îowed_bssid
(
sdev
, 
ndev_vif
, 
sÿn_»suÉ
);

517 
	}
}

519 
	$¦si_pİuÏ‹_ssid_šfo
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
, 
u16
 
sÿn_id
)

521 
li¡_h—d
 *
pos
;

522 
found
 = 0;

523 
sk_buff
 *
b—cÚ_´obe_skb
 = 
NULL
;

524 
›“80211_mgmt
 *
mgmt
 = 
NULL
;

525 
¦si_sÿn_»suÉ
 *
sÿn_»suÉ
 = 
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»suÉs
;

526 
¦si_ssid_šfo
 *
ssid_šfo
;

527 
max_couÁ
, 
sÿÄesuÉcouÁ
 = 0;

529 
max_couÁ
 = 
	`¦si_dev_g‘_sÿn_»suÉ_couÁ
();

531 
sÿn_»suÉ
) {

532 
sÿÄesuÉcouÁ
++;

533 ià(
sÿÄesuÉcouÁ
 >ğ
max_couÁ
) {

534 
	`SLSI_ERR_NODEV
("Scan Result Morehan Max Scan Result Count!!\n");

537 ià(
sÿn_»suÉ
->
b—cÚ
) {

538 
b—cÚ_´obe_skb
 = 
sÿn_»suÉ
->
b—cÚ
;

539 } ià(
sÿn_»suÉ
->
´obe_»¥
) {

540 
b—cÚ_´obe_skb
 = 
sÿn_»suÉ
->
´obe_»¥
;

542 
	`SLSI_ERR_NODEV
("Scanƒntry with‚o beacon /probe„esp!!\n");

543 
sÿn_»suÉ
 = sÿn_»suÉ->
Ãxt
;

547 
mgmt
 = 
	`çpi_g‘_mgmt
(
b—cÚ_´obe_skb
);

548 ià(!
sÿn_»suÉ
->
ssid_Ëngth
 ||

549 
	`¦si_»jeù_­_fÜ_sÿn_šfo
(
sdev
, 
ndev_vif
, 
mgmt
, 
	`çpi_g‘_mgm’
(
b—cÚ_´obe_skb
), 
sÿn_»suÉ
)) {

550 
sÿn_»suÉ
 = sÿn_»suÉ->
Ãxt
;

553 
found
 = 0;

554 
	`li¡_fÜ_—ch
(
pos
, &
ndev_vif
->
¡a
.
ssid_šfo
) {

555 
¦si_ssid_šfo
 *
ssid_šfo
 = 
	`li¡_’Œy
(
pos
, ¦si_ssid_šfo, 
li¡
);

557 ià(
ssid_šfo
->
ssid
.
ssid_Ën
 !ğ
sÿn_»suÉ
->
ssid_Ëngth
 ||

558 
	`memcmp
(
ssid_šfo
->
ssid
.ssid, &
sÿn_»suÉ
->ssid, sÿn_»suÉ->
ssid_Ëngth
) != 0 ||

559 !(
ssid_šfo
->
akm_ty³
 & 
sÿn_»suÉ
->akm_type))

561 
found
 = 1;

562 
	`¦si_pİuÏ‹_bssid_šfo
(
sdev
, 
ndev_vif
, 
b—cÚ_´obe_skb
, &
ssid_šfo
->
bssid_li¡
);

565 ià(
found
) {

566 
	`¦si_exŒaù_mbssids
(
sdev
, 
ndev_vif
, 
mgmt
, 
b—cÚ_´obe_skb
, 
sÿn_»suÉ
->
akm_ty³
);

567 
sÿn_»suÉ
 = sÿn_»suÉ->
Ãxt
;

571 
ssid_šfo
 = 
	`km®loc
((*ssid_šfo), 
GFP_ATOMIC
);

572 ià(
ssid_šfo
) {

573 
ssid_šfo
->
ssid
.
ssid_Ën
 = 
sÿn_»suÉ
->
ssid_Ëngth
;

574 
	`memıy
(
ssid_šfo
->
ssid
.ssid, &
sÿn_»suÉ
->ssid, sÿn_»suÉ->
ssid_Ëngth
);

575 
ssid_šfo
->
akm_ty³
 = 
sÿn_»suÉ
->akm_type;

576 
	`INIT_LIST_HEAD
(&
ssid_šfo
->
bssid_li¡
);

577 
	`¦si_pİuÏ‹_bssid_šfo
(
sdev
, 
ndev_vif
, 
b—cÚ_´obe_skb
, &
ssid_šfo
->
bssid_li¡
);

578 
	`li¡_add
(&
ssid_šfo
->
li¡
, &
ndev_vif
->
¡a
.ssid_info);

580 
	`SLSI_ERR
(
sdev
, "FaedØ®loÿ‹ƒÁry : %.* km®loc(èçed\n", 
sÿn_»suÉ
->
ssid_Ëngth
, sÿn_»suÉ->
ssid
);

582 
	`¦si_exŒaù_mbssids
(
sdev
, 
ndev_vif
, 
mgmt
, 
b—cÚ_´obe_skb
, 
sÿn_»suÉ
->
akm_ty³
);

583 
sÿn_»suÉ
 = sÿn_»suÉ->
Ãxt
;

587 
	}
}

590 
	$¦si_add_to_sÿn_li¡
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

591 
sk_buff
 *
skb
, cÚ¡ 
u8
 *
sÿn_ssid
, 
u16
 
sÿn_id
)

593 
¦si_sÿn_»suÉ
 *
h—d
;

594 
¦si_sÿn_»suÉ
 *
sÿn_»suÉ
, *
cu¼’t_»suÉ
, *
´ev
 = 
NULL
;

595 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

596 
boŞ
 
found
 = 0, 
skb_¡Üed
 = 0;

597 
cu¼’t_rssi
, 
cu¼’t_bªd
;

598 
boŞ
 
is_hidd’
 = 0, 
ssid_m©ched
 = 0;

600 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

601 
h—d
 = 
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»suÉs
;

602 
sÿn_»suÉ
 = 
h—d
;

603 
cu¼’t_rssi
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_sÿn_šd
.
rssi
);

604 
cu¼’t_bªd
 = (
	`çpi_g‘_s16
(
skb
,

605 
u
.
mlme_sÿn_šd
.
chªÃl_äequ’cy
) /

606 2000è=ğ2 ? 
SLSI_FREQ_BAND_2GHZ
 : 
SLSI_FREQ_BAND_5GHZ
;

608 
sÿn_»suÉ
) {

609 
is_hidd’
 = 
sÿn_»suÉ
->
hidd’
 && (!
sÿn_ssid
 || !scan_ssid[1] || scan_ssid[2] == '\0');

610 
ssid_m©ched
 = 
sÿn_ssid
 && sÿn_ssid[1] && 
sÿn_»suÉ
->
ssid_Ëngth
 &&

611 (
sÿn_ssid
[1] =ğ
sÿn_»suÉ
->
ssid_Ëngth
) &&

612 !
	`memcmp
(&
sÿn_ssid
[2], 
sÿn_»suÉ
->
ssid
, scan_ssid[1]);

613 ià((
	`SLSI_ETHER_EQUAL
(
sÿn_»suÉ
->
bssid
, 
mgmt
->bssidè&& sÿn_»suÉ->
bªd
 =ğ
cu¼’t_bªd
) &&

614 (
is_hidd’
 || 
ssid_m©ched
)) {

616 ià(!
sÿn_»suÉ
->
´obe_»¥
 && 
	`›“80211_is_´obe_»¥
(
mgmt
->
äame_cÚŒŞ
)) {

617 
sÿn_»suÉ
->
´obe_»¥
 = 
skb
;

618 
skb_¡Üed
 = 1;

619 } ià(!
sÿn_»suÉ
->
b—cÚ
 && 
	`›“80211_is_b—cÚ
(
mgmt
->
äame_cÚŒŞ
)) {

620 
sÿn_»suÉ
->
b—cÚ
 = 
skb
;

621 
skb_¡Üed
 = 1;

622 ià(!
sÿn_ssid
 || !scan_ssid[1] || scan_ssid[2] == '\0')

623 
sÿn_»suÉ
->
hidd’
 = 1;

629 ià(
cu¼’t_rssi
 < 
sÿn_»suÉ
->
rssi
) {

630 ià(!
skb_¡Üed
)

631 
	`kä“_skb
(
skb
);

632 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

636 
sÿn_»suÉ
->
rssi
 = 
cu¼’t_rssi
;

637 ià(!
skb_¡Üed
) {

638 ià(
	`›“80211_is_b—cÚ
(
mgmt
->
äame_cÚŒŞ
)) {

639 
	`kä“_skb
(
sÿn_»suÉ
->
b—cÚ
);

640 
sÿn_»suÉ
->
b—cÚ
 = 
skb
;

642 
	`kä“_skb
(
sÿn_»suÉ
->
´obe_»¥
);

643 
sÿn_»suÉ
->
´obe_»¥
 = 
skb
;

648 ià(!
´ev
 ||…»v->
rssi
 > 
cu¼’t_rssi
) {

649 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

654 
found
 = 1;

655 
´ev
->
Ãxt
 = 
sÿn_»suÉ
->next;

656 
sÿn_»suÉ
->
Ãxt
 = 
NULL
;

657 
cu¼’t_»suÉ
 = 
sÿn_»suÉ
;

662 
´ev
 = 
sÿn_»suÉ
;

663 
sÿn_»suÉ
 = sÿn_»suÉ->
Ãxt
;

666 ià(!
found
) {

668 
cu¼’t_»suÉ
 = 
	`kz®loc
((*cu¼’t_»suÉ), 
GFP_KERNEL
);

669 ià(!
cu¼’t_»suÉ
) {

670 
	`SLSI_ERR
(
sdev
, "Failedo‡llocate‚ode for scan„esult\n");

671 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

674 
	`SLSI_ETHER_COPY
(
cu¼’t_»suÉ
->
bssid
, 
mgmt
->bssid);

676 
cu¼’t_»suÉ
->
rssi
 = 
cu¼’t_rssi
;

677 
cu¼’t_»suÉ
->
bªd
 = 
cu¼’t_bªd
;

678 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

679 ià(
	`›“80211_is_b—cÚ
(
mgmt
->
äame_cÚŒŞ
))

680 
cu¼’t_»suÉ
->
akm_ty³
 = 
	`¦si_bss_cÚÃù_ty³_g‘
(
sdev
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
,

681 
	`çpi_g‘_mgm’
(
skb
è- (
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
 - (
u8
 *)mgmt));

683 
cu¼’t_»suÉ
->
akm_ty³
 = 
	`¦si_bss_cÚÃù_ty³_g‘
(
sdev
, 
mgmt
->
u
.
´obe_»¥
.
v¬ŸbË
,

684 
	`çpi_g‘_mgm’
(
skb
è- (
mgmt
->
u
.
´obe_»¥
.
v¬ŸbË
 - (
u8
 *)mgmt));

686 ià(
sÿn_ssid
 && scan_ssid[1]) {

687 
	`memıy
(
cu¼’t_»suÉ
->
ssid
, &
sÿn_ssid
[2], scan_ssid[1]);

688 
cu¼’t_»suÉ
->
ssid_Ëngth
 = 
sÿn_ssid
[1];

690 
cu¼’t_»suÉ
->
ssid_Ëngth
 = 0;

692 ià(
	`›“80211_is_b—cÚ
(
mgmt
->
äame_cÚŒŞ
)) {

693 
cu¼’t_»suÉ
->
b—cÚ
 = 
skb
;

694 ià(!
sÿn_ssid
 || !scan_ssid[1] || scan_ssid[2] == '\0')

695 
cu¼’t_»suÉ
->
hidd’
 = 1;

697 
cu¼’t_»suÉ
->
´obe_»¥
 = 
skb
;

699 
cu¼’t_»suÉ
->
Ãxt
 = 
NULL
;

701 ià(!
h—d
) {

702 
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»suÉs
 = 
cu¼’t_»suÉ
;

703 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

708 
sÿn_»suÉ
 = 
h—d
;

709 
´ev
 = 
NULL
;

711 
sÿn_»suÉ
) {

712 ià(
cu¼’t_»suÉ
->
rssi
 > 
sÿn_»suÉ
->rssi) {

713 
cu¼’t_»suÉ
->
Ãxt
 = 
sÿn_»suÉ
;

714 ià(
´ev
)

715 
´ev
->
Ãxt
 = 
cu¼’t_»suÉ
;

717 
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»suÉs
 = 
cu¼’t_»suÉ
;

720 
´ev
 = 
sÿn_»suÉ
;

721 
sÿn_»suÉ
 = sÿn_»suÉ->
Ãxt
;

723 ià(!
sÿn_»suÉ
) {

725 
´ev
->
Ãxt
 = 
cu¼’t_»suÉ
;

726 
cu¼’t_»suÉ
->
Ãxt
 = 
NULL
;

729 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

731 
	}
}

733 
	$¦si_add_to_p2p_sÿn_li¡
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

734 
sk_buff
 *
skb
, 
u16
 
sÿn_id
)

736 
¦si_sÿn_»suÉ
 *
cu¼’t_»suÉ
;

737 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

738 
¦si_sÿn
 *
sÿn
;

741 
cu¼’t_»suÉ
 = 
	`kz®loc
((*cu¼’t_»suÉ), 
GFP_KERNEL
);

742 ià(!
cu¼’t_»suÉ
) {

743 
	`SLSI_ERR
(
sdev
, "Failedo‡llocate‚ode for scan„esult\n");

746 
	`SLSI_ETHER_COPY
(
cu¼’t_»suÉ
->
bssid
, 
mgmt
->bssid);

748 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

749 
sÿn
 = &
ndev_vif
->sÿn[
sÿn_id
];

750 ià(
	`›“80211_is_b—cÚ
(
mgmt
->
äame_cÚŒŞ
))

751 
cu¼’t_»suÉ
->
b—cÚ
 = 
skb
;

753 
cu¼’t_»suÉ
->
´obe_»¥
 = 
skb
;

755 ià(!
sÿn
->
sÿn_»suÉs
) {

756 
sÿn
->
sÿn_»suÉs
 = 
cu¼’t_»suÉ
;

757 
cu¼’t_»suÉ
->
Ãxt
 = 
NULL
;

759 
cu¼’t_»suÉ
->
Ãxt
 = 
sÿn
->
sÿn_»suÉs
;

760 
sÿn
->
sÿn_»suÉs
 = 
cu¼’t_»suÉ
;

762 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

765 
	}
}

767 
	$¦si_rx_sÿn_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

769 
u16
 
sÿn_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_sÿn_šd
.scan_id);

770 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

771 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

772 
size_t
 
mgmt_Ën
 = 
	`çpi_g‘_mgm’
(
skb
);

773 
size_t
 
›_Ën
 = 
mgmt_Ën
 - 
	`off£tof
(
›“80211_mgmt
, 
u
.
´obe_»¥
.
v¬ŸbË
);

774 cÚ¡ 
u8
 *
sÿn_ssid
 = 
NULL
;

776 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


777 ià(
	`¦si_is_gsÿn_id
(
sÿn_id
)) {

778 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_GSCAN
, "sÿn_id:%#x bssid:%pM\n", 
sÿn_id
, 
	`çpi_g‘_mgmt
(
skb
)->
bssid
);

779 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

780 
	`¦si_gsÿn_hªdË_sÿn_»suÉ
(
sdev
, 
dev
, 
skb
, 
sÿn_id
, 
çl£
);

781 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

786 
sÿn_ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
mgmt
->
u
.
´obe_»¥
.
v¬ŸbË
, 
›_Ën
);

788 ià(
sÿn_ssid
 && sÿn_ssid[1] > 
IEEE80211_MAX_SSID_LEN
) {

789 
	`SLSI_NET_ERR
(
dev
, "Drİpšg sÿÀ»suÉ dutØuÃx³ùed ssid†’gth(%d)\n", 
sÿn_ssid
[1]);

790 
	`kä“_skb
(
skb
);

794 ià(
sÿn_ssid
 && sÿn_ssid[1] && ((
›_Ën
 - (sÿn_ssid - 
mgmt
->
u
.
´obe_»¥
.
v¬ŸbË
) + 2) < scan_ssid[1])) {

795 
	`SLSI_NET_ERR
(
dev
, "Drİpšg sÿÀ»suÉ dutØskb d©¨i Ës thª ssid†’(%d)\n", 
sÿn_ssid
[1]);

796 
	`kä“_skb
(
skb
);

800 ià(
sdev
->
p2p_û¹if
 && 
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_CLIENT
 &&

801 (
sÿn_id
 =ğ(
ndev_vif
->
iâum
 << 8 | 
SLSI_SCAN_HW_ID
))) {

807 ià(
sÿn_ssid
 && scan_ssid[1] > 7) {

808 cÚ¡ 
u8
 *
p2p_›
 = 
NULL
;

810 
p2p_›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_WFA
, 
WLAN_OUI_TYPE_WFA_P2P
, 
mgmt
->
u
.
´obe_»¥
.
v¬ŸbË
, 
›_Ën
);

811 
	#P2P_GROUP_CAPAB_PERSISTENT_GROUP
 
	`BIT
(1)

	)

812 ià(
p2p_›
 && !Õ2p_›[10] & 
P2P_GROUP_CAPAB_PERSISTENT_GROUP
)) {

813 
	`SLSI_NET_INFO
(
dev
, "Ignoring‡…eer GO…robe„esponse with group_capab‡s 0\n");

814 
	`kä“_skb
(
skb
);

820 
sÿn_id
 = (scan_id & 0xFF);

822 ià(
	`WARN_ON
(
sÿn_id
 >ğ
SLSI_SCAN_MAX
)) {

823 
	`kä“_skb
(
skb
);

830 ià(!
ndev_vif
->
sÿn
[
sÿn_id
].
is_blockšg_sÿn
)

831 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

833 ià(
	`çpi_g‘_vif
(
skb
è!ğ0 && 
	`çpi_g‘_u16
(skb, 
u
.
mlme_sÿn_šd
.
sÿn_id
) == 0) {

835 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "CÚÃù/Rßmšg sÿÀšdiÿtiÚ„eûived, bssid:%pM\n", 
	`çpi_g‘_mgmt
(
skb
)->
bssid
);

836 
	`kä“_skb
(
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
);

837 
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
 = 
skb
;

838 } ià(
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»q
 ||‚dev_vif->sÿn[sÿn_id].
sched_»q
 ||

839 
ndev_vif
->
sÿn
[
sÿn_id
].
acs_»que¡
 ||

840 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
is_blockšg_sÿn
) {

841 
	`¦si_rßm_chªÃl_ÿche_add
(
sdev
, 
dev
, 
skb
);

842 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
))

843 
	`¦si_add_to_sÿn_li¡
(
sdev
, 
ndev_vif
, 
skb
, 
sÿn_ssid
, 
sÿn_id
);

845 
	`¦si_add_to_p2p_sÿn_li¡
(
sdev
, 
ndev_vif
, 
skb
, 
sÿn_id
);

848 ià(!
ndev_vif
->
sÿn
[
sÿn_id
].
is_blockšg_sÿn
)

849 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

850 
	}
}

852 #ià
defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

853 
	$¦si_rx_b—cÚ_»pÜtšg_ev’t_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

855 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

856 
u16
 
»asÚ_code
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_b—cÚ_»pÜtšg_ev’t_šd
.
abÜt_»asÚ
) -

857 
SLSI_FORWARD_BEACON_ABORT_REASON_OFFSET
;

858 
»t
 = 0;

860 ià(!
ndev_vif
->
aùiv©ed
) {

861 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

862 
	`kä“_skb
(
skb
);

865 ià(!
ndev_vif
->
is_ws_ruÂšg
) {

866 
	`SLSI_ERR
(
sdev
, "WIPS i nÙ„uÂšg. IgnÜb—cÚ_»pÜtšg_ev’t_šd(%u)\n", 
»asÚ_code
);

867 
	`kä“_skb
(
skb
);

871 
ndev_vif
->
is_ws_ruÂšg
 = 
çl£
;

873 ià(
»asÚ_code
 <ğ
SLSI_FORWARD_BEACON_ABORT_REASON_SUSPENDED
)

874 
	`SLSI_INFO
(
sdev
, "»ûived‡bÜt_ev’ˆäom FW w™h„—sÚ(%u)\n", 
»asÚ_code
);

876 
	`SLSI_ERR
(
sdev
, "»ûived‡bÜt_ev’ˆunsuµÜtšg„—sÚ(%u)\n", 
»asÚ_code
);

878 
»t
 = 
	`¦si_£nd_fÜw¬d_b—cÚ_abÜt_v’dÜ_ev’t
(
sdev
, 
dev
, 
»asÚ_code
);

879 ià(
»t
)

880 
	`SLSI_ERR
(
sdev
, "FaedØ£nd fÜw¬d_b—cÚ_abÜt_ev’tÓ¼=%d)\n", 
»t
);

881 
	`kä“_skb
(
skb
);

882 
	}
}

884 
	$¦si_hªdË_ws_b—cÚ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
,

885 
›“80211_mgmt
 *
mgmt
, 
mgmt_Ën
)

887 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

888 
size_t
 
›_Ën
 = 
mgmt_Ën
 - 
	`off£tof
(
›“80211_mgmt
, 
u
.
b—cÚ
.
v¬ŸbË
);

889 cÚ¡ 
u8
 *
ssid_›
 = 
NULL
;

890 cÚ¡ 
u8
 *
sÿn_ssid
 = 
NULL
;

891 cÚ¡ 
u8
 *
sÿn_bssid
 = 
NULL
;

892 
u16
 
b—cÚ_št
 = 0;

893 
u64
 
time¡amp
 = 0;

894 
ssid_Ën
 = 0;

895 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 6, 0))

896 
time¥ec64
 
sys_time
;

898 
time¥ec
 
sys_time
;

900 
»t
 = 0;

902 
u8
 
chªÃl
 = (u8)(
ndev_vif
->
chª
->
hw_v®ue
);

904 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 6, 0))

905 
sys_time
 = 
	`ktime_to_time¥ec64
(
	`ktime_g‘_boÙtime
());

906 #–ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(5, 4, 0))

907 
sys_time
 = 
	`ktime_to_time¥ec
(
	`ktime_g‘_boÙtime
());

909 
	`g‘_mÚÙÚic_boÙtime
(&
sys_time
);

911 
sÿn_bssid
 = 
	`çpi_g‘_mgmt
(
skb
)->
bssid
;

913 
ssid_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
, 
›_Ën
);

914 
ssid_Ën
 = 
ssid_›
[1];

915 
sÿn_ssid
 = &
ssid_›
[2];

916 
b—cÚ_št
 = 
mgmt
->
u
.
b—cÚ
.beacon_int;

917 
time¡amp
 = 
mgmt
->
u
.
b—cÚ
.timestamp;

919 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_RX
,

921 
	`çpi_g‘_mgmt
(
skb
)->
bssid
, 
b—cÚ_št
, 
time¡amp
,

922 (
u64
)
	`TIMESPEC_TO_US
(
sys_time
));

924 
»t
 = 
	`¦si_£nd_fÜw¬d_b—cÚ_v’dÜ_ev’t
(
sdev
, 
dev
, 
sÿn_ssid
, 
ssid_Ën
, 
sÿn_bssid
,

925 
chªÃl
, 
b—cÚ_št
, 
time¡amp
, (
u64
)
	`TIMESPEC_TO_US
(
sys_time
));

926 ià(
»t
)

927 
	`SLSI_ERR
(
sdev
, "Failedo forward beacon_event\n");

928 
	}
}

931 
	$¦si_rx_rş_chªÃl_li¡_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

933 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

934 
u32
 
chªÃl_couÁ
 = 0;

935 
u16
 
chªÃl_li¡
[
MAX_CHANNEL_COUNT
] = {0};

936 
i
 = 7;

937 
›_Ën
 = 0;

938 
u8
 *
±r
;

939 
u16
 
chªÃl_v®
 = 0;

940 
»t
 = 0;

941 
__Ë16
 *
Ë16_±r
 = 
NULL
;

943 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "RCL Channel List Indication„eceived\n");

944 
±r
 = 
	`çpi_g‘_d©a
(
skb
);

945 
›_Ën
 = 
±r
[1];

946 
i
 < 
›_Ën
) {

947 
Ë16_±r
 = (
__Ë16
 *)&
±r
[
i
];

948 
chªÃl_v®
 = 
	`Ë16_to_ıu
(*
Ë16_±r
);

949 
chªÃl_li¡
[
chªÃl_couÁ
] = 
	`›“80211_äequ’cy_to_chªÃl
(
chªÃl_v®
 / 2);

950 ià(
chªÃl_li¡
[
chªÃl_couÁ
] < 1 || channel_list[channel_count] > 196) {

951 
	`SLSI_ERR
(
sdev
, "ERR: Inv®id chªÃÈ»ûived %d\n", 
chªÃl_li¡
[
chªÃl_couÁ
]);

954 
i
 += 3;

955 
chªÃl_couÁ
 += 1;

956 ià(
chªÃl_couÁ
 >ğ
MAX_CHANNEL_COUNT
) {

957 
	`SLSI_ERR
(
sdev
, "ERR: ChªÃÈli¡„eûived >ğ%d\n", 
MAX_CHANNEL_COUNT
);

961 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

962 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
ssid
[ndev_vif->¡a.Ï¡_cÚÃùed_bss.
ssid_Ën
] = '\0';

963 
»t
 = 
	`¦si_£nd_rş_chªÃl_li¡_ev’t
(
sdev
, 
chªÃl_couÁ
, 
chªÃl_li¡
, 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
ssid
,

964 
ndev_vif
->
¡a
.
Ï¡_cÚÃùed_bss
.
ssid_Ën
 + 1);

965 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

966 ià(
»t
)

967 
	`SLSI_ERR
(
sdev
, "ERR: Failedo send RCL channel†ist\n");

968 
	`kä“_skb
(
skb
);

969 
	}
}

971 
	$¦si_rx_¡¬t_d‘eù_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

973 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

974 
pow”_v®ue
 = 0;

976 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

977 
pow”_v®ue
 = 
	`çpi_g‘_s16
(
skb
, 
u
.
mlme_¡¬t_d‘eù_šd
.
»suÉ
);

978 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "S¹ D‘eù IndiÿtiÚ„eûived w™h…ow” : %d\n", 
pow”_v®ue
);

979 
	`¦si_£nd_pow”_m—su»m’t_v’dÜ_ev’t
(
sdev
, 
pow”_v®ue
);

981 ià(
	`¦si_mlme_d–_d‘eù_vif
(
sdev
, 
dev
) != 0)

982 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed for detect vif\n");

983 
sdev
->
d‘eù_vif_aùive
 = 
çl£
;

985 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

986 
	`kä“_skb
(
skb
);

987 
	}
}

989 
	$¦si_sÿn_upd©e_ssid_m­
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
sÿn_id
)

991 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

992 
›“80211_mgmt
 *
mgmt
;

993 cÚ¡ 
u8
 *
ssid_›
 = 
NULL
, *
cÚÃùed_ssid
 = NULL;

994 
i
, 
found
 = 0, 
is_cÚÃùed
 = 0;

995 
¦si_sÿn_»suÉ
 *
sÿn_»suÉ
 = 
NULL
;

996 
bªd
;

998 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

999 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
sÿn_»suÉ_mu‹x
));

1001 ià(
ndev_vif
->
aùiv©ed
 &&‚dev_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&‚dev_vif->
¡a
.
¡a_bss
) {

1002 
bªd
 = (
ndev_vif
->
¡a
.
¡a_bss
->
chªÃl
->
ûÁ”_äeq
 /

1003 1000è=ğ2 ? 
SLSI_FREQ_BAND_2GHZ
 : 
SLSI_FREQ_BAND_5GHZ
;

1004 
is_cÚÃùed
 = 1;

1005 
cÚÃùed_ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,‚dev_vif->¡a.¡a_bss->›s->
Ën
);

1009 
i
 = 0; i < 
SLSI_SCAN_SSID_MAP_MAX
; i++) {

1010 
found
 = 0;

1011 ià(!
sdev
->
ssid_m­
[
i
].
ssid_Ën
)

1015 ià(
is_cÚÃùed
 && 
	`SLSI_ETHER_EQUAL
(
ndev_vif
->
¡a
.
¡a_bss
->
bssid
, 
sdev
->
ssid_m­
[
i
].bssid) &&

1016 
sdev
->
ssid_m­
[
i
].
bªd
 == band)

1020 
sÿn_»suÉ
 = 
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»suÉs
;

1021 
sÿn_»suÉ
) {

1022 ià(
	`SLSI_ETHER_EQUAL
(
sdev
->
ssid_m­
[
i
].
bssid
, 
sÿn_»suÉ
->bssid) &&

1023 
sdev
->
ssid_m­
[
i
].
bªd
 =ğ
sÿn_»suÉ
->band) {

1027 ià(!
sÿn_»suÉ
->
hidd’
 || (sÿn_»suÉ->hidd’ && !sÿn_»suÉ->
´obe_»¥
))

1028 
sdev
->
ssid_m­
[
i
].
age
 = 
SLSI_SCAN_SSID_MAP_EXPIRY_AGE
;

1030 
found
 = 1;

1033 
sÿn_»suÉ
 = sÿn_»suÉ->
Ãxt
;

1036 ià(!
found
) {

1037 
sdev
->
ssid_m­
[
i
].
age
++;

1038 ià(
sdev
->
ssid_m­
[
i
].
age
 > 
SLSI_SCAN_SSID_MAP_EXPIRY_AGE
) {

1039 
sdev
->
ssid_m­
[
i
].
ssid_Ën
 = 0;

1040 
sdev
->
ssid_m­
[
i
].
age
 = 0;

1045 
sÿn_»suÉ
 = 
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»suÉs
;

1047 
sÿn_»suÉ
) {

1048 
ssid_›
 = 
NULL
;

1050 ià(
sÿn_»suÉ
->
hidd’
) {

1051 ià(
is_cÚÃùed
 && 
	`SLSI_ETHER_EQUAL
(
ndev_vif
->
¡a
.
¡a_bss
->
bssid
, 
sÿn_»suÉ
->bssid) &&

1052 
sÿn_»suÉ
->
bªd
 == band) {

1053 
ssid_›
 = 
cÚÃùed_ssid
;

1054 } ià(
sÿn_»suÉ
->
´obe_»¥
) {

1055 
mgmt
 = 
	`çpi_g‘_mgmt
(
sÿn_»suÉ
->
´obe_»¥
);

1056 
ssid_›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
, 
	`çpi_g‘_mgm’
(
sÿn_»suÉ
->
´obe_»¥
è- (mgmt->u.b—cÚ.v¬ŸbË - (
u8
 *)mgmt));

1060 ià(!
ssid_›
) {

1061 
sÿn_»suÉ
 = sÿn_»suÉ->
Ãxt
;

1065 
found
 = 0;

1067 
i
 = 0; i < 
SLSI_SCAN_SSID_MAP_MAX
; i++) {

1068 ià(!
sdev
->
ssid_m­
[
i
].
ssid_Ën
)

1070 ià(
	`SLSI_ETHER_EQUAL
(
sÿn_»suÉ
->
bssid
, 
sdev
->
ssid_m­
[
i
].bssid) &&

1071 
sÿn_»suÉ
->
bªd
 =ğ
sdev
->
ssid_m­
[
i
].band) {

1072 
sdev
->
ssid_m­
[
i
].
ssid_Ën
 = 
ssid_›
[1];

1073 
	`memıy
(
sdev
->
ssid_m­
[
i
].
ssid
, &
ssid_›
[2], ssid_ie[1]);

1074 
found
 = 1;

1078 ià(!
found
) {

1080 
i
 = 0; i < 
SLSI_SCAN_SSID_MAP_MAX
; i++) {

1081 ià(
sdev
->
ssid_m­
[
i
].
ssid_Ën
)

1083 
	`SLSI_ETHER_COPY
(
sdev
->
ssid_m­
[
i
].
bssid
, 
sÿn_»suÉ
->bssid);

1084 
sdev
->
ssid_m­
[
i
].
age
 = 0;

1085 
sdev
->
ssid_m­
[
i
].
ssid_Ën
 = 
ssid_›
[1];

1086 
sdev
->
ssid_m­
[
i
].
bªd
 = 
sÿn_»suÉ
->band;

1087 
	`memıy
(
sdev
->
ssid_m­
[
i
].
ssid
, &
ssid_›
[2], ssid_ie[1]);

1091 
sÿn_»suÉ
 = sÿn_»suÉ->
Ãxt
;

1093 
	}
}

1095 
	$¦si_sÿn_com¶‘e
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u16
 
sÿn_id
, 
boŞ
 
abÜ‹d
,

1096 
boŞ
 
æush_sÿn_»suÉs
)

1098 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1099 
sk_buff
 *
sÿn
;

1100 
couÁ
 = 0;

1101 *
»suÉ_couÁ
 = 
NULL
, 
max_couÁ
 = 0;

1102 
cfg80211_sÿn_šfo
 
šfo
 = {.
abÜ‹d
 =‡borted};

1103 
sÿn_»suÉs_couÁ
 = 0;

1104 
mÜe_thª_max_couÁ
 = 0;

1105 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1106 
li¡_h—d
 *
pos
, *
q
, *
bÏckli¡_pos
, *
bÏckli¡_q
;

1109 ià(
	`WARN_ON
(
sÿn_id
 >ğ
SLSI_SCAN_MAX
))

1112 ià(
sÿn_id
 =ğ
SLSI_SCAN_HW_ID
 && !
ndev_vif
->
sÿn
[sÿn_id].
sÿn_»q
)

1115 ià(
	`WARN_ON
(
sÿn_id
 =ğ
SLSI_SCAN_SCHED_ID
 && !
ndev_vif
->
sÿn
[sÿn_id].
sched_»q
))

1118 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

1119 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

1120 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

1121 ià(
æush_sÿn_»suÉs
) {

1122 
	`li¡_fÜ_—ch_§ã
(
pos
, 
q
, &
ndev_vif
->
¡a
.
ssid_šfo
) {

1123 
¦si_ssid_šfo
 *
ssid_šfo
;

1124 
li¡_h—d
 *
bssid_pos
, *
p
;

1126 
ssid_šfo
 = 
	`li¡_’Œy
(
pos
, 
¦si_ssid_šfo
, 
li¡
);

1127 
	`li¡_fÜ_—ch_§ã
(
bssid_pos
, 
p
, &
ssid_šfo
->
bssid_li¡
) {

1128 
¦si_bssid_šfo
 *
bssid_šfo
;

1130 
bssid_šfo
 = 
	`li¡_’Œy
(
bssid_pos
, 
¦si_bssid_šfo
, 
li¡
);

1131 
	`li¡_d–
(
bssid_pos
);

1132 
	`kä“
(
bssid_šfo
);

1134 
	`li¡_d–
(
pos
);

1135 
	`kä“
(
ssid_šfo
);

1137 
	`INIT_LIST_HEAD
(&
ndev_vif
->
¡a
.
ssid_šfo
);

1139 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
¡a
.
bÏckli¡_h—d
) {

1140 
¦si_bssid_bÏckli¡_šfo
 *
bÏckli¡_šfo
;

1142 
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
, 
¦si_bssid_bÏckli¡_šfo
, 
li¡
);

1143 ià(
bÏckli¡_šfo
 && (
	`jiff›s_to_m£cs
(
jiff›s
è> bÏckli¡_šfo->
’d_time
)) {

1144 
	`li¡_d–
(
bÏckli¡_pos
);

1145 
	`kä“
(
bÏckli¡_šfo
);

1148 
	`¦si_pİuÏ‹_ssid_šfo
(
sdev
, 
ndev_vif
, 
sÿn_id
);

1150 
	`¦si_sÿn_upd©e_ssid_m­
(
sdev
, 
dev
, 
sÿn_id
);

1151 
max_couÁ
 = 
	`¦si_dev_g‘_sÿn_»suÉ_couÁ
();

1154 
»suÉ_couÁ
 = &
couÁ
;

1155 
sÿn
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->sÿn[
sÿn_id
], 
»suÉ_couÁ
);

1156 
sÿn
) {

1157 
sÿn_»suÉs_couÁ
++;

1159 
	`¦si_rx_sÿn_·ss_to_cfg80211
(
sdev
, 
dev
, 
sÿn
);

1161 ià((
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)è&& (*
»suÉ_couÁ
 >ğ
max_couÁ
)) {

1162 
mÜe_thª_max_couÁ
 = 1;

1163 
	`¦si_purge_sÿn_»suÉs_locked
(
ndev_vif
, 
sÿn_id
);

1166 
sÿn
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->sÿn[
sÿn_id
], 
»suÉ_couÁ
);

1168 
	`SLSI_INFO
(
sdev
, "SÿÀcouÁ:%d APs\n", 
sÿn_»suÉs_couÁ
);

1169 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "š‹rçû:%d, sÿn_id:%d,%s\n", 
ndev_vif
->
iâum
, 
sÿn_id
,

1170 
mÜe_thª_max_couÁ
 ? "Scan„esults overflow" : "");

1171 
	`¦si_rßm_chªÃl_ÿche_´uÃ
(
dev
, 
SLSI_ROAMING_CHANNEL_CACHE_TIMEOUT
, 
NULL
);

1173 ià(
sÿn_id
 =ğ
SLSI_SCAN_HW_ID
) {

1174 ià(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
è&& (!
	`SLSI_IS_P2P_GROUP_STATE
(
sdev
))) {

1178 ià(
ndev_vif
->
aùiv©ed
)

1179 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_VIF_ACTIVE
);

1181 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_NO_VIF
);

1183 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 9, 0))

1184 
	`cfg80211_sÿn_dÚe
(
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»q
, &
šfo
);

1186 
	`cfg80211_sÿn_dÚe
(
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»q
, 
abÜ‹d
);

1189 
ndev_vif
->
sÿn
[
sÿn_id
].
sÿn_»q
 = 
NULL
;

1190 
ndev_vif
->
sÿn
[
sÿn_id
].
»queue_timeout_wÜk
 = 
çl£
;

1193 ià(
sÿn_id
 =ğ
SLSI_SCAN_SCHED_ID
 && 
sÿn_»suÉs_couÁ
 > 0)

1194 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 12, 0))

1195 
	`cfg80211_sched_sÿn_»suÉs
(
sdev
->
why
, 
ndev_vif
->
sÿn
[
sÿn_id
].
sched_»q
->
»qid
);

1197 
	`cfg80211_sched_sÿn_»suÉs
(
sdev
->
why
);

1199 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

1200 
	}
}

1202 
	$¦si_£t_2g_auto_chªÃl
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

1203 
¦si_acs_£Ëùed_chªÃls
 *
acs_£Ëùed_chªÃls
,

1204 
¦si_acs_chª_šfo
 *
ch_šfo
)

1206 
i
 = 0, 
j
 = 0, 
avg_lßd
, 
tÙ®_num_­
, 
tÙ®_rssi
, 
adjaûÁ_rssi
;

1207 
boŞ
 
®l_bss_lßd
 = 
Œue
;

1208 
mš_avg_chª_utiz©iÚ
 = 
INT_MAX
, 
mš_adjaûÁ_rssi
 = INT_MAX;

1209 
ch_idx_mš_lßd
 = 0, 
ch_idx_mš_rssi
 = 0;

1210 
mš_avg_chª_utiz©iÚ_20
 = 
INT_MAX
, 
mš_adjaûÁ_rssi_20
 = INT_MAX;

1211 
ch_idx_mš_lßd_20
 = 0, 
ch_idx_mš_rssi_20
 = 0;

1212 
»t
 = 0;

1213 
ch_li¡_Ën
 = 
MAX_24G_CHANNELS
;

1215 
acs_£Ëùed_chªÃls
->
ch_width
 = 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
->ch_width;

1216 
acs_£Ëùed_chªÃls
->
hw_mode
 = 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
->hw_mode;

1218 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "ch_lis_Ën:%d\n", 
ch_li¡_Ën
);

1219 
i
 = 0; i < 
ch_li¡_Ën
; i++) {

1220 ià(!
ch_šfo
[
i
].
chª
)

1222 
adjaûÁ_rssi
 = 0;

1223 
j
 = -2; j <= 2; j++)

1224 ià(
i
 + 
j
 >ğ0 && i + j < 
ch_li¡_Ën
)

1225 
adjaûÁ_rssi
 +ğ
ch_šfo
[
i
 + 
j
].
rssi_çùÜ
;

1226 
ch_šfo
[
i
].
adj_rssi_çùÜ
 = 
adjaûÁ_rssi
;

1227 ià(
ch_šfo
[
i
].
num_bss_lßd_­
 != 0) {

1228 
ch_šfo
[
i
].
avg_chª_utiz©iÚ
 = ch_šfo[i].
tÙ®_chª_utiz©iÚ
 /

1229 
ch_šfo
[
i
].
num_bss_lßd_­
;

1230 ià(
ch_šfo
[
i
].
avg_chª_utiz©iÚ
 < 
mš_avg_chª_utiz©iÚ_20
) {

1231 
mš_avg_chª_utiz©iÚ_20
 = 
ch_šfo
[
i
].
avg_chª_utiz©iÚ
;

1232 
ch_idx_mš_lßd_20
 = 
i
;

1233 } ià(
ch_šfo
[
i
].
avg_chª_utiz©iÚ
 =ğ
mš_avg_chª_utiz©iÚ_20
 &&

1234 
ch_šfo
[
i
].
num_­
 < ch_šfo[
ch_idx_mš_lßd_20
].num_ap) {

1235 
ch_idx_mš_lßd_20
 = 
i
;

1238 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "BSS†oad IE‚ot found\n");

1239 
®l_bss_lßd
 = 
çl£
;

1241 ià(
adjaûÁ_rssi
 < 
mš_adjaûÁ_rssi_20
) {

1242 
mš_adjaûÁ_rssi_20
 = 
adjaûÁ_rssi
;

1243 
ch_idx_mš_rssi_20
 = 
i
;

1244 } ià(
adjaûÁ_rssi
 =ğ
mš_adjaûÁ_rssi_20
 &&

1245 
ch_šfo
[
i
].
num_­
 < ch_šfo[
ch_idx_mš_rssi_20
].num_ap) {

1246 
ch_idx_mš_rssi_20
 = 
i
;

1248 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "mš„ssi:%d mš_rssi_idx:%d\n", 
mš_adjaûÁ_rssi_20
, 
ch_idx_mš_rssi_20
);

1249 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "num_ap:%d,chan:%d,total_util:%d,avg_util:%d,rssi_fac:%d,adj_rssi_fac:%d,"

1250 "bss_­:%d\n", 
ch_šfo
[
i
].
num_­
, ch_šfo[i].
chª
, ch_šfo[i].
tÙ®_chª_utiz©iÚ
,

1251 
ch_šfo
[
i
].
avg_chª_utiz©iÚ
, ch_šfo[i].
rssi_çùÜ
, ch_šfo[i].
adj_rssi_çùÜ
,

1252 
ch_šfo
[
i
].
num_bss_lßd_­
);

1255 ià(
acs_£Ëùed_chªÃls
->
ch_width
 == 40) {

1256 
i
 = 0; i < 
ch_li¡_Ën
; i++) {

1257 ià(
i
 + 4 >ğ
ch_li¡_Ën
 || !
ch_šfo
[˜+ 4].
chª
 || !ch_info[i].chan)

1259 
avg_lßd
 = 
ch_šfo
[
i
].
avg_chª_utiz©iÚ
 + ch_info[i + 4].avg_chan_utilization;

1260 
tÙ®_num_­
 = 
ch_šfo
[
i
].
num_­
 + ch_info[i + 4].num_ap;

1261 
tÙ®_rssi
 = 
ch_šfo
[
i
].
adj_rssi_çùÜ
 + ch_info[i + 4].adj_rssi_factor;

1263 ià(
avg_lßd
 < 
mš_avg_chª_utiz©iÚ
) {

1264 
mš_avg_chª_utiz©iÚ
 = 
avg_lßd
;

1265 
ch_idx_mš_lßd
 = 
i
;

1266 } ià(
avg_lßd
 =ğ
mš_avg_chª_utiz©iÚ
 &&

1267 
tÙ®_num_­
 < 
ch_šfo
[
ch_idx_mš_lßd
].
num_­
 +

1268 
ch_šfo
[
ch_idx_mš_lßd
 + 4].
num_­
) {

1269 
ch_idx_mš_lßd
 = 
i
;

1271 ià(
tÙ®_rssi
 < 
mš_adjaûÁ_rssi
) {

1272 
mš_adjaûÁ_rssi
 = 
tÙ®_rssi
;

1273 
ch_idx_mš_rssi
 = 
i
;

1274 } ià(
tÙ®_rssi
 =ğ
mš_adjaûÁ_rssi
 &&

1275 
tÙ®_num_­
 < 
ch_šfo
[
ch_idx_mš_rssi
].
num_­
 +

1276 
ch_šfo
[
ch_idx_mš_rssi
 + 4].
num_­
) {

1277 
ch_idx_mš_rssi
 = 
i
;

1280 ià(
®l_bss_lßd
) {

1281 
acs_£Ëùed_chªÃls
->
´i_chªÃl
 = 
ch_šfo
[
ch_idx_mš_lßd
].
chª
;

1282 
acs_£Ëùed_chªÃls
->
£c_chªÃl
 = 
ch_šfo
[
ch_idx_mš_lßd
].
chª
 + 4;

1284 
acs_£Ëùed_chªÃls
->
´i_chªÃl
 = 
ch_šfo
[
ch_idx_mš_rssi
].
chª
;

1285 
acs_£Ëùed_chªÃls
->
£c_chªÃl
 = 
ch_šfo
[
ch_idx_mš_rssi
].
chª
 + 4;

1288 ià(!
acs_£Ëùed_chªÃls
->
´i_chªÃl
)

1289 
acs_£Ëùed_chªÃls
->
ch_width
 = 20;

1292 ià(
acs_£Ëùed_chªÃls
->
ch_width
 == 20) {

1293 ià(
®l_bss_lßd
)

1294 
acs_£Ëùed_chªÃls
->
´i_chªÃl
 = 
ch_šfo
[
ch_idx_mš_lßd_20
].
chª
;

1296 
acs_£Ëùed_chªÃls
->
´i_chªÃl
 = 
ch_šfo
[
ch_idx_mš_rssi_20
].
chª
;

1298  
»t
;

1299 
	}
}

1301 
	$¦si_is_40mhz_5gchª
(
u8
 
´i_chªÃl
, u8 
£c_chªÃl
)

1303 
¦si_40mhz_chª
[12] = {38, 46, 54, 62, 102, 110, 118, 126, 134, 142, 151, 159};

1304 
i
;

1306 
i
 = 0; i < 12; i++) {

1307 ià(
´i_chªÃl
 =ğ
¦si_40mhz_chª
[
i
] - 2 && 
£c_chªÃl
 == slsi_40mhz_chan[i] + 2)

1309 ià(
´i_chªÃl
 < 
¦si_40mhz_chª
[
i
])

1313 
	}
}

1315 
	$¦si_is_80mhz_5gchª
(
u8
 
´i_chªÃl
, u8 
Ï¡_chªÃl
)

1317 
¦si_80mhz_chª
[6] = {42, 58, 106, 122, 138, 155};

1318 
i
;

1320 
i
 = 0; i < 6; i++) {

1321 ià(
´i_chªÃl
 =ğ
¦si_80mhz_chª
[
i
] - 6 && 
Ï¡_chªÃl
 == slsi_80mhz_chan[i] + 6)

1323 ià(
´i_chªÃl
 < 
¦si_80mhz_chª
[
i
])

1327 
	}
}

1329 
	$¦si_£t_5g_auto_chªÃl
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

1330 
¦si_acs_£Ëùed_chªÃls
 *
acs_£Ëùed_chªÃls
,

1331 
¦si_acs_chª_šfo
 *
ch_šfo
)

1333 
i
 = 0, 
avg_lßd
, 
tÙ®_num_­
;

1334 
boŞ
 
®l_bss_lßd
 = 
Œue
, 
nÚe_bss_lßd
 =rue;

1335 
mš_num_­
 = 
INT_MAX
, 
mš_avg_chª_utiz©iÚ
 = INT_MAX;

1336 
ch_idx_mš_lßd
 = 0, 
ch_idx_mš_­
 = 0;

1337 
mš_avg_chª_utiz©iÚ_20
 = 
INT_MAX
, 
mš_num_­_20
 = INT_MAX;

1338 
ch_idx_mš_lßd_20
 = 0, 
ch_idx_mš_­_20
 = 0;

1339 
»t
 = 0;

1340 
ch_li¡_Ën
 = 
MAX_5G_CHANNELS
;

1342 
acs_£Ëùed_chªÃls
->
ch_width
 = 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
->ch_width;

1343 
acs_£Ëùed_chªÃls
->
hw_mode
 = 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
->hw_mode;

1345 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "ch_lis_Ën:%d\n", 
ch_li¡_Ën
);

1346 
i
 = 0; i < 
ch_li¡_Ën
; i++) {

1347 ià(!
ch_šfo
[
i
].
chª
)

1349 ià(
ch_šfo
[
i
].
num_bss_lßd_­
 != 0) {

1350 
ch_šfo
[
i
].
avg_chª_utiz©iÚ
 = ch_šfo[i].
tÙ®_chª_utiz©iÚ
 /

1351 
ch_šfo
[
i
].
num_bss_lßd_­
;

1352 ià(
ch_šfo
[
i
].
avg_chª_utiz©iÚ
 < 
mš_avg_chª_utiz©iÚ_20
) {

1353 
mš_avg_chª_utiz©iÚ_20
 = 
ch_šfo
[
i
].
avg_chª_utiz©iÚ
;

1354 
ch_idx_mš_lßd_20
 = 
i
;

1355 } ià(
ch_šfo
[
i
].
avg_chª_utiz©iÚ
 =ğ
mš_avg_chª_utiz©iÚ_20
 &&

1356 
ch_šfo
[
i
].
num_­
 < ch_šfo[
ch_idx_mš_lßd_20
].num_ap) {

1357 
ch_idx_mš_lßd_20
 = 
i
;

1359 
nÚe_bss_lßd
 = 
çl£
;

1361 ià(
ch_šfo
[
i
].
num_­
 < 
mš_num_­_20
) {

1362 
mš_num_­_20
 = 
ch_šfo
[
i
].
num_­
;

1363 
ch_idx_mš_­_20
 = 
i
;

1365 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "BSS†oad IE‚ot found\n");

1366 
ch_šfo
[
i
].
avg_chª_utiz©iÚ
 = 128;

1367 
®l_bss_lßd
 = 
çl£
;

1369 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "num_ap:%d chan:%d,otal_chan_util:%d,‡vg_chan_util:%d, bss_load_ap:%d\n",

1370 
ch_šfo
[
i
].
num_­
, ch_šfo[i].
chª
, ch_šfo[i].
tÙ®_chª_utiz©iÚ
,

1371 
ch_šfo
[
i
].
avg_chª_utiz©iÚ
, ch_šfo[i].
num_bss_lßd_­
);

1374 ià(
acs_£Ëùed_chªÃls
->
ch_width
 == 80) {

1375 
i
 = 0; i < 
ch_li¡_Ën
; i++) {

1376 ià(
i
 + 3 >ğ
ch_li¡_Ën
)

1378 ià(!
ch_šfo
[
i
].
chª
 || !ch_info[i + 1].chan || !ch_info[i + 2].chan || !ch_info[i + 3].chan)

1380 ià(
	`¦si_is_80mhz_5gchª
(
ch_šfo
[
i
].
chª
, ch_info[i + 3].chan)) {

1381 
avg_lßd
 = 
ch_šfo
[
i
].
avg_chª_utiz©iÚ
 + ch_info[i + 1].avg_chan_utilization +

1382 
ch_šfo
[
i
 + 2].
avg_chª_utiz©iÚ
 + ch_info[i + 3].avg_chan_utilization;

1383 
tÙ®_num_­
 = 
ch_šfo
[
i
].
num_­
 + ch_info[i + 1].num_ap + ch_info[i + 2].num_ap +

1384 
ch_šfo
[
i
 + 3].
num_­
;

1385 ià(
avg_lßd
 < 
mš_avg_chª_utiz©iÚ
) {

1386 
mš_avg_chª_utiz©iÚ
 = 
avg_lßd
;

1387 
ch_idx_mš_lßd
 = 
i
;

1388 } ià(
avg_lßd
 =ğ
mš_avg_chª_utiz©iÚ
 && 
tÙ®_num_­
 <

1389 (
ch_šfo
[
ch_idx_mš_lßd
].
num_­
 + ch_info[ch_idx_min_load + 1].num_ap +

1390 
ch_šfo
[
ch_idx_mš_lßd
 + 2].
num_­
 +

1391 
ch_šfo
[
ch_idx_mš_lßd
 + 3].
num_­
)) {

1392 
ch_idx_mš_lßd
 = 
i
;

1394 ià(
tÙ®_num_­
 < 
mš_num_­
) {

1395 
mš_num_­
 = 
tÙ®_num_­
;

1396 
ch_idx_mš_­
 = 
i
;

1400 ià(
®l_bss_lßd
 || 
mš_avg_chª_utiz©iÚ
 <= 512) {

1401 
acs_£Ëùed_chªÃls
->
´i_chªÃl
 = 
ch_šfo
[
ch_idx_mš_lßd
].
chª
;

1402 
acs_£Ëùed_chªÃls
->
vht_£g0_ûÁ”_ch
 = 
ch_šfo
[
ch_idx_mš_lßd
].
chª
 + 6;

1403 } ià(
nÚe_bss_lßd
 || 
mš_avg_chª_utiz©iÚ
 > 512) {

1404 
acs_£Ëùed_chªÃls
->
´i_chªÃl
 = 
ch_šfo
[
ch_idx_mš_­
].
chª
;

1405 
acs_£Ëùed_chªÃls
->
vht_£g0_ûÁ”_ch
 = 
ch_šfo
[
ch_idx_mš_­
].
chª
 + 6;

1408 ià(!
acs_£Ëùed_chªÃls
->
´i_chªÃl
)

1409 
acs_£Ëùed_chªÃls
->
ch_width
 = 40;

1412 ià(
acs_£Ëùed_chªÃls
->
ch_width
 == 40) {

1413 
i
 = 0; i < 
ch_li¡_Ën
; i++) {

1414 ià(!
ch_šfo
[
i
].
chª
 || i + 1 >ğ
ch_li¡_Ën
 || !ch_info[i + 1].chan)

1416 ià(
	`¦si_is_40mhz_5gchª
(
ch_šfo
[
i
].
chª
, ch_info[i + 1].chan)) {

1417 
avg_lßd
 = 
ch_šfo
[
i
].
avg_chª_utiz©iÚ
 + ch_info[i + 1].avg_chan_utilization;

1418 
tÙ®_num_­
 = 
ch_šfo
[
i
].
num_­
 + ch_info[i + 1].num_ap;

1419 ià(
avg_lßd
 < 
mš_avg_chª_utiz©iÚ
) {

1420 
mš_avg_chª_utiz©iÚ
 = 
avg_lßd
;

1421 
ch_idx_mš_lßd
 = 
i
;

1422 } ià(
avg_lßd
 =ğ
mš_avg_chª_utiz©iÚ
 && 
tÙ®_num_­
 <

1423 
ch_šfo
[
ch_idx_mš_lßd
].
num_­
 + ch_info[ch_idx_min_load + 1].num_ap) {

1424 
ch_idx_mš_lßd
 = 
i
;

1426 ià(
tÙ®_num_­
 < 
mš_num_­
) {

1427 
mš_num_­
 = 
tÙ®_num_­
;

1428 
ch_idx_mš_­
 = 
i
;

1432 ià(
®l_bss_lßd
 || 
mš_avg_chª_utiz©iÚ
 <= 256) {

1433 
acs_£Ëùed_chªÃls
->
´i_chªÃl
 = 
ch_šfo
[
ch_idx_mš_lßd
].
chª
;

1434 
acs_£Ëùed_chªÃls
->
£c_chªÃl
 = 
ch_šfo
[
ch_idx_mš_lßd
 + 1].
chª
;

1435 } ià(
nÚe_bss_lßd
 || 
mš_avg_chª_utiz©iÚ
 > 256) {

1436 
acs_£Ëùed_chªÃls
->
´i_chªÃl
 = 
ch_šfo
[
ch_idx_mš_­
].
chª
;

1437 
acs_£Ëùed_chªÃls
->
£c_chªÃl
 = 
ch_šfo
[
ch_idx_mš_­
 + 1].
chª
;

1440 ià(!
acs_£Ëùed_chªÃls
->
´i_chªÃl
)

1441 
acs_£Ëùed_chªÃls
->
ch_width
 = 20;

1444 ià(
acs_£Ëùed_chªÃls
->
ch_width
 == 20) {

1445 ià(
®l_bss_lßd
 || 
mš_avg_chª_utiz©iÚ_20
 < 128)

1446 
acs_£Ëùed_chªÃls
->
´i_chªÃl
 = 
ch_šfo
[
ch_idx_mš_lßd_20
].
chª
;

1447 ià(
nÚe_bss_lßd
 || 
mš_avg_chª_utiz©iÚ_20
 >= 128)

1448 
acs_£Ëùed_chªÃls
->
´i_chªÃl
 = 
ch_šfo
[
ch_idx_mš_­_20
].
chª
;

1450  
»t
;

1451 
	}
}

1453 
	$¦si_£t_bªd_ªy_auto_chªÃl
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
,

1454 
¦si_acs_£Ëùed_chªÃls
 *
acs_£Ëùed_chªÃls
,

1455 
¦si_acs_chª_šfo
 *
ch_šfo
)

1457 
¦si_acs_chª_šfo
 
ch_šfo_2g
[
MAX_24G_CHANNELS
];

1458 
¦si_acs_chª_šfo
 
ch_šfo_5g
[
MAX_5G_CHANNELS
];

1459 
¦si_acs_£Ëùed_chªÃls
 
acs_£Ëùed_chªÃls_5g
;

1460 
¦si_acs_£Ëùed_chªÃls
 
acs_£Ëùed_chªÃls_2g
;

1461 
be¡_chªÃl_5g
 = -1;

1462 
be¡_chªÃl_5g_num_­
 = 0;

1463 
be¡_chªÃl_2g
 = -1;

1464 
be¡_chªÃl_2g_num_­
 = 0;

1465 
i
, 
»t
 = 0;

1466 
j
 = 0;

1468 
	`mem£t
(&
acs_£Ëùed_chªÃls_5g
, 0, (acs_selected_channels_5g));

1469 
	`mem£t
(&
acs_£Ëùed_chªÃls_2g
, 0, (acs_selected_channels_2g));

1470 
	`mem£t
(&
ch_šfo_5g
, 0, (ch_info_5g));

1471 
	`mem£t
(&
ch_šfo_2g
, 0, (ch_info_2g));

1473 
i
 = 
MAX_24G_CHANNELS
; i < 
MAX_CHAN_VALUE_ACS
; i++) {

1474 
ch_šfo_5g
[
j
] = 
ch_šfo
[
i
];

1475 
j
++;

1477 
»t
 = 
	`¦si_£t_5g_auto_chªÃl
(
sdev
, 
ndev_vif
, &
acs_£Ëùed_chªÃls_5g
, 
ch_šfo_5g
);

1479 ià(
»t
 == 0) {

1480 
be¡_chªÃl_5g
 = 
acs_£Ëùed_chªÃls_5g
.
´i_chªÃl
;

1481 
i
 = 0; i < 
MAX_5G_CHANNELS
; i++) {

1482 ià(
ch_šfo_5g
[
i
].
chª
 =ğ
be¡_chªÃl_5g
) {

1483 
be¡_chªÃl_5g_num_­
 = 
ch_šfo_5g
[
i
].
num_­
;

1487 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "Be¡ 5G chªÃÈğ%d,‚um_­ = %d\n", 
be¡_chªÃl_5g
,

1488 
be¡_chªÃl_5g_num_­
);

1490 ià(
be¡_chªÃl_5g_num_­
 < 
MAX_AP_THRESHOLD
) {

1491 *
acs_£Ëùed_chªÃls
 = 
acs_£Ëùed_chªÃls_5g
;

1492 
acs_£Ëùed_chªÃls
->
hw_mode
 = 
SLSI_ACS_MODE_IEEE80211A
;

1493  
»t
;

1497 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "5G APhresholdƒxceed,ryingo select from 2G band\n");

1499 
i
 = 0; i < 
MAX_24G_CHANNELS
; i++)

1500 
ch_šfo_2g
[
i
] = 
ch_šfo
[i];

1501 
»t
 = 
	`¦si_£t_2g_auto_chªÃl
(
sdev
, 
ndev_vif
, &
acs_£Ëùed_chªÃls_2g
, 
ch_šfo_2g
);

1503 ià(
»t
 == 0) {

1504 
be¡_chªÃl_2g
 = 
acs_£Ëùed_chªÃls_2g
.
´i_chªÃl
;

1505 
i
 = 0; i < 
MAX_24G_CHANNELS
; i++) {

1506 ià(
ch_šfo_2g
[
i
].
chª
 =ğ
be¡_chªÃl_2g
) {

1507 
be¡_chªÃl_2g_num_­
 = 
ch_šfo_2g
[
i
].
num_­
;

1511 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "Be¡ 2G chªÃÈğ%d,‚um_­ = %d\n", 
be¡_chªÃl_2g
,

1512 
be¡_chªÃl_2g_num_­
);

1513 ià(
be¡_chªÃl_5g
 == -1) {

1514 *
acs_£Ëùed_chªÃls
 = 
acs_£Ëùed_chªÃls_2g
;

1515 
acs_£Ëùed_chªÃls
->
hw_mode
 = 
SLSI_ACS_MODE_IEEE80211G
;

1516  
»t
;

1520 ià(
be¡_chªÃl_5g_num_­
 > 
be¡_chªÃl_2g_num_­
) {

1521 *
acs_£Ëùed_chªÃls
 = 
acs_£Ëùed_chªÃls_2g
;

1522 
acs_£Ëùed_chªÃls
->
hw_mode
 = 
SLSI_ACS_MODE_IEEE80211G
;

1524 *
acs_£Ëùed_chªÃls
 = 
acs_£Ëùed_chªÃls_5g
;

1525 
acs_£Ëùed_chªÃls
->
hw_mode
 = 
SLSI_ACS_MODE_IEEE80211A
;

1528  
»t
;

1529 
	}
}

1531 
	$¦si_acs_g‘_rssi_çùÜ
(
¦si_dev
 *
sdev
, 
rssi
, 
u8
 
ch_ut
)

1533 
äac_pow_v®
[10] = {10, 12, 15, 19, 25, 31, 39, 50, 63, 79};

1534 
»s
 = 1;

1535 
i
;

1537 ià(
rssi
 < 0)

1538 
rssi
 = 0 -„ssi;

1540  
INT_MAX
;

1541 
i
 = 0; i < 
rssi
 / 10; i++)

1542 
»s
 *= 10;

1543 
»s
 = (10000000 * 
ch_ut
 /„esè/ 
äac_pow_v®
[
rssi
 % 10];

1545 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "ch_ut:%d\n", 
ch_ut
);

1546  
»s
;

1547 
	}
}

1549 
¦si_acs_chª_šfo
 *
	$¦si_acs_sÿn_»suÉs
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
, 
u16
 
sÿn_id
)

1551 
sk_buff
 *
sÿn_»s
;

1552 
sk_buff
 *
unique_sÿn
;

1553 
sk_buff_h—d
 
unique_sÿn_»suÉs
;

1554 
¦si_acs_chª_šfo
 *
ch_šfo
 = 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
->
acs_chª_šfo
;

1556 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "Received‡cs_results\n");

1557 
	`skb_queue_h—d_š™
(&
unique_sÿn_»suÉs
);

1558 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

1559 
sÿn_»s
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
], 
NULL
);

1561 
sÿn_»s
) {

1562 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
sÿn_»s
);

1563 
size_t
 
mgmt_Ën
 = 
	`çpi_g‘_mgm’
(
sÿn_»s
);

1564 
›“80211_chªÃl
 *
sÿn_chªÃl
;

1565 
idx
 = 0;

1566 cÚ¡ 
u8
 *
›_d©a
;

1567 cÚ¡ 
u8
 *
›
;

1568 
›_Ën
;

1569 
u8
 
ch_ut
 = 128;

1571 
size_t
 
›s_Ën
 = 
mgmt_Ën
 - 
	`off£tof
(
›“80211_mgmt
, 
u
.
b—cÚ
.
v¬ŸbË
);

1573 
	`skb_queue_w®k
(&
unique_sÿn_»suÉs
, 
unique_sÿn
) {

1574 
›“80211_mgmt
 *
unique_mgmt
 = 
	`çpi_g‘_mgmt
(
unique_sÿn
);

1576 ià(
	`com·»_‘h”_addr
(
mgmt
->
bssid
, 
unique_mgmt
->bssid) == 0)

1577 
Ãxt_sÿn
;

1579 
	`skb_queue_h—d
(&
unique_sÿn_»suÉs
, 
sÿn_»s
);

1580 
sÿn_chªÃl
 = 
	`¦si_fšd_sÿn_chªÃl
(
sdev
, 
mgmt
, 
mgmt_Ën
,

1581 
	`çpi_g‘_u16
(
sÿn_»s
, 
u
.
mlme_sÿn_šd
.
chªÃl_äequ’cy
) / 2);

1582 ià(!
sÿn_chªÃl
)

1583 
Ãxt_sÿn
;

1584 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "scan„esult (scan_id:%d, %pM, channel:%d,„ssi:%d, ie_len = %zu)\n",

1585 
	`çpi_g‘_u16
(
sÿn_»s
, 
u
.
mlme_sÿn_šd
.
sÿn_id
),

1586 
	`çpi_g‘_mgmt
(
sÿn_»s
)->
bssid
, 
sÿn_chªÃl
->
hw_v®ue
,

1587 
	`çpi_g‘_s16
(
sÿn_»s
, 
u
.
mlme_sÿn_šd
.
rssi
),

1588 
›s_Ën
);

1590 
idx
 = 
	`¦si_fšd_chª_idx
(
sÿn_chªÃl
->
hw_v®ue
, 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
->
hw_mode
);

1591 ià(
idx
 < 0) {

1592 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "idx i nÙ iÀ¿ngidx=%d\n", 
idx
);

1593 
Ãxt_sÿn
;

1595 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "chª_idx:%d chª_v®ue: %d\n", 
idx
, 
ch_šfo
[idx].
chª
);

1597 ià(
ch_šfo
[
idx
].
chª
) {

1598 
ch_šfo
[
idx
].
num_­
 += 1;

1599 
›
 = 
	`cfg80211_fšd_›
(
WLAN_EID_QBSS_LOAD
, 
mgmt
->
u
.
b—cÚ
.
v¬ŸbË
, 
›s_Ën
);

1600 ià(
›
) {

1601 
›_Ën
 = 
›
[1];

1602 
›_d©a
 = &
›
[2];

1603 ià(
›_Ën
 >= 3) {

1604 
ch_ut
 = 
›_d©a
[2];

1605 
ch_šfo
[
idx
].
num_bss_lßd_­
 += 1;

1606 
ch_šfo
[
idx
].
tÙ®_chª_utiz©iÚ
 +ğ
ch_ut
;

1609 ià(
idx
 =ğ
sÿn_chªÃl
->
hw_v®ue
 - 1) {

1610 
»s
 = 0;

1612 
»s
 = 
	`¦si_acs_g‘_rssi_çùÜ
(
sdev
, 
	`çpi_g‘_s16
(
sÿn_»s
, 
u
.
mlme_sÿn_šd
.
rssi
),

1613 
ch_ut
);

1614 
ch_šfo
[
idx
].
rssi_çùÜ
 +ğ
»s
;

1615 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "ch_šfo[idx].rssi_çùÜ:%d\n", 
ch_šfo
[
idx
].
rssi_çùÜ
);

1618 
Ãxt_sÿn
;

1620 
Ãxt_sÿn
:

1621 
sÿn_»s
 = 
	`¦si_dequeue_ÿched_sÿn_»suÉ
(&
ndev_vif
->
sÿn
[
sÿn_id
], 
NULL
);

1623 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_»suÉ_mu‹x
);

1624 
	`skb_queue_purge
(&
unique_sÿn_»suÉs
);

1625  
ch_šfo
;

1626 
	}
}

1628 
	$¦si_acs_sÿn_com¶‘e
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
, 
u16
 
sÿn_id
)

1630 
¦si_acs_£Ëùed_chªÃls
 
acs_£Ëùed_chªÃls
;

1631 
¦si_acs_chª_šfo
 *
ch_šfo
;

1632 
r
 = 0;

1634 
	`mem£t
(&
acs_£Ëùed_chªÃls
, 0, (acs_selected_channels));

1635 
ch_šfo
 = 
	`¦si_acs_sÿn_»suÉs
(
sdev
, 
ndev_vif
, 
sÿn_id
);

1636 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
->
hw_mode
 =ğ
SLSI_ACS_MODE_IEEE80211A
)

1637 
r
 = 
	`¦si_£t_5g_auto_chªÃl
(
sdev
, 
ndev_vif
, &
acs_£Ëùed_chªÃls
, 
ch_šfo
);

1638 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
->
hw_mode
 =ğ
SLSI_ACS_MODE_IEEE80211B
 ||

1639 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
->
hw_mode
 =ğ
SLSI_ACS_MODE_IEEE80211G
)

1640 
r
 = 
	`¦si_£t_2g_auto_chªÃl
(
sdev
, 
ndev_vif
, &
acs_£Ëùed_chªÃls
, 
ch_šfo
);

1641 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
->
hw_mode
 =ğ
SLSI_ACS_MODE_IEEE80211ANY
)

1642 
r
 = 
	`¦si_£t_bªd_ªy_auto_chªÃl
(
sdev
, 
ndev_vif
, &
acs_£Ëùed_chªÃls
, 
ch_šfo
);

1644 
r
 = -
EINVAL
;

1645 ià(!
r
) {

1646 
r
 = 
	`¦si_£nd_acs_ev’t
(
sdev
, 
acs_£Ëùed_chªÃls
);

1647 ià(
r
 != 0)

1648 
	`SLSI_ERR
(
sdev
, "Could‚ot send ACS vendorƒvent up\n");

1650 
	`SLSI_ERR
(
sdev
, "£t_auto_chªÃÈçed: %d\n", 
r
);

1652 
sdev
->
acs_chªÃl_sw™ched
 = 
Œue
;

1653 
	`kä“
(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
);

1654 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
 = 
NULL
;

1655 
	}
}

1657 
	$¦si_rx_sÿn_dÚe_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

1659 
u16
 
sÿn_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_sÿn_dÚe_šd
.scan_id);

1660 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1662 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1663 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
sÿn_mu‹x
);

1664 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_GSCAN
, "Reûived sÿn_id:%#x\n", 
sÿn_id
);

1666 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


1667 ià(
	`¦si_is_gsÿn_id
(
sÿn_id
)) {

1668 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_GSCAN
, "sÿn_id:%#x\n", 
sÿn_id
);

1670 
	`¦si_gsÿn_hªdË_sÿn_»suÉ
(
sdev
, 
dev
, 
skb
, 
sÿn_id
, 
Œue
);

1672 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

1673 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1677 
sÿn_id
 = (scan_id & 0xFF);

1679 ià(
sÿn_id
 =ğ
SLSI_SCAN_HW_ID
 && (
ndev_vif
->
sÿn
[SLSI_SCAN_HW_ID].
sÿn_»q
 ||

1680 
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
))

1681 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
sÿn_timeout_wÜk
);

1682 ià(
ndev_vif
->
sÿn
[
SLSI_SCAN_HW_ID
].
acs_»que¡
)

1683 
	`¦si_acs_sÿn_com¶‘e
(
sdev
, 
ndev_vif
, 
sÿn_id
);

1685 
	`¦si_sÿn_com¶‘e
(
sdev
, 
dev
, 
sÿn_id
, 
çl£
, 
Œue
);

1690 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&‚dev_vif->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
 &&

1691 
ndev_vif
->
iáy³
 !ğ
NL80211_IFTYPE_P2P_CLIENT
) {

1692 cÚ¡ 
u8
 *
cÚÃùed_ssid
 = 
NULL
;

1693 
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
ÃtwÜk_m­
;

1694 
u32
 
chªÃls_couÁ
 = 0;

1695 
u8
 
chªÃls
[
SLSI_ROAMING_CHANNELS_MAX
];

1696 
u8
 
m”ged_chªÃls
[
SLSI_ROAMING_CHANNELS_MAX
 * 2];

1697 
u32
 
m”ge_chª_couÁ
 = 0;

1699 
	`mem£t
(
m”ged_chªÃls
, 0, (merged_channels));

1700 
cÚÃùed_ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,

1701 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
Ën
);

1702 
ÃtwÜk_m­
 = 
	`¦si_rßm_chªÃl_ÿche_g‘
(
dev
, 
cÚÃùed_ssid
);

1703 ià(
ÃtwÜk_m­
) {

1704 
ndev_vif
->
¡a
.
chªÃls_24_ghz
 = 
ÃtwÜk_m­
->channels_24_ghz;

1705 
ndev_vif
->
¡a
.
chªÃls_5_ghz
 = 
ÃtwÜk_m­
->channels_5_ghz;

1707 
chªÃls_couÁ
 = 
	`¦si_rßm_chªÃl_ÿche_g‘_chªÃls_št
(
dev
, 
ÃtwÜk_m­
, 
chªÃls
);

1708 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1709 
m”ge_chª_couÁ
 = 
	`¦si_m”ge_li¡s
(
chªÃls
, 
chªÃls_couÁ
,

1710 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
chªÃls
,

1711 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
,

1712 
m”ged_chªÃls
);

1713 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

1714 ià(
	`¦si_mlme_£t_ÿched_chªÃls
(
sdev
, 
dev
, 
m”ge_chª_couÁ
, 
m”ged_chªÃls
) != 0)

1715 
	`SLSI_NET_ERR
(
dev
, "MLME-SET-CACHED-CHANNELS.req failed\n");

1719 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
sÿn_mu‹x
);

1720 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1721 
	`kä“_skb
(
skb
);

1722 
	}
}

1724 
	$¦si_rx_chªÃl_sw™ched_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

1726 
u16
 
äeq
 = 0;

1727 
width
;

1728 
´im¬y_chª_pos
;

1729 
u16
 
‹mp_chª_šfo
;

1730 
cfg80211_chª_def
 
chªdef
 = {};

1731 
u16
 
cf1
 = 0;

1732 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1734 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1735 ià(!
ndev_vif
->
aùiv©ed
) {

1736 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

1737 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1738 
	`kä“_skb
(
skb
);

1742 
‹mp_chª_šfo
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_chªÃl_sw™ched_šd
.
chªÃl_šfÜm©iÚ
);

1743 
cf1
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_chªÃl_sw™ched_šd
.
chªÃl_äequ’cy
);

1744 
cf1
 = cf1 / 2;

1746 
´im¬y_chª_pos
 = (
‹mp_chª_šfo
 >> 8);

1747 
width
 = (
‹mp_chª_šfo
 & 0x00FF);

1750 ià(
width
 == 40)

1751 
äeq
 = 
cf1
 + (
´im¬y_chª_pos
 * 20) - 10;

1752 ià(
width
 == 80)

1753 
äeq
 = 
cf1
 + (
´im¬y_chª_pos
 * 20) - 30;

1755 
äeq
 = 
cf1
;

1757 ià(
width
 == 20)

1758 
width
 = 
NL80211_CHAN_WIDTH_20
;

1759 ià(
width
 == 40)

1760 
width
 = 
NL80211_CHAN_WIDTH_40
;

1761 ià(
width
 == 80)

1762 
width
 = 
NL80211_CHAN_WIDTH_80
;

1763 ià(
width
 == 160)

1764 
width
 = 
NL80211_CHAN_WIDTH_160
;

1766 
chªdef
.
chª
 = 
	`›“80211_g‘_chªÃl
(
sdev
->
why
, 
äeq
);

1767 
chªdef
.
width
 = width;

1768 
chªdef
.
ûÁ”_äeq1
 = 
cf1
;

1769 
chªdef
.
ûÁ”_äeq2
 = 0;

1771 
ndev_vif
->
­
.
chªÃl_äeq
 = 
äeq
;

1772 
ndev_vif
->
chª
 = 
chªdef
.chan;

1773 
ndev_vif
->
chªdef_§ved
 = 
chªdef
;

1774 
	`cfg80211_ch_sw™ch_nÙify
(
dev
, &
chªdef
);

1775 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1776 
	`kä“_skb
(
skb
);

1777 
	}
}

1779 
	$__¦si_rx_blockack_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

1781 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1782 
¦si_³”
 *
³”
;

1784 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
,

1787 
	`çpi_g‘_vif
(
skb
),

1788 
	`çpi_g‘_buff
(
skb
, 
u
.
ma_blockack_šd
.
³”_q¡a_add»ss
),

1789 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_blockack_šd
.
blockack_·¿m‘”_£t
),

1790 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_blockack_šd
.
£qu’û_numb”
),

1791 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_blockack_šd
.
»asÚ_code
),

1792 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_blockack_šd
.
dœeùiÚ
));

1794 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
	`çpi_g‘_buff
(
skb
, 
u
.
ma_blockack_šd
.
³”_q¡a_add»ss
));

1795 
	`WARN_ON
(!
³”
);

1797 ià(
³”
) {

1799 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && 
³”
->
cÚÃùed_¡©e
 =ğ
SLSI_STA_CONN_STATE_CONNECTING
) {

1800 
	`SLSI_DBG3
(
sdev
, 
SLSI_MLME
, "Buffering MA-BlockAck.Indication\n");

1801 
	`skb_queue_
(&
³”
->
bufã»d_äames
, 
skb
);

1804 
	`¦si_hªdË_blockack
(

1805 
dev
,

1806 
³”
,

1807 
	`çpi_g‘_vif
(
skb
),

1808 
	`çpi_g‘_buff
(
skb
, 
u
.
ma_blockack_šd
.
³”_q¡a_add»ss
),

1809 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_blockack_šd
.
blockack_·¿m‘”_£t
),

1810 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_blockack_šd
.
£qu’û_numb”
),

1811 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_blockack_šd
.
»asÚ_code
),

1812 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_blockack_šd
.
dœeùiÚ
)

1816 
	`kä“_skb
(
skb
);

1817 
	}
}

1819 
	$¦si_rx_blockack_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

1821 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1823 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1824 ià(!
ndev_vif
->
aùiv©ed
) {

1825 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

1826 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1827 
	`kä“_skb
(
skb
);

1830 
	`__¦si_rx_blockack_šd
(
sdev
, 
dev
, 
skb
);

1831 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1832 
	}
}

1834 
	$¦si_rx_ma_to_mlme_d–ba_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

1836 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1837 
§p_drv_ma_to_mlme_d–ba_»q
 *
d–ba_»q
 = (§p_drv_ma_to_mlme_d–ba_»q *)(
skb
->
d©a
);

1839 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

1840 ià(!
ndev_vif
->
aùiv©ed
) {

1841 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

1842 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1843 
	`kä“_skb
(
skb
);

1847 
	`¦si_mlme_d–ba_»q
(
sdev
,

1848 
dev
,

1849 
d–ba_»q
->
³”_q¡a_add»ss
,

1850 
d–ba_»q
->
u£r_´iÜ™y
,

1851 
d–ba_»q
->
dœeùiÚ
,

1852 
d–ba_»q
->
£qu’û_numb”
,

1853 
d–ba_»q
->
»asÚ
);

1855 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

1856 
	`kä“_skb
(
skb
);

1857 
	}
}

1859 
boŞ
 
	$g‘_wmm_›_äom_»¥_›
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
u8
 *
»¥_›
, 
size_t
 
»¥_›_Ën
, cÚ¡ u8 **
wmm_–em
, 
u16
 *
wmm_–em_Ën
)

1861 
›“80211_v’dÜ_›
 *
›
;

1863 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

1865 ià(!
»¥_›
) {

1866 
	`SLSI_NET_ERR
(
dev
, "Received invalid…ointerohe ie's ofhe‡ssociation„esponse\n");

1867  
çl£
;

1870 *
wmm_–em
 = 
»¥_›
;

1871 *
wmm_–em
 && (*wmm_–em - 
»¥_›
 < 
»¥_›_Ën
)) {

1873 *
wmm_–em
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WMM
, *wmm_elem,

1874 
»¥_›_Ën
 - (*
wmm_–em
 - 
»¥_›
));

1878 ià(*
wmm_–em
 && (*wmm_–em)[1] > 6 && (*wmm_–em)[6] =ğ
WMM_OUI_SUBTYPE_PARAMETER_ELEMENT
)

1880 ià(*
wmm_–em
)

1881 *
wmm_–em
 += (*wmm_elem)[1];

1884 ià(!(*
wmm_–em
)) {

1885 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "No WMM IE\n");

1886  
çl£
;

1888 
›
 = (
›“80211_v’dÜ_›
 *)*
wmm_–em
;

1889 *
wmm_–em_Ën
 = 
›
->
Ën
 + 2;

1891 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "WMM IE„eceived‡nd…arsed successfully\n");

1892  
Œue
;

1893 
	}
}

1895 
boŞ
 
	$¡a_wmm_upd©e_u­sd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
, 
u8
 *
assoc_»q_›
, 
size_t
 
assoc_»q_›_Ën
)

1897 cÚ¡ 
u8
 *
wmm_šfÜm©iÚ_›
;

1899 ià(!
assoc_»q_›
) {

1900 
	`SLSI_NET_ERR
(
dev
, "null„eferenceo IE\n");

1901  
çl£
;

1904 
wmm_šfÜm©iÚ_›
 = 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WMM
, 
assoc_»q_›
, 
assoc_»q_›_Ën
);

1905 ià(!
wmm_šfÜm©iÚ_›
) {

1906 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "no WMM IE\n");

1907  
çl£
;

1910 
³”
->
u­sd
 = 
wmm_šfÜm©iÚ_›
[8];

1911 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "³”->u­sd = 0x%x\n", 
³”
->
u­sd
);

1912  
Œue
;

1913 
	}
}

1915 
boŞ
 
	$¡a_wmm_upd©e_wmm_ac_›s
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
,

1916 
u8
 *
assoc_r¥_›
, 
size_t
 
assoc_r¥_›_Ën
)

1918 
u16
 
Ëá
;

1919 cÚ¡ 
u8
 *
pos
;

1920 cÚ¡ 
u8
 *
wmm_–em
 = 
NULL
;

1921 
u16
 
wmm_–em_Ën
 = 0;

1922 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1923 
¦si_wmm_ac
 *
wmm_ac
 = &
ndev_vif
->
¡a
.wmm_ac[0];

1925 ià(!
	`g‘_wmm_›_äom_»¥_›
(
sdev
, 
dev
, 
assoc_r¥_›
, 
assoc_r¥_›_Ën
, &
wmm_–em
, &
wmm_–em_Ën
)) {

1926 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "No WMM IE„eceived\n");

1927  
çl£
;

1930 ià(
wmm_–em_Ën
 < 10 || 
wmm_–em
[7] != 1) {

1931 
	`SLSI_NET_WARN
(
dev
, "Inv®id WMM IE: wmm_–em_Ën=%lu, wmm_–em[7]=%d\n", ()
wmm_–em_Ën
, ()
wmm_–em
[7]);

1932  
çl£
;

1935 
pos
 = 
wmm_–em
 + 10;

1936 
Ëá
 = 
wmm_–em_Ën
 - 10;

1938 ; 
Ëá
 >ğ4;†eá -ğ4, 
pos
 += 4) {

1939 
aci
 = (
pos
[0] >> 5) & 0x03;

1940 
acm
 = (
pos
[0] >> 4) & 0x01;

1942 
	`memıy
(
wmm_ac
, 
pos
, (
¦si_wmm_ac
));

1944 
aci
) {

1946 ià(
acm
)

1947 
³”
->
wmm_acm
 |ğ
	`BIT
(1) | BIT(2);

1950 ià(
acm
)

1951 
³”
->
wmm_acm
 |ğ
	`BIT
(4) | BIT(5);

1954 ià(
acm
)

1955 
³”
->
wmm_acm
 |ğ
	`BIT
(6) | BIT(7);

1959 ià(
acm
)

1960 
³”
->
wmm_acm
 |ğ
	`BIT
(0) | BIT(3);

1963 
wmm_ac
++;

1966 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "WMM ies have been updated successfully\n");

1967  
Œue
;

1968 
	}
}

1970 #ifdeà
CONFIG_SCSC_WLAN_KEY_MGMT_OFFLOAD


1971 
	e¦si_wÏn_v’dÜ_©Œ_rßm_auth
 {

1972 
	mSLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_INVALID
 = 0,

1973 
	mSLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_BSSID
,

1974 
	mSLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_REQ_IE
,

1975 
	mSLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_RESP_IE
,

1976 
	mSLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_AUTHORIZED
,

1977 
	mSLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_KEY_REPLAY_CTR
,

1978 
	mSLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_PTK_KCK
,

1979 
	mSLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_PTK_KEK
,

1980 
	mSLSI_WLAN_VENDOR_ATTR_ROAM_BEACON_IE
,

1982 
	mSLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_AFTER_LAST
,

1983 
	mSLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_MAX
 =

1984 
SLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_AFTER_LAST
 - 1

1987 
	$¦si_£nd_rßm_v’dÜ_ev’t
(
¦si_dev
 *
sdev
, cÚ¡ 
u8
 *
bssid
,

1988 cÚ¡ 
u8
 *
»q_›
, 
u32
 
»q_›_Ën
, cÚ¡ u8 *
»¥_›
, u32 
»¥_›_Ën
,

1989 cÚ¡ 
u8
 *
b—cÚ_›
, 
u32
 
b—cÚ_›_Ën
, 
boŞ
 
authÜized
)

1991 
boŞ
 
is_£cu»d_bss
;

1992 
sk_buff
 *
skb
 = 
NULL
;

1993 
u8
 
”r
 = 0;

1995 
is_£cu»d_bss
 = 
	`cfg80211_fšd_›
(
WLAN_EID_RSN
, 
»q_›
, 
»q_›_Ën
) ||

1996 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPA
, 
»q_›
, 
»q_›_Ën
);

1998 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "authÜized:%d, is_£cu»d_bss:%d\n", 
authÜized
, 
is_£cu»d_bss
);

2000 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

2001 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NULL
, 
NLMSG_DEFAULT_SIZE
,

2002 
SLSI_NL80211_VENDOR_SUBCMD_KEY_MGMT_ROAM_AUTH
, 
GFP_KERNEL
);

2004 
skb
 = 
	`cfg80211_v’dÜ_ev’t_®loc
(
sdev
->
why
, 
NLMSG_DEFAULT_SIZE
,

2005 
SLSI_NL80211_VENDOR_SUBCMD_KEY_MGMT_ROAM_AUTH
, 
GFP_KERNEL
);

2007 ià(!
skb
) {

2008 
	`SLSI_ERR_NODEV
("Failedo‡llocate skb for VENDOR Roamƒvent\n");

2009  -
ENOMEM
;

2012 
”r
 |ğ
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_BSSID
, 
ETH_ALEN
, 
bssid
è? 
	`BIT
(1) : 0;

2013 
”r
 |ğ
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_AUTHORIZED
, 1, &
authÜized
è? 
	`BIT
(2) : 0;

2014 
”r
 |ğ(
»q_›
 && 
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_REQ_IE
, 
»q_›_Ën
,„eq_›)è? 
	`BIT
(3) : 0;

2015 
”r
 |ğ(
»¥_›
 && 
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_ROAM_AUTH_RESP_IE
, 
»¥_›_Ën
,„e¥_›)è? 
	`BIT
(4) : 0;

2016 
”r
 |ğ(
b—cÚ_›
 && 
	`Æa_put
(
skb
, 
SLSI_WLAN_VENDOR_ATTR_ROAM_BEACON_IE
, 
b—cÚ_›_Ën
, b—cÚ_›)è? 
	`BIT
(5) : 0;

2017 ià(
”r
) {

2018 
	`SLSI_ERR_NODEV
("Failed‚la_put ,req_ie_len=%d,resp_ie_len=%d,beacon_ie_len=%d,condition_failed=%d\n",

2019 
»q_›_Ën
, 
»¥_›_Ën
, 
b—cÚ_›_Ën
, 
”r
);

2020 
	`kä“_skb
(
skb
);

2021  -
EINVAL
;

2023 
	`SLSI_DBG3_NODEV
(
SLSI_MLME
, "Ev’t: KEY_MGMT_ROAM_AUTH(%d)\n", 
SLSI_NL80211_VENDOR_SUBCMD_KEY_MGMT_ROAM_AUTH
);

2024 
	`cfg80211_v’dÜ_ev’t
(
skb
, 
GFP_KERNEL
);

2026 
	}
}

2029 
	$¦si_rx_rßmed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2031 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2032 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

2033 
¦si_³”
 *
³”
;

2034 
u16
 
‹mpÜ®_keys_»quœed
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_rßmed_šd
.temporal_keys_required);

2035 
›“80211_chªÃl
 *
cur_chªÃl
 = 
NULL
;

2036 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

2037 
›“80211_´ivacy
 
bss_´ivacy
;

2039 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 12, 0))

2040 
cfg80211_rßm_šfo
 
rßm_šfo
 = {};

2043 
	`¹Æ_lock
();

2044 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
£t_muÉiÿ¡_f‹r_wÜk
);

2045 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
upd©e_pkt_f‹r_wÜk
);

2046 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2048 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_roamed_ind(vif:%d) Roamingo %pM\n",

2049 
	`çpi_g‘_vif
(
skb
),

2050 
mgmt
->
bssid
);

2051 ià(!
ndev_vif
->
aùiv©ed
) {

2052 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

2053 
ex™
;

2056 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

2057 ià(
	`WARN_ON
(!
³”
))

2058 
ex™
;

2060 ià(
	`WARN_ON
(!
ndev_vif
->
¡a
.
¡a_bss
))

2061 
ex™
;

2063 
	`¦si_rx_ba_¡İ_®l
(
dev
, 
³”
);

2065 
	`SLSI_ETHER_COPY
(
³”
->
add»ss
, 
mgmt
->
bssid
);

2067 ià(
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
) {

2069 
cur_chªÃl
 = 
	`¦si_rx_sÿn_·ss_to_cfg80211
(
sdev
, 
dev
, 
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
);

2070 
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
 = 
NULL
;

2073 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

2074 ià(
ndev_vif
->
¡a
.
¡a_bss
->
ÿ·b™y
 & 
WLAN_CAPABILITY_PRIVACY
)

2075 
bss_´ivacy
 = 
IEEE80211_PRIVACY_ON
;

2077 
bss_´ivacy
 = 
IEEE80211_PRIVACY_OFF
;

2080 
	`¦si_cfg80211_put_bss
(
sdev
->
why
, 
ndev_vif
->
¡a
.
¡a_bss
);

2082 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

2083 
ndev_vif
->
¡a
.
¡a_bss
 = 
	`cfg80211_g‘_bss
(
sdev
->
why
, 
cur_chªÃl
, 
³”
->
add»ss
, 
NULL
, 0,

2084 
IEEE80211_BSS_TYPE_ANY
, 
bss_´ivacy
);

2086 
ndev_vif
->
¡a
.
¡a_bss
 = 
	`cfg80211_g‘_bss
(
sdev
->
why
, 
cur_chªÃl
, 
³”
->
add»ss
, 
NULL
, 0, 0, 0);

2089 ià(!
ndev_vif
->
¡a
.
¡a_bss
 || !ndev_vif->¡a.
rßm_mlme_´oûdu»_¡¬‹d_šd
) {

2090 ià(!
ndev_vif
->
¡a
.
¡a_bss
)

2091 
	`SLSI_INFO
(
sdev
, "BSS‚ot updated in cfg80211\n");

2092 ià(!
ndev_vif
->
¡a
.
rßm_mlme_´oûdu»_¡¬‹d_šd
)

2093 
	`SLSI_INFO
(
sdev
, "procedure-started-ind‚ot„eceived before„oamed-ind\n");

2094 
	`Ãtif_ÿ¼›r_off
(
dev
);

2095 
	`¦si_mlme_discÚÃù
(
sdev
, 
dev
, 
³”
->
add»ss
, 0, 
Œue
);

2096 
	`¦si_hªdË_discÚÃù
(
sdev
, 
dev
, 
³”
->
add»ss
, 0, 
NULL
, 0);

2098 
u8
 *
assoc_›
 = 
NULL
;

2099 
size_t
 
assoc_›_Ën
 = 0;

2100 
u8
 *
assoc_r¥_›
 = 
NULL
;

2101 
size_t
 
assoc_r¥_›_Ën
 = 0;

2103 
	`¦si_³”_»£t_¡©s
(
sdev
, 
dev
, 
³”
);

2104 
	`¦si_³”_upd©e_assoc_»q
(
sdev
, 
dev
, 
³”
, 
ndev_vif
->
¡a
.
rßm_mlme_´oûdu»_¡¬‹d_šd
);

2105 
	`¦si_³”_upd©e_assoc_r¥
(
sdev
, 
dev
, 
³”
, 
skb
);

2108 
skb
 = 
NULL
;

2110 ià(
³”
->
assoc_›
) {

2111 
assoc_›
 = 
³”
->assoc_›->
d©a
;

2112 
assoc_›_Ën
 = 
³”
->
assoc_›
->
Ën
;

2115 ià(
³”
->
assoc_»¥_›
) {

2116 
assoc_r¥_›
 = 
³”
->
assoc_»¥_›
->
d©a
;

2117 
assoc_r¥_›_Ën
 = 
³”
->
assoc_»¥_›
->
Ën
;

2123 
³”
->
wmm_acm
 = 0;

2124 
³”
->
t¥ec_e¡ablished
 = 0;

2125 
³”
->
u­sd
 = 0;

2130 ià(!
	`¡a_wmm_upd©e_u­sd
(
sdev
, 
dev
, 
³”
, 
assoc_›
, 
assoc_›_Ën
))

2131 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Failo update WMM uapsd\n");

2136 ià(!
	`¡a_wmm_upd©e_wmm_ac_›s
(
sdev
, 
dev
, 
³”
, 
assoc_r¥_›
, 
assoc_r¥_›_Ën
))

2137 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Failo update WMM AC ies\n");

2139 
ndev_vif
->
¡a
.
rßm_mlme_´oûdu»_¡¬‹d_šd
 = 
NULL
;

2141 ià(
‹mpÜ®_keys_»quœed
) {

2142 
³”
->
·œwi£_key_£t
 = 0;

2143 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DOING_KEY_CONFIG
);

2146 
	`WARN_ON
(
assoc_›_Ën
 && !
assoc_›
);

2147 
	`WARN_ON
(
assoc_r¥_›_Ën
 && !
assoc_r¥_›
);

2149 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "cfg80211_roamed()\n");

2151 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 12, 0))

2156 
rßm_šfo
.
chªÃl
 = 
ndev_vif
->
¡a
.
¡a_bss
->channel;

2157 
rßm_šfo
.
bssid
 = 
³”
->
add»ss
;

2158 
rßm_šfo
.
»q_›
 = 
assoc_›
;

2159 
rßm_šfo
.
»q_›_Ën
 = 
assoc_›_Ën
;

2160 
rßm_šfo
.
»¥_›
 = 
assoc_r¥_›
;

2161 
rßm_šfo
.
»¥_›_Ën
 = 
assoc_r¥_›_Ën
;

2162 
	`cfg80211_rßmed
(
dev
, &
rßm_šfo
, 
GFP_KERNEL
);

2164 
	`cfg80211_rßmed
(
dev
,

2165 
ndev_vif
->
¡a
.
¡a_bss
->
chªÃl
,

2166 
³”
->
add»ss
,

2167 
assoc_›
,

2168 
assoc_›_Ën
,

2169 
assoc_r¥_›
,

2170 
assoc_r¥_›_Ën
,

2171 
GFP_KERNEL
);

2173 #ifdeà
CONFIG_SCSC_WLAN_KEY_MGMT_OFFLOAD


2174 ià(
	`¦si_£nd_rßm_v’dÜ_ev’t
(
sdev
, 
³”
->
add»ss
, 
assoc_›
, 
assoc_›_Ën
,

2175 
assoc_r¥_›
, 
assoc_r¥_›_Ën
,

2176 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,‚dev_vif->¡a.¡a_bss->›s->
Ën
,

2177 !
‹mpÜ®_keys_»quœed
) != 0) {

2178 
	`SLSI_NET_ERR
(
dev
, "Couldnt send Roam vendorƒvent");

2181 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_MLME
, "cfg80211_roamed() Done\n");

2183 
ndev_vif
->
¡a
.
rßm_š_´og»ss
 = 
çl£
;

2184 
ndev_vif
->
chª
 =‚dev_vif->
¡a
.
¡a_bss
->
chªÃl
;

2185 
	`SLSI_ETHER_COPY
(
ndev_vif
->
¡a
.
bssid
, 
³”
->
add»ss
);

2187 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Taking‡ wakelock for DHCPo finish‡fter„oaming\n");

2188 
	`¦si_wake_lock_timeout
(&
sdev
->
wÏn_wl_rßm
, 
	`m£cs_to_jiff›s
(10 * 1000));

2189 #ià
	`IS_ENABLED
(
CONFIG_SCSC_WIFILOGGER
)

2190 
	`SCSC_WLOG_WAKELOCK
(
WLOG_NORMAL
, 
WL_TAKEN
, "wÏn_wl_rßm", 
WL_REASON_ROAM
);

2193 ià(!
‹mpÜ®_keys_»quœed
) {

2194 
	`¦si_mlme_rßmed_»¥
(
sdev
, 
dev
);

2195 
	`ÿc_upd©e_rßm_Œaffic_·¿ms
(
sdev
, 
dev
);

2197 
ndev_vif
->
¡a
.
»¥_id
 = 
MLME_ROAMED_RES
;

2201 
ex™
:

2202 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2203 
	`¹Æ_uÆock
();

2204 
	`kä“_skb
(
skb
);

2205 
	}
}

2207 
	$¦si_rx_rßm_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2209 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2211 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

2213 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_roam_ind(vif:%d,‡id:0,„esult:0x%04x )\n",

2214 
	`çpi_g‘_vif
(
skb
),

2215 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_rßm_šd
.
»suÉ_code
));

2217 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2219 ià(!
ndev_vif
->
aùiv©ed
) {

2220 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

2221 
ex™_w™h_lock
;

2224 
	`WARN
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
, "Not‡ Station VIF\n");

2226 
ex™_w™h_lock
:

2227 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2228 
	`kä“_skb
(
skb
);

2229 
	}
}

2231 
	$¦si_tdls_ev’t_discov”ed
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2233 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2234 
u16
 
tdls_ev’t
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_tdls_³”_šd
.tdls_event);

2235 
u16
 
³”_šdex
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_tdls_³”_šd
.peer_index);

2236 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

2237 
Ën
 = 
	`çpi_g‘_mgm’
(
skb
);

2239 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2241 
	`SLSI_INFO
(
sdev
, "\n");

2243 ià(
Ën
 != 0) {

2244 
	`cfg80211_rx_mgmt
(&
ndev_vif
->
wdev
,‚dev_vif->
chª
->
ûÁ”_äeq
, 0, (cÚ¡ 
u8
 *)
mgmt
, 
Ën
, 
GFP_ATOMIC
);

2246 
	`¦si_mlme_tdls_³”_»¥
(
sdev
, 
dev
, 
³”_šdex
, 
tdls_ev’t
);

2249 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2251 
	`kä“_skb
(
skb
);

2252 
	}
}

2254 
	$¦si_tdls_ev’t_cÚÃùed
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2256 
¦si_³”
 *
³”
 = 
NULL
;

2257 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2258 
u16
 
³”_šdex
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_tdls_³”_šd
.peer_index);

2259 
u16
 
tdls_ev’t
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_tdls_³”_šd
.tdls_event);

2261 
	`¹Æ_lock
();

2262 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2264 
ndev_vif
->
¡a
.
tdls_’abËd
 = 
Œue
;

2266 
	`SLSI_INFO
(
sdev
, "(vif:%d,…“r_šdex:%d mac[" 
MACSTR
 "])\n",

2267 
	`çpi_g‘_vif
(
skb
), 
³”_šdex
, 
	`MAC2STR
(
	`çpi_g‘_buff
(skb, 
u
.
mlme_tdls_³”_šd
.
³”_¡a_add»ss
)));

2269 ià(!
ndev_vif
->
aùiv©ed
) {

2270 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

2271 
ex™_w™h_lock
;

2274 ià(
	`WARN
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
, "STA VIF"))

2275 
ex™_w™h_lock
;

2277 ià(
³”_šdex
 < 
SLSI_TDLS_PEER_INDEX_MIN
 ||…“r_šdex > 
SLSI_TDLS_PEER_INDEX_MAX
) {

2278 
	`SLSI_NET_ERR
(
dev
, "Reûived incÜ»ù…“r_šdex: %d\n", 
³”_šdex
);

2279 
ex™_w™h_lock
;

2287 
	`¦si_¥šlock_lock
(&
ndev_vif
->
tı_ack_lock
);

2288 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

2290 ià(
ndev_vif
->
¡a
.
tdls_³”_¡a_»cÜds
 + 1 > 
SLSI_TDLS_PEER_CONNECTIONS_MAX
) {

2291 
	`SLSI_NET_ERR
(
dev
, "MAX TDLS…“¸lim™„—ched. IgnÜšd fÜ…“r_šdex:%d\n", 
³”_šdex
);

2292 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

2293 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2294 
ex™_w™h_lock
;

2297 
³”
 = 
	`¦si_³”_add
(
sdev
, 
dev
, 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_tdls_³”_šd
.
³”_¡a_add»ss
), 
³”_šdex
);

2299 ià(!
³”
) {

2300 
	`SLSI_NET_ERR
(
dev
, "Peer NOT Created\n");

2301 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

2302 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2303 
ex™_w™h_lock
;

2307 
³”
->
qos_’abËd
 = 
Œue
;

2309 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

2312 
	`¦si_tdls_move_·ck‘s
(
sdev
, 
dev
, 
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
], 
³”
, 
Œue
);

2313 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

2314 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2317 
	`¦si_mlme_tdls_³”_»¥
(
sdev
, 
dev
, 
³”_šdex
, 
tdls_ev’t
);

2319 
ex™_w™h_lock
:

2320 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2321 
	`¹Æ_uÆock
();

2322 
	`kä“_skb
(
skb
);

2323 
	}
}

2325 
	$¦si_tdls_ev’t_discÚÃùed
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2327 
¦si_³”
 *
³”
 = 
NULL
;

2328 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2329 
u16
 
pid
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_tdls_³”_šd
.
³”_šdex
);

2330 
u16
 
tdls_ev’t
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_tdls_³”_šd
.tdls_event);

2332 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2334 ià(
	`WARN_ON
(!
dev
))

2335 
ex™
;

2337 
	`SLSI_INFO
(
sdev
, "(vif:%d, MAC:" 
MACSTR
 ")\n", 
ndev_vif
->
iâum
,

2338 
	`MAC2STR
(
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_tdls_³”_šd
.
³”_¡a_add»ss
)));

2340 ià(!
ndev_vif
->
aùiv©ed
) {

2341 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

2342 
ex™
;

2350 
	`¦si_¥šlock_lock
(&
ndev_vif
->
tı_ack_lock
);

2351 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

2352 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_tdls_³”_šd
.
³”_¡a_add»ss
));

2354 ià(!
³”
 ||…“r->
aid
 == 0) {

2355 
	`WARN_ON
(!
³”
 || (³”->
aid
 == 0));

2356 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "peer NOT found by MAC‡ddress\n");

2357 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

2358 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2359 
ex™
;

2362 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DISCONNECTED
);

2365 
	`¦si_tdls_move_·ck‘s
(
sdev
, 
dev
, 
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
], 
³”
, 
çl£
);

2371 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

2372 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
tı_ack_lock
);

2375 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

2376 
	`¦si_³”_»move
(
sdev
, 
dev
, 
³”
);

2377 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

2379 
	`¦si_mlme_tdls_³”_»¥
(
sdev
, 
dev
, 
pid
, 
tdls_ev’t
);

2380 
ex™
:

2381 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2382 
	`kä“_skb
(
skb
);

2383 
	}
}

2387 
	$¦si_tdls_³”_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2389 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2390 
u16
 
tdls_ev’t
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_tdls_³”_šd
.tdls_event);

2392 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_tdls_³”_šddls_ev’t: %d\n", 
tdls_ev’t
);

2393 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2394 ià(!
ndev_vif
->
aùiv©ed
) {

2395 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

2396 
	`kä“_skb
(
skb
);

2397 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2400 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2402 
tdls_ev’t
) {

2403 
FAPI_TDLSEVENT_CONNECTED
:

2404 
	`¦si_tdls_ev’t_cÚÃùed
(
sdev
, 
dev
, 
skb
);

2406 
FAPI_TDLSEVENT_DISCONNECTED
:

2407 
	`¦si_tdls_ev’t_discÚÃùed
(
sdev
, 
dev
, 
skb
);

2409 
FAPI_TDLSEVENT_DISCOVERED
:

2410 
	`¦si_tdls_ev’t_discov”ed
(
sdev
, 
dev
, 
skb
);

2413 
	`WARN_ON
((
tdls_ev’t
 == 0) || (tdls_event > 4));

2414 
	`kä“_skb
(
skb
);

2417 
	}
}

2420 
	$¦si_rx_bufã»d_äames
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_³”
 *
³”
)

2422 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2423 
sk_buff
 *
buff_äame
 = 
NULL
;

2425 
	`WARN_ON
(!
	`SLSI_MUTEX_IS_LOCKED
(
ndev_vif
->
vif_mu‹x
));

2426 ià(
	`WARN
(!
³”
, "Peer is NULL"))

2428 
	`WARN
(
³”
->
cÚÃùed_¡©e
 =ğ
SLSI_STA_CONN_STATE_CONNECTING
, "Wrong state");

2430 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
,

2432 
ndev_vif
->
iâum
, 
³”
->
aid
);

2433 
buff_äame
 = 
	`skb_dequeue
(&
³”
->
bufã»d_äames
);

2434 
buff_äame
) {

2435 
	`¦si_debug_äame
(
sdev
, 
dev
, 
buff_äame
, "RX_BUFFERED");

2436 
	`çpi_g‘_sigid
(
buff_äame
)) {

2437 
MA_BLOCKACK_IND
:

2438 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "Transferring buffered MA_BLOCKACK_IND frame");

2439 
	`__¦si_rx_blockack_šd
(
sdev
, 
dev
, 
buff_äame
);

2442 
	`SLSI_NET_WARN
(
dev
, "UÃx³ùed D©a: 0x%.4x\n", 
	`çpi_g‘_sigid
(
buff_äame
));

2443 
	`kä“_skb
(
buff_äame
);

2446 
buff_äame
 = 
	`skb_dequeue
(&
³”
->
bufã»d_äames
);

2448 
	}
}

2450 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


2451 
	$¦si_rx_synchrÚi£d_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2453 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2454 
cfg80211_ex‹º®_auth_·¿ms
 
auth_»que¡
;

2455 
r
;

2457 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2458 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Reûived synchrÚi£d_šd, bssid:%pM\n", 
	`çpi_g‘_mgmt
(
skb
)->
bssid
);

2459 ià(!
ndev_vif
->
aùiv©ed
) {

2460 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

2461 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2462 
	`kä“_skb
(
skb
);

2466 
auth_»que¡
.
aùiÚ
 = 
NL80211_EXTERNAL_AUTH_START
;

2467 
	`memıy
(
auth_»que¡
.
bssid
, 
	`çpi_g‘_mgmt
(
skb
)->bssid, 
ETH_ALEN
);

2468 
	`memıy
(
auth_»que¡
.
ssid
.ssid, 
ndev_vif
->
¡a
.ssid,‚dev_vif->¡a.
ssid_Ën
);

2469 
auth_»que¡
.
ssid
.
ssid_Ën
 = 
ndev_vif
->
¡a
.ssid_len;

2470 
auth_»que¡
.
key_mgmt_su™e
 = 
ndev_vif
->
¡a
.
üy±o
.
akm_su™es
[0];

2472 
r
 = 
	`cfg80211_ex‹º®_auth_»que¡
(
dev
, &
auth_»que¡
, 
GFP_KERNEL
);

2473 ià(
r
)

2474 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "cfg80211_external_auth_request failed");

2476 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

2477 
ndev_vif
->
¡a
.
w·3_auth_¡©e
 = 
SLSI_WPA3_AUTHENTICATING
;

2480 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2481 
	`kä“_skb
(
skb
);

2482 
	}
}

2485 
	$¦si_add_bÏckli¡_šfo
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
Ãtdev_vif
 *
ndev_vif
, 
u8
 *
addr
, 
u32
 
»‹ÁiÚ_time
)

2487 
¦si_bssid_bÏckli¡_šfo
 *
d©a
;

2488 
bÏckli¡_»ûived_time
;

2489 
li¡_h—d
 *
bÏckli¡_pos
, *
bÏckli¡_q
;

2494 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_fw_li¡
) {

2495 
¦si_bssid_bÏckli¡_šfo
 *
bÏckli¡_šfo
;

2497 
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
, 
¦si_bssid_bÏckli¡_šfo
, 
li¡
);

2498 ià(
bÏckli¡_šfo
 && 
	`SLSI_ETHER_EQUAL
(bÏckli¡_šfo->
bssid
, 
addr
)) {

2499 
bÏckli¡_»ûived_time
 = 
	`jiff›s_to_m£cs
(
jiff›s
);

2500 
bÏckli¡_šfo
->
’d_time
 = 
bÏckli¡_»ûived_time
 + 
»‹ÁiÚ_time
 * 1000;

2505 
d©a
 = 
	`kz®loc
((*d©a), 
GFP_KERNEL
);

2507 ià(!
d©a
) {

2508 
	`SLSI_NET_ERR
(
dev
, "BÏckli¡_add: UÇbËØadd bÏckli¡ MAC:" 
MACSTR
 "\n", 
	`MAC2STR
(
addr
));

2511 
	`‘h”_addr_cİy
(
d©a
->
bssid
, 
addr
);

2512 
bÏckli¡_»ûived_time
 = 
	`jiff›s_to_m£cs
(
jiff›s
);

2513 
d©a
->
’d_time
 = 
bÏckli¡_»ûived_time
 + 
»‹ÁiÚ_time
 * 1000;

2514 
	`li¡_add
(&
d©a
->
li¡
, &
ndev_vif
->
aş_d©a_fw_li¡
);

2517 
	`¦si_£t_aş
(
sdev
, 
dev
);

2518 
	}
}

2520 
	$¦si_£t_aş
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

2522 
cfg80211_aş_d©a
 *
aş_d©a_tÙ®
 = 
NULL
;

2523 
fw_aş_’Œ›s_couÁ
 = 0;

2524 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2525 
»t
 = 0;

2526 
num_bssid_tÙ®
 = 0;

2527 
li¡_h—d
 *
bÏckli¡_pos
, *
bÏckli¡_q
;

2528 
ioùl_aş_’Œ›s_couÁ
 = 0;

2531 ià(!
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
))

2532  -
EINVAL
;

2534 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_fw_li¡
) {

2535 
fw_aş_’Œ›s_couÁ
++;

2538 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_ioùl_li¡
) {

2539 
ioùl_aş_’Œ›s_couÁ
++;

2542 ià(
ndev_vif
->
aş_d©a_suµliÿÁ
)

2543 
num_bssid_tÙ®
 +ğ
ndev_vif
->
aş_d©a_suµliÿÁ
->
n_aş_’Œ›s
;

2544 ià(
ndev_vif
->
aş_d©a_h®
)

2545 
num_bssid_tÙ®
 +ğ
ndev_vif
->
aş_d©a_h®
->
n_aş_’Œ›s
;

2546 
num_bssid_tÙ®
 +ğ
fw_aş_’Œ›s_couÁ
;

2547 
num_bssid_tÙ®
 +ğ
ioùl_aş_’Œ›s_couÁ
;

2549 
aş_d©a_tÙ®
 = 
	`km®loc
((*aş_d©a_tÙ®è+ ((
mac_add»ss
è* 
num_bssid_tÙ®
), 
GFP_KERNEL
);

2551 ià(!
aş_d©a_tÙ®
) {

2552 
	`SLSI_ERR
(
sdev
, "Blacklist: Failedo‡llocate memory\n");

2553  -
ENOMEM
;

2555 
aş_d©a_tÙ®
->
n_aş_’Œ›s
 = 0;

2556 
aş_d©a_tÙ®
->
aş_pŞicy
 = 
FAPI_ACLPOLICY_BLACKLIST
;

2557 ià(
ndev_vif
->
aş_d©a_suµliÿÁ
 &&‚dev_vif->aş_d©a_suµliÿÁ->
n_aş_’Œ›s
) {

2558 
	`memıy
(
aş_d©a_tÙ®
->
mac_addrs
[aş_d©a_tÙ®->
n_aş_’Œ›s
].
addr
,

2559 
ndev_vif
->
aş_d©a_suµliÿÁ
->
mac_addrs
[0].
addr
,

2560 
ndev_vif
->
aş_d©a_suµliÿÁ
->
n_aş_’Œ›s
 * 
ETH_ALEN
);

2561 
aş_d©a_tÙ®
->
n_aş_’Œ›s
 +ğ
ndev_vif
->
aş_d©a_suµliÿÁ
->n_acl_entries;

2563 ià(
ndev_vif
->
aş_d©a_h®
 &&‚dev_vif->aş_d©a_h®->
n_aş_’Œ›s
) {

2564 
	`memıy
(
aş_d©a_tÙ®
->
mac_addrs
[aş_d©a_tÙ®->
n_aş_’Œ›s
].
addr
,

2565 
ndev_vif
->
aş_d©a_h®
->
mac_addrs
[0].
addr
,

2566 
ndev_vif
->
aş_d©a_h®
->
n_aş_’Œ›s
 * 
ETH_ALEN
);

2567 
aş_d©a_tÙ®
->
n_aş_’Œ›s
 +ğ
ndev_vif
->
aş_d©a_h®
->n_acl_entries;

2570 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_fw_li¡
) {

2571 
¦si_bssid_bÏckli¡_šfo
 *
bÏckli¡_šfo
;

2573 
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
, 
¦si_bssid_bÏckli¡_šfo
, 
li¡
);

2574 ià(
bÏckli¡_šfo
) {

2575 
	`memıy
(
aş_d©a_tÙ®
->
mac_addrs
[aş_d©a_tÙ®->
n_aş_’Œ›s
].
addr
, 
bÏckli¡_šfo
->
bssid
, 
ETH_ALEN
);

2576 
aş_d©a_tÙ®
->
n_aş_’Œ›s
++;

2580 
	`li¡_fÜ_—ch_§ã
(
bÏckli¡_pos
, 
bÏckli¡_q
, &
ndev_vif
->
aş_d©a_ioùl_li¡
) {

2581 
¦si_ioùl_bÏckli¡_šfo
 *
bÏckli¡_šfo
;

2583 
bÏckli¡_šfo
 = 
	`li¡_’Œy
(
bÏckli¡_pos
, 
¦si_ioùl_bÏckli¡_šfo
, 
li¡
);

2584 ià(
bÏckli¡_šfo
) {

2585 
	`memıy
(
aş_d©a_tÙ®
->
mac_addrs
[aş_d©a_tÙ®->
n_aş_’Œ›s
].
addr
, 
bÏckli¡_šfo
->
bssid
, 
ETH_ALEN
);

2586 
aş_d©a_tÙ®
->
n_aş_’Œ›s
++;

2590 
»t
 = 
	`¦si_mlme_£t_aş
(
sdev
, 
dev
, 0, 
aş_d©a_tÙ®
->
aş_pŞicy
,‡ş_d©a_tÙ®->
n_aş_’Œ›s
,

2591 
aş_d©a_tÙ®
->
mac_addrs
);

2592 
	`kä“
(
aş_d©a_tÙ®
);

2593  
»t
;

2594 
	}
}

2596 
	$¦si_rx_bÏckli¡ed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2598 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2599 
u8
 *
mac_addr
;

2600 
u32
 
»‹ÁiÚ_time
;

2602 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_bÏckli¡ed_šd(vif:%d, MAC:" 
MACSTR
 " )\n",

2603 
	`çpi_g‘_vif
(
skb
),

2604 
	`MAC2STR
(
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_bÏckli¡ed_šd
.
bssid
)));

2606 
	`ÿnûl_d–ayed_wÜk_sync
(&
ndev_vif
->
bÏckli¡_d–_wÜk
);

2608 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2609 
mac_addr
 = 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_bÏckli¡ed_šd
.
bssid
);

2610 
»‹ÁiÚ_time
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
mlme_bÏckli¡ed_šd
.
»assocŸtiÚ_»Œy_d–ay
);

2611 
	`¦si_add_bÏckli¡_šfo
(
sdev
, 
dev
, 
ndev_vif
, 
mac_addr
, 
»‹ÁiÚ_time
);

2612 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2614 
	`queue_d–ayed_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
bÏckli¡_d–_wÜk
, 0);

2615 
	`kä“_skb
(
skb
);

2616 
	}
}

2618 
	$¦si_rx_cÚÃùed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2620 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2621 
¦si_³”
 *
³”
 = 
NULL
;

2622 
u16
 
aid
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_cÚÃùed_šd
.
assocŸtiÚ_id’tif›r
);

2626 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2628 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_connected_ind(vif:%d,…eer_index:%d)\n",

2629 
	`çpi_g‘_vif
(
skb
),

2630 
aid
);

2631 
	`SLSI_INFO
(
sdev
, "Received Association Response\n");

2633 ià(!
ndev_vif
->
aùiv©ed
) {

2634 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

2635 
ex™_w™h_lock
;

2638 ià(
	`WARN
(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
, "STA VIF‡nd Not Roaming"))

2639 
ex™_w™h_lock
;

2641 
ndev_vif
->
vif_ty³
) {

2642 
FAPI_VIFTYPE_AP
:

2644 ià(
aid
 < 
SLSI_PEER_INDEX_MIN
 ||‡id > 
SLSI_PEER_INDEX_MAX
) {

2645 
	`SLSI_NET_ERR
(
dev
, "Reûived incÜ»ù…“r_šdex: %d\n", 
aid
);

2646 
ex™_w™h_lock
;

2649 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
aid
 - 1);

2650 ià(!
³”
) {

2651 
	`SLSI_NET_ERR
(
dev
, "P“¸×id:%dèNÙ Found - DiscÚÃù…“r\n", 
aid
);

2652 
ex™_w™h_lock
;

2655 
	`cfg80211_Ãw_¡a
(
dev
, 
³”
->
add»ss
, &³”->
sšfo
, 
GFP_KERNEL
);

2657 ià(
ndev_vif
->
­
.
´ivacy
) {

2658 
³”
->
cÚÃùed_¡©e
 = 
SLSI_STA_CONN_STATE_DOING_KEY_CONFIG
;

2659 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DOING_KEY_CONFIG
);

2661 
³”
->
cÚÃùed_¡©e
 = 
SLSI_STA_CONN_STATE_CONNECTED
;

2662 
	`¦si_mlme_cÚÃùed_»¥
(
sdev
, 
dev
, 
aid
);

2663 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

2665 
	`¦si_rx_bufã»d_äames
(
sdev
, 
dev
, 
³”
);

2670 
	`SLSI_NET_WARN
(
dev
, "mlme_cÚÃùed_šd(vif:%d, uÃx³ùed viàty³:%d)\n", 
	`çpi_g‘_vif
(
skb
), 
ndev_vif
->
vif_ty³
);

2673 
ex™_w™h_lock
:

2674 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2675 
	`kä“_skb
(
skb
);

2676 
	}
}

2678 
	$¦si_rx_»assoc_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2680 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2681 
›“80211_¡©uscode
 
¡©us
 = 
WLAN_STATUS_SUCCESS
;

2682 
¦si_³”
 *
³”
 = 
NULL
;

2683 
u8
 *
assoc_›
 = 
NULL
;

2684 
size_t
 
assoc_›_Ën
 = 0;

2685 
u8
 *
»assoc_r¥_›
 = 
NULL
;

2686 
size_t
 
»assoc_r¥_›_Ën
 = 0;

2688 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_reassoc_ind(vif:%d,„esult:0x%04x)\n",

2689 
	`çpi_g‘_vif
(
skb
),

2690 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_»assocŸ‹_šd
.
»suÉ_code
));

2692 
	`¹Æ_lock
();

2693 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2695 ià(!
ndev_vif
->
aùiv©ed
) {

2696 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

2697 
ex™_w™h_lock
;

2700 ià(
	`WARN
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
, "Not‡ Station VIF\n"))

2701 
ex™_w™h_lock
;

2703 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 0);

2704 ià(
	`WARN_ON
(!
³”
)) {

2705 
	`SLSI_NET_ERR
(
dev
, "PEER Not found\n");

2706 
ex™_w™h_lock
;

2709 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_»assocŸ‹_šd
.
»suÉ_code
è!ğ
FAPI_RESULTCODE_SUCCESS
) {

2710 
¡©us
 = 
WLAN_STATUS_UNSPECIFIED_FAILURE
;

2711 
	`¦si_rx_ba_¡İ_®l
(
dev
, 
³”
);

2713 
³”
->
·œwi£_key_£t
 = 0;

2715 ià(
³”
->
assoc_›
) {

2716 
assoc_›
 = 
³”
->assoc_›->
d©a
;

2717 
assoc_›_Ën
 = 
³”
->
assoc_›
->
Ën
;

2718 
	`WARN_ON
(
assoc_›_Ën
 && !
assoc_›
);

2721 
	`¦si_³”_»£t_¡©s
(
sdev
, 
dev
, 
³”
);

2723 
³”
->
sšfo
.
assoc_»q_›s
 = 
assoc_›
;

2724 
³”
->
sšfo
.
assoc_»q_›s_Ën
 = 
assoc_›_Ën
;

2725 #ià(
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(4, 0, 0))

2726 
³”
->
sšfo
.
fËd
 |ğ
STATION_INFO_ASSOC_REQ_IES
;

2728 
	`¦si_³”_upd©e_assoc_r¥
(
sdev
, 
dev
, 
³”
, 
skb
);

2730 
skb
 = 
NULL
;

2731 ià(
³”
->
assoc_»¥_›
) {

2732 
»assoc_r¥_›
 = 
³”
->
assoc_»¥_›
->
d©a
;

2733 
»assoc_r¥_›_Ën
 = 
³”
->
assoc_»¥_›
->
Ën
;

2734 
	`WARN_ON
(
»assoc_r¥_›_Ën
 && !
»assoc_r¥_›
);

2740 ià(!
	`¡a_wmm_upd©e_u­sd
(
sdev
, 
dev
, 
³”
, 
assoc_›
, 
assoc_›_Ën
))

2741 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Failo update WMM uapsd\n");

2746 ià(!
	`¡a_wmm_upd©e_wmm_ac_›s
(
sdev
, 
dev
, 
³”
, 
»assoc_r¥_›
, 
»assoc_r¥_›_Ën
))

2747 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Failo update WMM AC ies\n");

2751 
	`cfg80211_cÚÃù_»suÉ
(
dev
,

2752 
³”
->
add»ss
,

2753 
assoc_›
, 
assoc_›_Ën
,

2754 
»assoc_r¥_›
, 
»assoc_r¥_›_Ën
,

2755 
¡©us
,

2756 
GFP_KERNEL
);

2758 ià(
¡©us
 =ğ
WLAN_STATUS_SUCCESS
) {

2759 
ndev_vif
->
¡a
.
vif_¡©us
 = 
SLSI_VIF_STATUS_CONNECTED
;

2764 ià((
³”
->
ÿ·b™›s
 & 
WLAN_CAPABILITY_PRIVACY
) &&

2765 (
	`cfg80211_fšd_›
(
WLAN_EID_RSN
, 
assoc_›
, 
assoc_›_Ën
) ||

2766 
	`cfg80211_fšd_›
(
SLSI_WLAN_EID_WAPI
, 
assoc_›
, 
assoc_›_Ën
) ||

2767 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPA
, 
assoc_›
, 
assoc_›_Ën
))) {

2769 
ndev_vif
->
¡a
.
»¥_id
 = 
MLME_REASSOCIATE_RES
;

2770 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DOING_KEY_CONFIG
);

2771 
³”
->
cÚÃùed_¡©e
 = 
SLSI_STA_CONN_STATE_DOING_KEY_CONFIG
;

2774 
	`¦si_mlme_»assocŸ‹_»¥
(
sdev
, 
dev
);

2775 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

2776 
³”
->
cÚÃùed_¡©e
 = 
SLSI_STA_CONN_STATE_CONNECTED
;

2779 
	`Ãtif_ÿ¼›r_off
(
dev
);

2780 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

2781 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

2782 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

2785 
ex™_w™h_lock
:

2786 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

2787 
	`¹Æ_uÆock
();

2788 
	`kä“_skb
(
skb
);

2789 
	}
}

2791 
	$¦si_cÚÃù_»suÉ_code
(
Ãtdev_vif
 *
ndev_vif
, 
u16
 
fw_»suÉ_code
, *
¡©us
, 
Æ80211_timeout_»asÚ
 *
timeout_»asÚ
)

2793 *
¡©us
 = 
fw_»suÉ_code
;

2794 
fw_»suÉ_code
) {

2795 
FAPI_RESULTCODE_PROBE_TIMEOUT
:

2796 *
timeout_»asÚ
 = 
NL80211_TIMEOUT_SCAN
;

2797 #ià(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 11)

2798 *
¡©us
 = 
SLSI_CONNECT_NO_NETWORK_FOUND
;

2801 
FAPI_RESULTCODE_AUTH_TIMEOUT
:

2802 *
¡©us
 = 
WLAN_STATUS_AUTH_TIMEOUT
;

2803 *
timeout_»asÚ
 = 
NL80211_TIMEOUT_AUTH
;

2804 #ià(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 11)

2805 ià(
ndev_vif
->
¡a
.
üy±o
.
w·_v”siÚs
 == 3)

2806 *
¡©us
 = 
SLSI_CONNECT_AUTH_SAE_NO_RESP
;

2808 *
¡©us
 = 
SLSI_CONNECT_AUTH_NO_RESP
;

2811 
FAPI_RESULTCODE_AUTH_NO_ACK
:

2812 *
timeout_»asÚ
 = 
NL80211_TIMEOUT_AUTH
;

2813 *
¡©us
 = 
WLAN_STATUS_AUTH_TIMEOUT
;

2814 #ià(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 11)

2815 ià(
ndev_vif
->
¡a
.
üy±o
.
w·_v”siÚs
 == 3)

2816 *
¡©us
 = 
SLSI_CONNECT_AUTH_SAE_NO_ACK
;

2818 *
¡©us
 = 
SLSI_CONNECT_AUTH_NO_ACK
;

2821 
FAPI_RESULTCODE_AUTH_TX_FAIL
:

2822 *
timeout_»asÚ
 = 
NL80211_TIMEOUT_AUTH
;

2823 *
¡©us
 = 
WLAN_STATUS_AUTH_TIMEOUT
;

2824 #ià(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 11)

2825 ià(
ndev_vif
->
¡a
.
üy±o
.
w·_v”siÚs
 == 3)

2826 *
¡©us
 = 
SLSI_CONNECT_AUTH_SAE_TX_FAIL
;

2828 *
¡©us
 = 
SLSI_CONNECT_AUTH_TX_FAIL
;

2831 
FAPI_RESULTCODE_ASSOC_TIMEOUT
:

2832 *
timeout_»asÚ
 = 
NL80211_TIMEOUT_ASSOC
;

2833 #ià(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 11)

2834 *
¡©us
 = 
SLSI_CONNECT_ASSOC_NO_RESP
;

2837 
FAPI_RESULTCODE_ASSOC_ABORT
:

2838 *
¡©us
 = 
WLAN_STATUS_UNSPECIFIED_FAILURE
;

2840 
FAPI_RESULTCODE_ASSOC_NO_ACK
:

2841 *
timeout_»asÚ
 = 
NL80211_TIMEOUT_ASSOC
;

2842 #ià(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 11)

2843 *
¡©us
 = 
SLSI_CONNECT_ASSOC_NO_ACK
;

2846 
FAPI_RESULTCODE_ASSOC_TX_FAIL
:

2847 *
timeout_»asÚ
 = 
NL80211_TIMEOUT_ASSOC
;

2848 #ià(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 11)

2849 *
¡©us
 = 
SLSI_CONNECT_ASSOC_TX_FAIL
;

2853 *
¡©us
 = 
fw_»suÉ_code
;

2855 
	}
}

2857 
	$¦si_rx_cÚÃù_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

2859 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

2860 
¡©us
 = 
WLAN_STATUS_SUCCESS
;

2861 
¦si_³”
 *
³”
 = 
NULL
;

2862 
u8
 *
assoc_›
 = 
NULL
;

2863 
assoc_›_Ën
 = 0;

2864 
u8
 *
assoc_r¥_›
 = 
NULL
;

2865 
assoc_r¥_›_Ën
 = 0;

2866 
u8
 
bssid
[
ETH_ALEN
];

2867 
u16
 
fw_»suÉ_code
;

2868 
›“80211_chªÃl
 *
cur_chªÃl
 = 
NULL
;

2869 
Æ80211_timeout_»asÚ
 
timeout_»asÚ
 = 
NL80211_TIMEOUT_UNSPECIFIED
;

2871 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
£t_muÉiÿ¡_f‹r_wÜk
);

2872 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
upd©e_pkt_f‹r_wÜk
);

2873 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

2875 
fw_»suÉ_code
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_cÚÃù_šd
.
»suÉ_code
);

2877 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_connect_ind(vif:%d,„esult:0x%04x)\n",

2878 
	`çpi_g‘_vif
(
skb
), 
fw_»suÉ_code
);

2880 ià(!
ndev_vif
->
aùiv©ed
) {

2881 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

2882 
ex™_w™h_lock
;

2885 ià(
	`WARN
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
, "Not‡ Station VIF\n"))

2886 
ex™_w™h_lock
;

2888 ià(
ndev_vif
->
¡a
.
vif_¡©us
 !ğ
SLSI_VIF_STATUS_CONNECTING
) {

2889 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot in connecting state\n");

2890 
ex™_w™h_lock
;

2893 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

2894 ià(
³”
) {

2895 
	`SLSI_ETHER_COPY
(
bssid
, 
³”
->
add»ss
);

2897 
	`SLSI_NET_ERR
(
dev
, "!!NO…eer„ecord for AP\n");

2898 
	`‘h_z”o_addr
(
bssid
);

2900 
sdev
->
assoc_»suÉ_code
 = 
fw_»suÉ_code
;

2901 ià(
fw_»suÉ_code
 !ğ
FAPI_RESULTCODE_SUCCESS
) {

2902 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

2903 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


2904 ià(
ndev_vif
->
¡a
.
üy±o
.
w·_v”siÚs
 =ğ3 &&‚dev_vif->¡a.
w·3_auth_¡©e
 =ğ
SLSI_WPA3_AUTHENTICATING
 &&

2905 (
fw_»suÉ_code
 =ğ
FAPI_RESULTCODE_AUTH_TIMEOUT
 || fw_»suÉ_cod=ğ
FAPI_RESULTCODE_AUTH_NO_ACK
 ||

2906 
fw_»suÉ_code
 =ğ
FAPI_RESULTCODE_AUTH_TX_FAIL
)) {

2907 
r
;

2908 
cfg80211_ex‹º®_auth_·¿ms
 
auth_»que¡
;

2910 
auth_»que¡
.
aùiÚ
 = 
NL80211_EXTERNAL_AUTH_ABORT
;

2911 
	`memıy
(
auth_»que¡
.
bssid
, 
ndev_vif
->
¡a
.bssid, 
ETH_ALEN
);

2912 
	`memıy
(
auth_»que¡
.
ssid
.ssid, 
ndev_vif
->
¡a
.ssid,‚dev_vif->¡a.
ssid_Ën
);

2913 
auth_»que¡
.
ssid
.
ssid_Ën
 = 
ndev_vif
->
¡a
.ssid_len;

2914 
auth_»que¡
.
key_mgmt_su™e
 = 
ndev_vif
->
¡a
.
üy±o
.
akm_su™es
[0];

2915 
r
 = 
	`cfg80211_ex‹º®_auth_»que¡
(
dev
, &
auth_»que¡
, 
GFP_KERNEL
);

2916 ià(
r
)

2917 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "cfg80211_external_auth_request Abort failed");

2920 ià(
ndev_vif
->
¡a
.
drv_bss_£ËùiÚ
 && 
	`¦si_»Œy_cÚÃùiÚ
(
sdev
, 
dev
)) {

2921 
	`SLSI_INFO
(
sdev
, "Connect ind :„etrying connection\n");

2922 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


2923 ià(
ndev_vif
->
¡a
.
üy±o
.
w·_v”siÚs
 == 3)

2924 
ndev_vif
->
¡a
.
w·3_§e_»cÚÃùiÚ
 = 
Œue
;

2926 
ex™_w™h_lock
;

2928 
ndev_vif
->
¡a
.
drv_cÚÃù_»q_Úgošg
 = 
çl£
;

2929 
	`¦si_ä“_cÚÃùiÚ_·¿ms
(
sdev
, 
dev
);

2932 ià(
fw_»suÉ_code
 =ğ
FAPI_RESULTCODE_AUTH_TIMEOUT
) {

2933 
	`SLSI_INFO
(
sdev
, "Connect failed,Result code: Auth Timeout\n");

2934 } ià(
fw_»suÉ_code
 =ğ
FAPI_RESULTCODE_ASSOC_TIMEOUT
) {

2935 
	`SLSI_INFO
(
sdev
, "Connect failed,Result code: Assoc Timeout\n");

2936 } ià(
fw_»suÉ_code
 =ğ
FAPI_RESULTCODE_PROBE_TIMEOUT
) {

2937 
	`SLSI_INFO
(
sdev
, "Connect failed,Result code: Probe Timeout\n");

2938 } ià(
fw_»suÉ_code
 >ğ
FAPI_RESULTCODE_AUTH_FAILED_CODE
 && fw_result_code <= 0x81FF) {

2939 ià(
fw_»suÉ_code
 !ğ
FAPI_RESULTCODE_AUTH_FAILED_CODE
)

2940 
fw_»suÉ_code
 = fw_result_code & 0x00FF;

2941 
	`SLSI_INFO
(
sdev
, "CÚÃù faed(Auth fau»), ResuÉ code:0x%04x\n", 
fw_»suÉ_code
);

2942 } ià(
fw_»suÉ_code
 >ğ
FAPI_RESULTCODE_ASSOC_FAILED_CODE
 && fw_result_code <= 0x82FF) {

2943 ià(
fw_»suÉ_code
 !ğ
FAPI_RESULTCODE_ASSOC_FAILED_CODE
)

2944 
fw_»suÉ_code
 = fw_result_code & 0x00FF;

2945 
	`SLSI_INFO
(
sdev
, "CÚÃù faed(AssoøFau»), ResuÉ code:0x%04x\n", 
fw_»suÉ_code
);

2946 ià(
	`çpi_g‘_d©®’
(
skb
)) {

2947 
mgmt_hdr_Ën
;

2948 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

2950 ià(
	`›“80211_is_assoc_»¥
(
mgmt
->
äame_cÚŒŞ
)) {

2951 
mgmt_hdr_Ën
 = (
mgmt
->
u
.
assoc_»¥
.
v¬ŸbË
 - (
u8
 *)mgmt);

2952 } ià(
	`›“80211_is_»assoc_»¥
(
mgmt
->
äame_cÚŒŞ
)) {

2953 
mgmt_hdr_Ën
 = (
mgmt
->
u
.
»assoc_»¥
.
v¬ŸbË
 - (
u8
 *)mgmt);

2955 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Assoc/Reassoc„esponse‚ot found!\n");

2956 
ex™_w™h_lock
;

2959 
assoc_r¥_›
 = (*)
mgmt
 + 
mgmt_hdr_Ën
;

2960 
assoc_r¥_›_Ën
 = 
	`çpi_g‘_d©®’
(
skb
è- 
mgmt_hdr_Ën
;

2963 
	`SLSI_INFO
(
sdev
, "CÚÃù faed,ResuÉ code:0x%04x\n", 
fw_»suÉ_code
);

2965 ià(
fw_»suÉ_code
 <ğ
FAPI_RESULTCODE_ASSOC_FAILED_CODE
)

2966 
	`¦si_cÚÃù_»suÉ_code
(
ndev_vif
, 
fw_»suÉ_code
, &
¡©us
, &
timeout_»asÚ
);

2967 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

2969 
	`scsc_log_cŞËùÜ_scheduË_cŞËùiÚ
(
SCSC_LOG_HOST_WLAN
, 
SCSC_LOG_HOST_WLAN_REASON_CONNECT_ERR
);

2971 #ià(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

2972 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


2973 ià(
ndev_vif
->
¡a
.
üy±o
.
w·_v”siÚs
 == 3) {

2974 ià(
fw_»suÉ_code
 =ğ
FAPI_RESULTCODE_AUTH_TIMEOUT
 ||

2975 
fw_»suÉ_code
 =ğ
FAPI_RESULTCODE_AUTH_NO_ACK
 ||

2976 
fw_»suÉ_code
 =ğ
FAPI_RESULTCODE_AUTH_TX_FAIL
) {

2977 
r
;

2978 
cfg80211_ex‹º®_auth_·¿ms
 
auth_»que¡
;

2980 
auth_»que¡
.
aùiÚ
 = 
NL80211_EXTERNAL_AUTH_ABORT
;

2981 
	`memıy
(
auth_»que¡
.
bssid
, 
ndev_vif
->
¡a
.bssid, 
ETH_ALEN
);

2982 
	`memıy
(
auth_»que¡
.
ssid
.ssid, 
ndev_vif
->
¡a
.ssid,‚dev_vif->¡a.
ssid_Ën
);

2983 
auth_»que¡
.
ssid
.
ssid_Ën
 = 
ndev_vif
->
¡a
.ssid_len;

2984 
auth_»que¡
.
key_mgmt_su™e
 = 
ndev_vif
->
¡a
.
üy±o
.
akm_su™es
[0];

2985 
r
 = 
	`cfg80211_ex‹º®_auth_»que¡
(
dev
, &
auth_»que¡
, 
GFP_KERNEL
);

2986 ià(
r
)

2987 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "cfg80211_external_auth_request Abort failed");

2993 
	`SLSI_INFO
(
sdev
, "Received Association Response\n");

2995 ià(!
³”
 || !³”->
assoc_›
) {

2996 ià(
³”
)

2997 
	`WARN
(!
³”
->
assoc_›
, "proc-started-ind‚ot„eceived before connect-ind");

2998 
¡©us
 = 
WLAN_STATUS_UNSPECIFIED_FAILURE
;

3000 ià(
³”
->
assoc_›
) {

3001 
assoc_›
 = 
³”
->assoc_›->
d©a
;

3002 
assoc_›_Ën
 = 
³”
->
assoc_›
->
Ën
;

3005 
	`¦si_³”_upd©e_assoc_r¥
(
sdev
, 
dev
, 
³”
, 
skb
);

3007 
skb
 = 
NULL
;

3009 ià(
³”
->
assoc_»¥_›
) {

3010 
assoc_r¥_›
 = 
³”
->
assoc_»¥_›
->
d©a
;

3011 
assoc_r¥_›_Ën
 = 
³”
->
assoc_»¥_›
->
Ën
;

3017 
³”
->
wmm_acm
 = 0;

3018 
³”
->
t¥ec_e¡ablished
 = 0;

3019 
³”
->
u­sd
 = 0;

3024 ià(!
	`¡a_wmm_upd©e_u­sd
(
sdev
, 
dev
, 
³”
, 
assoc_›
, 
assoc_›_Ën
))

3025 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Failo update WMM uapsd\n");

3030 ià(!
	`¡a_wmm_upd©e_wmm_ac_›s
(
sdev
, 
dev
, 
³”
, 
assoc_r¥_›
, 
assoc_r¥_›_Ën
))

3031 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Failo update WMM AC ies\n");

3033 
	`WARN_ON
(!
assoc_r¥_›_Ën
 && !
assoc_r¥_›
);

3036 
	`WARN
(!
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
, "mlme_scan.ind‚ot„eceived before connect-ind");

3038 ià(
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
) {

3039 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION < 11)

3040 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
);

3042 
ndev_vif
->
¡a
.
b—cÚ_št
 = 
mgmt
->
u
.
b—cÚ
.beacon_int;

3044 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "S’dšg sÿÀšdiÿtiÚØcfg80211, bssid: %pM\n", 
	`çpi_g‘_mgmt
(
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
)->
bssid
);

3046 
cur_chªÃl
 = 
	`¦si_rx_sÿn_·ss_to_cfg80211
(
sdev
, 
dev
, 
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
);

3047 
ndev_vif
->
¡a
.
mlme_sÿn_šd_skb
 = 
NULL
;

3050 ià(!
ndev_vif
->
¡a
.
¡a_bss
) {

3051 ià(
³”
)

3052 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 1, 0))

3053 
ndev_vif
->
¡a
.
¡a_bss
 = 
	`cfg80211_g‘_bss
(
sdev
->
why
, 
cur_chªÃl
, 
³”
->
add»ss
,

3054 
NULL
, 0, 
IEEE80211_BSS_TYPE_ANY
,

3055 
IEEE80211_PRIVACY_ANY
);

3057 
ndev_vif
->
¡a
.
¡a_bss
 = 
	`cfg80211_g‘_bss
(
sdev
->
why
, 
cur_chªÃl
, 
³”
->
add»ss
,

3058 
NULL
, 0, 0, 0);

3060 ià(!
ndev_vif
->
¡a
.
¡a_bss
) {

3061 
	`SLSI_NET_ERR
(
dev
, "¡a_bs i nÙ‡vaabË,”mš©šghcÚÃùiÚ (³”: %p)\n", 
³”
);

3062 
¡©us
 = 
WLAN_STATUS_UNSPECIFIED_FAILURE
;

3067 ià(!
³”
 && 
¡©us
 =ğ
WLAN_STATUS_SUCCESS
)

3068 
¡©us
 = 
WLAN_STATUS_UNSPECIFIED_FAILURE
;

3070 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 11, 0))

3071 #ià!(
	`defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 11)

3072 ià(
fw_»suÉ_code
 >ğ
FAPI_RESULTCODE_PROBE_TIMEOUT
 && fw_»suÉ_cod<ğ
FAPI_RESULTCODE_ASSOC_TIMEOUT
) {

3073 
	`cfg80211_cÚÃù_timeout
(
dev
, 
bssid
, 
assoc_›
, 
assoc_›_Ën
,

3074 
GFP_KERNEL
, 
timeout_»asÚ
);

3076 ià(!
ndev_vif
->
¡a
.
rßm_Ú_discÚÃù
 || 
¡©us
 !ğ
WLAN_STATUS_SUCCESS
) {

3077 
	`cfg80211_»f_bss
(
sdev
->
why
, 
ndev_vif
->
¡a
.
¡a_bss
);

3078 
	`cfg80211_cÚÃù_bss
(
dev
, 
bssid
, 
ndev_vif
->
¡a
.
¡a_bss
, 
assoc_›
, 
assoc_›_Ën
, 
assoc_r¥_›
,

3079 
assoc_r¥_›_Ën
, 
¡©us
, 
GFP_KERNEL
, 
timeout_»asÚ
);

3081 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 12, 0))

3082 
cfg80211_rßm_šfo
 
rßm_šfo
 = {};

3088 
rßm_šfo
.
chªÃl
 = 
ndev_vif
->
¡a
.
¡a_bss
->channel;

3089 
rßm_šfo
.
bssid
 = 
ndev_vif
->
¡a
.
¡a_bss
->bssid;

3090 
rßm_šfo
.
»q_›
 = 
assoc_›
;

3091 
rßm_šfo
.
»q_›_Ën
 = 
assoc_›_Ën
;

3092 
rßm_šfo
.
»¥_›
 = 
assoc_r¥_›
;

3093 
rßm_šfo
.
»¥_›_Ën
 = 
assoc_r¥_›_Ën
;

3094 
	`cfg80211_rßmed
(
dev
, &
rßm_šfo
, 
GFP_KERNEL
);

3096 
	`cfg80211_rßmed
(
dev
,

3097 
ndev_vif
->
¡a
.
¡a_bss
->
chªÃl
,

3098 
ndev_vif
->
¡a
.
¡a_bss
->
bssid
,

3099 
assoc_›
,

3100 
assoc_›_Ën
,

3101 
assoc_r¥_›
,

3102 
assoc_r¥_›_Ën
,

3103 
GFP_KERNEL
);

3105 #ifdeà
CONFIG_SCSC_WLAN_KEY_MGMT_OFFLOAD


3106 ià(
	`¦si_£nd_rßm_v’dÜ_ev’t
(
sdev
, 
³”
->
add»ss
, 
assoc_›
, 
assoc_›_Ën
,

3107 
assoc_r¥_›
, 
assoc_r¥_›_Ën
,

3108 
ndev_vif
->
¡a
.
¡a_bss
->
›s
->
d©a
,‚dev_vif->¡a.¡a_bss->›s->
Ën
,

3109 
çl£
) != 0) {

3110 
	`SLSI_NET_ERR
(
dev
, "Couldnt send Roamƒvent");

3113 
ndev_vif
->
¡a
.
rßm_Ú_discÚÃù
 = 
çl£
;

3117 
	`cfg80211_»f_bss
(
sdev
->
why
, 
ndev_vif
->
¡a
.
¡a_bss
);

3118 
	`cfg80211_cÚÃù_bss
(
dev
, 
bssid
, 
ndev_vif
->
¡a
.
¡a_bss
, 
assoc_›
, 
assoc_›_Ën
, 
assoc_r¥_›
,

3119 
assoc_r¥_›_Ën
, 
¡©us
, 
GFP_KERNEL
, 
timeout_»asÚ
);

3125 
	`cfg80211_cÚÃù_»suÉ
(
dev
,

3126 
bssid
,

3127 
assoc_›
, 
assoc_›_Ën
,

3128 
assoc_r¥_›
, 
assoc_r¥_›_Ën
,

3129 (
u16
)
¡©us
,

3130 
GFP_KERNEL
);

3132 ià(
¡©us
 =ğ
WLAN_STATUS_SUCCESS
) {

3133 
ndev_vif
->
¡a
.
vif_¡©us
 = 
SLSI_VIF_STATUS_CONNECTED
;

3139 ià((
³”
->
ÿ·b™›s
 & 
WLAN_CAPABILITY_PRIVACY
) &&

3140 (
	`cfg80211_fšd_›
(
WLAN_EID_RSN
, 
assoc_›
, 
assoc_›_Ën
) ||

3141 
	`cfg80211_fšd_›
(
SLSI_WLAN_EID_WAPI
, 
assoc_›
, 
assoc_›_Ën
) ||

3142 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPA
, 
assoc_›
, 
assoc_›_Ën
))) {

3144 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_DOING_KEY_CONFIG
);

3145 
ndev_vif
->
¡a
.
»¥_id
 = 
MLME_CONNECT_RES
;

3148 
	`¦si_mlme_cÚÃù_»¥
(
sdev
, 
dev
);

3149 ià(
ndev_vif
->
add»ss
)

3150 
	`¦si__add»ss_chªged
(
sdev
, 
dev
, 
ndev_vif
->
add»ss
);

3152 
	`¦si_£t_aş
(
sdev
, 
dev
);

3153 
	`¦si_£t_·ck‘_f‹rs
(
sdev
, 
dev
);

3155 ià(
ndev_vif
->
add»ss
)

3156 
	`¦si_mlme_pow”mgt
(
sdev
, 
dev
, 
ndev_vif
->
£t_pow”_mode
);

3157 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

3163 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_CLIENT
)

3164 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_GROUP_FORMED_CLI
);

3167 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


3168 ià(!
sdev
->
deviû_cÚfig
.
rßm_sÿn_mode
 && 
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&‚dev_vif->
aùiv©ed
 &&‚dev_vif->
iáy³
 !ğ
NL80211_IFTYPE_P2P_CLIENT
) {

3170 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&‚dev_vif->
aùiv©ed
 &&‚dev_vif->
iáy³
 !ğ
NL80211_IFTYPE_P2P_CLIENT
) {

3172 cÚ¡ 
u8
 *
ssid
 = 
	`cfg80211_fšd_›
(
WLAN_EID_SSID
, 
assoc_›
, 
assoc_›_Ën
);

3173 
¦si_rßmšg_ÃtwÜk_m­_’Œy
 *
ÃtwÜk_m­
;

3174 
u8
 
chªÃls
[
SLSI_ROAMING_CHANNELS_MAX
];

3175 
u32
 
chªÃls_couÁ
 = 
	`¦si_rßmšg_sÿn_cÚfigu»_chªÃls
(
sdev
, 
dev
, 
ssid
, 
chªÃls
);

3176 
u8
 
m”ged_chªÃls
[
SLSI_ROAMING_CHANNELS_MAX
 * 2];

3177 
u32
 
m”ge_chª_couÁ
 = 0;

3179 
	`mem£t
(
m”ged_chªÃls
, 0, (merged_channels));

3181 
ÃtwÜk_m­
 = 
	`¦si_rßm_chªÃl_ÿche_g‘
(
dev
, 
ssid
);

3182 ià(
ÃtwÜk_m­
) {

3183 
ndev_vif
->
¡a
.
chªÃls_24_ghz
 = 
ÃtwÜk_m­
->channels_24_ghz;

3184 
ndev_vif
->
¡a
.
chªÃls_5_ghz
 = 
ÃtwÜk_m­
->channels_5_ghz;

3187 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3188 
m”ge_chª_couÁ
 = 
	`¦si_m”ge_li¡s
(
chªÃls
, 
chªÃls_couÁ
,

3189 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
chªÃls
,

3190 
sdev
->
deviû_cÚfig
.
Ëgacy_rßm_sÿn_li¡
.
n
,

3191 
m”ged_chªÃls
);

3192 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

3193 ià(
	`¦si_mlme_£t_ÿched_chªÃls
(
sdev
, 
dev
, 
m”ge_chª_couÁ
, 
m”ged_chªÃls
) != 0)

3194 
	`SLSI_NET_ERR
(
dev
, "MLME-SET-CACHED-CHANNELS.req failed\n");

3200 ià(
fw_»suÉ_code
 =ğ
FAPI_RESULTCODE_SUCCESS
 && 
³”
) {

3201 
	`¦si_mlme_discÚÃù
(
sdev
, 
dev
, 
³”
->
add»ss
, 
FAPI_REASONCODE_UNSPECIFIED_REASON
, 
Œue
);

3202 
	`¦si_hªdË_discÚÃù
(
sdev
, 
dev
, 
³”
->
add»ss
, 
FAPI_REASONCODE_UNSPECIFIED_REASON
, 
NULL
, 0);

3204 
	`¦si_hªdË_discÚÃù
(
sdev
, 
dev
, 
NULL
, 
FAPI_REASONCODE_UNSPECIFIED_REASON
, NULL, 0);

3208 
ex™_w™h_lock
:

3209 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3210 
	`kä“_skb
(
skb
);

3211 
	}
}

3213 
	$¦si_rx_discÚÃù_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3215 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3217 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
£t_muÉiÿ¡_f‹r_wÜk
);

3218 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
upd©e_pkt_f‹r_wÜk
);

3219 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3221 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_disconnect_ind(vif:%d, MAC:%pM)\n",

3222 
	`çpi_g‘_vif
(
skb
),

3223 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_discÚÃù_šd
.
³”_¡a_add»ss
));

3225 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

3226 
	`scsc_log_cŞËùÜ_scheduË_cŞËùiÚ
(
SCSC_LOG_HOST_WLAN
, 
SCSC_LOG_HOST_WLAN_REASON_DISCONNECT_IND
);

3228 #iâdeà
SLSI_TEST_DEV


3229 
	`mx140_log_dump
();

3233 
	`SLSI_INFO
(
sdev
, "Received DEAUTH,„eason = 0\n");

3234 
	`¦si_hªdË_discÚÃù
(
sdev
,

3235 
dev
,

3236 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_discÚÃù_šd
.
³”_¡a_add»ss
),

3238 
NULL
,

3241 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3242 
	`kä“_skb
(
skb
);

3243 
	}
}

3245 
	$¦si_rx_discÚÃùed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3247 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3248 
u16
 
»asÚ
;

3249 
u8
 *
di§ssoc_r¥_›
 = 
NULL
;

3250 
u32
 
di§ssoc_r¥_›_Ën
 = 0;

3252 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
£t_muÉiÿ¡_f‹r_wÜk
);

3253 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
upd©e_pkt_f‹r_wÜk
);

3254 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3255 ià(!
ndev_vif
->
aùiv©ed
) {

3256 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

3257 
ex™
;

3259 
»asÚ
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_discÚÃùed_šd
.
»asÚ_code
);

3260 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_disconnected_ind(vif:%d,„eason:%d, MAC:%pM)\n",

3261 
	`çpi_g‘_vif
(
skb
),

3262 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_discÚÃùed_šd
.
»asÚ_code
),

3263 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_discÚÃùed_šd
.
³”_¡a_add»ss
));

3265 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

3266 
	`scsc_log_cŞËùÜ_scheduË_cŞËùiÚ
(
SCSC_LOG_HOST_WLAN
, 
SCSC_LOG_HOST_WLAN_REASON_DISCONNECTED_IND
);

3268 #iâdeà
SLSI_TEST_DEV


3269 
	`mx140_log_dump
();

3272 ià(
»asÚ
 <= 0xFF) {

3273 
	`SLSI_INFO
(
sdev
, "Reûived DEAUTH,„—sÚ = %d\n", 
»asÚ
);

3274 } ià(
»asÚ
 >= 0x8100 &&„eason <= 0x81FF) {

3275 
»asÚ
 =„eason & 0x00FF;

3276 
	`SLSI_INFO
(
sdev
, "Reûived DEAUTH,„—sÚ = %d\n", 
»asÚ
);

3277 } ià(
»asÚ
 >= 0x8200 &&„eason <= 0x82FF) {

3278 
»asÚ
 =„eason & 0x00FF;

3279 
	`SLSI_INFO
(
sdev
, "Reûived DISASSOC,„—sÚ = %d\n", 
»asÚ
);

3281 
	`SLSI_INFO
(
sdev
, "Reûived DEAUTH,„—sÚ = LoÿÈDiscÚÃù <%d>\n", 
»asÚ
);

3284 ià(
	`çpi_g‘_d©®’
(
skb
è>ğ
	`off£tof
(
›“80211_mgmt
, 
u
.
d—uth
.
»asÚ_code
) + 2) {

3285 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

3287 ià(
	`›“80211_is_d—uth
(
mgmt
->
äame_cÚŒŞ
)) {

3288 
di§ssoc_r¥_›
 = (*)&
mgmt
->
u
.
d—uth
.
»asÚ_code
 + 2;

3289 
di§ssoc_r¥_›_Ën
 = 
	`çpi_g‘_d©®’
(
skb
) -

3290 (
u32
)(
di§ssoc_r¥_›
 - (
u8
 *)
	`çpi_g‘_d©a
(
skb
));

3291 } ià(
	`›“80211_is_di§ssoc
(
mgmt
->
äame_cÚŒŞ
)) {

3292 
di§ssoc_r¥_›
 = (*)&
mgmt
->
u
.
di§ssoc
.
»asÚ_code
 + 2;

3293 
di§ssoc_r¥_›_Ën
 = 
	`çpi_g‘_d©®’
(
skb
) -

3294 (
u32
)(
di§ssoc_r¥_›
 - (
u8
 *)
	`çpi_g‘_d©a
(
skb
));

3296 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Not‡ disassoc/deauth…acket\n");

3300 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
) {

3301 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_discÚÃùed_šd
.
»asÚ_code
) ==

3302 
FAPI_REASONCODE_HOTSPOT_MAX_CLIENT_REACHED
) {

3303 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
,

3305 
	`cfg80211_cÚn_çed
(
dev
, 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_discÚÃùed_šd
.
³”_¡a_add»ss
),

3306 
NL80211_CONN_FAIL_MAX_CLIENTS
, 
GFP_KERNEL
);

3307 
ex™
;

3311 
	`¦si_hªdË_discÚÃù
(
sdev
,

3312 
dev
,

3313 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_discÚÃùed_šd
.
³”_¡a_add»ss
),

3314 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_discÚÃùed_šd
.
»asÚ_code
),

3315 
di§ssoc_r¥_›
,

3316 
di§ssoc_r¥_›_Ën
);

3318 
ex™
:

3319 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3320 
	`kä“_skb
(
skb
);

3321 
	}
}

3324 
	$¦si_rx_p2p_deviû_discov”ed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3326 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3327 
mgmt_Ën
;

3329 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

3331 ià(
ndev_vif
->
chª
) {

3332 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "F»q = %d\n", 
ndev_vif
->
chª
->
ûÁ”_äeq
);

3334 
	`SLSI_NET_ERR
(
dev
, "ndev_vif->chan is NULL\n");

3339 
mgmt_Ën
 = 
	`çpi_g‘_mgm’
(
skb
);

3340 ià(
mgmt_Ën
) {

3341 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

3343 ià(
	`›“80211_is_mgmt
(
mgmt
->
äame_cÚŒŞ
)) {

3344 ià(
	`›“80211_is_´obe_»q
(
mgmt
->
äame_cÚŒŞ
)) {

3345 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_CFG80211
, "Received Probe Request\n");

3346 
	`cfg80211_rx_mgmt
(&
ndev_vif
->
wdev
,‚dev_vif->
chª
->
ûÁ”_äeq
, 0, (cÚ¡ 
u8
 *)
mgmt
, 
mgmt_Ën
, 
GFP_ATOMIC
);

3348 
	`SLSI_NET_ERR
(
dev
, "Ignore Indication - Not Probe Request frame\n");

3351 
	`SLSI_NET_ERR
(
dev
, "Ignore Indication - Not Management frame\n");

3354 
	}
}

3356 
	$¦si_rx_´oûdu»_¡¬‹d_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3358 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3359 
¦si_³”
 *
³”
 = 
NULL
;

3361 
	`¹Æ_lock
();

3362 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3363 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_procedure_started_ind(vif:%d,ype:%d,‡id:%d)\n",

3364 
	`çpi_g‘_vif
(
skb
),

3365 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_´oûdu»_¡¬‹d_šd
.
´oûdu»_ty³
),

3366 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_´oûdu»_¡¬‹d_šd
.
assocŸtiÚ_id’tif›r
));

3367 ià(!
ndev_vif
->
aùiv©ed
) {

3368 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

3369 
ex™_w™h_lock
;

3371 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_´oûdu»_¡¬‹d_šd
.
´oûdu»_ty³
è!ğ
FAPI_PROCEDURETYPE_DEVICE_DISCOVERED
)

3372 
	`SLSI_INFO
(
sdev
, "Send Association Request\n");

3374 ià(!
ndev_vif
->
aùiv©ed
) {

3375 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

3376 
ex™_w™h_lock
;

3379 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_´oûdu»_¡¬‹d_šd
.
´oûdu»_ty³
)) {

3380 
FAPI_PROCEDURETYPE_CONNECTION_STARTED
:

3381 
ndev_vif
->
vif_ty³
) {

3382 
FAPI_VIFTYPE_AP
:

3384 
u16
 
aid
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_´oûdu»_¡¬‹d_šd
.
assocŸtiÚ_id’tif›r
);

3387 ià((
ndev_vif
->
³”_¡a_»cÜds
 + 1è> 
SLSI_AP_PEER_CONNECTIONS_MAX
) {

3388 
	`SLSI_NET_ERR
(
dev
, "MAX StiÚ†im™„—ched. IgnÜšd fÜ‡id:%d\n", 
aid
);

3389 
ex™_w™h_lock
;

3392 ià(
aid
 < 
SLSI_PEER_INDEX_MIN
 ||‡id > 
SLSI_PEER_INDEX_MAX
) {

3393 
	`SLSI_NET_ERR
(
dev
, "Reûived incÜ»ù‡id: %d\n", 
aid
);

3394 
ex™_w™h_lock
;

3397 
³”
 = 
	`¦si_³”_add
(
sdev
, 
dev
, (
	`çpi_g‘_mgmt
(
skb
))->
§
, 
aid
);

3398 ià(!
³”
) {

3399 
	`SLSI_NET_ERR
(
dev
, "Peer NOT Created\n");

3400 
ex™_w™h_lock
;

3402 
	`¦si_³”_upd©e_assoc_»q
(
sdev
, 
dev
, 
³”
, 
skb
);

3404 
skb
 = 
NULL
;

3405 
³”
->
cÚÃùed_¡©e
 = 
SLSI_STA_CONN_STATE_CONNECTING
;

3407 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_GO
 &&

3408 
³”
->
assoc_›
 &&

3409 
	`cfg80211_fšd_v’dÜ_›
(
WLAN_OUI_MICROSOFT
, 
WLAN_OUI_TYPE_MICROSOFT_WPS
, 
³”
->
assoc_›
->
d©a
,…“r->assoc_›->
Ën
)) {

3410 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "WPS IE is…resent. Setting…eer->is_wpso TRUE\n");

3411 
³”
->
is_wps
 = 
Œue
;

3417 
	`¦si_wake_lock_timeout
(&
sdev
->
wÏn_wl_mlme
, 
	`m£cs_to_jiff›s
(
SLSI_WAKELOCK_TIME_MSEC_EAPOL
));

3420 
FAPI_VIFTYPE_STATION
:

3422 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

3423 ià(
	`WARN_ON
(!
³”
)) {

3424 
	`SLSI_NET_ERR
(
dev
, "Peer NOT FOUND\n");

3425 
ex™_w™h_lock
;

3427 
	`¦si_³”_upd©e_assoc_»q
(
sdev
, 
dev
, 
³”
, 
skb
);

3429 
skb
 = 
NULL
;

3433 
	`SLSI_NET_ERR
(
dev
, "Incorrect vifype for…roceduretype_connection_started\n");

3437 
FAPI_PROCEDURETYPE_DEVICE_DISCOVERED
:

3439 ià(!
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
è&&‚dev_vif->
iáy³
 !ğ
NL80211_IFTYPE_P2P_GO
) {

3440 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "PROCEDURETYPE_DEVICE_DISCOVERED„ecd in‚on P2P„ole\n");

3441 
ex™_w™h_lock
;

3447 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_LISTENING
 || 
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_GO
)

3448 
	`¦si_rx_p2p_deviû_discov”ed_šd
(
sdev
, 
dev
, 
skb
);

3450 
FAPI_PROCEDURETYPE_ROAMING_STARTED
:

3452 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "Rßmšg Proûdu» S¹šg w™h %pM\n", (
	`çpi_g‘_mgmt
(
skb
))->
bssid
);

3453 ià(
	`WARN_ON
(
ndev_vif
->
vif_ty³
 !ğ
FAPI_VIFTYPE_STATION
))

3454 
ex™_w™h_lock
;

3455 ià(
	`WARN_ON
(!
ndev_vif
->
³”_¡a_»cÜd
[
SLSI_STA_PEER_QUEUESET
] || !ndev_vif->³”_¡a_»cÜd[SLSI_STA_PEER_QUEUESET]->
v®id
))

3456 
ex™_w™h_lock
;

3457 
	`kä“_skb
(
ndev_vif
->
¡a
.
rßm_mlme_´oûdu»_¡¬‹d_šd
);

3458 
ndev_vif
->
¡a
.
rßm_mlme_´oûdu»_¡¬‹d_šd
 = 
skb
;

3460 
skb
 = 
NULL
;

3464 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "UnknowÀProûdu»: %d\n", 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_´oûdu»_¡¬‹d_šd
.
´oûdu»_ty³
));

3465 
ex™_w™h_lock
;

3468 
ex™_w™h_lock
:

3469 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3470 
	`¹Æ_uÆock
();

3471 
	`kä“_skb
(
skb
);

3472 
	}
}

3474 
	$¦si_rx_äame_ŒªsmissiÚ_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3476 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3477 
¦si_³”
 *
³”
;

3478 
u16
 
ho¡_g
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_äame_ŒªsmissiÚ_šd
.host_tag);

3479 
u16
 
tx_¡©us
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_äame_ŒªsmissiÚ_šd
.
ŒªsmissiÚ_¡©us
);

3480 
boŞ
 
ack
 = 
Œue
;

3482 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3484 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
,

3486 
	`çpi_g‘_vif
(
skb
), 
ho¡_g
, 
tx_¡©us
);

3487 ià(!
ndev_vif
->
aùiv©ed
) {

3488 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

3489 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3490 
	`kä“_skb
(
skb
);

3494 #ifdeà
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL


3495 ià(
ho¡_g
 & 
SLSI_HOST_TAG_ARP_MASK
) {

3496 
	`©omic_dec
(&
sdev
->
¬p_tx_couÁ
);

3497 
	`©omic_dec
(&
ndev_vif
->
¬p_tx_couÁ
);

3498 ià(
	`©omic_»ad
(&
sdev
->
ù¾_·u£_¡©e
) &&

3499 
	`©omic_»ad
(&
sdev
->
¬p_tx_couÁ
è< (sdev->
fw_max_¬p_couÁ
 - 
SLSI_ARP_UNPAUSE_THRESHOLD
))

3500 
	`scsc_wifi_uÅau£_¬p_q_®l_vif
(
sdev
);

3504 ià(
ndev_vif
->
mgmt_tx_d©a
.
ho¡_g
 == host_tag) {

3505 
Ãtdev_vif
 *
ndev_vif_to_cfg
 = 
ndev_vif
;

3510 ià(
tx_¡©us
 !ğ
FAPI_TRANSMISSIONSTATUS_SUCCESSFUL
) {

3511 
ack
 = 
çl£
;

3512 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

3513 ià(
sdev
->
wÏn_unsync_vif_¡©e
 =ğ
WLAN_UNSYNC_VIF_TX
)

3514 
sdev
->
wÏn_unsync_vif_¡©e
 = 
WLAN_UNSYNC_VIF_ACTIVE
;

3516 ià(
sdev
->
p2p_group_exp_äame
 !ğ
SLSI_PA_INVALID
)

3517 
	`¦si_ş—r_offchªÃl_d©a
(
sdev
, 
çl£
);

3518 ià(
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 !ğ
SLSI_PA_INVALID
)

3519 ()
	`¦si_mlme_»£t_dw–l_time
(
sdev
, 
dev
);

3520 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

3525 ià(
	`SLSI_IS_VIF_INDEX_P2P
(
ndev_vif
è&&‚dev_vif->
mgmt_tx_d©a
.
exp_äame
 =ğ
SLSI_PA_INVALID
) {

3526 ià(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
))

3527 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_LISTENING
);

3529 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_VIF_ACTIVE
);

3530 } ià(
	`SLSI_IS_VIF_INDEX_P2P_GROUP
(
sdev
, 
ndev_vif
)) {

3531 cÚ¡ 
›“80211_mgmt
 *
mgmt
 = (cÚ¡ ›“80211_mgmˆ*)
ndev_vif
->
mgmt_tx_d©a
.
buf
;

3536 ià((
mgmt
è&& (
	`memcmp
(mgmt->
§
, 
dev
->
dev_addr
, 
ETH_ALEN
) != 0)) {

3537 
Ãt_deviû
 *
ndev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_P2P
);

3539 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
,

3543 
ndev_vif_to_cfg
 = 
	`Ãtdev_´iv
(
ndev
);

3544 ià(!
ndev_vif_to_cfg
) {

3545 
	`SLSI_NET_ERR
(
dev
, "Getting P2P Index‚etdev failed\n");

3546 
ndev_vif_to_cfg
 = 
ndev_vif
;

3550 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


3551 ià(!
sdev
->
deviû_cÚfig
.
wes_mode
) {

3553 
	`cfg80211_mgmt_tx_¡©us
(&
ndev_vif_to_cfg
->
wdev
, 
ndev_vif
->
mgmt_tx_d©a
.
cook›
,‚dev_vif->mgmt_tx_d©a.
buf
,‚dev_vif->mgmt_tx_d©a.
buf_Ën
, 
ack
, 
GFP_KERNEL
);

3554 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


3557 ()
	`¦si_£t_mgmt_tx_d©a
(
ndev_vif
, 0, 0, 
NULL
, 0);

3560 ià(
tx_¡©us
 =ğ
FAPI_TRANSMISSIONSTATUS_SUCCESSFUL
 ||x_¡©u =ğ
FAPI_TRANSMISSIONSTATUS_RETRY_LIMIT
) {

3561 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


3562 ià(
ndev_vif
->
’hªûd_¬p_d‘eù_’abËd
 &&‚dev_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

3563 
i
 = 0;

3565 
i
 = 0; i < 
SLSI_MAX_ARP_SEND_FRAME
; i++) {

3566 ià(
ndev_vif
->
’hªûd_¬p_ho¡_g
[
i
] =ğ
ho¡_g
) {

3567 
ndev_vif
->
’hªûd_¬p_ho¡_g
[
i
] = 0;

3568 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_»q_rx_couÁ_by_low”_mac
++;

3569 ià(
tx_¡©us
 =ğ
FAPI_TRANSMISSIONSTATUS_SUCCESSFUL
)

3570 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_»q_couÁ_tx_sucûss
++;

3576 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

3577 
ndev_vif
->
¡a
.
m4_ho¡_g
 =ğ
ho¡_g
) {

3578 
ndev_vif
->
¡a
.
»¥_id
) {

3579 
MLME_ROAMED_RES
:

3580 
	`¦si_mlme_rßmed_»¥
(
sdev
, 
dev
);

3581 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

3582 ià(
	`WARN_ON
(!
³”
))

3584 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

3585 
	`ÿc_upd©e_rßm_Œaffic_·¿ms
(
sdev
, 
dev
);

3587 
MLME_CONNECT_RES
:

3588 
	`¦si_mlme_cÚÃù_»¥
(
sdev
, 
dev
);

3589 ià(
ndev_vif
->
add»ss
)

3590 
	`¦si__add»ss_chªged
(
sdev
, 
dev
, 
ndev_vif
->
add»ss
);

3591 
	`¦si_£t_aş
(
sdev
, 
dev
);

3592 
	`¦si_£t_·ck‘_f‹rs
(
sdev
, 
dev
);

3593 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

3594 ià(
	`WARN_ON
(!
³”
))

3596 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

3598 
MLME_REASSOCIATE_RES
:

3599 
	`¦si_mlme_»assocŸ‹_»¥
(
sdev
, 
dev
);

3604 
ndev_vif
->
¡a
.
m4_ho¡_g
 = 0;

3605 
ndev_vif
->
¡a
.
»¥_id
 = 0;

3607 ià(
tx_¡©us
 =ğ
FAPI_TRANSMISSIONSTATUS_RETRY_LIMIT
) {

3608 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_STATION
 &&

3609 
ndev_vif
->
¡a
.
—p_ho¡g
 =ğ
ho¡_g
) {

3610 ià(
ndev_vif
->
¡a
.
¡a_bss
) {

3611 
	`SLSI_NET_WARN
(
dev
, "Disconnect‡s EAP frameransmission failed\n");

3612 
	`¦si_mlme_discÚÃù
(
sdev
, 
dev
, 
ndev_vif
->
¡a
.
¡a_bss
->
bssid
, 
FAPI_REASONCODE_UNSPECIFIED_REASON
, 
çl£
);

3614 
	`SLSI_NET_WARN
(
dev
, "EAP frameransmission failed, sta_bss‚ot‡vailable\n");

3617 
ndev_vif
->
¡©s
.
tx_”rÜs
++;

3620 
ndev_vif
->
¡©s
.
tx_”rÜs
++;

3622 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

3623 
	`kä“_skb
(
skb
);

3624 
	}
}

3626 #ifdeà
CONFIG_SCSC_WLAN_NW_PKT_DROP


3627 
	$by·ss_backlog
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3629 
·ck‘_ty³
 *
±y³
, *
±_´ev
;

3630 
li¡_h—d
 
±y³_®l
;

3631 
li¡_h—d
 
±y³_ba£
[
PTYPE_HASH_SIZE
];

3632 
sk_buff
 *
tskb
;

3634 
	`skb_»£t_ÃtwÜk_h—d”
(
skb
);

3635 ià(!
	`skb_Œª¥Üt_h—d”_was_£t
(
skb
))

3636 
	`skb_»£t_Œª¥Üt_h—d”
(
skb
);

3637 
	`skb_»£t_mac_Ën
(
skb
);

3639 
±_´ev
 = 
NULL
;

3640 
	`li¡_fÜ_—ch_’Œy_rcu
(
±y³
, &
±y³_®l
, 
li¡
) {

3641 ià(
±_´ev
) {

3642 
tskb
 = 
	`skb_cİy
(
skb
, 
GFP_ATOMIC
);

3643 ià(
tskb
)

3644 
±_´ev
->
	`func
(
tskb
, 
dev
,…t_prev, dev);

3646 
±_´ev
 = 
±y³
;

3648 
	`li¡_fÜ_—ch_’Œy_rcu
(
±y³
, &
dev
->
±y³_®l
, 
li¡
) {

3649 ià(
±_´ev
) {

3650 
tskb
 = 
	`skb_cİy
(
skb
, 
GFP_ATOMIC
);

3651 ià(
tskb
)

3652 
±_´ev
->
	`func
(
tskb
, 
dev
,…t_prev, dev);

3654 
±_´ev
 = 
±y³
;

3656 
	`li¡_fÜ_—ch_’Œy_rcu
(
±y³
, &
±y³_ba£
[
	`Áohs
(
skb
->
´ÙocŞ
è& 
PTYPE_HASH_MASK
], 
li¡
) {

3657 ià(
±y³
->
ty³
 !ğ
skb
->
´ÙocŞ
)

3659 ià(
±_´ev
) {

3660 
tskb
 = 
	`skb_cİy
(
skb
, 
GFP_ATOMIC
);

3661 ià(
tskb
)

3662 
±_´ev
->
	`func
(
tskb
, 
dev
,…t_prev, dev);

3664 
±_´ev
 = 
±y³
;

3666 
	`li¡_fÜ_—ch_’Œy_rcu
(
±y³
, &
dev
->
±y³_¥ecific
, 
li¡
) {

3667 ià(
±y³
->
ty³
 !ğ
skb
->
´ÙocŞ
)

3669 ià(
±_´ev
) {

3670 
tskb
 = 
	`skb_cİy
(
skb
, 
GFP_ATOMIC
);

3671 ià(
tskb
)

3672 
±_´ev
->
	`func
(
tskb
, 
dev
,…t_prev, dev);

3674 
±_´ev
 = 
±y³
;

3676 ià(
±_´ev
)

3677 
±_´ev
->
	`func
(
skb
, 
dev
,…t_prev, dev);

3679 
	`kä“_skb
(
skb
);

3680 
	}
}

3682 
boŞ
 
	$¦si_rx_»ûived_äame_loggšg
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, *
log_¡r_bufãr
, 
bufãr_size
)

3684 
u16
 
´ÙocŞ
 = 0;

3685 
u8
 *
—pŞ
 = 
NULL
;

3686 
u8
 *
—p
 = 
NULL
;

3687 
u16
 
—p_Ëngth
 = 0;

3688 
u32
 
dhı_mes§ge_ty³
 = 
SLSI_DHCP_MESSAGE_TYPE_INVALID
;

3689 
boŞ
 
is_—pŞ_dhı
 = 
çl£
;

3691 ià((
skb
->
Ën
 - (
‘hhdr
)) >= 99)

3692 
—pŞ
 = 
skb
->
d©a
 + (
‘hhdr
);

3694 ià((
skb
->
Ën
 - (
‘hhdr
)) >= 9) {

3695 
—p_Ëngth
 = (
skb
->
Ën
 - (
‘hhdr
)) - 4;

3696 
—p
 = 
skb
->
d©a
 + (
‘hhdr
);

3698 ià(
skb
->
Ën
 >ğ285 && 
	`¦si_is_dhı_·ck‘
(skb->
d©a
è!ğ
SLSI_TX_IS_NOT_DHCP
)

3699 
dhı_mes§ge_ty³
 = 
skb
->
d©a
[284];

3701 
skb
->
´ÙocŞ
 = 
	`‘h_ty³_Œªs
(skb, 
dev
);

3702 
´ÙocŞ
 = 
	`Áohs
(
skb
->protocol);

3704 ià(
´ÙocŞ
 =ğ
ETH_P_PAE
) {

3705 ià(
—pŞ
 &&ƒ­Ş[
SLSI_EAPOL_IEEE8021X_TYPE_POS
] =ğ
SLSI_IEEE8021X_TYPE_EAPOL_KEY
) {

3706 ià((
—pŞ
[
SLSI_EAPOL_TYPE_POS
] =ğ
SLSI_EAPOL_TYPE_RSN_KEY
 ||

3707 
—pŞ
[
SLSI_EAPOL_TYPE_POS
] =ğ
SLSI_EAPOL_TYPE_WPA_KEY
) &&

3708 (
—pŞ
[
SLSI_EAPOL_KEY_INFO_LOWER_BYTE_POS
] &

3709 
SLSI_EAPOL_KEY_INFO_KEY_TYPE_BIT_IN_LOWER_BYTE
) &&

3710 (
—pŞ
[
SLSI_EAPOL_KEY_INFO_HIGHER_BYTE_POS
] &

3711 
SLSI_EAPOL_KEY_INFO_MIC_BIT_IN_HIGHER_BYTE
) &&

3712 
—pŞ
[
SLSI_EAPOL_KEY_DATA_LENGTH_HIGHER_BYTE_POS
] == 0 &&

3713 
—pŞ
[
SLSI_EAPOL_KEY_DATA_LENGTH_LOWER_BYTE_POS
] == 0) {

3714 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "4way-H/S, M4");

3715 } ià(!(
—pŞ
[
SLSI_EAPOL_KEY_INFO_HIGHER_BYTE_POS
] &

3716 
SLSI_EAPOL_KEY_INFO_MIC_BIT_IN_HIGHER_BYTE
)) {

3717 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "4way-H/S, M1");

3718 
is_—pŞ_dhı
 = 
Œue
;

3719 } ià(
—pŞ
[
SLSI_EAPOL_KEY_INFO_HIGHER_BYTE_POS
] &

3720 
SLSI_EAPOL_KEY_INFO_SECURE_BIT_IN_HIGHER_BYTE
) {

3721 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "4way-H/S, M3");

3722 
is_—pŞ_dhı
 = 
Œue
;

3724 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "4way-H/S, M2");

3726 } ià(
—p
 &&ƒ­[
SLSI_EAPOL_IEEE8021X_TYPE_POS
] =ğ
SLSI_IEEE8021X_TYPE_EAP_PACKET
) {

3727 
—p
[
SLSI_EAP_CODE_POS
]) {

3728 
SLSI_EAP_PACKET_REQUEST
:

3729 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "EAP-Reque¡ (%d)", 
—p_Ëngth
);

3731 
SLSI_EAP_PACKET_RESPONSE
:

3732 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "EAP-Re¥Ú£ (%d)", 
—p_Ëngth
);

3734 
SLSI_EAP_PACKET_SUCCESS
:

3735 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "EAP-Sucûs (%d)", 
—p_Ëngth
);

3737 
SLSI_EAP_PACKET_FAILURE
:

3738 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "EAP-Fau» (%d)", 
—p_Ëngth
);

3742 } ià(
´ÙocŞ
 =ğ
ETH_P_IP
) {

3743 
dhı_mes§ge_ty³
) {

3744 
SLSI_DHCP_MESSAGE_TYPE_DISCOVER
:

3745 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "DHCP [DISCOVER]");

3747 
SLSI_DHCP_MESSAGE_TYPE_OFFER
:

3748 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "DHCP [OFFER]");

3749 
is_—pŞ_dhı
 = 
Œue
;

3751 
SLSI_DHCP_MESSAGE_TYPE_REQUEST
:

3752 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "DHCP [REQUEST]");

3754 
SLSI_DHCP_MESSAGE_TYPE_DECLINE
:

3755 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "DHCP [DECLINE]");

3757 
SLSI_DHCP_MESSAGE_TYPE_ACK
:

3758 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "DHCP [ACK]");

3759 
is_—pŞ_dhı
 = 
Œue
;

3761 
SLSI_DHCP_MESSAGE_TYPE_NAK
:

3762 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "DHCP [NAK]");

3764 
SLSI_DHCP_MESSAGE_TYPE_RELEASE
:

3765 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "DHCP [RELEASE]");

3767 
SLSI_DHCP_MESSAGE_TYPE_INFORM
:

3768 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "DHCP [INFORM]");

3770 
SLSI_DHCP_MESSAGE_TYPE_FORCERENEW
:

3771 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "DHCP [FORCERENEW]");

3773 
SLSI_DHCP_MESSAGE_TYPE_INVALID
:

3774 
	`SLSI_DBG1_NODEV
(
SLSI_RX
, "Received IP…kt but‚ot DHCP\n");

3777 
	`¢´štf
(
log_¡r_bufãr
, 
bufãr_size
, "DHCP [INVALID]");

3781  
is_—pŞ_dhı
;

3782 
	}
}

3784 
	$¦si_rx_»ûived_äame_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

3786 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

3787 
u16
 
d©a_un™_desütÜ
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_»ûived_äame_šd
.data_unit_descriptor);

3788 
u16
 
äequ’cy
 = 
	`SLSI_FREQ_FW_TO_HOST
(
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_»ûived_äame_šd
.
chªÃl_äequ’cy
));

3789 
subty³
 = 
SLSI_PA_INVALID
;

3790 
log_¡r_bufãr
[128] = {0};

3791 
sk_buff
 *
log_skb
 = 
NULL
;

3792 
boŞ
 
is_drİ³d
 = 
çl£
;

3793 #ifdeà
CONFIG_SCSC_WLAN_NW_PKT_DROP


3794 
boŞ
 
is_—pŞ_dhı
 = 
çl£
;

3797 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "mlme_received_frame_ind(vif:%d, data descriptor:%d, freq:%d)\n",

3798 
	`çpi_g‘_vif
(
skb
),

3799 
d©a_un™_desütÜ
,

3800 
äequ’cy
);

3802 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

3803 ià(
d©a_un™_desütÜ
 =ğ
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
) {

3804 
›“80211_mgmt
 *
mgmt
;

3805 
mgmt_Ën
;

3807 
mgmt_Ën
 = 
	`çpi_g‘_mgm’
(
skb
);

3808 ià(!
mgmt_Ën
)

3809 
ex™
;

3810 
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

3811 ià(
	`›“80211_is_auth
(
mgmt
->
äame_cÚŒŞ
)) {

3812 
	`cfg80211_rx_mgmt
(&
ndev_vif
->
wdev
, 
äequ’cy
, 0, (cÚ¡ 
u8
 *)
mgmt
, 
mgmt_Ën
, 
GFP_ATOMIC
);

3813 
	`SLSI_INFO
(
sdev
, "Received Auth Frame\n");

3814 
ex™
;

3816 #ià
	`defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

3817 ià(
	`›“80211_is_b—cÚ
(
mgmt
->
äame_cÚŒŞ
)) {

3818 ià(!
ndev_vif
->
is_ws_ruÂšg
) {

3819 
	`SLSI_NET_WARN
(
dev
, "Unwanted beacon is forwarded");

3820 
	`¦si_mlme_£t_fÜw¬d_b—cÚ
(
sdev
, 
dev
, 
çl£
);

3821 } ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

3822 
	`¦si_hªdË_ws_b—cÚ
(
sdev
, 
dev
, 
skb
, 
mgmt
, 
mgmt_Ën
);

3825 
ex™
;

3828 ià(!(
	`›“80211_is_aùiÚ
(
mgmt
->
äame_cÚŒŞ
))) {

3829 
	`SLSI_NET_ERR
(
dev
, "Expected‡n Action Frame\n");

3830 
ex™
;

3833 
subty³
 = 
	`¦si_g‘_public_aùiÚ_subty³
(
mgmt
);

3834 ià(
	`SLSI_IS_VIF_INDEX_WLAN
(
ndev_vif
)) {

3835 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


3836 ià(
	`¦si_is_wes_aùiÚ_äame
(
mgmt
)) {

3837 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_CFG80211
, "Received NCHO WES VS‡ction frame\n");

3838 ià(!
sdev
->
deviû_cÚfig
.
wes_mode
)

3839 
ex™
;

3842 ià(
mgmt
->
u
.
aùiÚ
.
ÿ‹gÜy
 =ğ
WLAN_CATEGORY_WMM
) {

3843 
	`ÿc_rx_wmm_aùiÚ
(
sdev
, 
dev
, 
mgmt
, 
mgmt_Ën
);

3845 
	`¦si_wÏn_dump_public_aùiÚ_subty³
(
sdev
, 
mgmt
, 
çl£
);

3846 ià(
sdev
->
wÏn_unsync_vif_¡©e
 =ğ
WLAN_UNSYNC_VIF_TX
)

3847 
sdev
->
wÏn_unsync_vif_¡©e
 = 
WLAN_UNSYNC_VIF_ACTIVE
;

3848 ià(
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 !ğ
SLSI_PA_INVALID
 && 
subty³
 ==‚dev_vif->mgmt_tx_data.exp_frame) {

3849 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

3850 ()
	`¦si_mlme_»£t_dw–l_time
(
sdev
, 
dev
);

3853 #ifdeà
CONFIG_SCSC_WLAN_WES_NCHO


3857 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "Reûived‡ùiÚ f¿m(%s)\n", 
	`¦si_·_subty³_‹xt
(
subty³
));

3859 ià(
	`SLSI_IS_P2P_UNSYNC_VIF
(
ndev_vif
è&&‚dev_vif->
mgmt_tx_d©a
.
exp_äame
 !ğ
SLSI_PA_INVALID
 &&

3860 
subty³
 =ğ
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
) {

3861 ià(
sdev
->
p2p_¡©e
 =ğ
P2P_LISTENING
)

3862 
	`SLSI_NET_WARN
(
dev
, "Driver in incorrect P2P state (P2P_LISTENING)");

3864 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
d–_vif_wÜk
);

3875 ià(
subty³
 =ğ
SLSI_P2P_PA_GO_NEG_CFM
 || subty³ =ğ
SLSI_P2P_PA_PROV_DISC_RSP
) {

3876 
ndev_vif
->
drv_š_p2p_´oûdu»
 = 
çl£
;

3877 ià(!
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
)) {

3878 ià(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
))

3879 
	`ÿnûl_d–ayed_wÜk
(&
ndev_vif
->
unsync
.
un£t_chªÃl_expœy_wÜk
);

3880 
	`queue_d–ayed_wÜk
(
ndev_vif
->
sdev
->
deviû_wq
, &ndev_vif->
unsync
.
un£t_chªÃl_expœy_wÜk
,

3881 
	`m£cs_to_jiff›s
(
SLSI_P2P_DELAY_UNSET_CHANNEL_AFTER_P2P_PROCEDURE
));

3883 ()
	`¦si_mlme_»£t_dw–l_time
(
sdev
, 
dev
);

3889 ()
	`¦si_mlme_»£t_dw–l_time
(
sdev
, 
dev
);

3892 
ndev_vif
->
mgmt_tx_d©a
.
exp_äame
 = 
SLSI_PA_INVALID
;

3893 ià(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
)) {

3894 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_LISTENING
);

3896 
	`queue_d–ayed_wÜk
(
sdev
->
deviû_wq
, &
ndev_vif
->
unsync
.
d–_vif_wÜk
,

3897 
	`m£cs_to_jiff›s
(
SLSI_P2P_UNSYNC_VIF_EXTRA_MSEC
));

3898 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_VIF_ACTIVE
);

3907 ià(
ndev_vif
->
mgmt_tx_d©a
.
ho¡_g
) {

3908 
	`cfg80211_mgmt_tx_¡©us
(&
ndev_vif
->
wdev
,‚dev_vif->
mgmt_tx_d©a
.
cook›
,‚dev_vif->mgmt_tx_d©a.
buf
,‚dev_vif->mgmt_tx_d©a.
buf_Ën
, 
Œue
, 
GFP_KERNEL
);

3909 ()
	`¦si_£t_mgmt_tx_d©a
(
ndev_vif
, 0, 0, 
NULL
, 0);

3911 } ià((
sdev
->
p2p_group_exp_äame
 !ğ
SLSI_PA_INVALID
è&& (sdev->p2p_group_exp_äam=ğ
subty³
)) {

3912 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
, "Ex³ùed‡ùiÚ f¿m(%sè»ûived oÀGrou°VIF\n", 
	`¦si_·_subty³_‹xt
(
subty³
));

3913 
	`¦si_ş—r_offchªÃl_d©a
(
sdev
,

3914 (!
	`SLSI_IS_VIF_INDEX_P2P_GROUP
(
sdev
,

3915 
ndev_vif
)è? 
Œue
 : 
çl£
);

3923 } ià(
	`SLSI_IS_P2P_UNSYNC_VIF
(
ndev_vif
è&& (ndev_vif->
mgmt_tx_d©a
.
exp_äame
 =ğ
SLSI_PA_INVALID
è&& (
subty³
 =ğ
SLSI_P2P_PA_GO_NEG_REQ
)) {

3924 ià(
ndev_vif
->
mgmt_tx_d©a
.
ho¡_g
) {

3925 ià(
	`d–ayed_wÜk_³ndšg
(&
ndev_vif
->
unsync
.
roc_expœy_wÜk
))

3926 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_LISTENING
);

3928 
	`SLSI_P2P_STATE_CHANGE
(
sdev
, 
P2P_IDLE_VIF_ACTIVE
);

3929 
	`cfg80211_mgmt_tx_¡©us
(&
ndev_vif
->
wdev
,‚dev_vif->
mgmt_tx_d©a
.
cook›
,‚dev_vif->mgmt_tx_d©a.
buf
,‚dev_vif->mgmt_tx_d©a.
buf_Ën
, 
Œue
, 
GFP_KERNEL
);

3930 ()
	`¦si_£t_mgmt_tx_d©a
(
ndev_vif
, 0, 0, 
NULL
, 0);

3935 
	`cfg80211_rx_mgmt
(&
ndev_vif
->
wdev
, 
äequ’cy
, 0, (cÚ¡ 
u8
 *)
mgmt
, 
mgmt_Ën
, 
GFP_ATOMIC
);

3936 } ià(
d©a_un™_desütÜ
 =ğ
FAPI_DATAUNITDESCRIPTOR_IEEE802_3_FRAME
) {

3937 
¦si_³”
 *
³”
 = 
NULL
;

3938 
‘hhdr
 *
ehdr
 = (‘hhd¸*)
	`çpi_g‘_d©a
(
skb
);

3941 ià(
	`uÆik–y
(
	`¦si_skb_cb_g‘
(
skb
)->
wakeup
))

3942 
	`¦si_rx_upd©e_wake_¡©s
(
sdev
, 
ehdr
, 
skb
->
Ën
 - 
	`çpi_g‘_sigËn
(skb));

3944 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
ehdr
->
h_sourû
);

3945 ià(!
³”
) {

3946 
	`SLSI_DBG1
(
sdev
, 
SLSI_RX
, "drop…acket‡s No…eer found\n");

3947 
ex™
;

3951 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 && (
	`is_muÉiÿ¡_‘h”_addr
(
ehdr
->
h_de¡
))) {

3952 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_RX
, "multicast/broadcast…acket„eceived in STA mode skip BA\n");

3954 
ba_check_dÚe
;

3964 ià((
	`FAPI_MAJOR_VERSION
(
FAPI_CONTROL_SAP_VERSION
) >= 0x0e) &&

3965 (
	`FAPI_MINOR_VERSION
(
FAPI_CONTROL_SAP_VERSION
) >= 0x06) &&

3966 (
FAPI_CONTROL_SAP_ENG_VERSION
 >= 0x0d)) {

3967 
u16
 
£q_num
;

3968 
u16
 
´iÜ™y
;

3970 
£q_num
 = 
	`çpi_g‘_low16_u32
(
skb
, 
u
.
mlme_»ûived_äame_šd
.
¥¬e_1
);

3971 
´iÜ™y
 = 
	`çpi_g‘_high16_u32
(
skb
, 
u
.
mlme_»ûived_äame_šd
.
¥¬e_1
);

3973 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_RX
, "mlme_received_frame_ind(vif:%d, dest:%pM, src:%pM,…riority:%d, s:%d)\n",

3974 
	`çpi_g‘_vif
(
skb
),

3975 
ehdr
->
h_de¡
,

3976 
ehdr
->
h_sourû
,

3977 
´iÜ™y
,

3978 
£q_num
);

3980 ià(
	`¦si_ba_check
(
³”
, 
´iÜ™y
)) {

3981 
	`¦si_ba_upd©e_wšdow
(
dev
, 
³”
->
ba_£ssiÚ_rx
[
´iÜ™y
], ((
£q_num
 + 1) & 0xFFF));

3985 
ba_check_dÚe
:

3987 
	`skb_puÎ
(
skb
, 
	`çpi_g‘_sigËn
(skb));

3989 
skb
->
dev
 = dev;

3990 
skb
->
_summed
 = 
CHECKSUM_NONE
;

3992 
ndev_vif
->
¡©s
.
rx_·ck‘s
++;

3993 
ndev_vif
->
¡©s
.
rx_by‹s
 +ğ
skb
->
Ën
;

3994 #ià(
LINUX_VERSION_CODE
 <ğ
	`KERNEL_VERSION
(4, 10, 0))

3995 
dev
->
Ï¡_rx
 = 
jiff›s
;

3998 #ifdeà
CONFIG_SCSC_WLAN_NW_PKT_DROP


3999 
is_—pŞ_dhı
 = 
	`¦si_rx_»ûived_äame_loggšg
(
dev
, 
skb
, 
log_¡r_bufãr
, (log_str_buffer));

4001 
	`¦si_rx_»ûived_äame_loggšg
(
dev
, 
skb
, 
log_¡r_bufãr
, (log_str_buffer));

4003 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4004 
	`SLSI_DBG2
(
sdev
, 
SLSI_MLME
, "·s %u by‹ u°ÕrÙo:%d)\n", 
skb
->
Ën
, 
	`Áohs
(skb->
´ÙocŞ
));

4005 
	`¦si_skb_cb_š™
(
skb
);

4006 
log_skb
 = 
	`skb_cİy
(
skb
, 
GFP_ATOMIC
);

4008 #ifdeà
CONFIG_SCSC_WLAN_NW_PKT_DROP


4009 ià(
is_—pŞ_dhı
) {

4013 
	`loÿl_bh_di§bË
();

4014 
	`by·ss_backlog
(
sdev
, 
dev
, 
skb
);

4015 
	`loÿl_bh_’abË
();

4019 
is_drİ³d
 = (
NET_RX_DROP
 =ğ
	`Ãtif_rx_ni
(
skb
));

4020 ià(
log_¡r_bufãr
[0])

4021 
	`SLSI_INFO
(
sdev
, "% %s\n", (
is_drİ³d
 ? "Drİ³d" : "Reûived"), 
log_¡r_bufãr
);

4022 ià(
log_skb
) {

4023 ià(
is_drİ³d
)

4024 
	`SLSI_INFO_HEX_NODEV
(
log_skb
->
d©a
,

4025 (
log_skb
->
Ën
 < 128 ?†og_skb->len : 128), "HEX Dump:\n");

4026 
	`kä“_skb
(
log_skb
);

4028 
	`¦si_wake_lock_timeout
(&
sdev
->
wÏn_wl_mlme
, 
	`m£cs_to_jiff›s
(
SLSI_WAKELOCK_TIME_MSEC_EAPOL
));

4031 
ex™
:

4032 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4033 
	`kä“_skb
(
skb
);

4034 
	}
}

4036 
	$¦si_rx_mic_çu»_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

4038 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4039 
u8
 *
mac_addr
;

4040 
u16
 
key_ty³
, 
key_id
;

4041 
Æ80211_key_ty³
 
Æ_key_ty³
;

4043 
	`SLSI_UNUSED_PARAMETER
(
sdev
);

4045 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4046 ià(!
ndev_vif
->
aùiv©ed
) {

4047 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

4048 
ex™
;

4051 
mac_addr
 = 
	`çpi_g‘_buff
(
skb
, 
u
.
mlme_discÚÃùed_šd
.
³”_¡a_add»ss
);

4052 
key_ty³
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_mic_çu»_šd
.key_type);

4053 
key_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_mic_çu»_šd
.key_id);

4055 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "mlme_mic_failure_ind(vif:%d, MAC:%pM, key_type:%d, key_id:%d)\n",

4056 
	`çpi_g‘_vif
(
skb
), 
mac_addr
, 
key_ty³
, 
key_id
);

4058 ià(
	`WARN_ON
(
key_ty³
 !ğ
FAPI_KEYTYPE_GROUP
 && key_ty³ !ğ
FAPI_KEYTYPE_PAIRWISE
))

4059 
ex™
;

4061 
Æ_key_ty³
 = (
key_ty³
 =ğ
FAPI_KEYTYPE_GROUP
è? 
NL80211_KEYTYPE_GROUP
 : 
NL80211_KEYTYPE_PAIRWISE
;

4063 
	`cfg80211_mich«l_mic_çu»
(
dev
, 
mac_addr
, 
Æ_key_ty³
, 
key_id
, 
NULL
, 
GFP_KERNEL
);

4065 
ex™
:

4066 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4067 
	`kä“_skb
(
skb
);

4068 
	}
}

4076 
	$¦si_rx_li¡’_’d_šd
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

4078 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4080 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4082 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_CFG80211
, "Inform completion of P2P Listen Offloading\n");

4083 ià(!
ndev_vif
->
aùiv©ed
) {

4084 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "VIF‚ot‡ctivated\n");

4085 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4086 
	`kä“_skb
(
skb
);

4090 
	`cfg80211_»maš_Ú_chªÃl_expœed
(&
ndev_vif
->
wdev
, 0xffff,‚dev_vif->
chª
, 
GFP_KERNEL
);

4092 
ndev_vif
->
unsync
.
li¡’_ofæßd
 = 
çl£
;

4094 
	`¦si_p2p_queue_unsync_vif_d–_wÜk
(
ndev_vif
, 
SLSI_P2P_UNSYNC_VIF_EXTRA_MSEC
);

4096 
	`SLSI_P2P_STATE_CHANGE
(
ndev_vif
->
sdev
, 
P2P_IDLE_VIF_ACTIVE
);

4098 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4099 
	`kä“_skb
(
skb
);

4100 
	}
}

4102 
	$¦si_rx_wa™_šd_m©ch
(
u16
 
»cv_id
, u16 
wa™_id
)

4104 ià(
»cv_id
 =ğ
wa™_id
)

4106 ià(
wa™_id
 =ğ
MLME_DISCONNECT_IND
 && 
»cv_id
 =ğ
MLME_DISCONNECTED_IND
)

4109 
	}
}

4111 
	$¦si_rx_blockšg_sigÇls
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

4113 
u16
 
pid
, 
id
;

4114 
¦si_sig_£nd
 *
sig_wa™
;

4115 
u16
 
vif
 = 
	`çpi_g‘_vif
(
skb
);

4117 
sig_wa™
 = &
sdev
->sig_wait;

4118 
id
 = 
	`çpi_g‘_sigid
(
skb
);

4119 
pid
 = 
	`çpi_g‘_u16
(
skb
, 
»ûiv”_pid
);

4122 ià(
	`çpi_is_cfm
(
skb
)) {

4123 
Ãt_deviû
 *
dev
;

4124 
Ãtdev_vif
 *
ndev_vif
;

4126 
	`rcu_»ad_lock
();

4127 ià(
vif
 =ğ
SLSI_NET_INDEX_DETECT
 &&

4128 (
id
 =ğ
MLME_ADD_VIF_CFM
 ||

4129 
id
 =ğ
MLME_START_DETECT_CFM
 ||

4130 
id
 =ğ
MLME_DEL_VIF_CFM
))

4131 
vif
 = 1;

4132 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

4133 ià(
dev
) {

4134 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4135 
sig_wa™
 = &
ndev_vif
->sig_wait;

4137 
	`¥š_lock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

4138 ià(
id
 =ğ
sig_wa™
->
cfm_id
 && 
pid
 =ğsig_wa™->
´oûss_id
) {

4139 ià(
	`WARN_ON
(
sig_wa™
->
cfm
))

4140 
	`kä“_skb
(
sig_wa™
->
cfm
);

4141 
sig_wa™
->
cfm
 = 
skb
;

4142 
	`¥š_uÆock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

4143 
	`com¶‘e
(&
sig_wa™
->
com¶‘iÚ
);

4144 
	`rcu_»ad_uÆock
();

4154 ià(
id
 !ğ
MLME_SEND_FRAME_CFM
)

4155 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "UÃx³ùed cfm(0x%.4x,…id:0x%.4x, vif:%d)\n", 
id
, 
pid
, 
vif
);

4156 
	`¥š_uÆock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

4157 
	`rcu_»ad_uÆock
();

4158  -
EINVAL
;

4161 ià(
	`çpi_is_šd
(
skb
)) {

4162 
Ãt_deviû
 *
dev
;

4163 
Ãtdev_vif
 *
ndev_vif
;

4165 
	`rcu_»ad_lock
();

4166 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

4167 ià(
dev
) {

4168 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4169 
sig_wa™
 = &
ndev_vif
->sig_wait;

4171 
	`¥š_lock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

4172 ià(
	`¦si_rx_wa™_šd_m©ch
(
id
, 
sig_wa™
->
šd_id
è&& 
pid
 =ğsig_wa™->
´oûss_id
) {

4173 ià(
	`WARN_ON
(
sig_wa™
->
šd
))

4174 
	`kä“_skb
(
sig_wa™
->
šd
);

4175 
sig_wa™
->
šd
 = 
skb
;

4176 
	`¥š_uÆock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

4177 
	`com¶‘e
(&
sig_wa™
->
com¶‘iÚ
);

4178 
	`rcu_»ad_uÆock
();

4181 
	`¥š_uÆock_bh
(&
sig_wa™
->
£nd_sigÇl_lock
);

4182 
	`rcu_»ad_uÆock
();

4184  -
EINVAL
;

4185 
	}
}

4187 #ifdeà
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL


4188 
	$¦si_rx_£nd_äame_cfm_async
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

4190 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

4191 
u16
 
ho¡_g
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_£nd_äame_cfm
.host_tag);

4192 
u16
 
»q_¡©us
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_£nd_äame_cfm
.
»suÉ_code
);

4194 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

4195 ià(
ho¡_g
 & 
SLSI_HOST_TAG_ARP_MASK
 && 
»q_¡©us
 !ğ
FAPI_RESULTCODE_SUCCESS
) {

4196 
	`©omic_dec
(&
sdev
->
¬p_tx_couÁ
);

4197 
	`©omic_dec
(&
ndev_vif
->
¬p_tx_couÁ
);

4198 ià(
	`©omic_»ad
(&
sdev
->
ù¾_·u£_¡©e
) &&

4199 
	`©omic_»ad
(&
sdev
->
¬p_tx_couÁ
è< (sdev->
fw_max_¬p_couÁ
 - 
SLSI_ARP_UNPAUSE_THRESHOLD
))

4200 
	`scsc_wifi_uÅau£_¬p_q_®l_vif
(
sdev
);

4201 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
,

4203 
	`çpi_g‘_vif
(
skb
), 
ho¡_g
, 
»q_¡©us
);

4205 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

4206 
	`kä“
(
skb
);

4207 
	}
}

	@sap.h

7 #iâdeà
__SAP_H__


8 
	#__SAP_H__


	)

11 
	#SAP_TOTAL
 4

	)

13 
	#SAP_MLME
 0

	)

14 
	#SAP_MA
 1

	)

15 
	#SAP_DBG
 2

	)

16 
	#SAP_TST
 3

	)

19 
	#SAP_MAX_VER
 2

	)

21 
	#SAP_MAJOR
(
v”siÚ
è((v”siÚ & 0xff00è>> 8)

	)

22 
	#SAP_MINOR
(
v”siÚ
è(v”siÚ & 0xff)

	)

24 
	#SAP_DRV_SIGNAL_BASE
 0xA000

	)

25 
	#SAP_DRV_MA_TO_MLME_DELBA_REQ
 (
SAP_DRV_SIGNAL_BASE
 + 1)

	)

27 
	s§p_drv_ma_to_mlme_d–ba_»q
 {

28 
çpi_sigÇl_h—d”
 
	mh—d”
;

29 
__Ë16
 
	mvif
;

30 
u8
 
	m³”_q¡a_add»ss
[
ETH_ALEN
];

31 
__Ë16
 
	m£qu’û_numb”
;

32 
__Ë16
 
	mu£r_´iÜ™y
;

33 
__Ë16
 
	m»asÚ
;

34 
__Ë16
 
	mdœeùiÚ
;

35 } 
__©Œibu‹__
((
·cked
));

37 
	g¦si_dev
;

38 
	gsk_buff
;

40 
	s§p_­i
 {

41 
u8
 
	m§p_şass
;

42 
u16
 
	m§p_v”siÚs
[
SAP_MAX_VER
];

43 (*
	m§p_v”siÚ_suµÜ‹d
)(
u16
 
	mv”siÚ
);

44 (*
	m§p_hªdËr
)(
¦si_dev
 *
	msdev
, 
sk_buff
 *
	mskb
);

45 (*
	m§p_txdÚe
)(
¦si_dev
 *
	msdev
, 
u8
 
	mvif
, u8 
	m³”_šdex
, u8 
	mac
);

46 (*
	m§p_nÙif›r
)(
¦si_dev
 *
	msdev
, 
	mev’t
);

	@sap_dbg.c

6 
	~<lšux/ty³s.h
>

7 
	~"debug.h
"

8 
	~"dev.h
"

9 
	~"§p.h
"

10 
	~"§p_dbg.h
"

11 
	~"h.h
"

13 
	#SUPPORTED_OLD_VERSION
 0

	)

15 
§p_dbg_v”siÚ_suµÜ‹d
(
u16
 
v”siÚ
);

16 
§p_dbg_rx_hªdËr
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
);

18 
§p_­i
 
	g§p_dbg
 = {

19 .
§p_şass
 = 
SAP_DBG
,

20 .
	g§p_v”siÚ_suµÜ‹d
 = 
§p_dbg_v”siÚ_suµÜ‹d
,

21 .
	g§p_hªdËr
 = 
§p_dbg_rx_hªdËr
,

22 .
	g§p_v”siÚs
 = { 
FAPI_DEBUG_SAP_VERSION
, 
SUPPORTED_OLD_VERSION
 },

25 
	$§p_dbg_v”siÚ_suµÜ‹d
(
u16
 
v”siÚ
)

27 
majÜ
 = 
	`SAP_MAJOR
(
v”siÚ
);

28 
mšÜ
 = 
	`SAP_MINOR
(
v”siÚ
);

29 
u8
 
i
 = 0;

31 
	`SLSI_INFO_NODEV
("R•Ü‹d v”siÚ: %d.%d\n", 
majÜ
, 
mšÜ
);

33 
i
 = 0; i < 
SAP_MAX_VER
; i++)

34 ià(
	`SAP_MAJOR
(
§p_dbg
.
§p_v”siÚs
[
i
]è=ğ
majÜ
)

37 
	`SLSI_ERR_NODEV
("V”siÚ %d.%d NÙ suµÜ‹d\n", 
majÜ
, 
mšÜ
);

39  -
EINVAL
;

40 
	}
}

42 
	$¦si_rx_debug
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

44 
u16
 
id
 = 
	`çpi_g‘_u16
(
skb
, id);

46 
	`SLSI_UNUSED_PARAMETER
(
dev
);

48 
id
) {

49 
DEBUG_FAULT_IND
:

50 
	`SLSI_WARN
(
sdev
, "WF_FW_INFO: |cpu %s|id 0x%04X|arg 0x%08X|count %d|timestamp %10u|\n",

51 ((
	`çpi_g‘_u16
(
skb
, 
u
.
debug_çuÉ_šd
.
ıu
) == 0x8000) ? "MAC" :

52 (
	`çpi_g‘_u16
(
skb
, 
u
.
debug_çuÉ_šd
.
ıu
) == 0x4000) ? "PHY" : "???"),

53 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_çuÉ_šd
.
çuÉid
),

54 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_çuÉ_šd
.
¬g
),

55 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_çuÉ_šd
.
couÁ
),

56 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_çuÉ_šd
.
time¡amp
));

58 
DEBUG_WORD12IND
:

59 
	`©omic_šc
(&
sdev
->
debug_šds
);

60 
	`SLSI_DBG4
(
sdev
, 
SLSI_FW_TEST
, "FW DEBUG(id:%d, subid:%d, vif:%d,ime:%u) %04X %04X %04X %04X %04X %04X %04X %04X %04X %04X %04X %04X\n",

61 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
moduË_id
),

62 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
moduË_sub_id
),

63 
	`çpi_g‘_vif
(
skb
),

64 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_wÜd12_šd
.
time¡amp
),

65 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[0]),

66 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[1]),

67 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[2]),

68 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[3]),

69 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[4]),

70 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[5]),

71 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[6]),

72 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[7]),

73 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[8]),

74 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[9]),

75 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[10]),

76 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_wÜd12_šd
.
debug_wÜds
[11]));

79 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
, "UnhªdËd Debug Ind: 0x%.4x\n", 
id
);

82 
	`kä“_skb
(
skb
);

83 
	}
}

85 
	$¦si_rx_dbg_§p
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

87 
u16
 
id
 = 
	`çpi_g‘_u16
(
skb
, id);

88 
u16
 
vif
 = 
	`çpi_g‘_vif
(
skb
);

89 
Ãt_deviû
 *
dev
;

91 
id
) {

92 
DEBUG_FAULT_IND
:

93 
DEBUG_WORD12IND
:

94 
DEBUG_GENERIC_IND
:

95 
	`¦si_rx_debug
(
sdev
, 
NULL
, 
skb
);

97 
DEBUG_PKT_SINK_REPORT_IND
:

99 
	`rcu_»ad_lock
();

100 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

101 ià(!
dev
) {

102 
	`rcu_»ad_uÆock
();

103 
	`kä“_skb
(
skb
);

106 
	`¦si_rx_sšk_»pÜt
(
sdev
, 
dev
, 
skb
);

107 
	`rcu_»ad_uÆock
();

110 
DEBUG_PKT_GEN_REPORT_IND
:

112 
	`rcu_»ad_lock
();

113 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

114 ià(!
dev
) {

115 
	`rcu_»ad_uÆock
();

116 
	`kä“_skb
(
skb
);

119 
	`¦si_rx_g’_»pÜt
(
sdev
, 
dev
, 
skb
);

120 
	`rcu_»ad_uÆock
();

124 
	`kä“_skb
(
skb
);

125 
	`SLSI_ERR
(
sdev
, "UnhªdËd Ind: 0x%.4x\n", 
id
);

130 
	}
}

132 
	$¦si_rx_dbg_§p_wÜk
(
wÜk_¡ruù
 *
wÜk
)

134 
¦si_skb_wÜk
 *
w
 = 
	`cÚš”_of
(
wÜk
, slsi_skb_work, work);

135 
¦si_dev
 *
sdev
 = 
w
->sdev;

136 
sk_buff
 *
skb
 = 
	`¦si_skb_wÜk_dequeue
(
w
);

138 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

139 
skb
) {

140 
	`¦si_debug_äame
(
sdev
, 
NULL
, 
skb
, "RX");

141 
	`¦si_rx_dbg_§p
(
sdev
, 
skb
);

142 
skb
 = 
	`¦si_skb_wÜk_dequeue
(
w
);

144 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

145 
	}
}

147 
	$§p_dbg_rx_hªdËr
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

152 ià(
	`¦si_rx_blockšg_sigÇls
(
sdev
, 
skb
) == 0)

155 
	`¦si_skb_wÜk_’queue
(&
sdev
->
rx_dbg_§p
, 
skb
);

157 
	}
}

159 
	$§p_dbg_š™
()

161 
	`SLSI_INFO_NODEV
("Registering SAP\n");

163 
	`¦si_h_§p_»gi¡”
(&
§p_dbg
);

166 
	}
}

168 
	$§p_dbg_deš™
()

170 
	`SLSI_INFO_NODEV
("Unregistering SAP\n");

171 
	`¦si_h_§p_uÄegi¡”
(&
§p_dbg
);

173 
	}
}

	@sap_dbg.h

8 #iâdeà
__SAP_DBG_H__


9 
	#__SAP_DBG_H__


	)

11 
§p_dbg_š™
();

12 
§p_dbg_deš™
();

	@sap_ma.c

6 
	~<lšux/ty³s.h
>

7 
	~"debug.h
"

8 
	~"dev.h
"

9 
	~"§p.h
"

10 
	~"§p_ma.h
"

11 
	~"h.h
"

12 
	~"ba.h
"

13 
	~"mgt.h
"

14 
	~"Æ80211_v’dÜ.h
"

15 
	~"h4_§m¶”.h
"

16 
	~"Œaffic_mÚ™Ü.h
"

18 #ià
IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

19 
	~<scsc/scsc_log_cŞËùÜ.h
>

22 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


23 
	~"scsc_wifogg”_ršgs.h
"

26 
	#SUPPORTED_OLD_VERSION
 0

	)

28 
§p_ma_v”siÚ_suµÜ‹d
(
u16
 
v”siÚ
);

29 
§p_ma_rx_hªdËr
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
);

30 
§p_ma_txdÚe
(
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
, u8 
ac
);

31 
§p_ma_nÙif›r
(
¦si_dev
 *
sdev
, 
ev’t
);

33 
§p_­i
 
	g§p_ma
 = {

34 .
§p_şass
 = 
SAP_MA
,

35 .
	g§p_v”siÚ_suµÜ‹d
 = 
§p_ma_v”siÚ_suµÜ‹d
,

36 .
	g§p_hªdËr
 = 
§p_ma_rx_hªdËr
,

37 .
	g§p_v”siÚs
 = { 
FAPI_DATA_SAP_VERSION
, 
SUPPORTED_OLD_VERSION
 },

38 .
	g§p_txdÚe
 = 
§p_ma_txdÚe
,

39 .
	g§p_nÙif›r
 = 
§p_ma_nÙif›r
,

42 
	$§p_ma_nÙif›r
(
¦si_dev
 *
sdev
, 
ev’t
)

44 
ušt
 
vif
;

46 
	`SLSI_INFO_NODEV
("NÙif›¸ev’ˆ»ûived: %lu\n", 
ev’t
);

47 ià(
ev’t
 >ğ
SCSC_MAX_NOTIFIER
)

48  -
EIO
;

50 
ev’t
) {

51 
SCSC_WIFI_STOP
:

52 
	`SLSI_INFO_NODEV
("Stop‚etdev queues\n");

53 
	`rcu_»ad_lock
();

54 
vif
 = 
SLSI_NET_INDEX_WLAN
;

55 
vif
 <ğ
SLSI_NET_INDEX_P2PX_SWLAN
; vif++) {

56 
Ãt_deviû
 *
ndev
 =

57 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

58 ià(
ndev
 && !
	`Ãtif_queue_¡İ³d
(ndev))

59 
	`Ãtif_tx_¡İ_®l_queues
(
ndev
);

61 
	`rcu_»ad_uÆock
();

64 
SCSC_WIFI_FAILURE_RESET
:

65 
	`SLSI_DBG1_NODEV
(
SLSI_NETDEV
, "Netdevs queues will‚ot be„estarted -„ecovery willake care of it\n");

68 
SCSC_WIFI_SUSPEND
:

71 
SCSC_WIFI_RESUME
:

73 
SCSC_WIFI_CHIP_READY
:

75 
SCSC_WIFI_SUBSYSTEM_RESET
:

78 
	`SLSI_INFO_NODEV
("UnknowÀev’ˆcod%lu\n", 
ev’t
);

83 
	}
}

85 
	$§p_ma_v”siÚ_suµÜ‹d
(
u16
 
v”siÚ
)

87 
majÜ
 = 
	`SAP_MAJOR
(
v”siÚ
);

88 
mšÜ
 = 
	`SAP_MINOR
(
v”siÚ
);

89 
u8
 
i
 = 0;

91 
	`SLSI_INFO_NODEV
("R•Ü‹d v”siÚ: %d.%d\n", 
majÜ
, 
mšÜ
);

93 
i
 = 0; i < 
SAP_MAX_VER
; i++)

94 ià(
	`SAP_MAJOR
(
§p_ma
.
§p_v”siÚs
[
i
]è=ğ
majÜ
)

97 
	`SLSI_ERR_NODEV
("V”siÚ %d.%d NÙ suµÜ‹d\n", 
majÜ
, 
mšÜ
);

99  -
EINVAL
;

100 
	}
}

102 
boŞ
 
	$¦si_rx_check_mc_addr_»gd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
‘hhdr
 *
ehdr
)

104 
i
;

105 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

107 
	`¦si_¥šlock_lock
(&
ndev_vif
->
¡a
.
»gd_mc_addr_lock
);

109 
i
 = 0 ; i < 
ndev_vif
->
¡a
.
»gd_mc_addr_couÁ
; i++)

110 ià(
	`memcmp
(
ehdr
->
h_de¡
, 
ndev_vif
->
¡a
.
»gd_mc_addr
[
i
], 
ETH_ALEN
) == 0) {

111 
	`SLSI_INFO
(
sdev
, "Wakeu°by„egd møadd¸" 
MACSTR
 "\n", 
	`MAC2STR
(
ndev_vif
->
¡a
.
»gd_mc_addr
[
i
]));

112 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
¡a
.
»gd_mc_addr_lock
);

113  
Œue
;

116 
	`SLSI_ERR
(
sdev
, "Wakeup by unregistered mc‡ddress\n");

117 
	`SLSI_INFO
(
sdev
, "Reûived…ack‘ sourû : " 
MACSTR
 ", de¡ : " MACSTR "\n", 
	`MAC2STR
(
ehdr
->
h_sourû
), MAC2STRÓhdr->
h_de¡
));

118 
	`SLSI_INFO
(
sdev
, "Regd mc‡ddr : \n");

119 
i
 = 0 ; i < 
ndev_vif
->
¡a
.
»gd_mc_addr_couÁ
; i++)

120 
	`SLSI_INFO
(
sdev
, " " 
MACSTR
 "\n", 
	`MAC2STR
(
ndev_vif
->
¡a
.
»gd_mc_addr
[
i
]));

122 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
¡a
.
»gd_mc_addr_lock
);

123  
çl£
;

124 
	}
}

126 
	$¦si_rx_amsdu_d—gg»g©e
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
sk_buff_h—d
 *
msdu_li¡
)

128 
d©a_Ën
 = 0;

129 
subäame_Ën
 = 0;

130 
·ddšg
 = 0;

131 
sk_buff
 *
subäame
 = 
NULL
;

132 cÚ¡ 
mac_0
[
ETH_ALEN
] = { 0 };

133 
‘hhdr
 *
mh
 = 
NULL
;

134 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

138 
	`DEFINE_RATELIMIT_STATE
(
_rs
, 30*
HZ
, 1);

141 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX
, "A-MSDU„eûived (Ën:%d)\n", 
skb
->
Ën
);

142 
skb
->
Ën
) {

155 ià(
	`uÆik–y
((
ETH_ALEN
 * 2 + 2è> 
skb
->
Ën
)) {

156 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

157 ià(
	`__¿‹lim™
(&
_rs
))

158 
	`scsc_log_cŞËùÜ_scheduË_cŞËùiÚ
(
SCSC_LOG_HOST_WLAN
, 
SCSC_LOG_HOST_WLAN_REASON_INVALID_AMSDU
);

160 
	`SLSI_NET_ERR
(
dev
, "šv®id SKB†’gth %d < %d\n", 
skb
->
Ën
, (
ETH_ALEN
 * 2 + 2));

161 
	`__skb_queue_purge
(
msdu_li¡
);

162 
	`kä“_skb
(
skb
);

163  -
EINVAL
;

166 
d©a_Ën
 = (
skb
->
d©a
[
ETH_ALEN
 * 2] << 8) | skb->data[(ETH_ALEN * 2) + 1];

167 ià(
	`uÆik–y
(
d©a_Ën
 <ğ
LLC_SNAP_HDR_LEN
)) {

168 
	`SLSI_NET_ERR
(
dev
, "šv®id d©¨Ëngth %d < %d\n", 
d©a_Ën
, 
LLC_SNAP_HDR_LEN
);

169 
	`__skb_queue_purge
(
msdu_li¡
);

170 
	`kä“_skb
(
skb
);

171  -
EINVAL
;

173 
d©a_Ën
 -ğ
LLC_SNAP_HDR_LEN
;

181 ià(
	`uÆik–y
(
ETH_ALEN
 * 2 + 2 + 
LLC_SNAP_HDR_LEN
 + 
d©a_Ën
 > 
skb
->
Ën
)) {

182 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

183 ià(
	`__¿‹lim™
(&
_rs
))

184 
	`scsc_log_cŞËùÜ_scheduË_cŞËùiÚ
(
SCSC_LOG_HOST_WLAN
, 
SCSC_LOG_HOST_WLAN_REASON_INVALID_AMSDU
);

186 
	`SLSI_NET_ERR
(
dev
, "šv®id MSDU d©¨Ëngth %d, SKB†’gth = %d\n", 
d©a_Ën
, 
skb
->
Ën
);

187 
	`__skb_queue_purge
(
msdu_li¡
);

188 
	`kä“_skb
(
skb
);

189  -
EINVAL
;

199 
subäame_Ën
 = (
‘hhdr
è+ 
d©a_Ën
;

202 ià(
skb
->
Ën
 =ğ
subäame_Ën
 + 
LLC_SNAP_HDR_LEN
) {

204 
	`SLSI_ETHER_COPY
(&
skb
->
d©a
[14], &skb->data[6]);

205 
	`SLSI_ETHER_COPY
(&
skb
->
d©a
[8], &skb->data[0]);

207 
	`skb_puÎ
(
skb
, 
LLC_SNAP_HDR_LEN
);

209 
	`skb_£t_mac_h—d”
(
skb
, 0);

210 
mh
 = 
	`‘h_hdr
(
skb
);

211 ià(
	`SLSI_ETHER_EQUAL
(
mh
->
h_de¡
, 
mac_0
)) {

212 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX
, "msdu subäamf‹»d out: MAC de¡š©iÚ‡dd»s %pM\n", 
mh
->
h_de¡
);

213 
	`kä“_skb
(
skb
);

215 
	`__skb_queue_
(
msdu_li¡
, 
skb
);

222 
subäame
 = 
	`®loc_skb
(
subäame_Ën
, 
GFP_ATOMIC
);

223 ià(
	`uÆik–y
(!
subäame
)) {

224 
	`SLSI_NET_ERR
(
dev
, "failedo‡lloche SKB for A-MSDU subframe\n");

225 
	`__skb_queue_purge
(
msdu_li¡
);

226 
	`kä“_skb
(
skb
);

227  -
ENOMEM
;

243 
	`skb_put_d©a
(
subäame
, 
skb
->
d©a
, 
ETH_ALEN
 * 2);

244 
	`skb_puÎ
(
skb
, 
ETH_ALEN
 * 2);

253 
	`skb_puÎ
(
skb
, 8);

268 
	`skb_put_d©a
(
subäame
, 
skb
->
d©a
, 2);

269 
	`skb_puÎ
(
skb
, 2);

284 
	`skb_put_d©a
(
subäame
, 
skb
->
d©a
, 
d©a_Ën
);

285 
	`skb_puÎ
(
skb
, 
d©a_Ën
);

295 
·ddšg
 = (
skb
->
Ën
 ? (4 - (
subäame_Ën
 % 4)) & 0x3 : 0);

296 ià(
	`uÆik–y
(!
	`skb_puÎ
(
skb
, 
·ddšg
))) {

297 #ià
	`IS_ENABLED
(
CONFIG_SCSC_LOG_COLLECTION
)

298 ià(
	`__¿‹lim™
(&
_rs
))

299 
	`scsc_log_cŞËùÜ_scheduË_cŞËùiÚ
(
SCSC_LOG_HOST_WLAN
, 
SCSC_LOG_HOST_WLAN_REASON_INVALID_AMSDU
);

301 
	`kä“_skb
(
subäame
);

302 
	`SLSI_NET_ERR
(
dev
, "Invalid A-MSDU Padding\n");

303 
	`__skb_queue_purge
(
msdu_li¡
);

304 
	`kä“_skb
(
skb
);

305  -
EINVAL
;

310 
	`skb_£t_mac_h—d”
(
subäame
, 0);

311 
mh
 = 
	`‘h_hdr
(
subäame
);

312 ià(
	`uÆik–y
(
	`SLSI_ETHER_EQUAL
(
mh
->
h_de¡
, 
mac_0
))) {

313 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_RX
, "msdu subäamf‹»d out: MAC de¡š©iÚ‡dd»s %pM\n", 
mh
->
h_de¡
);

314 
	`kä“_skb
(
subäame
);

317 
	`__skb_queue_
(
msdu_li¡
, 
subäame
);

320 
	}
}

322 
šlše
 
boŞ
 
	$¦si_rx_is_amsdu
(
sk_buff
 *
skb
)

324  (
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
d©a_un™_desütÜ
è=ğ
FAPI_DATAUNITDESCRIPTOR_AMSDU
);

325 
	}
}

327 
	$¦si_rx_check_İt_out_·ck‘
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

329 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

330 
‘hhdr
 *
ehdr
 = (‘hhd¸*)(
skb
->
d©a
);

332 
ndev_vif
->
is_İt_out_·ck‘
 = 
çl£
;

334 ià(
	`is_brßdÿ¡_‘h”_addr
(
ehdr
->
h_de¡
)) {

335 
ndev_vif
->
is_İt_out_·ck‘
 = 
Œue
;

336 
	`SLSI_NET_ERR
(
dev
, "Wakeup by Broadcast…acket\n");

337 } ià(
	`is_muÉiÿ¡_‘h”_addr
(
ehdr
->
h_de¡
)) {

338 
ndev_vif
->
is_İt_out_·ck‘
 = !
	`¦si_rx_check_mc_addr_»gd
(
sdev
, 
dev
, 
ehdr
);

339 } ià(
	`be16_to_ıu
(
ehdr
->
h_´Ùo
è=ğ
ETH_P_ARP
) {

340 
u8
 *
äame
;

341 
u16
 
¬p_İcode
;

343 
äame
 = 
skb
->
d©a
 + (
‘hhdr
);

344 
¬p_İcode
 = 
äame
[
SLSI_ARP_OPCODE_OFFSET
] << 8 | frame[SLSI_ARP_OPCODE_OFFSET + 1];

350 ià(
¬p_İcode
 =ğ
SLSI_ARP_REQUEST_OPCODE
)

351 
ndev_vif
->
is_İt_out_·ck‘
 = 
Œue
;

352 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


354 
ndev_vif
->
is_İt_out_·ck‘
 = 
sdev
->
’hªûd_pkt_f‹r_’abËd
;

356 
	`SLSI_NET_ERR
(
dev
, "Wakeu°by ARP…ack‘,‡½_İcod: %d\n", 
¬p_İcode
);

357 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_PKT_FILTER


358 } ià(
sdev
->
’hªûd_pkt_f‹r_’abËd
) {

359 ià(
	`is_uniÿ¡_‘h”_addr
(
ehdr
->
h_de¡
)) {

361 ià(
	`be16_to_ıu
(
ehdr
->
h_´Ùo
è=ğ
ETH_P_IP
) {

362 
hdr
 *

 = (hd¸*)(
skb
->
d©a
 + (
‘hhdr
));

364 
ndev_vif
->
is_İt_out_·ck‘
 = !(

->
´ÙocŞ
 =ğ
IPPROTO_TCP
);

365 
	`SLSI_NET_INFO
(
dev
, "Wakeu°by IPV4 , ip->´ÙocŞ = %d\n", 

->
´ÙocŞ
);

366 } ià(
	`be16_to_ıu
(
ehdr
->
h_´Ùo
è=ğ
ETH_P_IPV6
) {

367 
v6hdr
 *

 = (v6hd¸*)(
skb
->
d©a
 + (
‘hhdr
));

369 
ndev_vif
->
is_İt_out_·ck‘
 = !(

->
Ãxthdr
 =ğ
IPPROTO_TCP
);

370 
	`SLSI_NET_INFO
(
dev
, "Wakeu°by IPV6 , ip->Ãxthd¸ğ%d\n", 

->
Ãxthdr
);

372 
ndev_vif
->
is_İt_out_·ck‘
 = 
Œue
;

373 
	`SLSI_NET_ERR
(
dev
, "Wakeu°by h_´ÙØ: 0x%.4X\n", 
	`be16_to_ıu
(
ehdr
->
h_´Ùo
));

376 
	`SLSI_NET_ERR
(
dev
, "Wakeup by Not Unicast -he…acket must be checking in Multicast condition\n");

380 
	`SLSI_NET_INFO
(
dev
, "Wakeup by Opt in…acket\n");

382 
	}
}

384 
	$¦si_rx_d©a_d–iv”_skb
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
, 
boŞ
 
ùx_Çpi
)

386 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

387 
sk_buff_h—d
 
msdu_li¡
;

388 
¦si_³”
 *
³”
 = 
NULL
;

389 
‘hhdr
 *
‘h_hdr
;

390 
boŞ
 
is_amsdu
 = 
	`¦si_rx_is_amsdu
(
skb
);

391 
u8
 
Œafic_q
 = 
	`¦si_äame_´iÜ™y_to_ac_queue
(
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
´iÜ™y
));

393 
	`__skb_queue_h—d_š™
(&
msdu_li¡
);

395 #ifdeà
CONFIG_SCSC_SMAPPER


397 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
bulk_d©a_desütÜ
è=ğ
FAPI_BULKDATADESCRIPTOR_SMAPPER
) {

399 
skb
 = 
	`¦si_h_g‘_skb_äom_sm­³r
(
sdev
, skb);

400 ià(!
skb
) {

401 
	`SLSI_NET_WARN
(
dev
, "SKB from SMAPPER is NULL\n");

406 
	`skb_puÎ
(
skb
, 
	`çpi_g‘_sigËn
(skb));

409 
	`skb_puÎ
(
skb
, 
	`çpi_g‘_sigËn
(skb));

412 
‘h_hdr
 = (
‘hhdr
 *)
skb
->
d©a
;

413 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
‘h_hdr
->
h_sourû
);

414 ià(!
³”
) {

415 
	`SLSI_NET_WARN
(
dev
, "Packet dropped (no…eer„ecords)\n");

416 
	`kä“_skb
(
skb
);

421 ià(
is_amsdu
) {

422 ià(
	`¦si_rx_amsdu_d—gg»g©e
(
dev
, 
skb
, &
msdu_li¡
)) {

423 
	`SLSI_NET_WARN
(
dev
, "Packet dropped (A-MSDUƒrror)\n");

424 
ndev_vif
->
¡©s
.
rx_drİ³d
++;

425 ià(
³”
)

426 
³”
->
sšfo
.
rx_drİ³d_misc
++;

430 
	`__skb_queue_
(&
msdu_li¡
, 
skb
);

433 !
	`skb_queue_em±y
(&
msdu_li¡
)) {

434 
sk_buff
 *
rx_skb
;

435 #ià
	`defšed
(
CONFIG_SCSC_WLAN_RX_NAPI
è&& defšed(
CONFIG_SCSC_WLAN_RX_NAPI_GRO
)

436 
u16
 
drİ_´Ùo
;

439 
rx_skb
 = 
	`__skb_dequeue
(&
msdu_li¡
);

445 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
) {

446 
‘hhdr
 *
ehdr
 = (‘hhd¸*)(
rx_skb
->
d©a
);

448 ià(
	`uÆik–y
(
	`¦si_skb_cb_g‘
(
rx_skb
)->
wakeup
)) {

449 
	`¦si_rx_check_İt_out_·ck‘
(
sdev
, 
dev
, 
rx_skb
);

450 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

451 
	`scheduË_wÜk
(&
ndev_vif
->
upd©e_pkt_f‹r_wÜk
);

464 ià(
	`is_muÉiÿ¡_‘h”_addr
(
ehdr
->
h_de¡
è&& !
	`com·»_‘h”_addr
Óhdr->
h_sourû
, 
dev
->
dev_addr
)) {

465 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_RX
, "drop†ocally generated multicast frame„elayed back by AP\n");

466 
	`cÚsume_skb
(
rx_skb
);

472 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 &&‚dev_vif->
³”_¡a_»cÜds
) {

473 
¦si_³”
 *
³”
 = 
NULL
;

474 
‘hhdr
 *
ehdr
 = (‘hhd¸*)(
rx_skb
->
d©a
);

476 ià(
	`is_muÉiÿ¡_‘h”_addr
(
ehdr
->
h_de¡
)) {

478 
sk_buff
 *
»brßdÿ¡_skb
 = 
	`skb_cİy
(
rx_skb
, 
GFP_ATOMIC
);

479 ià(!
»brßdÿ¡_skb
) {

480 
	`SLSI_WARN
(
sdev
, "Intra BSS: failedo‡lloc‚ew SKB for broadcast\n");

482 
	`SLSI_DBG3
(
sdev
, 
SLSI_RX
, "IÁ¿ BSS: muÉiÿ¡ %pM\n", 
ehdr
->
h_de¡
);

483 
»brßdÿ¡_skb
->
dev
 = dev;

484 
»brßdÿ¡_skb
->
´ÙocŞ
 = 
	`ıu_to_be16
(
ETH_P_802_3
);

485 
	`skb_»£t_ÃtwÜk_h—d”
(
»brßdÿ¡_skb
);

486 
	`skb_»£t_mac_h—d”
(
»brßdÿ¡_skb
);

487 
	`dev_queue_xm™
(
»brßdÿ¡_skb
);

490 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
ehdr
->
h_de¡
);

491 ià(
³”
 &&…“r->
authÜized
) {

492 
	`SLSI_DBG3
(
sdev
, 
SLSI_RX
, "IÁ¿ BSS: uniÿ¡ %pM\n", 
ehdr
->
h_de¡
);

493 
rx_skb
->
dev
 = dev;

494 
rx_skb
->
´ÙocŞ
 = 
	`ıu_to_be16
(
ETH_P_802_3
);

495 
	`skb_»£t_ÃtwÜk_h—d”
(
rx_skb
);

496 
	`skb_»£t_mac_h—d”
(
rx_skb
);

497 
	`dev_queue_xm™
(
rx_skb
);

503 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


505 ià(
ndev_vif
->
iâum
 >ğ
SLSI_NAN_DATA_IFINDEX_START
) {

506 
Ãt_deviû
 *
Ùh”_dev
;

507 
Ãtdev_vif
 *
Ùh”_ndev_vif
;

508 
‘hhdr
 *
ehdr
 = (‘hhd¸*)(
rx_skb
->
d©a
);

509 
u8
 
i
, 
j
;

511 ià(
	`is_muÉiÿ¡_‘h”_addr
(
ehdr
->
h_de¡
)) {

521 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_RX
, "NAN: muÉiÿ¡ (sourû‡dd»ss: %pM)\n", 
ehdr
->
h_sourû
);

522 (
i
 = 
ndev_vif
->
iâum
 + 1); i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

523 
Ùh”_dev
 = (
Ãt_deviû
 *è
sdev
->
Ãtdev
[
i
];

524 ià(!
Ùh”_dev
)

526 
Ùh”_ndev_vif
 = (
Ãtdev_vif
 *)
	`Ãtdev_´iv
(
Ùh”_dev
);

527 ià(!
Ùh”_ndev_vif
)

529 
j
 = 0; j < 
SLSI_PEER_INDEX_MAX
; j++) {

530 ià(
Ùh”_ndev_vif
->
³”_¡a_»cÜd
[
j
] &&

531 
Ùh”_ndev_vif
->
³”_¡a_»cÜd
[
j
]->
v®id
 &&

532 
	`‘h”_addr_equ®
(
Ùh”_ndev_vif
->
³”_¡a_»cÜd
[
j
]->
add»ss
, 
ehdr
->
h_sourû
)) {

534 
sk_buff
 *
du¶iÿ‹_skb
 = 
	`skb_cİy
(
rx_skb
, 
GFP_ATOMIC
);

535 
	`SLSI_NET_DBG2
(
Ùh”_dev
, 
SLSI_RX
, "NAN: sourû‡dd»s m©ch %pM\n", 
Ùh”_ndev_vif
->
³”_¡a_»cÜd
[
j
]->
add»ss
);

536 ià(!
du¶iÿ‹_skb
) {

537 
	`SLSI_NET_WARN
(
Ùh”_dev
, "NAN: multicast: failedo‡lloc‚ew SKB\n");

541 
Ùh”_ndev_vif
->
³”_¡a_»cÜd
[
j
]->
sšfo
.
rx_by‹s
 +ğ
du¶iÿ‹_skb
->
Ën
;

542 
Ùh”_ndev_vif
->
¡©s
.
rx_·ck‘s
++;

543 
Ùh”_ndev_vif
->
¡©s
.
rx_by‹s
 +ğ
du¶iÿ‹_skb
->
Ën
;

544 
Ùh”_ndev_vif
->
rx_·ck‘s
[
Œafic_q
]++;

546 
du¶iÿ‹_skb
->
dev
 = 
Ùh”_dev
;

547 
du¶iÿ‹_skb
->
_summed
 = 
CHECKSUM_NONE
;

548 
du¶iÿ‹_skb
->
´ÙocŞ
 = 
	`‘h_ty³_Œªs
(du¶iÿ‹_skb, 
Ùh”_dev
);

550 
	`SLSI_NET_DBG4
(
Ùh”_dev
, 
SLSI_RX
, "·s %u by‹ tØloÿÈ¡ack\n", 
du¶iÿ‹_skb
->
Ën
);

551 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


552 
	`Ãtif_»ûive_skb
(
du¶iÿ‹_skb
);

554 
	`Ãtif_rx_ni
(
du¶iÿ‹_skb
);

562 ià(
³”
) {

563 
³”
->
sšfo
.
rx_by‹s
 +ğ
rx_skb
->
Ën
;

565 
ndev_vif
->
¡©s
.
rx_·ck‘s
++;

566 
ndev_vif
->
¡©s
.
rx_by‹s
 +ğ
rx_skb
->
Ën
;

567 
ndev_vif
->
rx_·ck‘s
[
Œafic_q
]++;

569 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


570 ià(!
ndev_vif
->
’hªûd_¬p_¡©s
.
is_du¶iÿ‹_addr_d‘eùed
) {

571 
u8
 *
äame
 = 
rx_skb
->
d©a
 + 12;

572 
u16
 
·ck‘_ty³
 = 
äame
[0] << 8 | frame[1];

574 ià(
·ck‘_ty³
 =ğ
ETH_P_ARP
) {

575 
äame
 = frame + 2;

577 ià((
äame
[
SLSI_ARP_SRC_IP_ADDR_OFFSET
] =ğ(
ndev_vif
->
add»ss
 & 255)) &&

578 (
äame
[
SLSI_ARP_SRC_IP_ADDR_OFFSET
 + 1] =ğ((
ndev_vif
->
add»ss
 >> 8U) & 255)) &&

579 (
äame
[
SLSI_ARP_SRC_IP_ADDR_OFFSET
 + 2] =ğ((
ndev_vif
->
add»ss
 >> 16U) & 255)) &&

580 (
äame
[
SLSI_ARP_SRC_IP_ADDR_OFFSET
 + 3] =ğ((
ndev_vif
->
add»ss
 >> 24U) & 255)) &&

581 !
	`SLSI_IS_GRATUITOUS_ARP
(
äame
) &&

582 !
	`SLSI_ETHER_EQUAL
(
dev
->
dev_addr
, 
äame
 + 8))

583 
ndev_vif
->
’hªûd_¬p_¡©s
.
is_du¶iÿ‹_addr_d‘eùed
 = 1;

587 ià(
ndev_vif
->
’hªûd_¬p_d‘eù_’abËd
 && (ndev_vif->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
)) {

588 
u8
 *
äame
 = 
rx_skb
->
d©a
 + 12;

589 
u16
 
·ck‘_ty³
 = 
äame
[0] << 8 | frame[1];

590 
u16
 
¬p_İcode
;

592 ià(
·ck‘_ty³
 =ğ
ETH_P_ARP
) {

593 
äame
 = frame + 2;

594 
¬p_İcode
 = 
äame
[
SLSI_ARP_OPCODE_OFFSET
] << 8 | frame[SLSI_ARP_OPCODE_OFFSET + 1];

596 ià((
¬p_İcode
 =ğ
SLSI_ARP_REPLY_OPCODE
) &&

597 !
	`SLSI_IS_GRATUITOUS_ARP
(
äame
) &&

598 !
	`memcmp
(&
äame
[
SLSI_ARP_SRC_IP_ADDR_OFFSET
], &
ndev_vif
->
rg‘__addr
, 4)) {

599 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_r¥_couÁ_to_Ãtdev
++;

600 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_r¥_rx_couÁ_by_uµ”_mac
++;

606 
rx_skb
->
dev
 = dev;

607 
rx_skb
->
_summed
 = 
CHECKSUM_NONE
;

608 
rx_skb
->
´ÙocŞ
 = 
	`‘h_ty³_Œªs
Ôx_skb, 
dev
);

610 
	`SCSC_HIP4_SAMPLER_TCP_DECODE
(
sdev
, 
dev
, 
rx_skb
->
d©a
, 
Œue
);

611 
	`¦si_Œaffic_mÚ_ev’t_rx
(
sdev
, 
dev
, 
rx_skb
);

613 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX
, "·s %u by‹ tØloÿÈ¡ack\n", 
rx_skb
->
Ën
);

614 
	`¦si_skb_cb_š™
(
rx_skb
);

615 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


616 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI_GRO


617 #ifdeà
CONFIG_SCSC_WLAN_NW_PKT_DROP


621 ià(
rx_skb
->
´ÙocŞ
 =ğ
	`htÚs
(
ETH_P_ARP
)) {

622 
	`by·ss_backlog
(
sdev
, 
dev
, 
rx_skb
);

626 
drİ_´Ùo
 = 
rx_skb
->
´ÙocŞ
;

627 ià(
ùx_Çpi
) {

628 ià(
GRO_DROP
 =ğ
	`Çpi_gro_»ûive
(&
sdev
->
h4_š¡
.
h_´iv
->
Çpi
, 
rx_skb
))

629 
	`SLSI_NET_WARN
(
dev
, "Pack‘ i drİ³d. PrÙocŞ=%hx\n", 
	`Áohs
(
drİ_´Ùo
));

631 ià(
NET_RX_DROP
 =ğ
	`Ãtif_»ûive_skb
(
rx_skb
))

632 
	`SLSI_NET_WARN
(
dev
, "Pack‘ i drİ³d. PrÙocŞ=%hx\n", 
	`Áohs
(
drİ_´Ùo
));

635 
	`Ãtif_»ûive_skb
(
rx_skb
);

638 
	`Ãtif_rx_ni
(
rx_skb
);

640 
	`¦si_wake_lock_timeout
(&
sdev
->
wÏn_wl_ma
, 
	`m£cs_to_jiff›s
(
SLSI_RX_WAKELOCK_TIME
));

642 
	}
}

644 
	$¦si_rx_d©a_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

646 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

647 
¦si_³”
 *
³”
 = 
NULL
;

648 
‘hhdr
 *
‘h_hdr
;

649 
u16
 
£q_num
;

651 ià(!((
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
d©a_un™_desütÜ
è=ğ
FAPI_DATAUNITDESCRIPTOR_IEEE802_3_FRAME
) ||

652 (
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
d©a_un™_desütÜ
è=ğ
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
) ||

653 (
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
d©a_un™_desütÜ
è=ğ
FAPI_DATAUNITDESCRIPTOR_AMSDU
))) {

654 
	`WARN_ON
(1);

655 #ifdeà
CONFIG_SCSC_SMAPPER


656 
	`h4_sm­³r_ä“_m­³d_skb
(
skb
);

658 
	`kä“_skb
(
skb
);

663 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_MONITOR
) {

664 #ifdeà
CONFIG_SCSC_SMAPPER


666 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
bulk_d©a_desütÜ
è=ğ
FAPI_BULKDATADESCRIPTOR_SMAPPER
) {

668 
skb
 = 
	`¦si_h_g‘_skb_äom_sm­³r
(
sdev
, skb);

669 ià(!
skb
) {

670 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_RX
, "SKB from SMAPPER is NULL\n");

675 
	`skb_puÎ
(
skb
, 
	`çpi_g‘_sigËn
(skb));

678 
	`skb_puÎ
(
skb
, 
	`çpi_g‘_sigËn
(skb));

681 ià(
	`uÆik–y
(
	`¦si_skb_cb_g‘
(
skb
)->
wakeup
))

682 
	`¦si_rx_upd©e_wake_¡©s
(
sdev
, (
‘hhdr
 *)(
skb
->
d©a
), skb->
Ën
);

683 
	`skb_»£t_mac_h—d”
(
skb
);

684 
skb
->
dev
 = dev;

685 
skb
->
_summed
 = 
CHECKSUM_UNNECESSARY
;

686 
skb
->
pkt_ty³
 = 
PACKET_OTHERHOST
;

687 
	`Ãtif_rx_ni
(
skb
);

691 #ifdeà
CONFIG_SCSC_SMAPPER


693 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
bulk_d©a_desütÜ
è=ğ
FAPI_BULKDATADESCRIPTOR_SMAPPER
) {

694 
‘h_hdr
 = (
‘hhdr
 *)
	`¦si_h_g‘_skb_d©a_äom_sm­³r
(
sdev
, 
skb
);

695 ià(!(
‘h_hdr
)) {

696 
	`SLSI_NET_WARN
(
dev
, "SKB from SMAPPER is NULL\n");

697 
	`kä“_skb
(
skb
);

701 
‘h_hdr
 = (
‘hhdr
 *)
	`çpi_g‘_d©a
(
skb
);

704 
‘h_hdr
 = (
‘hhdr
 *)
	`çpi_g‘_d©a
(
skb
);

707 ià(
	`uÆik–y
(
	`¦si_skb_cb_g‘
(
skb
)->
wakeup
))

708 
	`¦si_rx_upd©e_wake_¡©s
(
sdev
, 
‘h_hdr
, 
skb
->
Ën
);

709 
£q_num
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
£qu’û_numb”
);

710 
	`SLSI_NET_DBG4
(
dev
, 
SLSI_RX
, "ma_unitdata_ind(vif:%d, dest:%pM, src:%pM, datatype:%d,…riority:%d, s:%d, s-mapper:%d)\n",

711 
	`çpi_g‘_vif
(
skb
),

712 
‘h_hdr
->
h_de¡
,

713 
‘h_hdr
->
h_sourû
,

714 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
d©a_un™_desütÜ
),

715 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
´iÜ™y
),

716 (
£q_num
 & 
SLSI_RX_SEQ_NUM_MASK
),

717 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
bulk_d©a_desütÜ
));

719 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
‘h_hdr
->
h_sourû
);

720 ià(!
³”
) {

721 
	`SLSI_NET_WARN
(
dev
, "Packet dropped (no…eer„ecords)\n");

723 #ifdeà
CONFIG_SCSC_SMAPPER


724 
	`h4_sm­³r_ä“_m­³d_skb
(
skb
);

726 
	`kä“_skb
(
skb
);

731 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && 
³”
->
cÚÃùed_¡©e
 !ğ
SLSI_STA_CONN_STATE_CONNECTED
) {

732 
	`SLSI_NET_WARN
(
dev
, "Pack‘ drİ³d (³” cÚÃùiÚ‚Ù com¶‘(¡©e:%u))\n", 
³”
->
cÚÃùed_¡©e
);

733 #ifdeà
CONFIG_SCSC_SMAPPER


734 
	`h4_sm­³r_ä“_m­³d_skb
(
skb
);

736 
	`kä“_skb
(
skb
);

741 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 && (
	`is_muÉiÿ¡_‘h”_addr
(
‘h_hdr
->
h_de¡
))) {

743 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_RX
, "MuÉiÿ¡/Brßdÿ¡…ack‘„eûived iÀSTA mode(£q: %dèsk BA\n", (
£q_num
 & 
SLSI_RX_SEQ_NUM_MASK
));

744 
	`¦si_rx_d©a_d–iv”_skb
(
sdev
, 
dev
, 
skb
, 
çl£
);

752 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 && 
³”
->
aid
 < 
SLSI_TDLS_PEER_INDEX_MIN
 && (
£q_num
 & 
SLSI_RX_VIA_TDLS_LINK
)) {

753 ià(
	`´štk_¿‹lim™
())

754 
	`SLSI_NET_WARN
(
dev
, "Pack‘„eûived from TDLS buˆnØTDLSƒxi¡ (£q: %xèSk BA\n", 
£q_num
);

757 
	`¦si_rx_d©a_d–iv”_skb
(
sdev
, 
dev
, 
skb
, 
çl£
);

762 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 && 
³”
->
aid
 >ğ
SLSI_TDLS_PEER_INDEX_MIN
 && (!(
£q_num
 & 
SLSI_RX_VIA_TDLS_LINK
))) {

763 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_TDLS
, "Pack‘„eûived from TDLS…“¸throughhAP(£q: %x)\n", 
£q_num
);

764 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

765 ià(!
³”
) {

766 
	`SLSI_NET_WARN
(
dev
, "Packet dropped (AP…eer‚ot found)\n");

767 #ifdeà
CONFIG_SCSC_SMAPPER


768 
	`h4_sm­³r_ä“_m­³d_skb
(
skb
);

770 
	`kä“_skb
(
skb
);

776 ià(
	`¦si_ba_check
(
³”
, 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
´iÜ™y
)))

777 ià(!
	`¦si_ba_´oûss_äame
(
dev
, 
³”
, 
skb
, (
£q_num
 & 
SLSI_RX_SEQ_NUM_MASK
),

778 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
´iÜ™y
)))

782 
	`¦si_rx_d©a_d–iv”_skb
(
sdev
, 
dev
, 
skb
, 
çl£
);

783 
	}
}

785 
	$¦si_rx_d©a_cfm
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

787 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

788 
u16
 
ho¡_g
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_cfm
.host_tag);

790 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "ma_unitdata_cfm(vif:%d, host_tag:0x%x, status:%d)\n",

791 
	`çpi_g‘_vif
(
skb
),

792 
ho¡_g
,

793 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_cfm
.
ŒªsmissiÚ_¡©us
));

794 #ifdeà
CONFIG_SCSC_WLAN_DEBUG


795 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_cfm
.
ŒªsmissiÚ_¡©us
è=ğ
FAPI_TRANSMISSIONSTATUS_TX_LIFETIME
) {

796 ià(
	`´štk_¿‹lim™
())

797 
	`SLSI_NET_WARN
(
dev
, "ma_un™d©a_cfm:x_liãtime(vif:%d, ho¡_g:0x%x)\n", 
	`çpi_g‘_vif
(
skb
), 
ho¡_g
);

800 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_cfm
.
ŒªsmissiÚ_¡©us
è=ğ
FAPI_TRANSMISSIONSTATUS_RETRY_LIMIT
)

801 
ndev_vif
->
tx_no_ack
[
	`SLSI_HOST_TAG_TRAFFIC_QUEUE
(
ho¡_g
)]++;

803 
	`kä“_skb
(
skb
);

805 
	}
}

807 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


808 
	$¦si_rx_Çpi_´oûss
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

810 
Ãt_deviû
 *
dev
;

811 
Ãtdev_vif
 *
ndev_vif
;

812 
u16
 
vif
;

814 
vif
 = 
	`çpi_g‘_vif
(
skb
);

816 
	`rcu_»ad_lock
();

817 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


818 ià((
vif
 >ğ
SLSI_NAN_DATA_IFINDEX_START
è&& 
	`çpi_g‘_sigid
(
skb
è=ğ
MA_UNITDATA_IND
) {

819 
dev
 = 
	`¦si_Çn_g‘_Ãtdev_rcu
(
sdev
, 
skb
);

821 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

824 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

826 ià(!
dev
) {

827 
	`SLSI_ERR
(
sdev
, "Ãtdev(%dèNØlÚg”ƒxi¡s\n", 
vif
);

828 
	`rcu_»ad_uÆock
();

829  -
EINVAL
;

831 
	`rcu_»ad_uÆock
();

833 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

835 
	`¦si_debug_äame
(
sdev
, 
dev
, 
skb
, "RX");

836 
	`çpi_g‘_u16
(
skb
, 
id
)) {

837 
MA_UNITDATA_IND
:

838 
	`¦si_rx_d©a_šd
(
sdev
, 
dev
, 
skb
);

841 
	`¦si_¥šlock_lock
(&
ndev_vif
->
ba_lock
);

842 ià(
	`©omic_»ad
(&
ndev_vif
->
ba_æush
)) {

843 
	`©omic_£t
(&
ndev_vif
->
ba_æush
, 0);

844 
	`¦si_ba_´oûss_com¶‘e
(
dev
, 
Œue
);

846 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

848 
MA_UNITDATA_CFM
:

849 ()
	`¦si_rx_d©a_cfm
(
sdev
, 
dev
, 
skb
);

852 
	`SLSI_DBG1
(
sdev
, 
SLSI_RX
, "UÃx³ùed D©a: 0x%.4x\n", 
	`çpi_g‘_sigid
(
skb
));

853 
	`kä“_skb
(
skb
);

857 
	}
}

859 
	$¦si_rx_Ãtdev_d©a_wÜk
(
wÜk_¡ruù
 *
wÜk
)

861 
¦si_skb_wÜk
 *
w
 = 
	`cÚš”_of
(
wÜk
, slsi_skb_work, work);

862 
¦si_dev
 *
sdev
 = 
w
->sdev;

863 
Ãt_deviû
 *
dev
 = 
w
->dev;

864 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

865 
sk_buff
 *
skb
;

867 ià(
	`WARN_ON
(!
dev
))

870 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

873 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

874 ià(!
ndev_vif
->
aùiv©ed
) {

875 
	`skb_queue_purge
(&
w
->
queue
);

876 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

880 
	`¦si_¥šlock_lock
(&
ndev_vif
->
ba_lock
);

881 ià(
	`©omic_»ad
(&
ndev_vif
->
ba_æush
)) {

882 
	`©omic_£t
(&
ndev_vif
->
ba_æush
, 0);

883 
	`¦si_ba_´oûss_com¶‘e
(
dev
, 
çl£
);

885 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
ba_lock
);

887 
skb
 = 
	`¦si_skb_wÜk_dequeue
(
w
);

888 ià(!
skb
) {

889 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

893 
	`¦si_debug_äame
(
sdev
, 
dev
, 
skb
, "RX");

894 
	`çpi_g‘_u16
(
skb
, 
id
)) {

895 
MA_UNITDATA_IND
:

896 #ifdeà
CONFIG_SCSC_SMAPPER


897 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
bulk_d©a_desütÜ
è=ğ
FAPI_BULKDATADESCRIPTOR_SMAPPER
) {

898 
u8
 *
äame
 = (u8 *)
	`¦si_h_g‘_skb_d©a_äom_sm­³r
(
sdev
, 
skb
);

900 ià(
äame
)

901 
	`SCSC_HIP4_SAMPLER_TCP_DECODE
(
sdev
, 
dev
, 
äame
, 
çl£
);

903 
	`SCSC_HIP4_SAMPLER_TCP_DECODE
(
sdev
, 
dev
, 
skb
->
d©a
 + 
	`çpi_g‘_sigËn
(skb), 
çl£
);

906 
	`SCSC_HIP4_SAMPLER_TCP_DECODE
(
sdev
, 
dev
, 
skb
->
d©a
 + 
	`çpi_g‘_sigËn
(skb), 
çl£
);

908 
	`¦si_rx_d©a_šd
(
sdev
, 
dev
, 
skb
);

910 
MA_UNITDATA_CFM
:

911 ()
	`¦si_rx_d©a_cfm
(
sdev
, 
dev
, 
skb
);

914 
	`SLSI_DBG1
(
sdev
, 
SLSI_RX
, "UÃx³ùed D©a: 0x%.4x\n", 
	`çpi_g‘_sigid
(
skb
));

915 
	`kä“_skb
(
skb
);

918 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

920 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

922 
	`¦si_h_»´oûss_sk³d_d©a_bh
(
sdev
);

924 
	}
}

926 
	$¦si_rx_queue_d©a
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

928 
Ãt_deviû
 *
dev
;

929 
Ãtdev_vif
 *
ndev_vif
;

930 
vif
;

932 
vif
 = 
	`çpi_g‘_vif
(
skb
);

934 
	`rcu_»ad_lock
();

935 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


936 ià(
vif
 >ğ
SLSI_NAN_DATA_IFINDEX_START
 && 
	`çpi_g‘_sigid
(
skb
è=ğ
MA_UNITDATA_IND
) {

937 
dev
 = 
	`¦si_Çn_g‘_Ãtdev_rcu
(
sdev
, 
skb
);

939 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

942 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

945 ià(!
dev
) {

946 
	`SLSI_ERR
(
sdev
, "Ãtdev(%dèNØlÚg”ƒxi¡s\n", 
vif
);

947 
	`rcu_»ad_uÆock
();

948 
”r
;

950 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

952 
	`¦si_skb_wÜk_’queue
(&
ndev_vif
->
rx_d©a
, 
skb
);

953 
	`rcu_»ad_uÆock
();

955 
”r
:

956  -
EINVAL
;

957 
	}
}

960 
	$§p_ma_rx_hªdËr
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

962 #ifdeà
CONFIG_SCSC_SMAPPER


963 
u16
 
sig_Ën
;

964 
u32
 
”r
;

967 
	`çpi_g‘_sigid
(
skb
)) {

968 
MA_UNITDATA_IND
:

969 #ifdeà
CONFIG_SCSC_SMAPPER


971 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
bulk_d©a_desütÜ
è=ğ
FAPI_BULKDATADESCRIPTOR_SMAPPER
) {

972 
sig_Ën
 = 
	`çpi_g‘_sigËn
(
skb
);

973 
	`skb_puÎ
(
skb
, 
sig_Ën
);

974 
”r
 = 
	`¦si_h_cÚsume_sm­³r_’Œy
(
sdev
, 
skb
);

975 
	`skb_push
(
skb
, 
sig_Ën
);

976 ià(
”r
)

977  
”r
;

981 
MA_UNITDATA_CFM
:

982 #ifdeà
CONFIG_SCSC_WLAN_RX_NAPI


983  
	`¦si_rx_Çpi_´oûss
(
sdev
, 
skb
);

985  
	`¦si_rx_queue_d©a
(
sdev
, 
skb
);

991 
	`SLSI_ERR_NODEV
("Shouldn't be getting here!\n");

992  -
EINVAL
;

993 
	}
}

996 
	$§p_ma_txdÚe
(
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
, u8 
ac
)

998 
Ãt_deviû
 *
dev
;

999 
¦si_³”
 *
³”
;

1001 
	`rcu_»ad_lock
();

1002 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

1004 ià(!
dev
) {

1005 
	`SLSI_ERR
(
sdev
, "Ãtdev(%dèNØlÚg”ƒxi¡s\n", 
vif
);

1006 
	`rcu_»ad_uÆock
();

1007  -
EINVAL
;

1009 
	`rcu_»ad_uÆock
();

1011 ià(
³”_šdex
 <ğ
SLSI_PEER_INDEX_MAX
) {

1013 ià(
³”_šdex
 == 0) {

1014 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

1016  
	`scsc_wifi_fcq_»ûive_d©a
(
dev
, &
ndev_vif
->
­
.
group_d©a_qs
, 
ac
, 
sdev
, 
vif
, 
³”_šdex
);

1018 
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
	`MAP_AID_TO_QS
(
³”_šdex
));

1019 ià(
³”
)

1020  
	`scsc_wifi_fcq_»ûive_d©a
(
dev
, &
³”
->
d©a_qs
, 
ac
, 
sdev
, 
vif
, 
³”_šdex
);

1022 
	`SLSI_DBG1
(
sdev
, 
SLSI_RX
, "³”„ecÜd NOT found fÜ vif=%d…“r_šdex=%d\n", 
vif
, 
³”_šdex
);

1026  
	`scsc_wifi_fcq_»ûive_d©a_no_³”
(
dev
, 
ac
, 
sdev
, 
vif
, 
³”_šdex
);

1028 
	`SLSI_ERR
(
sdev
, "Ëg®…“r_šdex vif=%d…“r_šdex=%d\n", 
vif
, 
³”_šdex
);

1029  -
EINVAL
;

1030 
	}
}

1032 
	$§p_ma_š™
()

1034 
	`SLSI_INFO_NODEV
("Registering SAP\n");

1035 
	`¦si_h_§p_»gi¡”
(&
§p_ma
);

1037 
	}
}

1039 
	$§p_ma_deš™
()

1041 
	`SLSI_INFO_NODEV
("Unregistering SAP\n");

1042 
	`¦si_h_§p_uÄegi¡”
(&
§p_ma
);

1044 
	}
}

	@sap_ma.h

8 #iâdeà
__SAP_MA_H__


9 
	#__SAP_MA_H__


	)

11 
§p_ma_š™
();

12 
§p_ma_deš™
();

	@sap_mlme.c

6 
	~<lšux/ty³s.h
>

7 
	~"debug.h
"

8 
	~"dev.h
"

9 
	~"§p.h
"

10 
	~"§p_mlme.h
"

11 
	~"h.h
"

12 
	~"mgt.h
"

14 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


15 
	~"scsc_wifogg”_ršgs.h
"

17 
	~"Æ80211_v’dÜ.h
"

18 
	~"mlme.h
"

20 
	#SUPPORTED_OLD_VERSION
 0

	)

22 
§p_mlme_v”siÚ_suµÜ‹d
(
u16
 
v”siÚ
);

23 
§p_mlme_rx_hªdËr
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
);

25 
§p_mlme_nÙif›r
(
¦si_dev
 *
sdev
, 
ev’t
);

27 
§p_­i
 
	g§p_mlme
 = {

28 .
§p_şass
 = 
SAP_MLME
,

29 .
	g§p_v”siÚ_suµÜ‹d
 = 
§p_mlme_v”siÚ_suµÜ‹d
,

30 .
	g§p_hªdËr
 = 
§p_mlme_rx_hªdËr
,

31 .
	g§p_v”siÚs
 = { 
FAPI_CONTROL_SAP_VERSION
, 
SUPPORTED_OLD_VERSION
 },

32 .
	g§p_nÙif›r
 = 
§p_mlme_nÙif›r
,

35 
	$§p_mlme_nÙif›r
(
¦si_dev
 *
sdev
, 
ev’t
)

37 
i
;

38 #ià
	`defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

39 
Ãt_deviû
 *
dev
;

41 
Ëv–
;

42 
Ãtdev_vif
 *
ndev_vif
;

43 
boŞ
 
is_»cov”y
 = 
çl£
;

45 
	`SLSI_INFO_NODEV
("NÙif›¸ev’ˆ»ûived: %lu\n", 
ev’t
);

46 ià(
ev’t
 >ğ
SCSC_MAX_NOTIFIER
)

47  -
EIO
;

49 
ev’t
) {

50 
SCSC_WIFI_STOP
:

52 
sdev
->
mlme_blocked
 = 
Œue
;

53 
sdev
->
d‘eù_vif_aùive
 = 
çl£
;

55 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

56 
Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

57 
	`SLSI_INFO_NODEV
("MLME BLOCKED sy¡emƒ¼Ü†ev–:%d\n", 
Ëv–
);

58 ià(
Ëv–
 < 
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
)

59 
is_»cov”y
 = 
Œue
;

60 
	`com¶‘e_®l
(&
sdev
->
sig_wa™
.
com¶‘iÚ
);

62 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++)

63 ià(
sdev
->
Ãtdev
[
i
]) {

64 
boŞ
 
vif_ty³_­
 = 
çl£
;

65 
ndev_vif
 = 
	`Ãtdev_´iv
(
sdev
->
Ãtdev
[
i
]);

66 
	`com¶‘e_®l
(&
ndev_vif
->
sig_wa™
.
com¶‘iÚ
);

67 
	`¦si_sÿn_ş—nup
(
sdev
, sdev->
Ãtdev
[
i
]);

68 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
£t_muÉiÿ¡_f‹r_wÜk
);

69 
	`ÿnûl_wÜk_sync
(&
ndev_vif
->
upd©e_pkt_f‹r_wÜk
);

71 ià(
Ëv–
 < 
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
 && 
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
)

72 
vif_ty³_­
 = 
Œue
;

73 
sdev
->
»quœe_vif_d–‘e
[
ndev_vif
->
iâum
] = 
çl£
;

74 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

75 
	`¦si_vif_ş—nup
(
sdev
, sdev->
Ãtdev
[
i
], 0, 
is_»cov”y
);

76 ià(
Ëv–
 < 
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
 && 
vif_ty³_­
)

77 
ndev_vif
->
vif_ty³
 = 
FAPI_VIFTYPE_AP
;

78 #ifdeà
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL


79 ià(
	`©omic_»ad
(&
ndev_vif
->
¬p_tx_couÁ
è&&‡tomic_»ad(&
sdev
->
ù¾_·u£_¡©e
))

80 
	`scsc_wifi_uÅau£_¬p_q_®l_vif
(
sdev
);

81 
	`©omic_£t
(&
ndev_vif
->
¬p_tx_couÁ
, 0);

83 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

85 #ifdeà
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL


86 ià(
	`©omic_»ad
(&
sdev
->
¬p_tx_couÁ
è&&‡tomic_»ad(&sdev->
ù¾_·u£_¡©e
))

87 
	`scsc_wifi_uÅau£_¬p_q_®l_vif
(
sdev
);

88 
	`©omic_£t
(&
sdev
->
¬p_tx_couÁ
, 0);

90 ià(
Ëv–
 < 
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
)

91 
sdev
->
deviû_¡©e
 = 
SLSI_DEVICE_STATE_STOPPING
;

92 ià(
sdev
->
Ãtdev_up_couÁ
 == 0)

93 
sdev
->
mlme_blocked
 = 
çl£
;

94 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

95 
	`SLSI_INFO_NODEV
("Force cleaned‡ll VIFs\n");

98 
SCSC_WIFI_FAILURE_RESET
:

99 
Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

100 ià(
Ëv–
 < 
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
 || 
sdev
->
»quœe_£rviû_şo£
) {

101 
	`SLSI_INFO
(
sdev
, "E¼Ü Lev–:%d, s¹„ecov”y_wÜk_Ú_¡İ queue!!\n", 
Ëv–
);

102 
	`queue_wÜk
(
sdev
->
deviû_wq
, &sdev->
»cov”y_wÜk_Ú_¡İ
);

106 
SCSC_WIFI_SUSPEND
:

107 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

108 ià(!(
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
è|| (sdev->deviû_cÚfig.
ho¡_¡©e
 & 
SLSI_HOSTSTATE_LCD_ACTIVE
)) {

109 
	`SLSI_WARN
(
sdev
, "SUSPEND but‚o SETSUSPENDMODE\n");

110 
	`SLSI_INFO
(
sdev
, "UserSuspendMode:%d HostState:%0.2x\n",

111 
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
, sdev->deviû_cÚfig.
ho¡_¡©e
);

113 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

116 
SCSC_WIFI_RESUME
:

117 #ià
	`defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

118 
dev
 = 
	`¦si_g‘_Ãtdev
(
sdev
, 
SLSI_NET_INDEX_WLAN
);

119 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

120 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

122 ià(
ndev_vif
->
is_ws_ruÂšg
 &&‚dev_vif->
aùiv©ed
 &&

123 
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_STATION
 &&

124 
ndev_vif
->
¡a
.
vif_¡©us
 =ğ
SLSI_VIF_STATUS_CONNECTED
) {

125 
ndev_vif
->
is_ws_ruÂšg
 = 
çl£
;

127 
	`¦si_£nd_fÜw¬d_b—cÚ_abÜt_v’dÜ_ev’t
(
sdev
, 
dev
,

128 
SLSI_FORWARD_BEACON_ABORT_REASON_SUSPENDED
);

129 
	`SLSI_INFO_NODEV
("FORWARD_BEACON: SUSPEND_RESUMED!! send‡bortƒvent\n");

132 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

134 
	`SLSI_MUTEX_LOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

135 ià(!(
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
è|| (sdev->deviû_cÚfig.
ho¡_¡©e
 & 
SLSI_HOSTSTATE_LCD_ACTIVE
)) {

136 
	`SLSI_WARN
(
sdev
, "RESUME but‚o SETSUSPENDMODE\n");

137 
	`SLSI_INFO
(
sdev
, "UserSuspendMode:%d HostState:%0.2x\n",

138 
sdev
->
deviû_cÚfig
.
u£r_su¥’d_mode
, sdev->deviû_cÚfig.
ho¡_¡©e
);

140 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
deviû_cÚfig_mu‹x
);

142 
SCSC_WIFI_SUBSYSTEM_RESET
:

144 
	`queue_wÜk
(
sdev
->
deviû_wq
, &sdev->
»cov”y_wÜk
);

146 
SCSC_WIFI_CHIP_READY
:

147 
Ëv–
 = 
	`©omic_»ad
(&
sdev
->
cm_if
.
»£t_Ëv–
);

148 ià(
Ëv–
 < 
SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
 && 
sdev
->
Ãtdev_up_couÁ
 != 0)

149 
	`queue_wÜk
(
sdev
->
deviû_wq
, &sdev->
»cov”y_wÜk_Ú_¡¬t
);

152 
	`SLSI_INFO_NODEV
("UnknowÀev’ˆcod%lu\n", 
ev’t
);

157 
	}
}

159 
	$§p_mlme_v”siÚ_suµÜ‹d
(
u16
 
v”siÚ
)

161 
majÜ
 = 
	`SAP_MAJOR
(
v”siÚ
);

162 
mšÜ
 = 
	`SAP_MINOR
(
v”siÚ
);

163 
u8
 
i
 = 0;

165 
	`SLSI_INFO_NODEV
("R•Ü‹d v”siÚ: %d.%d\n", 
majÜ
, 
mšÜ
);

167 
i
 = 0; i < 
SAP_MAX_VER
; i++)

168 ià(
	`SAP_MAJOR
(
§p_mlme
.
§p_v”siÚs
[
i
]è=ğ
majÜ
)

171 
	`SLSI_ERR_NODEV
("V”siÚ %d.%d NÙ suµÜ‹d\n", 
majÜ
, 
mšÜ
);

173  -
EINVAL
;

174 
	}
}

176 
	$¦si_rx_Ãtdev_mlme
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

178 
u16
 
id
 = 
	`çpi_g‘_u16
(
skb
, id);

182 
id
) {

183 
MLME_SCAN_IND
:

184 
	`¦si_rx_sÿn_šd
(
sdev
, 
dev
, 
skb
);

186 
MLME_SCAN_DONE_IND
:

187 
	`¦si_rx_sÿn_dÚe_šd
(
sdev
, 
dev
, 
skb
);

189 
MLME_CONNECT_IND
:

190 
	`¦si_rx_cÚÃù_šd
(
sdev
, 
dev
, 
skb
);

192 
MLME_CONNECTED_IND
:

193 
	`¦si_rx_cÚÃùed_šd
(
sdev
, 
dev
, 
skb
);

195 
MLME_RECEIVED_FRAME_IND
:

196 
	`¦si_rx_»ûived_äame_šd
(
sdev
, 
dev
, 
skb
);

198 
MLME_DISCONNECT_IND
:

199 
	`¦si_rx_discÚÃù_šd
(
sdev
, 
dev
, 
skb
);

201 
MLME_DISCONNECTED_IND
:

202 
	`¦si_rx_discÚÃùed_šd
(
sdev
, 
dev
, 
skb
);

204 
MLME_PROCEDURE_STARTED_IND
:

205 
	`¦si_rx_´oûdu»_¡¬‹d_šd
(
sdev
, 
dev
, 
skb
);

207 
MLME_FRAME_TRANSMISSION_IND
:

208 
	`¦si_rx_äame_ŒªsmissiÚ_šd
(
sdev
, 
dev
, 
skb
);

210 
MA_BLOCKACK_IND
:

211 
	`¦si_rx_blockack_šd
(
sdev
, 
dev
, 
skb
);

213 
MLME_ROAMED_IND
:

214 
	`¦si_rx_rßmed_šd
(
sdev
, 
dev
, 
skb
);

216 
MLME_ROAM_IND
:

217 
	`¦si_rx_rßm_šd
(
sdev
, 
dev
, 
skb
);

219 
MLME_MIC_FAILURE_IND
:

220 
	`¦si_rx_mic_çu»_šd
(
sdev
, 
dev
, 
skb
);

222 
MLME_REASSOCIATE_IND
:

223 
	`¦si_rx_»assoc_šd
(
sdev
, 
dev
, 
skb
);

225 
MLME_TDLS_PEER_IND
:

226 
	`¦si_tdls_³”_šd
(
sdev
, 
dev
, 
skb
);

228 
MLME_LISTEN_END_IND
:

229 
	`¦si_rx_li¡’_’d_šd
(
dev
, 
skb
);

231 
MLME_CHANNEL_SWITCHED_IND
:

232 
	`¦si_rx_chªÃl_sw™ched_šd
(
sdev
, 
dev
, 
skb
);

234 
MLME_AC_PRIORITY_UPDATE_IND
:

235 
	`SLSI_DBG1
(
sdev
, 
SLSI_MLME
,

237 
	`kä“_skb
(
skb
);

239 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


240 
MLME_RSSI_REPORT_IND
:

241 
	`¦si_rx_rssi_»pÜt_šd
(
sdev
, 
dev
, 
skb
);

243 
MLME_RANGE_IND
:

244 
	`¦si_rx_¿nge_šd
(
sdev
, 
dev
, 
skb
);

246 
MLME_RANGE_DONE_IND
:

247 
	`¦si_rx_¿nge_dÚe_šd
(
sdev
, 
dev
, 
skb
);

249 
MLME_EVENT_LOG_IND
:

250 
	`¦si_rx_ev’t_log_šdiÿtiÚ
(
sdev
, 
dev
, 
skb
);

253 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


254 
MLME_NAN_EVENT_IND
:

255 
	`¦si_Çn_ev’t
(
sdev
, 
dev
, 
skb
);

257 
MLME_NAN_FOLLOWUP_IND
:

258 
	`¦si_Çn_fŞlowup_šd
(
sdev
, 
dev
, 
skb
);

260 
MLME_NAN_SERVICE_IND
:

261 
	`¦si_Çn_£rviû_šd
(
sdev
, 
dev
, 
skb
);

263 
MLME_NDP_REQUEST_IND
:

264 
	`¦si_Çn_ndp_£tup_šd
(
sdev
, 
dev
, 
skb
, 
Œue
);

266 
MLME_NDP_REQUESTED_IND
:

267 
	`¦si_Çn_ndp_»que¡ed_šd
(
sdev
, 
dev
, 
skb
);

269 
MLME_NDP_RESPONSE_IND
:

270 
	`¦si_Çn_ndp_£tup_šd
(
sdev
, 
dev
, 
skb
, 
çl£
);

272 
MLME_NDP_TERMINATED_IND
:

273 
	`¦si_Çn_ndp_‹rmš©iÚ_šd
(
sdev
, 
dev
, 
skb
);

275 
MLME_NAN_RANGE_IND
:

276 
	`¦si_rx_Çn_¿nge_šd
(
sdev
, 
dev
, 
skb
);

279 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


280 
MLME_SYNCHRONISED_IND
:

281 
	`¦si_rx_synchrÚi£d_šd
(
sdev
, 
dev
, 
skb
);

284 #ià
	`defšed
(
CONFIG_SLSI_WLAN_STA_FWD_BEACON
è&& (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

285 
MLME_BEACON_REPORTING_EVENT_IND
:

286 
	`¦si_rx_b—cÚ_»pÜtšg_ev’t_šd
(
sdev
, 
dev
, 
skb
);

289 
MLME_BLACKLISTED_IND
:

290 
	`¦si_rx_bÏckli¡ed_šd
(
sdev
, 
dev
, 
skb
);

292 
MLME_ROAMING_CHANNEL_LIST_IND
:

293 
	`¦si_rx_rş_chªÃl_li¡_šd
(
sdev
, 
dev
, 
skb
);

295 #ifdeà
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL


296 
MLME_SEND_FRAME_CFM
:

297 
	`¦si_rx_£nd_äame_cfm_async
(
sdev
, 
dev
, 
skb
);

300 
MLME_START_DETECT_IND
:

301 
	`¦si_rx_¡¬t_d‘eù_šd
(
sdev
, 
dev
, 
skb
);

303 
SAP_DRV_MA_TO_MLME_DELBA_REQ
:

304 
	`¦si_rx_ma_to_mlme_d–ba_»q
(
sdev
, 
dev
, 
skb
);

307 
	`kä“_skb
(
skb
);

308 
	`SLSI_NET_ERR
(
dev
, "UnhªdËd Ind/Cfm: 0x%.4x\n", 
id
);

312 
	}
}

314 
	$¦si_rx_Ãtdev_mlme_wÜk
(
wÜk_¡ruù
 *
wÜk
)

316 
¦si_skb_wÜk
 *
w
 = 
	`cÚš”_of
(
wÜk
, slsi_skb_work, work);

317 
¦si_dev
 *
sdev
 = 
w
->sdev;

318 
Ãt_deviû
 *
dev
 = 
w
->dev;

319 
sk_buff
 *
skb
 = 
NULL
;

320 #ifdeà
CONFIG_SCSC_WLAN_DEBUG_MLME_WORK_STRUCT


321 
¦si_dev
 *
Üg_sdev
 = 
	`¦si_g‘_sdev
();

322 
¥šlock_t
 *
w_lock
 = &
w
->
queue
.
lock
;

323 vŞ©
¥šlock_t
 *
lock
 = 
NULL
;

325 ià(
w
->
sdev
 !ğ
Üg_sdev
) {

326 
	`SLSI_INFO_NODEV
("Deliberately…aniche kernel dueo corrupted worker struct\n");

327 
	`SLSI_INFO_NODEV
("calling BUG_ON(1)\n");

328 
	`BUG_ON
(1);

331 ià(
	`WARN_ON
(!
dev
))

333 
skb
 = 
	`¦si_skb_wÜk_dequeue
(
w
);

335 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

336 
skb
) {

337 
	`¦si_debug_äame
(
sdev
, 
dev
, 
skb
, "RX");

338 
	`¦si_rx_Ãtdev_mlme
(
sdev
, 
dev
, 
skb
);

339 #ifdeà
CONFIG_SCSC_WLAN_DEBUG_MLME_WORK_STRUCT


340 
lock
 = &
w
->
queue
.lock;

341 ià(
w_lock
 !ğ
lock
) {

342 
	`SLSI_INFO_NODEV
("Deliberately…aniche kernel dueo corrupted†ock‡ddress\n");

343 
	`SLSI_INFO_NODEV
("calling BUG_ON(1)\n");

344 
	`BUG_ON
(1);

347 
skb
 = 
	`¦si_skb_wÜk_dequeue
(
w
);

349 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

350 
	}
}

352 
	$¦si_rx_’queue_Ãtdev_mlme
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
, 
u16
 
vif
)

354 
Ãt_deviû
 *
dev
;

355 
Ãtdev_vif
 *
ndev_vif
;

356 #ifdeà
CONFIG_SCSC_WLAN_DEBUG_MLME_WORK_STRUCT


357 
¦si_dev
 *
Üg_sdev
 = 
	`¦si_g‘_sdev
();

359 ià(
sdev
 !ğ
Üg_sdev
) {

360 
	`SLSI_INFO_NODEV
("Deliberately…aniche kernel dueo memory corruption\n");

361 
	`SLSI_INFO_NODEV
("calling BUG_ON(1)\n");

362 
	`BUG_ON
(1);

366 
	`rcu_»ad_lock
();

367 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


368 ià(
vif
 >ğ
SLSI_NAN_DATA_IFINDEX_START
 && 
	`çpi_g‘_sigid
(
skb
è=ğ
MA_BLOCKACK_IND
)

369 
dev
 = 
	`¦si_Çn_g‘_Ãtdev_rcu
(
sdev
, 
skb
);

371 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

373 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

377 ià(!
dev
) {

378 
	`SLSI_WARN
(
sdev
, "dev is NULL");

379 
	`kä“_skb
(
skb
);

380 
	`rcu_»ad_uÆock
();

384 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

386 ià(
	`uÆik–y
(
ndev_vif
->
is_fw_‹¡
)) {

387 
	`kä“_skb
(
skb
);

388 
	`rcu_»ad_uÆock
();

392 
	`¦si_skb_wÜk_’queue
(&
ndev_vif
->
rx_mlme
, 
skb
);

393 
	`rcu_»ad_uÆock
();

395 
	}
}

397 
	$¦si_rx_aùiÚ_’queue_Ãtdev_mlme
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
, 
u16
 
vif
)

399 
Ãt_deviû
 *
dev
;

400 
Ãtdev_vif
 *
ndev_vif
;

402 
	`rcu_»ad_lock
();

403 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

404 ià(
	`WARN_ON
(!
dev
)) {

405 
	`rcu_»ad_uÆock
();

406  -
ENODEV
;

409 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

411 ià(
	`uÆik–y
(
ndev_vif
->
is_fw_‹¡
)) {

412 
	`rcu_»ad_uÆock
();

416 ià(
ndev_vif
->
iáy³
 =ğ
NL80211_IFTYPE_P2P_GO
 ||‚dev_vif->iáy³ =ğ
NL80211_IFTYPE_P2P_CLIENT
) {

417 
›“80211_mgmt
 *
mgmt
 = 
	`çpi_g‘_mgmt
(
skb
);

419 ià(
	`memcmp
(
mgmt
->
da
, 
dev
->
dev_addr
, 
ETH_ALEN
) != 0) {

420 
Ãt_deviû
 *
p2pdev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
SLSI_NET_INDEX_P2P
);

422 ià(
	`WARN_ON
(!
p2pdev
)) {

423 
	`rcu_»ad_uÆock
();

424  -
ENODEV
;

426 ià(
	`memcmp
(
mgmt
->
da
, 
p2pdev
->
dev_addr
, 
ETH_ALEN
) == 0) {

431 
ndev_vif
 = 
	`Ãtdev_´iv
(
p2pdev
);

433 ià(
	`uÆik–y
(
ndev_vif
->
is_fw_‹¡
)) {

434 
	`kä“_skb
(
skb
);

435 
	`rcu_»ad_uÆock
();

442 
	`¦si_skb_wÜk_’queue
(&
ndev_vif
->
rx_mlme
, 
skb
);

444 
	`rcu_»ad_uÆock
();

446 
	}
}

448 
	$§p_mlme_rx_hªdËr
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

450 
u16
 
sÿn_id
;

451 
u16
 
vif
 = 
	`çpi_g‘_vif
(
skb
);

453 ià(
	`¦si_rx_blockšg_sigÇls
(
sdev
, 
skb
) == 0)

456 ià(
	`çpi_is_šd
(
skb
)) {

457 #ià
	`IS_ENABLED
(
CONFIG_SCSC_WIFILOGGER
)

458 
	`SCSC_WLOG_PKTFATE_LOG_RX_CTRL_FRAME
(
	`çpi_g‘_d©a
(
skb
), 
	`çpi_g‘_d©®’
(skb));

461 
	`çpi_g‘_sigid
(
skb
)) {

462 
MLME_SCAN_DONE_IND
:

463 
sÿn_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_sÿn_dÚe_šd
.scan_id);

464 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


465 ià(
	`¦si_is_gsÿn_id
(
sÿn_id
))

466  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
SLSI_NET_INDEX_WLAN
);

468  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, (
sÿn_id
 >> 8));

469 
MLME_SCAN_IND
:

470 ià(
vif
)

471  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
vif
);

472 
sÿn_id
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_sÿn_šd
.scan_id);

473 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


474 ià(
	`¦si_is_gsÿn_id
(
sÿn_id
))

475  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
SLSI_NET_INDEX_WLAN
);

477  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, (
sÿn_id
 >> 8));

478 
MLME_RECEIVED_FRAME_IND
:

479 ià(
vif
 == 0) {

480 
	`SLSI_WARN
(
sdev
, "MLME_RECEIVED_FRAME_IND VIF 0\n");

481 
”r
;

483  
	`¦si_rx_aùiÚ_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
vif
);

484 #ifdeà
CONFIG_SCSC_WLAN_GSCAN_ENABLE


485 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


486 
MLME_NAN_EVENT_IND
:

487 
MLME_NAN_FOLLOWUP_IND
:

488 
MLME_NAN_SERVICE_IND
:

489 
MLME_NDP_REQUEST_IND
:

490 
MLME_NDP_REQUESTED_IND
:

491 
MLME_NDP_RESPONSE_IND
:

492 
MLME_NDP_TERMINATED_IND
:

493 
MLME_NAN_RANGE_IND
:

494  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
vif
);

496 
MLME_RANGE_IND
:

497 
MLME_RANGE_DONE_IND
:

498 ià(
vif
 == 0)

499  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
SLSI_NET_INDEX_WLAN
);

501  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
vif
);

503 #ifdeà
CONFIG_SCSC_WLAN_ENHANCED_LOGGING


504 
MLME_EVENT_LOG_IND
:

505  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
SLSI_NET_INDEX_WLAN
);

507 
MLME_START_DETECT_IND
:

508  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
SLSI_NET_INDEX_WLAN
);

509 
MLME_ROAMED_IND
:

510 ià(
vif
 == 0) {

511 
	`SLSI_WARN
(
sdev
, "MLME_ROAMED_IND VIF 0\n");

512 
”r
;

514 
Ãt_deviû
 *
dev
;

515 
Ãtdev_vif
 *
ndev_vif
;

517 
	`rcu_»ad_lock
();

518 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

519 ià(
	`WARN_ON
(!
dev
)) {

520 
	`rcu_»ad_uÆock
();

521  -
ENODEV
;

523 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

524 ià(
	`©omic_»ad
(&
ndev_vif
->
¡a
.
drİ_rßmed_šd
)) {

528 
	`kä“_skb
(
skb
);

529 
	`rcu_»ad_uÆock
();

532 
	`rcu_»ad_uÆock
();

533  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
vif
);

536 ià(
vif
 == 0) {

537 
	`SLSI_WARN
(
sdev
, "Reûived sigÇÈ0x%04x oÀVIF 0,„‘uºƒ¼Ü\n", 
	`çpi_g‘_sigid
(
skb
));

538 
”r
;

540  
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
vif
);

545 ià(
	`çpi_is_cfm
(
skb
è&& 
	`çpi_g‘_sigid
(skbè=ğ
MLME_SEND_FRAME_CFM
 && 
vif
 != 0) {

546 #ifdeà
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL


547 
	`¦si_rx_’queue_Ãtdev_mlme
(
sdev
, 
skb
, 
vif
);

549 
	`kä“_skb
(
skb
);

554 ià(
	`WARN_ON
(
	`çpi_is_»q
(
skb
)))

555 
”r
;

557 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

558 
	`kä“_skb
(
skb
);

562 
	`WARN_ON
(1);

564 
”r
:

565  -
EINVAL
;

566 
	}
}

568 
	$¦si_g‘_çpi_v”siÚ_¡ršg
(*
»s
)

570 
couÁ
 = 0;

572 
couÁ
 = 
	`¢´štf
(
»s
, 100, "FAPI_CONTROL_SAP_VERSION : %d.%d.%d\n",

573 
	`FAPI_MAJOR_VERSION
(
FAPI_CONTROL_SAP_VERSION
),

574 
	`FAPI_MINOR_VERSION
(
FAPI_CONTROL_SAP_VERSION
),

575 
FAPI_CONTROL_SAP_ENG_VERSION
);

576 
»s
[
couÁ
] = '\0';

577 
	}
}

579 
	$§p_mlme_š™
()

581 
	`SLSI_INFO_NODEV
("Registering SAP\n");

582 
	`¦si_h_§p_»gi¡”
(&
§p_mlme
);

584 
	}
}

586 
	$§p_mlme_deš™
()

588 
	`SLSI_INFO_NODEV
("Unregistering SAP\n");

589 
	`¦si_h_§p_uÄegi¡”
(&
§p_mlme
);

591 
	}
}

	@sap_mlme.h

8 #iâdeà
__SAP_MLME_H__


9 
	#__SAP_MLME_H__


	)

11 
§p_mlme_š™
();

12 
§p_mlme_deš™
();

15 
¦si_rx_sÿn_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

16 #ià
defšed
 
CONFIG_SLSI_WLAN_STA_FWD_BEACON
 && (defšed(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 10)

17 
¦si_rx_b—cÚ_»pÜtšg_ev’t_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

19 
¦si_rx_sÿn_dÚe_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

20 
¦si_rx_chªÃl_sw™ched_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

21 #ifdeà
CONFIG_SCSC_WLAN_SAE_CONFIG


22 
¦si_rx_synchrÚi£d_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

24 
¦si_rx_bÏckli¡ed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

25 
¦si_rx_cÚÃù_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

26 
¦si_rx_cÚÃùed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

27 
¦si_rx_»ûived_äame_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

28 
¦si_rx_discÚÃù_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

29 
¦si_rx_discÚÃùed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

30 
¦si_rx_´oûdu»_¡¬‹d_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

31 
¦si_rx_äame_ŒªsmissiÚ_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

32 
¦si_rx_rßmed_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

33 
¦si_rx_rßm_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

34 
¦si_rx_mic_çu»_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

35 
¦si_rx_»assoc_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

36 
¦si_tdls_³”_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

37 
¦si_rx_li¡’_’d_šd
(
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

38 
¦si_rx_blockack_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

39 
¦si_rx_ma_to_mlme_d–ba_»q
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

40 
¦si_rx_¡¬t_d‘eù_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

41 
¦si_rx_rş_chªÃl_li¡_šd
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

42 
¦si_g‘_çpi_v”siÚ_¡ršg
(*
»s
);

	@sap_test.c

6 
	~<lšux/ty³s.h
>

7 
	~"dev.h
"

8 
	~"§p.h
"

9 
	~"§p_‹¡.h
"

10 
	~"h.h
"

12 
	~"debug.h
"

14 
	#SUPPORTED_OLD_VERSION
 0

	)

16 
§p_‹¡_v”siÚ_suµÜ‹d
(
u16
 
v”siÚ
);

17 
§p_‹¡_rx_hªdËr
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
);

19 
§p_­i
 
	g§p_‹¡
 = {

20 .
§p_şass
 = 
SAP_TST
,

21 .
	g§p_v”siÚ_suµÜ‹d
 = 
§p_‹¡_v”siÚ_suµÜ‹d
,

22 .
	g§p_hªdËr
 = 
§p_‹¡_rx_hªdËr
,

23 .
	g§p_v”siÚs
 = { 
FAPI_TEST_SAP_VERSION
, 
SUPPORTED_OLD_VERSION
 },

26 
	$§p_‹¡_v”siÚ_suµÜ‹d
(
u16
 
v”siÚ
)

28 
majÜ
 = 
	`SAP_MAJOR
(
v”siÚ
);

29 
mšÜ
 = 
	`SAP_MINOR
(
v”siÚ
);

30 
u8
 
i
 = 0;

32 
	`SLSI_INFO_NODEV
("R•Ü‹d v”siÚ: %d.%d\n", 
majÜ
, 
mšÜ
);

34 
i
 = 0; i < 
SAP_MAX_VER
; i++)

35 ià(
	`SAP_MAJOR
(
§p_‹¡
.
§p_v”siÚs
[
i
]è=ğ
majÜ
)

38 
	`SLSI_ERR_NODEV
("V”siÚ %d.%d NÙ suµÜ‹d\n", 
majÜ
, 
mšÜ
);

40  -
EINVAL
;

41 
	}
}

43 
	$§p_‹¡_rx_hªdËr
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

45 ià(
	`¦si_rx_blockšg_sigÇls
(
sdev
, 
skb
) == 0)

48 
	`SLSI_INFO_NODEV
("TEST SAP‚ot implemented\n");

50 
	`kä“_skb
(
skb
);

53 
	}
}

55 
	$§p_‹¡_š™
()

57 
	`SLSI_INFO_NODEV
("Registering SAP\n");

58 
	`¦si_h_§p_»gi¡”
(&
§p_‹¡
);

60 
	}
}

62 
	$§p_‹¡_deš™
()

64 
	`SLSI_INFO_NODEV
("Unregistering SAP\n");

65 
	`¦si_h_§p_uÄegi¡”
(&
§p_‹¡
);

67 
	}
}

	@sap_test.h

8 #iâdeà
__SAP_TEST_H__


9 
	#__SAP_TEST_H__


	)

11 
§p_‹¡_š™
();

12 
§p_‹¡_deš™
();

	@scsc_wifi_cm_if.h

7 #iâdeà
__SCSC_WIFI_CM_IF_H__


8 
	#__SCSC_WIFI_CM_IF_H__


	)

10 
	~<lšux/ty³s.h
>

11 
	~<lšux/deviû.h
>

12 
	~<lšux/k»f.h
>

14 
	~<scsc/scsc_mx.h
>

16 
	#SLSI_WIFI_CM_IF_SYSTEM_ERROR_PANIC
 8

	)

18 
	g¦si_dev
;

32 
	escsc_wifi_cm_if_¡©e
 {

33 
	mSCSC_WIFI_CM_IF_STATE_STOPPED
,

34 
	mSCSC_WIFI_CM_IF_STATE_PROBING
,

35 
	mSCSC_WIFI_CM_IF_STATE_PROBED
,

36 
	mSCSC_WIFI_CM_IF_STATE_STARTING
,

37 
	mSCSC_WIFI_CM_IF_STATE_STARTED
,

38 
	mSCSC_WIFI_CM_IF_STATE_STOPPING
,

39 
	mSCSC_WIFI_CM_IF_STATE_REMOVING
,

40 
	mSCSC_WIFI_CM_IF_STATE_REMOVED
,

41 
	mSCSC_WIFI_CM_IF_STATE_BLOCKED


51 
	escsc_wifi_cm_if_nÙif›r
 {

52 
	mSCSC_WIFI_STOP
,

53 
	mSCSC_WIFI_FAILURE_RESET
,

54 
	mSCSC_WIFI_SUSPEND
,

55 
	mSCSC_WIFI_RESUME
,

56 
	mSCSC_WIFI_SUBSYSTEM_RESET
,

57 
	mSCSC_WIFI_CHIP_READY
,

58 
	mSCSC_MAX_NOTIFIER


61 
	sscsc_wifi_cm_if
 {

62 
¦si_dev
 *
	msdev
;

64 
mu‹x
 
	mcm_if_mu‹x
;

66 
k»f
 
	mk»f
;

69 
©omic_t
 
	mcm_if_¡©e
;

71 
	m»cov”y_¡©e
;

73 
©omic_t
 
	m»£t_Ëv–
;

81 
¦si_dev
 *
¦si_dev_©ch
(
deviû
 *
dev
, 
scsc_mx
 *
cÜe
, 
scsc_£rviû_ş›Á
 *
mx_wÏn_ş›Á
);

82 
¦si_dev_d‘ach
(
¦si_dev
 *
sdev
);

87 
¦si_sm_£rviû_driv”_»gi¡”
();

88 
¦si_sm_£rviû_driv”_uÄegi¡”
();

89 
¦si_sm_£rviû_çed
(
¦si_dev
 *
sdev
, cÚ¡ *
»asÚ
, 
boŞ
 
is_wÜk
);

90 
¦si_sm_wÏn_£rviû_İ’
(
¦si_dev
 *
sdev
);

91 
¦si_sm_wÏn_£rviû_¡¬t
(
¦si_dev
 *
sdev
);

92 
¦si_sm_wÏn_£rviû_¡İ
(
¦si_dev
 *
sdev
);

93 
¦si_sm_wÏn_£rviû_şo£
(
¦si_dev
 *
sdev
);

94 
¦si_wÏn_£rviû_nÙif›r_»gi¡”
(
nÙif›r_block
 *
nb
);

95 
¦si_wÏn_£rviû_nÙif›r_uÄegi¡”
(
nÙif›r_block
 *
nb
);

96 
¦si_sm_»cov”y_£rviû_¡İ
(
¦si_dev
 *
sdev
);

97 
¦si_sm_»cov”y_£rviû_şo£
(
¦si_dev
 *
sdev
);

98 
¦si_sm_»cov”y_£rviû_İ’
(
¦si_dev
 *
sdev
);

99 
¦si_sm_»cov”y_£rviû_¡¬t
(
¦si_dev
 *
sdev
);

	@scsc_wifi_fcq.c

7 
	~"scsc_wifi_fcq.h
"

8 
	~"debug.h
"

9 
	~"dev.h
"

10 
	~"h4_§m¶”.h
"

38 
ušt
 
	gscsc_wifi_fcq_smod
 = 512;

39 
moduË_·¿m
(
scsc_wifi_fcq_smod
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

40 
MODULE_PARM_DESC
(
scsc_wifi_fcq_smod
, "Initial value of unicast smod -…eer‚ormal (default = 500)");

42 
ušt
 
	gscsc_wifi_fcq_mÿ¡_smod
 = 100;

43 
moduË_·¿m
(
scsc_wifi_fcq_mÿ¡_smod
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

44 
MODULE_PARM_DESC
(
scsc_wifi_fcq_mÿ¡_smod
, "Initial value of multicast smod -…eer‚ormal (default = 100)");

46 
ušt
 
	gscsc_wifi_fcq_smod_pow”
 = 4;

47 
moduË_·¿m
(
scsc_wifi_fcq_smod_pow”
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

48 
MODULE_PARM_DESC
(
scsc_wifi_fcq_smod_pow”
, "Initial…owersave SMOD value -…eer…owersave (default = 4)");

50 
ušt
 
	gscsc_wifi_fcq_mÿ¡_smod_pow”
 = 4;

51 
moduË_·¿m
(
scsc_wifi_fcq_mÿ¡_smod_pow”
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

52 
MODULE_PARM_DESC
(
scsc_wifi_fcq_mÿ¡_smod_pow”
, "Initial value of…owersave multicast smod -…eer‚ormal (default = 4)");

54 
ušt
 
	gscsc_wifi_fcq_qmod
 = 512;

55 
moduË_·¿m
(
scsc_wifi_fcq_qmod
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

56 
MODULE_PARM_DESC
(
scsc_wifi_fcq_qmod
, "Initial value of unicast qmod -…eer‚ormal (default = 500)");

58 
ušt
 
	gscsc_wifi_fcq_mÿ¡_qmod
 = 100;

59 
moduË_·¿m
(
scsc_wifi_fcq_mÿ¡_qmod
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

60 
MODULE_PARM_DESC
(
scsc_wifi_fcq_mÿ¡_qmod
, "Initial value of multicast qmod -…eer‚ormal (default = 100)");

62 
ušt
 
	gscsc_wifi_fcq_mšimum_smod
 = 50;

63 
moduË_·¿m
(
scsc_wifi_fcq_mšimum_smod
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

64 
MODULE_PARM_DESC
(
scsc_wifi_fcq_mšimum_smod
, "Initial value of minimum smod -…eer‚ormal (default = 50)");

66 
ušt
 
	gscsc_wifi_fcq_di¡ributiÚ_d–ay_ms
;

67 
moduË_·¿m
(
scsc_wifi_fcq_di¡ributiÚ_d–ay_ms
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

68 
MODULE_PARM_DESC
(
scsc_wifi_fcq_di¡ributiÚ_d–ay_ms
, "Distributionime in ms (default = 0)");

70 
	#SCSC_WIFI_FCQ_SMOD_RESUME_HYSTERESIS
 10

	)

71 
	#SCSC_WIFI_FCQ_QMOD_RESUME_HYSTERESIS
 10

	)

72 
	#SCSC_WIFI_FCQ_GMOD_RESUME_HYSTERESIS
 30

	)

75 
	#STOP_GUARD_GMOD
 10

	)

76 
	#STOP_GUARD_SMOD
 1

	)

77 
	#STOP_GUARD_QMOD
 2

	)

84 
	s³”s_ÿche
 {

85 
li¡_h—d
 
	mli¡
;

86 
Ãt_deviû
 *
	mdev
;

87 
	mvif
;

88 
	m³”_šdex
;

89 
scsc_wifi_fcq_d©a_q£t
 *
	mqs
;

90 
boŞ
 
	mis_uniÿ¡
;

93 
LIST_HEAD
(
³”s_ÿche_li¡
);

94 
DEFINE_SPINLOCK
(
³”s_ÿche_lock
);

99 
u32
 
	gac_q_Ïyout
[8][4] = {

113 
	#ENABLE_QCOD
 1

	)

114 #ià
IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

116 
	#DOMAINS
 3

	)

117 
	#DOMAIN_G
 0

	)

118 
	#DOMAIN_S
 1

	)

119 
	#DOMAIN_Q
 2

	)

121 
	#DIREC
 2

	)

122 
	#DIREC_TX
 0

	)

123 
	#DIREC_RX
 1

	)

125 
	#AC_Q
 4

	)

127 
	gtd
[
DIREC
][
DOMAINS
][
AC_Q
];

129 
šlše
 
	$fcq_upd©e_couÁ”s
(
dœeùiÚ
, 
domaš
, 
ac
)

131 
td
[
dœeùiÚ
][
domaš
][
ac
] =d[direction][domain][ac] + 1;

132 
	}
}

140 
	gtÙ®
;

142 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


144 
	gtÙ®_š_¦“p
;

147 
šlše
 
boŞ
 
	$is_gmod_aùive
(
¦si_dev
 *
sdev
)

149  
	`©omic_»ad
(&
sdev
->
h4_š¡
.
h_´iv
->
gaùive
);

150 
	}
}

152 
šlše
 
boŞ
 
	$is_smod_aùive
(
scsc_wifi_fcq_d©a_q£t
 *
qs
)

154  
	`©omic_»ad
(&
qs
->
aùive
);

155 
	}
}

157 
šlše
 
boŞ
 
	$is_qmod_aùive
(
scsc_wifi_fcq_d©a_q
 *
queue
)

159  
	`©omic_»ad
(&
queue
->
h—d
.
aùive
);

160 
	}
}

162 
šlše
 
boŞ
 
	$is_š_·u£
(
¦si_dev
 *
sdev
)

164  
	`©omic_»ad
(&
sdev
->
š_·u£_¡©e
);

165 
	}
}

167 
šlše
 
	$fcq_Ãtq_¡¬t_¡İ_§m¶e
(
scsc_wifi_fcq_q_h—d”
 *
queue
, 
boŞ
 
Ãw_¡©e
)

169 
scsc_wifi_fcq_q_¡©
 *
queue_¡©
;

170 
u32
 
d–_š_ms
 = 0;

172 ià(
	`WARN_ON
(!
queue
))

175 
queue_¡©
 = &
queue
->
¡©s
;

177 ià(
	`ktime_to_ms
(
queue_¡©
->
Ï¡_§m¶e_time
) == 0)

178 
queue_¡©
->
Ï¡_§m¶e_time
 = 
	`ktime_g‘
();

181 ià(
queue_¡©
->
Ãtq_¡©e
 =ğ
Ãw_¡©e
)

184 
queue_¡©
->
Ãtq_¡©e
 = 
Ãw_¡©e
;

190 ià(
Ãw_¡©e
)

191 
queue_¡©
->
Ãtq_¡İ_time_š_ms
 +ğ
	`ktime_to_ms
(
	`ktime_sub
(
	`ktime_g‘
(), queue_¡©->
Ï¡_¡İ_time
));

193 
queue_¡©
->
Ï¡_¡İ_time
 = 
	`ktime_g‘
();

196 ià(
	`ktime_to_ms
(
	`ktime_sub
(
	`ktime_g‘
(), 
queue_¡©
->
Ï¡_§m¶e_time
)) > 1000) {

198 
d–_š_ms
 = 
	`ktime_ms_d–
(
	`ktime_g‘
(), 
queue_¡©
->
Ï¡_§m¶e_time
);

201 ià(
d–_š_ms
 < 2000)

202 
queue_¡©
->
Ãtq_¡İ_³rûÁ
 = ((queue_¡©->
Ãtq_¡İ_time_š_ms
 * 100è/ 
d–_š_ms
);

204 
queue_¡©
->
Ãtq_¡İ_³rûÁ
 = 0;

206 
queue_¡©
->
Ãtq_¡İ_time_š_ms
 = 0;

207 
queue_¡©
->
Ï¡_§m¶e_time
 = 
	`ktime_g‘
();

209 
	}
}

212 
šlše
 
	$fcq_¡İ_®l_queues
(
¦si_dev
 *
sdev
)

214 
i
;

215 
³”s_ÿche
 *
pc_node
, *
Ãxt
;

216 
	`¥š_lock_bh
(&
³”s_ÿche_lock
);

217 
	`li¡_fÜ_—ch_’Œy_§ã
(
pc_node
, 
Ãxt
, &
³”s_ÿche_li¡
, 
li¡
) {

219 
i
 = 0; i < 
SLSI_NETIF_Q_PER_PEER
; i++) {

220 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "fcq_¡İ_®l_queue vià%d…“r_šdex %d‡ø%d\n", 
pc_node
->
vif
,…c_node->
³”_šdex
, 
i
);

221 
	`Ãtif_¡İ_subqueue
(
pc_node
->
dev
,…c_node->
qs
->
ac_q
[
i
].
h—d
.
Ãtif_queue_id
);

224 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

225 
	}
}

228 
šlše
 
	$fcq_wake_®l_queues
(
¦si_dev
 *
sdev
)

230 
i
;

231 
³”s_ÿche
 *
pc_node
, *
Ãxt
;

233 
	`¥š_lock_bh
(&
³”s_ÿche_lock
);

234 
	`li¡_fÜ_—ch_’Œy_§ã
(
pc_node
, 
Ãxt
, &
³”s_ÿche_li¡
, 
li¡
) {

236 
i
 = 0; i < 
SLSI_NETIF_Q_PER_PEER
; i++) {

237 ià(
	`is_gmod_aùive
(
sdev
è&& 
	`is_smod_aùive
(
pc_node
->
qs
è&& 
	`is_qmod_aùive
(&pc_node->qs->
ac_q
[
i
]è&& !
	`is_š_·u£
(sdev)) {

238 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "fcq_wake_®l_queue vià%d…“r_šdex %d‡ø%d\n", 
pc_node
->
vif
,…c_node->
³”_šdex
, 
i
);

239 
	`Ãtif_wake_subqueue
(
pc_node
->
dev
,…c_node->
qs
->
ac_q
[
i
].
h—d
.
Ãtif_queue_id
);

241 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "fcq_wake_®l_queue vià%d…“r_šdex %d‡ø%d‚Ù wok’ up!\n", 
pc_node
->
vif
,…c_node->
³”_šdex
, 
i
);

245 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

246 
	}
}

248 
	$scsc_wifi_fcq_·u£_queues
(
¦si_dev
 *
sdev
)

250 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Pause queues\n");

251 
	`©omic_£t
(&
sdev
->
š_·u£_¡©e
, 1);

252 
	`fcq_¡İ_®l_queues
(
sdev
);

253 
	}
}

255 
	$scsc_wifi_fcq_uÅau£_queues
(
¦si_dev
 *
sdev
)

257 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Unpause queues\n");

258 
	`©omic_£t
(&
sdev
->
š_·u£_¡©e
, 0);

259 
	`fcq_wake_®l_queues
(
sdev
);

260 
	}
}

262 #ifdeà
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL


263 
šlše
 
	$fcq_¡İ_¬p_q_®l_vif
(
¦si_dev
 *
sdev
)

265 
³”s_ÿche
 *
pc_node
, *
Ãxt
;

267 
	`¥š_lock_bh
(&
³”s_ÿche_lock
);

268 
	`li¡_fÜ_—ch_’Œy_§ã
(
pc_node
, 
Ãxt
, &
³”s_ÿche_li¡
, 
li¡
) {

269 
	`Ãtif_¡İ_subqueue
(
pc_node
->
dev
, 
SLSI_NETIF_Q_ARP
);

270 
	`SLSI_INFO
(
sdev
, "ARP_q stİ fÜ %s\n", 
pc_node
->
dev
->
Çme
);

272 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

273 
	}
}

275 
šlše
 
	$fcq_wake_¬p_q_®l_vif
(
¦si_dev
 *
sdev
)

277 
³”s_ÿche
 *
pc_node
, *
Ãxt
;

279 
	`¥š_lock_bh
(&
³”s_ÿche_lock
);

280 
	`li¡_fÜ_—ch_’Œy_§ã
(
pc_node
, 
Ãxt
, &
³”s_ÿche_li¡
, 
li¡
) {

281 
	`Ãtif_wake_subqueue
(
pc_node
->
dev
, 
SLSI_NETIF_Q_ARP
);

282 
	`SLSI_INFO
(
sdev
, "ARP_q wakfÜ %s\n", 
pc_node
->
dev
->
Çme
);

284 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

285 
	}
}

287 
	$scsc_wifi_·u£_¬p_q_®l_vif
(
¦si_dev
 *
sdev
)

289 ià(!
sdev
)

292 
	`SLSI_DBG1_NODEV
(
SLSI_WIFI_FCQ
, "Pause ARP queues\n");

293 
	`©omic_£t
(&
sdev
->
ù¾_·u£_¡©e
, 1);

294 
	`fcq_¡İ_¬p_q_®l_vif
(
sdev
);

295 
	}
}

297 
	$scsc_wifi_uÅau£_¬p_q_®l_vif
(
¦si_dev
 *
sdev
)

299 ià(!
sdev
)

302 
	`SLSI_DBG1_NODEV
(
SLSI_WIFI_FCQ
, "Unpause ARP queues\n");

303 
	`©omic_£t
(&
sdev
->
ù¾_·u£_¡©e
, 0);

304 
	`fcq_wake_¬p_q_®l_vif
(
sdev
);

305 
	}
}

308 #ifdeà
ENABLE_QCOD


313 
boŞ
 
	$fcq_»di¡ribu‹_qmod_befÜe_¡İpšg
(
scsc_wifi_fcq_d©a_q£t
 *
qs
)

315 
scsc_wifi_fcq_q_h—d”
 *
queue
;

316 
i
, 
j
;

317 
u32
 *
qmod_bË
;

318 
u32
 
v®
;

321 ià(
qs
->
ac_šu£
 == 1)

322  
çl£
;

325 
i
 = 1; i < 
SLSI_NETIF_Q_PER_PEER
; i++) {

326 
queue
 = &
qs
->
ac_q
[
i
].
h—d
;

327 ià(
queue
->
ÿn_be_di¡ribu‹d
 &&

328 (
	`ktime_com·»
(
	`ktime_g‘
(), 
	`ktime_add_ms
(
queue
->
em±y_t
, 
scsc_wifi_fcq_di¡ributiÚ_d–ay_ms
)) > 0)) {

330 
qs
->
ac_šu£
 &ğ~(1 << 
i
);

332 
queue
->
ÿn_be_di¡ribu‹d
 = 
çl£
;

333 
qmod_bË
 = &
ac_q_Ïyout
[
qs
->
ac_šu£
 >> 1][0];

334 
j
 = 0; j < 
SLSI_NETIF_Q_PER_PEER
; j++) {

335 
queue
 = &
qs
->
ac_q
[
j
].
h—d
;

336 
v®
 = (
	`©omic_»ad
(&
qs
->
smod
è* 
qmod_bË
[
SLSI_NETIF_Q_PER_PEER
 - 1 - 
j
]) / 1000;

337 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "D‘eùed‚Ú-aùivaøqueu(%d). Redi¡ribu‹ qmod[%d] %d qcod %d\n", 
i
, 
j
, 
v®
, 
	`©omic_»ad
(&
queue
->
qcod
));

338 
	`©omic_£t
(&
queue
->
qmod
, 
v®
);

340  
Œue
;

344  
çl£
;

345 
	}
}

347 
	$fcq_»di¡ribu‹_qmod
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
¦si_dev
 *
sdev
, 
u8
 
³”_šdex
, u8 
vif
)

349 
i
;

350 
scsc_wifi_fcq_q_h—d”
 *
queue_»dis
;

351 
u32
 *
qmod_bË
;

352 
u32
 
v®
;

354 
qmod_bË
 = &
ac_q_Ïyout
[
qs
->
ac_šu£
 >> 1][0];

355 
i
 = 0; i < 
SLSI_NETIF_Q_PER_PEER
; i++) {

356 
queue_»dis
 = &
qs
->
ac_q
[
i
].
h—d
;

357 
v®
 = (
	`©omic_»ad
(&
qs
->
smod
è* 
qmod_bË
[
SLSI_NETIF_Q_PER_PEER
 - 1 - 
i
]) / 1000;

358 
	`©omic_£t
(&
queue_»dis
->
qmod
, 
v®
);

359 #ifdeà
CLOSE_IN_OVERSHOOT


360 ià(
v®
 > 0) {

362 ià(
	`©omic_»ad
(&
queue_»dis
->
aùive
è&& (©omic_»ad(&queue_»dis->
qcod
è>ğ×tomic_»ad(&queue_»dis->
qmod
è- 
STOP_GUARD_QMOD
))) {

363 
	`Ãtif_¡İ_subqueue
(
dev
, 
queue_»dis
->
Ãtif_queue_id
);

364 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Closšg ov”shoÙ queufÜ vif: %d…“r: %d‡c: %d qcod (%dèqmod (%d)\n", 
vif
, 
³”_šdex
, 
i
, 
	`©omic_»ad
(&
queue_»dis
->
qcod
),‡tomic_»ad(&queue_»dis->
qmod
));

365 
	`©omic_£t
(&
queue_»dis
->
aùive
, 0);

369 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Redi¡ribu‹‚ew v®u%d: qmod[%d] %d qcod %d‡ùiv%d\n", 
v®
, 
i
, 
	`©omic_»ad
(&
queue_»dis
->
qmod
),‡tomic_»ad(&queue_»dis->
qcod
),‡tomic_»ad(&queue_»dis->
aùive
));

371 
	}
}

374 
	$fcq_»di¡ribu‹_smod
(
Ãt_deviû
 *
dev
, 
¦si_dev
 *
sdev
, 
tÙ®_to_di¡ribu‹
)

376 #ifdeà
CLOSE_IN_OVERSHOOT


377 
i
;

379 
u32
 
Ãw_smod
;

380 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


381 
g‘_tÙ®
 = 0;

383 
³”s_ÿche
 *
pc_node
, *
Ãxt
;

384 
scsc_wifi_fcq_d©a_q£t
 *
qs_»dis
;

389 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


390 
g‘_tÙ®
 = 
tÙ®_to_di¡ribu‹
 - 
tÙ®_š_¦“p
;

391 ià(
g‘_tÙ®
 > 0)

392 
Ãw_smod
 = 
scsc_wifi_fcq_smod
 / 
g‘_tÙ®
;

395 
Ãw_smod
 = 
scsc_wifi_fcq_smod
 / 
tÙ®
;

397 
Ãw_smod
 = 
scsc_wifi_fcq_smod
 / 
tÙ®_to_di¡ribu‹
;

400 ià(
Ãw_smod
 < 
scsc_wifi_fcq_mšimum_smod
)

401 
Ãw_smod
 = 
scsc_wifi_fcq_mšimum_smod
;

402 
	`¥š_lock_bh
(&
³”s_ÿche_lock
);

403 
	`li¡_fÜ_—ch_’Œy_§ã
(
pc_node
, 
Ãxt
, &
³”s_ÿche_li¡
, 
li¡
) {

404 ià(
pc_node
->
is_uniÿ¡
) {

405 
qs_»dis
 = 
pc_node
->
qs
;

406 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


407 ià(
qs_»dis
->
š_¦“p
)

408 
	`©omic_£t
(&
qs_»dis
->
smod
, 0);

410 
	`©omic_£t
(&
qs_»dis
->
smod
, 
Ãw_smod
);

412 
	`©omic_£t
(&
qs_»dis
->
smod
, 
Ãw_smod
);

414 #ifdeà
CLOSE_IN_OVERSHOOT


416 ià(
	`is_smod_aùive
(
qs_»dis
è&& 
	`©omic_»ad
(&qs_»dis->
scod
è>ğ×tomic_»ad(&qs_»dis->
smod
è- 
STOP_GUARD_SMOD
)) {

418 
i
 = 0; i < 
SLSI_NETIF_Q_PER_PEER
; i++)

419 
	`Ãtif_¡İ_subqueue
(
dev
, 
qs_»dis
->
ac_q
[
i
].
h—d
.
Ãtif_queue_id
);

420 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Closšg ov”shoÙ q fÜ vià%d…“r_šdex %d\n", 
pc_node
->
vif
,…c_node->
³”_šdex
);

421 
	`©omic_£t
(&
qs_»dis
->
aùive
, 0);

424 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


425 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Redi¡ribu‹d smod = %d fÜ vià%d…“r_šdex %dÙ® %dÙ®_š_¦“°%d\n", 
Ãw_smod
, 
pc_node
->
vif
,…c_node->
³”_šdex
, 
tÙ®_to_di¡ribu‹
, 
tÙ®_š_¦“p
);

427 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Redi¡ribu‹d smod = %d fÜ vià%d…“r_šdex %dÙ® %d\n", 
Ãw_smod
, 
pc_node
->
vif
,…c_node->
³”_šdex
, 
tÙ®_to_di¡ribu‹
);

430 
	`fcq_»di¡ribu‹_qmod
(
pc_node
->
dev
,…c_node->
qs
, 
sdev
,…c_node->
³”_šdex
,…c_node->
vif
);

433 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

434 
	}
}

436 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


437 
	$fcq_»di¡ribu‹_smod_befÜe_¡İpšg
(
Ãt_deviû
 *
dev
, 
¦si_dev
 *
sdev
, 
tÙ®_to_di¡ribu‹
)

439 
³”s_ÿche
 *
pc_node
, *
Ãxt
;

442 ià(
tÙ®_to_di¡ribu‹
 == 1)

443  
çl£
;

446 
	`¥š_lock_bh
(&
³”s_ÿche_lock
);

447 
	`li¡_fÜ_—ch_’Œy_§ã
(
pc_node
, 
Ãxt
, &
³”s_ÿche_li¡
, 
li¡
) {

448 ià(
pc_node
->
is_uniÿ¡
) {

449 ià(
pc_node
->
qs
->
ÿn_be_di¡ribu‹d
 &&

450 (
	`ktime_com·»
(
	`ktime_g‘
(), 
	`ktime_add_ms
(
pc_node
->
qs
->
em±y_t
, 5000)) > 0)) {

451 
pc_node
->
qs
->
š_¦“p
 = 
Œue
;

452 
tÙ®_š_¦“p
 += 1;

453 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Smod q em±y. Cª b»di¡ribu‹d fÜ vià%d…“r_šdex %d qs->ÿn_be_di¡ribu‹d %d\n", 
pc_node
->
vif
,…c_node->
³”_šdex
,…c_node->
qs
->
ÿn_be_di¡ribu‹d
);

454 
pc_node
->
qs
->
ÿn_be_di¡ribu‹d
 = 
çl£
;

455 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

456 
	`fcq_»di¡ribu‹_smod
(
dev
, 
sdev
, 
tÙ®_to_di¡ribu‹
);

457  
Œue
;

461 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

462  
çl£
;

463 
	}
}

466 
	$fcq_Œªsm™_gmod_domaš
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u16
 
´iÜ™y
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
)

468 
gcod
;

469 
gmod
;

471 
	`¥š_lock
(&
sdev
->
h4_š¡
.
h_´iv
->
gbÙ_lock
);

474 ià(
sdev
->
h4_š¡
.
h_´iv
->
§tu¿‹d
) {

475 #ià
	`IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

476 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "xxxxxxxxxxxxxxxxxxxxxxx Global domain. No space.‡ctive: %d vif: %d…eer: %d‡c: %d gcod (%d) gmod (%d) betx:%d berx:%d vitx:%d virx:%d votx:%d vorx:%d\n",

477 
	`©omic_»ad
(&
sdev
->
h4_š¡
.
h_´iv
->
gaùive
), 
vif
, 
³”_šdex
, 
´iÜ™y
,‡tomic_»ad(&sdev->h4_š¡.h_´iv->
gcod
),‡tomic_»ad(&sdev->h4_š¡.h_´iv->
gmod
),

478 
td
[
DIREC_TX
][
DOMAIN_G
][0],d[
DIREC_RX
][DOMAIN_G][0],d[DIREC_TX][DOMAIN_G][2],d[DIREC_RX][DOMAIN_G][2],d[DIREC_TX][DOMAIN_G][3],d[DIREC_RX][DOMAIN_G][3]);

479 
	`fcq_¡İ_®l_queues
(
sdev
);

481 
	`¥š_uÆock
(&
sdev
->
h4_š¡
.
h_´iv
->
gbÙ_lock
);

482  -
ENOSPC
;

485 ià(!
	`©omic_»ad
(&
sdev
->
h4_š¡
.
h_´iv
->
gaùive
è&& sdev->h4_š¡.h_´iv->
gu¬d
-- == 0) {

486 #ià
	`IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

487 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "xxxxxxxxxxxxxxxxxxxxxxx Global domain. Saturating Gmod.‡ctive: %d vif: %d…eer: %d‡c: %d gcod (%d) gmod (%d) betx:%d berx:%d vitx:%d virx:%d votx:%d vorx:%d\n",

488 
	`©omic_»ad
(&
sdev
->
h4_š¡
.
h_´iv
->
gaùive
), 
vif
, 
³”_šdex
, 
´iÜ™y
,‡tomic_»ad(&sdev->h4_š¡.h_´iv->
gcod
),‡tomic_»ad(&sdev->h4_š¡.h_´iv->
gmod
),

489 
td
[
DIREC_TX
][
DOMAIN_G
][0],d[
DIREC_RX
][DOMAIN_G][0],d[DIREC_TX][DOMAIN_G][2],d[DIREC_RX][DOMAIN_G][2],d[DIREC_TX][DOMAIN_G][3],d[DIREC_RX][DOMAIN_G][3]);

491 
sdev
->
h4_š¡
.
h_´iv
->
§tu¿‹d
 = 
Œue
;

494 
gmod
 = 
	`©omic_»ad
(&
sdev
->
h4_š¡
.
h_´iv
->gmod);

495 
gcod
 = 
	`©omic_šc_»tuº
(&
sdev
->
h4_š¡
.
h_´iv
->gcod);

496 #ià
	`IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

497 
	`fcq_upd©e_couÁ”s
(
DIREC_TX
, 
DOMAIN_G
, 
´iÜ™y
);

498 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "tx:‡ctive: %d vif: %d…eer: %d‡c: %d gcod (%d) gmod (%d) betx:%d berx:%d vitx:%d virx:%d votx:%d vorx:%d\n",

499 
	`©omic_»ad
(&
sdev
->
h4_š¡
.
h_´iv
->
gaùive
), 
vif
, 
³”_šdex
, 
´iÜ™y
, 
gcod
, 
gmod
,

500 
td
[
DIREC_TX
][
DOMAIN_G
][0],d[
DIREC_RX
][DOMAIN_G][0],d[DIREC_TX][DOMAIN_G][2],d[DIREC_RX][DOMAIN_G][2],d[DIREC_TX][DOMAIN_G][3],d[DIREC_RX][DOMAIN_G][3]);

502 ià(
gcod
 >ğ(
	`©omic_»ad
(&
sdev
->
h4_š¡
.
h_´iv
->
gmod
è- 
STOP_GUARD_GMOD
)) {

503 
	`fcq_¡İ_®l_queues
(
sdev
);

504 ià(
	`©omic_»ad
(&
sdev
->
h4_š¡
.
h_´iv
->
gaùive
)) {

505 
sdev
->
h4_š¡
.
h_´iv
->
gu¬d
 = 
STOP_GUARD_GMOD
;

507 ià(
sdev
->
h4_š¡
.
h_´iv
->
gu¬d
 == 0)

508 
sdev
->
h4_š¡
.
h_´iv
->
§tu¿‹d
 = 
Œue
;

510 
	`©omic_£t
(&
sdev
->
h4_š¡
.
h_´iv
->
gaùive
, 0);

511 
	`SCSC_HIP4_SAMPLER_BOT_STOP_Q
(
sdev
->
mšÜ_´of
, 
vif
, 
³”_šdex
);

512 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Glob® Queue Stİ³d. gcod (%dè>ğgmod (%dègaùive(%d)\n", 
gcod
, 
gmod
, 
	`©omic_»ad
(&
sdev
->
h4_š¡
.
h_´iv
->
gaùive
));

514 
	`¥š_uÆock
(&
sdev
->
h4_š¡
.
h_´iv
->
gbÙ_lock
);

517 
	}
}

520 
	$fcq_Œªsm™_smod_domaš
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u16
 
´iÜ™y
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
)

522 
scod
;

524 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


525 ià(
qs
->
š_¦“p
) {

527 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Detected‡ctivity in sleep Qs‡ctive %d vif: %d…eer: %d‡c: %d\n",

528 
	`©omic_»ad
(&
qs
->
aùive
), 
vif
, 
³”_šdex
, 
´iÜ™y
);

530 
qs
->
š_¦“p
 = 
çl£
;

531 ià(
tÙ®_š_¦“p
)

532 
tÙ®_š_¦“p
 -= 1;

533 
	`fcq_»di¡ribu‹_smod
(
dev
, 
sdev
, 
tÙ®
);

536 
qs
->
ÿn_be_di¡ribu‹d
 = 
çl£
;

539 ià(
qs
->
§tu¿‹d
) {

540 
i
;

542 #ià
	`IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

543 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "xxxxxxxxxxxxxxxxxxxxxxx Smod domain. No space.‡ctive %d vif: %d…eer: %d‡c: %d scod (%d) smod (%d) betx:%d berx:%d vitx:%d virx:%d votx:%d vorx:%d\n",

544 
	`©omic_»ad
(&
qs
->
aùive
), 
vif
, 
³”_šdex
, 
´iÜ™y
,‡tomic_»ad(&qs->
scod
),‡tomic_»ad(&qs->
smod
),

545 
td
[
DIREC_TX
][
DOMAIN_S
][0],d[
DIREC_RX
][DOMAIN_S][0],d[DIREC_TX][DOMAIN_S][2],d[DIREC_RX][DOMAIN_S][2],d[DIREC_TX][DOMAIN_S][3],d[DIREC_RX][DOMAIN_S][3]);

549 
i
 = 0; i < 
SLSI_NETIF_Q_PER_PEER
; i++)

550 
	`Ãtif_¡İ_subqueue
(
dev
, 
qs
->
ac_q
[
i
].
h—d
.
Ãtif_queue_id
);

552  -
ENOSPC
;

555 ià(!
	`©omic_»ad
(&
qs
->
aùive
è&& (qs->
gu¬d
-- == 0)) {

556 #ià
	`IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

557 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "xxxxxxxxxxxxxxxxxxxxxxx Smod domain. Going into Saturation.‡ctive %d vif: %d…eer: %d‡c: %d scod (%d) smod (%d) betx:%d berx:%d vitx:%d virx:%d votx:%d vorx:%d\n",

558 
	`©omic_»ad
(&
qs
->
aùive
), 
vif
, 
³”_šdex
, 
´iÜ™y
,‡tomic_»ad(&qs->
scod
),‡tomic_»ad(&qs->
smod
),

559 
td
[
DIREC_TX
][
DOMAIN_S
][0],d[
DIREC_RX
][DOMAIN_S][0],d[DIREC_TX][DOMAIN_S][2],d[DIREC_RX][DOMAIN_S][2],d[DIREC_TX][DOMAIN_S][3],d[DIREC_RX][DOMAIN_S][3]);

561 
qs
->
§tu¿‹d
 = 
Œue
;

563 
scod
 = 
	`©omic_šc_»tuº
(&
qs
->scod);

564 
	`SCSC_HIP4_SAMPLER_BOT_TX
(
sdev
->
mšÜ_´of
, 
vif
, 
³”_šdex
, 
´iÜ™y
, (
	`©omic_»ad
(&
qs
->
smod
è<< 16è| (
scod
 & 0xFFFF));

565 #ià
	`IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

566 
	`fcq_upd©e_couÁ”s
(
DIREC_TX
, 
DOMAIN_S
, 
´iÜ™y
);

567 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "tx:‡ctive: %d vif: %d…eer: %d‡c: %d scod (%d) smod (%d) betx:%d berx:%d vitx:%d virx:%d votx:%d vorx:%d\n",

568 
	`©omic_»ad
(&
qs
->
aùive
), 
vif
, 
³”_šdex
, 
´iÜ™y
,‡tomic_»ad(&qs->
scod
),‡tomic_»ad(&qs->
smod
),

569 
td
[
DIREC_TX
][
DOMAIN_S
][0],d[
DIREC_RX
][DOMAIN_S][0],d[DIREC_TX][DOMAIN_S][2],d[DIREC_RX][DOMAIN_S][2],d[DIREC_TX][DOMAIN_S][3],d[DIREC_RX][DOMAIN_S][3]);

571 ià(
scod
 >ğ(
	`©omic_»ad
(&
qs
->
smod
è- 
STOP_GUARD_SMOD
)) {

572 
i
;

573 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


575 ià(
	`fcq_»di¡ribu‹_smod_befÜe_¡İpšg
(
dev
, 
sdev
, 
tÙ®
)) {

576 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Sk³d Stİ vif: %d…“r: %d. scod (%dè>ğsmod (%d)\n", 
vif
, 
³”_šdex
, 
	`©omic_»ad
(&
qs
->
scod
),‡tomic_»ad(&qs->
smod
));

580 
i
 = 0; i < 
SLSI_NETIF_Q_PER_PEER
; i++)

581 
	`Ãtif_¡İ_subqueue
(
dev
, 
qs
->
ac_q
[
i
].
h—d
.
Ãtif_queue_id
);

583 ià(
	`©omic_»ad
(&
qs
->
aùive
)) {

584 
qs
->
gu¬d
 = 
STOP_GUARD_SMOD
;

586 ià(
qs
->
gu¬d
 == 0)

587 
qs
->
§tu¿‹d
 = 
Œue
;

589 
	`©omic_£t
(&
qs
->
aùive
, 0);

590 
qs
->
¡©s
.
Ãtq_¡İs
++;

591 
	`SCSC_HIP4_SAMPLER_BOT_STOP_Q
(
sdev
->
mšÜ_´of
, 
vif
, 
³”_šdex
);

592 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Smod Queue Stİ³d vif: %d…“r: %d. scod (%dè>ğsmod (%d)\n", 
vif
, 
³”_šdex
, 
	`©omic_»ad
(&
qs
->
scod
),‡tomic_»ad(&qs->
smod
));

595 
	}
}

597 #ià
defšed
(
ENABLE_CTRL_FCQ
è|| defšed(
ENABLE_QCOD
)

599 
	$fcq_Œªsm™_qmod_domaš
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
¦si_dev
 *
sdev
, 
u16
 
´iÜ™y
, 
u8
 
³”_šdex
, u8 
vif
)

601 
scsc_wifi_fcq_q_h—d”
 *
queue
;

602 
qcod
;

604 
queue
 = &
qs
->
ac_q
[
´iÜ™y
].
h—d
;

606 ià(!(
qs
->
ac_šu£
 & (1 << 
´iÜ™y
))) {

607 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "New AC d‘eùed: %d\n", 
´iÜ™y
);

608 
qs
->
ac_šu£
 |ğ(1 << 
´iÜ™y
);

609 
	`fcq_»di¡ribu‹_qmod
(
dev
, 
qs
, 
sdev
, 
³”_šdex
, 
vif
);

610 
queue
->
ÿn_be_di¡ribu‹d
 = 
çl£
;

613 ià(
queue
->
§tu¿‹d
) {

614 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "xxxxxxxxxxxxxxxxxxxxxxx NØ¥aû iÀac: %d\n", 
´iÜ™y
);

616 
	`Ãtif_¡İ_subqueue
(
dev
, 
queue
->
Ãtif_queue_id
);

617  -
ENOSPC
;

621 ià(!
	`©omic_»ad
(&
queue
->
aùive
è&& (queue->
gu¬d
-- == 0)) {

622 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "xxxxxxxxxxxxxxxxxxxxxxx NØ¥aû iÀac: %d S©u¿‹d\n", 
´iÜ™y
);

623 
queue
->
§tu¿‹d
 = 
Œue
;

626 
qcod
 = 
	`©omic_šc_»tuº
(&
queue
->qcod);

627 
	`SCSC_HIP4_SAMPLER_BOT_QMOD_TX
(
sdev
->
mšÜ_´of
, 
vif
, 
³”_šdex
, 
´iÜ™y
, (
	`©omic_»ad
(&
queue
->
qmod
è<< 16è| (
qcod
 & 0xFFFF));

628 #ià
	`IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

629 
	`fcq_upd©e_couÁ”s
(
DIREC_TX
, 
DOMAIN_Q
, 
´iÜ™y
);

630 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "tx:‡ctive: %d vif: %d…eer: %d‡c: %d qcod (%d) qmod (%d) betx:%d berx:%d vitx:%d virx:%d votx:%d vorx:%d\n",

631 
	`©omic_»ad
(&
queue
->
aùive
), 
vif
, 
³”_šdex
, 
´iÜ™y
,‡tomic_»ad(&queue->
qcod
),‡tomic_»ad(&queue->
qmod
),

632 
td
[
DIREC_TX
][
DOMAIN_Q
][0],d[
DIREC_RX
][DOMAIN_Q][0],d[DIREC_TX][DOMAIN_Q][2],d[DIREC_RX][DOMAIN_Q][2],d[DIREC_TX][DOMAIN_Q][3],d[DIREC_RX][DOMAIN_Q][3]);

634 ià(
	`©omic_»ad
(&
queue
->
aùive
è&& 
qcod
 >ğ×tomic_»ad(&queue->
qmod
è- 
STOP_GUARD_QMOD
)) {

636 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


637 ià(
	`fcq_»di¡ribu‹_smod_befÜe_¡İpšg
(
dev
, 
sdev
, 
tÙ®
)) {

638 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Sk³d Stİ vif: %d…“r: %d. scod (%dè>ğsmod (%d)\n", 
vif
, 
³”_šdex
, 
	`©omic_»ad
(&
qs
->
scod
),‡tomic_»ad(&qs->
smod
));

639 
sk_¡İ
;

642 ià(
	`fcq_»di¡ribu‹_qmod_befÜe_¡İpšg
(
qs
))

643 
sk_¡İ
;

644 
	`SCSC_HIP4_SAMPLER_BOT_QMOD_STOP
(
sdev
->
mšÜ_´of
, 
vif
, 
³”_šdex
, 
´iÜ™y
);

645 
	`SLSI_DBG1_NODEV
(
SLSI_WIFI_FCQ
, "Stİ subqueuvif: %d…“r: %d‡c: %d qcod (%dèqmod (%d)\n", 
vif
, 
³”_šdex
, 
´iÜ™y
, 
	`©omic_»ad
(&
queue
->
qcod
),‡tomic_»ad(&queue->
qmod
));

646 ià(
	`©omic_»ad
(&
queue
->
aùive
)) {

647 
queue
->
gu¬d
 = 
STOP_GUARD_QMOD
;

649 ià(
queue
->
gu¬d
 == 0)

650 
queue
->
§tu¿‹d
 = 
Œue
;

652 
	`©omic_£t
(&
queue
->
aùive
, 0);

653 
	`Ãtif_¡İ_subqueue
(
dev
, 
queue
->
Ãtif_queue_id
);

654 
queue
->
¡©s
.
Ãtq_¡İs
++;

655 
	`fcq_Ãtq_¡¬t_¡İ_§m¶e
(
queue
, 0);

657 
sk_¡İ
:

659 
	}
}

662 
	$scsc_wifi_fcq_Œªsm™_ù¾
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_ù¾_q
 *
queue
)

664 
rc
 = 0;

666 #ifdeà
ENABLE_CTRL_FCQ


667 ià(
	`WARN_ON
(!
dev
))

668  -
EINVAL
;

670 ià(
	`WARN_ON
(!
queue
))

671  -
EINVAL
;

673 
rc
 = 
	`fcq_Œªsm™_qmod_domaš
(
dev
, &
queue
->
h—d
);

675  
rc
;

676 
	}
}

678 
	$scsc_wifi_fcq_Œªsm™_d©a
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u16
 
´iÜ™y
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
)

680 
rc
;

681 
³”s_ÿche
 *
pc_node
, *
Ãxt
;

683 ià(
	`WARN_ON
(!
dev
))

684  -
EINVAL
;

686 ià(
	`WARN_ON
(!
qs
))

687  -
EINVAL
;

689 ià(
	`WARN_ON
(
´iÜ™y
 >ğ
	`ARRAY_SIZE
(
qs
->
ac_q
)))

690  -
EINVAL
;

692 
	`¥š_lock_bh
(&
qs
->
ı_lock
);

694 
	`¥š_lock_bh
(&
³”s_ÿche_lock
);

695 
	`li¡_fÜ_—ch_’Œy_§ã
(
pc_node
, 
Ãxt
, &
³”s_ÿche_li¡
, 
li¡
) {

696 ià(
pc_node
->
qs
 =ğq &&…c_node->
³”_šdex
 ==…eer_index &&

697 
pc_node
->
vif
 =ğvià&&…c_node->
dev
 == dev) {

698 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

699 
found
;

702 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

703 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Packet dropped. Detected incorrect…eer„ecord\n");

704 
	`¥š_uÆock_bh
(&
qs
->
ı_lock
);

705  -
EINVAL
;

706 
found
:

708 ià(
qs
->
cÚŒŞËd_pÜt_¡©e
 =ğ
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
) {

709 
	`SLSI_DBG1_NODEV
(
SLSI_WIFI_FCQ
, "8021x_STATE_BLOCKED\n");

710 
	`¥š_uÆock_bh
(&
qs
->
ı_lock
);

711  -
EPERM
;

713 
rc
 = 
	`fcq_Œªsm™_gmod_domaš
(
dev
, 
qs
, 
´iÜ™y
, 
sdev
, 
vif
, 
³”_šdex
);

714 ià(
rc
) {

715 
	`¥š_uÆock_bh
(&
qs
->
ı_lock
);

716  
rc
;

719 
rc
 = 
	`fcq_Œªsm™_smod_domaš
(
dev
, 
qs
, 
´iÜ™y
, 
sdev
, 
vif
, 
³”_šdex
);

720 ià(
rc
) {

726 
	`©omic_dec
(&
sdev
->
h4_š¡
.
h_´iv
->
gcod
);

727 
	`¥š_uÆock_bh
(&
qs
->
ı_lock
);

728  
rc
;

731 #ifdeà
ENABLE_QCOD


732 
rc
 = 
	`fcq_Œªsm™_qmod_domaš
(
dev
, 
qs
, 
sdev
, 
´iÜ™y
, 
³”_šdex
, 
vif
);

733 ià(
rc
) {

739 
	`©omic_dec
(&
qs
->
scod
);

740 
	`©omic_dec
(&
sdev
->
h4_š¡
.
h_´iv
->
gcod
);

741 
	`¥š_uÆock_bh
(&
qs
->
ı_lock
);

742 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "xxxxxxxxxxxxxxxxxxxxxxx scsc_wifi_fcq_transmit_data: Flow control‚ot„espected. Packet will be dropped.\n");

743  
rc
;

747 
	`¥š_uÆock_bh
(&
qs
->
ı_lock
);

749 
	}
}

751 
	$fcq_»ûive_gmod_domaš
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
¦si_dev
 *
sdev
, 
u16
 
´iÜ™y
, 
u8
 
³”_šdex
, u8 
vif
)

753 
gcod
;

754 
gmod
;

755 
gaùive
;

757 
	`¥š_lock
(&
sdev
->
h4_š¡
.
h_´iv
->
gbÙ_lock
);

759 
gmod
 = 
	`©omic_»ad
(&
sdev
->
h4_š¡
.
h_´iv
->gmod);

760 
gcod
 = 
	`©omic_dec_»tuº
(&
sdev
->
h4_š¡
.
h_´iv
->gcod);

761 
gaùive
 = 
	`©omic_»ad
(&
sdev
->
h4_š¡
.
h_´iv
->gactive);

762 ià(
	`uÆik–y
(
gcod
 < 0)) {

763 
	`©omic_£t
(&
sdev
->
h4_š¡
.
h_´iv
->
gcod
, 0);

764 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "xxxxxxxxxxxxxxxxxxxxxxx scsc_wifi_fcq_receive: gcod is‚egative. Has been fixed\n");

767 #ià
	`IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

768 
	`fcq_upd©e_couÁ”s
(
DIREC_RX
, 
DOMAIN_G
, 
´iÜ™y
);

769 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "rx:‡ctive: %d vif: %d…eer: %d‡c: %d gcod (%d) gmod (%d) betx:%d berx:%d vitx:%d virx:%d votx:%d vorx:%d %s\n",

770 
gaùive
, 
vif
, 
³”_šdex
, 
´iÜ™y
, 
gcod
, 
gmod
,

771 
td
[
DIREC_TX
][
DOMAIN_G
][0],d[
DIREC_RX
][DOMAIN_G][0],d[DIREC_TX][DOMAIN_G][2],d[DIREC_RX][DOMAIN_G][2],d[DIREC_TX][DOMAIN_G][3],d[DIREC_RX][DOMAIN_G][3], 
qs
 ? "" : "NO PEER");

774 ià(!
	`is_gmod_aùive
(
sdev
è&& (
gcod
 + 
SCSC_WIFI_FCQ_GMOD_RESUME_HYSTERESIS
 / 
tÙ®
 < 
gmod
)) {

775 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Glob® Queue S¹ed. gcod (%dè< gmod (%d)\n", 
gcod
, 
gmod
);

776 
sdev
->
h4_š¡
.
h_´iv
->
§tu¿‹d
 = 
çl£
;

777 
	`©omic_£t
(&
sdev
->
h4_š¡
.
h_´iv
->
gaùive
, 1);

778 
	`fcq_wake_®l_queues
(
sdev
);

780 
	`¥š_uÆock
(&
sdev
->
h4_š¡
.
h_´iv
->
gbÙ_lock
);

783 
	}
}

785 
	$fcq_»ûive_smod_domaš
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
¦si_dev
 *
sdev
, 
u16
 
´iÜ™y
, 
u8
 
³”_šdex
, u8 
vif
)

787 
scod
;

789 
scod
 = 
	`©omic_dec_»tuº
(&
qs
->scod);

790 ià(
	`uÆik–y
(
scod
 < 0)) {

791 
	`©omic_£t
(&
qs
->
scod
, 0);

792 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "xxxxxxxxxxxxxxxxxxxxxxx scsc_wifi_fcq_receive: scod is‚egative. Has been fixed\n");

795 #ià
	`IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

796 
	`fcq_upd©e_couÁ”s
(
DIREC_RX
, 
DOMAIN_S
, 
´iÜ™y
);

797 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "rx:‡ctive: %d vif: %d…eer: %d‡c: %d scod (%d) smod (%d) betx:%d berx:%d vitx:%d virx:%d votx:%d vorx:%d\n",

798 
	`©omic_»ad
(&
qs
->
aùive
), 
vif
, 
³”_šdex
, 
´iÜ™y
,‡tomic_»ad(&qs->
scod
),‡tomic_»ad(&qs->
smod
),

799 
td
[
DIREC_TX
][
DOMAIN_S
][0],d[
DIREC_RX
][DOMAIN_S][0],d[DIREC_TX][DOMAIN_S][2],d[DIREC_RX][DOMAIN_S][2],d[DIREC_TX][DOMAIN_S][3],d[DIREC_RX][DOMAIN_S][3]);

801 
	`SCSC_HIP4_SAMPLER_BOT_RX
(
sdev
->
mšÜ_´of
, 
vif
, 
³”_šdex
, 
´iÜ™y
, (
	`©omic_»ad
(&
qs
->
smod
è<< 16è| (
scod
 & 0xFFFF));

802 ià(!
	`is_smod_aùive
(
qs
è&& (
scod
 + 
SCSC_WIFI_FCQ_SMOD_RESUME_HYSTERESIS
 / 
tÙ®
 < 
	`©omic_»ad
(&qs->
smod
))) {

803 
i
;

805 
i
 = 0; i < 
SLSI_NETIF_Q_PER_PEER
; i++) {

806 ià(
	`is_gmod_aùive
(
sdev
è&& 
	`is_qmod_aùive
(&
qs
->
ac_q
[
i
]è&& !
	`is_š_·u£
(sdev))

807 
	`Ãtif_wake_subqueue
(
dev
, 
qs
->
ac_q
[
i
].
h—d
.
Ãtif_queue_id
);

809 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "smod wakvià%d…“r_šdex %d‡ø%d‚Ù wok’ up!\n", 
vif
, 
³”_šdex
, 
i
);

812 
	`SCSC_HIP4_SAMPLER_BOT_START_Q
(
sdev
->
mšÜ_´of
, 
vif
, 
³”_šdex
);

813 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Smod Queue S¹ed vif: %d…“r: %d. scod (%dè>ğsmod (%d)\n", 
vif
, 
³”_šdex
, 
	`©omic_»ad
(&
qs
->
scod
),‡tomic_»ad(&qs->
smod
));

815 
qs
->
§tu¿‹d
 = 
çl£
;

816 
	`©omic_£t
(&
qs
->
aùive
, 1);

817 
qs
->
¡©s
.
Ãtq_»sumes
++;

820 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


821 ià(
scod
 == 0) {

823 
qs
->
em±y_t
 = 
	`ktime_g‘
();

824 
qs
->
ÿn_be_di¡ribu‹d
 = 
Œue
;

825 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Q em±y vif: %d…“r: %d\n", 
vif
, 
³”_šdex
);

827 
qs
->
ÿn_be_di¡ribu‹d
 = 
çl£
;

831 
	}
}

833 #ifdeà
ENABLE_QCOD


834 
	$fcq_»ûive_qmod_domaš
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
¦si_dev
 *
sdev
, 
u16
 
´iÜ™y
, 
u8
 
³”_šdex
, u8 
vif
)

836 
scsc_wifi_fcq_q_h—d”
 *
queue
;

837 
qcod
;

839 
queue
 = &
qs
->
ac_q
[
´iÜ™y
].
h—d
;

841 
qcod
 = 
	`©omic_dec_»tuº
(&
queue
->qcod);

842 ià(
	`uÆik–y
(
qcod
 < 0)) {

843 
	`©omic_£t
(&
queue
->
qcod
, 0);

844 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "xxxxxxxxxxxxxxxxxxxxxxx fcq_receive_qmod_domain: qcod is‚egative. Has been fixed\n");

847 #ià
	`IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

848 
	`fcq_upd©e_couÁ”s
(
DIREC_RX
, 
DOMAIN_Q
, 
´iÜ™y
);

849 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "rx:‡ctive: %d vif: %d…eer: %d‡c: %d qcod (%d) qmod (%d) betx:%d berx:%d vitx:%d virx:%d votx:%d vorx:%d\n",

850 
	`©omic_»ad
(&
queue
->
aùive
), 
vif
, 
³”_šdex
, 
´iÜ™y
,‡tomic_»ad(&queue->
qcod
),‡tomic_»ad(&queue->
qmod
),

851 
td
[
DIREC_TX
][
DOMAIN_Q
][0],d[
DIREC_RX
][DOMAIN_Q][0],d[DIREC_TX][DOMAIN_Q][2],d[DIREC_RX][DOMAIN_Q][2],d[DIREC_TX][DOMAIN_Q][3],d[DIREC_RX][DOMAIN_Q][3]);

853 
	`SCSC_HIP4_SAMPLER_BOT_QMOD_RX
(
sdev
->
mšÜ_´of
, 
vif
, 
³”_šdex
, 
´iÜ™y
, (
	`©omic_»ad
(&
queue
->
qmod
è<< 16è| (
qcod
 & 0xFFFF));

855 ià(!
	`is_qmod_aùive
(&
qs
->
ac_q
[
´iÜ™y
]è&& ((
qcod
 + 
SCSC_WIFI_FCQ_QMOD_RESUME_HYSTERESIS
 / 
tÙ®
è< 
	`©omic_»ad
(&
queue
->
qmod
))) {

857 ià(
	`is_gmod_aùive
(
sdev
è&& 
	`is_smod_aùive
(
qs
è&& !
	`is_š_·u£
(sdev))

858 
	`Ãtif_wake_subqueue
(
dev
, 
queue
->
Ãtif_queue_id
);

860 
	`SCSC_HIP4_SAMPLER_BOT_QMOD_START
(
sdev
->
mšÜ_´of
, 
vif
, 
³”_šdex
, 
´iÜ™y
);

861 
	`SLSI_DBG1_NODEV
(
SLSI_WIFI_FCQ
, "S¹ subqueuvif: %d…“r: %d‡c: %d qcod (%dèqmod (%d)\n", 
vif
, 
³”_šdex
, 
´iÜ™y
, 
	`©omic_»ad
(&
queue
->
qcod
),‡tomic_»ad(&queue->
qmod
));

862 
queue
->
¡©s
.
Ãtq_»sumes
++;

864 
queue
->
§tu¿‹d
 = 
çl£
;

865 
	`©omic_£t
(&
queue
->
aùive
, 1);

866 
	`fcq_Ãtq_¡¬t_¡İ_§m¶e
(
queue
, 1);

870 ià(
qcod
 =ğ0 && 
´iÜ™y
 !ğ
SLSI_TRAFFIC_Q_BE
) {

872 
queue
->
em±y_t
 = 
	`ktime_g‘
();

873 
queue
->
ÿn_be_di¡ribu‹d
 = 
Œue
;

875 
queue
->
ÿn_be_di¡ribu‹d
 = 
çl£
;

878 
	}
}

881 
	$scsc_wifi_fcq_»ûive_ù¾
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_ù¾_q
 *
queue
)

883 ià(
	`WARN_ON
(!
dev
))

884  -
EINVAL
;

886 ià(
	`WARN_ON
(!
queue
))

887  -
EINVAL
;

889 #ifdeà
ENABLE_CTRL_FCQ


893 
	}
}

896 
	$scsc_wifi_fcq_»ûive_d©a_no_³”
(
Ãt_deviû
 *
dev
, 
u16
 
´iÜ™y
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
)

898 
	`fcq_»ûive_gmod_domaš
(
dev
, 
NULL
, 
sdev
, 
´iÜ™y
, 
³”_šdex
, 
vif
);

899 #ià
	`IS_ENABLED
(
CONFIG_SCSC_DEBUG
)

901 
	`fcq_upd©e_couÁ”s
(
DIREC_RX
, 
DOMAIN_S
, 
´iÜ™y
);

902 
	`fcq_upd©e_couÁ”s
(
DIREC_RX
, 
DOMAIN_Q
, 
´iÜ™y
);

905 
	}
}

907 
	$scsc_wifi_fcq_»ûive_d©a
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u16
 
´iÜ™y
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
)

909 
rc
 = 0;

911 ià(
	`WARN_ON
(!
dev
))

912  -
EINVAL
;

914 ià(
	`WARN_ON
(!
qs
))

915  -
EINVAL
;

917 ià(
	`WARN_ON
(
´iÜ™y
 >ğ
	`ARRAY_SIZE
(
qs
->
ac_q
)))

918  -
EINVAL
;

921 
	`¥š_lock_bh
(&
qs
->
ı_lock
);

923 
rc
 = 
	`fcq_»ûive_gmod_domaš
(
dev
, 
qs
, 
sdev
, 
´iÜ™y
, 
³”_šdex
, 
vif
);

924 ià(
rc
)

925 
’d
;

927 
rc
 = 
	`fcq_»ûive_smod_domaš
(
dev
, 
qs
, 
sdev
, 
´iÜ™y
, 
³”_šdex
, 
vif
);

928 ià(
rc
)

929 
’d
;

931 #ifdeà
ENABLE_QCOD


932 
rc
 = 
	`fcq_»ûive_qmod_domaš
(
dev
, 
qs
, 
sdev
, 
´iÜ™y
, 
³”_šdex
, 
vif
);

934 
’d
:

935 
	`¥š_uÆock_bh
(&
qs
->
ı_lock
);

936  
rc
;

937 
	}
}

939 
	$scsc_wifi_fcq_upd©e_smod
(
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
scsc_wifi_fcq_ps_¡©e
 
³”_ps_¡©e
,

940 
scsc_wifi_fcq_queue_£t_ty³
 
ty³
)

942 ià(
	`WARN_ON
(!
qs
))

943  -
EINVAL
;

945 ià(
³”_ps_¡©e
 =ğ
SCSC_WIFI_FCQ_PS_STATE_POWERSAVE
) {

946 
	`©omic_£t
(&
qs
->
smod
, 
ty³
 =ğ
SCSC_WIFI_FCQ_QUEUE_SET_TYPE_UNICAST
 ? 
scsc_wifi_fcq_smod_pow”
 : 
scsc_wifi_fcq_mÿ¡_smod_pow”
);

947 
qs
->
³”_ps_¡©e
 =…eer_ps_state;

948 
qs
->
³”_ps_¡©e_Œªs™iÚs
++;

949 } ià(
³”_ps_¡©e
 =ğ
SCSC_WIFI_FCQ_PS_STATE_ACTIVE
) {

950 
	`©omic_£t
(&
qs
->
smod
, 
ty³
 =ğ
SCSC_WIFI_FCQ_QUEUE_SET_TYPE_UNICAST
 ? 
scsc_wifi_fcq_smod
 : 
scsc_wifi_fcq_mÿ¡_smod
);

951 
qs
->
³”_ps_¡©e
 =…eer_ps_state;

952 
qs
->
³”_ps_¡©e_Œªs™iÚs
++;

954 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Unknown sta_state %d\n",

955 
³”_ps_¡©e
);

958 
	}
}

960 
	$scsc_wifi_fcq_8021x_pÜt_¡©e
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
scsc_wifi_fcq_8021x_¡©e
 
¡©e
)

962 ià(
	`WARN_ON
(!
dev
))

963  -
EINTR
;

965 ià(
	`WARN_ON
(!
qs
))

966  -
EINVAL
;

968 
	`¥š_lock_bh
(&
qs
->
ı_lock
);

969 
qs
->
cÚŒŞËd_pÜt_¡©e
 = 
¡©e
;

970 
	`¥š_uÆock_bh
(&
qs
->
ı_lock
);

971 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_WIFI_FCQ
, "802.1x: Queu£ˆ0x%°i %s\n", 
qs
,

972 
¡©e
 =ğ
SCSC_WIFI_FCQ_8021x_STATE_OPEN
 ? "Open" : "Blocked");

974 
	}
}

979 
	$scsc_wifi_fcq_¡©_queue
(
scsc_wifi_fcq_q_h—d”
 *
queue
,

980 
scsc_wifi_fcq_q_¡©
 *
queue_¡©
,

981 *
qmod
, *
qcod
)

983 ià(
	`WARN_ON
(!
queue
è|| WARN_ON(!
queue_¡©
è|| WARN_ON(!
qmod
) || WARN_ON(!qmod))

984  -
EINTR
;

991 if(
	`ktime_to_ms
(
	`ktime_sub
(
	`ktime_g‘
(), 
queue
->
¡©s
.
Ï¡_§m¶e_time
)) > 2000)

992 
queue
->
¡©s
.
Ãtq_¡İ_³rûÁ
 = 0;

994 
	`memıy
(
queue_¡©
, &
queue
->
¡©s
, (
scsc_wifi_fcq_q_¡©
));

995 *
qmod
 = 
	`©omic_»ad
(&
queue
->qmod);

996 *
qcod
 = 
	`©omic_»ad
(&
queue
->qcod);

998 
	}
}

1000 
	$scsc_wifi_fcq_¡©_queue£t
(
scsc_wifi_fcq_d©a_q£t
 *
queue_£t
,

1001 
scsc_wifi_fcq_q_¡©
 *
queue_¡©
,

1002 *
smod
, *
scod
, 
scsc_wifi_fcq_8021x_¡©e
 *
ı_¡©e
,

1003 
u32
 *
³”_ps_¡©e_Œªs™iÚs
)

1005 ià(
	`WARN_ON
(!
queue_£t
è|| WARN_ON(!
queue_¡©
è|| WARN_ON(!
smod
è|| WARN_ON(!
scod
) ||

1006 
	`WARN_ON
(!
ı_¡©e
è|| WARN_ON(!
³”_ps_¡©e_Œªs™iÚs
))

1007  -
EINTR
;

1009 
	`memıy
(
queue_¡©
, &
queue_£t
->
¡©s
, (
scsc_wifi_fcq_q_¡©
));

1010 *
³”_ps_¡©e_Œªs™iÚs
 = 
queue_£t
->peer_ps_state_transitions;

1011 *
ı_¡©e
 = 
queue_£t
->
cÚŒŞËd_pÜt_¡©e
;

1012 *
smod
 = 
	`©omic_»ad
(&
queue_£t
->smod);

1013 *
scod
 = 
	`©omic_»ad
(&
queue_£t
->scod);

1015 
	}
}

1020 
	$scsc_wifi_fcq_ù¾_q_š™
(
scsc_wifi_fcq_ù¾_q
 *
queue
)

1022 ià(
	`WARN_ON
(!
queue
))

1023  -
EINVAL
;

1026 ià(
	`WARN_ON
(
scsc_wifi_fcq_qmod
 >= 0x1000000))

1027  -
EINVAL
;

1029 
	`©omic_£t
(&
queue
->
h—d
.
qmod
, 
scsc_wifi_fcq_qmod
);

1030 
	`©omic_£t
(&
queue
->
h—d
.
qcod
, 0);

1031 
queue
->
h—d
.
Ãtif_queue_id
 = 0;

1032 
queue
->
h—d
.
¡©s
.
Ãtq_¡İs
 = 0;

1033 
queue
->
h—d
.
¡©s
.
Ãtq_»sumes
 = 0;

1034 
	`©omic_£t
(&
queue
->
h—d
.
aùive
, 1);

1037 
	}
}

1039 
	$scsc_wifi_fcq_ù¾_q_deš™
(
scsc_wifi_fcq_ù¾_q
 *
queue
)

1041 
qcod
;

1043 
	`WARN_ON
(!
queue
);

1045 
qcod
 = 
	`©omic_»ad
(&
queue
->
h—d
.qcod);

1046 ià(
qcod
 != 0)

1047 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Ctrl queue (0x%p) deinit: qcod is %d,‚etif queue %d\n",

1048 
queue
, 
qcod
, queue->
h—d
.
Ãtif_queue_id
);

1049 
	}
}

1051 
	$fcq_d©a_q_š™
(
Ãt_deviû
 *
dev
, 
¦si_dev
 *
sdev
, 
scsc_wifi_fcq_queue_£t_ty³
 
ty³
, 
scsc_wifi_fcq_d©a_q
 *
queue
,

1052 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u8
 
qs_num
, 
s16
 
ac
)

1054 ià(
	`WARN_ON
(!
queue
))

1055  -
EINVAL
;

1057 ià(
	`WARN_ON
(!
qs
))

1058  -
EINVAL
;

1061 ià(
	`WARN_ON
(
scsc_wifi_fcq_qmod
 >ğ0x1000000è|| WARN_ON(
scsc_wifi_fcq_mÿ¡_qmod
 >= 0x1000000))

1062  -
EINVAL
;

1064 
	`©omic_£t
(&
queue
->
h—d
.
qmod
, 
ty³
 =ğ
SCSC_WIFI_FCQ_QUEUE_SET_TYPE_UNICAST
 ? 
scsc_wifi_fcq_qmod
 : 
scsc_wifi_fcq_mÿ¡_qmod
);

1066 
	`©omic_£t
(&
queue
->
h—d
.
qcod
, 0);

1067 
queue
->
qs
 = qs;

1068 
queue
->
h—d
.
Ãtif_queue_id
 = 
ty³
 =ğ
SCSC_WIFI_FCQ_QUEUE_SET_TYPE_UNICAST
 ?

1069 
	`¦si_Ãtif_g‘_³”_queue
(
qs_num
, 
ac
è: 
	`¦si_Ãtif_g‘_muÉiÿ¡_queue
(ac);

1071 
queue
->
h—d
.
¡©s
.
Ãtq_¡İs
 = 0;

1072 
queue
->
h—d
.
¡©s
.
Ãtq_»sumes
 = 0;

1075 ià(!
	`©omic_»ad
(&
sdev
->
š_·u£_¡©e
))

1076 
	`Ãtif_wake_subqueue
(
dev
, 
queue
->
h—d
.
Ãtif_queue_id
);

1078 
queue
->
h—d
.
§tu¿‹d
 = 
çl£
;

1079 
	`©omic_£t
(&
queue
->
h—d
.
aùive
, 1);

1080 
queue
->
h—d
.
¡©s
.
Ãtq_¡©e
 = 1;

1081 
queue
->
h—d
.
¡©s
.
Ãtq_¡İ_time_š_ms
 = 0;

1082 
queue
->
h—d
.
¡©s
.
Ãtq_¡İ_³rûÁ
 = 0;

1085 
	}
}

1087 
	$fcq_d©a_q_deš™
(
scsc_wifi_fcq_d©a_q
 *
queue
)

1089 
qcod
;

1091 
	`WARN_ON
(!
queue
);

1093 
qcod
 = 
	`©omic_»ad
(&
queue
->
h—d
.qcod);

1094 ià(
qcod
 != 0)

1095 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Data queue (0x%p) deinit: qcod is %d,‚etif queue %d\n",

1096 
queue
, 
qcod
, queue->
h—d
.
Ãtif_queue_id
);

1097 
	}
}

1099 
	$fcq_q£t_š™
(
Ãt_deviû
 *
dev
, 
¦si_dev
 *
sdev
, 
scsc_wifi_fcq_queue_£t_ty³
 
ty³
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u8
 
qs_num
)

1101 
i
;

1102 
scsc_wifi_fcq_d©a_q
 *
queue
;

1104 
	`mem£t
(
qs
, 0, (
scsc_wifi_fcq_d©a_q£t
));

1105 
	`¥š_lock_š™
(&
qs
->
ı_lock
);

1106 
	`©omic_£t
(&
qs
->
smod
, 
ty³
 =ğ
SCSC_WIFI_FCQ_QUEUE_SET_TYPE_UNICAST
 ? 
scsc_wifi_fcq_smod
 : 
scsc_wifi_fcq_mÿ¡_smod
);

1107 
	`©omic_£t
(&
qs
->
scod
, 0);

1109 
	`¥š_lock_bh
(&
qs
->
ı_lock
);

1110 
qs
->
³”_ps_¡©e
 = 
SCSC_WIFI_FCQ_PS_STATE_ACTIVE
;

1111 
qs
->
§tu¿‹d
 = 
çl£
;

1112 
	`©omic_£t
(&
qs
->
aùive
, 1);

1113 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


1114 
qs
->
š_¦“p
 = 
çl£
;

1115 
qs
->
ÿn_be_di¡ribu‹d
 = 
çl£
;

1117 
qs
->
cÚŒŞËd_pÜt_¡©e
 = 
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
;

1120 
i
 = 0; i < 
SLSI_NETIF_Q_PER_PEER
; i++) {

1122 
qs
->
ac_šu£
 &ğ~(1 << 
i
);

1123 
queue
 = &
qs
->
ac_q
[
i
];

1124 
	`fcq_d©a_q_š™
(
dev
, 
sdev
, 
ty³
, 
queue
, 
qs
, 
qs_num
, 
i
);

1127 
qs
->
ac_šu£
 = 1;

1128 
	`¥š_uÆock_bh
(&
qs
->
ı_lock
);

1129 
	}
}

1131 
	$scsc_wifi_fcq_uniÿ¡_q£t_š™
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u8
 
qs_num
, 
¦si_dev
 *
sdev
, u8 
vif
, 
¦si_³”
 *
³”
)

1133 
³”s_ÿche
 *
pc_Ãw_node
;

1135 ià(
	`WARN_ON
(!
qs
))

1136  -
EINVAL
;

1139 ià(
	`WARN_ON
(
scsc_wifi_fcq_smod
 >= 0x1000000))

1140  -
EINVAL
;

1142 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "In™ uniÿ¡ queu£ˆ0x%°vià%d…“r_šdex %d\n", 
qs
, 
vif
, 
³”
->
aid
);

1143 
	`fcq_q£t_š™
(
dev
, 
sdev
, 
SCSC_WIFI_FCQ_QUEUE_SET_TYPE_UNICAST
, 
qs
, 
qs_num
);

1144 
	`SCSC_HIP4_SAMPLER_BOT_ADD
Ğ
sdev
->
mšÜ_´of
,

1145 
vif
,

1146 
³”
->
aid
,

1147 (
³”
->
add»ss
[3] << 24) | (peer->address[2] << 16) | (peer->address[1] << 8) | (peer->address[0]));

1148 
	`SCSC_HIP4_SAMPLER_BOT_TX
(
sdev
->
mšÜ_´of
, 
vif
, 
³”
->
aid
, 0, (
	`©omic_»ad
(&
qs
->
smod
è<< 16è| (©omic_»ad(&qs->
scod
) & 0xFFFF));

1150 
pc_Ãw_node
 = 
	`kz®loc
((*pc_Ãw_node), 
GFP_ATOMIC
);

1151 ià(!
pc_Ãw_node
)

1152  -
ENOMEM
;

1153 
pc_Ãw_node
->
dev
 = dev;

1154 
pc_Ãw_node
->
qs
 = qs;

1155 
pc_Ãw_node
->
³”_šdex
 = 
³”
->
aid
;

1156 
pc_Ãw_node
->
vif
 = vif;

1157 
pc_Ãw_node
->
is_uniÿ¡
 = 
Œue
;

1159 
	`SLSI_DBG1_NODEV
(
SLSI_WIFI_FCQ
, "Add‚ew…“¸q %°vià%d…“r->aid %d\n", 
qs
, 
vif
, 
³”
->
aid
);

1160 
	`¥š_lock_bh
(&
³”s_ÿche_lock
);

1161 
	`li¡_add_
(&
pc_Ãw_node
->
li¡
, &
³”s_ÿche_li¡
);

1162 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

1164 ià(
tÙ®
 == 0) {

1166 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


1167 
tÙ®_š_¦“p
 = 0;

1169 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "First…eer. Reset gcod.\n");

1170 
	`©omic_£t
(&
sdev
->
h4_š¡
.
h_´iv
->
gcod
, 0);

1171 
	`©omic_£t
(&
sdev
->
h4_š¡
.
h_´iv
->
gaùive
, 1);

1172 
sdev
->
h4_š¡
.
h_´iv
->
§tu¿‹d
 = 
çl£
;

1175 
tÙ®
++;

1176 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "Add New…“r. TÙ® %d\n", 
tÙ®
);

1177 
	`fcq_»di¡ribu‹_smod
(
dev
, 
sdev
, 
tÙ®
);

1180 
	}
}

1182 
	$scsc_wifi_fcq_muÉiÿ¡_q£t_š™
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
¦si_dev
 *
sdev
, 
u8
 
vif
)

1184 
³”s_ÿche
 *
pc_node
;

1186 ià(
	`WARN_ON
(!
qs
))

1187  -
EINVAL
;

1190 ià(
	`WARN_ON
(
scsc_wifi_fcq_mÿ¡_smod
 >= 0x1000000))

1191  -
EINVAL
;

1193 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "In™ muÉiÿ¡ queu£ˆ0x%p\n", 
qs
);

1194 
	`fcq_q£t_š™
(
dev
, 
sdev
, 
SCSC_WIFI_FCQ_QUEUE_SET_TYPE_MULTICAST
, 
qs
, 0);

1195 
	`SCSC_HIP4_SAMPLER_BOT_ADD
(
sdev
->
mšÜ_´of
, 
vif
, 0, 0);

1196 
	`SCSC_HIP4_SAMPLER_BOT_TX
(
sdev
->
mšÜ_´of
, 
vif
, 0, 0, (
	`©omic_»ad
(&
qs
->
smod
è<< 16è| (©omic_»ad(&qs->
scod
) & 0xFFFF));

1199 
pc_node
 = 
	`kz®loc
((*pc_node), 
GFP_ATOMIC
);

1200 ià(!
pc_node
)

1201  -
ENOMEM
;

1202 
pc_node
->
dev
 = dev;

1203 
pc_node
->
qs
 = qs;

1204 
pc_node
->
³”_šdex
 = 0;

1205 
pc_node
->
vif
 = vif;

1206 
pc_node
->
is_uniÿ¡
 = 
çl£
;

1208 
	`SLSI_DBG1_NODEV
(
SLSI_WIFI_FCQ
, "Add MuÉiÿ¡ Q£ˆ%°vià%d…“r->aid 0\n", 
qs
, 
vif
);

1209 
	`¥š_lock_bh
(&
³”s_ÿche_lock
);

1210 
	`li¡_add_
(&
pc_node
->
li¡
, &
³”s_ÿche_li¡
);

1211 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

1213 
	`fcq_»di¡ribu‹_qmod
(
pc_node
->
dev
,…c_node->
qs
, 
sdev
,…c_node->
³”_šdex
,…c_node->
vif
);

1216 
	}
}

1218 
	$scsc_wifi_fcq_q£t_deš™
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, 
¦si_³”
 *
³”
)

1220 
³”s_ÿche
 *
pc_node
, *
Ãxt
;

1221 
i
, 
scod
;

1222 #ifdeà
CONFIG_SCSC_WLAN_HIP4_PROFILING


1223 
aid
 = 0;

1225 ià(
³”
)

1226 
aid
 = 
³”
->aid;

1229 
	`WARN_ON
(!
qs
);

1231 ià(!
qs
)

1234 
scod
 = 
	`©omic_»ad
(&
qs
->scod);

1235 ià(
scod
 != 0)

1236 
	`SLSI_DBG1_NODEV
(
SLSI_WIFI_FCQ
, "D©¨£ˆ(0x%pèdeš™: scod i %d\n", 
qs
, 
scod
);

1238 
i
 = 0; i < 
SLSI_NETIF_Q_PER_PEER
; i++)

1239 
	`fcq_d©a_q_deš™
(&
qs
->
ac_q
[
i
]);

1241 
qs
->
ac_šu£
 = 0;

1242 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


1244 ià(
qs
->
š_¦“p
 && 
tÙ®_š_¦“p
)

1245 
tÙ®_š_¦“p
 -= 1;

1247 
	`SCSC_HIP4_SAMPLER_BOT_RX
(
sdev
->
mšÜ_´of
, 
vif
, 
aid
, 0, 0);

1248 
	`SCSC_HIP4_SAMPLER_BOT_REMOVE
(
sdev
->
mšÜ_´of
, 
vif
, 
aid
);

1250 ià(
³”
)

1251 
	`SLSI_DBG1_NODEV
(
SLSI_WIFI_FCQ
, "D–‘q %°vià%d…“r->aid %d\n", 
qs
, 
vif
, 
³”
->
aid
);

1253 
	`SLSI_DBG1_NODEV
(
SLSI_WIFI_FCQ
, "D–‘q %°vià%d MuÉiÿ¡\n", 
qs
, 
vif
);

1255 
	`¥š_lock_bh
(&
³”s_ÿche_lock
);

1256 
	`li¡_fÜ_—ch_’Œy_§ã
(
pc_node
, 
Ãxt
, &
³”s_ÿche_li¡
, 
li¡
) {

1257 ià(
pc_node
->
qs
 == qs) {

1258 
	`li¡_d–
(&
pc_node
->
li¡
);

1259 
	`kä“
(
pc_node
);

1262 
	`¥š_uÆock_bh
(&
³”s_ÿche_lock
);

1264 ià(
tÙ®
 > 0 && 
³”
)

1265 
tÙ®
--;

1267 
	`SLSI_DBG4_NODEV
(
SLSI_WIFI_FCQ
, "D–…“r. TÙ® %d\n", 
tÙ®
);

1269 ià(
tÙ®
 == 0)

1272 
	`fcq_»di¡ribu‹_smod
(
dev
, 
sdev
, 
tÙ®
);

1273 
	}
}

	@scsc_wifi_fcq.h

7 
	~<lšux/¥šlock.h
>

8 
	~<asm/©omic.h
>

9 
	~"Ãtif.h
"

11 #iâdeà
__SCSC_WIFI_FCQ_H


12 
	#__SCSC_WIFI_FCQ_H


	)

14 
	escsc_wifi_fcq_8021x_¡©e
 {

15 
	mSCSC_WIFI_FCQ_8021x_STATE_BLOCKED
 = 0,

16 
	mSCSC_WIFI_FCQ_8021x_STATE_OPEN
 = 1

19 
	escsc_wifi_fcq_ps_¡©e
 {

20 
	mSCSC_WIFI_FCQ_PS_STATE_POWERSAVE
 = 1,

21 
	mSCSC_WIFI_FCQ_PS_STATE_ACTIVE
 = 2

24 
	sscsc_wifi_fcq_q_¡©
 {

25 
u32
 
	mÃtq_¡İs
;

26 
u32
 
	mÃtq_»sumes
;

27 
u32
 
	mÃtq_¡İ_³rûÁ
;

28 
u32
 
	mÃtq_¡İ_time_š_ms
;

29 
ktime_t
 
	mÏ¡_§m¶e_time
;

30 
ktime_t
 
	mÏ¡_¡İ_time
;

31 
boŞ
 
	mÃtq_¡©e
;

34 
	sscsc_wifi_fcq_q_h—d”
 {

35 
©omic_t
 
	mqmod
;

36 
©omic_t
 
	mqcod
;

37 
u16
 
	mÃtif_queue_id
;

38 
©omic_t
 
	maùive
;

39 
scsc_wifi_fcq_q_¡©
 
	m¡©s
;

40 
ktime_t
 
	mem±y_t
;

41 
boŞ
 
	mÿn_be_di¡ribu‹d
;

42 
boŞ
 
	m§tu¿‹d
;

43 
	mgu¬d
;

46 
	sscsc_wifi_fcq_d©a_q
 {

47 
scsc_wifi_fcq_q_h—d”
 
	mh—d
;

48 
scsc_wifi_fcq_d©a_q£t
 *
	mqs
;

51 
	sscsc_wifi_fcq_ù¾_q
 {

52 
scsc_wifi_fcq_q_h—d”
 
	mh—d
;

55 
	escsc_wifi_fcq_queue_£t_ty³
 {

56 
	mSCSC_WIFI_FCQ_QUEUE_SET_TYPE_UNICAST
 = 0,

57 
	mSCSC_WIFI_FCQ_QUEUE_SET_TYPE_MULTICAST
 = 1

60 
	#EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION
 1

	)

62 
	sscsc_wifi_fcq_d©a_q£t
 {

63 
©omic_t
 
	maùive
;

64 
scsc_wifi_fcq_8021x_¡©e
 
	mcÚŒŞËd_pÜt_¡©e
;

66 
¥šlock_t
 
	mı_lock
;

68 
scsc_wifi_fcq_d©a_q
 
	mac_q
[
SLSI_NETIF_Q_PER_PEER
];

70 
u8
 
	mac_šu£
;

71 
©omic_t
 
	msmod
;

72 
©omic_t
 
	mscod
;

74 
scsc_wifi_fcq_q_¡©
 
	m¡©s
;

75 
scsc_wifi_fcq_ps_¡©e
 
	m³”_ps_¡©e
;

76 
u32
 
	m³”_ps_¡©e_Œªs™iÚs
;

78 #ifdeà
EXPERIMENTAL_DYNAMIC_SMOD_ADAPTATION


79 
ktime_t
 
	mem±y_t
;

80 
boŞ
 
	mÿn_be_di¡ribu‹d
;

81 
boŞ
 
	mš_¦“p
;

83 
boŞ
 
	m§tu¿‹d
;

84 
	mgu¬d
;

88 
scsc_wifi_fcq_ù¾_q_š™
(
scsc_wifi_fcq_ù¾_q
 *
queue
);

89 
scsc_wifi_fcq_ù¾_q_deš™
(
scsc_wifi_fcq_ù¾_q
 *
queue
);

91 
scsc_wifi_fcq_uniÿ¡_q£t_š™
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u8
 
qs_num
, 
¦si_dev
 *
sdev
, u8 
vif
, 
¦si_³”
 *
³”
);

92 
scsc_wifi_fcq_muÉiÿ¡_q£t_š™
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
¦si_dev
 *
sdev
, 
u8
 
vif
);

93 
scsc_wifi_fcq_q£t_deš™
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, 
¦si_³”
 *
³”
);

96 
scsc_wifi_fcq_Œªsm™_d©a
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u16
 
´iÜ™y
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
);

97 
scsc_wifi_fcq_»ûive_d©a
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u16
 
´iÜ™y
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
);

98 
scsc_wifi_fcq_»ûive_d©a_no_³”
(
Ãt_deviû
 *
dev
, 
u16
 
´iÜ™y
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
);

100 
scsc_wifi_fcq_·u£_queues
(
¦si_dev
 *
sdev
);

101 #ifdeà
CONFIG_SCSC_WLAN_ARP_FLOW_CONTROL


102 
scsc_wifi_·u£_¬p_q_®l_vif
(
¦si_dev
 *
sdev
);

103 
scsc_wifi_uÅau£_¬p_q_®l_vif
(
¦si_dev
 *
sdev
);

106 
scsc_wifi_fcq_uÅau£_queues
(
¦si_dev
 *
sdev
);

108 
scsc_wifi_fcq_Œªsm™_ù¾
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_ù¾_q
 *
queue
);

109 
scsc_wifi_fcq_»ûive_ù¾
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_ù¾_q
 *
queue
);

111 
scsc_wifi_fcq_upd©e_smod
(
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
scsc_wifi_fcq_ps_¡©e
 
³”_ps_¡©e
,

112 
scsc_wifi_fcq_queue_£t_ty³
 
ty³
);

113 
scsc_wifi_fcq_8021x_pÜt_¡©e
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
scsc_wifi_fcq_8021x_¡©e
 
¡©e
);

116 
scsc_wifi_fcq_¡©_queue
(
scsc_wifi_fcq_q_h—d”
 *
queue
,

117 
scsc_wifi_fcq_q_¡©
 *
queue_¡©
,

118 *
qmod
, *
qcod
);

120 
scsc_wifi_fcq_¡©_queue£t
(
scsc_wifi_fcq_d©a_q£t
 *
queue_£t
,

121 
scsc_wifi_fcq_q_¡©
 *
queue_¡©
,

122 *
smod
, *
scod
, 
scsc_wifi_fcq_8021x_¡©e
 *
ı_¡©e
,

123 
u32
 *
³”_ps_¡©e_Œªs™iÚs
);

	@scsc_wifilogger.h

6 #iâdeà
_SCSC_WIFILOGGER_H_


7 
	#_SCSC_WIFILOGGER_H_


	)

49 
	~"scsc_wifogg”_ty³s.h
"

57 
wifi_”rÜ
 
scsc_wifi_g‘_fœmw¬e_v”siÚ
(*
bufãr
, 
bufãr_size
);

65 
wifi_”rÜ
 
scsc_wifi_g‘_driv”_v”siÚ
(*
bufãr
, 
bufãr_size
);

72 
wifi_”rÜ
 
scsc_wifi_g‘_ršg_bufãrs_¡©us
(
u32
 *
num_ršgs
,

73 
scsc_wifi_ršg_bufãr_¡©us
 *
¡©us
);

79 
wifi_”rÜ
 
scsc_wifi_g‘_logg”_suµÜ‹d_ã©u»_£t
(*
suµÜt
);

87 
wifi_”rÜ
 
scsc_wifi_£t_log_hªdËr
(
Ú_ršg_bufãr_d©a
 
hªdËr
, *
ùx
);

88 
wifi_”rÜ
 
scsc_wifi_»£t_log_hªdËr
();

94 
wifi_”rÜ
 
scsc_wifi_£t_®”t_hªdËr
(
Ú_®”t
 
hªdËr
, *
ùx
);

95 
wifi_”rÜ
 
scsc_wifi_»£t_®”t_hªdËr
();

100 
wifi_”rÜ
 
scsc_wifi_g‘_ršg_d©a
(*
ršg_Çme
);

126 
wifi_”rÜ
 
scsc_wifi_¡¬t_loggšg
(
u32
 
v”bo£_Ëv–
, u32 
æags
, u32 
max_š‹rv®_£c
,

127 
u32
 
mš_d©a_size
, *
ršg_Çme
);

135 
wifi_”rÜ
 
scsc_wifi_g‘_fœmw¬e_memÜy_dump
(
Ú_fœmw¬e_memÜy_dump
 
hªdËr
, *
ùx
);

152 
wifi_”rÜ
 
scsc_wifi_g‘_driv”_memÜy_dump
(
Ú_driv”_memÜy_dump
 
hªdËr
, *
ùx
);

159 
wifi_”rÜ
 
scsc_wifi_¡¬t_pkt_ç‹_mÚ™Üšg
();

177 
wifi_”rÜ
 
scsc_wifi_g‘_tx_pkt_ç‹s
(
wifi_tx_»pÜt
 *
tx_»pÜt_bufs
,

178 
size_t
 
n_»que¡ed_ç‹s
,

179 
size_t
 *
n_´ovided_ç‹s
,

180 
boŞ
 
is_u£r
);

198 
wifi_”rÜ
 
scsc_wifi_g‘_rx_pkt_ç‹s
(
wifi_rx_»pÜt
 *
rx_»pÜt_bufs
,

199 
size_t
 
n_»que¡ed_ç‹s
,

200 
size_t
 *
n_´ovided_ç‹s
,

201 
boŞ
 
is_u£r
);

	@scsc_wifilogger_api.c

6 
	~<scsc/scsc_mx.h
>

7 
	~<scsc/scsc_logršg.h
>

9 
	~"scsc_wifogg”.h
"

10 
	~"scsc_wifogg”_cÜe.h
"

11 
	~"scsc_wifogg”_š‹º®.h
"

12 
	~"scsc_wifogg”_ršg_pktç‹.h
"

14 
wifi_”rÜ
 
	$scsc_wifi_g‘_fœmw¬e_v”siÚ
(*
bufãr
, 
bufãr_size
)

16 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

17 
	`mxmª_g‘_fw_v”siÚ
(
bufãr
, 
bufãr_size
);

18  
WIFI_SUCCESS
;

19 
	}
}

20 
EXPORT_SYMBOL
(
scsc_wifi_g‘_fœmw¬e_v”siÚ
);

22 
wifi_”rÜ
 
	$scsc_wifi_g‘_driv”_v”siÚ
(*
bufãr
, 
bufãr_size
)

24 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

25 
	`mxmª_g‘_driv”_v”siÚ
(
bufãr
, 
bufãr_size
);

26  
WIFI_SUCCESS
;

27 
	}
}

28 
EXPORT_SYMBOL
(
scsc_wifi_g‘_driv”_v”siÚ
);

30 
wifi_”rÜ
 
	$scsc_wifi_g‘_ršg_bufãrs_¡©us
(
u32
 *
num_ršgs
,

31 
scsc_wifi_ršg_bufãr_¡©us
 *
¡©us
)

33 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

34 ià(!
	`scsc_wifogg”_g‘_ršgs_¡©us
(
num_ršgs
, 
¡©us
))

35  
WIFI_ERROR_UNINITIALIZED
;

37  
WIFI_SUCCESS
;

38 
	}
}

39 
EXPORT_SYMBOL
(
scsc_wifi_g‘_ršg_bufãrs_¡©us
);

41 
wifi_”rÜ
 
	$scsc_wifi_g‘_logg”_suµÜ‹d_ã©u»_£t
(*
suµÜt
)

43 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

44 ià(!
suµÜt
)

45  
WIFI_ERROR_INVALID_ARGS
;

46 *
suµÜt
 = 
	`scsc_wifogg”_g‘_ã©u»s
();

48  
WIFI_SUCCESS
;

49 
	}
}

50 
EXPORT_SYMBOL
(
scsc_wifi_g‘_logg”_suµÜ‹d_ã©u»_£t
);

52 
wifi_”rÜ
 
	$scsc_wifi_£t_log_hªdËr
(
Ú_ršg_bufãr_d©a
 
hªdËr
, *
ùx
)

54 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

56 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

57 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

58 ià(!
wl
 || !wl->
š™Ÿlized
) {

59 
	`SCSC_TAG_ERR
(
WLOG
,

61  
WIFI_ERROR_UNINITIALIZED
;

63 ià(!
hªdËr
) {

64 
	`SCSC_TAG_ERR
(
WLOG
,

66  
WIFI_ERROR_INVALID_ARGS
;

69 
	`mu‹x_lock
(&
wl
->
lock
);

70 ià(
wl
->
Ú_ršg_bufãr_d©a_cb
) {

71 
	`SCSC_TAG_ERR
(
WLOG
,

73 
	`mu‹x_uÆock
(&
wl
->
lock
);

74  
WIFI_SUCCESS
;

76 
wl
->
Ú_ršg_bufãr_d©a_cb
 = 
hªdËr
;

77 
wl
->
Ú_ršg_bufãr_ùx
 = 
ùx
;

78 
	`mu‹x_uÆock
(&
wl
->
lock
);

80  
WIFI_SUCCESS
;

81 
	}
}

82 
EXPORT_SYMBOL
(
scsc_wifi_£t_log_hªdËr
);

84 
wifi_”rÜ
 
	$scsc_wifi_»£t_log_hªdËr
()

86 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

88 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

89 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

90 ià(!
wl
 || !wl->
š™Ÿlized
) {

91 
	`SCSC_TAG_ERR
(
WLOG
,

93  
WIFI_ERROR_UNINITIALIZED
;

95 
	`mu‹x_lock
(&
wl
->
lock
);

96 
wl
->
Ú_ršg_bufãr_d©a_cb
 = 
NULL
;

97 
wl
->
Ú_ršg_bufãr_ùx
 = 
NULL
;

98 
	`mu‹x_uÆock
(&
wl
->
lock
);

100  
WIFI_SUCCESS
;

101 
	}
}

102 
EXPORT_SYMBOL
(
scsc_wifi_»£t_log_hªdËr
);

104 
wifi_”rÜ
 
	$scsc_wifi_£t_®”t_hªdËr
(
Ú_®”t
 
hªdËr
, *
ùx
)

106 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

108 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

109 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

110 ià(!
wl
 || !wl->
š™Ÿlized
) {

111 
	`SCSC_TAG_ERR
(
WLOG
,

113  
WIFI_ERROR_UNINITIALIZED
;

115 ià(!
hªdËr
) {

116 
	`SCSC_TAG_ERR
(
WLOG
,

118  
WIFI_ERROR_INVALID_ARGS
;

121 
	`mu‹x_lock
(&
wl
->
lock
);

122 ià(
wl
->
Ú_®”t_cb
) {

123 
	`SCSC_TAG_ERR
(
WLOG
,

125 
	`mu‹x_uÆock
(&
wl
->
lock
);

126  
WIFI_SUCCESS
;

128 
wl
->
Ú_®”t_cb
 = 
hªdËr
;

129 
wl
->
Ú_®”t_ùx
 = 
ùx
;

130 
	`mu‹x_uÆock
(&
wl
->
lock
);

132  
WIFI_SUCCESS
;

133 
	}
}

134 
EXPORT_SYMBOL
(
scsc_wifi_£t_®”t_hªdËr
);

136 
wifi_”rÜ
 
	$scsc_wifi_»£t_®”t_hªdËr
()

138 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

140 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

141 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

142 ià(!
wl
 || !wl->
š™Ÿlized
) {

143 
	`SCSC_TAG_ERR
(
WLOG
,

145  
WIFI_ERROR_UNINITIALIZED
;

147 
	`mu‹x_lock
(&
wl
->
lock
);

148 
wl
->
Ú_®”t_cb
 = 
NULL
;

149 
wl
->
Ú_®”t_ùx
 = 
NULL
;

150 
	`mu‹x_uÆock
(&
wl
->
lock
);

152  
WIFI_SUCCESS
;

153 
	}
}

154 
EXPORT_SYMBOL
(
scsc_wifi_»£t_®”t_hªdËr
);

156 
wifi_”rÜ
 
	$scsc_wifi_g‘_ršg_d©a
(*
ršg_Çme
)

158 
scsc_wlog_ršg
 *
r
;

159 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

161 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

162 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

163 ià(!
wl
 || !wl->
š™Ÿlized
) {

164 
	`SCSC_TAG_ERR
(
WLOG
,

166 
ršg_Çme
);

167  
WIFI_ERROR_UNINITIALIZED
;

170 
	`mu‹x_lock
(&
wl
->
lock
);

171 ià(!
wl
->
Ú_ršg_bufãr_d©a_cb
)

172 
	`SCSC_TAG_WARNING
(
WLOG
,

174 
ršg_Çme
);

175 
	`mu‹x_uÆock
(&
wl
->
lock
);

177 
r
 = 
	`scsc_wifogg”_g‘_ršg_äom_Çme
(
ršg_Çme
);

178 ià(!
r
) {

179 
	`SCSC_TAG_ERR
(
WLOG
,

181 
ršg_Çme
);

182  
WIFI_ERROR_NOT_AVAILABLE
;

185 
	`scsc_wlog_d¿š_whŞe_ršg
(
r
);

187  
WIFI_SUCCESS
;

188 
	}
}

189 
EXPORT_SYMBOL
(
scsc_wifi_g‘_ršg_d©a
);

191 
wifi_”rÜ
 
	$scsc_wifi_¡¬t_loggšg
(
u32
 
v”bo£_Ëv–
, u32 
æags
, u32 
max_š‹rv®_£c
,

192 
u32
 
mš_d©a_size
, *
ršg_Çme
)

194 
scsc_wlog_ršg
 *
r
;

196 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

197 
r
 = 
	`scsc_wifogg”_g‘_ršg_äom_Çme
(
ršg_Çme
);

198 ià(!
r
) {

199 
	`SCSC_TAG_ERR
(
WLOG
,

201 
ršg_Çme
);

202  
WIFI_ERROR_NOT_AVAILABLE
;

205  
	`scsc_wlog_¡¬t_loggšg
(
r
, 
v”bo£_Ëv–
, 
æags
,

206 
max_š‹rv®_£c
, 
mš_d©a_size
);

207 
	}
}

208 
EXPORT_SYMBOL
(
scsc_wifi_¡¬t_loggšg
);

210 
wifi_”rÜ
 
	$scsc_wifi_g‘_fœmw¬e_memÜy_dump
(
Ú_fœmw¬e_memÜy_dump
 
hªdËr
, *
ùx
)

212 
buf
[] = "Full FW memory dump NOT‡vailable.\n";

214 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

215 
	`hªdËr
(
buf
, (buf), 
ùx
);

217  
WIFI_SUCCESS
;

218 
	}
}

219 
EXPORT_SYMBOL
(
scsc_wifi_g‘_fœmw¬e_memÜy_dump
);

221 
wifi_”rÜ
 
	$scsc_wifi_g‘_driv”_memÜy_dump
(
Ú_driv”_memÜy_dump
 
hªdËr
, *
ùx
)

223 
buf
[] = "Full DRIVER memory dump NOT‡vailable.\n";

225 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

226 
	`hªdËr
(
buf
, (buf), 
ùx
);

228  
WIFI_SUCCESS
;

229 
	}
}

230 
EXPORT_SYMBOL
(
scsc_wifi_g‘_driv”_memÜy_dump
);

232 
wifi_”rÜ
 
	$scsc_wifi_¡¬t_pkt_ç‹_mÚ™Üšg
()

234 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

235 
	`scsc_wifogg”_ršg_pktç‹_¡¬t_mÚ™Üšg
();

237  
WIFI_SUCCESS
;

238 
	}
}

239 
EXPORT_SYMBOL
(
scsc_wifi_¡¬t_pkt_ç‹_mÚ™Üšg
);

241 
wifi_”rÜ
 
	$scsc_wifi_g‘_tx_pkt_ç‹s
(
wifi_tx_»pÜt
 *
tx_»pÜt_bufs
,

242 
size_t
 
n_»que¡ed_ç‹s
,

243 
size_t
 *
n_´ovided_ç‹s
, 
boŞ
 
is_u£r
)

245 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

246 
	`scsc_wifogg”_ršg_pktç‹_g‘_ç‹s
(
TX_FATE
, 
tx_»pÜt_bufs
,

247 
n_»que¡ed_ç‹s
, 
n_´ovided_ç‹s
, 
is_u£r
);

248  
WIFI_SUCCESS
;

249 
	}
}

250 
EXPORT_SYMBOL
(
scsc_wifi_g‘_tx_pkt_ç‹s
);

252 
wifi_”rÜ
 
	$scsc_wifi_g‘_rx_pkt_ç‹s
(
wifi_rx_»pÜt
 *
rx_»pÜt_bufs
,

253 
size_t
 
n_»que¡ed_ç‹s
,

254 
size_t
 *
n_´ovided_ç‹s
, 
boŞ
 
is_u£r
)

256 
	`SCSC_TAG_DEBUG
(
WLOG
, "\n");

257 
	`scsc_wifogg”_ršg_pktç‹_g‘_ç‹s
(
RX_FATE
, 
rx_»pÜt_bufs
,

258 
n_»que¡ed_ç‹s
, 
n_´ovided_ç‹s
, 
is_u£r
);

259  
WIFI_SUCCESS
;

260 
	}
}

261 
EXPORT_SYMBOL
(
scsc_wifi_g‘_rx_pkt_ç‹s
);

	@scsc_wifilogger_core.c

7 
	~<lšux/k”Ãl.h
>

8 
	~<lšux/ty³s.h
>

9 
	~<lšux/mu‹x.h
>

10 
	~<lšux/¦ab.h
>

11 
	~<lšux/sched.h
>

12 
	~<lšux/time.h
>

13 
	~<lšux/wÜkqueue.h
>

14 
	~<lšux/¥šlock.h
>

15 
	~<scsc/scsc_logršg.h
>

16 
	~<lšux/tim”.h
>

17 
	~<lšux/uacûss.h
>

20 
	~"scsc_wifogg”_cÜe.h
"

22 
©omic_t
 
	gÃxt_ršg_id
;

24 
	$wlog_d¿š_wÜk”
(
wÜk_¡ruù
 *
wÜk
)

26 
scsc_wlog_ršg
 *
r
;

28 
r
 = 
	`cÚš”_of
(
wÜk
, 
scsc_wlog_ršg
, 
d¿š_wÜk
);

30 ià(
r
 &&„->
İs
.
d¿š_ršg
)

31 
r
->
İs
.
	`d¿š_ršg
Ô,„->
æushšg
 ?„->
¡
.
rb_by‹_size
 : 
	`DEFAULT_DRAIN_CHUNK_SZ
(r));

32 
	}
}

34 #ià
KERNEL_VERSION
(4, 19, 0è<ğ
LINUX_VERSION_CODE


35 
	$d¿š_tim”_ÿÎback
(
tim”_li¡
 *
t
)

37 
	$d¿š_tim”_ÿÎback
(
d©a
)

40 #ià
	`KERNEL_VERSION
(4, 19, 0è<ğ
LINUX_VERSION_CODE


41 
scsc_wlog_ršg
 *
r
 = 
	`äom_tim”
Ô, 
t
, 
d¿š_tim”
);

43 
scsc_wlog_ršg
 *
r
 = (scsc_wlog_ršg *)
d©a
;

45 
	`SCSC_TAG_DBG4
(
WLOG
, "TIMER DRAIN : %p\n", 
r
);

47 
	`queue_wÜk
(
r
->
d¿š_wÜkq
, &r->
d¿š_wÜk
);

49 ià(
r
->
¡
.
v”bo£_Ëv–
 &&„->
max_š‹rv®_£c
) {

50 
	`mod_tim”
(&
r
->
d¿š_tim”
,

51 
jiff›s
 + 
	`m£cs_to_jiff›s
(
r
->
max_š‹rv®_£c
 * 1000));

52 
	`SCSC_TAG_DBG4
(
WLOG
, "TIMER RELOADED !!!\n");

54 
	}
}

56 
	$wlog_ršg_š™
(
scsc_wlog_ršg
 *
r
)

59 
r
->
buf
 = 
	`kz®loc
Ô->
¡
.
rb_by‹_size
 + 
MAX_RECORD_SZ
, 
GFP_KERNEL
);

60 ià(!
r
->
buf
)

61  -
ENOMEM
;

62 
r
->
d¿š_sz
 = 
DRAIN_BUF_SZ
;

63 
r
->
d¿š_buf
 = 
	`kz®loc
Ô->
d¿š_sz
, 
GFP_KERNEL
);

64 ià(!
r
->
d¿š_buf
) {

65 
	`kä“
(
r
->
buf
);

66  -
ENOMEM
;

68 
	`mu‹x_š™
(&
r
->
d¿š_lock
);

70 
r
->
d¿š_wÜkq
 = 
	`ü—‹_wÜkqueue
("wifilogger");

71 
	`INIT_WORK
(&
r
->
d¿š_wÜk
, 
wlog_d¿š_wÜk”
);

72 #ià
	`KERNEL_VERSION
(4,19,0è<ğ
LINUX_VERSION_CODE


73 
	`tim”_£tup
(&
r
->
d¿š_tim”
, 
d¿š_tim”_ÿÎback
, 0);

75 
	`£tup_tim”
(&
r
->
d¿š_tim”
, 
d¿š_tim”_ÿÎback
, ()r);

77 
r
->
¡
.
ršg_id
 = 
	`©omic_»ad
(&
Ãxt_ršg_id
);

78 
	`©omic_šc
(&
Ãxt_ršg_id
);

80 
	`SCSC_TAG_DBG3
(
WLOG
, "Workers initialized for„ing[%p]: %s\n",

81 
r
,„->
¡
.
Çme
);

84 
	}
}

86 
	$wlog_ršg_fš®ize
(
scsc_wlog_ršg
 *
r
)

88 ià(!
r
)

91 
	`ÿnûl_wÜk_sync
(&
r
->
d¿š_wÜk
);

92 
	`d–_tim”_sync
(&
r
->
d¿š_tim”
);

93 
	`de¡roy_wÜkqueue
(
r
->
d¿š_wÜkq
);

95 
r
->
š™Ÿlized
 = 
çl£
;

96 
	`kä“
(
r
->
d¿š_buf
);

97 
	`kä“
(
r
->
buf
);

98 
r
->
buf
 = 
NULL
;

99 
	}
}

101 
wifi_”rÜ
 
	$wlog_g‘_ršg_¡©us
(
scsc_wlog_ršg
 *
r
,

102 
scsc_wifi_ršg_bufãr_¡©us
 *
¡©us
)

104 ià(!
r
 || !
¡©us
)

105  
WIFI_ERROR_INVALID_ARGS
;

107 *
¡©us
 = 
r
->
¡
;

109  
WIFI_SUCCESS
;

110 
	}
}

112 
	$wlog_»ad_»cÜds
(
scsc_wlog_ršg
 *
r
, 
u8
 *
buf
,

113 
size_t
 
bËn
, 
u32
 *
»cÜds
,

114 
scsc_wifi_ršg_bufãr_¡©us
 *
¡©us
,

115 
boŞ
 
is_u£r
)

117 
u16
 
»ad_by‹s
 = 0, 
»c_sz
 = 0;

118 
u32
 
gÙ_»cÜds
 = 0, 
»q_»cÜds
 = -1;

119 
»t_ignÜe
 = 0;

121 ià(
	`scsc_wlog_ršg_is_æushšg
(
r
))

129 ià(
»cÜds
)

130 
»q_»cÜds
 = *
»cÜds
;

144 
	`¿w_¥š_lock
(&
r
->
¾ock
);

145 !
	`scsc_wlog_is_ršg_em±y
(
r
è&& 
gÙ_»cÜds
 < 
»q_»cÜds
) {

146 
»c_sz
 = 
	`REC_SZ
(
r
, 
	`RPOS
(r));

147 ià(
»ad_by‹s
 + 
»c_sz
 > 
bËn
)

153 ià(
is_u£r
)

155 
»t_ignÜe
 = 
	`cİy_to_u£r
(
buf
 + 
»ad_by‹s
, 
	`REC_START
(
r
, 
	`RPOS
Ô)), 
»c_sz
);

158 
	`memıy
(
buf
 + 
»ad_by‹s
, 
	`REC_START
(
r
, 
	`RPOS
Ô)), 
»c_sz
);

160 
»ad_by‹s
 +ğ
»c_sz
;

161 
r
->
¡
.
»ad_by‹s
 +ğ
»c_sz
;

162 
gÙ_»cÜds
++;

164 ià(
¡©us
)

165 *
¡©us
 = 
r
->
¡
;

166 
	`¿w_¥š_uÆock
(&
r
->
¾ock
);

168 ià(
»cÜds
)

169 *
»cÜds
 = 
gÙ_»cÜds
;

170 
	`SCSC_TAG_DBG4
(
WLOG
, "BytesRead:%d -- RecordsRead:%d\n",

171 
»ad_by‹s
, 
gÙ_»cÜds
);

173  
»ad_by‹s
;

174 
	}
}

176 
	$wlog_deçuÉ_ršg_d¿š”
(
scsc_wlog_ršg
 *
r
, 
size_t
 
d¿š_sz
)

178 
rv®
 = 0, 
d¿šed_by‹s
 = 0;

179 
size_t
 
chunk_sz
 = 
d¿š_sz
 <ğ
r
->drain_sz ? drain_sz :„->drain_sz;

180 
scsc_wifi_ršg_bufãr_¡©us
 
ršg_¡©us
 = {};

183 
	`mu‹x_lock
(&
r
->
d¿š_lock
);

186 
rv®
 = 
r
->
İs
.
	`»ad_»cÜds
Ô,„->
d¿š_buf
, 
chunk_sz
, 
NULL
, &
ršg_¡©us
, 
çl£
);

188 ià(!
r
->
æushšg
) {

189 
	`mu‹x_lock
(&
r
->
wl
->
lock
);

190 ià(
rv®
 > 0 && 
r
->
wl
->
Ú_ršg_bufãr_d©a_cb
) {

191 
	`SCSC_TAG_DEBUG
(
WLOG
,

193 
r
->
wl
->
Ú_ršg_bufãr_d©a_cb
, 
rv®
);

194 
r
->
wl
->
	`Ú_ršg_bufãr_d©a_cb
Ô->
¡
.
Çme
,„->
d¿š_buf
, 
rv®
,

195 &
ršg_¡©us
, 
r
->
wl
->
Ú_ršg_bufãr_ùx
);

196 
	`SCSC_TAG_DBG4
(
WLOG
, "C®lback…roûs£d %d by‹s\n", 
rv®
);

198 
	`mu‹x_uÆock
(&
r
->
wl
->
lock
);

200 
d¿šed_by‹s
 +ğ
rv®
;

201 } 
rv®
 && 
d¿šed_by‹s
 <ğ
d¿š_sz
);

202 
	`SCSC_TAG_DBG3
(
WLOG
, "% %d by‹s\n", (
r
->
æushšg
) ? "Flushed" : "Drained",

203 
d¿šed_by‹s
);

206 ià(
r
->
æushšg
) {

207 
æags
;

210 
	`¿w_¥š_lock_œq§ve
(&
r
->
wlock
, 
æags
);

211 
r
->
drİ³d
 = 0;

212 
r
->
¡
.
wr™‹n_»cÜds
 = 0;

213 
r
->
¡
.
»ad_by‹s
 =„->¡.
wr™‹n_by‹s
 = 0;

214 
r
->
æushšg
 = 
çl£
;

215 
	`¿w_¥š_uÆock_œq»¡Üe
(&
r
->
wlock
, 
æags
);

216 
	`SCSC_TAG_INFO
(
WLOG
, "Ršg '%s' flushed.\n", 
r
->
¡
.
Çme
);

218 
	`mu‹x_uÆock
(&
r
->
d¿š_lock
);

220  
d¿šed_by‹s
;

221 
	}
}

267 
	$wlog_wr™e_»cÜd
(
scsc_wlog_ršg
 *
r
, 
u8
 *
buf
, 
size_t
 
bËn
,

268 *
ršg_hdr
, 
size_t
 
hËn
, 
u32
 
v”bo£_Ëv–
, 
u64
 
time¡amp
)

270 
u8
 *
¡¬t
 = 
NULL
;

271 
u16
 
chunk_sz
;

272 
æags
;

274 ià(
	`scsc_wlog_ršg_is_æushšg
(
r
))

278 ià(!
	`scsc_wlog_is_mes§ge_®lowed
(
r
, 
v”bo£_Ëv–
))

282 
chunk_sz
 = (
scsc_wifi_ršg_bufãr_’Œy
è+ 
hËn
 + 
bËn
;

283 ià(
chunk_sz
 > 
MAX_RECORD_SZ
) {

284 
	`SCSC_TAG_WARNING
(
WLOG
, "Dropping„ecordƒxceeding %d bytes\n",

285 
chunk_sz
);

289 
	`¿w_¥š_lock_œq§ve
(&
r
->
wlock
, 
æags
);

295 ià(!
r
->
drİ_Ú_fuÎ
 &&„->
mš_d©a_size
 &&

296 
	`AVAIL_BYTES
(
r
è>ğr->
mš_d©a_size
)

297 
	`queue_wÜk
(
r
->
d¿š_wÜkq
, &r->
d¿š_wÜk
);

305 ià(!
	`CAN_FIT
(
r
, 
chunk_sz
)) {

306 
	`SCSC_TAG_DBG4
(
WLOG
, "[%s]:: dropped %zd bytes\n",

307 
r
->
¡
.
Çme
, 
bËn
 + 
hËn
);

308 
r
->
drİ³d
 +ğ
bËn
 + 
hËn
;

309 
	`¿w_¥š_uÆock_œq»¡Üe
(&
r
->
wlock
, 
æags
);

313 
¡¬t
 = 
	`REC_START
(
r
, 
	`WPOS
(r));

314 
	`REC_HEADER_FILL
(
¡¬t
, 
hËn
 + 
bËn
, 
time¡amp
, (
u8
)
r
->
¡
.
æags
,„->
ty³
);

315 
¡¬t
 +ğ(
scsc_wifi_ršg_bufãr_’Œy
);

316 ià(
hËn
) {

317 
	`memıy
(
¡¬t
, 
ršg_hdr
, 
hËn
);

318 
¡¬t
 +ğ
hËn
;

320 ià(
bËn
)

321 
	`memıy
(
¡¬t
, 
buf
, 
bËn
);

323 ià(
¡¬t
 + 
bËn
 > 
	`BUF_END
(
r
))

324 
	`memıy
(
	`BUF_START
(
r
), 
	`BUF_END
Ô), 
¡¬t
 + 
bËn
 - BUF_END(r));

325 
r
->
¡
.
wr™‹n_by‹s
 +ğ
chunk_sz
;

326 
r
->
¡
.
wr™‹n_»cÜds
++;

327 
	`¿w_¥š_uÆock_œq»¡Üe
(&
r
->
wlock
, 
æags
);

329  
chunk_sz
;

330 
	}
}

332 
	$wlog_deçuÉ_ršg_cÚfig_chªge
(
scsc_wlog_ršg
 *
r
,

333 
u32
 
v”bo£_Ëv–
, u32 
æags
,

334 
u32
 
max_š‹rv®_£c
,

335 
u32
 
mš_d©a_size
)

337 
u32
 
Şd_š‹rv®_£c
;

339 
	`SCSC_TAG_DEBUG
(
WLOG
, "Ring: %s -- configuration change.\n",

340 
r
->
¡
.
Çme
);

342 
r
->
mš_d©a_size
 = min_data_size;

343 
Şd_š‹rv®_£c
 = 
r
->
max_š‹rv®_£c
;

344 
r
->
max_š‹rv®_£c
 = max_interval_sec;

346 ià(
r
->
¡©e
 =ğ
RING_STATE_SUSPEND
 &&„->
¡
.
v”bo£_Ëv–
) {

350 ià(
r
->
max_š‹rv®_£c
)

351 
	`mod_tim”
(&
r
->
d¿š_tim”
,

352 
jiff›s
 + 
	`m£cs_to_jiff›s
(
r
->
max_š‹rv®_£c
 * 1000));

353 
r
->
¡©e
 = 
RING_STATE_ACTIVE
;

354 
	`SCSC_TAG_INFO
(
WLOG
, "ACTIVATED„šg: %s\n", 
r
->
¡
.
Çme
);

355 } ià(
r
->
¡©e
 =ğ
RING_STATE_ACTIVE
 && !r->
¡
.
v”bo£_Ëv–
) {

357 
	`d–_tim”_sync
(&
r
->
d¿š_tim”
);

358 
	`ÿnûl_wÜk_sync
(&
r
->
d¿š_wÜk
);

359 
r
->
¡©e
 = 
RING_STATE_SUSPEND
;

360 
	`SCSC_TAG_INFO
(
WLOG
, "SUSPENDED„šg: %s\n", 
r
->
¡
.
Çme
);

361 } ià(
r
->
¡©e
 =ğ
RING_STATE_ACTIVE
) {

362 ià(
Şd_š‹rv®_£c
 !ğ
r
->
max_š‹rv®_£c
) {

363 ià(!
r
->
max_š‹rv®_£c
)

364 
	`d–_tim”_sync
(&
r
->
d¿š_tim”
);

366 
	`mod_tim”
(&
r
->
d¿š_tim”
,

367 
jiff›s
 + 
	`m£cs_to_jiff›s
(
r
->
max_š‹rv®_£c
 * 1000));

369 
	`SCSC_TAG_INFO
(
WLOG
, "RECONFIGURED„šg: %s\n", 
r
->
¡
.
Çme
);

373 
	}
}

375 
wifi_”rÜ
 
	$wlog_¡¬t_loggšg
(
scsc_wlog_ršg
 *
r
,

376 
u32
 
v”bo£_Ëv–
, u32 
æags
,

377 
u32
 
max_š‹rv®_£c
,

378 
u32
 
mš_d©a_size
)

380 ià(!
r
)

381  
WIFI_ERROR_INVALID_ARGS
;

383 
	`scsc_wlog_ršg_chªge_v”bos™y
(
r
, 
v”bo£_Ëv–
);

384 
	`wlog_deçuÉ_ršg_cÚfig_chªge
(
r
, 
v”bo£_Ëv–
, 
æags
,

385 
max_š‹rv®_£c
, 
mš_d©a_size
);

387  
WIFI_SUCCESS
;

388 
	}
}

390 
scsc_wlog_ršg_İs
 
	gdeçuÉ_ršg_İs
 = {

391 .
š™
 = 
NULL
,

392 .
	gfš®ize
 = 
NULL
,

393 .
	gg‘_ršg_¡©us
 = 
wlog_g‘_ršg_¡©us
,

394 .
	g»ad_»cÜds
 = 
wlog_»ad_»cÜds
,

395 .
	gwr™e_»cÜd
 = 
wlog_wr™e_»cÜd
,

396 .
	glogËv–_chªge
 = 
NULL
,

397 .
	gd¿š_ršg
 = 
wlog_deçuÉ_ršg_d¿š”
,

398 .
	g¡¬t_loggšg
 = 
wlog_¡¬t_loggšg
,

401 
	$scsc_wlog_ršg_de¡roy
(
scsc_wlog_ršg
 *
r
)

403 ià(!
r
 ||„->
»gi¡”ed
) {

404 
	`SCSC_TAG_ERR
(
WLOG
, "CªnÙ de¡roy„šg„:%p\n", 
r
);

408 ià(
r
->
š™Ÿlized
 &&„->
İs
.
fš®ize
)

409 
r
->
İs
.
	`fš®ize
(r);

410 
	`wlog_ršg_fš®ize
(
r
);

411 
	`kä“
(
r
);

412 
	}
}

414 
scsc_wlog_ršg
 *
	$scsc_wlog_ršg_ü—‹
(*
ršg_Çme
, 
u32
 
æags
,

415 
u8
 
ty³
, 
u32
 
size
,

416 
ã©u»s_mask
,

417 
š™_cb
 
š™
, 
fš®ize_cb
 
fši
,

418 *
´iv
)

420 
scsc_wlog_ršg
 *
r
 = 
NULL
;

422 
	`WARN_ON
(!
ršg_Çme
 || !
size
);

424 
r
 = 
	`kz®loc
((*r), 
GFP_KERNEL
);

425 ià(!
r
)

426  
r
;

427 
r
->
ty³
 =ype;

428 
r
->
¡
.
æags
 = flags;

429 
r
->
¡
.
rb_by‹_size
 = 
size
;

430 ià(
	`¢´štf
(
r
->
¡
.
Çme
, 
RING_NAME_SZ
 - 1, "%s", 
ršg_Çme
) >= RING_NAME_SZ)

431 
	`SCSC_TAG_WARNING
(
WLOG
, "Ring‚ameoo†ong...truncatedo: %s\n",

432 
r
->
¡
.
Çme
);

434 
	`memıy
(&
r
->
İs
, &
deçuÉ_ršg_İs
, (
scsc_wlog_ršg_İs
));

435 
r
->
İs
.
š™
 = init;

436 
r
->
İs
.
fš®ize
 = 
fši
;

437 
r
->
´iv
 =…riv;

439 ià(
	`wlog_ršg_š™
(
r
)) {

440 
	`SCSC_TAG_ERR
(
WLOG
,

442 
r
->
¡
.
Çme
);

443 
	`kä“
(
r
);

444  
NULL
;

446 ià(
r
->
İs
.
š™
) {

447 ià(
r
->
İs
.
	`š™
(r)) {

448 
	`SCSC_TAG_DBG4
(
WLOG
,

450 
r
->
¡
.
Çme
);

452 
	`SCSC_TAG_ERR
(
WLOG
,

454 
r
->
¡
.
Çme
);

455 
	`scsc_wlog_ršg_de¡roy
(
r
);

456  
NULL
;

459 
r
->
ã©u»s_mask
 = features_mask;

460 
	`¿w_¥š_lock_š™
(&
r
->
¾ock
);

461 
	`¿w_¥š_lock_š™
(&
r
->
wlock
);

462 
r
->
š™Ÿlized
 = 
Œue
;

463 
	`SCSC_TAG_DEBUG
(
WLOG
, "Ršg '%s' in™Ÿlized.\n", 
r
->
¡
.
Çme
);

465  
r
;

466 
	}
}

468 
	$scsc_wlog_»gi¡”_logËv–_chªge_cb
(
scsc_wlog_ršg
 *
r
,

469 (*
ÿÎback
)(
scsc_wlog_ršg
 *
r
, 
u32
 
Ãw_logËv–
))

471 ià(!
ÿÎback
)

472 
r
->
İs
.
logËv–_chªge
 = 
NULL
;

474 
r
->
İs
.
logËv–_chªge
 = 
ÿÎback
;

477 
	}
}

479 
	$scsc_wlog_d¿š_whŞe_ršg
(
scsc_wlog_ršg
 *
r
)

481 
	`SCSC_TAG_INFO
(
WLOG
, "D¿ššg whŞršg %s\n", 
r
->
¡
.
Çme
);

482  
r
->
İs
.
	`d¿š_ršg
Ô,„->
¡
.
rb_by‹_size
);

483 
	}
}

485 
	$scsc_wlog_æush_ršg
(
scsc_wlog_ršg
 *
r
)

487 
r
->
æushšg
 = 
Œue
;

489 
	`queue_wÜk
(
r
->
d¿š_wÜkq
, &r->
d¿š_wÜk
);

490 
	}
}

	@scsc_wifilogger_core.h

6 #iâdeà
_SCSC_WIFILOGGER_CORE_H_


7 
	#_SCSC_WIFILOGGER_CORE_H_


	)

64 
	~"scsc_wifogg”_ty³s.h
"

65 
	~"scsc_wifogg”_š‹º®.h
"

67 
	#DRAIN_BUF_SZ
 4096

	)

69 
	#BUF_SZ
(
r
è(Ô)->
¡
.
rb_by‹_size
)

	)

70 
	#BUF_START
(
r
è(Ô)->
buf
)

	)

71 
	#BUF_END
(
r
è(Ô)->
buf
 + 
	`BUF_SZ
Ô))

	)

72 
	#AVAIL_BYTES
(
r
è(Ô)->
¡
.
wr™‹n_by‹s
 - (r)->¡.
»ad_by‹s
)

	)

79 
	#RPOS
(
r
) \

80 ((
r
)->
¡
.
»ad_by‹s
 & (
	`BUF_SZ
Ôè- 1))

	)

82 
	#WPOS
(
r
) \

83 ((
r
)->
¡
.
wr™‹n_by‹s
 & (
	`BUF_SZ
Ôè- 1))

	)

85 
	#WPOS_INC
(
r
, 
by‹s
) \

86 (((
r
)->
¡
.
wr™‹n_by‹s
 + (
by‹s
)è& (
	`BUF_SZ
Ôè- 1))

	)

88 
	#REC_PAYLOAD_SZ
(
r
, 
pos
) \

89 (*((
u16
 *)((
r
)->
buf
 + (
pos
))))

	)

91 
	#REC_SZ
(
r
, 
pos
) \

92 (
	`REC_PAYLOAD_SZ
(
r
, 
pos
è+ (
scsc_wifi_ršg_bufãr_’Œy
))

	)

94 
	#REC_START
(
r
, 
pos
è(Ô)->
buf
 + (pos))

	)

96 
	#IS_EMPTY
(
r
) \

97 ((
r
)->
¡
.
»ad_by‹s
 =ğÔ)->¡.
wr™‹n_by‹s
)

	)

99 
	#CAN_FIT
(
r
, 
by‹s
) \

100 (
by‹s
 < 
	`BUF_SZ
(
r
) && \

101 (
	`IS_EMPTY
(
r
) || \

102 (
	`WPOS
(
r
è< 
	`RPOS
Ôè&& WPOSÔè+ (
by‹s
) < RPOS(r)) || \

103 (
	`WPOS
(
r
è> 
	`RPOS
Ôè&& (WPOSÔè+ (
by‹s
è< 
	`BUF_SZ
Ôè|| 
	`WPOS_INC
Ô, by‹sè< RPOSÔ)))))

	)

105 
	#REC_HEADER_FILL
(
±r
, 
·ylßd_sz
, 
¹ime¡amp
, 
ræags
, 
¹y³
) \

107 
scsc_wifi_ršg_bufãr_’Œy
 *
h
 = \

108 (
scsc_wifi_ršg_bufãr_’Œy
 *)(
±r
); \

110 
h
->
’Œy_size
 = (
·ylßd_sz
); \

111 
h
->
æags
 |ğ(
ræags
è| 
RING_BUFFER_ENTRY_FLAGS_HAS_TIMESTAMP
; \

112 
h
->
ty³
 = (
¹y³
); \

113 
h
->
time¡amp
 = (
¹ime¡amp
è?: 
	`loÿl_şock
();\

114 } 0)

	)

116 
	#MINIMUM_DRAIN_CHUNK_BYTES
 1024

	)

117 
	#DEFAULT_DRAIN_CHUNK_SZ
(
r
è(Ô)->
¡
.
rb_by‹_size
 / 2)

	)

118 
	#FORCE_DRAIN_CHUNK_SZ
(
r
è(Ô)->
¡
.
rb_by‹_size
 / 4)

	)

119 
	#MAX_RECORD_SZ
 8192

	)

122 
	mRING_STATE_SUSPEND
,

123 
	mRING_STATE_ACTIVE


126 
	gscsc_wlog_ršg
;

128 
	$boŞ
 (*
	tš™_cb
)(
	tscsc_wlog_ršg
 *
	tr
);

129 
	$boŞ
 (*
	tfš®ize_cb
)(
	tscsc_wlog_ršg
 *
	tr
);

131 
	sscsc_wlog_ršg_İs
 {

132 
š™_cb
 
š™
;

133 
fš®ize_cb
 
fš®ize
;

135 
	`wifi_”rÜ
 (*
g‘_ršg_¡©us
)(
scsc_wlog_ršg
 *
r
,

136 
scsc_wifi_ršg_bufãr_¡©us
 *
¡©us
);

137 (*
»ad_»cÜds
)(
scsc_wlog_ršg
 *
r
, 
u8
 *
buf
, 
size_t
 
bËn
,

138 
u32
 *
»cÜds
, 
scsc_wifi_ršg_bufãr_¡©us
 *
¡©us
, 
boŞ
 
is_u£r
);

139 (*
wr™e_»cÜd
)(
scsc_wlog_ršg
 *
r
, 
u8
 *
buf
, 
size_t
 
bËn
,

140 *
hdr
, 
size_t
 
hËn
, 
u32
 
v”bo£_Ëv–
, 
u64
 
time¡amp
);

141 (*
logËv–_chªge
)(
scsc_wlog_ršg
 *
r
, 
u32
 
Ãw_logËv–
);

142 (*
d¿š_ršg
)(
scsc_wlog_ršg
 *
r
, 
size_t
 
d¿š_sz
);

143 
	`wifi_”rÜ
 (*
¡¬t_loggšg
)(
scsc_wlog_ršg
 *
r
, 
u32
 
v”bo£_Ëv–
,

144 
u32
 
æags
, u32 
max_š‹rv®_£c
,

145 
u32
 
mš_d©a_size
);

148 
	sscsc_wlog_ršg
 {

149 
boŞ
 
š™Ÿlized
;

150 
boŞ
 
»gi¡”ed
;

151 
boŞ
 
æushšg
;

152 
boŞ
 
drİ_Ú_fuÎ
;

153 
u8
 
¡©e
;

155 
u8
 *
buf
;

156 
ã©u»s_mask
;

157 
u8
 
ty³
;

158 
u32
 
mš_d©a_size
;

159 
u32
 
max_š‹rv®_£c
;

160 
u32
 
drİ³d
;

161 
u32
 *
v”bos™y
;

162 
¿w_¥šlock_t
 
¾ock
, 
wlock
;

163 
scsc_wifi_ršg_bufãr_¡©us
 
¡
;

165 
u8
 *
d¿š_buf
;

166 
size_t
 
d¿š_sz
;

167 
mu‹x
 
d¿š_lock
;

168 
tim”_li¡
 
d¿š_tim”
;

169 
wÜk_¡ruù
 
d¿š_wÜk
;

170 
wÜkqueue_¡ruù
 *
d¿š_wÜkq
;

172 
scsc_wlog_ršg_İs
 
İs
;

174 *
´iv
;

176 
scsc_wifi_logg”
 *
wl
;

179 
scsc_wlog_ršg
 *
	`scsc_wlog_ršg_ü—‹
(*
ršg_Çme
, 
u32
 
æags
,

180 
u8
 
ty³
, 
u32
 
size
,

181 
ã©u»s_mask
,

182 
š™_cb
 
š™
, 
fš®ize_cb
 
fši
,

183 *
´iv
);

185 
	`scsc_wlog_ršg_de¡roy
(
scsc_wlog_ršg
 *
r
);

187 
	`scsc_wlog_»gi¡”_logËv–_chªge_cb
(
scsc_wlog_ršg
 *
r
,

188 (*
ÿÎback
)(
scsc_wlog_ršg
 *
r
,

189 
u32
 
Ãw_logËv–
));

191 
	`scsc_wlog_d¿š_whŞe_ršg
(
scsc_wlog_ršg
 *
r
);

193 
šlše
 
boŞ
 
	$scsc_wlog_is_ršg_em±y
(
scsc_wlog_ršg
 *
r
)

195  
r
->
¡
.
wr™‹n_by‹s
 =ğr->¡.
»ad_by‹s
;

196 
	}
}

198 
šlše
 
wifi_”rÜ
 
	$scsc_wlog_g‘_ršg_¡©us
(
scsc_wlog_ršg
 *
r
,

199 
scsc_wifi_ršg_bufãr_¡©us
 *
¡©us
)

201 ià(!
r
)

202  
WIFI_ERROR_INVALID_ARGS
;

204  
r
->
İs
.
	`g‘_ršg_¡©us
Ô, 
¡©us
);

205 
	}
}

207 
šlše
 
boŞ
 
	$scsc_wlog_is_mes§ge_®lowed
(
scsc_wlog_ršg
 *
r
, 
u32
 
v”bo£_Ëv–
)

209  
r
->
¡
.
v”bo£_Ëv–
 && verbose_level <=„->st.verbose_level;

210 
	}
}

212 
šlše
 
	$scsc_wlog_»ad_»cÜds
(
scsc_wlog_ršg
 *
r
, 
u8
 *
buf
, 
size_t
 
bËn
, 
boŞ
 
is_u£r
)

214  
r
->
İs
.
	`»ad_»cÜds
Ô, 
buf
, 
bËn
, 
NULL
, NULL, 
çl£
);

215 
	}
}

217 
šlše
 
	$scsc_wlog_»ad_max_»cÜds
(
scsc_wlog_ršg
 *
r
, 
u8
 *
buf
,

218 
size_t
 
bËn
, 
u32
 *
max_»cÜds
, 
boŞ
 
is_u£r
)

220  
r
->
İs
.
	`»ad_»cÜds
Ô, 
buf
, 
bËn
, 
max_»cÜds
, 
NULL
, 
is_u£r
);

221 
	}
}

223 
šlše
 
	$scsc_wlog_wr™e_»cÜd
(
scsc_wlog_ršg
 *
r
, 
u8
 *
buf
, 
size_t
 
bËn
,

224 *
hdr
, 
size_t
 
hËn
, 
u32
 
v”bo£_Ëv–
, 
u64
 
time¡amp
)

226  
r
->
İs
.
	`wr™e_»cÜd
Ô, 
buf
, 
bËn
, 
hdr
, 
hËn
, 
v”bo£_Ëv–
, 
time¡amp
);

227 
	}
}

229 
šlše
 
wifi_”rÜ
 
	$scsc_wlog_¡¬t_loggšg
(
scsc_wlog_ršg
 *
r
,

230 
u32
 
v”bo£_Ëv–
, u32 
æags
,

231 
u32
 
max_š‹rv®_£c
, u32 
mš_d©a_size
)

233  
r
->
İs
.
	`¡¬t_loggšg
Ô, 
v”bo£_Ëv–
, 
æags
, 
max_š‹rv®_£c
, 
mš_d©a_size
);

234 
	}
}

236 
šlše
 
	$scsc_wlog_ršg_£t_drİ_Ú_fuÎ
(
scsc_wlog_ršg
 *
r
)

238 
r
->
drİ_Ú_fuÎ
 = 
Œue
;

239 
	}
}

241 
šlše
 
	$scsc_wlog_»gi¡”_v”bos™y_»ã»nû
(
scsc_wlog_ršg
 *
r
, 
u32
 *
v”bo£_»f
)

243 
r
->
v”bos™y
 = 
v”bo£_»f
;

244 
	}
}

246 
šlše
 
boŞ
 
	$scsc_wlog_ršg_is_æushšg
(
scsc_wlog_ršg
 *
r
)

248 ià(!
r
->
æushšg
)

249  
çl£
;

251 
	`SCSC_TAG_DBG4
(
WLOG
, "Ring is flushing..abort…ending„ead/write\n");

252  
Œue
;

253 
	}
}

255 
šlše
 
	$scsc_wlog_ršg_chªge_v”bos™y
(
scsc_wlog_ršg
 *
r
, 
u32
 
v”bo£_Ëv–
)

257 ià(
r
->
¡
.
v”bo£_Ëv–
 != verbose_level) {

258 ià(
r
->
İs
.
logËv–_chªge
)

259 
r
->
İs
.
	`logËv–_chªge
Ô, 
v”bo£_Ëv–
);

260 
r
->
¡
.
v”bo£_Ëv–
 = verbose_level;

261 ià(
r
->
v”bos™y
)

262 *
r
->
v”bos™y
 =„->
¡
.
v”bo£_Ëv–
;

263 
	`SCSC_TAG_INFO
(
WLOG
, "Ring: %s -- verbose_level changedo: %d\n",

264 
r
->
¡
.
Çme
,„->¡.
v”bo£_Ëv–
);

266 
	}
}

268 
scsc_wlog_æush_ršg
(
scsc_wlog_ršg
 *
r
);

	@scsc_wifilogger_debugfs.c

6 
	~<lšux/uacûss.h
>

7 
	~"scsc_wifogg”_debugfs.h
"

8 
	~"scsc_wifogg”_ršg_pktç‹.h
"

10 
d’Œy
 *
	gscsc_wlog_debugfs_glob®_roÙ
;

12 
	$dfs_İ’
(
šode
 *
šo
, 
fe
 *
fp
)

14 ià(!
fp
->
´iv©e_d©a
) {

15 
fp
->
´iv©e_d©a
 = 
šo
->
i_´iv©e
;

16 ià(!
fp
->
´iv©e_d©a
)

17  -
EFAULT
;

20 
	}
}

22 
	$dfs_»Ëa£
(
šode
 *
šo
, 
fe
 *
fp
)

25 
	}
}

27 
	#SCSC_RING_TEST_STAT_SZ
 512

	)

29 
ssize_t
 
	$dfs_¡©s_»ad
(
fe
 *
fp
, 
__u£r
 *
ubuf
,

30 
size_t
 
couÁ
, 
loff_t
 *
f_pos
)

32 
¦’
 = 0;

33 
¡©¡r
[
SCSC_RING_TEST_STAT_SZ
] = {};

34 
scsc_ršg_‹¡_objeù
 *
¹o
 = 
fp
->
´iv©e_d©a
;

36 
¦’
 = 
	`¢´štf
(
¡©¡r
, 
SCSC_RING_TEST_STAT_SZ
,

39 
¹o
->
r
->
¡
.
Çme
,„to->r->¡.
rb_by‹_size
,„to->r->
¡©e
,

40 
¹o
->
r
->
¡
.
v”bo£_Ëv–
,„to->r->
mš_d©a_size
,

41 
¹o
->
r
->
max_š‹rv®_£c
,„to->r->
drİ_Ú_fuÎ
,

42 
¹o
->
r
->
¡
.
wr™‹n_by‹s
 -„to->r->¡.
»ad_by‹s
,

43 
¹o
->
r
->
¡
.
wr™‹n_by‹s
,„to->r->¡.
»ad_by‹s
,

44 
¹o
->
r
->
¡
.
wr™‹n_»cÜds
,„to->r->
drİ³d
,„to->r->
buf
);

45 ià(
¦’
 >ğ0 && *
f_pos
 < slen) {

46 
couÁ
 = (couÁ <ğ
¦’
 - *
f_pos
) ? count : (slen - *f_pos);

47 ià(
	`cİy_to_u£r
(
ubuf
, 
¡©¡r
 + *
f_pos
, 
couÁ
))

48  -
EFAULT
;

49 *
f_pos
 +ğ
couÁ
;

51 
couÁ
 = 0;

53  
couÁ
;

54 
	}
}

56 cÚ¡ 
fe_İ”©iÚs
 
	g¡©s_fİs
 = {

57 .
owÃr
 = 
THIS_MODULE
,

58 .
	gİ’
 = 
dfs_İ’
,

59 .
	g»ad
 = 
dfs_¡©s_»ad
,

60 .
	g»Ëa£
 = 
dfs_»Ëa£
,

63 #ifdeà
CONFIG_SCSC_WIFILOGGER_TEST


64 
	$dfs_»ad_»cÜd_İ’
(
šode
 *
šo
, 
fe
 *
fp
)

66 
»t
;

67 
scsc_ršg_‹¡_objeù
 *
¹o
;

69 
»t
 = 
	`dfs_İ’
(
šo
, 
fp
);

70 ià(
»t
)

71  
»t
;

73 
¹o
 = 
fp
->
´iv©e_d©a
;

74 ià(!
	`mu‹x_Œylock
(&
¹o
->
»ad”s_lock
)) {

75 
	`SCSC_TAG_ERR
(
WLOG
,

77 
	`dfs_»Ëa£
(
šo
, 
fp
);

78  -
EPERM
;

81 
	`scsc_wifi_¡¬t_loggšg
(1, 0x00, 0, 8192, 
¹o
->
r
->
¡
.
Çme
);

83  
»t
;

84 
	}
}

86 
	$dfs_»ad_»cÜd_»Ëa£
(
šode
 *
šo
, 
fe
 *
fp
)

88 
scsc_ršg_‹¡_objeù
 *
¹o
 = 
fp
->
´iv©e_d©a
;

91 
	`scsc_wifi_¡¬t_loggšg
(0, 0x00, 0, 8192, 
¹o
->
r
->
¡
.
Çme
);

92 
	`mu‹x_uÆock
(&
¹o
->
»ad”s_lock
);

93 
	`SCSC_TAG_DEBUG
(
WLOG
, "Readers mutex„eleased.\n");

95  
	`dfs_»Ëa£
(
šo
, 
fp
);

96 
	}
}

98 
ssize_t
 
	$dfs_»ad_»cÜd
(
fe
 *
fp
, 
__u£r
 *
ubuf
,

99 
size_t
 
couÁ
, 
loff_t
 *
f_pos
)

101 
»t
;

102 
scsc_ršg_‹¡_objeù
 *
¹o
;

104 ià(!
fp
->
´iv©e_d©a
)

105  -
EINVAL
;

106 
¹o
 = 
fp
->
´iv©e_d©a
;

108 
	`scsc_wlog_is_ršg_em±y
(
¹o
->
r
)) {

109 ià(
	`wa™_ev’t_š‹¼u±ibË
(
¹o
->
rw_wq
,

110 !
	`scsc_wlog_is_ršg_em±y
(
¹o
->
r
)))

111  -
ERESTARTSYS
;

113 
»t
 = 
	`scsc_wlog_»ad_»cÜds
(
¹o
->
r
,„to->
rbuf
,„to->
bsz
, 
çl£
);

114 
couÁ
 = 
»t
 <= count ?„et : count;

115 ià(
	`cİy_to_u£r
(
ubuf
, 
¹o
->
rbuf
, 
couÁ
))

116  -
EFAULT
;

117 *
f_pos
 +ğ
couÁ
;

119  
couÁ
;

120 
	}
}

122 cÚ¡ 
fe_İ”©iÚs
 
	g»ad_»cÜd_fİs
 = {

123 .
owÃr
 = 
THIS_MODULE
,

124 .
	gİ’
 = 
dfs_»ad_»cÜd_İ’
,

125 .
	g»ad
 = 
dfs_»ad_»cÜd
,

126 .
	g»Ëa£
 = 
dfs_»ad_»cÜd_»Ëa£
,

129 
	$Ú_ršg_‹¡_d©a_cb
(*
ršg_Çme
, *
buf
, 
bsz
,

130 
scsc_wifi_ršg_bufãr_¡©us
 *
¡©us
,

131 *
ùx
)

133 
scsc_ršg_‹¡_objeù
 *
a_¹o
, *
h—d_¹o
 = 
ùx
;

135 
a_¹o
 = 
	`kz®loc
((*a_¹o), 
GFP_KERNEL
);

136 ià(!
a_¹o
)

138 
a_¹o
->
rbuf
 = 
	`km®loc
(
bsz
, 
GFP_KERNEL
);

139 ià(!
a_¹o
->
rbuf
) {

140 
	`kä“
(
a_¹o
);

144 
	`memıy
(
a_¹o
->
rbuf
, 
buf
, 
bsz
);

145 
a_¹o
->
bsz
 = bsz;

146 
	`li¡_add_
(&
a_¹o
->
–em
, &
h—d_¹o
->elem);

147 
	`wake_up_š‹¼u±ibË
(&
h—d_¹o
->
d¿š_wq
);

148 
	}
}

150 
	$dfs_»ad_İ’
(
šode
 *
šo
, 
fe
 *
fp
)

152 
»t
;

153 
scsc_ršg_‹¡_objeù
 *
¹o
;

155 
»t
 = 
	`dfs_İ’
(
šo
, 
fp
);

156 ià(
»t
)

157  
»t
;

160 
¹o
 = 
fp
->
´iv©e_d©a
;

161 ià(!
	`mu‹x_Œylock
(&
¹o
->
»ad”s_lock
)) {

162 
	`SCSC_TAG_ERR
(
WLOG
,

164 
	`dfs_»Ëa£
(
šo
, 
fp
);

165  -
EPERM
;

168 
	`SCSC_TAG_DEBUG
(
WLOG
,

170 
¹o
->
r
->
¡
.
Çme
);

171 
	`scsc_wifi_£t_log_hªdËr
(
Ú_ršg_‹¡_d©a_cb
, 
¹o
);

172 
	`scsc_wifi_¡¬t_loggšg
(1, 0x00, 2, 8192, 
¹o
->
r
->
¡
.
Çme
);

174  
»t
;

175 
	}
}

177 
ssize_t
 
	$dfs_»ad
(
fe
 *
fp
, 
__u£r
 *
ubuf
,

178 
size_t
 
couÁ
, 
loff_t
 *
f_pos
)

180 
size_t
 
»t_couÁ
 = 0;

181 
li¡_h—d
 *
pos
 = 
NULL
, *
i¡
 = NULL;

182 
scsc_ršg_‹¡_objeù
 *
h—d_¹o
, *
a_¹o
;

184 ià(!
fp
->
´iv©e_d©a
)

185  -
EINVAL
;

186 
h—d_¹o
 = 
fp
->
´iv©e_d©a
;

188 
	`li¡_em±y
(&
h—d_¹o
->
–em
)) {

189 ià(
	`wa™_ev’t_š‹¼u±ibË
(
h—d_¹o
->
d¿š_wq
, !
	`li¡_em±y
(&h—d_¹o->
–em
)))

190  -
ERESTARTSYS
;

193 
	`li¡_fÜ_—ch_§ã
(
pos
, 
i¡
, &
h—d_¹o
->
–em
) {

194 
a_¹o
 = 
	`li¡_’Œy
(
pos
, 
scsc_ršg_‹¡_objeù
, 
–em
);

195 
	`SCSC_TAG_DEBUG
(
WLOG
, "Proûssšg†i¡ i‹m: %p\n", 
a_¹o
);

196 ià(!
a_¹o
 || 
»t_couÁ
 +‡_¹o->
bsz
 >ğ
couÁ
) {

197 
	`SCSC_TAG_DEBUG
(
WLOG
, "BREAK OUT on:%p\n", 
a_¹o
);

198 
	`li¡_d–
(
pos
);

199 ià(
a_¹o
) {

200 
	`kä“
(
a_¹o
->
rbuf
);

201 
	`kä“
(
a_¹o
);

205 ià(
	`cİy_to_u£r
(
ubuf
 + 
»t_couÁ
, 
a_¹o
->
rbuf
,‡_¹o->
bsz
))

206  -
EFAULT
;

207 
»t_couÁ
 +ğ
a_¹o
->
bsz
;

208 
	`li¡_d–
(
pos
);

209 
	`kä“
(
a_¹o
->
rbuf
);

210 
	`kä“
(
a_¹o
);

212 *
f_pos
 +ğ
»t_couÁ
;

214  
couÁ
;

215 
	}
}

217 
	$dfs_»ad_»Ëa£
(
šode
 *
šo
, 
fe
 *
fp
)

219 
»t
;

220 
scsc_ršg_‹¡_objeù
 *
h—d_¹o
, *
a_¹o
;

222 
h—d_¹o
 = 
fp
->
´iv©e_d©a
;

223 ià(
h—d_¹o
) {

224 
li¡_h—d
 *
pos
 = 
NULL
, *
i¡
 = NULL;

226 
	`li¡_fÜ_—ch_§ã
(
pos
, 
i¡
, &
h—d_¹o
->
–em
) {

227 
a_¹o
 = 
	`li¡_’Œy
(
pos
, 
scsc_ršg_‹¡_objeù
, 
–em
);

228 
	`li¡_d–
(
pos
);

229 ià(
a_¹o
) {

230 
	`kä“
(
a_¹o
->
rbuf
);

231 
	`kä“
(
a_¹o
);

232 
a_¹o
 = 
NULL
;

237 
»t
 = 
	`dfs_»ad_»cÜd_»Ëa£
(
šo
, 
fp
);

238 
	`scsc_wifi_»£t_log_hªdËr
();

240  
»t
;

241 
	}
}

243 cÚ¡ 
fe_İ”©iÚs
 
	g»ad_fİs
 = {

244 .
owÃr
 = 
THIS_MODULE
,

245 .
	gİ’
 = 
dfs_»ad_İ’
,

246 .
	g»ad
 = 
dfs_»ad
,

247 .
	g»Ëa£
 = 
dfs_»ad_»Ëa£
,

250 
	#BUF_LEN
 16

	)

251 
ssize_t
 
	$dfs_v”bo£_»ad
(
fe
 *
fp
, 
__u£r
 *
ubuf
,

252 
size_t
 
couÁ
, 
loff_t
 *
f_pos
)

254 
buf
[
BUF_LEN
] = {};

255 
scsc_ršg_‹¡_objeù
 *
¹o
;

257 ià(!
fp
->
´iv©e_d©a
)

258  -
EINVAL
;

259 
¹o
 = 
fp
->
´iv©e_d©a
;

261 
couÁ
 = 
	`¢´štf
(
buf
, 
BUF_LEN
, "%d\n", 
¹o
->
r
->
¡
.
v”bo£_Ëv–
);

262 ià(
	`cİy_to_u£r
(
ubuf
, 
buf
, 
couÁ
))

263  -
EFAULT
;

265 
couÁ
 = !*
f_pos
 ? count : 0;

266 *
f_pos
 +ğ
couÁ
;

268  
couÁ
;

269 
	}
}

271 
ssize_t
 
	$dfs_v”bo£_wr™e
(
fe
 *
fp
, cÚ¡ 
__u£r
 *
ubuf
,

272 
size_t
 
couÁ
, 
loff_t
 *
f_pos
)

274 
buf
[
BUF_LEN
] = {};

275 
size_t
 
wr™‹n
;

276 
v”b
;

277 
scsc_ršg_‹¡_objeù
 *
¹o
;

279 ià(!
fp
->
´iv©e_d©a
)

280  -
EINVAL
;

281 
¹o
 = 
fp
->
´iv©e_d©a
;

283 
couÁ
 = couÁ < 
BUF_LEN
 ? count : BUF_LEN - 1;

284 ià(
	`cİy_äom_u£r
(
buf
, 
ubuf
, 
couÁ
))

285  -
EINVAL
;

286 ià(!
	`k¡¹oul
((cÚ¡ *)
buf
, 10, &
v”b
))

287 
	`scsc_wlog_ršg_chªge_v”bos™y
(
¹o
->
r
, 
v”b
);

288 
wr™‹n
 = 
	`¡¾’
(
buf
);

289 *
f_pos
 +ğ
wr™‹n
;

291 
	`SCSC_TAG_DEBUG
(
WLOG
, "Changed verbosity on„ing %so %d\n",

292 
¹o
->
r
->
¡
.
Çme
,„to->r->¡.
v”bo£_Ëv–
);

294 
¹o
->
r
->
¡
.
v”bo£_Ëv–
) {

296 
	`SCSC_TAG_DEBUG
(
WLOG
, "Ring '%s' -- RING FULL DRAIN !\n",

297 
¹o
->
r
->
¡
.
Çme
);

298 
	`scsc_wifi_g‘_ršg_d©a
(
¹o
->
r
->
¡
.
Çme
);

301 
	`scsc_wlog_æush_ršg
(
¹o
->
r
);

302 
	`SCSC_TAG_DEBUG
(
WLOG
, "Ring '%s' -- RING FLUSH !\n",

303 
¹o
->
r
->
¡
.
Çme
);

306 
	`scsc_wlog_ršg_£t_drİ_Ú_fuÎ
(
¹o
->
r
);

307 
	`SCSC_TAG_DEBUG
(
WLOG
, "Ring '%s' -- RING SET DROP ON FULL !\n",

308 
¹o
->
r
->
¡
.
Çme
);

311 ià(
¹o
->
r
->
ã©u»s_mask
 & 
WIFI_LOGGER_PACKET_FATE_SUPPORTED
) {

312 
	`scsc_wifogg”_ršg_pktç‹_¡¬t_mÚ™Üšg
();

313 
	`SCSC_TAG_DEBUG
(
WLOG
, "PKTFATE MONITORING STARTED !\n");

318 
i
, 
num_ršgs
 = 10;

319 
scsc_wifi_ršg_bufãr_¡©us
 
¡©us
[10];

321 
	`scsc_wifogg”_g‘_ršgs_¡©us
(&
num_ršgs
, 
¡©us
);

322 
	`SCSC_TAG_INFO
(
WLOG
, "R‘uºed„šgs: %d\n", 
num_ršgs
);

323 
i
 = 0; i < 
num_ršgs
; i++)

324 
	`SCSC_TAG_INFO
(
WLOG
, "R‘r›ved„šg: %s\n", 
¡©us
[
i
].
Çme
);

331  
wr™‹n
;

332 
	}
}

334 cÚ¡ 
fe_İ”©iÚs
 
	gv”bos™y_fİs
 = {

335 .
owÃr
 = 
THIS_MODULE
,

336 .
	gİ’
 = 
dfs_İ’
,

337 .
	g»ad
 = 
dfs_v”bo£_»ad
,

338 .
	gwr™e
 = 
dfs_v”bo£_wr™e
,

339 .
	g»Ëa£
 = 
dfs_»Ëa£
,

346 
scsc_ršg_‹¡_objeù
 *
	$š™_ršg_‹¡_objeù
(
scsc_wlog_ršg
 *
r
)

348 
scsc_ršg_‹¡_objeù
 *
¹o
;

350 
¹o
 = 
	`kz®loc
((*¹o), 
GFP_KERNEL
);

351 ià(!
¹o
)

352  
¹o
;

354 #ifdeà
CONFIG_SCSC_WIFILOGGER_TEST


355 
¹o
->
bsz
 = 
MAX_RECORD_SZ
;

356 
¹o
->
rbuf
 = 
	`kz®loc
Ôto->
bsz
, 
GFP_KERNEL
);

357 ià(!
¹o
->
rbuf
) {

358 
	`kä“
(
¹o
);

359  
NULL
;

361 
¹o
->
wbuf
 = 
	`kz®loc
Ôto->
bsz
, 
GFP_KERNEL
);

362 ià(!
¹o
->
wbuf
) {

363 
	`kä“
(
¹o
->
rbuf
);

364 
	`kä“
(
¹o
);

365  
NULL
;

368 
	`INIT_LIST_HEAD
(&
¹o
->
–em
);

369 
	`š™_wa™queue_h—d
(&
¹o
->
d¿š_wq
);

370 
	`š™_wa™queue_h—d
(&
¹o
->
rw_wq
);

371 
	`mu‹x_š™
(&
¹o
->
»ad”s_lock
);

373 
¹o
->
r
 =„;

375  
¹o
;

376 
	}
}

378 *
	$scsc_wlog_»gi¡”_debugfs_’Œy
(cÚ¡ *
ršg_Çme
,

379 cÚ¡ *
âame
,

380 cÚ¡ 
fe_İ”©iÚs
 *
fİs
,

381 *
¹o
,

382 
scsc_wlog_debugfs_šfo
 *
di
)

384 ià(!
ršg_Çme
 || !
âame
 || !
fİs
 || !
¹o
 || !
di
)

385  
NULL
;

388 ià(!
di
->
roÙdœ
) {

389 ià(
scsc_wlog_debugfs_glob®_roÙ
) {

390 
di
->
roÙdœ
 = 
scsc_wlog_debugfs_glob®_roÙ
;

392 
di
->
roÙdœ
 = 
	`debugfs_ü—‹_dœ
(
SCSC_DEBUGFS_ROOT_DIRNAME
, 
NULL
);

393 
scsc_wlog_debugfs_glob®_roÙ
 = 
di
->
roÙdœ
;

395 ià(!
di
->
roÙdœ
)

396 
no_roÙdœ
;

399 ià(!
di
->
ršgdœ
) {

400 
di
->
ršgdœ
 = 
	`debugfs_ü—‹_dœ
(
ršg_Çme
, di->
roÙdœ
);

401 ià(!
di
->
ršgdœ
)

402 
no_ršgdœ
;

406 
	`debugfs_ü—‹_fe
(
âame
, 0664, 
di
->
ršgdœ
, 
¹o
, 
fİs
);

408  
di
;

410 
no_ršgdœ
:

411 
no_roÙdœ
:

412 
	`SCSC_TAG_ERR
(
WLOG
, "Failed WiFiLogger Debugfs basic initialization\n");

413  
NULL
;

414 
	}
}

416 
	$scsc_wifogg”_debugfs_»move_tİ_dœ_»cursive
()

418 ià(!
scsc_wlog_debugfs_glob®_roÙ
)

421 
	`debugfs_»move_»cursive
(
scsc_wlog_debugfs_glob®_roÙ
);

423 
	`SCSC_TAG_INFO
(
WLOG
, "Wi-Fi Logger Debugfs Cleaned Up\n");

424 
	}
}

426 
	$scsc_»gi¡”_commÚ_debugfs_’Œ›s
(*
ršg_Çme
, *
¹o
,

427 
scsc_wlog_debugfs_šfo
 *
di
)

429 
	`scsc_wlog_»gi¡”_debugfs_’Œy
(
ršg_Çme
, "stats",

430 &
¡©s_fİs
, 
¹o
, 
di
);

431 #ifdeà
CONFIG_SCSC_WIFILOGGER_TEST


432 
	`scsc_wlog_»gi¡”_debugfs_’Œy
(
ršg_Çme
, "verbose_level",

433 &
v”bos™y_fİs
, 
¹o
, 
di
);

434 
	`scsc_wlog_»gi¡”_debugfs_’Œy
(
ršg_Çme
, "read_record",

435 &
»ad_»cÜd_fİs
, 
¹o
, 
di
);

436 
	`scsc_wlog_»gi¡”_debugfs_’Œy
(
ršg_Çme
, "read",

437 &
»ad_fİs
, 
¹o
, 
di
);

439 
	}
}

	@scsc_wifilogger_debugfs.h

6 #iâdeà
_SCSC_WIFILOGGER_DEBUGFS_H_


7 
	#_SCSC_WIFILOGGER_DEBUGFS_H_


	)

9 
	~<lšux/k”Ãl.h
>

10 
	~<lšux/ty³s.h
>

11 
	~<lšux/moduË.h
>

12 
	~<lšux/debugfs.h
>

13 
	~<lšux/v”siÚ.h
>

14 
	~<lšux/mu‹x.h
>

15 
	~<lšux/wa™.h
>

16 
	~<lšux/¦ab.h
>

17 
	~<lšux/fs.h
>

18 
	~<lšux/vm®loc.h
>

19 
	~<asm/uacûss.h
>

21 
	~<scsc/scsc_logršg.h
>

23 
	~"scsc_wifogg”_cÜe.h
"

24 
	~"scsc_wifogg”.h
"

26 
	#SCSC_DEBUGFS_ROOT
 "/sys/k”Ãl/debug/wifogg”"

	)

27 
	#SCSC_DEBUGFS_ROOT_DIRNAME
 "wifogg”"

	)

29 
	sscsc_wlog_debugfs_šfo
 {

30 
d’Œy
 *
	mroÙdœ
;

31 
d’Œy
 *
	mršgdœ
;

34 
	sscsc_ršg_‹¡_objeù
 {

35 
scsc_wlog_ršg
 *
	mr
;

36 #ifdeà
CONFIG_SCSC_WIFILOGGER_TEST


37 *
	mrbuf
;

38 *
	mwbuf
;

39 
size_t
 
	mbsz
;

40 
li¡_h—d
 
	m–em
;

41 
wa™_queue_h—d_t
 
	md¿š_wq
;

42 
wa™_queue_h—d_t
 
	mrw_wq
;

43 
mu‹x
 
	m»ad”s_lock
;

47 *
scsc_wlog_»gi¡”_debugfs_’Œy
(cÚ¡ *
ršg_Çme
,

48 cÚ¡ *
âame
,

49 cÚ¡ 
fe_İ”©iÚs
 *
fİs
,

50 *
¹o
,

51 
scsc_wlog_debugfs_šfo
 *
di
);

53 
scsc_ršg_‹¡_objeù
 *
š™_ršg_‹¡_objeù
(
scsc_wlog_ršg
 *
r
);

55 
scsc_wifogg”_debugfs_»move_tİ_dœ_»cursive
();

57 
scsc_»gi¡”_commÚ_debugfs_’Œ›s
(*
ršg_Çme
, *
¹o
,

58 
scsc_wlog_debugfs_šfo
 *
di
);

60 
dfs_İ’
(
šode
 *
šo
, 
fe
 *
fp
);

62 
dfs_»Ëa£
(
šode
 *
šo
, 
fe
 *
fp
);

	@scsc_wifilogger_internal.c

6 
	~<lšux/k”Ãl.h
>

7 
	~<lšux/ty³s.h
>

8 
	~<lšux/mu‹x.h
>

9 
	~<lšux/nÙif›r.h
>

10 
	~<lšux/¦ab.h
>

11 
	~<scsc/scsc_logršg.h
>

12 
	~<scsc/scsc_mx.h
>

14 
	~"scsc_wifogg”_š‹º®.h
"

16 
scsc_wifi_logg”
 *
	gwifi_logg”
;

18 
scsc_wifi_logg”
 *
	$scsc_wifogg”_g‘_hªdË
()

20  
wifi_logg”
;

21 
	}
}

23 
boŞ
 
	$scsc_wifogg”_š™
()

25 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

27 
wl
 = 
	`kz®loc
((*wl), 
GFP_KERNEL
);

28 ià(!
wl
) {

29 
	`SCSC_TAG_ERR
(
WLOG
,

31  
çl£
;

34 
	`mu‹x_š™
(&
wl
->
lock
);

35 
wl
->
š™Ÿlized
 = 
Œue
;

36 
wifi_logg”
 = 
wl
;

38  
Œue
;

39 
	}
}

41 
	$scsc_wifogg”_nÙif›r
(
nÙif›r_block
 *
nb
,

42 
ev’t
, *
d©a
)

44 
»t
 = 
NOTIFY_DONE
;

45 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

47 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

48 ià(!
wl
 || !wl->
š™Ÿlized
) {

49 
	`SCSC_TAG_ERR
(
WLOG
, "WiFi Logger NOT initialized !\n");

50  
NOTIFY_BAD
;

53 
ev’t
) {

54 
SCSC_FW_EVENT_FAILURE
:

56 
SCSC_FW_EVENT_MOREDUMP_COMPLETE
:

58 *
·nic_»cÜd_dump
 = 
d©a
;

60 
	`SCSC_TAG_INFO
(
WLOG
, "Notification„eceived: MOREDUMP COMPLETED.\n");

61 
	`SCSC_TAG_DEBUG
(
WLOG
, "PANIC DUMP RX\n-------------------------\n\n%s\n",

62 
·nic_»cÜd_dump
);

63 ià(
wl
->
Ú_®”t_cb
) {

64 
wl
->
	`Ú_®”t_cb
(
·nic_»cÜd_dump
,

65 
PANIC_RECORD_DUMP_BUFFER_SZ
, 0, 
wl
->
Ú_®”t_ùx
);

66 
	`SCSC_TAG_DEBUG
(
WLOG
, "Alert handler --…rocessed %d bytes @%p\n",

67 
PANIC_RECORD_DUMP_BUFFER_SZ
, 
·nic_»cÜd_dump
);

69 
»t
 = 
NOTIFY_OK
;

73 
»t
 = 
NOTIFY_BAD
;

77  
»t
;

78 
	}
}

80 
nÙif›r_block
 
	gfœmw¬e_nb
 = {

81 .
nÙif›r_ÿÎ
 = 
scsc_wifogg”_nÙif›r
,

84 
boŞ
 
	$scsc_wifogg”_fw_®”t_š™
()

86 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

88 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

89 ià(!
wl
 || !wl->
š™Ÿlized
) {

90 
	`SCSC_TAG_ERR
(
WLOG
, "WiFi Logger NOT initialized !\n");

91  
çl£
;

94 
wl
->
ã©u»s_mask
 |ğ
WIFI_LOGGER_MEMORY_DUMP_SUPPORTED
 | 
WIFI_LOGGER_DRIVER_DUMP_SUPPORTED
;

95 ià(!
	`mxmª_»gi¡”_fœmw¬e_nÙif›r
(&
fœmw¬e_nb
))

96 
wl
->
ã©u»s_mask
 |ğ
WIFI_LOGGER_WATCHDOG_TIMER_SUPPORTED
;

98  
Œue
;

99 
	}
}

101 
	$scsc_wifogg”_g‘_ã©u»s
()

103 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

105 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

106 ià(!
wl
 || !wl->
š™Ÿlized
) {

107 
	`SCSC_TAG_ERR
(
WLOG
, "WiFi Logger NOT initialized !\n");

111  
wl
->
ã©u»s_mask
;

112 
	}
}

114 
boŞ
 
	$scsc_wifogg”_g‘_ršgs_¡©us
(
u32
 *
num_ršgs
,

115 
scsc_wifi_ršg_bufãr_¡©us
 *
¡©us
)

117 
i
, 
j
 = 0;

118 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

120 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

121 ià(!
wl
 || !wl->
š™Ÿlized
) {

122 
	`SCSC_TAG_ERR
(
WLOG
, "WiFi Logger NOT initialized !\n");

123 *
num_ršgs
 = 0;

124  
çl£
;

127 
i
 = 0; i < *
num_ršgs
 && i < 
MAX_WIFI_LOGGER_RINGS
; i++)

128 ià(
wl
->
ršgs
[
i
] && wl->ršgs[i]->
»gi¡”ed
)

129 
	`scsc_wlog_g‘_ršg_¡©us
(
wl
->
ršgs
[
i
], &
¡©us
[
j
++]);

130 *
num_ršgs
 = 
j
;

132  
Œue
;

133 
	}
}

135 
scsc_wlog_ršg
 *
	$scsc_wifogg”_g‘_ršg_äom_Çme
(*
Çme
)

137 
i
;

138 
scsc_wlog_ršg
 *
r
 = 
NULL
;

139 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

141 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

142 ià(!
wl
 || !wl->
š™Ÿlized
) {

143 
	`SCSC_TAG_ERR
(
WLOG
,

145  
r
;

148 
	`mu‹x_lock
(&
wl
->
lock
);

149 
i
 = 0; i < 
MAX_WIFI_LOGGER_RINGS
; i++) {

150 ià(
wl
->
ršgs
[
i
] &&

151 !
	`¡ºcmp
(
Çme
, 
wl
->
ršgs
[
i
]->
¡
.Çme, 
RING_NAME_SZ
)) {

152 ià(
wl
->
ršgs
[
i
]->
š™Ÿlized
 &&

153 
wl
->
ršgs
[
i
]->
»gi¡”ed
)

154 
r
 = 
wl
->
ršgs
[
i
];

158 
	`mu‹x_uÆock
(&
wl
->
lock
);

160  
r
;

161 
	}
}

163 
boŞ
 
	$scsc_wifogg”_»gi¡”_ršg
(
scsc_wlog_ršg
 *
r
)

165 
pos
;

166 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

168 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

169 ià(!
wl
 || !wl->
š™Ÿlized
) {

170 
	`SCSC_TAG_ERR
(
WLOG
,

172  
çl£
;

179 
pos
 = 
r
->
¡
.
ršg_id
 % 
MAX_WIFI_LOGGER_RINGS
;

180 
	`mu‹x_lock
(&
wl
->
lock
);

181 ià(
wl
->
ršgs
[
pos
]) {

182 
	`SCSC_TAG_ERR
(
WLOG
,

184 
wl
->
ršgs
[
pos
]->
¡
.
Çme
,…os);

185 
	`mu‹x_uÆock
(&
wl
->
lock
);

186  
çl£
;

188 
	`SCSC_TAG_DEBUG
(
WLOG
, "Registering„ing %s‡s…osition %d\n",

189 
r
->
¡
.
Çme
, 
pos
);

190 
wl
->
ršgs
[
pos
] = 
r
;

191 
wl
->
ã©u»s_mask
 |ğ
r
->features_mask;

192 
r
->
wl
 = wl;

193 
r
->
»gi¡”ed
 = 
Œue
;

194 
	`mu‹x_uÆock
(&
wl
->
lock
);

195 
	`SCSC_TAG_INFO
(
WLOG
, "Ršg '%s'„egi¡”ed\n", 
r
->
¡
.
Çme
);

197  
Œue
;

198 
	}
}

200 
	$scsc_wifogg”_de¡roy
()

202 
i
;

203 
scsc_wlog_ršg
 *
r
 = 
NULL
;

204 
scsc_wifi_logg”
 *
wl
 = 
NULL
;

206 
wl
 = 
	`scsc_wifogg”_g‘_hªdË
();

207 ià(!
wl
 || !wl->
š™Ÿlized
) {

208 
	`SCSC_TAG_ERR
(
WLOG
,

213 
	`mxmª_uÄegi¡”_fœmw¬e_nÙif›r
(&
fœmw¬e_nb
);

215 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


216 
	`scsc_wifogg”_debugfs_»move_tİ_dœ_»cursive
();

219 
	`mu‹x_lock
(&
wl
->
lock
);

220 
i
 = 0; i < 
MAX_WIFI_LOGGER_RINGS
; i++) {

221 ià(
wl
->
ršgs
[
i
]) {

222 
r
 = 
wl
->
ršgs
[
i
];

223 
	`scsc_wlog_ršg_chªge_v”bos™y
(
r
, 
WLOG_NONE
);

224 
r
->
»gi¡”ed
 = 
çl£
;

225 
wl
->
ršgs
[
i
] = 
NULL
;

226 ià(
r
->
š™Ÿlized
)

227 
	`scsc_wlog_ršg_de¡roy
(
r
);

230 
wl
->
ã©u»s_mask
 = 0;

231 
	`mu‹x_uÆock
(&
wl
->
lock
);

232 
	`kä“
(
wl
);

233 
wifi_logg”
 = 
NULL
;

234 
	}
}

	@scsc_wifilogger_internal.h

6 #iâdeà
_SCSC_WIFILOGGER_INTERNAL_H_


7 
	#_SCSC_WIFILOGGER_INTERNAL_H_


	)

9 
	~<lšux/k”Ãl.h
>

10 
	~<lšux/ty³s.h
>

11 
	~<lšux/mu‹x.h
>

12 
	~<lšux/¦ab.h
>

13 
	~<lšux/b™İs.h
>

15 
	~"scsc_wifogg”_ty³s.h
"

16 
	~"scsc_wifogg”_cÜe.h
"

17 
	~"scsc_wifogg”_debugfs.h
"

19 
	sscsc_wifi_logg”
 {

20 
boŞ
 
	mš™Ÿlized
;

21 
mu‹x
 
	mlock
;

22 
	mã©u»s_mask
;

23 
scsc_wlog_ršg
 *
	mršgs
[
MAX_WIFI_LOGGER_RINGS
];

32 (*
	mÚ_ršg_bufãr_d©a_cb
)(*
	mršg_Çme
, *
	mbufãr
,

33 
	mbufãr_size
,

34 
scsc_wifi_ršg_bufãr_¡©us
 *
	m¡©us
,

35 *
	mùx
);

37 (*
	mÚ_®”t_cb
)(*
	mbufãr
, 
	mbufãr_size
, 
	m”r_code
, *
	mùx
);

39 *
	mÚ_ršg_bufãr_ùx
;

40 *
	mÚ_®”t_ùx
;

43 
boŞ
 
scsc_wifogg”_š™
();

44 
scsc_wifogg”_de¡roy
();

45 
boŞ
 
scsc_wifogg”_fw_®”t_š™
();

46 
scsc_wifi_logg”
 *
scsc_wifogg”_g‘_hªdË
();

47 
scsc_wifogg”_g‘_ã©u»s
();

48 
boŞ
 
scsc_wifogg”_»gi¡”_ršg
(
scsc_wlog_ršg
 *
r
);

49 
scsc_wlog_ršg
 *
scsc_wifogg”_g‘_ršg_äom_Çme
(*
Çme
);

50 
boŞ
 
scsc_wifogg”_g‘_ršgs_¡©us
(
u32
 *
num_ršgs
,

51 
scsc_wifi_ršg_bufãr_¡©us
 *
¡©us
);

	@scsc_wifilogger_module.c

13 
	~"scsc_wifogg”_moduË.h
"

15 
__š™
 
	$scsc_wifogg”_moduË_š™
()

17 ià(
	`scsc_wifogg”_š™
()) {

18 
	`scsc_wifogg”_ršg_cÚÃùiv™y_š™
();

19 
	`scsc_wifogg”_ršg_wak–ock_š™
();

20 
	`scsc_wifogg”_ršg_pktç‹_š™
();

21 #ifdeà
CONFIG_SCSC_WIFILOGGER_TEST


22 
	`scsc_wifogg”_ršg_‹¡_š™
();

24 
	`scsc_wifogg”_fw_®”t_š™
();

26 
	`SCSC_TAG_ERR
(
WLOG
, "Module init failed\n");

27  -
ENOMEM
;

30 
	`SCSC_TAG_INFO
(
WLOG
, "Wi-Fi Logger subsystem initialized.\n");

33 
	}
}

35 
__ex™
 
	$scsc_wifogg”_moduË_ex™
()

37 
	`scsc_wifogg”_de¡roy
();

39 
	`SCSC_TAG_INFO
(
WLOG
, "Wi-Fi Logger subsystem unloaded.\n");

40 
	}
}

42 
moduË_š™
(
scsc_wifogg”_moduË_š™
);

43 
moduË_ex™
(
scsc_wifogg”_moduË_ex™
);

45 
MODULE_LICENSE
("GPL");

46 
MODULE_AUTHOR
("Samsung SLSI");

47 
MODULE_DESCRIPTION
("Android Wi-Fi Logger module");

	@scsc_wifilogger_module.h

7 #iâdeà
_SCSC_WIFILOGGER_MODULE_H_


8 
	#_SCSC_WIFILOGGER_MODULE_H_


	)

10 
	~<lšux/k”Ãl.h
>

11 
	~<lšux/ty³s.h
>

12 
	~<lšux/mu‹x.h
>

13 
	~<lšux/¦ab.h
>

14 
	~<lšux/moduË.h
>

15 
	~<scsc/scsc_logršg.h
>

17 
	~"scsc_wifogg”_š‹º®.h
"

19 
	~"scsc_wifogg”_ršg_cÚÃùiv™y.h
"

20 
	~"scsc_wifogg”_ršg_wak–ock.h
"

21 
	~"scsc_wifogg”_ršg_pktç‹.h
"

23 #ifdeà
CONFIG_SCSC_WIFILOGGER_TEST


24 
	~"scsc_wifogg”_ršg_‹¡.h
"

	@scsc_wifilogger_ring_connectivity.c

7 
	~"scsc_wifogg”_ršg_cÚÃùiv™y.h
"

10 
	~<¡d¬g.h
>

11 
	~"scsc_wifogg”_ršg_cÚÃùiv™y_­i.h
"

12 
	~"scsc_wifogg”_š‹º®.h
"

14 
scsc_wlog_ršg
 *
	gthe_ršg
;

16 
u32
 
	güšg_Ëv
;

17 
EXPORT_SYMBOL
(
üšg_Ëv
);

19 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


20 
	~"scsc_wifogg”_debugfs.h
"

22 
scsc_wlog_debugfs_šfo
 
	gdi
;

26 
boŞ
 
	$scsc_wifogg”_ršg_cÚÃùiv™y_š™
()

28 
scsc_wlog_ršg
 *
r
 = 
NULL
;

29 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


30 
scsc_ršg_‹¡_objeù
 *
¹o
;

33 
r
 = 
	`scsc_wlog_ršg_ü—‹
(
WLOGGER_RCONNECT_NAME
,

34 
RING_BUFFER_ENTRY_FLAGS_HAS_BINARY
,

35 
ENTRY_TYPE_CONNECT_EVENT
, 32768 * 8,

36 
WIFI_LOGGER_CONNECT_EVENT_SUPPORTED
,

37 
NULL
, NULL, NULL);

39 ià(!
r
) {

40 
	`SCSC_TAG_ERR
(
WLOG
, "Failedo CREATE WiFiLogger„ing: %s\n",

41 
WLOGGER_RCONNECT_NAME
);

42  
çl£
;

44 
	`scsc_wlog_»gi¡”_v”bos™y_»ã»nû
(
r
, &
üšg_Ëv
);

46 ià(!
	`scsc_wifogg”_»gi¡”_ršg
(
r
)) {

47 
	`SCSC_TAG_ERR
(
WLOG
, "Failedo REGISTER WiFiLogger„ing: %s\n",

48 
WLOGGER_RCONNECT_NAME
);

49 
	`scsc_wlog_ršg_de¡roy
(
r
);

50  
çl£
;

52 
the_ršg
 = 
r
;

54 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


55 
¹o
 = 
	`š™_ršg_‹¡_objeù
(
the_ršg
);

56 ià(
¹o
)

57 
	`scsc_»gi¡”_commÚ_debugfs_’Œ›s
(
the_ršg
->
¡
.
Çme
, 
¹o
, &
di
);

60  
Œue
;

61 
	}
}

65 
	$scsc_wifogg”_ršg_cÚÃùiv™y_fw_ev’t
(
wlog_v”bo£_Ëv–
 
Ëv
, 
u16
 
fw_ev’t_id
,

66 
u64
 
fw_time¡amp
, *
fw_bulk_d©a
, 
size_t
 
fw_bËn
)

68 
scsc_wifi_ršg_bufãr_driv”_cÚÃùiv™y_ev’t
 
ev’t_™em
;

70 ià(!
the_ršg
)

73 
	`SCSC_TAG_DEBUG
(
WLOG
, "EL -- RX MLME_EVENT_LOG_INFO -ƒvent_id[%d] @0x%x\n",

74 
fw_ev’t_id
, 
fw_time¡amp
);

75 
ev’t_™em
.
ev’t
 = 
fw_ev’t_id
;

77  
	`scsc_wlog_wr™e_»cÜd
(
the_ršg
, 
fw_bulk_d©a
, 
fw_bËn
, &
ev’t_™em
,

78 (
ev’t_™em
), 
Ëv
, 
fw_time¡amp
);

79 
	}
}

80 
EXPORT_SYMBOL
(
scsc_wifogg”_ršg_cÚÃùiv™y_fw_ev’t
);

82 
	$scsc_wifogg”_ršg_cÚÃùiv™y_driv”_ev’t
(
wlog_v”bo£_Ëv–
 
Ëv
,

83 
u16
 
driv”_ev’t_id
, 
g_couÁ
, ...)

85 
i
;

86 
u64
 
time¡amp
;

87 
va_li¡
 
­
;

88 
u8
 
vs
[
MAX_TLVS_SZ
];

89 
size_t
 
vs_sz
 = 0;

90 
scsc_v_log
 *
v
 = 
NULL
;

91 
scsc_wifi_ršg_bufãr_driv”_cÚÃùiv™y_ev’t
 
ev’t_™em
;

93 ià(!
the_ršg
)

96 
time¡amp
 = 
	`loÿl_şock
();

98 
	`SCSC_TAG_DEBUG
(
WLOG
, "EL -- RX Driver CONNECTIVITY EVENT -ƒvent_id[%d] @0x%x\n",

99 
driv”_ev’t_id
, 
time¡amp
);

101 
ev’t_™em
.
ev’t
 = 
driv”_ev’t_id
;

102 
	`va_¡¬t
(
­
, 
g_couÁ
);

103 
i
 = 0; i < 
g_couÁ
 &&

104 
vs_sz
 + (*
v
è< 
MAX_TLVS_SZ
; 
i
++) {

105 
v
 = (
scsc_v_log
 *)(
vs
 + 
vs_sz
);

106 
v
->
g
 = (
u16
)
	`va_¬g
(
­
, );

107 
v
->
Ëngth
 = (
u16
)
	`va_¬g
(
­
, );

108 ià(
vs_sz
 + (*
v
è+lv->
Ëngth
 >ğ
MAX_TLVS_SZ
) {

109 
	`WARN
(
Œue
,

111 
MAX_TLVS_SZ
);

114 
	`memıy
(&
v
->
v®ue
, 
	`va_¬g
(
­
, 
u8
 *),lv->
Ëngth
);

115 
vs_sz
 +ğ(*
v
è+lv->
Ëngth
;

117 
	`va_’d
(
­
);

119  
	`scsc_wlog_wr™e_»cÜd
(
the_ršg
, 
vs
, 
vs_sz
, &
ev’t_™em
,

120 (
ev’t_™em
), 
Ëv
, 
time¡amp
);

121 
	}
}

122 
EXPORT_SYMBOL
(
scsc_wifogg”_ršg_cÚÃùiv™y_driv”_ev’t
);

	@scsc_wifilogger_ring_connectivity.h

6 #iâdeà
__SCSC_WIFILOGGER_RING_CONNECTIVITY_H__


7 
	#__SCSC_WIFILOGGER_RING_CONNECTIVITY_H__


	)

9 
	~<lšux/ty³s.h
>

10 
	~<lšux/wa™.h
>

11 
	~<lšux/mu‹x.h
>

12 
	~<lšux/li¡.h
>

13 
	~<scsc/scsc_logršg.h
>

15 
	~"scsc_wifogg”_cÜe.h
"

16 
	~"scsc_wifogg”.h
"

18 
	#MAX_TLVS_SZ
 1024

	)

19 
	#WLOGGER_RCONNECT_NAME
 "cÚÃùiv™y"

	)

25 
u32
 
üšg_Ëv
;

27 
boŞ
 
scsc_wifogg”_ršg_cÚÃùiv™y_š™
();

29 
scsc_wifogg”_ršg_cÚÃùiv™y_driv”_ev’t
(
wlog_v”bo£_Ëv–
 
Ëv
,

30 
u16
 
driv”_ev’t_id
, 
g_couÁ
, ...);

32 
scsc_wifogg”_ršg_cÚÃùiv™y_fw_ev’t
(
wlog_v”bo£_Ëv–
 
Ëv
, 
u16
 
fw_ev’t_id
,

33 
u64
 
fw_time¡amp
, *
fw_bulk_d©a
, 
size_t
 
fw_bËn
);

	@scsc_wifilogger_ring_connectivity_api.h

6 #iâdeà
__SCSC_WIFILOGGER_RING_CONNECTIVITY_API_H__


7 
	#__SCSC_WIFILOGGER_RING_CONNECTIVITY_API_H__


	)

17 #ià
IS_ENABLED
(
CONFIG_SCSC_WIFILOGGER
)

19 
	~"scsc_wifogg”_ršg_cÚÃùiv™y.h
"

44 
	#SCSC_WLOG_DRIVER_EVENT
(
Ëv
, 
driv”_ev’t_id
, 
g_couÁ
, 
g_¬gs
...) \

46 ià(
üšg_Ëv
 && (
Ëv
) <= cring_lev) \

47 
	`scsc_wifogg”_ršg_cÚÃùiv™y_driv”_ev’t
((
Ëv
), (
driv”_ev’t_id
), \

48 (
g_couÁ
), 
g_¬gs
); \

49 } 0)

	)

66 
	#SCSC_WLOG_FW_EVENT
(
Ëv
, 
fw_ev’t_id
, 
fw_time¡amp
, 
fw_bulk_d©a
, 
fw_bËn
) \

68 ià(
üšg_Ëv
 && (
Ëv
) <= cring_lev) \

69 
	`scsc_wifogg”_ršg_cÚÃùiv™y_fw_ev’t
((
Ëv
), (
fw_ev’t_id
), (
fw_time¡amp
), \

70 (
fw_bulk_d©a
), (
fw_bËn
)); \

71 } 0)

	)

74 
	#SCSC_WLOG_DRIVER_EVENT
(
Ëv
, 
driv”_ev’t_id
, 
g_couÁ
, 
g_¬gs
...èdØ{} 0)

	)

75 
	#SCSC_WLOG_FW_EVENT
(
Ëv
, 
fw_ev’t_id
, 
fw_time¡amp
, 
fw_bulk_d©a
, 
fw_bËn
èdØ{} 0)

	)

	@scsc_wifilogger_ring_pktfate.c

7 
	~"scsc_wifogg”_ršg_pktç‹.h
"

10 
	~<¡d¬g.h
>

11 
	~"scsc_wifogg”_š‹º®.h
"

13 
boŞ
 
	gpktç‹_mÚ™Ü_¡¬‹d
;

15 
wifi_tx_»pÜt
 
	gtxr
;

16 
wifi_rx_»pÜt
 
	grxr
;

17 
scsc_wlog_ršg
 *
	gç‹_ršg_tx
;

18 
scsc_wlog_ršg
 *
	gç‹_ršg_rx
;

20 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


21 
	~"scsc_wifogg”_debugfs.h
"

22 
	~"scsc_wifogg”.h
"

24 
scsc_wlog_debugfs_šfo
 
	gdi_tx
, 
	gdi_rx
;

26 #ifdeà
CONFIG_SCSC_WIFILOGGER_TEST


27 
	~<lšux/uacûss.h
>

29 
ssize_t
 
	$dfs_»ad_ç‹s
(
fe
 *
fp
, 
__u£r
 *
ubuf
,

30 
size_t
 
couÁ
, 
loff_t
 *
f_pos
)

32 
size_t
 
gÙ_sz
, 
n_´ovided_ç‹s
 = 0, 
n_»que¡ed_ç‹s
;

33 
scsc_ršg_‹¡_objeù
 *
¹o
;

34 
wifi_tx_»pÜt
 *
tx_»pÜt_bufs
 = 
NULL
;

35 
wifi_rx_»pÜt
 *
rx_»pÜt_bufs
 = 
NULL
;

36 *
¤cbuf
 = 
NULL
;

38 ià(!
fp
->
´iv©e_d©a
)

39  -
EINVAL
;

40 
¹o
 = 
fp
->
´iv©e_d©a
;

42 ià(!
	`¡ºcmp
(
¹o
->
r
->
¡
.
Çme
, 
WLOGGER_RFATE_TX_NAME
, 
RING_NAME_SZ
 - 1)) {

43 
n_»que¡ed_ç‹s
 = 
couÁ
 / (
wifi_tx_»pÜt
);

44 
tx_»pÜt_bufs
 = 
	`vm®loc
((
wifi_tx_»pÜt
è* 
n_»que¡ed_ç‹s
);

45 ià(
tx_»pÜt_bufs
)

46 
	`scsc_wifi_g‘_tx_pkt_ç‹s
(
tx_»pÜt_bufs
, 
n_»que¡ed_ç‹s
,

47 &
n_´ovided_ç‹s
, 
çl£
);

48 
gÙ_sz
 = (
wifi_tx_»pÜt
è* 
n_´ovided_ç‹s
;

49 
¤cbuf
 = 
tx_»pÜt_bufs
;

51 
n_»que¡ed_ç‹s
 = 
couÁ
 / (
wifi_rx_»pÜt
);

52 
rx_»pÜt_bufs
 = 
	`vm®loc
((
wifi_rx_»pÜt
è* 
n_»que¡ed_ç‹s
);

53 ià(
rx_»pÜt_bufs
)

54 
	`scsc_wifi_g‘_rx_pkt_ç‹s
(
rx_»pÜt_bufs
, 
n_»que¡ed_ç‹s
,

55 &
n_´ovided_ç‹s
, 
çl£
);

56 
gÙ_sz
 = (
wifi_rx_»pÜt
è* 
n_´ovided_ç‹s
;

57 
¤cbuf
 = 
rx_»pÜt_bufs
;

59 
	`SCSC_TAG_DEBUG
(
WLOG
, "Ring '%s'...asked for %d fates....GOT %d\n",

60 
¹o
->
r
->
¡
.
Çme
, 
n_»que¡ed_ç‹s
, 
n_´ovided_ç‹s
);

61 ià(
	`cİy_to_u£r
(
ubuf
, 
¤cbuf
, 
gÙ_sz
))

62  -
EFAULT
;

63 *
f_pos
 +ğ
gÙ_sz
;

65  
gÙ_sz
;

66 
	}
}

68 cÚ¡ 
fe_İ”©iÚs
 
	gg‘_ç‹s_fİs
 = {

69 .
owÃr
 = 
THIS_MODULE
,

70 .
	gİ’
 = 
dfs_İ’
,

71 .
	g»ad
 = 
dfs_»ad_ç‹s
,

72 .
	g»Ëa£
 = 
dfs_»Ëa£
,

78 
boŞ
 
	$is_pktç‹_mÚ™Ü_¡¬‹d
()

80  
pktç‹_mÚ™Ü_¡¬‹d
;

81 
	}
}

82 
EXPORT_SYMBOL
(
is_pktç‹_mÚ™Ü_¡¬‹d
);

84 
boŞ
 
	$scsc_wifogg”_ršg_pktç‹_š™
()

86 
scsc_wlog_ršg
 *
r
 = 
NULL
;

87 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


88 
scsc_ršg_‹¡_objeù
 *
¹o_tx
, *
¹o_rx
;

91 
r
 = 
	`scsc_wlog_ršg_ü—‹
(
WLOGGER_RFATE_TX_NAME
,

92 
RING_BUFFER_ENTRY_FLAGS_HAS_BINARY
,

93 
ENTRY_TYPE_PKT
, 32768 * 4,

94 
WIFI_LOGGER_PACKET_FATE_SUPPORTED
,

95 
NULL
, NULL, NULL);

96 ià(!
r
) {

97 
	`SCSC_TAG_ERR
(
WLOG
, "Failedo CREATE WiFiLogger„ing: %s\n",

98 
WLOGGER_RFATE_TX_NAME
);

99  
çl£
;

101 
ç‹_ršg_tx
 = 
r
;

103 
r
 = 
	`scsc_wlog_ršg_ü—‹
(
WLOGGER_RFATE_RX_NAME
,

104 
RING_BUFFER_ENTRY_FLAGS_HAS_BINARY
,

105 
ENTRY_TYPE_PKT
, 32768 * 4,

106 
WIFI_LOGGER_PACKET_FATE_SUPPORTED
,

107 
NULL
, NULL, NULL);

108 ià(!
r
) {

109 
	`SCSC_TAG_ERR
(
WLOG
, "Failedo CREATE WiFiLogger„ing: %s\n",

110 
WLOGGER_RFATE_RX_NAME
);

111 
	`scsc_wlog_ršg_de¡roy
(
ç‹_ršg_tx
);

112  
çl£
;

114 
ç‹_ršg_rx
 = 
r
;

116 ià(!
	`scsc_wifogg”_»gi¡”_ršg
(
ç‹_ršg_tx
)) {

117 
	`SCSC_TAG_ERR
(
WLOG
, "Failedo REGISTER WiFiLogger„ing: %s\n",

118 
ç‹_ršg_tx
->
¡
.
Çme
);

119 
	`scsc_wlog_ršg_de¡roy
(
ç‹_ršg_tx
);

120 
	`scsc_wlog_ršg_de¡roy
(
ç‹_ršg_rx
);

121  
çl£
;

123 ià(!
	`scsc_wifogg”_»gi¡”_ršg
(
ç‹_ršg_rx
)) {

124 
	`SCSC_TAG_ERR
(
WLOG
, "Failedo REGISTER WiFiLogger„ing: %s\n",

125 
ç‹_ršg_rx
->
¡
.
Çme
);

126 
	`scsc_wlog_ršg_de¡roy
(
ç‹_ršg_tx
);

127 
	`scsc_wlog_ršg_de¡roy
(
ç‹_ršg_rx
);

128  
çl£
;

132 
	`scsc_wlog_ršg_£t_drİ_Ú_fuÎ
(
ç‹_ršg_tx
);

133 
	`scsc_wlog_ršg_£t_drİ_Ú_fuÎ
(
ç‹_ršg_rx
);

135 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


139 
¹o_tx
 = 
	`š™_ršg_‹¡_objeù
(
ç‹_ršg_tx
);

140 ià(
¹o_tx
) {

141 
	`scsc_»gi¡”_commÚ_debugfs_’Œ›s
(
ç‹_ršg_tx
->
¡
.
Çme
, 
¹o_tx
, &
di_tx
);

142 #ifdeà
CONFIG_SCSC_WIFILOGGER_TEST


143 
	`scsc_wlog_»gi¡”_debugfs_’Œy
(
ç‹_ršg_tx
->
¡
.
Çme
, "get_fates",

144 &
g‘_ç‹s_fİs
, 
¹o_tx
, &
di_tx
);

148 
¹o_rx
 = 
	`š™_ršg_‹¡_objeù
(
ç‹_ršg_rx
);

149 ià(
¹o_rx
) {

150 
	`scsc_»gi¡”_commÚ_debugfs_’Œ›s
(
ç‹_ršg_rx
->
¡
.
Çme
, 
¹o_rx
, &
di_rx
);

151 #ifdeà
CONFIG_SCSC_WIFILOGGER_TEST


152 
	`scsc_wlog_»gi¡”_debugfs_’Œy
(
ç‹_ršg_rx
->
¡
.
Çme
, "get_fates",

153 &
g‘_ç‹s_fİs
, 
¹o_rx
, &
di_rx
);

158  
Œue
;

159 
	}
}

161 
	$scsc_wifogg”_ršg_pktç‹_¡¬t_mÚ™Üšg
()

163 ià(!
ç‹_ršg_rx
 || !
ç‹_ršg_tx
)

167 
	`scsc_wlog_æush_ršg
(
ç‹_ršg_tx
);

168 
	`scsc_wlog_¡¬t_loggšg
(
ç‹_ršg_tx
, 
WLOG_DEBUG
, 0, 0, 0);

169 
	`scsc_wlog_æush_ršg
(
ç‹_ršg_rx
);

170 
	`scsc_wlog_¡¬t_loggšg
(
ç‹_ršg_rx
, 
WLOG_DEBUG
, 0, 0, 0);

171 
pktç‹_mÚ™Ü_¡¬‹d
 = 
Œue
;

173 
	`SCSC_TAG_INFO
(
WLOG
, "PacketFate monitor started.\n");

174 
	}
}

177 
	$scsc_wifogg”_ršg_pktç‹_Ãw_assoc
()

179 
	`SCSC_TAG_INFO
(
WLOG
, "New Association started...flushing PacketFate„ings.\n");

180 
	`scsc_wlog_æush_ršg
(
ç‹_ršg_tx
);

181 
	`scsc_wlog_æush_ršg
(
ç‹_ršg_rx
);

182 
	}
}

183 
EXPORT_SYMBOL
(
scsc_wifogg”_ršg_pktç‹_Ãw_assoc
);

185 
	$scsc_wifogg”_ršg_pktç‹_g‘_ç‹s
(
ç‹
, *
»pÜt_bufs
,

186 
size_t
 
n_»que¡ed_ç‹s
,

187 
size_t
 *
n_´ovided_ç‹s
,

188 
boŞ
 
is_u£r
)

190 
scsc_wlog_ršg
 *
r
;

191 
u32
 
n_»q_ç‹s
 = (u32)
n_»que¡ed_ç‹s
;

192 
size_t
 
bËn
;

194 
r
 = (
ç‹
 =ğ
TX_FATE
è? 
ç‹_ršg_tx
 : 
ç‹_ršg_rx
;

195 ià(
ç‹
 =ğ
TX_FATE
)

196 
bËn
 = (
wifi_tx_»pÜt
è* 
n_»q_ç‹s
;

198 
bËn
 = (
wifi_rx_»pÜt
è* 
n_»q_ç‹s
;

199 
	`scsc_wlog_»ad_max_»cÜds
(
r
, 
»pÜt_bufs
, 
bËn
, &
n_»q_ç‹s
, 
is_u£r
);

200 *
n_´ovided_ç‹s
 = 
n_»q_ç‹s
;

202 
	`SCSC_TAG_INFO
(
WLOG
, "[%s]:: GET %s…kt_fates -- Requested:%zd - Got:%zd\n",

203 
r
->
¡
.
Çme
,

204 (
ç‹
 =ğ
TX_FATE
è? "TX" : "RX", 
n_»que¡ed_ç‹s
, *
n_´ovided_ç‹s
);

205 
	}
}

206 
EXPORT_SYMBOL
(
scsc_wifogg”_ršg_pktç‹_g‘_ç‹s
);

219 
	$scsc_wifogg”_ršg_pktç‹_log_tx_äame
(
wifi_tx_·ck‘_ç‹
 
ç‹
,

220 
u16
 
hg
, *
äame
,

221 
size_t
 
Ën
, 
boŞ
 
ma_un™d©a
)

223 ià(
Ën
 > 
MAX_FRAME_LEN_ETHERNET
) {

224 
	`SCSC_TAG_WARNING
(
WLOG
, "pktfate TX:: dropped unplausible†ength frame.\n");

228 ià(
ma_un™d©a
)

229 
Ën
 =†’ <ğ
MAX_UNITDATA_LOGGED_SZ
 ?†en : MAX_UNITDATA_LOGGED_SZ;

231 
txr
.
ç‹
 = fate;

232 
txr
.
äame_šf
.
·ylßd_ty³
 = 
FRAME_TYPE_ETHERNET_II
;

233 
txr
.
äame_šf
.
äame_Ën
 = 
Ën
;

234 
txr
.
äame_šf
.
driv”_time¡amp_u£c
 = 
	`ktime_to_ns
(
	`ktime_g‘_boÙtime
());

235 
txr
.
äame_šf
.
fœmw¬e_time¡amp_u£c
 = 0;

236 
	`memıy
(&
txr
.
äame_šf
.
äame_cÚ‹Á
, 
äame
, 
Ën
);

238 
	`mem£t
(&
txr
.
md5_´efix
, 0x00, 
MD5_PREFIX_LEN
);

250 
	`scsc_wlog_wr™e_»cÜd
(
ç‹_ršg_tx
, 
NULL
, 0, &
txr
, Ñxr), 
WLOG_DEBUG
, 0);

251 
	}
}

252 
EXPORT_SYMBOL
(
scsc_wifogg”_ršg_pktç‹_log_tx_äame
);

254 
	$scsc_wifogg”_ršg_pktç‹_log_rx_äame
(
wifi_rx_·ck‘_ç‹
 
ç‹
, 
u16
 
du_desc
,

255 *
äame
, 
size_t
 
Ën
, 
boŞ
 
ma_un™d©a
)

257 ià((
du_desc
 =ğ
SCSC_DUD_ETHERNET_FRAME
 && 
Ën
 > 
MAX_FRAME_LEN_ETHERNET
) ||

258 (
du_desc
 =ğ
SCSC_DUD_80211_FRAME
 && 
Ën
 > 
MAX_FRAME_LEN_80211_MGMT
)) {

259 
	`SCSC_TAG_WARNING
(
WLOG
, "pktfate RX:: dropped unplausible†ength frame.\n");

263 ià(
ma_un™d©a
)

264 
Ën
 =†’ <ğ
MAX_UNITDATA_LOGGED_SZ
 ?†en : MAX_UNITDATA_LOGGED_SZ;

266 
rxr
.
ç‹
 = fate;

267 
rxr
.
äame_šf
.
·ylßd_ty³
 = 
du_desc
 =ğ
SCSC_DUD_ETHERNET_FRAME
 ? 
FRAME_TYPE_ETHERNET_II
 :

268 (
du_desc
 =ğ
SCSC_DUD_80211_FRAME
 ? 
FRAME_TYPE_80211_MGMT
 : 
FRAME_TYPE_UNKNOWN
);

269 
rxr
.
äame_šf
.
äame_Ën
 = 
Ën
;

270 
rxr
.
äame_šf
.
driv”_time¡amp_u£c
 = 
	`ktime_to_ns
(
	`ktime_g‘_boÙtime
());

271 
rxr
.
äame_šf
.
fœmw¬e_time¡amp_u£c
 = 0;

272 
	`memıy
(&
rxr
.
äame_šf
.
äame_cÚ‹Á
, 
äame
, 
Ën
);

274 
	`mem£t
(&
rxr
.
md5_´efix
, 0x00, 
MD5_PREFIX_LEN
);

286 
	`scsc_wlog_wr™e_»cÜd
(
ç‹_ršg_rx
, 
NULL
, 0, &
rxr
, Ôxr), 
WLOG_DEBUG
, 0);

287 
	}
}

288 
EXPORT_SYMBOL
(
scsc_wifogg”_ršg_pktç‹_log_rx_äame
);

	@scsc_wifilogger_ring_pktfate.h

6 #iâdeà
__SCSC_WIFILOGGER_RING_PKTFATE_H__


7 
	#__SCSC_WIFILOGGER_RING_PKTFATE_H__


	)

9 
	~<lšux/ty³s.h
>

10 
	~<lšux/mu‹x.h
>

11 
	~<lšux/ktime.h
>

12 
	~<lšux/timek“pšg.h
>

13 
	~<scsc/scsc_logršg.h
>

15 
	~"scsc_wifogg”_cÜe.h
"

16 
	~"scsc_wifogg”.h
"

18 
	#TX_FATE
 0

	)

19 
	#RX_FATE
 1

	)

20 
	#WLOGGER_RFATE_TX_NAME
 "pkt_ç‹_tx"

	)

21 
	#WLOGGER_RFATE_RX_NAME
 "pkt_ç‹_rx"

	)

22 
	#MAX_UNITDATA_LOGGED_SZ
 100

	)

24 
	#SCSC_DUD_ETHERNET_FRAME
 0

	)

25 
	#SCSC_DUD_80211_FRAME
 1

	)

26 
	#SCSC_DUD_MLME
 2

	)

28 
boŞ
 
is_pktç‹_mÚ™Ü_¡¬‹d
();

29 
boŞ
 
scsc_wifogg”_ršg_pktç‹_š™
();

30 
scsc_wifogg”_ršg_pktç‹_¡¬t_mÚ™Üšg
();

31 
scsc_wifogg”_ršg_pktç‹_Ãw_assoc
();

32 
scsc_wifogg”_ršg_pktç‹_log_tx_äame
(
wifi_tx_·ck‘_ç‹
 
ç‹
,

33 
u16
 
hg
, *
pkt
,

34 
size_t
 
Ën
, 
boŞ
 
ma_un™d©a
);

35 
scsc_wifogg”_ršg_pktç‹_log_rx_äame
(
wifi_rx_·ck‘_ç‹
 
ç‹
, 
u16
 
du_desc
,

36 *
äame
, 
size_t
 
Ën
, 
boŞ
 
ma_un™d©a
);

37 
scsc_wifogg”_ršg_pktç‹_g‘_ç‹s
(
ç‹
, *
»pÜt_bufs
,

38 
size_t
 
n_»que¡ed_ç‹s
,

39 
size_t
 *
n_´ovided_ç‹s
, 
boŞ
 
is_u£r
);

	@scsc_wifilogger_ring_pktfate_api.h

6 #iâdeà
__SCSC_WIFILOGGER_RING_PKTFATE_API_H__


7 
	#__SCSC_WIFILOGGER_RING_PKTFATE_API_H__


	)

15 #ià
IS_ENABLED
(
CONFIG_SCSC_WIFILOGGER
)

16 
	~"scsc_wifogg”_ršg_pktç‹.h
"

18 
	#SCSC_WLOG_PKTFATE_NEW_ASSOC
() \

20 ià(
	`is_pktç‹_mÚ™Ü_¡¬‹d
()) \

21 
	`scsc_wifogg”_ršg_pktç‹_Ãw_assoc
(); \

22 } 0)

	)

24 
	#SCSC_WLOG_PKTFATE_LOG_TX_DATA_FRAME
(
hg
, 
äame
, 
æ’
) \

26 ià(
	`is_pktç‹_mÚ™Ü_¡¬‹d
()) \

27 
	`scsc_wifogg”_ršg_pktç‹_log_tx_äame
(
TX_PKT_FATE_DRV_QUEUED
, (
hg
), \

28 (*)(
äame
), (
æ’
), 
Œue
); \

29 } 0)

	)

31 
	#SCSC_WLOG_PKTFATE_LOG_RX_DATA_FRAME
(
du_desc
, 
äame
, 
æ’
) \

33 ià(
	`is_pktç‹_mÚ™Ü_¡¬‹d
() && \

34 ((
du_desc
è=ğ
SCSC_DUD_ETHERNET_FRAME
 || (du_descè=ğ
SCSC_DUD_80211_FRAME
)) \

35 
	`scsc_wifogg”_ršg_pktç‹_log_rx_äame
(
RX_PKT_FATE_DRV_QUEUED
, (
du_desc
), \

36 (*)(
äame
), (
æ’
), 
Œue
); \

37 } 0)

	)

39 
	#SCSC_WLOG_PKTFATE_LOG_TX_CTRL_FRAME
(
hg
, 
äame
, 
æ’
) \

41 ià(
	`is_pktç‹_mÚ™Ü_¡¬‹d
()) \

42 
	`scsc_wifogg”_ršg_pktç‹_log_tx_äame
(
TX_PKT_FATE_DRV_QUEUED
, (
hg
), \

43 (*)(
äame
), (
æ’
), 
çl£
); \

44 } 0)

	)

46 
	#SCSC_WLOG_PKTFATE_LOG_RX_CTRL_FRAME
(
äame
, 
æ’
) \

48 ià(
	`is_pktç‹_mÚ™Ü_¡¬‹d
()) \

49 
	`scsc_wifogg”_ršg_pktç‹_log_rx_äame
(
RX_PKT_FATE_DRV_QUEUED
, 
SCSC_DUD_MLME
, \

50 (*)(
äame
), (
æ’
), 
çl£
); \

51 } 0)

	)

55 
	#SCSC_WLOG_PKTFATE_NEW_ASSOC
(èdØ{} 0)

	)

56 
	#SCSC_WLOG_PKTFATE_LOG_TX_DATA_FRAME
(
hg
, 
skb_mac
, 
skb_hËn
èdØ{} 0)

	)

57 
	#SCSC_WLOG_PKTFATE_LOG_TX_CTRL_FRAME
(
hg
, 
skb_mac
, 
skb_hËn
èdØ{} 0)

	)

58 
	#SCSC_WLOG_PKTFATE_LOG_RX_DATA_FRAME
(
du_desc
, 
skb_mac
, 
skb_hËn
èdØ{} 0)

	)

59 
	#SCSC_WLOG_PKTFATE_LOG_RX_CTRL_FRAME
(
äame
, 
æ’
èdØ{} 0)

	)

	@scsc_wifilogger_ring_test.c

7 
	~"scsc_wifogg”_ršg_‹¡.h
"

10 
	~"scsc_wifogg”_š‹º®.h
"

11 
	~<lšux/uacûss.h
>

12 
u32
 
	g£q
;

13 
scsc_wlog_ršg
 *
	gthe_ršg
;

15 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


16 
	~"scsc_wifogg”_debugfs.h
"

18 
scsc_wlog_debugfs_šfo
 
	gdi
;

21 
	$ršg_‹¡_logËv–_chªge_cb
(
scsc_wlog_ršg
 *
r
,

22 
u32
 
Ãw_logËv–
)

24 
	`SCSC_TAG_DEBUG
(
WLOG
,

26 
r
->
¡
.
Çme
, 
Ãw_logËv–
);

29 
	}
}

31 
boŞ
 
	$ršg_‹¡_cu¡om_š™
(
scsc_wlog_ršg
 *
r
)

33 
	`SCSC_TAG_DEBUG
(
WLOG
, "Cu¡om in™ fÜ„šg:%s\n", 
r
->
¡
.
Çme
);

35  
Œue
;

36 
	}
}

38 
boŞ
 
	$ršg_‹¡_cu¡om_fši
(
scsc_wlog_ršg
 *
r
)

40 
	`SCSC_TAG_DEBUG
(
WLOG
, "Cu¡om fš˜fÜ„šg:%s\n", 
r
->
¡
.
Çme
);

42  
Œue
;

43 
	}
}

46 
	$scsc_wifogg”_ršg_‹¡_wr™e
(*
buf
, 
size_t
 
bËn
)

48 
Œšg_hdr
 
thdr
;

50 ià(!
the_ršg
)

53 
thdr
.
£q
 = seq++;

54 
thdr
.
çke
 = 666 & 
£q
;

56  
	`scsc_wlog_wr™e_»cÜd
(
the_ršg
, 
buf
, 
bËn
, &
thdr
, Ñhdr), 
WLOG_NORMAL
, 0);

57 
	}
}

58 
EXPORT_SYMBOL
(
scsc_wifogg”_ršg_‹¡_wr™e
);

60 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


61 
ssize_t
 
	$dfs_»cÜd_wr™e
(
fe
 *
fp
, cÚ¡ 
__u£r
 *
ubuf
,

62 
size_t
 
couÁ
, 
loff_t
 *
f_pos
)

64 
ssize_t
 
wr™‹n
;

65 
scsc_ršg_‹¡_objeù
 *
¹o
;

67 ià(!
fp
->
´iv©e_d©a
)

68  -
EINVAL
;

69 
¹o
 = 
fp
->
´iv©e_d©a
;

71 
couÁ
 = couÁ < 
¹o
->
bsz
 ? count :„to->bsz;

72 ià(
	`cİy_äom_u£r
(
¹o
->
wbuf
, 
ubuf
, 
couÁ
))

73  -
EINVAL
;

74 
wr™‹n
 = 
	`scsc_wifogg”_ršg_‹¡_wr™e
(
¹o
->
wbuf
, 
couÁ
);

75 ià(!
wr™‹n
 && 
couÁ
)

76  -
EAGAIN
;

77 
	`wake_up_š‹¼u±ibË
(&
¹o
->
rw_wq
);

78 *
f_pos
 +ğ
wr™‹n
;

80  
wr™‹n
;

81 
	}
}

83 cÚ¡ 
fe_İ”©iÚs
 
	gwr™e_»cÜd_fİs
 = {

84 .
owÃr
 = 
THIS_MODULE
,

85 .
	gİ’
 = 
dfs_İ’
,

86 .
	gwr™e
 = 
dfs_»cÜd_wr™e
,

87 .
	g»Ëa£
 = 
dfs_»Ëa£
,

91 
boŞ
 
	$scsc_wifogg”_ršg_‹¡_š™
()

93 
scsc_wlog_ršg
 *
r
 = 
NULL
;

94 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


95 
scsc_ršg_‹¡_objeù
 *
¹o
;

98 
r
 = 
	`scsc_wlog_ršg_ü—‹
(
WLOGGER_RTEST_NAME
,

99 
RING_BUFFER_ENTRY_FLAGS_HAS_BINARY
,

100 
ENTRY_TYPE_DATA
, 32768,

101 
WIFI_LOGGER_SCSC_TEST_RING_SUPPORTED
,

102 
ršg_‹¡_cu¡om_š™
, 
ršg_‹¡_cu¡om_fši
,

103 
NULL
);

105 ià(!
r
) {

106 
	`SCSC_TAG_ERR
(
WLOG
, "Failedo CREATE WiFiLogger„ing: %s\n",

107 
WLOGGER_RTEST_NAME
);

108  
çl£
;

111 
	`scsc_wlog_»gi¡”_logËv–_chªge_cb
(
r
, 
ršg_‹¡_logËv–_chªge_cb
);

113 ià(!
	`scsc_wifogg”_»gi¡”_ršg
(
r
)) {

114 
	`SCSC_TAG_ERR
(
WLOG
, "Failedo REGISTER WiFiLogger„ing: %s\n",

115 
WLOGGER_RTEST_NAME
);

116 
	`scsc_wlog_ršg_de¡roy
(
r
);

117  
çl£
;

119 
the_ršg
 = 
r
;

121 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


125 
¹o
 = 
	`š™_ršg_‹¡_objeù
(
the_ršg
);

126 ià(
¹o
) {

127 
	`scsc_»gi¡”_commÚ_debugfs_’Œ›s
(
the_ršg
->
¡
.
Çme
, 
¹o
, &
di
);

129 
	`scsc_wlog_»gi¡”_debugfs_’Œy
(
the_ršg
->
¡
.
Çme
, "write_record",

130 &
wr™e_»cÜd_fİs
, 
¹o
, &
di
);

134  
Œue
;

135 
	}
}

	@scsc_wifilogger_ring_test.h

6 #iâdeà
__SCSC_WIFILOGGER_RING_TEST_H__


7 
	#__SCSC_WIFILOGGER_RING_TEST_H__


	)

9 
	~<lšux/ty³s.h
>

10 
	~<lšux/wa™.h
>

11 
	~<lšux/mu‹x.h
>

12 
	~<lšux/li¡.h
>

13 
	~<scsc/scsc_logršg.h
>

15 
	~"scsc_wifogg”_cÜe.h
"

16 
	~"scsc_wifogg”.h
"

18 
	#WLOGGER_RTEST_NAME
 "‹¡"

	)

20 
	sŒšg_hdr
 {

21 
u32
 
	m£q
;

22 
u64
 
	mçke
;

23 } 
	g__·cked
;

25 
boŞ
 
scsc_wifogg”_ršg_‹¡_š™
();

27 
scsc_wifogg”_ršg_‹¡_wr™e
(*
buf
, 
size_t
 
bËn
);

	@scsc_wifilogger_ring_wakelock.c

7 
	~"scsc_wifogg”_ršg_wak–ock.h
"

10 
	~"scsc_wifogg”_ršg_wak–ock_­i.h
"

11 
	~"scsc_wifogg”_š‹º®.h
"

13 
scsc_wlog_ršg
 *
	gthe_ršg
;

15 
u32
 
	gwršg_Ëv
;

16 
EXPORT_SYMBOL
(
wršg_Ëv
);

18 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


19 
	~"scsc_wifogg”_debugfs.h
"

21 
scsc_wlog_debugfs_šfo
 
	gdi
;

25 
boŞ
 
	$scsc_wifogg”_ršg_wak–ock_š™
()

27 
scsc_wlog_ršg
 *
r
 = 
NULL
;

28 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


29 
scsc_ršg_‹¡_objeù
 *
¹o
 = 
NULL
;

32 
r
 = 
	`scsc_wlog_ršg_ü—‹
(
WLOGGER_RWAKELOCK_NAME
,

33 
RING_BUFFER_ENTRY_FLAGS_HAS_BINARY
,

34 
ENTRY_TYPE_WAKE_LOCK
, 65536,

35 
WIFI_LOGGER_WAKE_LOCK_SUPPORTED
,

36 
NULL
, NULL, NULL);

38 ià(!
r
) {

39 
	`SCSC_TAG_ERR
(
WLOG
, "Failedo CREATE WiFiLogger„ing: %s\n",

40 
WLOGGER_RWAKELOCK_NAME
);

41  
çl£
;

43 
	`scsc_wlog_»gi¡”_v”bos™y_»ã»nû
(
r
, &
wršg_Ëv
);

45 ià(!
	`scsc_wifogg”_»gi¡”_ršg
(
r
)) {

46 
	`SCSC_TAG_ERR
(
WLOG
, "Failedo REGISTER WiFiLogger„ing: %s\n",

47 
WLOGGER_RWAKELOCK_NAME
);

48 
	`scsc_wlog_ršg_de¡roy
(
r
);

49  
çl£
;

51 
the_ršg
 = 
r
;

53 #ifdeà
CONFIG_SCSC_WIFILOGGER_DEBUGFS


54 
¹o
 = 
	`š™_ršg_‹¡_objeù
(
the_ršg
);

55 ià(
¹o
)

56 
	`scsc_»gi¡”_commÚ_debugfs_’Œ›s
(
the_ršg
->
¡
.
Çme
, 
¹o
, &
di
);

59  
Œue
;

60 
	}
}

64 
	$scsc_wifogg”_ršg_wak–ock_aùiÚ
(
u32
 
v”bo£_Ëv–
, 
¡©us
,

65 *
wl_Çme
, 
»asÚ
)

67 
u64
 
time¡amp
;

68 
scsc_wake_lock_ev’t
 
wl_ev’t
;

70 ià(!
the_ršg
)

73 
time¡amp
 = 
	`loÿl_şock
();

74 
	`SCSC_TAG_DBG4
(
WLOG
, "EL -- WAKELOCK[%s] - status:%d„eason:%d @0x%x\n",

75 
wl_Çme
, 
¡©us
, 
»asÚ
, 
time¡amp
);

77 
wl_ev’t
.
¡©us
 = status;

78 
wl_ev’t
.
»asÚ
 =„eason;

79  
	`scsc_wlog_wr™e_»cÜd
(
the_ršg
, 
wl_Çme
, 
	`¡¾’
(wl_Çme), &
wl_ev’t
,

80 (
wl_ev’t
), 
v”bo£_Ëv–
, 
time¡amp
);

81 
	}
}

82 
EXPORT_SYMBOL
(
scsc_wifogg”_ršg_wak–ock_aùiÚ
);

	@scsc_wifilogger_ring_wakelock.h

6 #iâdeà
__SCSC_WIFILOGGER_RING_WAKELOCK_H__


7 
	#__SCSC_WIFILOGGER_RING_WAKELOCK_H__


	)

9 
	~<lšux/ty³s.h
>

10 
	~<scsc/scsc_logršg.h
>

12 
	~"scsc_wifogg”_cÜe.h
"

13 
	~"scsc_wifogg”.h
"

15 
	#WLOGGER_RWAKELOCK_NAME
 "wak–ock"

	)

17 
u32
 
wršg_Ëv
;

19 
scsc_wifogg”_ršg_wak–ock_aùiÚ
(
u32
 
v”bo£_Ëv–
, 
¡©us
,

20 *
wl_Çme
, 
»asÚ
);

23 
boŞ
 
scsc_wifogg”_ršg_wak–ock_š™
();

	@scsc_wifilogger_ring_wakelock_api.h

6 #iâdeà
__SCSC_WIFILOGGER_RING_WAKELOCK_API_H__


7 
	#__SCSC_WIFILOGGER_RING_WAKELOCK_API_H__


	)

16 
	mWL_TAKEN
 = 0,

17 
	mWL_RELEASED


21 
	mWL_REASON_TX
 = 0,

22 
	mWL_REASON_RX
,

23 
	mWL_REASON_ROAM


26 #ià
IS_ENABLED
(
CONFIG_SCSC_WIFILOGGER
)

28 
	~"scsc_wifogg”_ršg_wak–ock.h
"

30 
	#SCSC_WLOG_WAKELOCK
(
Ëv
, 
¡©us
, 
wl_Çme
, 
»asÚ
) \

32 ià(
wršg_Ëv
 && (
Ëv
) <= wring_lev) \

33 
	`scsc_wifogg”_ršg_wak–ock_aùiÚ
((
Ëv
), (
¡©us
), (
wl_Çme
), (
»asÚ
)); \

34 } 0)

	)

38 
	#SCSC_WLOG_WAKELOCK
(
Ëv
, 
¡©us
, 
wl_Çme
, 
»asÚ
èdØ{} 0)

	)

	@scsc_wifilogger_rings.h

6 #iâdeà
__SCSC_WIFILOGGER_RINGS_H__


7 
	#__SCSC_WIFILOGGER_RINGS_H__


	)

9 
	~"scsc_wifogg”_ty³s.h
"

11 
	~"scsc_wifogg”_ršg_cÚÃùiv™y_­i.h
"

12 
	~"scsc_wifogg”_ršg_wak–ock_­i.h
"

13 
	~"scsc_wifogg”_ršg_pktç‹_­i.h
"

	@scsc_wifilogger_types.h

6 #iâdeà
_SCSC_WIFILOGGER_TYPES_H_


7 
	#_SCSC_WIFILOGGER_TYPES_H_


	)

18 
	~<lšux/ty³s.h
>

20 
	#LOGGER_MAJOR_VERSION
 1

	)

21 
	#LOGGER_MINOR_VERSION
 0

	)

22 
	#LOGGER_MICRO_VERSION
 0

	)

29 #iâdeà
CONFIG_SCSC_WIFILOGGER_TEST_RING


30 
	#MAX_WIFI_LOGGER_RINGS
 10

	)

32 
	#MAX_WIFI_LOGGER_RINGS
 11

	)

36 
	mWIFI_SUCCESS
 = 0,

37 
	mWIFI_ERROR_NONE
 = 0,

38 
	mWIFI_ERROR_UNKNOWN
 = -1,

39 
	mWIFI_ERROR_UNINITIALIZED
 = -2,

40 
	mWIFI_ERROR_NOT_SUPPORTED
 = -3,

41 
	mWIFI_ERROR_NOT_AVAILABLE
 = -4,

42 
	mWIFI_ERROR_INVALID_ARGS
 = -5,

43 
	mWIFI_ERROR_INVALID_REQUEST_ID
 = -6,

44 
	mWIFI_ERROR_TIMED_OUT
 = -7,

45 
	mWIFI_ERROR_TOO_MANY_REQUESTS
 = -8,

46 
	mWIFI_ERROR_OUT_OF_MEMORY
 = -9,

47 
	mWIFI_ERROR_BUSY
 = -10,

48 } 
	twifi_”rÜ
;

52 
	mWLOG_NONE
 = 0,

53 
	mWLOG_NORMAL
 = 1,

54 
	mWLOG_LAZY
 = 2,

55 
	mWLOG_DEBUG
 = 3,

56 } 
	twlog_v”bo£_Ëv–
;

60 
	mWIFI_LOGGER_MEMORY_DUMP_SUPPORTED
 = (1 << (0)),

61 
	mWIFI_LOGGER_PER_PACKET_TX_RX_STATUS_SUPPORTED
 = (1 << (1)),

62 
	mWIFI_LOGGER_CONNECT_EVENT_SUPPORTED
 = (1 << (2)),

63 
	mWIFI_LOGGER_POWER_EVENT_SUPPORTED
 = (1 << (3)),

64 
	mWIFI_LOGGER_WAKE_LOCK_SUPPORTED
 = (1 << (4)),

65 
	mWIFI_LOGGER_VERBOSE_SUPPORTED
 = (1 << (5)),

66 
	mWIFI_LOGGER_WATCHDOG_TIMER_SUPPORTED
 = (1 << (6)),

67 
	mWIFI_LOGGER_DRIVER_DUMP_SUPPORTED
 = (1 << (7)),

68 
	mWIFI_LOGGER_PACKET_FATE_SUPPORTED
 = (1 << (8)),

69 #ifdeà
CONFIG_SCSC_WIFILOGGER_TEST


70 
	mWIFI_LOGGER_SCSC_TEST_RING_SUPPORTED
 = (1 << (9)),

75 
	mRING_BUFFER_ENTRY_FLAGS_HAS_BINARY
 = (1 << (0)),

76 
	mRING_BUFFER_ENTRY_FLAGS_HAS_TIMESTAMP
 = (1 << (1))

79 
	#RING_NAME_SZ
 32

	)

81 
	sscsc_wifi_ršg_bufãr_¡©us
 {

82 
u8
 
	mÇme
[
RING_NAME_SZ
];

83 
u32
 
	mæags
;

84 
	mršg_id
;

85 
u32
 
	mrb_by‹_size
;

86 
u32
 
	mv”bo£_Ëv–
;

87 
u32
 
	mwr™‹n_by‹s
;

91 
u32
 
	m»ad_by‹s
;

94 
u32
 
	mwr™‹n_»cÜds
;

100 (*
	tÚ_ršg_bufãr_d©a
)(*
	tršg_Çme
, *
	tbufãr
, 
	tbufãr_size
,

101 
	tscsc_wifi_ršg_bufãr_¡©us
 *
	t¡©us
, *
	tùx
);

102 (*
	tÚ_®”t
)(*
	tbufãr
, 
	tbufãr_size
, 
	t”r_code
, *
	tùx
);

105 
ENTRY_TYPE_CONNECT_EVENT
 = 1,

106 
ENTRY_TYPE_PKT
,

107 
ENTRY_TYPE_WAKE_LOCK
,

108 
ENTRY_TYPE_POWER_EVENT
,

109 
ENTRY_TYPE_DATA


112 
	sscsc_wifi_ršg_bufãr_’Œy
 {

113 
u16
 
’Œy_size
;

114 
u8
 
æags
;

115 
u8
 
ty³
;

116 
u64
 
time¡amp
;

117 } 
__·cked
;

120 
	#WIFI_RING_BUFFER_FLAG_HAS_BINARY_ENTRIES
 0x00000001

	)

122 
	#WIFI_RING_BUFFER_FLAG_HAS_ASCII_ENTRIES
 0x00000002

	)

125 
	#WIFI_EVENT_ASSOCIATION_REQUESTED
 0

126 
	#WIFI_EVENT_AUTH_COMPLETE
 1

	)

127 
	#WIFI_EVENT_ASSOC_COMPLETE
 2

	)

128 
	#WIFI_EVENT_FW_AUTH_STARTED
 3

129 
	#WIFI_EVENT_FW_ASSOC_STARTED
 4

130 
	#WIFI_EVENT_FW_RE_ASSOC_STARTED
 5

131 
	#WIFI_EVENT_DRIVER_SCAN_REQUESTED
 6

	)

132 
	#WIFI_EVENT_DRIVER_SCAN_RESULT_FOUND
 7

	)

133 
	#WIFI_EVENT_DRIVER_SCAN_COMPLETE
 8

	)

134 
	#WIFI_EVENT_G_SCAN_STARTED
 9

	)

135 
	#WIFI_EVENT_G_SCAN_COMPLETE
 10

	)

136 
	#WIFI_EVENT_DISASSOCIATION_REQUESTED
 11

	)

137 
	#WIFI_EVENT_RE_ASSOCIATION_REQUESTED
 12

	)

138 
	#WIFI_EVENT_ROAM_REQUESTED
 13

	)

139 
	#WIFI_EVENT_BEACON_RECEIVED
 14

141 
	#WIFI_EVENT_ROAM_SCAN_STARTED
 15

142 
	#WIFI_EVENT_ROAM_SCAN_COMPLETE
 16

143 
	#WIFI_EVENT_ROAM_SEARCH_STARTED
 17

145 
	#WIFI_EVENT_ROAM_SEARCH_STOPPED
 18

147 
	#WIFI_EVENT_CHANNEL_SWITCH_ANOUNCEMENT
 20

148 
	#WIFI_EVENT_FW_EAPOL_FRAME_TRANSMIT_START
 21

150 
	#WIFI_EVENT_FW_EAPOL_FRAME_TRANSMIT_STOP
 22

152 
	#WIFI_EVENT_DRIVER_EAPOL_FRAME_TRANSMIT_REQUESTED
 23

154 
	#WIFI_EVENT_FW_EAPOL_FRAME_RECEIVED
 24

156 
	#WIFI_EVENT_DRIVER_EAPOL_FRAME_RECEIVED
 26

159 
	#WIFI_EVENT_BLOCK_ACK_NEGOTIATION_COMPLETE
 27

160 
	#WIFI_EVENT_BT_COEX_BT_SCO_START
 28

	)

161 
	#WIFI_EVENT_BT_COEX_BT_SCO_STOP
 29

	)

162 
	#WIFI_EVENT_BT_COEX_BT_SCAN_START
 30

164 
	#WIFI_EVENT_BT_COEX_BT_SCAN_STOP
 31

	)

165 
	#WIFI_EVENT_BT_COEX_BT_HID_START
 32

	)

166 
	#WIFI_EVENT_BT_COEX_BT_HID_STOP
 33

	)

167 
	#WIFI_EVENT_ROAM_AUTH_STARTED
 34

168 
	#WIFI_EVENT_ROAM_AUTH_COMPLETE
 35

169 
	#WIFI_EVENT_ROAM_ASSOC_STARTED
 36

171 
	#WIFI_EVENT_ROAM_ASSOC_COMPLETE
 37

172 
	#WIFI_EVENT_G_SCAN_STOP
 38

173 
	#WIFI_EVENT_G_SCAN_CYCLE_STARTED
 39

174 
	#WIFI_EVENT_G_SCAN_CYCLE_COMPLETED
 40

175 
	#WIFI_EVENT_G_SCAN_BUCKET_STARTED
 41

177 
	#WIFI_EVENT_G_SCAN_BUCKET_COMPLETED
 42

179 
	#WIFI_EVENT_G_SCAN_RESULTS_AVAILABLE
 43

181 
	#WIFI_EVENT_G_SCAN_CAPABILITIES
 44

183 
	#WIFI_EVENT_ROAM_CANDIDATE_FOUND
 45

185 
	#WIFI_EVENT_ROAM_SCAN_CONFIG
 46

187 
	#WIFI_EVENT_AUTH_TIMEOUT
 47

188 
	#WIFI_EVENT_ASSOC_TIMEOUT
 48

189 
	#WIFI_EVENT_MEM_ALLOC_FAILURE
 49

190 
	#WIFI_EVENT_DRIVER_PNO_ADD
 50

191 
	#WIFI_EVENT_DRIVER_PNO_REMOVE
 51

192 
	#WIFI_EVENT_DRIVER_PNO_NETWORK_FOUND
 52

194 
	#WIFI_EVENT_DRIVER_PNO_SCAN_REQUESTED
 53

195 
	#WIFI_EVENT_DRIVER_PNO_SCAN_RESULT_FOUND
 54

197 
	#WIFI_EVENT_DRIVER_PNO_SCAN_COMPLETE
 55

199 

	)

204 
	#WIFI_TAG_VENDOR_SPECIFIC
 0

205 
	#WIFI_TAG_BSSID
 1

206 
	#WIFI_TAG_ADDR
 2

207 
	#WIFI_TAG_SSID
 3

208 
	#WIFI_TAG_STATUS
 4

209 
	#WIFI_TAG_CHANNEL_SPEC
 5

210 
	#WIFI_TAG_WAKE_LOCK_EVENT
 6

211 
	#WIFI_TAG_ADDR1
 7

212 
	#WIFI_TAG_ADDR2
 8

213 
	#WIFI_TAG_ADDR3
 9

214 
	#WIFI_TAG_ADDR4
 10

215 
	#WIFI_TAG_TSF
 11

216 
	#WIFI_TAG_IE
 12

219 
	#WIFI_TAG_INTERFACE
 13

220 
	#WIFI_TAG_REASON_CODE
 14

221 
	#WIFI_TAG_RATE_MBPS
 15

222 
	#WIFI_TAG_REQUEST_ID
 16

223 
	#WIFI_TAG_BUCKET_ID
 17

224 
	#WIFI_TAG_GSCAN_PARAMS
 18

225 
	#WIFI_TAG_GSCAN_CAPABILITIES
 19

226 
	#WIFI_TAG_SCAN_ID
 20

227 
	#WIFI_TAG_RSSI
 21

228 
	#WIFI_TAG_CHANNEL
 22

229 
	#WIFI_TAG_LINK_ID
 23

230 
	#WIFI_TAG_LINK_ROLE
 24

231 
	#WIFI_TAG_LINK_STATE
 25

232 
	#WIFI_TAG_LINK_TYPE
 26

233 
	#WIFI_TAG_TSCO
 27

234 
	#WIFI_TAG_RSCO
 28

235 
	#WIFI_TAG_EAPOL_MESSAGE_TYPE
 29

237 

	)

238 
	sscsc_v_log
 {

239 
u16
 
g
;

240 
u16
 
Ëngth
;

241 
u8
 
v®ue
[0];

242 } 
__·cked
;

244 
	sscsc_wifi_ršg_bufãr_driv”_cÚÃùiv™y_ev’t
 {

245 
u16
 
ev’t
;

246 
scsc_v_log
 
vs
[0];

247 } 
__·cked
;

253 
	sscsc_wake_lock_ev’t
 {

254 
¡©us
;

255 
»asÚ
;

256 
Çme
[0];

257 } 
__·cked
;

259 
	sscsc_wifi_pow”_ev’t
 {

260 
u16
 
ev’t
;

261 
scsc_v_log
 
vs
[0];

262 } 
__·cked
;

264 
	#PER_PACKET_ENTRY_FLAGS_DIRECTION_TX
 1

	)

265 
	#PER_PACKET_ENTRY_FLAGS_TX_SUCCESS
 2

	)

266 
	#PER_PACKET_ENTRY_FLAGS_80211_HEADER
 4

	)

267 
	#PER_PACKET_ENTRY_FLAGS_PROTECTED
 8

	)

269 
	sscsc_wifi_ršg_³r_·ck‘_¡©us_’Œy
 {

270 
u8
 
æags
;

271 
u8
 
tid
;

272 
u16
 
MCS
;

273 
u8
 
rssi
;

274 
u8
 
num_»Œ›s
;

275 
u16
 
Ï¡_Œªsm™_¿‹
;

276 
u16
 
lšk_Ïy”_Œªsm™_£qu’û
;

277 
u64
 
fœmw¬e_’Œy_time¡amp
;

278 
u64
 
¡¬t_cÚ‹ÁiÚ_time¡amp
;

279 
u64
 
Œªsm™_sucûss_time¡amp
;

280 
u8
 
d©a
[0];

281 } 
__·cked
;

283 (*
	tÚ_driv”_memÜy_dump
)(*
	tbufãr
, 
	tbufãr_size
, *
	tùx
);

284 (*
	tÚ_fœmw¬e_memÜy_dump
)(*
	tbufãr
, 
	tbufãr_size
, *
	tùx
);

288 
	#MD5_PREFIX_LEN
 4

	)

289 
	#MAX_FATE_LOG_LEN
 32

	)

290 
	#MAX_FRAME_LEN_ETHERNET
 1518

	)

291 
	#MAX_FRAME_LEN_80211_MGMT
 2352

292 

	)

295 
TX_PKT_FATE_ACKED
,

298 
TX_PKT_FATE_SENT
,

301 
TX_PKT_FATE_FW_QUEUED
,

305 
TX_PKT_FATE_FW_DROP_INVALID
,

308 
TX_PKT_FATE_FW_DROP_NOBUFS
,

313 
TX_PKT_FATE_FW_DROP_OTHER
,

316 
TX_PKT_FATE_DRV_QUEUED
,

320 
TX_PKT_FATE_DRV_DROP_INVALID
,

323 
TX_PKT_FATE_DRV_DROP_NOBUFS
,

326 
TX_PKT_FATE_DRV_DROP_OTHER
,

327 } 
	twifi_tx_·ck‘_ç‹
;

331 
RX_PKT_FATE_SUCCESS
,

334 
RX_PKT_FATE_FW_QUEUED
,

337 
RX_PKT_FATE_FW_DROP_FILTER
,

341 
RX_PKT_FATE_FW_DROP_INVALID
,

344 
RX_PKT_FATE_FW_DROP_NOBUFS
,

347 
RX_PKT_FATE_FW_DROP_OTHER
,

350 
RX_PKT_FATE_DRV_QUEUED
,

353 
RX_PKT_FATE_DRV_DROP_FILTER
,

356 
RX_PKT_FATE_DRV_DROP_INVALID
,

359 
RX_PKT_FATE_DRV_DROP_NOBUFS
,

362 
RX_PKT_FATE_DRV_DROP_OTHER
,

363 } 
	twifi_rx_·ck‘_ç‹
;

366 
FRAME_TYPE_UNKNOWN
,

367 
FRAME_TYPE_ETHERNET_II
,

368 
FRAME_TYPE_80211_MGMT
,

369 } 
	täame_ty³
;

371 
	sscsc_äame_šfo
 {

376 
äame_ty³
 
·ylßd_ty³
;

381 
size_t
 
äame_Ën
;

390 
u32
 
driv”_time¡amp_u£c
;

401 
u32
 
fœmw¬e_time¡amp_u£c
;

413 
‘h”Ãt_ii_by‹s
[
MAX_FRAME_LEN_ETHERNET
];

414 
›“_80211_mgmt_by‹s
[
MAX_FRAME_LEN_80211_MGMT
];

415 } 
äame_cÚ‹Á
;

422 
md5_´efix
[
MD5_PREFIX_LEN
];

423 
wifi_tx_·ck‘_ç‹
 
ç‹
;

424 
scsc_äame_šfo
 
äame_šf
;

425 } 
	t__·cked
 
	twifi_tx_»pÜt
;

431 
md5_´efix
[
MD5_PREFIX_LEN
];

432 
wifi_rx_·ck‘_ç‹
 
ç‹
;

433 
scsc_äame_šfo
 
äame_šf
;

434 } 
	t__·cked
 
	twifi_rx_»pÜt
;

	@scsc_wlan_mmap.c

6 
	~<lšux/k”Ãl.h
>

7 
	~<lšux/moduË.h
>

8 
	~<lšux/moduË·¿m.h
>

9 
	~<lšux/cdev.h
>

10 
	~<lšux/deviû.h
>

11 
	~<lšux/uacûss.h
>

12 
	~<lšux/mm.h
>

13 
	~"debug.h
"

15 
	#N_MINORS
 1

	)

16 
	#SCSC_WLAN_MAX_SIZE
 4*1024*1024

	)

18 
şass
 *
	gscsc_wÏn_mm­_şass
;

19 
cdev
 
	gscsc_wÏn_mm­_dev
[
N_MINORS
];

20 
dev_t
 
	gdev_num
;

22 
DEFINE_MUTEX
(
scsc_wÏn_lock
);

23 *
	gscsc_wÏn_mm­_buf
;

24 
size_t
 
	gscsc_wÏn_mm­_size
;

26 
	$scsc_wÏn_mm­_İ’
(
šode
 *šode, 
fe
 *
fp
)

28 
	`SLSI_INFO_NODEV
("scsc_wlan_mmap_open\n");

30 
	}
}

32 
	$scsc_wÏn_mm­_»Ëa£
(
šode
 *šode, 
fe
 *
fp
)

34 
	`SLSI_INFO_NODEV
("scsc_wlan_mmap_release\n");

36 
	}
}

39 
	$scsc_wÏn_mm­
(
fe
 *
fp
, 
vm_¬—_¡ruù
 *
vma
)

41 
¡¬t
 = 
vma
->
vm_¡¬t
;

42 
size
 = 
vma
->
vm_’d
 - vma->
vm_¡¬t
;

45 
off£t
 = 0;

46 
·ge
, 
pos
;

48 
	`mu‹x_lock
(&
scsc_wÏn_lock
);

49 ià(
size
 > 
scsc_wÏn_mm­_size
)

50 
”rÜ
;

51 ià(
off£t
 > 
scsc_wÏn_mm­_size
 - 
size
)

52 
”rÜ
;

54 ià(
scsc_wÏn_mm­_buf
 =ğ
NULL
) {

55 
	`SLSI_ERR_NODEV
("scsc_wlan_mmap_buf is NULL\n");

56 
”rÜ
;

59 
pos
 = ()
scsc_wÏn_mm­_buf
 + 
off£t
;

61 
	`SLSI_INFO_NODEV
("scsc_wÏn_mm­ size:%lu off£ˆ%ld\n", 
size
, 
off£t
);

63 
size
 > 0) {

64 
·ge
 = 
	`vm®loc_to_pâ
((*)
pos
);

65 ià(
	`»m­_pâ_¿nge
(
vma
, 
¡¬t
, 
·ge
, 
PAGE_SIZE
, 
PAGE_SHARED
))

66 
”rÜ
;

68 
¡¬t
 +ğ
PAGE_SIZE
;

69 
pos
 +ğ
PAGE_SIZE
;

70 ià(
size
 > 
PAGE_SIZE
)

71 
size
 -ğ
PAGE_SIZE
;

73 
size
 = 0;

76 
	`mu‹x_uÆock
(&
scsc_wÏn_lock
);

78 
”rÜ
:

79 
	`mu‹x_uÆock
(&
scsc_wÏn_lock
);

80  -
EAGAIN
;

81 
	}
}

83 
	$scsc_wÏn_mm­_£t_bufãr
(*
buf
, 
size_t
 
sz
)

85 
	`mu‹x_lock
(&
scsc_wÏn_lock
);

86 ià(
sz
 > 
SCSC_WLAN_MAX_SIZE
) {

87 
	`SLSI_ERR_NODEV
("Siz%zuƒxûed %d\n", 
sz
, 
SCSC_WLAN_MAX_SIZE
);

88 
scsc_wÏn_mm­_buf
 = 
NULL
;

89 
scsc_wÏn_mm­_size
 = 0;

90 
	`mu‹x_uÆock
(&
scsc_wÏn_lock
);

91  -
EIO
;

94 
	`SLSI_INFO_NODEV
("scsc_wÏn_mm­_£t_bufã¸size:%zu\n", 
sz
);

95 
scsc_wÏn_mm­_buf
 = 
buf
;

96 
scsc_wÏn_mm­_size
 = 
sz
;

97 
	`mu‹x_uÆock
(&
scsc_wÏn_lock
);

100 
	}
}

102 cÚ¡ 
fe_İ”©iÚs
 
	gscsc_wÏn_mm­_fİs
 = {

103 .
owÃr
 = 
THIS_MODULE
,

104 .
	gİ’
 = 
scsc_wÏn_mm­_İ’
,

105 .
	gmm­
 = 
scsc_wÏn_mm­
,

106 .
	g»Ëa£
 = 
scsc_wÏn_mm­_»Ëa£
,

109 
	$scsc_wÏn_mm­_ü—‹
()

111 
deviû
 *
dev
;

112 
i
;

113 
»t
;

114 
dev_t
 
cu¼_dev
;

117 
»t
 = 
	`®loc_chrdev_»giÚ
(&
dev_num
, 0, 
N_MINORS
, "scsc_wlan_mmap");

118 ià(
»t
) {

119 
	`SLSI_ERR_NODEV
("alloc_chrdev_region failed");

120 
”rÜ
;

124 
scsc_wÏn_mm­_şass
 = 
	`şass_ü—‹
(
THIS_MODULE
, "scsc_wlan_mmap_class");

125 ià(
	`IS_ERR
(
scsc_wÏn_mm­_şass
)) {

126 
»t
 = 
	`PTR_ERR
(
scsc_wÏn_mm­_şass
);

127 
”rÜ_şass
;

131 
i
 = 0; i < 
N_MINORS
; i++) {

132 
cu¼_dev
 = 
	`MKDEV
(
	`MAJOR
(
dev_num
), 
i
);

134 
	`cdev_š™
(&
scsc_wÏn_mm­_dev
[
i
], &
scsc_wÏn_mm­_fİs
);

135 
»t
 = 
	`cdev_add
(&
scsc_wÏn_mm­_dev
[
i
], 
cu¼_dev
, 1);

136 ià(
»t
) {

137 
	`SLSI_ERR_NODEV
("cdev_add failed");

141 
scsc_wÏn_mm­_dev
[
i
].
owÃr
 = 
THIS_MODULE
;

143 
dev
 = 
	`deviû_ü—‹
(
scsc_wÏn_mm­_şass
, 
NULL
, 
cu¼_dev
, NULL, "scsc_wÏn_mm­_%d", 
i
);

144 ià(
	`IS_ERR
(
dev
)) {

145 
	`SLSI_ERR_NODEV
("device_create failed");

146 
»t
 = 
	`PTR_ERR
(
dev
);

147 
	`cdev_d–
(&
scsc_wÏn_mm­_dev
[
i
]);

154 
”rÜ_şass
:

155 
	`uÄegi¡”_chrdev_»giÚ
(
dev_num
, 
N_MINORS
);

156 
”rÜ
:

158 
	}
}

160 
	$scsc_wÏn_mm­_de¡roy
()

162 
i
;

163 
majÜ
 = 
	`MAJOR
(
dev_num
);

164 
dev_t
 
cu¼_dev
;

166 
i
 = 0; i < 
N_MINORS
; i++) {

167 
cu¼_dev
 = 
	`MKDEV
(
majÜ
, 
i
);

168 
	`cdev_d–
(&
scsc_wÏn_mm­_dev
[
i
]);

169 
	`deviû_de¡roy
(
scsc_wÏn_mm­_şass
, 
dev_num
);

171 
	`şass_de¡roy
(
scsc_wÏn_mm­_şass
);

172 
	`uÄegi¡”_chrdev_»giÚ
(
dev_num
, 
N_MINORS
);

174 
	}
}

	@scsc_wlan_mmap.h

7 #iâdeà
SCSC_WLAN_MMAP_H


8 
	#SCSC_WLAN_MMAP_H


	)

10 
scsc_wÏn_mm­_ü—‹
();

11 
scsc_wÏn_mm­_de¡roy
();

12 
scsc_wÏn_mm­_£t_bufãr
(*
buf
, 
size_t
 
sz
);

	@src_sink.c

7 
	~"dev.h
"

8 
	~"¤c_sšk.h
"

9 
	~"debug.h
"

10 
	~"çpi.h
"

11 
	~"mlme.h
"

12 
	~"mgt.h
"

14 
	$¦si_¤c_sšk_çke_¡a_¡¬t
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

16 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

17 
¦si_³”
 *
³”
;

18 
u8
 
deviû_add»ss
[
ETH_ALEN
] = {0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF};

19 
u8
 
çke_³”_mac
[
ETH_ALEN
] = {0x00, 0x11, 0x22, 0x33, 0x44, 0x55};

21 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

23 
ndev_vif
->
iáy³
 = 
NL80211_IFTYPE_STATION
;

24 
dev
->
›“80211_±r
->
iáy³
 = 
NL80211_IFTYPE_STATION
;

25 
ndev_vif
->
vif_ty³
 = 
FAPI_VIFTYPE_STATION
;

27 ià(
	`WARN
(
	`¦si_mlme_add_vif
(
sdev
, 
dev
, dev->
dev_addr
, 
deviû_add»ss
) != 0, "add VIF failed")) {

28 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

29  -
EFAULT
;

32 ià(
	`WARN
(
	`¦si_vif_aùiv©ed
(
sdev
, 
dev
) != 0, "activate VIF failed")) {

33 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

34 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

35 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

36  -
EFAULT
;

39 
³”
 = 
	`¦si_³”_add
(
sdev
, 
dev
, 
çke_³”_mac
, 
SLSI_STA_PEER_QUEUESET
 + 1);

40 ià(
	`WARN
(!
³”
, "add fake…eer failed")) {

41 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

42 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

43 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

44 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

45  -
EFAULT
;

47 
³”
->
qos_’abËd
 = 
Œue
;

48 
	`¦si_ps_pÜt_cÚŒŞ
(
sdev
, 
dev
, 
³”
, 
SLSI_STA_CONN_STATE_CONNECTED
);

49 
	`Ãtif_ÿ¼›r_Ú
(
dev
);

50 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

52 
	}
}

54 
	$¦si_¤c_sšk_çke_¡a_¡İ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
)

56 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

57 
¦si_³”
 *
³”
 = 
	`¦si_g‘_³”_äom_qs
(
sdev
, 
dev
, 
SLSI_STA_PEER_QUEUESET
);

59 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

61 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_SRC_SINK
, "¡©iÚ stİ(vif:%d)\n", 
ndev_vif
->
iâum
);

63 ià(
	`WARN
(!
ndev_vif
->
aùiv©ed
, "not‡ctivated")) {

64 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

68 
	`Ãtif_ÿ¼›r_off
(
dev
);

69 ià(
³”
) {

70 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

71 
	`¦si_³”_»move
(
sdev
, 
dev
, 
³”
);

72 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

74 
	`¦si_vif_d—ùiv©ed
(
sdev
, 
dev
);

75 ià(
	`¦si_mlme_d–_vif
(
sdev
, 
dev
) != 0)

76 
	`SLSI_NET_ERR
(
dev
, "slsi_mlme_del_vif failed\n");

77 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

78 
	}
}

80 
	$¦si_¤c_sšk_loİback_¡¬t
(
¦si_dev
 *
sdev
)

82 
Ãt_deviû
 *
dev
;

83 
Ãtdev_vif
 *
ndev_vif
;

84 
u8
 
i
, 
queue_idx
;

86 
i
 = 
SLSI_NET_INDEX_WLAN
; i <ğ
SLSI_NET_INDEX_P2P
; i++) {

87 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
i
);

88 ià(
	`WARN
(!
dev
, "nØÃtdev (šdex:%d)", 
i
))

89  -
EFAULT
;

91 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

92 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

98 ià(
i
 =ğ
SLSI_NET_INDEX_P2P
) {

99 
queue_idx
 = 0; queue_idx < 
SLSI_ADHOC_PEER_CONNECTIONS_MAX
; queue_idx++) {

100 
ndev_vif
->
³”_¡a_»cÜd
[
queue_idx
] = 
	`kz®loc
((*ndev_vif->³”_¡a_»cÜd[queue_idx]), 
GFP_KERNEL
);

101 ià(!
ndev_vif
->
³”_¡a_»cÜd
[
queue_idx
]) {

102 
j
;

104 
	`SLSI_NET_ERR
(
dev
, "Could‚Ù‡Îoÿ‹ memÜy fÜ…“¸’Œy (queue_idx:%d)\n", 
queue_idx
);

107 
j
 = 0; j < 
queue_idx
; j++) {

108 
	`kä“
(
ndev_vif
->
³”_¡a_»cÜd
[
j
]);

109 
ndev_vif
->
³”_¡a_»cÜd
[
j
] = 
NULL
;

111 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

112  -
EFAULT
;

116 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

117 ià(
	`WARN
(
	`¦si_¤c_sšk_çke_¡a_¡¬t
(
sdev
, 
dev
è!ğ0, "çkSTA s‘u°çed (vif:%d)\n", 
i
))

118  -
EFAULT
;

121 
	}
}

123 
	$¦si_¤c_sšk_loİback_¡İ
(
¦si_dev
 *
sdev
)

125 
Ãt_deviû
 *
dev
;

126 
Ãtdev_vif
 *
ndev_vif
;

127 
u8
 
i
, 
queue_idx
;

129 
i
 = 
SLSI_NET_INDEX_WLAN
; i <ğ
SLSI_NET_INDEX_P2P
; i++) {

130 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
i
);

131 ià(
	`WARN
(!
dev
, "nØÃtdev (šdex:%d)", 
i
))

134 
	`¦si_¤c_sšk_çke_¡a_¡İ
(
sdev
, 
dev
);

136 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

137 
	`SLSI_MUTEX_LOCK
(
ndev_vif
->
vif_mu‹x
);

140 ià(
i
 =ğ
SLSI_NET_INDEX_P2P
) {

141 
queue_idx
 = 0; queue_idx < 
SLSI_ADHOC_PEER_CONNECTIONS_MAX
; queue_idx++) {

142 
	`kä“
(
ndev_vif
->
³”_¡a_»cÜd
[
queue_idx
]);

143 
ndev_vif
->
³”_¡a_»cÜd
[
queue_idx
] = 
NULL
;

146 
	`SLSI_MUTEX_UNLOCK
(
ndev_vif
->
vif_mu‹x
);

148 
	}
}

150 
	$¦si_¤c_sšk_cdev_ioùl_cfg
(
¦si_dev
 *
sdev
, 
¬g
)

152 
r
 = 0;

153 
unifiio_¤c_sšk_¬g_t
 
¤c_sšk_¬g
;

154 
Ãt_deviû
 *
dev
;

155 
Ãtdev_vif
 *
ndev_vif
;

156 
sk_buff
 *
»q
 = 
NULL
;

157 
sk_buff
 *
šd
 = 
NULL
;

159 
	`mem£t
((*)&
¤c_sšk_¬g
, 0, (
unifiio_¤c_sšk_¬g_t
));

160 ià(
	`cİy_äom_u£r
((*)(&
¤c_sšk_¬g
), (*)
¬g
, (
unifiio_¤c_sšk_¬g_t
)))

161  -
EFAULT
;

163 
	`SLSI_DBG2
(
sdev
, 
SLSI_SRC_SINK
, "Source/Sink\n");

164 
	`SLSI_DBG2
(
sdev
, 
SLSI_SRC_SINK
, "====================================================\n");

165 
	`SLSI_DBG2
(
sdev
, 
SLSI_SRC_SINK
, " #aùiÚ : [0x%04X]\n", 
¤c_sšk_¬g
.
commÚ
.
aùiÚ
);

166 
	`SLSI_DBG2
(
sdev
, 
SLSI_SRC_SINK
, " #dœeùiÚ : [0x%04X]\n", 
¤c_sšk_¬g
.
commÚ
.
dœeùiÚ
);

167 
	`SLSI_DBG2
(
sdev
, 
SLSI_SRC_SINK
, " #vià : [0x%04X]\n", 
¤c_sšk_¬g
.
commÚ
.
vif
);

168 
	`SLSI_DBG2
(
sdev
, 
SLSI_SRC_SINK
, " #’dpošˆ : [0x%04X]\n", 
¤c_sšk_¬g
.
commÚ
.
’dpošt
);

169 
	`SLSI_DBG2
(
sdev
, 
SLSI_SRC_SINK
, "====================================================\n");

171 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

172 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
¤c_sšk_¬g
.
commÚ
.
vif
);

173 ià(
	`WARN_ON
(!
dev
)) {

174 
	`SLSI_ERR
(
sdev
, "Ãtdev fÜ iÅuˆvif:%d i NULL\n", 
¤c_sšk_¬g
.
commÚ
.
vif
);

175 
r
 = -
ENODEV
;

176 
out_locked
;

178 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

180 
¤c_sšk_¬g
.
commÚ
.
aùiÚ
) {

181 
SRC_SINK_ACTION_SINK_START
:

182 ià(
	`WARN
(
	`¦si_¤c_sšk_çke_¡a_¡¬t
(
sdev
, 
dev
) != 0, "fake STA setup failed\n")) {

183 
r
 = -
EFAULT
;

184 
out_locked
;

186 
»q
 = 
	`çpi_®loc
(
debug_pkt_sšk_¡¬t_»q
, 
DEBUG_PKT_SINK_START_REQ
, 
¤c_sšk_¬g
.
commÚ
.
vif
, 0);

187 ià(
	`WARN_ON
(!
»q
)) {

188 
r
 = -
ENODEV
;

189 
out_locked
;

191 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_¡¬t_»q
.
’d_pošt
, 
¤c_sšk_¬g
.
commÚ
.
’dpošt
);

192 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_¡¬t_»q
.
dœeùiÚ
, 
¤c_sšk_¬g
.
commÚ
.direction);

193 
	`çpi_£t_u32
(
»q
, 
u
.
debug_pkt_sšk_¡¬t_»q
.
š‹rv®
, 
¤c_sšk_¬g
.u.
cÚfig
.interval);

194 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_¡¬t_»q
.
·ck‘s_³r_š‹rv®
, 
¤c_sšk_¬g
.u.
cÚfig
.
pkts_³r_št
);

195 
	`SLSI_DBG1
(
sdev
, 
SLSI_SRC_SINK
, "debug_pkt_sink_start_req->\n");

196 
r
 = 
	`¦si_mlme_»q
(
sdev
, 
dev
, 
»q
);

198 
SRC_SINK_ACTION_SINK_STOP
:

199 
»q
 = 
	`çpi_®loc
(
debug_pkt_sšk_¡İ_»q
, 
DEBUG_PKT_SINK_STOP_REQ
, 
¤c_sšk_¬g
.
commÚ
.
vif
, 0);

200 ià(
	`WARN_ON
(!
»q
)) {

201 
r
 = -
ENODEV
;

202 
out_locked
;

204 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_¡İ_»q
.
dœeùiÚ
, 
¤c_sšk_¬g
.
commÚ
.direction);

205 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_¡İ_»q
.
’d_pošt
, 
¤c_sšk_¬g
.
commÚ
.
’dpošt
);

206 
	`SLSI_DBG1
(
sdev
, 
SLSI_SRC_SINK
, "debug_pkt_sink_stop_req->\n");

207 
r
 = 
	`¦si_mlme_»q
(
sdev
, 
dev
, 
»q
);

208 
	`¦si_¤c_sšk_çke_¡a_¡İ
(
sdev
, 
dev
);

210 
SRC_SINK_ACTION_GEN_START
:

211 ià(
	`WARN
(
	`¦si_¤c_sšk_çke_¡a_¡¬t
(
sdev
, 
dev
) != 0, "fake STA setup failed\n")) {

212 
r
 = -
EFAULT
;

213 
out_locked
;

215 
»q
 = 
	`çpi_®loc
(
debug_pkt_g’_¡¬t_»q
, 
DEBUG_PKT_GEN_START_REQ
, 
¤c_sšk_¬g
.
commÚ
.
vif
, 0);

216 ià(
	`WARN_ON
(!
»q
)) {

217 
r
 = -
ENODEV
;

218 
out_locked
;

220 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_g’_¡¬t_»q
.
dœeùiÚ
, 
¤c_sšk_¬g
.
commÚ
.direction);

221 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_g’_¡¬t_»q
.
’d_pošt
, 
¤c_sšk_¬g
.
commÚ
.
’dpošt
);

222 
	`çpi_£t_u32
(
»q
, 
u
.
debug_pkt_g’_¡¬t_»q
.
š‹rv®
, 
¤c_sšk_¬g
.u.
cÚfig
.interval);

223 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_g’_¡¬t_»q
.
·ck‘s_³r_š‹rv®
, 
¤c_sšk_¬g
.u.
cÚfig
.
pkts_³r_št
);

224 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_g’_¡¬t_»q
.
size
, 
¤c_sšk_¬g
.u.
cÚfig
.u.
g’
.size);

225 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_g’_¡¬t_»q
.
u£_¡»amšg
, 
¤c_sšk_¬g
.u.
cÚfig
.u.
g’
.use_streaming);

226 
	`çpi_£t_u32
(
»q
, 
u
.
debug_pkt_g’_¡¬t_»q
.
v4de¡š©iÚ_add»ss
, 
¤c_sšk_¬g
.u.
cÚfig
.u.
g’
.
v4_de¡
);

227 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_g’_¡¬t_»q
.
·ck‘s_³r_š‹¼u±
, 
¤c_sšk_¬g
.u.
cÚfig
.u.
g’
.
pkts_³r_šŒ
);

229 
	`SLSI_DBG3
(
sdev
, 
SLSI_SRC_SINK
,

231 
¤c_sšk_¬g
.
u
.
cÚfig
.
š‹rv®
,

232 
¤c_sšk_¬g
.
u
.
cÚfig
.
pkts_³r_št
,

233 
¤c_sšk_¬g
.
commÚ
.
vif
,

234 
¤c_sšk_¬g
.
u
.
cÚfig
.u.
g’
.
size
,

235 
¤c_sšk_¬g
.
u
.
cÚfig
.u.
g’
.
u£_¡»amšg
,

236 
¤c_sšk_¬g
.
u
.
cÚfig
.u.
g’
.
v4_de¡
,

237 
¤c_sšk_¬g
.
u
.
cÚfig
.u.
g’
.
pkts_³r_šŒ
);

238 
	`SLSI_DBG1
(
sdev
, 
SLSI_SRC_SINK
, "debug_pkt_gen_start_req->\n");

239 
r
 = 
	`¦si_mlme_»q
(
sdev
, 
dev
, 
»q
);

241 
SRC_SINK_ACTION_GEN_STOP
:

242 
»q
 = 
	`çpi_®loc
(
debug_pkt_g’_¡İ_»q
, 
DEBUG_PKT_GEN_STOP_REQ
, 
¤c_sšk_¬g
.
commÚ
.
vif
, 0);

243 ià(
	`WARN_ON
(!
»q
)) {

244 
r
 = -
ENODEV
;

245 
out_locked
;

247 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_g’_¡İ_»q
.
dœeùiÚ
, 
¤c_sšk_¬g
.
commÚ
.direction);

248 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_g’_¡İ_»q
.
’d_pošt
, 
¤c_sšk_¬g
.
commÚ
.
’dpošt
);

249 
	`SLSI_DBG1
(
sdev
, 
SLSI_SRC_SINK
, "debug_pkt_gen_stop_req->\n");

250 
r
 = 
	`¦si_mlme_»q
(
sdev
, 
dev
, 
»q
);

251 
	`¦si_¤c_sšk_çke_¡a_¡İ
(
sdev
, 
dev
);

253 
SRC_SINK_ACTION_LOOPBACK_START
:

254 ià(
	`WARN
(
	`¦si_¤c_sšk_loİback_¡¬t
(
sdev
) != 0, "loopback setup failed\n")) {

255 
r
 = -
EFAULT
;

256 
out_locked
;

258 
»q
 = 
	`çpi_®loc
(
debug_pkt_sšk_¡¬t_»q
, 
DEBUG_PKT_SINK_START_REQ
, 1, 0);

259 ià(
	`WARN_ON
(!
»q
)) {

260 
r
 = -
ENODEV
;

261 
out_locked
;

263 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_¡¬t_»q
.
’d_pošt
, 
SRC_SINK_ENDPOINT_HOSTIO
);

264 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_¡¬t_»q
.
dœeùiÚ
, 
SRC_SINK_DIRECTION_RX
);

265 
	`çpi_£t_u32
(
»q
, 
u
.
debug_pkt_sšk_¡¬t_»q
.
š‹rv®
, 
¤c_sšk_¬g
.u.
cÚfig
.interval);

266 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_¡¬t_»q
.
·ck‘s_³r_š‹rv®
, 
¤c_sšk_¬g
.u.
cÚfig
.
pkts_³r_št
);

267 
	`SLSI_DBG1
(
sdev
, 
SLSI_SRC_SINK
, "debug_pkt_loopback_start_req->\n");

268 
r
 = 
	`¦si_mlme_»q
(
sdev
, 
dev
, 
»q
);

270 
SRC_SINK_ACTION_LOOPBACK_STOP
:

271 
»q
 = 
	`çpi_®loc
(
debug_pkt_sšk_¡İ_»q
, 
DEBUG_PKT_SINK_STOP_REQ
, 1, 0);

272 ià(
	`WARN_ON
(!
»q
)) {

273 
r
 = -
ENODEV
;

274 
out_locked
;

276 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_¡İ_»q
.
dœeùiÚ
, 
SRC_SINK_DIRECTION_RX
);

277 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_¡İ_»q
.
’d_pošt
, 
SRC_SINK_ENDPOINT_HOSTIO
);

278 
	`SLSI_DBG1
(
sdev
, 
SLSI_SRC_SINK
, "debug_pkt_loopback_stop_req->\n");

279 
r
 = 
	`¦si_mlme_»q
(
sdev
, 
dev
, 
»q
);

280 
	`¦si_¤c_sšk_loİback_¡İ
(
sdev
);

282 
SRC_SINK_ACTION_SINK_REPORT
:

283 
»q
 = 
	`çpi_®loc
(
debug_pkt_sšk_»pÜt_»q
, 
DEBUG_PKT_SINK_REPORT_REQ
, 
¤c_sšk_¬g
.
commÚ
.
vif
, 0);

284 ià(
	`WARN_ON
(!
»q
)) {

285 
r
 = -
ENODEV
;

286 
out_locked
;

288 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_»pÜt_»q
.
’d_pošt
, 
¤c_sšk_¬g
.
commÚ
.
’dpošt
);

289 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_sšk_»pÜt_»q
.
dœeùiÚ
, 
¤c_sšk_¬g
.
commÚ
.direction);

290 
	`çpi_£t_u32
(
»q
, 
u
.
debug_pkt_sšk_»pÜt_»q
.
»pÜt_š‹rv®
, 
¤c_sšk_¬g
.u.
»pÜt
.
š‹rv®
);

291 
	`SLSI_DBG1
(
sdev
, 
SLSI_SRC_SINK
, "debug_pkt_sink_report_req->\n");

293 
šd
 = 
	`¦si_mlme_»q_šd
(
sdev
, 
dev
, 
»q
, 
DEBUG_PKT_SINK_REPORT_IND
);

294 ià(!
šd
) {

295 
	`SLSI_ERR
(
sdev
, "slsi_mlme_req_ind [SINK_REPORT] failed\n");

296 
r
 = -
EIO
;

300 
¤c_sšk_¬g
.
u
.
»pÜt
.
du¿tiÚ
 = 
	`çpi_g‘_u32
(
šd
, u.
debug_pkt_sšk_»pÜt_šd
.duration);

301 
¤c_sšk_¬g
.
u
.
»pÜt
.
couÁ
 = 
	`çpi_g‘_u32
(
šd
, u.
debug_pkt_sšk_»pÜt_šd
.
»ûived_·ck‘s
);

302 
¤c_sšk_¬g
.
u
.
»pÜt
.
où‘
 = 
	`çpi_g‘_u32
(
šd
, u.
debug_pkt_sšk_»pÜt_šd
.
»ûived_où‘s
);

303 
¤c_sšk_¬g
.
u
.
»pÜt
.
kbps
 = 
	`çpi_g‘_u32
(
šd
, u.
debug_pkt_sšk_»pÜt_šd
.kbps);

304 
¤c_sšk_¬g
.
u
.
»pÜt
.
idË_¿tio
 = 
	`çpi_g‘_u16
(
šd
, u.
debug_pkt_sšk_»pÜt_šd
.idle_ratio);

305 
¤c_sšk_¬g
.
u
.
»pÜt
.
š‹¼u±_Ï‹ncy
 = 
	`çpi_g‘_u16
(
šd
, u.
debug_pkt_sšk_»pÜt_šd
.
št_Ï‹ncy
);

306 
¤c_sšk_¬g
.
u
.
»pÜt
.
ä“_kby‹s
 = 
	`çpi_g‘_u16
(
šd
, u.
debug_pkt_sšk_»pÜt_šd
.free_kbytes);

307 
¤c_sšk_¬g
.
u
.
»pÜt
.
time¡amp
 = 
	`jiff›s_to_m£cs
(
jiff›s
);

309 
	`mem£t
(&
ndev_vif
->
¤c_sšk_·¿ms
.
sšk_»pÜt
, 0, (
unifiio_¤c_sšk_»pÜt
));

312 ià(
	`cİy_to_u£r
((*)
¬g
, (*)(&
¤c_sšk_¬g
), (
unifiio_¤c_sšk_¬g_t
)))

313 
r
 = -
EFAULT
;

314 
	`kä“_skb
(
šd
);

316 
SRC_SINK_ACTION_GEN_REPORT
:

317 
»q
 = 
	`çpi_®loc
(
debug_pkt_g’_»pÜt_»q
, 
DEBUG_PKT_GEN_REPORT_REQ
, 
¤c_sšk_¬g
.
commÚ
.
vif
, 0);

318 ià(
	`WARN_ON
(!
»q
)) {

319 
r
 = -
ENODEV
;

320 
out_locked
;

322 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_g’_»pÜt_»q
.
’d_pošt
, 
¤c_sšk_¬g
.
commÚ
.
’dpošt
);

323 
	`çpi_£t_u16
(
»q
, 
u
.
debug_pkt_g’_»pÜt_»q
.
dœeùiÚ
, 
¤c_sšk_¬g
.
commÚ
.direction);

324 
	`çpi_£t_u32
(
»q
, 
u
.
debug_pkt_g’_»pÜt_»q
.
»pÜt_š‹rv®
, 
¤c_sšk_¬g
.u.
»pÜt
.
š‹rv®
);

325 
	`SLSI_DBG1
(
sdev
, 
SLSI_SRC_SINK
, "debug_pkt_gen_report_req->\n");

327 
šd
 = 
	`¦si_mlme_»q_šd
(
sdev
, 
dev
, 
»q
, 
DEBUG_PKT_GEN_REPORT_IND
);

328 ià(!
šd
) {

329 
	`SLSI_ERR
(
sdev
, "slsi_mlme_req_ind [GEN_REPORT] failed\n");

330 
r
 = -
EIO
;

334 
¤c_sšk_¬g
.
u
.
»pÜt
.
du¿tiÚ
 = 
	`çpi_g‘_u32
(
šd
, u.
debug_pkt_g’_»pÜt_šd
.duration);

335 
¤c_sšk_¬g
.
u
.
»pÜt
.
couÁ
 = 
	`çpi_g‘_u32
(
šd
, u.
debug_pkt_g’_»pÜt_šd
.
»ûived_·ck‘s
);

336 
¤c_sšk_¬g
.
u
.
»pÜt
.
çed_couÁ
 = 
	`çpi_g‘_u32
(
šd
, u.
debug_pkt_g’_»pÜt_šd
.failed_count);

337 
¤c_sšk_¬g
.
u
.
»pÜt
.
où‘
 = 
	`çpi_g‘_u32
(
šd
, u.
debug_pkt_g’_»pÜt_šd
.
»ûived_où‘s
);

338 
¤c_sšk_¬g
.
u
.
»pÜt
.
kbps
 = 
	`çpi_g‘_u32
(
šd
, u.
debug_pkt_g’_»pÜt_šd
.kbps);

339 
¤c_sšk_¬g
.
u
.
»pÜt
.
idË_¿tio
 = 
	`çpi_g‘_u16
(
šd
, u.
debug_pkt_g’_»pÜt_šd
.idle_ratio);

340 
¤c_sšk_¬g
.
u
.
»pÜt
.
š‹¼u±_Ï‹ncy
 = 
	`çpi_g‘_u16
(
šd
, u.
debug_pkt_g’_»pÜt_šd
.
št_Ï‹ncy
);

341 
¤c_sšk_¬g
.
u
.
»pÜt
.
ä“_kby‹s
 = 
	`çpi_g‘_u16
(
šd
, u.
debug_pkt_g’_»pÜt_šd
.free_kbytes);

343 
¤c_sšk_¬g
.
u
.
»pÜt
.
time¡amp
 = 
	`jiff›s_to_m£cs
(
jiff›s
);

345 
	`mem£t
(&
ndev_vif
->
¤c_sšk_·¿ms
.
g’_»pÜt
, 0, (
unifiio_¤c_sšk_»pÜt
));

348 ià(
	`cİy_to_u£r
((*)
¬g
, (*)(&
¤c_sšk_¬g
), (
unifiio_¤c_sšk_¬g_t
)))

349 
r
 = -
EFAULT
;

350 
	`kä“_skb
(
šd
);

352 
SRC_SINK_ACTION_SINK_REPORT_CACHED
:

353 
	`SLSI_DBG1
(
sdev
, 
SLSI_SRC_SINK
, "cached sink_report\n");

354 
	`memıy
(&
¤c_sšk_¬g
.
u
.
»pÜt
, &
ndev_vif
->
¤c_sšk_·¿ms
.
sšk_»pÜt
, (
unifiio_¤c_sšk_»pÜt
));

355 
	`mem£t
(&
ndev_vif
->
¤c_sšk_·¿ms
.
sšk_»pÜt
, 0, (
unifiio_¤c_sšk_»pÜt
));

357 ià(
	`cİy_to_u£r
((*)
¬g
, (*)(&
¤c_sšk_¬g
), (
unifiio_¤c_sšk_¬g_t
)))

358 
r
 = -
EFAULT
;

361 
SRC_SINK_ACTION_GEN_REPORT_CACHED
:

362 
	`SLSI_DBG1
(
sdev
, 
SLSI_SRC_SINK
, "cached gen_report\n");

363 
	`memıy
(&
¤c_sšk_¬g
.
u
.
»pÜt
, &
ndev_vif
->
¤c_sšk_·¿ms
.
g’_»pÜt
, (
unifiio_¤c_sšk_»pÜt
));

364 
	`mem£t
(&
ndev_vif
->
¤c_sšk_·¿ms
.
g’_»pÜt
, 0, (
unifiio_¤c_sšk_»pÜt
));

366 ià(
	`cİy_to_u£r
((*)
¬g
, (*)(&
¤c_sšk_¬g
), (
unifiio_¤c_sšk_¬g_t
)))

367 
r
 = -
EFAULT
;

370 
	`SLSI_ERR
(
sdev
, "Inv®id iÅuˆfÜ‡ùiÚ: 0x%04X\n", 
¤c_sšk_¬g
.
commÚ
.
aùiÚ
);

371 
r
 = -
EINVAL
;

375 
out_locked
:

376 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

377 ià(
r
)

378 
	`SLSI_ERR
(
sdev
, "¦si_¤c_sšk_cdev_ioùl_cfg(vif:%dèçed w™h %ld\n", 
¤c_sšk_¬g
.
commÚ
.
vif
, 
r
);

379  
r
;

380 
	}
}

382 
	$¦si_rx_sšk_»pÜt
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

384 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

385 
unifiio_¤c_sšk_»pÜt
 *
»pÜt
 = &
ndev_vif
->
¤c_sšk_·¿ms
.
sšk_»pÜt
;

387 
	`SLSI_DBG3
(
sdev
, 
SLSI_SRC_SINK
, "RX debug_pkt_sink_report_ind\n");

389 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

390 
	`mem£t
(
»pÜt
, 0, (
unifiio_¤c_sšk_»pÜt
));

391 
»pÜt
->
du¿tiÚ
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_pkt_sšk_»pÜt_šd
.duration);

392 
»pÜt
->
couÁ
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_pkt_sšk_»pÜt_šd
.
»ûived_·ck‘s
);

393 
»pÜt
->
où‘
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_pkt_sšk_»pÜt_šd
.
»ûived_où‘s
);

394 
»pÜt
->
kbps
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_pkt_sšk_»pÜt_šd
.kbps);

395 
»pÜt
->
idË_¿tio
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_pkt_sšk_»pÜt_šd
.idle_ratio);

396 
»pÜt
->
š‹¼u±_Ï‹ncy
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_pkt_sšk_»pÜt_šd
.
št_Ï‹ncy
);

397 
»pÜt
->
ä“_kby‹s
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_pkt_sšk_»pÜt_šd
.free_kbytes);

398 
»pÜt
->
time¡amp
 = 
	`jiff›s_to_m£cs
(
jiff›s
);

399 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

400 
	`kä“_skb
(
skb
);

401 
	}
}

403 
	$¦si_rx_g’_»pÜt
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

405 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

406 
unifiio_¤c_sšk_»pÜt
 *
»pÜt
 = &
ndev_vif
->
¤c_sšk_·¿ms
.
g’_»pÜt
;

408 
	`SLSI_DBG3
(
sdev
, 
SLSI_SRC_SINK
, "RX debug_pkt_gen_report_ind\n");

410 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

411 
	`mem£t
(
»pÜt
, 0, (
unifiio_¤c_sšk_»pÜt
));

412 
»pÜt
->
du¿tiÚ
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_pkt_g’_»pÜt_šd
.duration);

413 
»pÜt
->
couÁ
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_pkt_g’_»pÜt_šd
.
»ûived_·ck‘s
);

414 
»pÜt
->
çed_couÁ
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_pkt_g’_»pÜt_šd
.failed_count);

415 
»pÜt
->
où‘
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_pkt_g’_»pÜt_šd
.
»ûived_où‘s
);

416 
»pÜt
->
kbps
 = 
	`çpi_g‘_u32
(
skb
, 
u
.
debug_pkt_g’_»pÜt_šd
.kbps);

417 
»pÜt
->
idË_¿tio
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_pkt_g’_»pÜt_šd
.idle_ratio);

418 
»pÜt
->
š‹¼u±_Ï‹ncy
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_pkt_g’_»pÜt_šd
.
št_Ï‹ncy
);

419 
»pÜt
->
ä“_kby‹s
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_pkt_g’_»pÜt_šd
.free_kbytes);

420 
»pÜt
->
time¡amp
 = 
	`jiff›s_to_m£cs
(
jiff›s
);

421 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

422 
	`kä“_skb
(
skb
);

423 
	}
}

	@src_sink.h

7 #iâdeà
__SLSI_SRC_SINK_H__


8 
	#__SLSI_SRC_SINK_H__


	)

10 
	~"unifiio.h
"

12 
	s¦si_¤c_sšk_·¿ms
 {

13 
unifiio_¤c_sšk_»pÜt
 
	msšk_»pÜt
;

14 
unifiio_¤c_sšk_»pÜt
 
	mg’_»pÜt
;

17 
¦si_¤c_sšk_cdev_ioùl_cfg
(
¦si_dev
 *
sdev
, 
¬g
);

19 
¦si_rx_sšk_»pÜt
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

20 
¦si_rx_g’_»pÜt
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

	@test/dev_test.c

7 
	~<Ãt/.h
>

9 
	~"debug.h
"

10 
	~"uts.h
"

11 
	~"udi.h
"

12 
	~"un™‹¡.h
"

13 
	~"mgt.h
"

14 
	~"scsc/scsc_mx.h
"

16 
	#SLSI_TESTDRV_NAME
 "s5n2560_‹¡"

	)

18 
	g¿dios
 = 11;

19 
moduË_·¿m
(
¿dios
, , 0444);

20 
MODULE_PARM_DESC
(
¿dios
, "Number of simulated„adios");

23 
¦si_¥šlock
 
	g¦si_‹¡_deviûs_lock
;

24 
¦si_‹¡_dev
 *
	g¦si_‹¡_deviûs
[
SLSI_UDI_MINOR_NODES
];

26 
şass
 *
	g‹¡_dev_şass
;

28 
dev_t
 
	gmajÜ_numb”
;

30 
deviû_driv”
 
	g¦si_‹¡_driv”
 = {

31 .
Çme
 = 
SLSI_TESTDRV_NAME


34 
¦si_‹¡_dev_©ch_wÜk
(
wÜk_¡ruù
 *
wÜk
);

35 
¦si_‹¡_dev_d‘ach_wÜk
(
wÜk_¡ruù
 *
wÜk
);

37 
	$¦si_‹¡_dev_ä“
()

39 
i
;

41 
i
 = 0; i < 
SLSI_UDI_MINOR_NODES
; i++) {

42 
¦si_‹¡_dev
 *
uáe¡dev
;

44 
	`¦si_¥šlock_lock
(&
¦si_‹¡_deviûs_lock
);

45 
uáe¡dev
 = 
¦si_‹¡_deviûs
[
i
];

46 
¦si_‹¡_deviûs
[
i
] = 
NULL
;

47 
	`¦si_¥šlock_uÆock
(&
¦si_‹¡_deviûs_lock
);

48 ià(
uáe¡dev
 !ğ
NULL
) {

49 
	`SLSI_INFO_NODEV
("Free Test Device: %02X:%02X:%02X:%02X:%02X:%02X\n",

50 
uáe¡dev
->
hw_addr
[0],

51 
uáe¡dev
->
hw_addr
[1],

52 
uáe¡dev
->
hw_addr
[2],

53 
uáe¡dev
->
hw_addr
[3],

54 
uáe¡dev
->
hw_addr
[4],

55 
uáe¡dev
->
hw_addr
[5]);

57 ià(
	`WARN_ON
(
uáe¡dev
->
©ched
)) {

58 
	`¦si_‹¡_bh_deš™
(
uáe¡dev
);

59 
	`æush_wÜkqueue
(
uáe¡dev
->
©ch_d‘ach_wÜk_queue
);

61 
	`de¡roy_wÜkqueue
(
uáe¡dev
->
©ch_d‘ach_wÜk_queue
);

63 
	`¦si_‹¡_udi_node_deš™
(
uáe¡dev
);

65 
	`deviû_uÄegi¡”
(
uáe¡dev
->
dev
);

66 
	`deviû_de¡roy
(
‹¡_dev_şass
, 
uáe¡dev
->
dev
->
devt
);

70 
	`¦si_‹¡_udi_deš™
();

72 ià(
‹¡_dev_şass
 !ğ
NULL
)

73 
	`şass_de¡roy
(
‹¡_dev_şass
);

75 
	`uÄegi¡”_chrdev_»giÚ
(
majÜ_numb”
, 
SLSI_UDI_MINOR_NODES
);

76 
	}
}

78 
	$¦si_sdio_func_drv_»gi¡”
()

80 
i
 = 0, 
”r
 = 0, 
»t
 = 0;

81 
¦si_‹¡_dev
 *
uáe¡dev
;

82 
dev_t
 
devno
;

84 
	`SLSI_INFO_NODEV
("Lßdšg SLSI " 
SLSI_TESTDRV_NAME
 " Test Driver for mac80211\n");

86 ià(
¿dios
 > 
SLSI_UDI_MINOR_NODES
) {

87 
	`SLSI_ERR_NODEV
("Loading failed, configure SLSI_UDI_MINOR_NODESo match‚o. of simulated„adios\n");

88  -
ENOMEM
;

91 
	`¦si_¥šlock_ü—‹
(&
¦si_‹¡_deviûs_lock
);

92 
	`mem£t
(
¦si_‹¡_deviûs
, 0x00, (slsi_test_devices));

95 
»t
 = 
	`®loc_chrdev_»giÚ
(&
majÜ_numb”
, 0, 
SLSI_UDI_MINOR_NODES
, 
SLSI_TESTDRV_NAME
);

96 ià(
»t
) {

97 
	`SLSI_ERR_NODEV
("FaedØadd‡Îoødev‚umb”s: %d\n", 
»t
);

98 
	`uÄegi¡”_chrdev_»giÚ
(
majÜ_numb”
, 
SLSI_UDI_MINOR_NODES
);

99 
majÜ_numb”
 = 0;

100  -
ENOMEM
;

103 
‹¡_dev_şass
 = 
	`şass_ü—‹
(
THIS_MODULE
, 
SLSI_TESTDRV_NAME
);

104 ià(
	`IS_ERR
(
‹¡_dev_şass
))

105  -
EAGAIN
;

107 
	`¦si_‹¡_udi_š™
();

109 
i
 = 0; i < 
¿dios
; i++) {

110 
uáe¡dev
 = 
	`km®loc
((*uáe¡dev), 
GFP_KERNEL
);

111 
	`mem£t
(
uáe¡dev
, 0, (*uftestdev));

112 
uáe¡dev
->
©ch_d‘ach_wÜk_queue
 = 
	`®loc_Üd”ed_wÜkqueue
("Test Work", 0);

113 
	`INIT_WORK
(&
uáe¡dev
->
©ch_wÜk
, 
¦si_‹¡_dev_©ch_wÜk
);

114 
	`INIT_WORK
(&
uáe¡dev
->
d‘ach_wÜk
, 
¦si_‹¡_dev_d‘ach_wÜk
);

116 
devno
 = 
	`MKDEV
(
	`MAJOR
(
majÜ_numb”
), 
i
);

118 
uáe¡dev
->
dev
 = 
	`deviû_ü—‹
(
‹¡_dev_şass
, 
NULL
, 
devno
, uáe¡dev, 
SLSI_TESTDRV_NAME
 "_dev%d", 
i
);

119 ià(
	`IS_ERR
(
uáe¡dev
->
dev
)) {

120 
	`SLSI_ERR_NODEV
("deviû_ü—‹ FAILED,„‘uºed - (%ld)\n", 
	`PTR_ERR
(
uáe¡dev
->
dev
));

121 
”r
 = -
ENOMEM
;

122 
çed_ä“_®l
;

125 
uáe¡dev
->
dev
->
driv”
 = &
¦si_‹¡_driv”
;

127 
	`mu‹x_š™
(&
uáe¡dev
->
©ch_d‘ach_mu‹x
);

128 
	`¦si_‹¡_bh_š™
(
uáe¡dev
);

129 
	`¥š_lock_š™
(&
uáe¡dev
->
rou‹_¥šlock
);

131 ià(
	`¦si_‹¡_udi_node_š™
(
uáe¡dev
, uáe¡dev->
dev
) != 0) {

132 
	`SLSI_ERR_NODEV
("udi <node> init FAILED\n");

133 
çed_dev_uÄegi¡”
;

141 
	`mem£t
(
uáe¡dev
->
hw_addr
, 0, (uftestdev->hw_addr));

142 
uáe¡dev
->
hw_addr
[1] = 0x12;

143 
uáe¡dev
->
hw_addr
[2] = 0xFB;

145 
uáe¡dev
->
hw_addr
[
ETH_ALEN
 - 1] +ğ(
i
 & (0xff));

147 
	`SLSI_INFO_NODEV
("Create Test Device: %02X:%02X:%02X:%02X:%02X:%02X\n",

148 
uáe¡dev
->
hw_addr
[0],

149 
uáe¡dev
->
hw_addr
[1],

150 
uáe¡dev
->
hw_addr
[2],

151 
uáe¡dev
->
hw_addr
[3],

152 
uáe¡dev
->
hw_addr
[4],

153 
uáe¡dev
->
hw_addr
[5]);

154 
¦si_‹¡_deviûs
[
uáe¡dev
->
deviû_mšÜ_numb”
] = uftestdev;

159 
çed_dev_uÄegi¡”
:

160 
	`deviû_uÄegi¡”
(
uáe¡dev
->
dev
);

161 
	`deviû_de¡roy
(
‹¡_dev_şass
, 
uáe¡dev
->
dev
->
devt
);

162 
çed_ä“_®l
:

163 
	`¦si_‹¡_dev_ä“
();

165  -
EPERM
;

166 
	}
}

168 
	$¦si_sdio_func_drv_uÄegi¡”
()

170 
	`SLSI_INFO_NODEV
("Unloading UF6K Test Driver for mac80211\n");

171 
	`¦si_‹¡_dev_ä“
();

172 
	}
}

174 
	$¦si_‹¡_dev_©ch
(
¦si_‹¡_dev
 *
uáe¡dev
)

176 
¦si_dev
 *
sdev
;

177 
scsc_£rviû_ş›Á
 
£rviû_ş›Á
;

179 
	`mu‹x_lock
(&
uáe¡dev
->
©ch_d‘ach_mu‹x
);

180 
	`SLSI_INFO_NODEV
("UnitTest UDI Attached : %02X:%02X:%02X:%02X:%02X:%02X\n",

181 
uáe¡dev
->
hw_addr
[0],

182 
uáe¡dev
->
hw_addr
[1],

183 
uáe¡dev
->
hw_addr
[2],

184 
uáe¡dev
->
hw_addr
[3],

185 
uáe¡dev
->
hw_addr
[4],

186 
uáe¡dev
->
hw_addr
[5]);

188 ià(
uáe¡dev
->
©ched
) {

189 
	`SLSI_ERR_NODEV
("attached ==rue\n");

190 
ex™
;

193 
uáe¡dev
->
©ched
 = 
Œue
;

194 
sdev
 = 
	`¦si_dev_©ch
(
uáe¡dev
->
dev
, (
scsc_mx
 *)uáe¡dev, &
£rviû_ş›Á
);

196 
	`¦si_¥šlock_lock
(&
¦si_‹¡_deviûs_lock
);

197 
uáe¡dev
->
sdev
 = sdev;

198 ià(!
sdev
) {

199 
	`SLSI_ERR_NODEV
("slsi_dev_attach() Failed\n");

200 
uáe¡dev
->
©ched
 = 
çl£
;

202 
	`¦si_‹¡_bh_¡¬t
(
uáe¡dev
);

205 
	`¦si_¥šlock_uÆock
(&
¦si_‹¡_deviûs_lock
);

207 
ex™
:

208 
	`mu‹x_uÆock
(&
uáe¡dev
->
©ch_d‘ach_mu‹x
);

209 
	}
}

211 
	$¦si_‹¡_dev_d‘ach
(
¦si_‹¡_dev
 *
uáe¡dev
)

213 
	`mu‹x_lock
(&
uáe¡dev
->
©ch_d‘ach_mu‹x
);

214 
	`SLSI_INFO
(
uáe¡dev
->
sdev
, "UnitTest UDI Detached : %02X:%02X:%02X:%02X:%02X:%02X\n",

215 
uáe¡dev
->
hw_addr
[0],

216 
uáe¡dev
->
hw_addr
[1],

217 
uáe¡dev
->
hw_addr
[2],

218 
uáe¡dev
->
hw_addr
[3],

219 
uáe¡dev
->
hw_addr
[4],

220 
uáe¡dev
->
hw_addr
[5]);

221 ià(!
uáe¡dev
->
©ched
) {

222 
	`SLSI_ERR
(
uáe¡dev
->
sdev
, "attached !=rue\n");

223 
ex™
;

226 
uáe¡dev
->
©ched
 = 
çl£
;

227 ià(
uáe¡dev
->
sdev
) {

228 
¦si_dev
 *
sdev
 = 
uáe¡dev
->sdev;

230 
	`¦si_‹¡_bh_¡İ
(
uáe¡dev
);

232 
	`¦si_dev_d‘ach
(
sdev
);

233 
	`¦si_¥šlock_lock
(&
¦si_‹¡_deviûs_lock
);

234 
uáe¡dev
->
sdev
 = 
NULL
;

235 
	`¦si_¥šlock_uÆock
(&
¦si_‹¡_deviûs_lock
);

238 
ex™
:

239 
	`mu‹x_uÆock
(&
uáe¡dev
->
©ch_d‘ach_mu‹x
);

240 
	}
}

242 
	$¦si_š™_Ãtdev_mac_addr
(
¦si_dev
 *
sdev
)

245 
	`¦si_g‘_hw_mac_add»ss
(
sdev
, sdev->
hw_addr
);

247 
	`SLSI_ETHER_COPY
(
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_WLAN
], sdev->
hw_addr
);

249 
	`SLSI_ETHER_COPY
(
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2P
], sdev->
hw_addr
);

250 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2P
][0] |= 0x02;

252 
	`SLSI_ETHER_COPY
(
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2PX_SWLAN
], sdev->
hw_addr
);

253 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2PX_SWLAN
][0] |= 0x02;

254 
sdev
->
Ãtdev_add»s£s
[
SLSI_NET_INDEX_P2PX_SWLAN
][4] ^= 0x80;

256 
	`SLSI_ETHER_COPY
(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_WLAN
]->
dev_addr
, sdev->
Ãtdev_add»s£s
[SLSI_NET_INDEX_WLAN]);

257 
	`SLSI_ETHER_COPY
(
sdev
->
Ãtdev
[
SLSI_NET_INDEX_P2P
]->
dev_addr
, sdev->
Ãtdev_add»s£s
[SLSI_NET_INDEX_P2P]);

258 
	}
}

260 
boŞ
 
	$¦si_‹¡_´oûss_sigÇl__»m­
(
¦si_‹¡_dev
 *
uáe¡dev
, 
sk_buff
 *
skb
, 
¦si_‹¡_d©a_rou‹
 *
rou‹
)

262 
´Ùo
 = 
	`Áohs
(
skb
->
´ÙocŞ
);

263 
u8
 *
äame
 = 
	`çpi_g‘_d©a
(
skb
) + 14;

265 
´Ùo
) {

269 
u8
 *
sha
 = &
äame
[8];

270 
u8
 *
¥a
 = &
äame
[14];

271 
u8
 *
tha
 = &
äame
[18];

272 
u8
 *
a
 = &
äame
[24];

274 
	`SLSI_UNUSED_PARAMETER
(
sha
);

275 
	`SLSI_UNUSED_PARAMETER
(
¥a
);

276 
	`SLSI_UNUSED_PARAMETER
(
tha
);

277 
	`SLSI_UNUSED_PARAMETER
(
a
);

279 
	`SLSI_DBG4
(
uáe¡dev
->
sdev
, 
SLSI_TEST
, "ARP: sha:%pM, spa:%d.%d.%d.%d,ha:%pM,pa:%d.%d.%d.%d\n",

280 
sha
, 
¥a
[0], spa[1], spa[2], spa[3],

281 
tha
, 
a
[0],pa[1],pa[2],pa[3]);

282 
¥a
[2] = 
rou‹
->
subÃt
;

283 
a
[2] = 
rou‹
->
subÃt
;

284 
	`SLSI_DBG4
(
uáe¡dev
->
sdev
, 
SLSI_TEST
, "ARP: sha:%pM, spa:%d.%d.%d.%d,ha:%pM,pa:%d.%d.%d.%d\n",

285 
sha
, 
¥a
[0], spa[1], spa[2], spa[3],

286 
tha
, 
a
[0],pa[1],pa[2],pa[3]);

287  
Œue
;

292 
hdr
 *
h
 = (hd¸*)
äame
;

293 
u8
 *
¤c
 = (u8 *)&
h
->
§ddr
;

294 
u8
 *
d¡
 = (u8 *)&
h
->
daddr
;

296 
	`SLSI_UNUSED_PARAMETER
(
¤c
);

297 
	`SLSI_UNUSED_PARAMETER
(
d¡
);

299 
	`SLSI_DBG4
(
uáe¡dev
->
sdev
, 
SLSI_TEST
, "PING: src:%d.%d.%d.%d, dst:%d.%d.%d.%d, check:0x%.4X\n",

300 
¤c
[0], src[1], src[2], src[3],

301 
d¡
[0], dst[1], dst[2], dst[3],

302 
h
->
check
);

303 
¤c
[2] = 
rou‹
->
subÃt
;

304 
d¡
[2] = 
rou‹
->
subÃt
;

307 
h
->
check
 = 0;

308 
	`_£nd_check
(
h
);

310 
	`SLSI_DBG4
(
uáe¡dev
->
sdev
, 
SLSI_TEST
, "PING: src:%d.%d.%d.%d, dst:%d.%d.%d.%d, check:0x%.4X\n",

311 
¤c
[0], src[1], src[2], src[3],

312 
d¡
[0], dst[1], dst[2], dst[3],

313 
h
->
check
);

315  
Œue
;

318 
	`SLSI_DBG4
(
uáe¡dev
->
sdev
, 
SLSI_TEST
, "PrÙo:0x%.4X\n", 
´Ùo
);

321  
çl£
;

322 
	}
}

324 
¦si_‹¡_d©a_rou‹
 *
	$¦si_‹¡_´oûss_sigÇl_g‘_rou‹
(
¦si_‹¡_dev
 *
uáe¡dev
, cÚ¡ 
u8
 *
mac
)

326 
¦si_‹¡_d©a_rou‹
 *
rou‹
;

327 
i
;

329 ià(
	`WARN_ON
(!
	`¥š_is_locked
(&
uáe¡dev
->
rou‹_¥šlock
)))

330  
NULL
;

332 
i
 = 0; i < 
SLSI_AP_PEER_CONNECTIONS_MAX
; i++) {

333 
rou‹
 = &
uáe¡dev
->rou‹[
i
];

334 ià(
rou‹
->
cÚfigu»d
 && 
	`‘h”_addr_equ®
Ôou‹->
mac
, mac))

335  
rou‹
;

338  
NULL
;

339 
	}
}

341 
¦si_‹¡_d©a_rou‹
 *
	$¦si_‹¡_´oûss_sigÇl_g‘_ä“_rou‹
(
¦si_‹¡_dev
 *
uáe¡dev
)

343 
¦si_‹¡_d©a_rou‹
 *
rou‹
;

344 
i
;

346 ià(
	`WARN_ON
(!
	`¥š_is_locked
(&
uáe¡dev
->
rou‹_¥šlock
)))

347  
NULL
;

349 
i
 = 0; i < 
SLSI_AP_PEER_CONNECTIONS_MAX
; i++) {

350 
rou‹
 = &
uáe¡dev
->rou‹[
i
];

351 ià(!
rou‹
->
cÚfigu»d
)

352  
rou‹
;

355  
NULL
;

356 
	}
}

358 
	$¦si_‹¡_´oûss_sigÇl_£t_rou‹
(
¦si_‹¡_dev
 *
uáe¡dev
, 
sk_buff
 *
skb
)

360 
¦si_‹¡_d©a_rou‹
 *
rou‹
;

361 
u8
 
mac
[
ETH_ALEN
];

362 
u16
 
de¡_deviû_mšÜ_numb”
 = 0xFFFF;

363 
i
;

365 
mac
[0] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[2]) >> 8;

366 
mac
[1] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[2]) & 0xFF;

367 
mac
[2] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[3]) >> 8;

368 
mac
[3] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[3]) & 0xFF;

369 
mac
[4] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[4]) >> 8;

370 
mac
[5] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[4]) & 0xFF;

372 
	`¦si_¥šlock_lock
(&
¦si_‹¡_deviûs_lock
);

373 
i
 = 0; i < 
SLSI_UDI_MINOR_NODES
; i++) {

374 
¦si_‹¡_dev
 *
de¡dev
 = 
¦si_‹¡_deviûs
[
i
];

376 ià(
de¡dev
 !ğ
NULL
 && 
	`‘h”_addr_equ®
(de¡dev->
hw_addr
, 
mac
))

377 
de¡_deviû_mšÜ_numb”
 = 
de¡dev
->
deviû_mšÜ_numb”
;

379 
	`¦si_¥šlock_uÆock
(&
¦si_‹¡_deviûs_lock
);

381 ià(
de¡_deviû_mšÜ_numb”
 == 0xFFFF) {

382 
	`SLSI_ERR
(
uáe¡dev
->
sdev
, "S‘tšg Rou‹ fÜ %pM FAILED. NØm©ch found\n", 
mac
);

385 
	`¥š_lock
(&
uáe¡dev
->
rou‹_¥šlock
);

386 
rou‹
 = 
	`¦si_‹¡_´oûss_sigÇl_g‘_rou‹
(
uáe¡dev
, 
mac
);

387 ià(!
rou‹
)

388 
rou‹
 = 
	`¦si_‹¡_´oûss_sigÇl_g‘_ä“_rou‹
(
uáe¡dev
);

390 ià(
rou‹
) {

391 
	`SLSI_DBG1
(
uáe¡dev
->
sdev
, 
SLSI_TEST
, "S‘tšg Rou‹ fÜ %pM -> %pM\n", uáe¡dev->
hw_addr
, 
mac
);

392 
rou‹
->
cÚfigu»d
 = 
Œue
;

393 
rou‹
->
‹¡_deviû_mšÜ_numb”
 = 
de¡_deviû_mšÜ_numb”
;

394 
	`SLSI_ETHER_COPY
(
rou‹
->
mac
, mac);

395 
rou‹
->
vif
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[5]);

396 
rou‹
->
subÃt
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[6]) & 0xFF;

397 
rou‹
->
£qu’û_numb”
 = 1;

399 
	`SLSI_ERR
(
uáe¡dev
->
sdev
, "S‘tšg Rou‹ fÜ %pM FAILED. NØF»Rou‹ EÁry\n", 
mac
);

402 
	`¥š_uÆock
(&
uáe¡dev
->
rou‹_¥šlock
);

403 
	}
}

405 
	$¦si_‹¡_´oûss_sigÇl_ş—r_rou‹
(
¦si_‹¡_dev
 *
uáe¡dev
, 
sk_buff
 *
skb
)

407 
¦si_‹¡_d©a_rou‹
 *
rou‹
;

408 
u8
 
mac
[
ETH_ALEN
];

410 
mac
[0] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[2]) >> 8;

411 
mac
[1] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[2]) & 0xFF;

412 
mac
[2] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[3]) >> 8;

413 
mac
[3] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[3]) & 0xFF;

414 
mac
[4] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[4]) >> 8;

415 
mac
[5] = 
	`çpi_g‘_buff
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[4]) & 0xFF;

417 
	`¥š_lock
(&
uáe¡dev
->
rou‹_¥šlock
);

418 
	`SLSI_DBG1
(
uáe¡dev
->
sdev
, 
SLSI_TEST
, "CË¬šg Rou‹ fÜ %pM\n", 
mac
);

419 
rou‹
 = 
	`¦si_‹¡_´oûss_sigÇl_g‘_rou‹
(
uáe¡dev
, 
mac
);

420 ià(
rou‹
)

421 
rou‹
->
cÚfigu»d
 = 
çl£
;

423 
	`SLSI_ERR
(
uáe¡dev
->
sdev
, "CË¬šg Rou‹ fÜ %pM FAILED. NØRou‹ EÁry Found\n", 
mac
);

424 
	`¥š_uÆock
(&
uáe¡dev
->
rou‹_¥šlock
);

425 
	}
}

427 
boŞ
 
	$¦si_‹¡_´oûss_sigÇl
(
¦si_‹¡_dev
 *
uáe¡dev
, 
sk_buff
 *
skb
)

429 ià(
	`çpi_g‘_sigid
(
skb
è=ğ
DEBUG_GENERIC_REQ
) {

430 
	`SLSI_DBG1
(
uáe¡dev
->
sdev
, 
SLSI_TEST
, "çpi_g‘_u16(skb, u.debug_g’”ic_»q.debug_wÜds[0]èğ%d\n", 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[0]));

431 
	`SLSI_DBG1
(
uáe¡dev
->
sdev
, 
SLSI_TEST
, "çpi_g‘_u16(skb, u.debug_g’”ic_»q.debug_wÜds[1]èğ%d\n", 
	`çpi_g‘_u16
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[1]));

432 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[0]) == 0x1357) {

433 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[1]) == 0)

434 
	`queue_wÜk
(
uáe¡dev
->
©ch_d‘ach_wÜk_queue
, &uáe¡dev->
d‘ach_wÜk
);

435 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[1]) == 1)

436 
	`queue_wÜk
(
uáe¡dev
->
©ch_d‘ach_wÜk_queue
, &uáe¡dev->
©ch_wÜk
);

437 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[1]) == 2)

438 
	`¦si_‹¡_´oûss_sigÇl_£t_rou‹
(
uáe¡dev
, 
skb
);

439 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
debug_g’”ic_»q
.
debug_wÜds
[1]) == 3)

440 
	`¦si_‹¡_´oûss_sigÇl_ş—r_rou‹
(
uáe¡dev
, 
skb
);

442 
	`kä“_skb
(
skb
);

443  
Œue
;

447 ià(
	`çpi_g‘_sigid
(
skb
è=ğ
MA_UNITDATA_REQ
) {

448 
¦si_‹¡_d©a_rou‹
 *
rou‹
;

449 
‘hhdr
 *
ehdr
 = (‘hhd¸*)
skb
->
d©a
;

451 
	`¥š_lock
(&
uáe¡dev
->
rou‹_¥šlock
);

452 
rou‹
 = 
	`¦si_‹¡_´oûss_sigÇl_g‘_rou‹
(
uáe¡dev
, 
ehdr
->
h_de¡
);

453 ià(
rou‹
 && 
	`¦si_‹¡_´oûss_sigÇl__»m­
(
uáe¡dev
, 
skb
,„oute)) {

454 
¦si_skb_cb
 *
cb
;

455 
çpi_sigÇl
 
»q
 = *((çpi_sigÇÈ*)
skb
->
d©a
);

456 
çpi_sigÇl
 *
šd
;

459 
	`WARN_ON
(!
	`skb_puÎ
(
skb
, 
	`çpi_sig_size
(
ma_un™d©a_»q
)));

460 
šd
 = (
çpi_sigÇl
 *)
	`skb_push
(
skb
, 
	`çpi_sig_size
(
ma_un™d©a_šd
));

461 ià(
	`WARN_ON
(!
šd
)) {

462 
	`kä“_skb
(
skb
);

463 
	`¥š_uÆock
(&
uáe¡dev
->
rou‹_¥šlock
);

464  
Œue
;

467 
šd
->
id
 = 
	`ıu_to_Ë16
(
MA_UNITDATA_IND
);

468 
šd
->
»ûiv”_pid
 = 0;

469 
šd
->
£nd”_pid
 = 0;

470 
	`çpi_£t_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
vif
, 
	`ıu_to_Ë16
(
rou‹
->vif));

471 
	`çpi_£t_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
£qu’û_numb”
, 
rou‹
->sequence_number++);

473 
cb
 = 
	`¦si_skb_cb_š™
(
skb
);

474 
cb
->
sig_Ëngth
 = 
	`çpi_g‘_ex³ùed_size
(
skb
);

475 
cb
->
d©a_Ëngth
 = 
skb
->
Ën
;

477 
	`¦si_¥šlock_lock
(&
¦si_‹¡_deviûs_lock
);

478 ià(
¦si_‹¡_deviûs
[
rou‹
->
‹¡_deviû_mšÜ_numb”
] &&

479 
¦si_‹¡_deviûs
[
rou‹
->
‹¡_deviû_mšÜ_numb”
]->
sdev
) {

480 ià(
	`¦si_h_rx
(
¦si_‹¡_deviûs
[
rou‹
->
‹¡_deviû_mšÜ_numb”
]->
sdev
, 
skb
) != 0)

481 
	`kä“_skb
(
skb
);

483 
rou‹
->
cÚfigu»d
 = 
çl£
;

484 
	`kä“_skb
(
skb
);

486 
	`¦si_¥šlock_uÆock
(&
¦si_‹¡_deviûs_lock
);

487 
	`¥š_uÆock
(&
uáe¡dev
->
rou‹_¥šlock
);

488  
Œue
;

490 
	`¥š_uÆock
(&
uáe¡dev
->
rou‹_¥šlock
);

493  
çl£
;

494 
	}
}

496 
	$¦si_‹¡_dev_©ch_wÜk
(
wÜk_¡ruù
 *
wÜk
)

498 
¦si_‹¡_dev
 *
uáe¡dev
 = 
	`cÚš”_of
(
wÜk
, ¦si_‹¡_dev, 
©ch_wÜk
);

500 
	`SLSI_INFO_NODEV
("UnitTest TEST Attach\n");

501 
	`¦si_‹¡_dev_©ch
(
uáe¡dev
);

502 
	`¦si_‹¡_udi_node_»»gi¡”
(
uáe¡dev
);

503 
	}
}

505 
	$¦si_‹¡_dev_d‘ach_wÜk
(
wÜk_¡ruù
 *
wÜk
)

507 
¦si_‹¡_dev
 *
uáe¡dev
 = 
	`cÚš”_of
(
wÜk
, ¦si_‹¡_dev, 
d‘ach_wÜk
);

509 
	`SLSI_INFO
(
uáe¡dev
->
sdev
, "UnitTest TEST Detach\n");

510 
	`¦si_‹¡_dev_d‘ach
(
uáe¡dev
);

511 
	}
}

513 
	$scsc_wifi_uÅau£_¬p_q_®l_vif
(
¦si_dev
 *
sdev
)

515 
	}
}

517 
	$scsc_wifi_·u£_¬p_q_®l_vif
(
¦si_dev
 *
sdev
)

519 
	}
}

521 
	$mx140_»que¡_fe
(
scsc_mx
 *
mx
, *
·th
, cÚ¡ 
fœmw¬e
 **
fœmp
)

523  -
EINVAL
;

524 
	}
}

526 
	$mx140_»Ëa£_fe
(
scsc_mx
 *
mx
, cÚ¡ 
fœmw¬e
 *
fœmp
)

528  -
EINVAL
;

529 
	}
}

	@test/hip_test.c

7 
	~<lšux/kth»ad.h
>

9 
	~"un™‹¡.h
"

10 
	~"h.h
"

11 
	~"§p.h
"

12 
	~"debug.h
"

13 
	~"´ocfs.h
"

14 
	~"h4.h
"

16 
	#SLSI_TEST_DEV_SDIO_BLOCK_SIZE
 500

	)

17 
boŞ
 
	gh4_§m¶”_§m¶e_¡¬t_¡İ_q
 = 
Œue
;

18 
h4_h_cÚŒŞ
 
	g‹¡_h_cÚŒŞ
;

21 
	sh_§p
 {

22 
§p_­i
 *
	m§p
[
SAP_TOTAL
];

23 } 
	gh_§p_cÚt
;

26 
	$¦si_h_§p_»gi¡”
(
§p_­i
 *sap_api)

28 
u8
 
şass
 = 
§p_­i
->
§p_şass
;

30 ià(
şass
 >ğ
SAP_TOTAL
)

31  -
ENODEV
;

33 
h_§p_cÚt
.
§p
[
şass
] = 
§p_­i
;

36 
	}
}

39 
	$¦si_h_§p_uÄegi¡”
(
§p_­i
 *sap_api)

41 
u8
 
şass
 = 
§p_­i
->
§p_şass
;

43 ià(
şass
 >ğ
SAP_TOTAL
)

44  -
ENODEV
;

46 
h_§p_cÚt
.
§p
[
şass
] = 
NULL
;

49 
	}
}

51 
	$¦si_h_§p_£tup
(
¦si_dev
 *
sdev
)

54 
u16
 
v”siÚ
 = 0;

56 ià(
h_§p_cÚt
.
§p
[
SAP_MLME
]->
§p_v”siÚ_suµÜ‹d
) {

57 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_mlme_v”
);

58 ià(
h_§p_cÚt
.
§p
[
SAP_MLME
]->
	`§p_v”siÚ_suµÜ‹d
(
v”siÚ
))

59  -
ENODEV
;

61  -
ENODEV
;

64 ià(
h_§p_cÚt
.
§p
[
SAP_MA
]->
§p_v”siÚ_suµÜ‹d
) {

65 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_ma_v”
);

66 ià(
h_§p_cÚt
.
§p
[
SAP_MA
]->
	`§p_v”siÚ_suµÜ‹d
(
v”siÚ
))

67  -
ENODEV
;

69  -
ENODEV
;

72 ià(
h_§p_cÚt
.
§p
[
SAP_DBG
]->
§p_v”siÚ_suµÜ‹d
) {

73 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_debug_v”
);

74 ià(
h_§p_cÚt
.
§p
[
SAP_DBG
]->
	`§p_v”siÚ_suµÜ‹d
(
v”siÚ
))

75  -
ENODEV
;

77  -
ENODEV
;

80 ià(
h_§p_cÚt
.
§p
[
SAP_TST
]->
§p_v”siÚ_suµÜ‹d
) {

81 
v”siÚ
 = 
	`scsc_wifi_g‘_h_cÚfig_v”siÚ_4_u16
(&
sdev
->
h4_š¡
.
h_cÚŒŞ
->
cÚfig_v4
, 
§p_‹¡_v”
);

82 ià(
h_§p_cÚt
.
§p
[
SAP_TST
]->
	`§p_v”siÚ_suµÜ‹d
(
v”siÚ
))

83  -
ENODEV
;

85  -
ENODEV
;

90 
	}
}

93 
	$¦si_h_rx
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

95 
u16
 
pid
;

98 
	`¦si_log_ş›Ás_log_sigÇl_ç¡
(
sdev
, &sdev->
log_ş›Ás
, 
skb
, 
SLSI_LOG_DIRECTION_TO_HOST
);

99 
pid
 = 
	`çpi_g‘_u16
(
skb
, 
»ûiv”_pid
);

100 ià(
pid
 >ğ
SLSI_TX_PROCESS_ID_UDI_MIN
 &&…id <ğ
SLSI_TX_PROCESS_ID_UDI_MAX
) {

101 
	`kä“_skb
(
skb
);

105 ià(
	`çpi_is_ma
(
skb
))

106  
h_§p_cÚt
.
§p
[
SAP_MA
]->
	`§p_hªdËr
(
sdev
, 
skb
);

108 ià(
	`çpi_is_mlme
(
skb
))

109  
h_§p_cÚt
.
§p
[
SAP_MLME
]->
	`§p_hªdËr
(
sdev
, 
skb
);

111 ià(
	`çpi_is_debug
(
skb
))

112  
h_§p_cÚt
.
§p
[
SAP_DBG
]->
	`§p_hªdËr
(
sdev
, 
skb
);

114 ià(
	`çpi_is_‹¡
(
skb
))

115  
h_§p_cÚt
.
§p
[
SAP_TST
]->
	`§p_hªdËr
(
sdev
, 
skb
);

117  -
EIO
;

118 
	}
}

121 
	$¦si_h_š™
(
¦si_dev
 *
sdev
, 
deviû
 *
dev
)

123 
	`SLSI_UNUSED_PARAMETER
(
dev
);

125 
	`mem£t
(&
sdev
->
h
, 0, (sdev->hip));

127 
sdev
->
h
.sdev = sdev;

128 
	`mu‹x_š™
(&
sdev
->
h
.
h_mu‹x
);

130 
sdev
->
h4_š¡
.
h_cÚŒŞ
 = &
‹¡_h_cÚŒŞ
;

132 
	}
}

134 
	$¦si_h_deš™
(
¦si_dev
 *
sdev
)

136 
	`mu‹x_de¡roy
(&
sdev
->
h
.
h_mu‹x
);

137 
	}
}

139 
	$¦si_h_¡İ
(
¦si_dev
 *
sdev
)

142 
	}
}

144 
	$h4_ä“_ù¾_¦Ùs_couÁ
(
¦si_h4
 *
h
)

146  
HIP4_CTL_SLOTS
;

147 
	}
}

149 
	$scsc_wifi_Œªsm™_äame
(
¦si_h4
 *
h
, 
sk_buff
 *
skb
, 
boŞ
 
ù¾_·ck‘
, 
u8
 
vif_šdex
, u8 
³”_šdex
, u8 
´iÜ™y
)

151 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
h
, ¦si_dev, 
h4_š¡
);

153 
	`¦si_log_ş›Ás_log_sigÇl_ç¡
(
sdev
, &sdev->
log_ş›Ás
, 
skb
, 
SLSI_LOG_DIRECTION_FROM_HOST
);

155 
	`cÚsume_skb
(
skb
);

158 
	}
}

160 
	$¦si_‹¡_bh_wÜk_f
(
wÜk_¡ruù
 *
wÜk
)

162 
	}
}

165 
boŞ
 
	gh4_§m¶”_§m¶e_q
;

166 
boŞ
 
	gh4_§m¶”_§m¶e_q»f
;

167 
boŞ
 
	gh4_§m¶”_§m¶e_št
;

168 
boŞ
 
	gh4_§m¶”_§m¶e_çpi
;

169 
boŞ
 
	gh4_§m¶”_§m¶e_through
;

170 
boŞ
 
	gh4_§m¶”_§m¶e_¡¬t_¡İ_q
;

171 
boŞ
 
	gh4_§m¶”_§m¶e_mbulk
;

172 
boŞ
 
	gh4_§m¶”_§m¶e_qfuÎ
;

173 
boŞ
 
	gh4_§m¶”_§m¶e_mfuÎ
;

174 
boŞ
 
	gh4_§m¶”_vif
;

175 
boŞ
 
	gh4_§m¶”_bÙ
;

176 
boŞ
 
	gh4_§m¶”_pkt_tx
;

178 
	$h4_§m¶”_upd©e_»cÜd
(
u32
 
mšÜ
, 
u8
 
·¿m1
, u8 
·¿m2
, u8 
·¿m3
, u8 
·¿m4
)

180 
	}
}

182 
	$h4_§m¶”_ü—‹
(
¦si_dev
 *
sdev
, 
scsc_mx
 *
mx
)

184 
	}
}

186 
	$h4_§m¶”_de¡roy
(
¦si_dev
 *
sdev
, 
scsc_mx
 *
mx
)

188 
	}
}

190 
	$h4_§m¶”_»gi¡”_h
(
scsc_mx
 *
mx
)

193 
	}
}

195 
	$scsc_wifi_fcq_ù¾_q_š™
(
scsc_wifi_fcq_ù¾_q
 *
queue
)

198 
	}
}

200 
	$scsc_wifi_fcq_ù¾_q_deš™
(
scsc_wifi_fcq_ù¾_q
 *
queue
)

202 
	}
}

204 
	$scsc_wifi_fcq_uniÿ¡_q£t_š™
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u8
 
qs_num
, 
¦si_dev
 *
sdev
, u8 
vif
, 
¦si_³”
 *
³”
)

207 
	}
}

209 
	$scsc_wifi_fcq_muÉiÿ¡_q£t_š™
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
¦si_dev
 *
sdev
, 
u8
 
vif
)

212 
	}
}

214 
	$scsc_wifi_fcq_q£t_deš™
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, 
¦si_³”
 *
³”
)

216 
	}
}

218 
	$scsc_wifi_fcq_Œªsm™_d©a
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u16
 
´iÜ™y
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
)

221 
	}
}

223 
	$scsc_wifi_fcq_»ûive_d©a
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
u16
 
´iÜ™y
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
)

226 
	}
}

228 
	$scsc_wifi_fcq_»ûive_d©a_no_³”
(
Ãt_deviû
 *
dev
, 
u16
 
´iÜ™y
, 
¦si_dev
 *
sdev
, 
u8
 
vif
, u8 
³”_šdex
)

231 
	}
}

233 
	$scsc_wifi_fcq_·u£_queues
(
¦si_dev
 *
sdev
)

235 
	}
}

237 
	$scsc_wifi_fcq_uÅau£_queues
(
¦si_dev
 *
sdev
)

239 
	}
}

241 
	$scsc_wifi_fcq_Œªsm™_ù¾
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_ù¾_q
 *
queue
)

244 
	}
}

246 
	$scsc_wifi_fcq_»ûive_ù¾
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_ù¾_q
 *
queue
)

249 
	}
}

251 
	$scsc_wifi_fcq_upd©e_smod
(
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
scsc_wifi_fcq_ps_¡©e
 
³”_ps_¡©e
,

252 
scsc_wifi_fcq_queue_£t_ty³
 
ty³
)

255 
	}
}

257 
	$scsc_wifi_fcq_8021x_pÜt_¡©e
(
Ãt_deviû
 *
dev
, 
scsc_wifi_fcq_d©a_q£t
 *
qs
, 
scsc_wifi_fcq_8021x_¡©e
 
¡©e
)

260 
	}
}

262 
	$scsc_wifi_fcq_¡©_queue
(
scsc_wifi_fcq_q_h—d”
 *
queue
,

263 
scsc_wifi_fcq_q_¡©
 *
queue_¡©
,

264 *
qmod
, *
qcod
)

267 
	}
}

269 
	$scsc_wifi_fcq_¡©_queue£t
(
scsc_wifi_fcq_d©a_q£t
 *
queue_£t
,

270 
scsc_wifi_fcq_q_¡©
 *
queue_¡©
,

271 *
smod
, *
scod
, 
scsc_wifi_fcq_8021x_¡©e
 *
ı_¡©e
,

272 
u32
 *
³”_ps_¡©e_Œªs™iÚs
)

275 
	}
}

276 
	$¦si_h_»´oûss_sk³d_d©a_bh
(
¦si_dev
 *
sdev
)

279 
	}
}

	@test/hydra_test.c

7 
	~"dev.h
"

8 
	~"un™‹¡.h
"

9 
	~"debug.h
"

10 
	~"h_bh.h
"

12 
	$¦si_sm_£rviû_driv”_»gi¡”
()

14 
c¤_»suÉ
;

16 
c¤_»suÉ
 = 
	`¦si_sdio_func_drv_»gi¡”
();

17 ià(
c¤_»suÉ
 != 0) {

18 
	`SLSI_ERR_NODEV
("FaedØ»gi¡”h´‘’d SDIO funùiÚ driv”: c¤ResuÉ=%d\n", 
c¤_»suÉ
);

19  -
EIO
;

23 
	}
}

25 
	$¦si_sm_£rviû_driv”_uÄegi¡”
()

27 
	`¦si_sdio_func_drv_uÄegi¡”
();

28 
	}
}

30 
	$¦si_sm_£rviû_çed
(
¦si_dev
 *
sdev
, cÚ¡ *
»asÚ
)

32 
	}
}

34 
boŞ
 
	$¦si_is_‹¡_mode_’abËd
()

36  
çl£
;

37 
	}
}

39 
boŞ
 
	$¦si_is_rf_‹¡_mode_’abËd
()

41  
çl£
;

42 
	}
}

44 
	$¦si_check_rf_‹¡_mode
()

47 
	}
}

49 
	$¦si_sm_wÏn_£rviû_¡¬t
(
¦si_dev
 *
sdev
)

52 
	}
}

54 
	$¦si_sm_wÏn_£rviû_¡İ
(
¦si_dev
 *
sdev
)

57 
	}
}

59 
	$¦si_sm_wÏn_£rviû_İ’
(
¦si_dev
 *
sdev
)

62 
	}
}

64 
	$mx140_fe_»que¡_cÚf
(
scsc_mx
 *
mx
, cÚ¡ 
fœmw¬e
 **
cÚf
, cÚ¡ *
cÚfig_»l_·th
, cÚ¡ *
f’ame
)

67 
	}
}

69 
	$mx140_fe_»Ëa£_cÚf
(
scsc_mx
 *
mx
, cÚ¡ 
fœmw¬e
 *
cÚf
)

71 
	}
}

73 
	$¦si_sm_wÏn_£rviû_şo£
(
¦si_dev
 *
sdev
)

75 
	}
}

76 
	$¦si_sm_»cov”y_£rviû_¡İ
(
¦si_dev
 *
sdev
)

79 
	}
}

80 
	$¦si_sm_»cov”y_£rviû_şo£
(
¦si_dev
 *
sdev
)

83 
	}
}

	@test/udi_test.c

7 
	~<lšux/sysfs.h
>

8 
	~<lšux/pŞl.h
>

9 
	~<lšux/cdev.h
>

11 
	~"dev.h
"

13 
	~"h.h
"

14 
	~"log_ş›Ás.h
"

15 
	~"debug.h
"

16 
	~"un™‹¡.h
"

17 
	~"udi.h
"

19 
	~"unifiio.h
"

21 
	#UDI_CHAR_DEVICE_NAME
 "s5e7570un™‹¡h"

	)

22 
	#UDI_CLASS_NAME
 "s5e7570un™‹¡h"

	)

28 
	#NUM_CHAR_CLIENTS
 1

	)

30 
	#MAX_MINOR
 (
SLSI_UDI_MINOR_NODES
 - 1è

	)

31 
dev_t
 
	gmajÜ_numb”
;

32 
şass
 *
	gşass
;

34 
	g¦si_‹¡_cdev_ş›Á
;

36 
	s¦si_cdev
 {

37 
	mmšÜ
;

38 
cdev
 
	mcdev
;

39 
¦si_‹¡_cdev_ş›Á
 *
	mş›Á
[
NUM_CHAR_CLIENTS
];

41 
¦si_‹¡_dev
 *
	muáe¡dev
;

42 
deviû
 *
	m·»Á
;

45 
	s¦si_‹¡_cdev_ş›Á
 {

46 
¦si_cdev
 *
	mufcdev
;

47 
	mlog_’abËd
;

50 
u16
 
	mma_·ck‘_f‹r_cÚfig
;

52 
sk_buff_h—d
 
	mlog_li¡
;

53 
wa™_queue_h—d_t
 
	mlog_wq
;

60 
¦si_cdev
 *
	guf_cdevs
[
SLSI_UDI_MINOR_NODES
];

62 
udi_log_ev’t
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
);

63 
£nd_sigÇl_to_log_f‹r
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
);

64 
£nd_sigÇl_to_šv”£_log_f‹r
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
);

66 
	$¦si_‹¡_cdev_İ’
(
šode
 *šode, 
fe
 *file)

68 
¦si_cdev
 *
uf_cdev
;

69 
¦si_‹¡_cdev_ş›Á
 *
ş›Á
;

70 
šdx
;

71 
mšÜ
;

73 
mšÜ
 = 
	`imšÜ
(
šode
);

74 ià(
mšÜ
 > 
MAX_MINOR
) {

75 
	`SLSI_ERR_NODEV
("mšÜ %dƒxûed ¿nge\n", 
mšÜ
);

76  -
EINVAL
;

79 
uf_cdev
 = 
uf_cdevs
[
mšÜ
];

80 ià(!
uf_cdev
) {

81 
	`SLSI_ERR_NODEV
("nØcdev in¡ªû fÜ mšÜ %d\n", 
mšÜ
);

82  -
EINVAL
;

85 ià(!
uf_cdev
->
uáe¡dev
) {

86 
	`SLSI_ERR_NODEV
("uftestdev‚ot set\n");

87  -
EINVAL
;

90 
šdx
 = 0; indx < 
NUM_CHAR_CLIENTS
; indx++)

91 ià(
uf_cdev
->
ş›Á
[
šdx
] =ğ
NULL
)

93 ià(
šdx
 >ğ
NUM_CHAR_CLIENTS
) {

94 
	`SLSI_ERR_NODEV
("already opened\n");

95  -
ENOTSUPP
;

98 
ş›Á
 = 
	`km®loc
((*ş›Á), 
GFP_KERNEL
);

99 ià(
ş›Á
 =ğ
NULL
)

100  -
ENOMEM
;

101 
	`mem£t
(
ş›Á
, 0, (
¦si_‹¡_cdev_ş›Á
));

104 
	`skb_queue_h—d_š™
(&
ş›Á
->
log_li¡
);

105 
	`š™_wa™queue_h—d
(&
ş›Á
->
log_wq
);

107 
ş›Á
->
ufcdev
 = 
uf_cdev
;

108 
uf_cdev
->
ş›Á
[
šdx
] = client;

109 
fe
->
´iv©e_d©a
 = 
ş›Á
;

111 
	`¦si_‹¡_dev_©ch
(
ş›Á
->
ufcdev
->
uáe¡dev
);

114 
	}
}

116 
	$¦si_‹¡_cdev_»Ëa£
(
šode
 *šode, 
fe
 *
fp
)

118 
¦si_‹¡_cdev_ş›Á
 *
ş›Á
 = (*)
fp
->
´iv©e_d©a
;

119 
¦si_cdev
 *
uf_cdev
;

120 
šdx
;

121 
mšÜ
;

123 
mšÜ
 = 
	`imšÜ
(
šode
);

124 ià(
mšÜ
 > 
MAX_MINOR
) {

125 
	`SLSI_ERR_NODEV
("mšÜ %dƒxûed ¿nge\n", 
mšÜ
);

126  -
EINVAL
;

129 
uf_cdev
 = 
uf_cdevs
[
mšÜ
];

130 ià(!
uf_cdev
) {

131 
	`SLSI_ERR_NODEV
("nØcdev in¡ªû fÜ mšÜ %d\n", 
mšÜ
);

132  -
EINVAL
;

135 ià(
ş›Á
 =ğ
NULL
)

136  -
EINVAL
;

138 ià(!
ş›Á
->
ufcdev
) {

139 
	`SLSI_ERR_NODEV
("ufcdev‚ot set\n");

140  -
EINVAL
;

143 ià(!
ş›Á
->
ufcdev
->
uáe¡dev
) {

144 
	`SLSI_ERR_NODEV
("uftestdev‚ot set\n");

145  -
EINVAL
;

148 
šdx
 = 0; indx < 
NUM_CHAR_CLIENTS
; indx++)

149 ià(
uf_cdev
->
ş›Á
[
šdx
] == client)

151 ià(
šdx
 >ğ
NUM_CHAR_CLIENTS
) {

152 
	`SLSI_ERR_NODEV
("client‚ot found in†ist\n");

153  -
EINVAL
;

156 ià(
	`wa™queue_aùive
(&
ş›Á
->
log_wq
))

157 
	`wake_up_š‹¼u±ibË
(&
ş›Á
->
log_wq
);

159 ià(
ş›Á
->
log_’abËd
 && cl›Á->
ufcdev
->
uáe¡dev
->
sdev
)

160 
	`¦si_log_ş›Á_uÄegi¡”
(
ş›Á
->
ufcdev
->
uáe¡dev
->
sdev
, client);

162 
	`¦si_‹¡_dev_d‘ach
(
ş›Á
->
ufcdev
->
uáe¡dev
);

164 
	`skb_queue_purge
(&
ş›Á
->
log_li¡
);

167 
	`kä“
(
ş›Á
);

169 
uf_cdev
->
ş›Á
[
šdx
] = 
NULL
;

172 
	}
}

174 
ssize_t
 
	$¦si_‹¡_cdev_»ad
(
fe
 *
fp
, *
p
, 
size_t
 
Ën
, 
loff_t
 *
poff
)

176 
¦si_‹¡_cdev_ş›Á
 *
ş›Á
 = (*)
fp
->
´iv©e_d©a
;

177 
msgËn
;

178 
sk_buff
 *
skb
;

180 
	`SLSI_UNUSED_PARAMETER
(
poff
);

182 ià(
ş›Á
 =ğ
NULL
)

183  -
EINVAL
;

185 ià(!
	`skb_queue_Ën
(&
ş›Á
->
log_li¡
)) {

186 ià(
fp
->
f_æags
 & 
O_NONBLOCK
)

190 ià(
	`wa™_ev’t_š‹¼u±ibË
(
ş›Á
->
log_wq
, 
	`skb_queue_Ën
(&ş›Á->
log_li¡
)))

191  -
ERESTARTSYS
;

194 
skb
 = 
	`skb_dequeue
(&
ş›Á
->
log_li¡
);

196 
msgËn
 = 
skb
->
Ën
;

197 ià(
msgËn
 > (
s32
)
Ën
) {

198 
	`SLSI_WARN_NODEV
("Œunÿ‹d„—dØ%d‡ùu® msg†’ i %lu\n", 
msgËn
, ()
Ën
);

199 
msgËn
 = 
Ën
;

202 
	`SLSI_DBG_HEX_NODEV
(
SLSI_TEST
, 
skb
->
d©a
, skb->
Ën
, "cdev„ead skb:%p skb->data:%p\n", skb, skb->data);

203 ià(
	`cİy_to_u£r
(
p
, 
skb
->
d©a
, 
msgËn
)) {

204 
	`SLSI_ERR_NODEV
("Failedo copy UDI†ogo user\n");

205 
	`kä“_skb
(
skb
);

206  -
EFAULT
;

209 
	`kä“_skb
(
skb
);

210  
msgËn
;

211 
	}
}

213 
ssize_t
 
	$¦si_‹¡_cdev_wr™e
(
fe
 *
fp
, cÚ¡ *
p
, 
size_t
 
Ën
, 
loff_t
 *
poff
)

215 
¦si_‹¡_cdev_ş›Á
 *
ş›Á
;

216 
¦si_‹¡_dev
 *
uáe¡dev
;

217 
sk_buff
 *
skb
;

218 
¦si_skb_cb
 *
cb
;

219 
u8
 *
d©a
;

221 
	`SLSI_UNUSED_PARAMETER
(
poff
);

223 
ş›Á
 = (*)
fp
->
´iv©e_d©a
;

224 ià(
ş›Á
 =ğ
NULL
) {

225 
	`SLSI_ERR_NODEV
("filep…rivate data‚ot set\n");

226  -
EINVAL
;

229 ià(!
ş›Á
->
ufcdev
) {

230 
	`SLSI_ERR_NODEV
("ufcdev‚ot set\n");

231  -
EINVAL
;

234 
uáe¡dev
 = 
ş›Á
->
ufcdev
->uftestdev;

235 ià(!
uáe¡dev
) {

236 
	`SLSI_ERR_NODEV
("uftestdev‚ot set\n");

237  -
EINVAL
;

240 
skb
 = 
	`®loc_skb
(
Ën
, 
GFP_KERNEL
);

241 ià(!
skb
) {

242 
	`SLSI_WARN_NODEV
("”rÜ‡Îoÿtšg skb (Ën: %d)\n", 
Ën
);

243  -
ENOMEM
;

246 
d©a
 = 
	`skb_put
(
skb
, 
Ën
);

247 ià(
	`cİy_äom_u£r
(
d©a
, 
p
, 
Ën
)) {

248 
	`SLSI_ERR_NODEV
("copy from user failed\n");

249 
	`kä“_skb
(
skb
);

250  -
EFAULT
;

253 ià(
skb
->
Ën
 < (
çpi_sigÇl_h—d”
)) {

254 
	`SLSI_ERR_NODEV
("D©a(%dètoØshÜˆfÜ‡ sigÇl\n", 
skb
->
Ën
);

255 
	`kä“_skb
(
skb
);

256  -
EINVAL
;

259 
	`SLSI_DBG_HEX_NODEV
(
SLSI_TEST
, 
skb
->
d©a
, skb->
Ën
, "cdev write skb:%p skb->data:%p\n", skb, skb->data);

262 ià(
	`¦si_‹¡_´oûss_sigÇl
(
uáe¡dev
, 
skb
))

263  
Ën
;

266 
¦si_dev
 *
sdev
;

268 
sdev
 = 
uáe¡dev
->sdev;

269 ià(!
sdev
) {

270 
	`SLSI_ERR_NODEV
("sdev‚ot set\n");

271 
	`kä“_skb
(
skb
);

272  -
EINVAL
;

275 
cb
 = 
	`¦si_skb_cb_š™
(
skb
);

276 
cb
->
sig_Ëngth
 = 
	`çpi_g‘_ex³ùed_size
(
skb
);

277 
cb
->
d©a_Ëngth
 = 
skb
->
Ën
;

279 ià(
	`WARN_ON
(
	`¦si_h_rx
(
sdev
, 
skb
))) {

280 
	`kä“_skb
(
skb
);

281  -
EINVAL
;

284  
Ën
;

285 
	}
}

287 
	$¦si_‹¡_cdev_ioùl
(
fe
 *
fp
, 
cmd
, 
¬g
)

289 
¦si_‹¡_cdev_ş›Á
 *
ş›Á
 = (*)
fp
->
´iv©e_d©a
;

290 
¦si_‹¡_dev
 *
uáe¡dev
;

291 
¦si_dev
 *
sdev
;

292 
r
 = 0;

293 
št_·¿m
;

295 ià(
ş›Á
 =ğ
NULL
 || cl›Á->
ufcdev
 == NULL)

296  -
EINVAL
;

298 
uáe¡dev
 = 
ş›Á
->
ufcdev
->uftestdev;

299 ià(!
uáe¡dev
) {

300 
	`SLSI_ERR_NODEV
("uftestdev‚ot set\n");

301  -
EINVAL
;

304 
sdev
 = 
uáe¡dev
->sdev;

305 ià(!
sdev
) {

306 
	`SLSI_ERR_NODEV
("sdev‚ot set\n");

307  -
EINVAL
;

310 
	`FUNC_ENTER_NODEV
();

312 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

314 
cmd
) {

315 
UNIFI_GET_UDI_ENABLE
:

316 
št_·¿m
 = 
ş›Á
->
log_’abËd
;

317 
	`put_u£r
(
št_·¿m
, (*)
¬g
);

320 
UNIFI_SET_UDI_ENABLE
:

321 ià(
	`g‘_u£r
(
št_·¿m
, (*)
¬g
)) {

322 
r
 = -
EFAULT
;

326 ià(
št_·¿m
) {

327 
	`¦si_log_ş›Á_»gi¡”
(
sdev
, 
ş›Á
, 
udi_log_ev’t
, 
NULL
, 0, 0);

328 
ş›Á
->
log_’abËd
 = 1;

330 
	`¦si_log_ş›Á_uÄegi¡”
(
sdev
, 
ş›Á
);

331 
ş›Á
->
log_’abËd
 = 0;

335 
UNIFI_SET_UDI_LOG_MASK
:

337 
unifiio_f‹r_t
 
f‹r
;

338 
i
;

341 ià(
	`cİy_äom_u£r
(&
f‹r
, (*)
¬g
, (filter))) {

342 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_UDI_LOG_MASK: Failedo copy from userspace\n");

343 
r
 = -
EFAULT
;

346 ià(
f‹r
.
sigÇl_ids_n
) {

347 *
sigÇl_f‹r_šdex
;

348 
max
;

349 
mš
;

350 
size
 = 
f‹r
.
sigÇl_ids_n
 * (f‹r.
sigÇl_ids
[0]);

351 
u16
 *
sigÇl_ids
 = 
	`km®loc
(
size
, 
GFP_KERNEL
);

353 ià(!
sigÇl_ids
) {

354 
r
 = -
ENOMEM
;

358 
max
 = 
sigÇl_ids
[0];

359 
mš
 = 
sigÇl_ids
[0];

361 ià(
	`cİy_äom_u£r
(
sigÇl_ids
, 
f‹r
.sigÇl_ids, 
size
)) {

362 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_UDI_LOG_MASK: Failedo copy filter from userspace\n");

363 
	`kä“
(
sigÇl_ids
);

364 
r
 = -
EFAULT
;

368 
i
 = 0; i < 
f‹r
.
sigÇl_ids_n
; i++) {

369 ià(
sigÇl_ids
[
i
] & 
UDI_MA_UNITDATA_FILTER_ALLOW_MASK
) {

370 
ş›Á
->
ma_·ck‘_f‹r_cÚfig
 |ğ
sigÇl_ids
[
i
];

373 ià(
sigÇl_ids
[
i
] > 
max
)

374 
max
 = 
sigÇl_ids
[
i
];

375 ià(
sigÇl_ids
[
i
] < 
mš
)

376 
mš
 = 
sigÇl_ids
[
i
];

379 
sigÇl_f‹r_šdex
 = 
	`km®loc
(
max
 - 
mš
 + 1, 
GFP_KERNEL
);

380 ià(
sigÇl_f‹r_šdex
) {

381 
	`mem£t
(
sigÇl_f‹r_šdex
, 0, 
max
 - 
mš
 + 1);

382 
i
 = 0; i < 
f‹r
.
sigÇl_ids_n
; i++) {

383 ià(
sigÇl_ids
[
i
] & 
UDI_MA_UNITDATA_FILTER_ALLOW_MASK
)

385 
sigÇl_f‹r_šdex
[
sigÇl_ids
[
i
] - 
mš
] = 1;

387 
	`¦si_log_ş›Á_uÄegi¡”
(
sdev
, 
ş›Á
);

388 
	`¦si_log_ş›Á_»gi¡”
(
sdev
, 
ş›Á
,

389 
f‹r
.
log_li¡ed_æag
 ? 
£nd_sigÇl_to_šv”£_log_f‹r
 :

390 
£nd_sigÇl_to_log_f‹r
, 
sigÇl_f‹r_šdex
, 
mš
, 
max
);

392 
r
 = -
ENOMEM
;

394 
	`kä“
(
sigÇl_ids
);

399 
	`SLSI_WARN
(
sdev
, "O³¿tiÚ (%dènÙ suµÜ‹d\n", 
cmd
);

400 
r
 = -
EINVAL
;

403 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

404  
r
;

405 
	}
}

407 
	$¦si_‹¡_cdev_pŞl
(
fe
 *
fp
, 
pŞl_bË
 *
wa™
)

409 
¦si_‹¡_cdev_ş›Á
 *
ş›Á
 = (*)
fp
->
´iv©e_d©a
;

410 
mask
 = 0;

411 
»ady
;

413 
»ady
 = 
	`skb_queue_Ën
(&
ş›Á
->
log_li¡
);

414 
	`pŞl_wa™
(
fp
, &
ş›Á
->
log_wq
, 
wa™
);

415 ià(
»ady
)

416 
mask
 |ğ
POLLIN
 | 
POLLRDNORM
;

418  
mask
;

419 
	}
}

425 
	$£nd_sigÇl_to_log_f‹r
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
)

427 
»t
 = 0;

428 
u16
 
sigÇl_id
 = 
	`çpi_g‘_u16
(
skb
, 
id
);

430 ià(
sigÇl_id
 > 
log_ş›Á
->
max_sigÇl_id
 || sigÇl_id <†og_ş›Á->
mš_sigÇl_id
 || !log_ş›Á->
sigÇl_f‹r
[signal_id -†og_client->min_signal_id])

431 
»t
 = 
	`udi_log_ev’t
(
log_ş›Á
, 
skb
, 
dœ
);

433  
»t
;

434 
	}
}

436 
	$£nd_sigÇl_to_šv”£_log_f‹r
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
)

438 
»t
 = 0;

439 
u16
 
sigÇl_id
 = 
	`çpi_g‘_u16
(
skb
, 
id
);

441 ià(
sigÇl_id
 <ğ
log_ş›Á
->
max_sigÇl_id
 && sigÇl_id >ğlog_ş›Á->
mš_sigÇl_id
 &&†og_ş›Á->
sigÇl_f‹r
[signal_id -†og_client->min_signal_id])

442 
»t
 = 
	`udi_log_ev’t
(
log_ş›Á
, 
skb
, 
dœ
);

443  
»t
;

444 
	}
}

446 
	$udi_log_ev’t
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
)

448 
¦si_‹¡_cdev_ş›Á
 *
ş›Á
 = 
log_ş›Á
->
log_ş›Á_ùx
;

449 
udi_msg_t
 
msg
;

450 
udi_msg_t
 *
msg_skb
;

452 ià(
	`WARN_ON
(
ş›Á
 =ğ
NULL
))

453  -
EINVAL
;

454 ià(
	`WARN_ON
(
skb
 =ğ
NULL
))

455  -
EINVAL
;

456 ià(
	`WARN_ON
(
skb
->
Ën
 == 0))

457  -
EINVAL
;

459 
skb
 = 
	`skb_cİy_ex·nd
(skb, (
msg
), 0, 
GFP_ATOMIC
);

460 ià(
	`WARN_ON
(!
skb
))

461  -
ENOMEM
;

464 ià(
	`¦si_‹¡_´oûss_sigÇl
(
ş›Á
->
ufcdev
->
uáe¡dev
, 
skb
))

465  -
ECANCELED
;

467 ià(
	`WARN_ON
(
	`skb_h—droom
(
skb
è< (
msg
)))

468  -
ENOMEM
;

470 
msg
.
Ëngth
 = (msgè+ 
skb
->
Ën
;

471 
msg
.
time¡amp
 = 
	`jiff›s_to_m£cs
(
jiff›s
);

472 
msg
.
dœeùiÚ
 = 
dœ
;

473 
msg
.
sigÇl_Ëngth
 = 
	`çpi_g‘_sigËn
(
skb
);

475 
msg_skb
 = (
udi_msg_t
 *)
	`skb_push
(
skb
, (
msg
));

476 *
msg_skb
 = 
msg
;

478 
	`skb_queue_
(&
ş›Á
->
log_li¡
, 
skb
);

481 
	`wake_up_š‹¼u±ibË
(&
ş›Á
->
log_wq
);

484 
	}
}

486 
	#UF_DEVICE_CREATE
(
_şass
, 
_·»Á
, 
_devno
, 
_´iv
, 
_fmt
, 
_¬gs
) \

487 
	`deviû_ü—‹
(
_şass
, 
_·»Á
, 
_devno
, 
_´iv
, 
_fmt
, 
_¬gs
)

	)

489 cÚ¡ 
fe_İ”©iÚs
 
	g¦si_‹¡_cdev_fİs
 = {

490 .
owÃr
 = 
THIS_MODULE
,

491 .
	gİ’
 = 
¦si_‹¡_cdev_İ’
,

492 .
	g»Ëa£
 = 
¦si_‹¡_cdev_»Ëa£
,

493 .
	g»ad
 = 
¦si_‹¡_cdev_»ad
,

494 .
	gwr™e
 = 
¦si_‹¡_cdev_wr™e
,

495 .
	guÆocked_ioùl
 = 
¦si_‹¡_cdev_ioùl
,

496 .
	gcom·t_ioùl
 = 
¦si_‹¡_cdev_ioùl
,

497 .
	gpŞl
 = 
¦si_‹¡_cdev_pŞl
,

500 
	#UF_DEVICE_CREATE
(
_şass
, 
_·»Á
, 
_devno
, 
_´iv
, 
_fmt
, 
_¬gs
) \

501 
	`deviû_ü—‹
(
_şass
, 
_·»Á
, 
_devno
, 
_´iv
, 
_fmt
, 
_¬gs
)

	)

503 
	$¦si_g‘_mšÜ
()

505 
mšÜ
;

507 
mšÜ
 = 0; mšÜ < 
SLSI_UDI_MINOR_NODES
; minor++)

508 ià(
uf_cdevs
[
mšÜ
] == 0)

509  
mšÜ
;

511 
	}
}

513 
	$¦si_‹¡_cdev_ü—‹
(
¦si_‹¡_dev
 *
uáe¡dev
, 
deviû
 *
·»Á
)

515 
dev_t
 
devno
;

516 
»t
;

517 
¦si_cdev
 *
pdev
;

518 
mšÜ
;

520 
	`FUNC_ENTER_NODEV
();

521 
mšÜ
 = 
	`¦si_g‘_mšÜ
();

522 ià(
mšÜ
 < 0) {

523 
	`SLSI_ERR_NODEV
("no minor‚umbers‡vailable\n");

524  -
ENOMEM
;

527 
pdev
 = 
	`km®loc
((*pdev), 
GFP_KERNEL
);

528 ià(
pdev
 =ğ
NULL
)

529  -
ENOMEM
;

530 
	`mem£t
(
pdev
, 0, (*pdev));

532 
	`cdev_š™
(&
pdev
->
cdev
, &
¦si_‹¡_cdev_fİs
);

533 
pdev
->
cdev
.
owÃr
 = 
THIS_MODULE
;

534 
pdev
->
mšÜ
 = minor;

535 
devno
 = 
	`MKDEV
(
	`MAJOR
(
majÜ_numb”
), 
mšÜ
);

536 
»t
 = 
	`cdev_add
(&
pdev
->
cdev
, 
devno
, 1);

537 ià(
»t
) {

538 
	`SLSI_ERR_NODEV
("cdev_add faed w™h %d fÜ mšÜ %d\n", 
»t
, 
mšÜ
);

539 
	`kä“
(
pdev
);

540  
»t
;

543 
pdev
->
uáe¡dev
 = uftestdev;

544 
pdev
->
·»Á
 =…arent;

545 ià(!
	`UF_DEVICE_CREATE
(
şass
, 
pdev
->
·»Á
, 
devno
,…dev, 
UDI_CHAR_DEVICE_NAME
 "%d", 
mšÜ
)) {

546 
	`cdev_d–
(&
pdev
->
cdev
);

547 
	`kä“
(
pdev
);

548  -
EINVAL
;

550 
uáe¡dev
->
uf_cdev
 = (*)
pdev
;

551 
uáe¡dev
->
deviû_mšÜ_numb”
 = 
mšÜ
;

552 
uf_cdevs
[
mšÜ
] = 
pdev
;

554 
	}
}

556 
	$¦si_‹¡_cdev_de¡roy
(
¦si_‹¡_dev
 *
uáe¡dev
)

558 
¦si_cdev
 *
pdev
 = (¦si_cdev *)
uáe¡dev
->
uf_cdev
;

560 
	`FUNC_ENTER_NODEV
();

561 ià(!
pdev
)

563 
	`deviû_de¡roy
(
şass
, 
pdev
->
cdev
.
dev
);

564 
	`cdev_d–
(&
pdev
->
cdev
);

565 
uáe¡dev
->
uf_cdev
 = 0;

566 
uf_cdevs
[
pdev
->
mšÜ
] = 0;

567 
	`kä“
(
pdev
);

568 
	}
}

570 
	gudi_š™Ÿli£d
;

572 
	$¦si_‹¡_udi_š™
()

574 
»t
;

576 
	`mem£t
(
uf_cdevs
, 0, (uf_cdevs));

579 
»t
 = 
	`®loc_chrdev_»giÚ
(&
majÜ_numb”
, 0, 
SLSI_UDI_MINOR_NODES
, 
UDI_CLASS_NAME
);

580 ià(
»t
) {

581 
	`SLSI_ERR_NODEV
("FaedØadd‡Îoødev‚umb”s: %d\n", 
»t
);

582  
»t
;

586 
şass
 = 
	`şass_ü—‹
(
THIS_MODULE
, 
UDI_CLASS_NAME
);

587 ià(
	`IS_ERR
(
şass
)) {

588 
	`SLSI_ERR_NODEV
("Failedo create UniFi class\n");

589 
	`uÄegi¡”_chrdev_»giÚ
(
majÜ_numb”
, 
SLSI_UDI_MINOR_NODES
);

590 
majÜ_numb”
 = 0;

591  -
EINVAL
;

594 
udi_š™Ÿli£d
 = 1;

597 
	}
}

599 
	$¦si_‹¡_udi_deš™
()

601 ià(!
udi_š™Ÿli£d
)

603 
	`şass_de¡roy
(
şass
);

604 
	`uÄegi¡”_chrdev_»giÚ
(
majÜ_numb”
, 
SLSI_UDI_MINOR_NODES
);

605 
udi_š™Ÿli£d
 = 0;

607 
	}
}

609 
	$¦si_‹¡_udi_node_š™
(
¦si_‹¡_dev
 *
uáe¡dev
, 
deviû
 *
·»Á
)

611 
	`FUNC_ENTER_NODEV
();

612 ià(!
udi_š™Ÿli£d
)

614  
	`¦si_‹¡_cdev_ü—‹
(
uáe¡dev
, 
·»Á
);

615 
	}
}

617 
	$¦si_‹¡_udi_node_»»gi¡”
(
¦si_‹¡_dev
 *
uáe¡dev
)

619 
¦si_cdev
 *
pdev
 = 
uáe¡dev
->
uf_cdev
;

620 
šdx
;

622 ià(
uáe¡dev
->
sdev
)

623 
šdx
 = 0; indx < 
NUM_CHAR_CLIENTS
; indx++)

624 ià(
pdev
->
ş›Á
[
šdx
] !ğ
NULL
 &&…dev->ş›Á[šdx]->
log_’abËd
)

625 
	`¦si_log_ş›Á_»gi¡”
(
uáe¡dev
->
sdev
, 
pdev
->
ş›Á
[
šdx
], 
udi_log_ev’t
, 
NULL
, 0, 0);

628 
	}
}

630 
	$¦si_‹¡_udi_node_deš™
(
¦si_‹¡_dev
 *
uáe¡dev
)

632 
	`FUNC_ENTER_NODEV
();

633 ià(!
udi_š™Ÿli£d
)

635 
	`¦si_‹¡_cdev_de¡roy
(
uáe¡dev
);

637 
	}
}

	@test/unittest.h

7 #iâdeà
__SLSI_UNITTEST_H__


8 
	#__SLSI_UNITTEST_H__


	)

10 
	~"dev.h
"

12 
	g¦si_‹¡_dev
;

13 
	s¦si_‹¡_bh_wÜk
 {

14 
boŞ
 
	mavaabË
;

15 
¦si_‹¡_dev
 *
	muáe¡dev
;

16 
wÜkqueue_¡ruù
 *
	mwÜkqueue
;

17 
wÜk_¡ruù
 
	mwÜk
;

18 
¦si_¥šlock
 
	m¥šlock
;

21 
	s¦si_‹¡_d©a_rou‹
 {

22 
boŞ
 
	mcÚfigu»d
;

23 
u16
 
	m‹¡_deviû_mšÜ_numb”
;

24 
u8
 
	mmac
[
ETH_ALEN
];

25 
u16
 
	mvif
;

26 
u8
 
	msubÃt
;

27 
u16
 
	m£qu’û_numb”
;

30 
	s¦si_‹¡_dev
 {

36 
	mdeviû_mšÜ_numb”
;

38 *
	muf_cdev
;

39 
deviû
 *
	mdev
;

40 
¦si_dev
 *
	msdev
;

42 
wÜkqueue_¡ruù
 *
	m©ch_d‘ach_wÜk_queue
;

44 
mu‹x
 
	m©ch_d‘ach_mu‹x
;

45 
wÜk_¡ruù
 
	m©ch_wÜk
;

46 
wÜk_¡ruù
 
	md‘ach_wÜk
;

47 
boŞ
 
	m©ched
;

49 
u8
 
	mhw_addr
[
ETH_ALEN
];

50 
¦si_‹¡_bh_wÜk
 
	mbh_wÜk
;

53 
¥šlock_t
 
	mrou‹_¥šlock
;

54 
¦si_‹¡_d©a_rou‹
 
	mrou‹
[
SLSI_AP_PEER_CONNECTIONS_MAX
];

57 
¦si_‹¡_dev_©ch
(
¦si_‹¡_dev
 *
uáe¡dev
);

58 
¦si_‹¡_dev_d‘ach
(
¦si_‹¡_dev
 *
uáe¡dev
);

59 
boŞ
 
¦si_‹¡_´oûss_sigÇl
(
¦si_‹¡_dev
 *
uáe¡dev
, 
sk_buff
 *
skb
);

61 
¦si_‹¡_udi_node_š™
(
¦si_‹¡_dev
 *
uáe¡dev
, 
deviû
 *
·»Á
);

62 
¦si_‹¡_udi_node_»»gi¡”
(
¦si_‹¡_dev
 *
uáe¡dev
);

63 
¦si_‹¡_udi_node_deš™
(
¦si_‹¡_dev
 *
uáe¡dev
);

65 
¦si_‹¡_udi_š™
();

66 
¦si_‹¡_udi_deš™
();

68 
¦si_‹¡_bh_wÜk_f
(
wÜk_¡ruù
 *
wÜk
);

69 
šlše
 
	$¦si_‹¡_bh_š™
(
¦si_‹¡_dev
 *
uáe¡dev
)

71 
uáe¡dev
->
bh_wÜk
.
avaabË
 = 
çl£
;

72 
uáe¡dev
->
bh_wÜk
.uftestdev = uftestdev;

73 
	`¦si_¥šlock_ü—‹
(&
uáe¡dev
->
bh_wÜk
.
¥šlock
);

74 
	`INIT_WORK
(&
uáe¡dev
->
bh_wÜk
.
wÜk
, 
¦si_‹¡_bh_wÜk_f
);

75 
uáe¡dev
->
bh_wÜk
.
wÜkqueue
 = 
	`®loc_Üd”ed_wÜkqueue
("slsi_wlan_unittest_bh", 0);

76 ià(!
uáe¡dev
->
bh_wÜk
.
wÜkqueue
)

77  -
ENOMEM
;

78 
uáe¡dev
->
bh_wÜk
.
avaabË
 = 
Œue
;

80 
	}
}

82 
šlše
 
	$¦si_‹¡_bh_¡¬t
(
¦si_‹¡_dev
 *
uáe¡dev
)

84 
	`¦si_¥šlock_lock
(&
uáe¡dev
->
bh_wÜk
.
¥šlock
);

85 
uáe¡dev
->
bh_wÜk
.
avaabË
 = 
Œue
;

86 
	`¦si_¥šlock_uÆock
(&
uáe¡dev
->
bh_wÜk
.
¥šlock
);

87 
	}
}

89 
šlše
 
	$¦si_‹¡_bh_run
(
¦si_‹¡_dev
 *
uáe¡dev
)

91 
	`¦si_¥šlock_lock
(&
uáe¡dev
->
bh_wÜk
.
¥šlock
);

92 ià(!
uáe¡dev
->
bh_wÜk
.
avaabË
)

93 
ex™
;

94 
	`queue_wÜk
(
uáe¡dev
->
bh_wÜk
.
wÜkqueue
, &uáe¡dev->bh_wÜk.
wÜk
);

95 
ex™
:

96 
	`¦si_¥šlock_uÆock
(&
uáe¡dev
->
bh_wÜk
.
¥šlock
);

97 
	}
}

99 
šlše
 
	$¦si_‹¡_bh_¡İ
(
¦si_‹¡_dev
 *
uáe¡dev
)

101 
wÜkqueue_¡ruù
 *
wÜkqueue
 = 
NULL
;

103 
	`¦si_¥šlock_lock
(&
uáe¡dev
->
bh_wÜk
.
¥šlock
);

104 
uáe¡dev
->
bh_wÜk
.
avaabË
 = 
çl£
;

105 
wÜkqueue
 = 
uáe¡dev
->
bh_wÜk
.workqueue;

106 
uáe¡dev
->
bh_wÜk
.
wÜkqueue
 = 
NULL
;

107 
	`¦si_¥šlock_uÆock
(&
uáe¡dev
->
bh_wÜk
.
¥šlock
);

109 ià(
wÜkqueue
)

110 
	`æush_wÜkqueue
(
wÜkqueue
);

111 
	}
}

113 
šlše
 
	$¦si_‹¡_bh_deš™
(
¦si_‹¡_dev
 *
uáe¡dev
)

115 
wÜkqueue_¡ruù
 *
wÜkqueue
 = 
NULL
;

117 
	`¦si_¥šlock_lock
(&
uáe¡dev
->
bh_wÜk
.
¥šlock
);

118 
	`WARN_ON
(
uáe¡dev
->
bh_wÜk
.
avaabË
);

119 
uáe¡dev
->
bh_wÜk
.
avaabË
 = 
çl£
;

120 
wÜkqueue
 = 
uáe¡dev
->
bh_wÜk
.workqueue;

121 
uáe¡dev
->
bh_wÜk
.
wÜkqueue
 = 
NULL
;

122 
	`¦si_¥šlock_uÆock
(&
uáe¡dev
->
bh_wÜk
.
¥šlock
);

123 ià(
wÜkqueue
) {

124 
	`æush_wÜkqueue
(
wÜkqueue
);

125 
	`de¡roy_wÜkqueue
(
wÜkqueue
);

127 
	}
}

	@traffic_monitor.c

6 
	~<lšux/ktime.h
>

7 
	~"dev.h
"

8 
	~"debug.h
"

9 
	~"Œaffic_mÚ™Ü.h
"

11 
	s¦si_Œaffic_mÚ_ş›Á_’Œy
 {

12 
li¡_h—d
 
	mq
;

13 *
	mş›Á_ùx
;

14 
u32
 
	mthroughput
;

15 
u32
 
	m¡©e
;

16 
u32
 
	mhy¡”esis
;

17 
u32
 
	mmode
;

18 
u32
 
	mmid_ut
;

19 
u32
 
	mhigh_ut
;

20 (*
	mŒaffic_mÚ_ş›Á_cb
)(*
	mş›Á_ùx
, 
u32
 
	m¡©e
, u32 
	mut_tx
, u32 
	mut_rx
);

23 
šlše
 
	$Œaffic_mÚ_švoke_ş›Á_ÿÎback
(
¦si_dev
 *
sdev
, 
u32
 
ut_tx
, u32 
ut_rx
, 
boŞ
 
ov”ride
)

25 
li¡_h—d
 *
pos
, *
n
;

26 
¦si_Œaffic_mÚ_ş›Á_’Œy
 *
Œaffic_ş›Á
;

28 
	`li¡_fÜ_—ch_§ã
(
pos
, 
n
, &
sdev
->
Œaffic_mÚ_ş›Ás
.
ş›Á_li¡
) {

29 
Œaffic_ş›Á
 = 
	`li¡_’Œy
(
pos
, 
¦si_Œaffic_mÚ_ş›Á_’Œy
, 
q
);

31 ià(
ov”ride
) {

32 
Œaffic_ş›Á
->
¡©e
 = 
TRAFFIC_MON_CLIENT_STATE_OVERRIDE
;

33 ià(
Œaffic_ş›Á
->
Œaffic_mÚ_ş›Á_cb
)

34 
Œaffic_ş›Á
->
	`Œaffic_mÚ_ş›Á_cb
Ñ¿ffic_ş›Á->
ş›Á_ùx
, 
TRAFFIC_MON_CLIENT_STATE_OVERRIDE
, 
ut_tx
, 
ut_rx
);

35 } ià(
Œaffic_ş›Á
->
mode
 =ğ
TRAFFIC_MON_CLIENT_MODE_PERIODIC
) {

36 ià(
Œaffic_ş›Á
->
Œaffic_mÚ_ş›Á_cb
)

37 
Œaffic_ş›Á
->
	`Œaffic_mÚ_ş›Á_cb
Ñ¿ffic_ş›Á->
ş›Á_ùx
, 
TRAFFIC_MON_CLIENT_STATE_LOW
, 
ut_tx
, 
ut_rx
);

38 
Œaffic_ş›Á
->
throughput
 = (
ut_tx
 + 
ut_rx
);

39 } ià(
Œaffic_ş›Á
->
mode
 =ğ
TRAFFIC_MON_CLIENT_MODE_EVENTS
) {

40 ià((
Œaffic_ş›Á
->
high_ut
è&& ((
ut_tx
 + 
ut_rx
) >raffic_client->high_tput)) {

41 ià(
Œaffic_ş›Á
->
¡©e
 !ğ
TRAFFIC_MON_CLIENT_STATE_HIGH
 &&

42 (
Œaffic_ş›Á
->
hy¡”esis
++ > 
SLSI_TRAFFIC_MON_HYSTERESIS_HIGH
)) {

43 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "nÙify¿ffiøev’ˆÑput:%u, s‹:%u --> HIGH)\n", (
ut_tx
 + 
ut_rx
), 
Œaffic_ş›Á
->
¡©e
);

44 
Œaffic_ş›Á
->
hy¡”esis
 = 0;

45 
Œaffic_ş›Á
->
¡©e
 = 
TRAFFIC_MON_CLIENT_STATE_HIGH
;

47 ià(
Œaffic_ş›Á
->
Œaffic_mÚ_ş›Á_cb
)

48 
Œaffic_ş›Á
->
	`Œaffic_mÚ_ş›Á_cb
Ñ¿ffic_ş›Á->
ş›Á_ùx
, 
TRAFFIC_MON_CLIENT_STATE_HIGH
, 
ut_tx
, 
ut_rx
);

50 } ià((
Œaffic_ş›Á
->
mid_ut
è&& ((
ut_tx
 + 
ut_rx
) >raffic_client->mid_tput)) {

51 ià(
Œaffic_ş›Á
->
¡©e
 !ğ
TRAFFIC_MON_CLIENT_STATE_MID
) {

52 ià((
Œaffic_ş›Á
->
¡©e
 =ğ
TRAFFIC_MON_CLIENT_STATE_LOW
 && (Œaffic_ş›Á->
hy¡”esis
++ > 
SLSI_TRAFFIC_MON_HYSTERESIS_HIGH
)) ||

53 (
Œaffic_ş›Á
->
¡©e
 =ğ
TRAFFIC_MON_CLIENT_STATE_HIGH
 && (Œaffic_ş›Á->
hy¡”esis
++ > 
SLSI_TRAFFIC_MON_HYSTERESIS_LOW
))) {

54 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "nÙify¿ffiøev’ˆÑput:%u, s‹:%u --> MID)\n", (
ut_tx
 + 
ut_rx
), 
Œaffic_ş›Á
->
¡©e
);

55 
Œaffic_ş›Á
->
hy¡”esis
 = 0;

56 
Œaffic_ş›Á
->
¡©e
 = 
TRAFFIC_MON_CLIENT_STATE_MID
;

57 ià(
Œaffic_ş›Á
->
Œaffic_mÚ_ş›Á_cb
)

58 
Œaffic_ş›Á
->
	`Œaffic_mÚ_ş›Á_cb
Ñ¿ffic_ş›Á->
ş›Á_ùx
, 
TRAFFIC_MON_CLIENT_STATE_MID
, 
ut_tx
, 
ut_rx
);

61 } ià(
Œaffic_ş›Á
->
¡©e
 !ğ
TRAFFIC_MON_CLIENT_STATE_LOW
 &&

62 (
Œaffic_ş›Á
->
hy¡”esis
++ > 
SLSI_TRAFFIC_MON_HYSTERESIS_LOW
)) {

63 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "nÙify¿ffiøev’ˆÑput:%u, s‹:%u --> LOW\n", (
ut_tx
 + 
ut_rx
), 
Œaffic_ş›Á
->
¡©e
);

64 
Œaffic_ş›Á
->
hy¡”esis
 = 0;

65 
Œaffic_ş›Á
->
¡©e
 = 
TRAFFIC_MON_CLIENT_STATE_LOW
;

66 ià(
Œaffic_ş›Á
->
Œaffic_mÚ_ş›Á_cb
)

67 
Œaffic_ş›Á
->
	`Œaffic_mÚ_ş›Á_cb
Ñ¿ffic_ş›Á->
ş›Á_ùx
, 
TRAFFIC_MON_CLIENT_STATE_LOW
, 
ut_tx
, 
ut_rx
);

69 
Œaffic_ş›Á
->
throughput
 = (
ut_tx
 + 
ut_rx
);

72 
	}
}

74 #ià
KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


75 
	$Œaffic_mÚ_tim”
(
tim”_li¡
 *
t
)

77 
	$Œaffic_mÚ_tim”
(
d©a
)

80 #ià
	`KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


81 
¦si_Œaffic_mÚ_ş›Ás
 *
ş›Ás
 = 
	`äom_tim”
(ş›Ás, 
t
, 
tim”
);

82 
¦si_dev
 *
sdev
 = 
	`cÚš”_of
(
ş›Ás
, 
	`ty³of
(*sdev), 
Œaffic_mÚ_ş›Ás
);

84 
¦si_dev
 *
sdev
 = (¦si_dev *)
d©a
;

86 
Ãt_deviû
 *
dev
;

87 
Ãtdev_vif
 *
ndev_vif
;

88 
boŞ
 
¡İ_mÚ™Ü
;

89 
u8
 
i
;

90 
u32
 
ut_rx
 = 0;

91 
u32
 
ut_tx
 = 0;

93 ià(!
sdev
) {

94 
	`SLSI_ERR_NODEV
("invalid sdev\n");

98 
	`¥š_lock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

100 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

101 
dev
 = 
sdev
->
Ãtdev
[
i
];

102 ià(
dev
) {

103 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

105 ià(
ndev_vif
) {

106 
u32
 
time_š_ms
 = 0;

112 
time_š_ms
 = 
	`ktime_to_ms
(
	`ktime_sub
(
	`ktime_g‘
(), 
ndev_vif
->
Ï¡_tim”_time
));

117 
ndev_vif
->
num_by‹s_rx_³r_£c
 +ğndev_vif->
num_by‹s_rx_³r_tim”
;

118 
ndev_vif
->
num_by‹s_tx_³r_£c
 +ğndev_vif->
num_by‹s_tx_³r_tim”
;

119 
ndev_vif
->
»pÜt_time
 +ğ
time_š_ms
;

120 ià(
ndev_vif
->
»pÜt_time
 >= 1000) {

121 
ndev_vif
->
throughput_rx_bps
 = (ndev_vif->
num_by‹s_rx_³r_£c
 * 8 /‚dev_vif->
»pÜt_time
) * 1000;

122 
ndev_vif
->
throughput_tx_bps
 = (ndev_vif->
num_by‹s_tx_³r_£c
 * 8 /‚dev_vif->
»pÜt_time
) * 1000;

123 
ndev_vif
->
num_by‹s_rx_³r_£c
 = 0;

124 
ndev_vif
->
num_by‹s_tx_³r_£c
 = 0;

125 
ndev_vif
->
»pÜt_time
 = 0;

129 
ndev_vif
->
throughput_tx
 = (ndev_vif->
num_by‹s_tx_³r_tim”
 * 8 / 
time_š_ms
) * 1000;

130 
ndev_vif
->
throughput_rx
 = (ndev_vif->
num_by‹s_rx_³r_tim”
 * 8 / 
time_š_ms
) * 1000;

132 
ndev_vif
->
num_by‹s_tx_³r_tim”
 = 0;

133 
ndev_vif
->
num_by‹s_rx_³r_tim”
 = 0;

134 
ndev_vif
->
Ï¡_tim”_time
 = 
	`ktime_g‘
();

135 
ut_tx
 +ğ
ndev_vif
->
throughput_tx
;

136 
ut_rx
 +ğ
ndev_vif
->
throughput_rx
;

141 
	`Œaffic_mÚ_švoke_ş›Á_ÿÎback
(
sdev
, 
ut_tx
, 
ut_rx
, 
çl£
);

142 
¡İ_mÚ™Ü
 = 
	`li¡_em±y
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
ş›Á_li¡
);

144 
	`¥š_uÆock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

145 ià(!
¡İ_mÚ™Ü
)

146 
	`mod_tim”
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
tim”
, 
jiff›s
 + 
	`m£cs_to_jiff›s
(
SLSI_TRAFFIC_MON_TIMER_PERIOD
));

147 
	}
}

149 
šlše
 
	$¦si_Œaffic_mÚ_ev’t_rx
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

151 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

159 ià(
skb
->
Ën
 >= 40)

160 
ndev_vif
->
num_by‹s_rx_³r_tim”
 +ğ(
skb
->
Ën
 - 40);

162 
ndev_vif
->
num_by‹s_rx_³r_tim”
 +ğ
skb
->
Ën
;

163 
	}
}

165 
šlše
 
	$¦si_Œaffic_mÚ_ev’t_tx
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

167 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

168 
¦si_skb_cb
 *
cb
 = 
	`¦si_skb_cb_g‘
(
skb
);

170 ià((
skb
->
Ën
 - 
cb
->
sig_Ëngth
) >= 40)

171 
ndev_vif
->
num_by‹s_tx_³r_tim”
 +ğ((
skb
->
Ën
 - 40è- 
cb
->
sig_Ëngth
);

173 
ndev_vif
->
num_by‹s_tx_³r_tim”
 +ğ(
skb
->
Ën
 - 
cb
->
sig_Ëngth
);

174 
	}
}

176 
	$¦si_Œaffic_mÚ_ov”ride
(
¦si_dev
 *
sdev
)

178 ià(
	`WARN_ON_ONCE
(
	`š_œq
()))

181 
	`¥š_lock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

182 ià(!
	`li¡_em±y
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
ş›Á_li¡
)) {

183 
	`Œaffic_mÚ_švoke_ş›Á_ÿÎback
(
sdev
, 0, 0, 
Œue
);

185 
	`¥š_uÆock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

187 
	}
}

189 
u8
 
	$¦si_Œaffic_mÚ_is_ruÂšg
(
¦si_dev
 *
sdev
)

191 
u8
 
is_ruÂšg
 = 0;

193 
	`¥š_lock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

194 ià(!
	`li¡_em±y
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
ş›Á_li¡
))

195 
is_ruÂšg
 = 1;

196 
	`¥š_uÆock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

197  
is_ruÂšg
;

198 
	}
}

200 
	$¦si_Œaffic_mÚ_ş›Á_»gi¡”
(

201 
¦si_dev
 *
sdev
,

202 *
ş›Á_ùx
,

203 
u32
 
mode
,

204 
u32
 
mid_ut
,

205 
u32
 
high_ut
,

206 (*
Œaffic_mÚ_ş›Á_cb
)(*
ş›Á_ùx
, 
u32
 
¡©e
, u32 
ut_tx
, u32 
ut_rx
))

208 
¦si_Œaffic_mÚ_ş›Á_’Œy
 *
Œaffic_mÚ_ş›Á
;

209 
boŞ
 
¡¬t_mÚ™Ü
;

210 
Ãt_deviû
 *
dev
;

211 
Ãtdev_vif
 *
ndev_vif
;

212 
u8
 
i
;

214 ià(!
ş›Á_ùx
) {

215 
	`SLSI_ERR
(
sdev
, "A client context must be…rovided\n");

216  -
EINVAL
;

219 
	`¥š_lock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

220 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "ş›Á:%p, mode:%u, mid_ut:%u, high_ut:%u\n", 
ş›Á_ùx
, 
mode
, 
mid_ut
, 
high_ut
);

221 
¡¬t_mÚ™Ü
 = 
	`li¡_em±y
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
ş›Á_li¡
);

222 
Œaffic_mÚ_ş›Á
 = 
	`km®loc
((*Œaffic_mÚ_ş›Á), 
GFP_ATOMIC
);

223 ià(!
Œaffic_mÚ_ş›Á
) {

224 
	`SLSI_ERR
(
sdev
, "could‚ot‡llocate memory for Monitor client\n");

225 
	`¥š_uÆock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

226  -
ENOMEM
;

229 
Œaffic_mÚ_ş›Á
->
ş›Á_ùx
 = client_ctx;

230 
Œaffic_mÚ_ş›Á
->
¡©e
 = 
TRAFFIC_MON_CLIENT_STATE_LOW
;

231 
Œaffic_mÚ_ş›Á
->
hy¡”esis
 = 0;

232 
Œaffic_mÚ_ş›Á
->
mode
 = mode;

233 
Œaffic_mÚ_ş›Á
->
mid_ut
 = mid_tput;

234 
Œaffic_mÚ_ş›Á
->
high_ut
 = high_tput;

235 
Œaffic_mÚ_ş›Á
->
Œaffic_mÚ_ş›Á_cb
 =raffic_mon_client_cb;

238 
	`li¡_add_
(&
Œaffic_mÚ_ş›Á
->
q
, &
sdev
->
Œaffic_mÚ_ş›Ás
.
ş›Á_li¡
);

240 ià(
¡¬t_mÚ™Ü
) {

242 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

243 
dev
 = 
sdev
->
Ãtdev
[
i
];

244 ià(
dev
) {

245 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

247 ià(
ndev_vif
) {

248 
ndev_vif
->
throughput_tx
 = 0;

249 
ndev_vif
->
throughput_rx
 = 0;

250 
ndev_vif
->
num_by‹s_tx_³r_tim”
 = 0;

251 
ndev_vif
->
num_by‹s_rx_³r_tim”
 = 0;

252 
ndev_vif
->
Ï¡_tim”_time
 = 
	`ktime_g‘
();

253 
ndev_vif
->
num_by‹s_rx_³r_£c
 = 0;

254 
ndev_vif
->
num_by‹s_tx_³r_£c
 = 0;

255 
ndev_vif
->
throughput_rx_bps
 = 0;

256 
ndev_vif
->
throughput_tx_bps
 = 0;

257 
ndev_vif
->
»pÜt_time
 = 0;

261 
	`mod_tim”
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
tim”
, 
jiff›s
 + 
	`m£cs_to_jiff›s
(
SLSI_TRAFFIC_MON_TIMER_PERIOD
));

264 
	`¥š_uÆock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

266 
	}
}

268 
	$¦si_Œaffic_mÚ_ş›Á_uÄegi¡”
(
¦si_dev
 *
sdev
, *
ş›Á_ùx
)

270 
li¡_h—d
 *
pos
, *
n
;

271 
¦si_Œaffic_mÚ_ş›Á_’Œy
 *
Œaffic_mÚ_ş›Á
;

272 
Ãt_deviû
 *
dev
;

273 
Ãtdev_vif
 *
ndev_vif
;

274 
u8
 
i
;

276 
	`¥š_lock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

277 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "ş›Á: %p\n", 
ş›Á_ùx
);

278 
	`li¡_fÜ_—ch_§ã
(
pos
, 
n
, &
sdev
->
Œaffic_mÚ_ş›Ás
.
ş›Á_li¡
) {

279 
Œaffic_mÚ_ş›Á
 = 
	`li¡_’Œy
(
pos
, 
¦si_Œaffic_mÚ_ş›Á_’Œy
, 
q
);

280 ià(
Œaffic_mÚ_ş›Á
->
ş›Á_ùx
 == client_ctx) {

281 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "d–‘e: %p\n", 
Œaffic_mÚ_ş›Á
->
ş›Á_ùx
);

282 
	`li¡_d–
(
pos
);

283 
	`kä“
(
Œaffic_mÚ_ş›Á
);

287 ià(
	`li¡_em±y
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
ş›Á_li¡
)) {

289 
i
 = 1; i <ğ
CONFIG_SCSC_WLAN_MAX_INTERFACES
; i++) {

290 
dev
 = 
sdev
->
Ãtdev
[
i
];

291 ià(
dev
) {

292 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

294 ià(
ndev_vif
) {

295 
ndev_vif
->
throughput_tx
 = 0;

296 
ndev_vif
->
throughput_rx
 = 0;

297 
ndev_vif
->
num_by‹s_tx_³r_tim”
 = 0;

298 
ndev_vif
->
num_by‹s_rx_³r_tim”
 = 0;

299 
ndev_vif
->
num_by‹s_rx_³r_£c
 = 0;

300 
ndev_vif
->
num_by‹s_tx_³r_£c
 = 0;

301 
ndev_vif
->
throughput_rx_bps
 = 0;

302 
ndev_vif
->
throughput_tx_bps
 = 0;

303 
ndev_vif
->
»pÜt_time
 = 0;

307 
	`¥š_uÆock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

308 
	`d–_tim”_sync
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
tim”
);

309 
	`¥š_lock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

311 
	`¥š_uÆock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

312 
	}
}

314 
	$¦si_Œaffic_mÚ_ş›Ás_š™
(
¦si_dev
 *
sdev
)

316 ià(!
sdev
) {

317 
	`SLSI_ERR_NODEV
("invalid sdev\n");

320 #ià
	`KERNEL_VERSION
(4, 15, 0è<ğ
LINUX_VERSION_CODE


321 
	`tim”_£tup
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
tim”
, 
Œaffic_mÚ_tim”
, 0);

323 
	`£tup_tim”
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
tim”
, 
Œaffic_mÚ_tim”
, ()sdev);

325 
	`INIT_LIST_HEAD
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
ş›Á_li¡
);

326 
	`¥š_lock_š™
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

327 
	}
}

329 
	$¦si_Œaffic_mÚ_ş›Ás_deš™
(
¦si_dev
 *
sdev
)

331 
li¡_h—d
 *
pos
, *
n
;

332 
¦si_Œaffic_mÚ_ş›Á_’Œy
 *
Œaffic_mÚ_ş›Á
;

334 ià(!
sdev
) {

335 
	`SLSI_ERR_NODEV
("invalid sdev\n");

339 
	`¥š_lock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

340 
	`li¡_fÜ_—ch_§ã
(
pos
, 
n
, &
sdev
->
Œaffic_mÚ_ş›Ás
.
ş›Á_li¡
) {

341 
Œaffic_mÚ_ş›Á
 = 
	`li¡_’Œy
(
pos
, 
¦si_Œaffic_mÚ_ş›Á_’Œy
, 
q
);

342 
	`SLSI_DBG1
(
sdev
, 
SLSI_HIP
, "d–‘e: %p\n", 
Œaffic_mÚ_ş›Á
->
ş›Á_ùx
);

343 
	`li¡_d–
(
pos
);

344 
	`kä“
(
Œaffic_mÚ_ş›Á
);

346 
	`¥š_uÆock_bh
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
lock
);

347 
	`d–_tim”_sync
(&
sdev
->
Œaffic_mÚ_ş›Ás
.
tim”
);

348 
	}
}

	@traffic_monitor.h

7 #iâdeà
__TRAFFIC_MONITOR_H__


8 
	#__TRAFFIC_MONITOR_H__


	)

10 
	#SLSI_TRAFFIC_MON_TIMER_PERIOD
 100

	)

11 
	#SLSI_TRAFFIC_MON_HYSTERESIS_HIGH
 2

	)

12 
	#SLSI_TRAFFIC_MON_HYSTERESIS_LOW
 10

	)

15 
	mTRAFFIC_MON_CLIENT_MODE_NONE
,

16 
	mTRAFFIC_MON_CLIENT_MODE_PERIODIC
,

17 
	mTRAFFIC_MON_CLIENT_MODE_EVENTS


21 
	mTRAFFIC_MON_CLIENT_STATE_LOW
,

22 
	mTRAFFIC_MON_CLIENT_STATE_MID
,

23 
	mTRAFFIC_MON_CLIENT_STATE_HIGH
,

24 
	mTRAFFIC_MON_CLIENT_STATE_OVERRIDE


27 
	s¦si_Œaffic_mÚ_ş›Ás
 {

29 
¥šlock_t
 
	mlock
;

31 
tim”_li¡
 
	mtim”
;

32 
li¡_h—d
 
	mş›Á_li¡
;

35 
¦si_Œaffic_mÚ_ev’t_rx
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

36 
¦si_Œaffic_mÚ_ev’t_tx
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
);

47 
¦si_Œaffic_mÚ_ov”ride
(
¦si_dev
 *
sdev
);

58 
u8
 
¦si_Œaffic_mÚ_is_ruÂšg
(
¦si_dev
 *
sdev
);

75 
¦si_Œaffic_mÚ_ş›Á_»gi¡”
(

76 
¦si_dev
 *
sdev
,

77 *
ş›Á_ùx
,

78 
u32
 
mode
,

79 
u32
 
mid_ut
,

80 
u32
 
high_ut
,

82 (*
Œaffic_mÚ_ş›Á_cb
)(*
ş›Á_ùx
, 
u32
 
¡©e
, u32 
ut_tx
, u32 
ut_rx
));

83 
	`¦si_Œaffic_mÚ_ş›Á_uÄegi¡”
(
¦si_dev
 *
sdev
, *
ş›Á_ùx
);

85 
	`¦si_Œaffic_mÚ_ş›Ás_š™
(
¦si_dev
 *
sdev
);

86 
	`¦si_Œaffic_mÚ_ş›Ás_deš™
(
¦si_dev
 *
sdev
);

	@tx.c

7 
	~"dev.h
"

8 
	~"debug.h
"

9 
	~"mgt.h
"

10 
	~"mlme.h
"

11 
	~"Ãtif.h
"

12 
	~"log_ş›Ás.h
"

13 
	~"h4_§m¶”.h
"

14 
	~"Œaffic_mÚ™Ü.h
"

16 
boŞ
 
	gmsdu_’abË
 = 
Œue
;

17 
moduË_·¿m
(
msdu_’abË
, 
boŞ
, 
S_IRUGO
 | 
S_IWUSR
);

18 
MODULE_PARM_DESC
(
msdu_’abË
, "MSDU frame format, Y:ƒnable (default), N: disable");

20 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


21 
	~"scsc_wifogg”_ršgs.h
"

28 
	~"h4.h
"

30 
	~<lšux/¥šlock.h
>

32 
	$¦si_g‘_dw–l_time_fÜ_wps
(
¦si_dev
 *
sdev
, 
Ãtdev_vif
 *
ndev_vif
, 
u8
 *
—pŞ
, 
u16
 
—p_Ëngth
)

40 ià(
—pŞ
[
SLSI_EAP_CODE_POS
] =ğ
SLSI_EAP_PACKET_REQUEST
 ||

41 
—pŞ
[
SLSI_EAP_CODE_POS
] =ğ
SLSI_EAP_PACKET_RESPONSE
) {

42 ià(
—pŞ
[
SLSI_EAP_TYPE_POS
] =ğ
SLSI_EAP_TYPE_EXPANDED
 && 
—p_Ëngth
 >ğ
SLSI_EAP_OPCODE_POS
 - 3 &&

43 ((
—pŞ
[
SLSI_EAP_OPCODE_POS
] =ğ
SLSI_EAP_OPCODE_WSC_MSG
 && 
—p_Ëngth
 >ğ
SLSI_EAP_MSGTYPE_POS
 - 3 &&

44 
—pŞ
[
SLSI_EAP_MSGTYPE_POS
] !ğ
SLSI_EAP_MSGTYPE_M8
) ||

45 
—pŞ
[
SLSI_EAP_OPCODE_POS
] =ğ
SLSI_EAP_OPCODE_WSC_START
))

46  
SLSI_EAP_WPS_DWELL_TIME
;

51 ià(
	`SLSI_IS_VIF_INDEX_P2P_GROUP
(
sdev
, 
ndev_vif
) &&

52 
—pŞ
[
SLSI_EAP_CODE_POS
] =ğ
SLSI_EAP_PACKET_REQUEST
 &&

53 
—pŞ
[
SLSI_EAP_TYPE_POS
] =ğ
SLSI_EAP_TYPE_IDENTITY
)

54  
SLSI_EAP_WPS_DWELL_TIME
;

57 
	}
}

59 
	$¦si_tx_—pŞ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

61 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

62 
¦si_³”
 *
³”
;

63 
u8
 *
—pŞ
 = 
NULL
;

64 
u16
 
msg_ty³
 = 0;

65 
u16
 
´Ùo
 = 
	`Áohs
(
skb
->
´ÙocŞ
);

66 
»t
 = 0;

67 
u32
 
dw–l_time
 = 
sdev
->
fw_dw–l_time
;

68 
u64
 
tx_by‹s_tmp
 = 0;

69 
u16
 
—p_Ëngth
 = 0;

71 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

72 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
	`‘h_hdr
(
skb
)->
h_de¡
);

73 ià(!
³”
) {

74 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

75 
	`SLSI_NET_WARN
(
dev
, "nØ³”„ecÜd fÜ " 
MACSTR
 ", drİ EAP f¿me\n", 
	`MAC2STR
(
	`‘h_hdr
(
skb
)->
h_de¡
));

76  -
EINVAL
;

79 
´Ùo
) {

80 
ETH_P_PAE
:

92 ià((
skb
->
Ën
 - (
‘hhdr
)) >= 99)

93 
—pŞ
 = 
skb
->
d©a
 + (
‘hhdr
);

94 ià(
—pŞ
 &&ƒ­Ş[
SLSI_EAPOL_IEEE8021X_TYPE_POS
] =ğ
SLSI_IEEE8021X_TYPE_EAPOL_KEY
) {

95 
msg_ty³
 = 
FAPI_MESSAGETYPE_EAPOL_KEY_M123
;

97 ià((!(
—pŞ
[
SLSI_EAPOL_KEY_INFO_LOWER_BYTE_POS
] & 
SLSI_EAPOL_KEY_INFO_ACK_BIT_IN_LOWER_BYTE
)) &&

98 
—pŞ
[
SLSI_EAPOL_KEY_INFO_LOWER_BYTE_POS
] & 
SLSI_EAPOL_KEY_INFO_KEY_TYPE_BIT_IN_LOWER_BYTE
 &&

99 ((
—pŞ
[
SLSI_EAPOL_TYPE_POS
] =ğ
SLSI_EAPOL_TYPE_RSN_KEY
 &&

100 
—pŞ
[
SLSI_EAPOL_KEY_INFO_HIGHER_BYTE_POS
] & 
SLSI_EAPOL_KEY_INFO_SECURE_BIT_IN_HIGHER_BYTE
) ||

101 (
—pŞ
[
SLSI_EAPOL_TYPE_POS
] =ğ
SLSI_EAPOL_TYPE_WPA_KEY
 &&

102 
—pŞ
[
SLSI_EAPOL_KEY_INFO_HIGHER_BYTE_POS
] & 
SLSI_EAPOL_KEY_INFO_MIC_BIT_IN_HIGHER_BYTE
 &&

103 
—pŞ
[
SLSI_EAPOL_KEY_DATA_LENGTH_HIGHER_BYTE_POS
] =ğ0 &&ƒ­Ş[
SLSI_EAPOL_KEY_DATA_LENGTH_LOWER_BYTE_POS
] == 0))){

104 
msg_ty³
 = 
FAPI_MESSAGETYPE_EAPOL_KEY_M4
;

105 
dw–l_time
 = 0;

108 
msg_ty³
 = 
FAPI_MESSAGETYPE_EAP_MESSAGE
;

109 ià((
skb
->
Ën
 - (
‘hhdr
)) >= 9)

110 
—pŞ
 = 
skb
->
d©a
 + (
‘hhdr
);

112 
dw–l_time
 = 0;

113 ià(
—pŞ
 &&ƒ­Ş[
SLSI_EAPOL_IEEE8021X_TYPE_POS
] =ğ
SLSI_IEEE8021X_TYPE_EAP_PACKET
) {

114 
—p_Ëngth
 = (
skb
->
Ën
 - (
‘hhdr
)) - 4;

115 ià(
—pŞ
[
SLSI_EAP_CODE_POS
] =ğ
SLSI_EAP_PACKET_REQUEST
)

116 
	`SLSI_INFO
(
sdev
, "S’d EAP-Reque¡ (%d)\n", 
—p_Ëngth
);

117 ià(
—pŞ
[
SLSI_EAP_CODE_POS
] =ğ
SLSI_EAP_PACKET_RESPONSE
)

118 
	`SLSI_INFO
(
sdev
, "S’d EAP-Re¥Ú£ (%d)\n", 
—p_Ëngth
);

119 ià(
—pŞ
[
SLSI_EAP_CODE_POS
] =ğ
SLSI_EAP_PACKET_SUCCESS
)

120 
	`SLSI_INFO
(
sdev
, "S’d EAP-Sucûs (%d)\n", 
—p_Ëngth
);

121 ià(
—pŞ
[
SLSI_EAP_CODE_POS
] =ğ
SLSI_EAP_PACKET_FAILURE
)

122 
	`SLSI_INFO
(
sdev
, "S’d EAP-Fau» (%d)\n", 
—p_Ëngth
);

127 
dw–l_time
 = 
	`¦si_g‘_dw–l_time_fÜ_wps
(
sdev
, 
ndev_vif
, 
—pŞ
, 
—p_Ëngth
);

131 
ETH_P_WAI
:

132 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_MLME
, "WAI…rotocol frame\n");

133 
msg_ty³
 = 
FAPI_MESSAGETYPE_WAI_MESSAGE
;

135 ià(
skb
->
d©a
[17] != 9)

136 
dw–l_time
 = 0;

139 
	`SLSI_NET_WARN
(
dev
, "protocol NOT supported\n");

140 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

141  -
EOPNOTSUPP
;

145 
tx_by‹s_tmp
 = 
skb
->
Ën
;

146 
»t
 = 
	`¦si_mlme_£nd_äame_d©a
(
sdev
, 
dev
, 
skb
, 
msg_ty³
, 0, 
dw–l_time
, 0);

147 ià(!
»t
)

148 
³”
->
sšfo
.
tx_by‹s
 +ğ
tx_by‹s_tmp
;

150 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

151  
»t
;

152 
	}
}

154 
	$¦si_tx_¬p
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

156 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

157 
¦si_³”
 *
³”
;

158 
u8
 *
äame
;

159 
u16
 
¬p_İcode
;

160 
»t
 = 0;

161 
u32
 
dw–l_time
 = 0;

163 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

165 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
	`‘h_hdr
(
skb
)->
h_de¡
);

166 ià(!
³”
 && !
	`is_brßdÿ¡_‘h”_addr
(
	`‘h_hdr
(
skb
)->
h_de¡
)) {

167 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

168 
	`SLSI_NET_WARN
(
dev
, "nØ³”„ecÜd fÜ " 
MACSTR
 ", drİ ARP f¿me\n", 
	`MAC2STR
(
	`‘h_hdr
(
skb
)->
h_de¡
));

169  -
EINVAL
;

172 ià(
³”
) {

173 
	`¥š_lock_bh
(&
³”
->
d©a_qs
.
ı_lock
);

175 ià(
³”
->
d©a_qs
.
cÚŒŞËd_pÜt_¡©e
 =ğ
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
) {

176 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, " ARP 8021x_STATE_BLOCKED\n");

177 
	`¥š_uÆock_bh
(&
³”
->
d©a_qs
.
ı_lock
);

178 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

179  -
EPERM
;

181 
	`¥š_uÆock_bh
(&
³”
->
d©a_qs
.
ı_lock
);

184 
äame
 = 
skb
->
d©a
 + (
‘hhdr
);

185 
¬p_İcode
 = 
äame
[
SLSI_ARP_OPCODE_OFFSET
] << 8 | frame[SLSI_ARP_OPCODE_OFFSET + 1];

186 ià(
¬p_İcode
 =ğ
SLSI_ARP_REQUEST_OPCODE
 &&

187 !
	`SLSI_IS_GRATUITOUS_ARP
(
äame
)) {

188 #ifdeà
CONFIG_SCSC_WLAN_STA_ENHANCED_ARP_DETECT


189 ià(
ndev_vif
->
’hªûd_¬p_d‘eù_’abËd
 &&

190 !
	`memcmp
(&
äame
[
SLSI_ARP_DEST_IP_ADDR_OFFSET
], &
ndev_vif
->
rg‘__addr
, 4)) {

191 
ndev_vif
->
’hªûd_¬p_¡©s
.
¬p_»q_couÁ_äom_Ãtdev
++;

194 
dw–l_time
 = 
sdev
->
fw_dw–l_time
;

196 
»t
 = 
	`¦si_mlme_£nd_äame_d©a
(
sdev
, 
dev
, 
skb
, 
FAPI_MESSAGETYPE_ARP
, 0, 
dw–l_time
, 0);

197 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

198  
»t
;

199 
	}
}

201 
	$¦si_dump_msgty³
(
¦si_dev
 *
sdev
, 
u32
 
dhı_mes§ge_ty³
)

203 ià(
dhı_mes§ge_ty³
 =ğ
SLSI_DHCP_MESSAGE_TYPE_DISCOVER
)

204 
	`SLSI_INFO
(
sdev
, "Send DHCP [DISCOVER]\n");

205 ià(
dhı_mes§ge_ty³
 =ğ
SLSI_DHCP_MESSAGE_TYPE_OFFER
)

206 
	`SLSI_INFO
(
sdev
, "Send DHCP [OFFER]\n");

207 ià(
dhı_mes§ge_ty³
 =ğ
SLSI_DHCP_MESSAGE_TYPE_REQUEST
)

208 
	`SLSI_INFO
(
sdev
, "Send DHCP [REQUEST]\n");

209 ià(
dhı_mes§ge_ty³
 =ğ
SLSI_DHCP_MESSAGE_TYPE_DECLINE
)

210 
	`SLSI_INFO
(
sdev
, "Send DHCP [DECLINE]\n");

211 ià(
dhı_mes§ge_ty³
 =ğ
SLSI_DHCP_MESSAGE_TYPE_ACK
)

212 
	`SLSI_INFO
(
sdev
, "Send DHCP [ACK]\n");

213 ià(
dhı_mes§ge_ty³
 =ğ
SLSI_DHCP_MESSAGE_TYPE_NAK
)

214 
	`SLSI_INFO
(
sdev
, "Send DHCP [NAK]\n");

215 ià(
dhı_mes§ge_ty³
 =ğ
SLSI_DHCP_MESSAGE_TYPE_RELEASE
)

216 
	`SLSI_INFO
(
sdev
, "Send DHCP [RELEASE]\n");

217 ià(
dhı_mes§ge_ty³
 =ğ
SLSI_DHCP_MESSAGE_TYPE_INFORM
)

218 
	`SLSI_INFO
(
sdev
, "Send DHCP [INFORM]\n");

219 ià(
dhı_mes§ge_ty³
 =ğ
SLSI_DHCP_MESSAGE_TYPE_FORCERENEW
)

220 
	`SLSI_INFO
(
sdev
, "Send DHCP [FORCERENEW]\n");

222 
	`SLSI_INFO
(
sdev
, "Send DHCP [INVALID]\n");

223 
	}
}

225 
	$¦si_tx_dhı
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

227 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

228 
¦si_³”
 *
³”
;

229 
»t
 = 0;

230 
u32
 
dw–l_time
 = 0;

231 
u32
 
dhı_mes§ge_ty³
 = 
SLSI_DHCP_MESSAGE_TYPE_INVALID
;

233 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

234 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
	`‘h_hdr
(
skb
)->
h_de¡
);

235 ià(!
³”
 && !
	`is_brßdÿ¡_‘h”_addr
(
	`‘h_hdr
(
skb
)->
h_de¡
)) {

236 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

237 
	`SLSI_NET_WARN
(
dev
, "nØ³”„ecÜd fÜ " 
MACSTR
 ", drİ DHCP f¿me\n", 
	`MAC2STR
(
	`‘h_hdr
(
skb
)->
h_de¡
));

238  -
EINVAL
;

241 ià(
³”
) {

242 
	`¥š_lock_bh
(&
³”
->
d©a_qs
.
ı_lock
);

244 ià(
³”
->
d©a_qs
.
cÚŒŞËd_pÜt_¡©e
 =ğ
SCSC_WIFI_FCQ_8021x_STATE_BLOCKED
) {

245 
	`SLSI_DBG1_NODEV
(
SLSI_MLME
, "dhcp 8021x_STATE_BLOCKED\n");

246 
	`¥š_uÆock_bh
(&
³”
->
d©a_qs
.
ı_lock
);

247 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

248  -
EPERM
;

250 
	`¥š_uÆock_bh
(&
³”
->
d©a_qs
.
ı_lock
);

253 ià(
skb
->
Ën
 >ğ285 && 
	`¦si_is_dhı_·ck‘
(skb->
d©a
è!ğ
SLSI_TX_IS_NOT_DHCP
) {

255 ià(
skb
->
d©a
[42] == 1)

256 
dw–l_time
 = 
sdev
->
fw_dw–l_time
;

257 
dhı_mes§ge_ty³
 = 
skb
->
d©a
[284];

258 
	`¦si_dump_msgty³
(
sdev
, 
dhı_mes§ge_ty³
);

259 
»t
 = 
	`¦si_mlme_£nd_äame_d©a
(
sdev
, 
dev
, 
skb
, 
FAPI_MESSAGETYPE_DHCP
, 0, 
dw–l_time
, 0);

262 
	`SLSI_NET_ERR
(
dev
, "Bad IP frame in SLSI_NETIF_Q_PRIORITY\n");

264 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

265  
»t
;

266 
	}
}

268 
ušt
 
	g¦si_sg_ho¡_®ign_mask
;

279 
	$¦si_tx_d©a
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

281 
¦si_skb_cb
 *
cb
;

282 
Ãtdev_vif
 *
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

283 
¦si_³”
 *
³”
;

284 
sk_buff
 *
Üigš®_skb
 = 
NULL
;

285 
u16
 
Ën
 = 
skb
->len;

286 
»t
 = 0;

287 
u8
 
vif_šdex
 = 0;

288 
u8
 
³”_šdex
 = 0;

289 
¦si_Œaffic_q
 
tq
;

291 ià(
	`¦si_is_‹¡_mode_’abËd
()) {

296 
	`SLSI_NET_WARN
(
dev
, "WlanLite: NOT supported\n");

297  -
EOPNOTSUPP
;

300 ià(!
ndev_vif
->
aùiv©ed
) {

301 
	`SLSI_NET_WARN
(
dev
, "vif NOT‡ctivated\n");

302  -
EINVAL
;

305 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
 && !ndev_vif->
³”_¡a_»cÜds
) {

306 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
,

308  -
EINVAL
;

315 ià(
skb
->
queue_m­pšg
 =ğ
SLSI_NETIF_Q_PRIORITY
) {

316 
´Ùo
 = 
	`be16_to_ıu
(
	`‘h_hdr
(
skb
)->
h_´Ùo
);

318 
´Ùo
) {

321 
	`SLSI_NET_ERR
(
dev
,

322 "Bad h_´Ùo=0x%x SLSI_NETIF_Q_PRIORITY\n", 
´Ùo
);

323  -
EINVAL
;

324 
ETH_P_PAE
:

325 
ETH_P_WAI
:

326 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
,

328  
	`¦si_tx_—pŞ
(
sdev
, 
dev
, 
skb
);

329 
ETH_P_IP
:

330 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
,

332  
	`¦si_tx_dhı
(
sdev
, 
dev
, 
skb
);

336 ià(
skb
->
queue_m­pšg
 =ğ
SLSI_NETIF_Q_ARP
) {

337 
´Ùo
 = 
	`be16_to_ıu
(
	`‘h_hdr
(
skb
)->
h_´Ùo
);

339 
´Ùo
) {

340 
ETH_P_ARP
:

341 
	`SLSI_NET_DBG2
(
dev
, 
SLSI_MLME
,

343  
	`¦si_tx_¬p
(
sdev
, 
dev
, 
skb
);

346 
	`SLSI_NET_ERR
(
dev
,

347 "Bad h_´Ùo=0x%x SLSI_NETIF_Q_ARP\n", 
´Ùo
);

348  -
EINVAL
;

352 ià(
	`skb_h—droom
(
skb
è< (
	`çpi_sig_size
(
ma_un™d©a_»q
) + 160)) {

353 
sk_buff
 *
skb2
 = 
NULL
;

355 
skb2
 = 
	`skb_»®loc_h—droom
(
skb
, 
	`çpi_sig_size
(
ma_un™d©a_»q
) + 160);

356 ià(!
skb2
) {

357 
	`SLSI_NET_WARN
(
dev
,

359  -
EINVAL
;

362 
Üigš®_skb
 = 
skb
;

363 
skb
 = 
skb2
;

367 ià(
	`skb_h—droom
(
skb
è!ğskb->
mac_h—d”
)

368 
	`skb_puÎ
(
skb
, skb->
mac_h—d”
 - 
	`skb_h—droom
(skb));

370 ià(
msdu_’abË
)

371 
	`‘hr_ii_to_subäame_msdu
(
skb
);

373 
Ën
 = 
skb
->len;

375 ()
	`skb_push
(
skb
, 
	`çpi_sig_size
(
ma_un™d©a_»q
));

376 
tq
 = 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
);

377 
vif_šdex
 = 
ndev_vif
->
iâum
;

378 
³”_šdex
 = 
	`MAP_QS_TO_AID
(
	`¦si_Ãtif_g‘_qs_äom_queue
(
skb
->
queue_m­pšg
, 
tq
));

379 
	`çpi_£t_u16
(
skb
, 
id
, 
MA_UNITDATA_REQ
);

380 
	`çpi_£t_u16
(
skb
, 
»ûiv”_pid
, 0);

381 
	`çpi_£t_u16
(
skb
, 
£nd”_pid
, 
SLSI_TX_PROCESS_ID_MIN
);

382 
	`çpi_£t_u32
(
skb
, 
fw_»ã»nû
, 0);

383 
	`çpi_£t_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
vif
, 
vif_šdex
);

384 
	`çpi_£t_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
ho¡_g
, 
	`¦si_tx_ho¡_g
(
sdev
, 
tq
));

385 
	`çpi_£t_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
³”_šdex
,…eer_index);

387 
	`SCSC_HIP4_SAMPLER_PKT_TX
(
sdev
->
mšÜ_´of
, 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
ho¡_g
));

392 
	`çpi_£t_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
´iÜ™y
, 
FAPI_PRIORITY_CONTENTION
);

394 ià(
msdu_’abË
)

395 
	`çpi_£t_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
d©a_un™_desütÜ
, 
FAPI_DATAUNITDESCRIPTOR_AMSDU_SUBFRAME
);

397 
	`çpi_£t_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
d©a_un™_desütÜ
, 
FAPI_DATAUNITDESCRIPTOR_IEEE802_3_FRAME
);

399 
	`SLSI_NET_DBG_HEX
(
dev
, 
SLSI_TX
, 
skb
->
d©a
, skb->
Ën
 < 128 ? skb->len : 128, "\n");

401 
cb
 = 
	`¦si_skb_cb_š™
(
skb
);

402 
cb
->
sig_Ëngth
 = 
	`çpi_sig_size
(
ma_un™d©a_»q
);

403 
cb
->
d©a_Ëngth
 = 
skb
->
Ën
;

405 #ià
	`IS_ENABLED
(
CONFIG_SCSC_WIFILOGGER
)

407 
	`SCSC_WLOG_PKTFATE_LOG_TX_DATA_FRAME
(
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
ho¡_g
),

408 
skb
->
d©a
, 
	`skb_h—dËn
(skb));

412 ià(
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
) {

413 
‘hhdr
 *
ehdr
 = 
	`‘h_hdr
(
skb
);

415 ià(
	`is_muÉiÿ¡_‘h”_addr
(
ehdr
->
h_de¡
)) {

416 
»t
 = 
	`scsc_wifi_fcq_Œªsm™_d©a
(
dev
,

417 &
ndev_vif
->
­
.
group_d©a_qs
,

418 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
),

419 
sdev
,

420 
vif_šdex
,

421 
³”_šdex
);

422 ià(
»t
 < 0) {

423 
	`SLSI_NET_WARN
(
dev
, "no fcq for groupcast, drop Tx frame\n");

425 ià(
Üigš®_skb
)

426 
	`cÚsume_skb
(
skb
);

427  
»t
;

430 
»t
 = 
	`scsc_wifi_Œªsm™_äame
(&
sdev
->
h4_š¡
, 
skb
, 
çl£
, 
vif_šdex
, 
³”_šdex
, 
	`¦si_äame_´iÜ™y_to_ac_queue
(skb->
´iÜ™y
));

431 ià(
»t
 =ğ
NETDEV_TX_OK
) {

436 ià(
Üigš®_skb
)

437 
	`cÚsume_skb
(
Üigš®_skb
);

438  
»t
;

439 } ià(
»t
 < 0) {

441 
	`scsc_wifi_fcq_»ûive_d©a
(
dev
,

442 &
ndev_vif
->
­
.
group_d©a_qs
,

443 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
),

444 
sdev
,

445 
vif_šdex
,

446 
³”_šdex
);

447 ià(
Üigš®_skb
)

448 
	`cÚsume_skb
(
skb
);

449  
»t
;

451 ià(
Üigš®_skb
)

452 
	`cÚsume_skb
(
skb
);

453  -
EIO
;

456 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

458 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
	`‘h_hdr
(
skb
)->
h_de¡
);

459 ià(!
³”
) {

460 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

461 
	`SLSI_NET_WARN
(
dev
, "nØ³”„ecÜd fÜ " 
MACSTR
 ", drİ Tx f¿me\n", 
	`MAC2STR
(
	`‘h_hdr
(
skb
)->
h_de¡
));

462 ià(
Üigš®_skb
)

463 
	`cÚsume_skb
(
skb
);

464  -
EINVAL
;

474 ià(
³”
->
qos_’abËd
)

475 
	`çpi_£t_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
´iÜ™y
, skb->priority);

477 #ifdeà
CONFIG_SCSC_WIFI_NAN_ENABLE


479 ià(
ndev_vif
->
iâum
 >ğ
SLSI_NAN_DATA_IFINDEX_START
) {

480 
u8
 
i
 = 0;

482 ià(
	`is_muÉiÿ¡_‘h”_addr
(
	`‘h_hdr
(
skb
)->
h_de¡
)) {

483 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "muÉiÿ¡ oÀNAN iÁ”çû: Sourû=%pM\n", 
	`‘h_hdr
(
skb
)->
h_sourû
);

489 
i
 = 0; i < 
SLSI_PEER_INDEX_MAX
; i++) {

490 ià(
ndev_vif
->
³”_¡a_»cÜd
[
i
] &&

491 
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
v®id
 &&

492 
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
ndl_vif
 !ğ
³”
->ndl_vif) {

496 
sk_buff
 *
du¶iÿ‹_skb
 = 
	`skb_cİy
(
skb
, 
GFP_ATOMIC
);

498 ià(!
du¶iÿ‹_skb
) {

499 
	`SLSI_NET_WARN
(
dev
, "NAN: Tx: multicast: failedo‡lloc duplicate SKB\n");

502 
	`çpi_£t_u16
(
du¶iÿ‹_skb
, 
u
.
ma_un™d©a_»q
.
vif
, 
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
ndl_vif
);

504 
»t
 = 
	`scsc_wifi_fcq_Œªsm™_d©a
(
dev
, &
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
d©a_qs
,

505 
	`¦si_äame_´iÜ™y_to_ac_queue
(
du¶iÿ‹_skb
->
´iÜ™y
),

506 
sdev
,

507 
vif_šdex
,

508 
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
aid
);

509 ià(
»t
 < 0) {

510 
	`SLSI_NET_WARN
(
dev
, "du¶iÿ‹ SKB:‚Øfcq fÜ " 
MACSTR
 ", drİ Tx f¿me\n", 
	`MAC2STR
(
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
add»ss
));

511 
	`kä“_skb
(
du¶iÿ‹_skb
);

515 
»t
 = 
	`scsc_wifi_Œªsm™_äame
(&
sdev
->
h4_š¡
,

516 
du¶iÿ‹_skb
,

517 
çl£
,

518 
vif_šdex
,

519 
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
aid
,

520 
	`¦si_äame_´iÜ™y_to_ac_queue
(
du¶iÿ‹_skb
->
´iÜ™y
));

521 ià(
»t
 !ğ
NETDEV_TX_OK
) {

523 
	`scsc_wifi_fcq_»ûive_d©a
(
dev
, &
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
d©a_qs
,

524 
	`¦si_äame_´iÜ™y_to_ac_queue
(
du¶iÿ‹_skb
->
´iÜ™y
),

525 
sdev
,

526 
vif_šdex
,

527 
ndev_vif
->
³”_¡a_»cÜd
[
i
]->
aid
);

528 
	`kä“_skb
(
du¶iÿ‹_skb
);

534 
	`çpi_£t_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
vif
, 
³”
->
ndl_vif
);

538 
	`¦si_debug_äame
(
sdev
, 
dev
, 
skb
, "TX");

540 
»t
 = 
	`scsc_wifi_fcq_Œªsm™_d©a
(
dev
, &
³”
->
d©a_qs
,

541 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
),

542 
sdev
,

543 
vif_šdex
,

544 
³”_šdex
);

545 ià(
»t
 < 0) {

546 
	`SLSI_NET_WARN
(
dev
, "nØfcq fÜ " 
MACSTR
 ", drİ Tx f¿me\n", 
	`MAC2STR
(
	`‘h_hdr
(
skb
)->
h_de¡
));

547 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

548 ià(
Üigš®_skb
)

549 
	`cÚsume_skb
(
skb
);

550  
»t
;

556 
	`¦si_Œaffic_mÚ_ev’t_tx
(
sdev
, 
dev
, 
skb
);

557 
»t
 = 
	`scsc_wifi_Œªsm™_äame
(&
sdev
->
h4_š¡
, 
skb
, 
çl£
, 
vif_šdex
, 
³”_šdex
, 
	`¦si_äame_´iÜ™y_to_ac_queue
(skb->
´iÜ™y
));

558 ià(
»t
 !ğ
NETDEV_TX_OK
) {

560 
	`scsc_wifi_fcq_»ûive_d©a
(
dev
, &
³”
->
d©a_qs
, 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
),

561 
sdev
,

562 
vif_šdex
,

563 
³”_šdex
);

565 ià(
»t
 =ğ-
ENOSPC
) {

566 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

567 ià(
Üigš®_skb
)

568 
	`cÚsume_skb
(
skb
);

569  
»t
;

571 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

572 ià(
Üigš®_skb
)

573 
	`cÚsume_skb
(
skb
);

574  -
EIO
;

577 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

579 ià(
Üigš®_skb
)

580 
	`cÚsume_skb
(
Üigš®_skb
);

581 
³”
->
sšfo
.
tx_by‹s
 +ğ
Ën
;

582  
»t
;

583 
	}
}

585 
	$¦si_tx_d©a_low”
(
¦si_dev
 *
sdev
, 
sk_buff
 *
skb
)

587 
Ãt_deviû
 *
dev
;

588 
Ãtdev_vif
 *
ndev_vif
;

589 
¦si_³”
 *
³”
;

590 
u16
 
vif
;

591 
u8
 
³”_šdex
;

592 
u8
 *
de¡
;

593 
»t
;

595 
vif
 = 
	`çpi_g‘_vif
(
skb
);

596 
³”_šdex
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_»q
.peer_index);

598 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
d©a_un™_desütÜ
)) {

599 
FAPI_DATAUNITDESCRIPTOR_IEEE802_3_FRAME
:

600 ià(
	`Áohs
(
	`‘h_hdr
(
skb
)->
h_´Ùo
è=ğ
ETH_P_PAE
 ||‚tohsÓth_hdr(skb)->h_´Ùoè=ğ
ETH_P_WAI
)

601  
	`¦si_tx_cÚŒŞ
(
sdev
, 
NULL
, 
skb
);

602 
de¡
 = 
	`‘h_hdr
(
skb
)->
h_de¡
;

605 
FAPI_DATAUNITDESCRIPTOR_AMSDU
:

612 
de¡
 = 
	`‘h_hdr
(
skb
)->
h_de¡
;

614 
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
:

615 
de¡
 = 
	`›“80211_g‘_DA
((
›“80211_hdr
 *)
	`çpi_g‘_d©a
(
skb
));

618 
	`SLSI_ERR
(
sdev
, "data_unit_descriptor incorrectly set (0x%02x), dropping TX frame\n",

619 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
d©a_un™_desütÜ
));

620  -
EINVAL
;

623 
	`rcu_»ad_lock
();

624 
dev
 = 
	`¦si_g‘_Ãtdev_rcu
(
sdev
, 
vif
);

625 ià(!
dev
) {

626 
	`SLSI_ERR
(
sdev
, "Ãtdev(%dèNØlÚg”ƒxi¡s\n", 
vif
);

627 
	`rcu_»ad_uÆock
();

628  -
EINVAL
;

631 
ndev_vif
 = 
	`Ãtdev_´iv
(
dev
);

632 
	`rcu_»ad_uÆock
();

634 ià(
	`is_muÉiÿ¡_‘h”_addr
(
de¡
è&& 
ndev_vif
->
vif_ty³
 =ğ
FAPI_VIFTYPE_AP
) {

635 ià(
	`scsc_wifi_fcq_Œªsm™_d©a
(
dev
, &
ndev_vif
->
­
.
group_d©a_qs
,

636 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
),

637 
sdev
,

638 
vif
,

639 
³”_šdex
) < 0) {

640 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
, "no fcq for groupcast, dropping TX frame\n");

641  -
EINVAL
;

643 
»t
 = 
	`scsc_wifi_Œªsm™_äame
(&
sdev
->
h4_š¡
, 
skb
, 
çl£
, 
vif
, 
³”_šdex
, 
	`¦si_äame_´iÜ™y_to_ac_queue
(skb->
´iÜ™y
));

644 ià(
»t
 =ğ
NETDEV_TX_OK
)

645  
»t
;

650 ià(
»t
 =ğ-
ENOSPC
)

651 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "TX_LOWER...Queue Full... BUT Dropping…acket\n");

653 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "TX_LOWER...Generic Error...Dropping…acket\n");

655 
	`scsc_wifi_fcq_»ûive_d©a
(
dev
, &
ndev_vif
->
­
.
group_d©a_qs
,

656 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
),

657 
sdev
,

658 
vif
,

659 
³”_šdex
);

660  
»t
;

663 
	`¦si_¥šlock_lock
(&
ndev_vif
->
³”_lock
);

664 
³”
 = 
	`¦si_g‘_³”_äom_mac
(
sdev
, 
dev
, 
de¡
);

665 ià(!
³”
) {

666 
	`SLSI_ERR
(
sdev
, "nØ³”„ecÜd fÜ " 
MACSTR
 ", dropping TX frame\n",

667 
	`MAC2STR
(
de¡
));

668 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

669  -
EINVAL
;

671 
	`¦si_debug_äame
(
sdev
, 
dev
, 
skb
, "TX");

673 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
´iÜ™y
è=ğ
FAPI_PRIORITY_CONTENTION
)

674 
skb
->
´iÜ™y
 = 
FAPI_PRIORITY_QOS_UP0
;

676 
skb
->
´iÜ™y
 = 
	`çpi_g‘_u16
(skb, 
u
.
ma_un™d©a_»q
.priority);

678 ià(
	`scsc_wifi_fcq_Œªsm™_d©a
(
dev
, &
³”
->
d©a_qs
,

679 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
),

680 
sdev
,

681 
vif
,

682 
³”_šdex
) < 0) {

683 
	`SLSI_NET_DBG3
(
dev
, 
SLSI_TX
, "no fcq for %02x:%02x:%02x:%02x:%02x:%02x, dropping TX frame\n",

684 
	`‘h_hdr
(
skb
)->
h_de¡
[0],ƒth_hdr(skb)->h_dest[1],ƒth_hdr(skb)->h_dest[2],ƒth_hdr(skb)->h_dest[3],ƒth_hdr(skb)->h_dest[4],ƒth_hdr(skb)->h_dest[5]);

685 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

686  -
EINVAL
;

692 
»t
 = 
	`scsc_wifi_Œªsm™_äame
(&
sdev
->
h4_š¡
, 
skb
, 
çl£
, 
vif
, 
³”_šdex
, 
	`¦si_äame_´iÜ™y_to_ac_queue
(skb->
´iÜ™y
));

693 ià(
»t
 < 0) {

694 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
, "% (sigÇl: %d)\n", 
»t
 =ğ-
ENOSPC
 ? "Queui fuÎ. Flow cÚŒŞ" : "FaedØŒªsm™", 
	`çpi_g‘_sigid
(
skb
));

696 
	`scsc_wifi_fcq_»ûive_d©a
(
dev
, &
ndev_vif
->
­
.
group_d©a_qs
,

697 
	`¦si_äame_´iÜ™y_to_ac_queue
(
skb
->
´iÜ™y
),

698 
sdev
,

699 
vif
,

700 
³”_šdex
);

701 ià(
»t
 =ğ-
ENOSPC
)

702 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
,

705 
	`SLSI_NET_DBG1
(
dev
, 
SLSI_TX
,

707 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

708  
»t
;

711 
	`¦si_¥šlock_uÆock
(&
ndev_vif
->
³”_lock
);

713 
	}
}

721 
	$¦si_tx_cÚŒŞ
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
sk_buff
 *
skb
)

723 
¦si_skb_cb
 *
cb
;

724 
»s
 = 0;

725 
çpi_sigÇl_h—d”
 *
hdr
;

727 ià(
	`WARN_ON
(!
skb
)) {

728 
»s
 = -
EINVAL
;

729 
ex™
;

737 ià(!
	`¦si_is_‹¡_mode_’abËd
())

738 ià(!
	`çpi_is_mlme
(
skb
è&& !
	`çpi_is_ma
(skbè&& !
	`çpi_is_debug
(skbè&& !
	`çpi_is_‹¡
(skb)) {

739 
	`SLSI_NET_WARN
(
dev
, "Disÿrdšg skb beÿu£ iˆha ty³: 0x%04X\n", 
	`çpi_g‘_sigid
(
skb
));

740  -
EINVAL
;

743 
cb
 = 
	`¦si_skb_cb_š™
(
skb
);

744 
cb
->
sig_Ëngth
 = 
	`çpi_g‘_ex³ùed_size
(
skb
);

745 
cb
->
d©a_Ëngth
 = 
skb
->
Ën
;

747 
hdr
 = (
çpi_sigÇl_h—d”
 *)
skb
->
d©a
;

748 
hdr
->
fw_»ã»nû
 = 0;

750 #ià
	`IS_ENABLED
(
CONFIG_SCSC_WIFILOGGER
)

752 
	`SCSC_WLOG_PKTFATE_LOG_TX_CTRL_FRAME
(
	`çpi_g‘_u16
(
skb
, 
u
.
mlme_äame_ŒªsmissiÚ_šd
.
ho¡_g
),

753 
skb
->
d©a
, 
	`skb_h—dËn
(skb));

756 
	`¦si_debug_äame
(
sdev
, 
dev
, 
skb
, "TX");

757 
»s
 = 
	`scsc_wifi_Œªsm™_äame
(&
sdev
->
h4_š¡
, 
skb
, 
Œue
, 0, 0, 0);

758 ià(
»s
 !ğ
NETDEV_TX_OK
) {

759 
»asÚ
[80];

761 
	`SLSI_NET_ERR
(
dev
, "% (sigÇÈ%d)\n", 
»s
 =ğ-
ENOSPC
 ? "Queui fuÎ. Flow cÚŒŞ" : "FaedØŒªsm™", 
	`çpi_g‘_sigid
(
skb
));

763 ià(!
	`š_š‹¼u±
()) {

764 
	`¢´štf
(
»asÚ
, Ô—sÚ), "FaedØŒªsm™ sigÇÈ0x%04X (”r:%d)", 
	`çpi_g‘_sigid
(
skb
), 
»s
);

765 
	`¦si_sm_£rviû_çed
(
sdev
, 
»asÚ
, 
çl£
);

767 
»s
 = -
EIO
;

770 
ex™
:

771  
»s
;

772 
	}
}

774 
	$¦si_tx_·u£_queues
(
¦si_dev
 *
sdev
)

776 ià(!
sdev
)

779 
	`scsc_wifi_fcq_·u£_queues
(
sdev
);

780 
	}
}

782 
	$¦si_tx_uÅau£_queues
(
¦si_dev
 *
sdev
)

784 ià(!
sdev
)

787 
	`scsc_wifi_fcq_uÅau£_queues
(
sdev
);

788 
	}
}

	@udi.c

7 
	~<lšux/sysfs.h
>

8 
	~<lšux/pŞl.h
>

9 
	~<lšux/cdev.h
>

11 
	~"dev.h
"

13 
	~"h.h
"

14 
	~"log_ş›Ás.h
"

15 
	~"mlme.h
"

16 
	~"fw_‹¡.h
"

17 
	~"debug.h
"

18 
	~"udi.h
"

19 
	~"¤c_sšk.h
"

20 
	~"unifiio.h
"

21 
	~"´ocfs.h
"

22 
	~"§p_mlme.h
"

24 #ifdeà
SLSI_TEST_DEV


25 
	~"un™‹¡.h
"

26 
	#UDI_CHAR_DEVICE_NAME
 "s5n2560un™‹¡"

	)

27 
	#UDI_CLASS_NAME
 "s5n2560‹¡"

	)

29 
	#UDI_CHAR_DEVICE_NAME
 "s5n2560udi"

	)

30 
	#UDI_CLASS_NAME
 "s5n2560"

	)

33 
	#UDI_LOG_MASK_FILTER_NUM_MAX
 5

	)

35 
	#UDI_MIB_SET_LEN_MAX
 65535

	)

36 
	#UDI_MIB_GET_LEN_MAX
 2048

	)

38 #iâdeà
ETH_P_WAPI


39 
	#ETH_P_WAPI
 0x88b4

	)

42 
	#SLSI_IP_TYPE_UDP
 0x11

	)

43 
	#SLSI_DHCP_SERVER_PORT
 67

	)

44 
	#SLSI_DHCP_CLIENT_PORT
 68

	)

45 
	#SLSI_DHCP_MAGIC_OFFSET
 272

	)

46 
	#SLSI_DHCP_MESSAGE_TYPE_ACK
 0x05

	)

52 
	#NUM_CHAR_CLIENTS
 12

	)

54 
	#MAX_MINOR
 (
SLSI_UDI_MINOR_NODES
 - 1è

	)

55 
dev_t
 
	gmajÜ_numb”
;

56 
şass
 *
	gşass
;

58 
	g¦si_cdev_ş›Á
;

60 
	s¦si_cdev
 {

61 
	mmšÜ
;

62 
cdev
 
	mcdev
;

63 
¦si_cdev_ş›Á
 *
	mş›Á
[
NUM_CHAR_CLIENTS
];

65 
¦si_dev
 *
	msdev
;

66 
deviû
 *
	m·»Á
;

69 
	s¦si_cdev_ş›Á
 {

70 
¦si_cdev
 *
	mufcdev
;

71 
	mlog_’abËd
;

72 
	mlog_®low_driv”_sigÇls
;

74 
u16
 
	mtx_£nd”_id
;

75 
¦si_fw_‹¡
 
	mfw_‹¡
;

78 
u16
 
	mma_un™d©a_f‹r_cÚfig
;

80 
u16
 
	mma_un™d©a_size_lim™
;

82 
sk_buff_h—d
 
	mlog_li¡
;

83 
£m­hÜe
 
	mlog_mu‹x
;

84 
wa™_queue_h—d_t
 
	mlog_wq
;

87 
	#UDI_MAX_QUEUED_FRAMES
 10000

	)

88 
	#UDI_RESTART_QUEUED_FRAMES
 9000

	)

90 
	#UDI_MAX_QUEUED_DATA_FRAMES
 9000

	)

91 
	#UDI_RESTART_QUEUED_DATA_FRAMES
 8000

	)

98 
u32
 
	mlog_drİ³d
;

99 
u32
 
	mlog_drİ³d_d©a
;

100 
boŞ
 
	mlog_drİ_d©a_·ck‘s
;

103 
šlše
 
boŞ
 
	$¦si_cdev_un™d©a_f‹r_®low
(
¦si_cdev_ş›Á
 *
ş›Á
, 
u16
 
f‹r
)

105  (
ş›Á
->
ma_un™d©a_f‹r_cÚfig
 & 
f‹r
) == filter;

106 
	}
}

111 
¦si_cdev
 *
	guf_cdevs
[
SLSI_UDI_MINOR_NODES
];

113 
udi_log_ev’t
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
);

114 
£nd_sigÇl_to_log_f‹r
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
);

115 
£nd_sigÇl_to_šv”£_log_f‹r
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
);

117 
	$¦si_check_cdev_»fs
()

119 
ş›Á_num
;

120 
cdev_num
;

121 
¦si_cdev
 *
cdev
 = 
NULL
;

123 
cdev_num
 = 0; cdev_num < 
SLSI_UDI_MINOR_NODES
; cdev_num++) {

124 
cdev
 = 
uf_cdevs
[
cdev_num
];

126 ià(!
cdev
)

129 
ş›Á_num
 = 0; cl›Á_num < 
NUM_CHAR_CLIENTS
; client_num++)

130 ià(
cdev
->
ş›Á
[
ş›Á_num
])

135 
	}
}

137 
	$¦si_k”Ãl_to_u£r_¥aû_ev’t
(
¦si_log_ş›Á
 *
log_ş›Á
, 
u16
 
ev’t
, 
u32
 
d©a_Ëngth
, cÚ¡ 
u8
 *
d©a
)

139 
¦si_cdev_ş›Á
 *
ş›Á
 = 
log_ş›Á
->
log_ş›Á_ùx
;

140 
sk_buff
 *
skb
;

141 
»t
;

143 ià(
	`WARN_ON
(!
ş›Á
))

144  -
EINVAL
;

146 ià(!
ş›Á
->
log_®low_driv”_sigÇls
)

149 
skb
 = 
	`çpi_®loc_f
((
çpi_sigÇl_h—d”
), 
d©a_Ëngth
, 
ev’t
, 0, 
__FILE__
, 
__LINE__
);

150 ià(
	`WARN_ON
(!
skb
))

151  -
ENOMEM
;

153 ià(
d©a_Ëngth
)

154 
	`çpi_­³nd_d©a
(
skb
, 
d©a
, 
d©a_Ëngth
);

156 
»t
 = 
	`udi_log_ev’t
(
log_ş›Á
, 
skb
, 
UDI_CONFIG_IND
);

157 ià(
»t
)

158 
	`SLSI_WARN_NODEV
("Udi†ogƒvent‚ot„egistered\n");

163 
	`kä“_skb
(
skb
);

164  
»t
;

165 
	}
}

167 
	$¦si_cdev_İ’
(
šode
 *šode, 
fe
 *file)

169 
¦si_cdev
 *
uf_cdev
;

170 
¦si_cdev_ş›Á
 *
ş›Á
;

171 
šdx
;

172 
mšÜ
;

174 
mšÜ
 = 
	`imšÜ
(
šode
);

175 ià(
mšÜ
 > 
MAX_MINOR
) {

176 
	`SLSI_ERR_NODEV
("mšÜ %dƒxûed ¿nge\n", 
mšÜ
);

177  -
EINVAL
;

180 
uf_cdev
 = 
uf_cdevs
[
mšÜ
];

181 ià(!
uf_cdev
) {

182 
	`SLSI_ERR_NODEV
("nØcdev in¡ªû fÜ mšÜ %d\n", 
mšÜ
);

183  -
EINVAL
;

186 
šdx
 = 0; indx < 
NUM_CHAR_CLIENTS
; indx++)

187 ià(!
uf_cdev
->
ş›Á
[
šdx
])

189 ià(
šdx
 >ğ
NUM_CHAR_CLIENTS
) {

190 
	`SLSI_ERR_NODEV
("already opened\n");

191  -
ENOTSUPP
;

194 
ş›Á
 = 
	`km®loc
((*ş›Á), 
GFP_KERNEL
);

195 ià(!
ş›Á
)

196  -
ENOMEM
;

197 
	`mem£t
(
ş›Á
, 0, (
¦si_cdev_ş›Á
));

200 
	`skb_queue_h—d_š™
(&
ş›Á
->
log_li¡
);

201 
	`š™_wa™queue_h—d
(&
ş›Á
->
log_wq
);

202 
	`£ma_š™
(&
ş›Á
->
log_mu‹x
, 1);

203 
ş›Á
->
tx_£nd”_id
 = 
SLSI_TX_PROCESS_ID_UDI_MIN
;

204 
	`¦si_fw_‹¡_š™
(
uf_cdev
->
sdev
, &
ş›Á
->
fw_‹¡
);

206 
ş›Á
->
ufcdev
 = 
uf_cdev
;

207 
uf_cdev
->
ş›Á
[
šdx
] = client;

208 
fe
->
´iv©e_d©a
 = 
ş›Á
;

209 
	`¦si_´ocfs_šc_node
();

211 #ià
	`IS_ENABLED
(
CONFIG_SCSC_MXLOGGER
)

212 
	`scsc_£rviû_»gi¡”_ob£rv”
(
NULL
, "udi");

215 
	`SLSI_DBG1_NODEV
(
SLSI_UDI
, "Cl›Á:%d‡dded\n", 
šdx
);

218 
	}
}

220 
	$¦si_cdev_»Ëa£
(
šode
 *šode, 
fe
 *
fp
)

222 
¦si_cdev_ş›Á
 *
ş›Á
 = (*)
fp
->
´iv©e_d©a
;

223 
¦si_cdev
 *
uf_cdev
;

224 
šdx
;

225 
mšÜ
;

227 
mšÜ
 = 
	`imšÜ
(
šode
);

228 ià(
mšÜ
 > 
MAX_MINOR
) {

229 
	`SLSI_ERR_NODEV
("mšÜ %dƒxûed ¿nge\n", 
mšÜ
);

230  -
EINVAL
;

233 
uf_cdev
 = 
uf_cdevs
[
mšÜ
];

234 ià(!
uf_cdev
) {

235 
	`SLSI_ERR_NODEV
("nØcdev in¡ªû fÜ mšÜ %d\n", 
mšÜ
);

236  -
EINVAL
;

239 ià(!
ş›Á
)

240  -
EINVAL
;

242 
šdx
 = 0; indx < 
NUM_CHAR_CLIENTS
; indx++)

243 ià(
uf_cdev
->
ş›Á
[
šdx
] == client)

245 ià(
šdx
 >ğ
NUM_CHAR_CLIENTS
) {

246 
	`SLSI_ERR_NODEV
("client‚ot found in†ist\n");

247  -
EINVAL
;

250 ià(
	`wa™queue_aùive
(&
ş›Á
->
log_wq
))

251 
	`wake_up_š‹¼u±ibË
(&
ş›Á
->
log_wq
);

253 ià(
ş›Á
->
log_’abËd
)

254 
	`¦si_log_ş›Á_uÄegi¡”
(
ş›Á
->
ufcdev
->
sdev
, client);

256 
	`skb_queue_purge
(&
ş›Á
->
log_li¡
);

258 
	`¦si_fw_‹¡_deš™
(
uf_cdev
->
sdev
, &
ş›Á
->
fw_‹¡
);

259 
uf_cdev
->
ş›Á
[
šdx
] = 
NULL
;

262 
	`kä“
(
ş›Á
);

263 
	`¦si_´ocfs_dec_node
();

265 #ià
	`IS_ENABLED
(
CONFIG_SCSC_MXLOGGER
)

266 
	`scsc_£rviû_uÄegi¡”_ob£rv”
(
NULL
, "udi");

269 
	`SLSI_DBG1_NODEV
(
SLSI_UDI
, "Cl›Á:%d„emoved\n", 
šdx
);

272 
	}
}

274 
ssize_t
 
	$¦si_cdev_»ad
(
fe
 *
fp
, *
p
, 
size_t
 
Ën
, 
loff_t
 *
poff
)

276 
¦si_cdev_ş›Á
 *
ş›Á
 = (*)
fp
->
´iv©e_d©a
;

277 
¦si_dev
 *
sdev
;

278 
msgËn
;

279 
sk_buff
 *
skb
;

281 
	`SLSI_UNUSED_PARAMETER
(
poff
);

283 ià(!
ş›Á
)

284  -
EINVAL
;

286 ià(!
	`skb_queue_Ën
(&
ş›Á
->
log_li¡
)) {

287 ià(
fp
->
f_æags
 & 
O_NONBLOCK
)

291 ià(
	`wa™_ev’t_š‹¼u±ibË
(
ş›Á
->
log_wq
, 
	`skb_queue_Ën
(&ş›Á->
log_li¡
))) {

292 
	`SLSI_ERR_NODEV
("slsi_cdev_read: wait_event_interruptible failed.\n");

293  -
ERESTARTSYS
;

297 
sdev
 = 
ş›Á
->
ufcdev
->sdev;

298 ià(!
sdev
) {

299 
	`SLSI_ERR_NODEV
("sdev‚ot set\n");

300  -
EINVAL
;

303 
skb
 = 
	`skb_dequeue
(&
ş›Á
->
log_li¡
);

304 ià(!
skb
) {

305 
	`SLSI_ERR
(
sdev
, "No Data\n");

306  -
EINVAL
;

309 
	`¦si_fw_‹¡_sigÇl_w™h_udi_h—d”
(
sdev
, &
ş›Á
->
fw_‹¡
, 
skb
);

311 
msgËn
 = 
skb
->
Ën
;

312 ià(
msgËn
 > (
s32
)
Ën
) {

313 
	`SLSI_WARN
(
sdev
, "Œunÿ‹d„—dØ%d‡ùu® msg†’ i %lu\n", 
msgËn
, ()
Ën
);

314 
msgËn
 = 
Ën
;

317 ià(
	`cİy_to_u£r
(
p
, 
skb
->
d©a
, 
msgËn
)) {

318 
	`SLSI_ERR
(
sdev
, "Failedo copy UDI†ogo user\n");

319 
	`kä“_skb
(
skb
);

320  -
EFAULT
;

323 
	`kä“_skb
(
skb
);

324  
msgËn
;

325 
	}
}

327 
ssize_t
 
	$¦si_cdev_wr™e
(
fe
 *
fp
, cÚ¡ *
p
, 
size_t
 
Ën
, 
loff_t
 *
poff
)

329 
¦si_cdev_ş›Á
 *
ş›Á
;

330 
¦si_dev
 *
sdev
;

331 
sk_buff
 *
skb
;

332 
u8
 *
d©a
;

333 
¦si_skb_cb
 *
cb
;

335 
	`SLSI_UNUSED_PARAMETER
(
poff
);

337 
ş›Á
 = (*)
fp
->
´iv©e_d©a
;

338 ià(!
ş›Á
) {

339 
	`SLSI_ERR_NODEV
("filep…rivate data‚ot set\n");

340  -
EINVAL
;

343 ià(!
ş›Á
->
ufcdev
) {

344 
	`SLSI_ERR_NODEV
("ufcdev‚ot set\n");

345  -
EINVAL
;

348 
sdev
 = 
ş›Á
->
ufcdev
->sdev;

349 ià(!
sdev
) {

350 
	`SLSI_ERR_NODEV
("sdev‚ot set\n");

351  -
EINVAL
;

353 
skb
 = 
	`®loc_skb
(
SLSI_NETIF_SKB_HEADROOM
 + 
SLSI_NETIF_SKB_TAILROOM
 + 
Ën
, 
GFP_KERNEL
);

354 ià(!
skb
) {

355 
	`SLSI_WARN_NODEV
("”rÜ‡Îoÿtšg skb (Ën: %d)\n", 
Ën
);

356  -
ENOMEM
;

359 
	`skb_»£rve
(
skb
, 
SLSI_NETIF_SKB_HEADROOM
 - 
	`SLSI_SKB_GET_ALIGNMENT_OFFSET
(skb));

360 
d©a
 = 
	`skb_put
(
skb
, 
Ën
);

361 ià(
	`cİy_äom_u£r
(
d©a
, 
p
, 
Ën
)) {

362 
	`SLSI_ERR
(
sdev
, "copy from user failed\n");

363 
	`kä“_skb
(
skb
);

364  -
EFAULT
;

367 
cb
 = 
	`¦si_skb_cb_š™
(
skb
);

368 
cb
->
sig_Ëngth
 = 
	`çpi_g‘_ex³ùed_size
(
skb
);

369 
cb
->
d©a_Ëngth
 = 
skb
->
Ën
;

372 
	`çpi_£t_u32
(
skb
, 
fw_»ã»nû
, 0);

374 
	`skb_£t_mac_h—d”
(
skb
, 
	`çpi_g‘_d©a
(skbè- skb->
d©a
);

376 
	`SLSI_DBG3_NODEV
(
SLSI_UDI
,

378 
	`çpi_g‘_sigid
(
skb
), 
	`çpi_g‘_sigËn
(skb),

379 
	`çpi_g‘_d©®’
(
skb
), 
	`skb_h—droom
(skb), ()
Ën
);

382 ià(
	`¦si_is_‹¡_mode_’abËd
(è|| 
	`çpi_is_»q
(
skb
è|| 
	`çpi_is_»s
(skb)) {

384 
ş›Á
->
tx_£nd”_id
++;

385 ià(
ş›Á
->
tx_£nd”_id
 > 
SLSI_TX_PROCESS_ID_UDI_MAX
)

386 
ş›Á
->
tx_£nd”_id
 = 
SLSI_TX_PROCESS_ID_UDI_MIN
;

388 
	`çpi_£t_u16
(
skb
, 
£nd”_pid
, 
ş›Á
->
tx_£nd”_id
);

389 ià(!
	`¦si_is_‹¡_mode_’abËd
())

390 
	`¦si_fw_‹¡_sigÇl
(
sdev
, &
ş›Á
->
fw_‹¡
, 
skb
);

391 ià(
	`çpi_is_ma
(
skb
)) {

392 ià(
	`¦si_tx_d©a_low”
(
sdev
, 
skb
)) {

393 
	`kä“_skb
(
skb
);

394  -
EINVAL
;

396 } ià(
	`¦si_tx_cÚŒŞ
(
sdev
, 
NULL
, 
skb
)) {

397 
	`kä“_skb
(
skb
);

398  -
EINVAL
;

400 } ià(
	`¦si_h_rx
(
sdev
, 
skb
)) {

401 
	`kä“_skb
(
skb
);

402  -
EINVAL
;

405  
Ën
;

406 
	}
}

408 
	$¦si_unifi_£t_mib
(
¦si_dev
 *
sdev
, 
¬g
)

410 
Ãt_deviû
 *
dev
 = 
NULL
;

411 
r
 = 0;

412 
u32
 
mib_d©a_Ëngth
;

413 
u32
 
mib_d©a_size
;

414 *
mib_d©a
;

415 
u16
 
mib_vif
;

417 ià(
sdev
->
deviû_¡©e
 !ğ
SLSI_DEVICE_STATE_STARTED
) {

418 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_MIB: Device‚ot yet‡vailable\n");

419  -
EFAULT
;

422 ià(
	`cİy_äom_u£r
((*)&
mib_vif
, (*)
¬g
, 2)) {

423 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_MIB: Failedo copy in vif\n");

424  -
EFAULT
;

427 ià(
	`cİy_äom_u£r
((*)&
mib_d©a_Ëngth
, (*)(
¬g
 + 2), 4)) {

428 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_MIB: Failedo copy in mib_data_length\n");

429  -
EFAULT
;

432 ià(
	`cİy_äom_u£r
((*)&
mib_d©a_size
, (*)(
¬g
 + 6), 4)) {

433 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_MIB: Failedo copy in mib_data_size\n");

434  -
EFAULT
;

437 ià(
	`uÆik–y
(
mib_d©a_Ëngth
 > 
UDI_MIB_SET_LEN_MAX
 || 
mib_d©a_size
 > UDI_MIB_SET_LEN_MAX)) {

438 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_MIB: siztoØlÚg (mib_d©a_Ëngth:%u mib_d©a_size:%u)\n", 
mib_d©a_Ëngth
, 
mib_d©a_size
);

439  -
EFAULT
;

442 
mib_d©a
 = 
	`km®loc
(
mib_d©a_size
, 
GFP_KERNEL
);

443 ià(!
mib_d©a
) {

444 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_MIB: Failedo‡llocate memory for mib_data\n");

445  -
ENOMEM
;

448 ià(
	`cİy_äom_u£r
((*)
mib_d©a
, (*)(
¬g
 + 10), 
mib_d©a_Ëngth
)) {

449 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_MIB: Failedo copy in mib_data\n");

450 
	`kä“
(
mib_d©a
);

451  -
EFAULT
;

454 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

455 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
mib_vif
);

456 ià(
mib_vif
 !ğ0 && !
dev
) {

457 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_MIB: Faed -‚‘_deviû i NULL fÜ iÁ”çû = %d\n", 
mib_vif
);

458 
	`kä“
(
mib_d©a
);

459 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

460  -
EFAULT
;

463 
r
 = 
	`¦si_mlme_£t
(
sdev
, 
dev
, 
mib_d©a
, 
mib_d©a_Ëngth
);

464 ià(
r
 != 0)

465 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_MIB: Faed - mlme_£t_»q : ResuÉ codğ%d\n", 
r
);

467 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

468 
	`kä“
(
mib_d©a
);

470  
r
;

471 
	}
}

473 
	$¦si_unifi_g‘_mib
(
¦si_dev
 *
sdev
, 
¬g
)

475 
Ãt_deviû
 *
dev
 = 
NULL
;

476 
r
 = 0;

477 
u32
 
mib_d©a_Ëngth
;

478 
u32
 
mib_d©a_size
;

479 *
mib_d©a
;

480 
u16
 
mib_vif
;

482 ià(
sdev
->
deviû_¡©e
 !ğ
SLSI_DEVICE_STATE_STARTED
) {

483 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: Device‚ot yet‡vailable\n");

484  -
EFAULT
;

488 ià(
	`cİy_äom_u£r
((*)&
mib_vif
, (*)
¬g
, 2)) {

489 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: Failedo copy in vif\n");

490  -
EFAULT
;

494 ià(
	`cİy_äom_u£r
((*)&
mib_d©a_Ëngth
, (*)(
¬g
 + 2), 4)) {

495 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: Failedo copy in mib_data_length\n");

496  -
EFAULT
;

500 ià(
	`cİy_äom_u£r
((*)&
mib_d©a_size
, (*)(
¬g
 + 6), 4)) {

501 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: Failedo copy in mib_data_size\n");

502  -
EFAULT
;

506 ià(
	`uÆik–y
(
mib_d©a_Ëngth
 > 
UDI_MIB_GET_LEN_MAX
 || 
mib_d©a_size
 > UDI_MIB_GET_LEN_MAX)) {

507 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: siztoØlÚg (mib_d©a_Ëngth:%u mib_d©a_size:%u)\n", 
mib_d©a_Ëngth
, 
mib_d©a_size
);

508  -
EFAULT
;

511 
mib_d©a
 = 
	`km®loc
(
mib_d©a_size
, 
GFP_KERNEL
);

512 ià(!
mib_d©a
) {

513 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: Failedo‡llocate memory for mib_data\n");

514  -
ENOMEM
;

517 ià(
	`cİy_äom_u£r
((*)
mib_d©a
, (*)(
¬g
 + 10), 
mib_d©a_Ëngth
)) {

518 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: Failedo copy in mib_data\n");

519 
	`kä“
(
mib_d©a
);

520  -
EFAULT
;

523 
	`SLSI_MUTEX_LOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

524 
dev
 = 
	`¦si_g‘_Ãtdev_locked
(
sdev
, 
mib_vif
);

525 ià(
mib_vif
 !ğ0 && !
dev
) {

526 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: Faed -‚‘_deviû i NULL fÜ iÁ”çû = %d\n", 
mib_vif
);

527 
	`kä“
(
mib_d©a
);

528 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

529  -
EFAULT
;

532 
r
 = 
	`¦si_mlme_g‘
(
sdev
, 
dev
, 
mib_d©a
, 
mib_d©a_Ëngth
, mib_d©a, 
mib_d©a_size
, &mib_data_length);

533 ià(
r
 != 0) {

534 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: Faed - mlme_g‘_»q : ResuÉ codğ%d\n", 
r
);

535 
	`kä“
(
mib_d©a
);

536 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

537  -
EINVAL
;

540 
	`SLSI_MUTEX_UNLOCK
(
sdev
->
Ãtdev_add_»move_mu‹x
);

543 ià(
mib_d©a_Ëngth
 > 
mib_d©a_size
) {

544 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: Mib„esuÉ d©¨i tØlÚg. (%d by‹ wh’hmax i %d by‹s)\n", 
mib_d©a_Ëngth
, 
mib_d©a_size
);

545 
	`kä“
(
mib_d©a
);

546  -
EINVAL
;

550 ià(
	`cİy_to_u£r
((*)
¬g
, (*)&
mib_d©a_Ëngth
, 4)) {

551 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: Failedo copy in mib_data_length backo user\n");

552 
	`kä“
(
mib_d©a
);

553  -
EFAULT
;

557 ià(
	`cİy_to_u£r
((*)(
¬g
 + 4), 
mib_d©a
, 
mib_d©a_Ëngth
)) {

558 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_MIB: Failedo copy in mib_data backo user\n");

559 
	`kä“
(
mib_d©a
);

560  -
EFAULT
;

562 
	`kä“
(
mib_d©a
);

564 
	}
}

566 
	$¦si_unifi_£t_log_mask
(
¦si_cdev_ş›Á
 *
ş›Á
, 
¦si_dev
 *
sdev
, 
¬g
)

568 
unifiio_f‹r_t
 
f‹r
;

569 
i
;

572 ià(
	`cİy_äom_u£r
(&
f‹r
, (*)
¬g
, (filter))) {

573 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_UDI_LOG_MASK: Failedo copy from userspace\n");

574  -
EFAULT
;

577 ià(
	`uÆik–y
(
f‹r
.
sigÇl_ids_n
 > 
UDI_LOG_MASK_FILTER_NUM_MAX
)) {

578 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_UDI_LOG_MASK:‚umber of filtersoo†ong\n");

579  -
EFAULT
;

582 ià(
f‹r
.
sigÇl_ids_n
) {

583 *
sigÇl_f‹r_šdex
;

584 
max
;

585 
mš
;

587 
max
 = 
f‹r
.
sigÇl_ids
[0];

588 
mš
 = 
f‹r
.
sigÇl_ids
[0];

591 
i
 = 0; i < 
f‹r
.
sigÇl_ids_n
; i++) {

592 ià(
f‹r
.
sigÇl_ids
[
i
] & 
UDI_MA_UNITDATA_FILTER_ALLOW_MASK
) {

593 
ş›Á
->
ma_un™d©a_f‹r_cÚfig
 |ğ
f‹r
.
sigÇl_ids
[
i
];

596 ià(
f‹r
.
sigÇl_ids
[
i
] > 
max
)

597 
max
 = 
f‹r
.
sigÇl_ids
[
i
];

598 ià(
f‹r
.
sigÇl_ids
[
i
] < 
mš
)

599 
mš
 = 
f‹r
.
sigÇl_ids
[
i
];

602 
sigÇl_f‹r_šdex
 = 
	`km®loc
(
max
 - 
mš
 + 1, 
GFP_KERNEL
);

603 ià(
sigÇl_f‹r_šdex
) {

604 
	`mem£t
(
sigÇl_f‹r_šdex
, 0, 
max
 - 
mš
 + 1);

605 
i
 = 0; i < 
f‹r
.
sigÇl_ids_n
; i++) {

606 ià(
f‹r
.
sigÇl_ids
[
i
] & 
UDI_MA_UNITDATA_FILTER_ALLOW_MASK
)

608 
sigÇl_f‹r_šdex
[
f‹r
.
sigÇl_ids
[
i
] - 
mš
] = 1;

610 
	`¦si_log_ş›Á_uÄegi¡”
(
sdev
, 
ş›Á
);

611 
	`¦si_log_ş›Á_»gi¡”
(
sdev
, 
ş›Á
,

612 
f‹r
.
log_li¡ed_æag
 ? 
£nd_sigÇl_to_šv”£_log_f‹r
 :

613 
£nd_sigÇl_to_log_f‹r
, 
sigÇl_f‹r_šdex
, 
mš
, 
max
);

615  -
ENOMEM
;

619 
	}
}

621 
	$¦si_cdev_ioùl
(
fe
 *
fp
, 
cmd
, 
¬g
)

623 
¦si_cdev_ş›Á
 *
ş›Á
 = (*)
fp
->
´iv©e_d©a
;

624 
¦si_dev
 *
sdev
;

625 
r
 = 0;

626 
št_·¿m
;

628 ià(!
ş›Á
 || !ş›Á->
ufcdev
)

629  -
EINVAL
;

630 
sdev
 = 
ş›Á
->
ufcdev
->sdev;

632 
	`¦si_wake_lock
(&
sdev
->
wÏn_wl
);

634 
cmd
) {

635 
UNIFI_GET_UDI_ENABLE
:

636 
št_·¿m
 = 
ş›Á
->
log_’abËd
;

637 
	`put_u£r
(
št_·¿m
, (*)
¬g
);

640 
UNIFI_SET_UDI_ENABLE
:

641 ià(
	`g‘_u£r
(
št_·¿m
, (*)
¬g
)) {

642 
r
 = -
EFAULT
;

646 ià(
št_·¿m
) {

647 
	`¦si_log_ş›Á_»gi¡”
(
sdev
, 
ş›Á
, 
udi_log_ev’t
, 
NULL
, 0, 0);

648 
ş›Á
->
log_’abËd
 = 1;

649 ià(
št_·¿m
 > 1)

650 
ş›Á
->
log_®low_driv”_sigÇls
 = 1;

652 
	`¦si_log_ş›Á_uÄegi¡”
(
sdev
, 
ş›Á
);

653 
ş›Á
->
log_’abËd
 = 0;

658 
UNIFI_SET_UDI_LOG_CONFIG
:

660 
unifiio_udi_cÚfig_t
 
cÚfig
;

662 ià(
	`cİy_äom_u£r
(&
cÚfig
, (*)
¬g
, (config))) {

663 
	`SLSI_ERR
(
sdev
, "UNIFI_SET_UDI_LOG_CONFIG: Failedo copy from userspace\n");

664 
r
 = -
EFAULT
;

668 
ş›Á
->
ma_un™d©a_size_lim™
 = 
cÚfig
.ma_unitdata_size_limit;

671 
UNIFI_SET_UDI_LOG_MASK
:

672 
r
 = 
	`¦si_unifi_£t_log_mask
(
ş›Á
, 
sdev
, 
¬g
);

675 
UNIFI_SET_MIB
:

676 
r
 = 
	`¦si_unifi_£t_mib
(
sdev
, 
¬g
);

679 
UNIFI_GET_MIB
:

680 
r
 = 
	`¦si_unifi_g‘_mib
(
sdev
, 
¬g
);

683 
UNIFI_SRC_SINK_IOCTL
:

684 ià(
sdev
->
deviû_¡©e
 !ğ
SLSI_DEVICE_STATE_STARTED
) {

685 
	`SLSI_ERR
(
sdev
, "UNIFI_SRC_SINK_IOCTL: Device‚ot yet‡vailable\n");

686 
r
 = -
EFAULT
;

689 
r
 = 
	`¦si_¤c_sšk_cdev_ioùl_cfg
(
sdev
, 
¬g
);

692 
UNIFI_SOFTMAC_CFG
:

694 
u32
 
soámac_cmd
;

695 
u8
 
cmd_·¿m_size
;

697 
	`SLSI_ERR
(
sdev
, "UNIFI_SOFTMAC_CFG\n");

699 ià(
	`cİy_äom_u£r
((*)&
soámac_cmd
, (*)
¬g
, 4)) {

700 
	`SLSI_ERR
(
sdev
, "Failedo gethe command\n");

701 
r
 = -
EFAULT
;

704 
	`SLSI_DBG3_NODEV
(
SLSI_UDI
, "soámac_cmd -> %u\n", 
soámac_cmd
);

706 
¬g
 +ğ(
soámac_cmd
);

707 ià(
	`cİy_äom_u£r
((*)&
cmd_·¿m_size
, (*)(
¬g
 + 4), 1)) {

708 
	`SLSI_ERR
(
sdev
, "Failedo gethe command size\n");

709 
r
 = -
EFAULT
;

712 
	`SLSI_DBG3_NODEV
(
SLSI_UDI
, "cmd_·¿m_siz-> %u\n", 
cmd_·¿m_size
);

714 ià(
cmd_·¿m_size
)

715 
ş›Á
->
ma_un™d©a_f‹r_cÚfig
 = 
UDI_MA_UNITDATA_FILTER_ALLOW_EAPOL_ID
;

717 
ş›Á
->
ma_un™d©a_f‹r_cÚfig
 = 0;

720 
UNIFI_GET_SW_VERSION
:

722 
»s
 = 0;

723 
bud_šfo
[200];

724 
Ën
 = 0;

725 #iâdeà
SLSI_TEST_DEV


726 
	`mem£t
(
bud_šfo
, 0, 200);

727 
	`mxmª_g‘_fw_v”siÚ
(
bud_šfo
, 200);

728 
Ën
 = 
	`¡¾’
(
bud_šfo
);

729 
	`¥rštf
(
bud_šfo
 + 
Ën
, " ");

730 ià(
Ën
 >= 197) {

731 
Ën
 = 197;

732 
bud_šfo
[
Ën
 - 1] = '.';

733 
bud_šfo
[
Ën
 - 2] = '.';

734 
bud_šfo
[
Ën
 - 3] = '.';

736 
	`mxmª_g‘_driv”_v”siÚ
(
bud_šfo
 + 
Ën
 + 1, 200 -†en - 1);

739 
	`mem£t
(
bud_šfo
, 0, 200);

740 
	`¡rıy
(
bud_šfo
, "UT Build");

743 
»s
 = 
	`cİy_to_u£r
((*)
¬g
, 
bud_šfo
, 200);

744 ià(
»s
) {

745 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_SW_VERSION:ƒ¼Ü backØu£¸%d\n", 
»s
);

746 
r
 = -
EINVAL
;

751 
UNIFI_GET_FAPI_VERSION
:

753 
»s
 = 0;

754 
çpi_šfo
[100];

756 
	`mem£t
(
çpi_šfo
, 0, 100);

757 
	`¦si_g‘_çpi_v”siÚ_¡ršg
(
çpi_šfo
);

759 
»s
 = 
	`cİy_to_u£r
((*)
¬g
, 
çpi_šfo
, 100);

760 ià(
»s
) {

761 
	`SLSI_ERR
(
sdev
, "UNIFI_GET_FAPI_VERSION:ƒ¼Ü backØu£¸%d\n", 
»s
);

762 
r
 = -
EINVAL
;

768 
	`SLSI_WARN
(
sdev
, "O³¿tiÚ (%dènÙ suµÜ‹d\n", 
cmd
);

769 
r
 = -
EINVAL
;

772 
	`¦si_wake_uÆock
(&
sdev
->
wÏn_wl
);

773  
r
;

774 
	}
}

776 
	$¦si_cdev_pŞl
(
fe
 *
fp
, 
pŞl_bË
 *
wa™
)

778 
¦si_cdev_ş›Á
 *
ş›Á
 = (*)
fp
->
´iv©e_d©a
;

780 
	`SLSI_DBG4_NODEV
(
SLSI_UDI
, "PŞl(%d)\n", 
	`skb_queue_Ën
(&
ş›Á
->
log_li¡
));

782 ià(
	`skb_queue_Ën
(&
ş›Á
->
log_li¡
))

783  
POLLIN
 | 
POLLRDNORM
;

785 
	`pŞl_wa™
(
fp
, &
ş›Á
->
log_wq
, 
wa™
);

787 ià(
	`skb_queue_Ën
(&
ş›Á
->
log_li¡
))

788  
POLLIN
 | 
POLLRDNORM
;

791 
	}
}

797 
	$£nd_sigÇl_to_log_f‹r
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
)

799 
»t
 = 0;

800 
u16
 
sigÇl_id
 = 
	`çpi_g‘_sigid
(
skb
);

802 ià(
sigÇl_id
 > 
log_ş›Á
->
max_sigÇl_id
 || sigÇl_id <†og_ş›Á->
mš_sigÇl_id
 || !log_ş›Á->
sigÇl_f‹r
[signal_id -†og_client->min_signal_id])

803 
»t
 = 
	`udi_log_ev’t
(
log_ş›Á
, 
skb
, 
dœ
);

805  
»t
;

806 
	}
}

808 
	$£nd_sigÇl_to_šv”£_log_f‹r
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
)

810 
»t
 = 0;

811 
u16
 
sigÇl_id
 = 
	`çpi_g‘_sigid
(
skb
);

813 ià(
sigÇl_id
 <ğ
log_ş›Á
->
max_sigÇl_id
 && sigÇl_id >ğlog_ş›Á->
mš_sigÇl_id
 &&†og_ş›Á->
sigÇl_f‹r
[signal_id -†og_client->min_signal_id])

814 
»t
 = 
	`udi_log_ev’t
(
log_ş›Á
, 
skb
, 
dœ
);

816  
»t
;

817 
	}
}

819 
boŞ
 
	$is_®lowed__äame
(
‘hhdr
 *
ehdr
, 
u16
 
sigÇl_id
)

821 
u8
 *
_äame
 = ((u8 *)
ehdr
è+ (
‘hhdr
);

822 
u8
 *
_d©a
;

823 
u16
 
_d©a_off£t
 = 20;

825 
u8
 
hËn
 = 
_äame
[0] & 0x0F;

831 
u8
 
_´Ùo
 = 
_äame
[9];

837 
	`SLSI_UNUSED_PARAMETER
(
sigÇl_id
);

839 ià(
hËn
 > 5)

840 
_d©a_off£t
 +ğ(
hËn
 - 5) * 4;

842 
_d©a
 = 
_äame
 + 
_d©a_off£t
;

844 
_´Ùo
) {

845 
SLSI_IP_TYPE_UDP
:

847 
u16
 
¤ıÜt
 = 
_d©a
[0] << 8 | ip_data[1];

848 
u16
 
d¡pÜt
 = 
_d©a
[2] << 8 | ip_data[3];

850 
	`SLSI_DBG3_NODEV
(
SLSI_UDI
, "FILTER(0x%.4XèKey -> PrÙo(0x%.4Xè-> IpPrÙo(%dè->UDP(s:%d, d:%d)\n", 
sigÇl_id
, 
	`Áohs
(
ehdr
->
h_´Ùo
), 
_´Ùo
, 
¤ıÜt
, 
d¡pÜt
);

851 ià(
¤ıÜt
 =ğ
SLSI_DHCP_CLIENT_PORT
 || srıÜˆ=ğ
SLSI_DHCP_SERVER_PORT
 ||

852 
d¡pÜt
 =ğ
SLSI_DHCP_CLIENT_PORT
 || d¡pÜˆ=ğ
SLSI_DHCP_SERVER_PORT
) {

853 
	`SLSI_DBG3_NODEV
(
SLSI_UDI
, "FILTER(0x%.4XèKey -> PrÙo(0x%.4Xè-> IpPrÙo(%dè->UDP(s:%d, d:%dèALLOW\n", 
sigÇl_id
, 
	`Áohs
(
ehdr
->
h_´Ùo
), 
_´Ùo
, 
¤ıÜt
, 
d¡pÜt
);

854  
Œue
;

861  
çl£
;

862 
	}
}

864 
	$udi_log_ev’t
(
¦si_log_ş›Á
 *
log_ş›Á
, 
sk_buff
 *
skb
, 
dœ
)

866 
¦si_cdev_ş›Á
 *
ş›Á
 = 
log_ş›Á
->
log_ş›Á_ùx
;

867 
udi_msg_t
 
msg
;

868 
udi_msg_t
 *
msg_skb
;

869 
u16
 
sigÇl_id
 = 
	`çpi_g‘_sigid
(
skb
);

871 ià(
	`WARN_ON
(!
ş›Á
))

872  -
EINVAL
;

873 ià(
	`WARN_ON
(!
skb
))

874  -
EINVAL
;

875 ià(
	`WARN_ON
(
skb
->
Ën
 == 0))

876  -
EINVAL
;

879 ià(
	`¦si_cdev_un™d©a_f‹r_®low
(
ş›Á
, 
UDI_MA_UNITDATA_FILTER_ALLOW_MASK
) &&

880 (
sigÇl_id
 =ğ
MA_UNITDATA_REQ
 || sigÇl_id =ğ
MA_UNITDATA_IND
)) {

881 
u16
 
äam‘y³
;

883 
	`SLSI_DBG4_NODEV
(
SLSI_UDI
, "FILTER(0x%.4X)\n", 
sigÇl_id
);

884 ià(
sigÇl_id
 =ğ
MA_UNITDATA_REQ
)

885 
äam‘y³
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_»q
.
d©a_un™_desütÜ
);

887 
äam‘y³
 = 
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_šd
.
d©a_un™_desütÜ
);

888 
	`SLSI_DBG4_NODEV
(
SLSI_UDI
, "FILTER(0x%.4Xèäam‘y³:%d\n", 
sigÇl_id
, 
äam‘y³
);

890 ià(
äam‘y³
 =ğ
FAPI_DATAUNITDESCRIPTOR_IEEE802_3_FRAME
) {

891 
‘hhdr
 *
ehdr
 = (‘hhd¸*)
	`çpi_g‘_d©a
(
skb
);

893 ià(
sigÇl_id
 =ğ
MA_UNITDATA_REQ
)

894 
ehdr
 = (
‘hhdr
 *)
	`çpi_g‘_d©a
(
skb
);

896 ià(
	`¦si_cdev_un™d©a_f‹r_®low
(
ş›Á
, 
UDI_MA_UNITDATA_FILTER_ALLOW_EAPOL_ID
) ||

897 
	`¦si_cdev_un™d©a_f‹r_®low
(
ş›Á
, 
UDI_MA_UNITDATA_FILTER_ALLOW_KEY_ID
)) {

898 
	`SLSI_DBG4_NODEV
(
SLSI_UDI
, "FILTER(0x%.4XèE­ -> PrÙo(0x%.4X)\n", 
sigÇl_id
, 
	`Áohs
(
ehdr
->
h_´Ùo
));

899 
	`Áohs
(
ehdr
->
h_´Ùo
)) {

900 
ETH_P_PAE
:

901 
ETH_P_WAI
:

902 
	`SLSI_DBG4_NODEV
(
SLSI_UDI
, "FILTER(0x%.4XèE­ -> PrÙo(0x%.4XèALLOW\n", 
sigÇl_id
, 
	`Áohs
(
ehdr
->
h_´Ùo
));

903 
®low_äame
;

909 ià(
	`¦si_cdev_un™d©a_f‹r_®low
(
ş›Á
, 
UDI_MA_UNITDATA_FILTER_ALLOW_KEY_ID
)) {

910 
	`SLSI_DBG4_NODEV
(
SLSI_UDI
, "FILTER(0x%.4XèKey -> PrÙo(0x%.4X)\n", 
sigÇl_id
, 
	`Áohs
(
ehdr
->
h_´Ùo
));

911 
	`Áohs
(
ehdr
->
h_´Ùo
)) {

912 
ETH_P_ARP
:

913 
	`SLSI_DBG4_NODEV
(
SLSI_UDI
, "FILTER(0x%.4XèKey -> PrÙo(0x%.4Xè-> A½ ALLOW\n", 
sigÇl_id
, 
	`Áohs
(
ehdr
->
h_´Ùo
));

914 
®low_äame
;

915 
ETH_P_IP
:

916 ià(
	`is_®lowed__äame
(
ehdr
, 
sigÇl_id
))

917 
®low_äame
;

923 ià(
äam‘y³
 =ğ
FAPI_DATAUNITDESCRIPTOR_IEEE802_11_FRAME
)

924 ià(
	`¦si_cdev_un™d©a_f‹r_®low
(
ş›Á
, 
UDI_MA_UNITDATA_FILTER_ALLOW_MGT_ID
))

925 ià(
	`›“80211_is_mgmt
(
	`çpi_g‘_mgmt
(
skb
)->
äame_cÚŒŞ
))

926 
®low_äame
;

928 
	`SLSI_DBG4_NODEV
(
SLSI_UDI
, "FILTER(0x%.4XèDROP\n", 
sigÇl_id
);

930 ià(
	`down_š‹¼u±ibË
(&
ş›Á
->
log_mu‹x
)) {

931 
	`SLSI_WARN_NODEV
("Failedo get udi sem\n");

932  -
ERESTARTSYS
;

934 ià(
ş›Á
->
log_drİ_d©a_·ck‘s
)

935 
ş›Á
->
log_drİ³d_d©a
++;

936 
	`up
(&
ş›Á
->
log_mu‹x
);

937  -
ECANCELED
;

943 ià(
sigÇl_id
 =ğ
MA_UNITDATA_CFM
 && 
	`¦si_cdev_un™d©a_f‹r_®low
(
ş›Á
, 
UDI_MA_UNITDATA_FILTER_ALLOW_CFM_ERROR_ID
))

944 ià(
	`çpi_g‘_u16
(
skb
, 
u
.
ma_un™d©a_cfm
.
ŒªsmissiÚ_¡©us
è=ğ
FAPI_TRANSMISSIONSTATUS_SUCCESSFUL
)

945  -
ECANCELED
;

951 ià(
dœ
 =ğ
UDI_CONFIG_IND
)

952 
®low_cÚfig_äame
;

954 
®low_äame
:

955 ià(
	`down_š‹¼u±ibË
(&
ş›Á
->
log_mu‹x
)) {

956 
	`SLSI_WARN_NODEV
("Failedo get udi sem\n");

957  -
ERESTARTSYS
;

961 ià(
ş›Á
->
log_drİ³d
) {

962 ià(
	`skb_queue_Ën
(&
ş›Á
->
log_li¡
è<ğ
UDI_RESTART_QUEUED_FRAMES
) {

963 
u32
 
drİ³d
 = 
ş›Á
->
log_drİ³d
;

965 
	`SLSI_WARN_NODEV
("Stİ Drİpšg UDI F¿me : %d f¿me Drİ³d\n", 
drİ³d
);

966 
ş›Á
->
log_drİ³d
 = 0;

967 
	`up
(&
ş›Á
->
log_mu‹x
);

968 
	`¦si_k”Ãl_to_u£r_¥aû_ev’t
(
log_ş›Á
, 
UDI_DRV_DROPPED_FRAMES
, (
u32
), (
u8
 *)&
drİ³d
);

969  -
ECANCELED
;

971 
ş›Á
->
log_drİ³d
++;

972 
	`up
(&
ş›Á
->
log_mu‹x
);

973  -
ECANCELED
;

974 } ià(!
ş›Á
->
log_drİ³d
 && 
	`skb_queue_Ën
(&ş›Á->
log_li¡
è>ğ
UDI_MAX_QUEUED_FRAMES
) {

975 
	`SLSI_WARN_NODEV
("Start Dropping UDI Frames\n");

976 
ş›Á
->
log_drİ³d
++;

977 
	`up
(&
ş›Á
->
log_mu‹x
);

978  -
ECANCELED
;

986 ià(
ş›Á
->
log_drİ_d©a_·ck‘s
 && 
	`skb_queue_Ën
(&ş›Á->
log_li¡
è< 
UDI_RESTART_QUEUED_DATA_FRAMES
) {

987 
u32
 
drİ³d
 = 
ş›Á
->
log_drİ³d_d©a
;

989 
	`SLSI_WARN_NODEV
("Stİ Drİpšg UDI F¿me : %d BasiøD©¨äame Drİ³d\n", 
ş›Á
->
log_drİ³d_d©a
);

990 
ş›Á
->
log_drİ_d©a_·ck‘s
 = 
çl£
;

991 
ş›Á
->
ma_un™d©a_f‹r_cÚfig
 = 0;

992 
ş›Á
->
log_drİ³d_d©a
 = 0;

993 
	`up
(&
ş›Á
->
log_mu‹x
);

994 
	`¦si_k”Ãl_to_u£r_¥aû_ev’t
(
log_ş›Á
, 
UDI_DRV_DROPPED_DATA_FRAMES
, (
u32
), (
u8
 *)&
drİ³d
);

995  -
ECANCELED
;

996 } ià(!
ş›Á
->
log_drİ_d©a_·ck‘s
 && 
	`skb_queue_Ën
(&ş›Á->
log_li¡
è>ğ
UDI_MAX_QUEUED_DATA_FRAMES
 && !
	`¦si_cdev_un™d©a_f‹r_®low
(ş›Á, 
UDI_MA_UNITDATA_FILTER_ALLOW_MASK
)) {

997 
	`SLSI_WARN_NODEV
("Start Dropping UDI Basic Data Frames\n");

998 
ş›Á
->
log_drİ_d©a_·ck‘s
 = 
Œue
;

999 
ş›Á
->
ma_un™d©a_f‹r_cÚfig
 = 
UDI_MA_UNITDATA_FILTER_ALLOW_MGT_ID
 |

1000 
UDI_MA_UNITDATA_FILTER_ALLOW_KEY_ID
 |

1001 
UDI_MA_UNITDATA_FILTER_ALLOW_CFM_ERROR_ID
 |

1002 
UDI_MA_UNITDATA_FILTER_ALLOW_EAPOL_ID
;

1004 
	`up
(&
ş›Á
->
log_mu‹x
);

1006 
®low_cÚfig_äame
:

1007 ià((
sigÇl_id
 =ğ
MA_UNITDATA_REQ
 || sigÇl_id =ğ
MA_UNITDATA_IND
) &&

1008 (
ş›Á
->
ma_un™d©a_size_lim™
è&& (
skb
->
Ën
 > client->ma_unitdata_size_limit)) {

1009 
¦si_skb_cb
 *
cb
;

1010 
sk_buff
 *
skb2
 = 
	`®loc_skb
((
msg
è+ 
ş›Á
->
ma_un™d©a_size_lim™
, 
GFP_ATOMIC
);

1012 ià(
	`WARN_ON
(!
skb2
))

1013  -
ENOMEM
;

1015 
	`skb_»£rve
(
skb2
, (
msg
));

1016 
cb
 = 
	`¦si_skb_cb_š™
(
skb2
);

1017 
cb
->
sig_Ëngth
 = 
	`çpi_g‘_sigËn
(
skb
);

1018 
cb
->
d©a_Ëngth
 = 
ş›Á
->
ma_un™d©a_size_lim™
;

1019 
	`skb_cİy_b™s
(
skb
, 0, 
	`skb_put
(
skb2
, 
ş›Á
->
ma_un™d©a_size_lim™
), client->ma_unitdata_size_limit);

1020 
skb
 = 
skb2
;

1022 
skb
 = 
	`skb_cİy_ex·nd
(skb, (
msg
), 0, 
GFP_ATOMIC
);

1023 ià(
	`WARN_ON
(!
skb
))

1024  -
ENOMEM
;

1027 
msg
.
Ëngth
 = (msgè+ 
skb
->
Ën
;

1028 
msg
.
time¡amp
 = 
	`ktime_to_ms
(
	`ktime_g‘
());

1029 
msg
.
dœeùiÚ
 = 
dœ
;

1030 
msg
.
sigÇl_Ëngth
 = 
	`çpi_g‘_sigËn
(
skb
);

1032 
msg_skb
 = (
udi_msg_t
 *)
	`skb_push
(
skb
, (
msg
));

1033 *
msg_skb
 = 
msg
;

1035 
	`skb_queue_
(&
ş›Á
->
log_li¡
, 
skb
);

1038 
	`wake_up_š‹¼u±ibË
(&
ş›Á
->
log_wq
);

1041 
	}
}

1043 
	#UF_DEVICE_CREATE
(
_şass
, 
_·»Á
, 
_devno
, 
_´iv
, 
_fmt
, 
_¬gs
) \

1044 
	`deviû_ü—‹
(
_şass
, 
_·»Á
, 
_devno
, 
_´iv
, 
_fmt
, 
_¬gs
)

	)

1046 cÚ¡ 
fe_İ”©iÚs
 
	g¦si_cdev_fİs
 = {

1047 .
owÃr
 = 
THIS_MODULE
,

1048 .
	gİ’
 = 
¦si_cdev_İ’
,

1049 .
	g»Ëa£
 = 
¦si_cdev_»Ëa£
,

1050 .
	g»ad
 = 
¦si_cdev_»ad
,

1051 .
	gwr™e
 = 
¦si_cdev_wr™e
,

1052 .
	guÆocked_ioùl
 = 
¦si_cdev_ioùl
,

1053 .
	gcom·t_ioùl
 = 
¦si_cdev_ioùl
,

1054 .
	gpŞl
 = 
¦si_cdev_pŞl
,

1057 
	#UF_DEVICE_CREATE
(
_şass
, 
_·»Á
, 
_devno
, 
_´iv
, 
_fmt
, 
_¬gs
) \

1058 
	`deviû_ü—‹
(
_şass
, 
_·»Á
, 
_devno
, 
_´iv
, 
_fmt
, 
_¬gs
)

	)

1060 #iâdeà
SLSI_TEST_DEV


1061 
	$¦si_g‘_mšÜ
()

1063 
mšÜ
;

1065 
mšÜ
 = 0; mšÜ < 
SLSI_UDI_MINOR_NODES
; minor++)

1066 ià(!
uf_cdevs
[
mšÜ
])

1067  
mšÜ
;

1069 
	}
}

1072 
	$¦si_cdev_ü—‹
(
¦si_dev
 *
sdev
, 
deviû
 *
·»Á
)

1074 
dev_t
 
devno
;

1075 
»t
;

1076 
¦si_cdev
 *
pdev
;

1077 
mšÜ
;

1079 
	`SLSI_DBG3_NODEV
(
SLSI_UDI
, "\n");

1080 #ifdeà
SLSI_TEST_DEV


1083 
¦si_‹¡_dev
 *
uáe¡dev
 = (¦si_‹¡_dev *)
sdev
->
maxw–l_cÜe
;

1085 
mšÜ
 = 
uáe¡dev
->
deviû_mšÜ_numb”
;

1086 ià(
mšÜ
 >ğ0 && mšÜ < 
SLSI_UDI_MINOR_NODES
 && 
uf_cdevs
[minor])

1087  -
EINVAL
;

1090 
mšÜ
 = 
	`¦si_g‘_mšÜ
();

1092 ià(
mšÜ
 >ğ
SLSI_UDI_MINOR_NODES
 || minor < 0) {

1093 
	`SLSI_ERR
(
sdev
, "nØmšÜ‚umb” avaabË,mšÜ:%d\n", 
mšÜ
);

1094  -
ENOMEM
;

1097 
pdev
 = 
	`km®loc
((*pdev), 
GFP_KERNEL
);

1098 ià(!
pdev
)

1099  -
ENOMEM
;

1100 
	`mem£t
(
pdev
, 0, (*pdev));

1102 
	`cdev_š™
(&
pdev
->
cdev
, &
¦si_cdev_fİs
);

1103 
pdev
->
cdev
.
owÃr
 = 
THIS_MODULE
;

1104 
pdev
->
mšÜ
 = minor;

1105 
devno
 = 
	`MKDEV
(
	`MAJOR
(
majÜ_numb”
), 
mšÜ
);

1106 
»t
 = 
	`cdev_add
(&
pdev
->
cdev
, 
devno
, 1);

1107 ià(
»t
) {

1108 
	`SLSI_ERR
(
sdev
, "cdev_add faed w™h %d fÜ mšÜ %d\n", 
»t
, 
mšÜ
);

1109 
	`kä“
(
pdev
);

1110  
»t
;

1113 
pdev
->
sdev
 = sdev;

1114 
pdev
->
·»Á
 =…arent;

1115 ià(!
	`UF_DEVICE_CREATE
(
şass
, 
pdev
->
·»Á
, 
devno
,…dev, 
UDI_CHAR_DEVICE_NAME
 "%d", 
mšÜ
)) {

1116 
	`cdev_d–
(&
pdev
->
cdev
);

1117 
	`kä“
(
pdev
);

1118  -
EINVAL
;

1120 
sdev
->
uf_cdev
 = (*)
pdev
;

1121 
sdev
->
´ocfs_š¡ªû
 = 
mšÜ
;

1122 
uf_cdevs
[
mšÜ
] = 
pdev
;

1125 
	}
}

1127 
	$¦si_cdev_de¡roy
(
¦si_dev
 *
sdev
)

1129 
¦si_cdev
 *
pdev
 = (¦si_cdev *)
sdev
->
uf_cdev
;

1130 
kobjeù
 *
kobj
;

1131 
k»f
 *kref;

1133 ià(!
pdev
)

1136 
	`SLSI_DBG1
(
sdev
, 
SLSI_UDI
, "\n");

1137 
	`¦si_check_cdev_»fs
()) {

1138 
	`SLSI_ERR
(
sdev
, "UDI Client still‡ttached. Please Terminate!\n");

1139 
	`m¦“p
(1000);

1159 
kobj
 = &
pdev
->
cdev
.kobj;

1160 
k»f
 = &
kobj
->kref;

1161 #ià(
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(4, 11, 0))

1162 
	`»fcouÁ_»ad
(&
k»f
->
»fcouÁ
) > 1) {

1163 
	`SLSI_WARN
(
sdev
, "UDI cl›Á Fİ„–—£‚Ù com¶‘ed y‘! (couÁ=%d)\n", 
	`»fcouÁ_»ad
(&
k»f
->
»fcouÁ
));

1164 
	`m¦“p
(50);

1167 
	`©omic_»ad
(&
k»f
->
»fcouÁ
) > 1) {

1168 
	`SLSI_WARN
(
sdev
, "UDI cl›Á Fİ„–—£‚Ù com¶‘ed y‘! (couÁ=%d)\n", 
	`©omic_»ad
(&
k»f
->
»fcouÁ
));

1169 
	`m¦“p
(50);

1172 
	`deviû_de¡roy
(
şass
, 
pdev
->
cdev
.
dev
);

1173 
	`cdev_d–
(&
pdev
->
cdev
);

1174 
sdev
->
uf_cdev
 = 
NULL
;

1175 
uf_cdevs
[
pdev
->
mšÜ
] = 
NULL
;

1176 
	`kä“
(
pdev
);

1177 
	}
}

1179 
	gudi_š™Ÿli£d
;

1181 
	$¦si_udi_š™
()

1183 
»t
;

1185 
	`SLSI_DBG1_NODEV
(
SLSI_UDI
, "\n");

1186 
	`mem£t
(
uf_cdevs
, 0, (uf_cdevs));

1189 
»t
 = 
	`®loc_chrdev_»giÚ
(&
majÜ_numb”
, 0, 
SLSI_UDI_MINOR_NODES
, 
UDI_CLASS_NAME
);

1190 ià(
»t
) {

1191 
	`SLSI_ERR_NODEV
("FaedØadd‡Îoødev‚umb”s: %d\n", 
»t
);

1192  
»t
;

1196 
şass
 = 
	`şass_ü—‹
(
THIS_MODULE
, 
UDI_CLASS_NAME
);

1197 ià(
	`IS_ERR
(
şass
)) {

1198 
	`SLSI_ERR_NODEV
("Failedo create driver udi class\n");

1199 
	`uÄegi¡”_chrdev_»giÚ
(
majÜ_numb”
, 
SLSI_UDI_MINOR_NODES
);

1200 
majÜ_numb”
 = 0;

1201  -
EINVAL
;

1204 
udi_š™Ÿli£d
 = 1;

1207 
	}
}

1209 
	$¦si_udi_deš™
()

1211 ià(!
udi_š™Ÿli£d
)

1213 
	`SLSI_DBG1_NODEV
(
SLSI_UDI
, "\n");

1214 
	`şass_de¡roy
(
şass
);

1215 
	`uÄegi¡”_chrdev_»giÚ
(
majÜ_numb”
, 
SLSI_UDI_MINOR_NODES
);

1216 
udi_š™Ÿli£d
 = 0;

1218 
	}
}

1220 
	$¦si_udi_node_š™
(
¦si_dev
 *
sdev
, 
deviû
 *
·»Á
)

1222  
	`¦si_cdev_ü—‹
(
sdev
, 
·»Á
);

1223 
	}
}

1225 
	$¦si_udi_node_deš™
(
¦si_dev
 *
sdev
)

1227 
	`¦si_cdev_de¡roy
(
sdev
);

1229 
	}
}

	@udi.h

7 #iâdeà
__SLSI_UDI_H__


8 
	#__SLSI_UDI_H__


	)

10 
	~"dev.h
"

12 #ifdeà
SLSI_TEST_DEV


17 
	#SLSI_UDI_MINOR_NODES
 20

	)

20 
	#SLSI_UDI_MINOR_NODES
 2

	)

23 
¦si_udi_node_š™
(
¦si_dev
 *
sdev
, 
deviû
 *
·»Á
);

24 
¦si_udi_node_deš™
(
¦si_dev
 *
sdev
);

26 
¦si_udi_š™
();

27 
¦si_udi_deš™
();

28 
¦si_k”Ãl_to_u£r_¥aû_ev’t
(
¦si_log_ş›Á
 *
log_ş›Á
, 
u16
 
ev’t
, 
u32
 
d©a_Ëngth
, cÚ¡ 
u8
 *
d©a
);

29 
¦si_check_cdev_»fs
();

	@unifiio.h

8 #iâdeà
__UNIFIIO_H__


9 
	#__UNIFIIO_H__


	)

11 
	~<lšux/ty³s.h
>

16 #ifdeà
__KERNEL__


17 
	~<lšux/sock‘.h
>

18 
	~<lšux/ty³s.h
>

20 
	~<sys/sock‘.h
>

21 
	~<¡dboŞ.h
>

23 
	~<lšux/if.h
>

25 #ifdeà
__ılu¥lus


29 
	#UNIFI_GET_UDI_ENABLE
 
	`_IOR
('u', 1, )

	)

30 
	#UNIFI_SET_UDI_ENABLE
 
	`_IOW
('u', 2, )

	)

32 
	#UDI_ENABLE_DATA
 0x1

	)

33 
	#UDI_ENABLE_CONTROL
 0x2

	)

36 
	#UNIFI_GET_MIB
 
	`_IOWR
('u', 3, )

	)

37 
	#UNIFI_SET_MIB
 
	`_IOW
('u', 4, )

	)

38 
	#MAX_MIB_DATA_LENGTH
 2048

	)

41 
	#SIOCIWS80211POWERSAVEPRIV
 
SIOCIWFIRSTPRIV


	)

42 
	#SIOCIWG80211POWERSAVEPRIV
 (
SIOCIWFIRSTPRIV
 + 1)

	)

43 
	#SIOCIWS80211RELOADDEFAULTSPRIV
 (
SIOCIWFIRSTPRIV
 + 2)

	)

44 
	#SIOCIWSCONFWAPIPRIV
 (
SIOCIWFIRSTPRIV
 + 4)

	)

45 
	#SIOCIWSWAPIKEYPRIV
 (
SIOCIWFIRSTPRIV
 + 6)

	)

46 
	#SIOCIWSSMEDEBUGPRIV
 (
SIOCIWFIRSTPRIV
 + 8)

	)

47 
	#SIOCIWSAPCFGPRIV
 (
SIOCIWFIRSTPRIV
 + 10)

	)

48 
	#SIOCIWSAPSTARTPRIV
 (
SIOCIWFIRSTPRIV
 + 12)

	)

49 
	#SIOCIWSAPSTOPPRIV
 (
SIOCIWFIRSTPRIV
 + 14)

	)

50 
	#SIOCIWSFWRELOADPRIV
 (
SIOCIWFIRSTPRIV
 + 16)

	)

51 
	#SIOCIWSSTACKSTART
 (
SIOCIWFIRSTPRIV
 + 18)

	)

52 
	#SIOCIWSSTACKSTOP
 (
SIOCIWFIRSTPRIV
 + 20)

	)

54 
	#IWPRIV_POWER_SAVE_MAX_STRING
 32

	)

55 
	#IWPRIV_SME_DEBUG_MAX_STRING
 32

	)

56 
	#IWPRIV_SME_MAX_STRING
 120

	)

59 
	#UNIFI_CFG
 
	`_IOWR
('u', 5, [4])

	)

83 
	#UNIFI_BUILD_TYPE
 
	`_IOWR
('u', 7, )

	)

85 
	#UNIFI_BUILD_NME
 1

	)

86 
	#UNIFI_BUILD_WEXT
 2

	)

87 
	#UNIFI_BUILD_AP
 3

	)

90 
	#UNIFI_SET_DEBUG
 
	`_IO
('u', 0x11)

	)

91 
	#UNIFI_SET_TRACE
 
	`_IO
('u', 0x12)

	)

93 
	#UNIFI_GET_INIT_STATUS
 
	`_IOR
('u', 0x15, )

	)

94 
	#UNIFI_SET_UDI_LOG_CONFIG
 
	`_IOR
('u', 0x16, 
unifiio_udi_cÚfig_t
)

	)

95 
	#UNIFI_SET_UDI_LOG_MASK
 
	`_IOR
('u', 0x18, 
unifiio_f‹r_t
)

	)

97 
	#UNIFI_INIT_HW
 
	`_IOR
('u', 0x13, )

	)

98 
	#UNIFI_INIT_NETDEV
 
	`_IOW
('u', 0x14, [6])

	)

99 
	#UNIFI_SME_PRESENT
 
	`_IOW
('u', 0x19, )

	)

101 
	#UNIFI_CFG_PERIOD_TRAFFIC
 
	`_IOW
('u', 0x21, [4])

	)

102 
	#UNIFI_CFG_UAPSD_TRAFFIC
 
	`_IOW
('u', 0x22, )

	)

104 
	#UNIFI_SOFTMAC_CFG
 
	`_IOWR
('u', 0x30, [4])

	)

106 
	#UNIFI_NETDEV_CFG
 
	`_IOWR
('u', 0x31, 
unifiio_Ãtdev_cfg_t
)

	)

107 
	#UNIFI_STREAM_CFG
 
	`_IOWR
('u', 0x32, 
unifiio_¡»am_cfg_t
)

	)

108 
	#UNIFI_AMSDU_CFG
 
	`_IOWR
('u', 0x33, 
unifiio_amsdu_cfg_t
)

	)

109 
	#UNIFI_BA_CFG
 
	`_IOWR
('u', 0x34, 
unifiio_ba_cfg_t
)

	)

110 
	#UNIFI_SUSPEND_RESUME_CFG
 
	`_IOWR
('u', 0x35, 
unifiio_su¥’d_»sume_cfg_t
)

	)

111 
	#UNIFI_SRC_SINK_IOCTL
 
	`_IOWR
('u', 0x41, 
unifiio_¤c_sšk_¬g_t
)

	)

112 
	#UNIFI_GET_FAPI_VERSION
 
	`_IOWR
('u', 0x42, [200])

	)

113 
	#UNIFI_GET_SW_VERSION
 
	`_IOWR
('u', 0x43, [200])

	)

115 
	#¤c_sšk_aùiÚ
 
ušt16_t


	)

116 
	#SRC_SINK_ACTION_NONE
 ((
¤c_sšk_aùiÚ
)0x0000)

	)

117 
	#SRC_SINK_ACTION_ENABLE_BA
 ((
¤c_sšk_aùiÚ
)0x0001)

	)

118 
	#SRC_SINK_ACTION_SINK_START
 ((
¤c_sšk_aùiÚ
)0x0002)

	)

119 
	#SRC_SINK_ACTION_SINK_STOP
 ((
¤c_sšk_aùiÚ
)0x0003)

	)

120 
	#SRC_SINK_ACTION_GEN_START
 ((
¤c_sšk_aùiÚ
)0x0004)

	)

121 
	#SRC_SINK_ACTION_GEN_STOP
 ((
¤c_sšk_aùiÚ
)0x0005)

	)

122 
	#SRC_SINK_ACTION_SINK_REPORT
 ((
¤c_sšk_aùiÚ
)0x0006)

	)

123 
	#SRC_SINK_ACTION_GEN_REPORT
 ((
¤c_sšk_aùiÚ
)0x0007)

	)

124 
	#SRC_SINK_ACTION_SINK_REPORT_CACHED
 ((
¤c_sšk_aùiÚ
)0x0008)

	)

125 
	#SRC_SINK_ACTION_GEN_REPORT_CACHED
 ((
¤c_sšk_aùiÚ
)0x0009)

	)

126 
	#SRC_SINK_ACTION_LOOPBACK_START
 ((
¤c_sšk_aùiÚ
)0x000A)

	)

127 
	#SRC_SINK_ACTION_LOOPBACK_STOP
 ((
¤c_sšk_aùiÚ
)0x000B)

	)

129 
	#¤c_sšk_dœeùiÚ
 
ušt16_t


	)

130 
	#SRC_SINK_DIRECTION_TX
 ((
¤c_sšk_dœeùiÚ
)0x0000)

	)

131 
	#SRC_SINK_DIRECTION_RX
 ((
¤c_sšk_dœeùiÚ
)0x0001)

	)

133 
	#¤c_sšk_’dpošt
 
ušt16_t


	)

134 
	#SRC_SINK_ENDPOINT_HOSTIO
 ((
¤c_sšk_’dpošt
)0x0000)

	)

135 
	#SRC_SINK_ENDPOINT_MACRAME
 ((
¤c_sšk_’dpošt
)0x0001)

	)

137 
	sunifiio_¤c_sšk_»pÜt
 {

139 
ušt32_t
 
time
;

141 
ušt32_t
 
š‹rv®
;

144 
ušt32_t
 
time¡amp
;

146 
ušt32_t
 
du¿tiÚ
;

148 
ušt32_t
 
couÁ
;

150 
ušt32_t
 
où‘
;

152 
ušt32_t
 
kbps
;

154 
ušt16_t
 
idË_¿tio
;

155 
ušt16_t
 
š‹¼u±_Ï‹ncy
;

156 
ušt16_t
 
ä“_kby‹s
;

158 
ušt32_t
 
çed_couÁ
;

162 
	sunifiio_¤c_sšk_g’_cÚfig
 {

163 
ušt16_t
 
size
;

164 
ušt16_t
 
u£_¡»amšg
;

165 
ušt16_t
 
pkts_³r_šŒ
;

166 
ušt32_t
 
v4_de¡
;

170 
	sunifiio_¤c_sšk_cÚfig
 {

171 
ušt32_t
 
š‹rv®
;

172 
ušt16_t
 
pkts_³r_št
;

174 
unifiio_¤c_sšk_g’_cÚfig
 
g’
;

175 } 
u
;

179 
	sunifiio_¤c_sšk_commÚ
 {

181 
¤c_sšk_aùiÚ
 
aùiÚ
;

182 
ušt16_t
 
vif
;

183 
¤c_sšk_dœeùiÚ
 
dœeùiÚ
;

184 
¤c_sšk_’dpošt
 
’dpošt
;

187 
	sunifiio_¤c_sšk_¬g_t
 {

189 
unifiio_¤c_sšk_commÚ
 
commÚ
;

191 
unifiio_¤c_sšk_cÚfig
 
cÚfig
;

192 
unifiio_¤c_sšk_»pÜt
 
»pÜt
;

193 } 
u
;

197 
	sudi_msg_t
 {

199 
Ëngth
;

202 
time¡amp
;

205 
dœeùiÚ
;

206 
	#UDI_FROM_HOST
 0

	)

207 
	#UDI_TO_HOST
 1

	)

208 
	#UDI_CONFIG_IND
 2

	)

211 
sigÇl_Ëngth
;

219 
	#UDI_MA_UNITDATA_FILTER_ALLOW_MASK
 0x8000

	)

220 
	#UDI_MA_UNITDATA_FILTER_ALLOW_MGT_ID
 0x8001

	)

221 
	#UDI_MA_UNITDATA_FILTER_ALLOW_KEY_ID
 0x8002

	)

222 
	#UDI_MA_UNITDATA_FILTER_ALLOW_CFM_ERROR_ID
 0x8004

	)

223 
	#UDI_MA_UNITDATA_FILTER_ALLOW_EAPOL_ID
 0x8008

	)

230 
	#UDI_DRV_SIGNAL_BASE
 0xA000

	)

231 
	#UDI_DRV_UNLOAD_IND
 (
UDI_DRV_SIGNAL_BASE
 + 1)

	)

232 
	#UDI_DRV_DROPPED_FRAMES
 (
UDI_DRV_SIGNAL_BASE
 + 2)

	)

233 
	#UDI_DRV_DROPPED_DATA_FRAMES
 (
UDI_DRV_SIGNAL_BASE
 + 3)

	)

234 
	#UDI_DRV_SUSPEND_IND
 (
UDI_DRV_SIGNAL_BASE
 + 4)

	)

235 
	#UDI_DRV_RESUME_IND
 (
UDI_DRV_SIGNAL_BASE
 + 5)

	)

237 
	sunifiio_udi_cÚfig_t
 {

238 
ušt16_t
 
ma_un™d©a_size_lim™
;

241 
	sunifiio_f‹r_t
 {

242 
ušt16_t
 
log_li¡ed_æag
;

243 
ušt16_t
 
sigÇl_ids_n
;

244 
ušt16_t
 
sigÇl_ids
[5];

247 
	#unifi_cfg_commªd
 
ušt32_t


	)

248 
	#UNIFI_CFG_GET
 ((
unifi_cfg_commªd
)0)

	)

249 
	#UNIFI_CFG_POWER
 ((
unifi_cfg_commªd
)1)

	)

250 
	#UNIFI_CFG_POWERSAVE
 ((
unifi_cfg_commªd
)2)

	)

251 
	#UNIFI_CFG_FILTER
 ((
unifi_cfg_commªd
)3)

	)

252 
	#UNIFI_CFG_POWERSUPPLY
 ((
unifi_cfg_commªd
)4)

	)

253 
	#UNIFI_CFG_WMM_QOSINFO
 ((
unifi_cfg_commªd
)5)

	)

254 
	#UNIFI_CFG_WMM_ADDTS
 ((
unifi_cfg_commªd
)6)

	)

255 
	#UNIFI_CFG_WMM_DELTS
 ((
unifi_cfg_commªd
)7)

	)

256 
	#UNIFI_CFG_STRICT_DRAFT_N
 ((
unifi_cfg_commªd
)8)

	)

257 
	#UNIFI_CFG_SET_AP_CONFIG
 ((
unifi_cfg_commªd
)9)

	)

258 
	#UNIFI_CFG_CORE_DUMP
 ((
unifi_cfg_commªd
)10)

	)

260 
	#unifi_cfg_pow”
 
ušt32_t


	)

261 
	#UNIFI_CFG_POWER_UNSPECIFIED
 ((
unifi_cfg_pow”
)0)

	)

262 
	#UNIFI_CFG_POWER_OFF
 ((
unifi_cfg_pow”
)1)

	)

263 
	#UNIFI_CFG_POWER_ON
 ((
unifi_cfg_pow”
)2)

	)

265 
	#unifi_cfg_pow”suµly
 
ušt32_t


	)

266 
	#UNIFI_CFG_POWERSUPPLY_UNSPECIFIED
 ((
unifi_cfg_pow”suµly
)0)

	)

267 
	#UNIFI_CFG_POWERSUPPLY_MAINS
 ((
unifi_cfg_pow”suµly
)1)

	)

268 
	#UNIFI_CFG_POWERSUPPLY_BATTERIES
 ((
unifi_cfg_pow”suµly
)2)

	)

270 
	#unifi_cfg_pow”§ve
 
ušt32_t


	)

271 
	#UNIFI_CFG_POWERSAVE_UNSPECIFIED
 ((
unifi_cfg_pow”§ve
)0)

	)

272 
	#UNIFI_CFG_POWERSAVE_NONE
 ((
unifi_cfg_pow”§ve
)1)

	)

273 
	#UNIFI_CFG_POWERSAVE_FAST
 ((
unifi_cfg_pow”§ve
)2)

	)

274 
	#UNIFI_CFG_POWERSAVE_FULL
 ((
unifi_cfg_pow”§ve
)3)

	)

275 
	#UNIFI_CFG_POWERSAVE_AUTO
 ((
unifi_cfg_pow”§ve
)4)

	)

277 
	#unifi_cfg_g‘
 
ušt32_t


	)

278 
	#UNIFI_CFG_GET_COEX
 ((
unifi_cfg_g‘
)0)

	)

279 
	#UNIFI_CFG_GET_POWER_MODE
 ((
unifi_cfg_g‘
)1)

	)

280 
	#UNIFI_CFG_GET_VERSIONS
 ((
unifi_cfg_g‘
)2)

	)

281 
	#UNIFI_CFG_GET_POWER_SUPPLY
 ((
unifi_cfg_g‘
)3)

	)

282 
	#UNIFI_CFG_GET_INSTANCE
 ((
unifi_cfg_g‘
)4)

	)

283 
	#UNIFI_CFG_GET_AP_CONFIG
 ((
unifi_cfg_g‘
)5)

	)

285 
	#UNIFI_CFG_FILTER_NONE
 0x0000

	)

286 
	#UNIFI_CFG_FILTER_DHCP
 0x0001

	)

287 
	#UNIFI_CFG_FILTER_ARP
 0x0002

	)

288 
	#UNIFI_CFG_FILTER_NBNS
 0x0004

	)

289 
	#UNIFI_CFG_FILTER_NBDS
 0x0008

	)

290 
	#UNIFI_CFG_FILTER_CUPS
 0x0010

	)

291 
	#UNIFI_CFG_FILTER_ALL
 0xFFFF

	)

293 
	#uf_cfg_·ck‘_f‹r_ty³
 
ušt32_t


	)

294 
	#UNIFI_CFG_FILTER_TYPE_NONE
 ((
uf_cfg_·ck‘_f‹r_ty³
)0)

	)

295 
	#UNIFI_CFG_FILTER_TYPE_ACTIVE_HOST
 ((
uf_cfg_·ck‘_f‹r_ty³
)1)

	)

296 
	#UNIFI_CFG_FILTER_TYPE_SUSPENDED_HOST
 ((
uf_cfg_·ck‘_f‹r_ty³
)2)

	)

298 
	suf_cfg_bÿ¡_·ck‘_f‹r
 {

299 
f‹r_mode
;

300 
uf_cfg_·ck‘_f‹r_ty³
 
·ck‘_f‹r_ty³
;

301 
¬p_f‹r
;

302 
dhı_f‹r
;

303 
tşas_›s_Ëngth
;

304 
tşas_›s
[1];

307 
	suf_cfg_­_cÚfig
 {

308 
ušt8_t
 
phySuµÜ‹dB™m­
;

309 
ušt8_t
 
chªÃl
;

310 
ušt16_t
 
b—cÚIÁ”v®
;

311 
ušt8_t
 
dtimP”iod
;

312 
boŞ
 
wmmEÇbËd
;

313 
ušt8_t
 
shÜtSlÙTimeEÇbËd
;

314 
ušt16_t
 
groupkeyTimeout
;

315 
boŞ
 
¡riùGtkRekeyEÇbËd
;

316 
ušt16_t
 
gmkTimeout
;

317 
ušt16_t
 
»¥Ú£Timeout
;

318 
ušt8_t
 
»ŒªsLim™
;

319 
ušt8_t
 
rxStbc
;

320 
boŞ
 
rifsModeAÎowed
;

321 
ušt8_t
 
du®CtsPrÙeùiÚ
;

322 
ušt8_t
 
ùsPrÙeùiÚTy³
;

323 
ušt16_t
 
maxLi¡’IÁ”v®
;

326 
	sc¤_wifi_cfg_cÛx_šfo
 {

327 
boŞ
 
hasT¿fficD©a
;

328 
ušt8_t
 
cu¼’tT¿fficTy³
;

329 
ušt16_t
 
cu¼’tP”iodMs
;

330 
ušt8_t
 
cu¼’tPow”Save
;

331 
ušt16_t
 
cu¼’tCÛxP”iodMs
;

332 
ušt16_t
 
cu¼’tCÛxL©’cyMs
;

333 
boŞ
 
hasBtDeviû
;

334 
ušt32_t
 
cu¼’tBÏckOutDu¿tiÚUs
;

335 
ušt32_t
 
cu¼’tBÏckOutP”iodUs
;

336 
ušt8_t
 
cu¼’tCÛxScheme
;

339 
	stı_şsä
 {

340 
__u8
 
şs_ä_ty³
;

341 
__u8
 
şs_ä_mask
;

342 
__u8
 
v”siÚ
;

343 
__u8
 
sourû__addr
[4];

344 
__u8
 
de¡__addr
[4];

345 
__u16
 
sourû_pÜt
;

346 
__u16
 
de¡_pÜt
;

347 
__u8
 
dsı
;

348 
__u8
 
´ÙocŞ
;

349 
__u8
 
»£rved
;

350 } 
__·cked
;

351 
	#tı_şsä_t
 
tı_şsä


	)

353 
	stşas
 {

354 
__u8
 
–em’t_id
;

355 
__u8
 
Ëngth
;

356 
__u8
 
u£r_´iÜ™y
;

357 
tı_şsä_t
 
tı__şs_ä
;

358 } 
__·cked
;

360 
	#CONFIG_IND_ERROR
 0x01

	)

361 
	#CONFIG_IND_EXIT
 0x02

	)

362 
	#CONFIG_SME_NOT_PRESENT
 0x10

	)

363 
	#CONFIG_SME_PRESENT
 0x20

	)

393 
	sunifiio_Ãtdev_cfg_t
 {

394 
ušt8_t
 
İ”©iÚ
;

396 
š‹rçûTag
;

397 
ušt8_t
 
vif_šdex
;

398 
ušt8_t
 
š‹rçûMode
;

399 
maÿddr
[6];

400 
Çme
[
IFNAMSIZ
];

401 
³”_maÿddr
[6];

402 
ušt16_t
 
assocŸtiÚ_id
;

405 
	#unifiio_¡»am_cfg_İ”©iÚ_ty³
 
ušt32_t


	)

406 
	#UNIFI_CFG_STREAM_OPERATION_TYPE_NONE
 ((
unifiio_¡»am_cfg_İ”©iÚ_ty³
)0)

	)

407 
	#UNIFI_CFG_STREAM_OPERATION_TYPE_CREATE
 ((
unifiio_¡»am_cfg_İ”©iÚ_ty³
)1)

	)

408 
	#UNIFI_CFG_STREAM_OPERATION_TYPE_STOP
 ((
unifiio_¡»am_cfg_İ”©iÚ_ty³
)2)

	)

409 
	#UNIFI_CFG_STREAM_OPERATION_TYPE_DELETE
 ((
unifiio_¡»am_cfg_İ”©iÚ_ty³
)3)

	)

411 
	sunifiio_¡»am_cfg_t
 {

412 
unifiio_¡»am_cfg_İ”©iÚ_ty³
 
İ”©iÚ
;

413 
š‹rçûTag
;

414 
³”_maÿddr
[6];

415 
ušt16_t
 
tId
;

416 
ušt16_t
 
hªdË
;

417 
ušt16_t
 
size
;

420 
	#unifiio_amsdu_cfg_İ”©iÚ_ty³
 
ušt32_t


	)

421 
	#UNIFI_CFG_AMSDU_OPERATION_TYPE_SET_MAX_SIZE
 ((
unifiio_amsdu_cfg_İ”©iÚ_ty³
)0)

	)

423 
	sunifiio_amsdu_cfg_t
 {

424 
unifiio_amsdu_cfg_İ”©iÚ_ty³
 
İ”©iÚ
;

425 
š‹rçûTag
;

426 
³”_maÿddr
[6];

427 
ušt16_t
 
size
;

430 
	#unifiio_ba_cfg_İ”©iÚ_ty³
 
ušt32_t


	)

431 
	#UNIFI_CFG_BA_SESSION_STOP
 ((
unifiio_ba_cfg_İ”©iÚ_ty³
)0)

	)

432 
	#UNIFI_CFG_BA_SESSION_START
 ((
unifiio_ba_cfg_İ”©iÚ_ty³
)1)

	)

434 
	sunifiio_ba_cfg_t
 {

435 
unifiio_ba_cfg_İ”©iÚ_ty³
 
İ”©iÚ
;

436 
š‹rçûTag
;

437 
³”_maÿddr
[6];

438 
ušt16_t
 
tId
;

439 
ušt8_t
 
rŞe
;

440 
ušt16_t
 
wšdow_size
;

441 
ušt16_t
 
s¢
;

444 
	#unifiio_su¥’d_»sume_cfg_İ”©iÚ_ty³
 
ušt32_t


	)

445 
	#UNIFI_CFG_SUSPEND
 ((
unifiio_su¥’d_»sume_cfg_İ”©iÚ_ty³
)0)

	)

446 
	#UNIFI_CFG_RESUME
 ((
unifiio_su¥’d_»sume_cfg_İ”©iÚ_ty³
)1)

	)

447 
	#UNIFI_CFG_WAIT_FOR_RESUME
 ((
unifiio_su¥’d_»sume_cfg_İ”©iÚ_ty³
)2)

	)

449 
	sunifiio_su¥’d_»sume_cfg_t
 {

450 
unifiio_su¥’d_»sume_cfg_İ”©iÚ_ty³
 
İ”©iÚ
;

451 
timeout_ms
;

454 #ifdeà
__ılu¥lus


	@utils.h

7 #iâdeà
SLSI_UTILS_H__


8 
	#SLSI_UTILS_H__


	)

10 
	~<lšux/v”siÚ.h
>

11 
	~<lšux/ty³s.h
>

12 
	~<lšux/¥šlock.h
>

13 
	~<lšux/wÜkqueue.h
>

14 
	~<lšux/skbuff.h
>

15 
	~<Ãt/cfg80211.h
>

17 
	~"Ãtif.h
"

18 
	~"çpi.h
"

20 
	s¦si_skb_cb
 {

21 
u32
 
	msig_Ëngth
;

22 
u32
 
	md©a_Ëngth
;

23 
u32
 
	mäame_fÜm©
;

24 #ifdeà
CONFIG_SCSC_SMAPPER


25 
boŞ
 
	mä“_ma_un™d©
;

26 
sk_buff
 *
	mskb_addr
;

28 
boŞ
 
	mwakeup
;

30 
	gÃtdev_vif
;

32 
šlše
 
¦si_skb_cb
 *
	$¦si_skb_cb_g‘
(
sk_buff
 *
skb
)

34  (
¦si_skb_cb
 *)
skb
->
cb
;

35 
	}
}

37 
šlše
 
¦si_skb_cb
 *
	$¦si_skb_cb_š™
(
sk_buff
 *
skb
)

39 
	`BUILD_BUG_ON
((
¦si_skb_cb
è> (
skb
->
cb
));

41 
	`mem£t
(
skb
->
cb
, 0, (
¦si_skb_cb
));

42  
	`¦si_skb_cb_g‘
(
skb
);

43 
	}
}

45 
	#çpi_®loc
(
mp_Çme
, 
mp_id
, 
mp_vif
, 
mp_d©®’
è
	`çpi_®loc_f
(
	`çpi_sig_size
(mp_Çme), mp_d©®’, mp_id, mp_vif, 
__FILE__
, 
__LINE__
)

	)

46 
	#çpi_g‘_buff
(
mp_skb
, 
mp_Çme
è(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çme)

	)

47 
	#çpi_g‘_u16
(
mp_skb
, 
mp_Çme
è
	`Ë16_to_ıu
(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çme)

	)

48 
	#çpi_g‘_u32
(
mp_skb
, 
mp_Çme
è
	`Ë32_to_ıu
(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çme)

	)

49 
	#çpi_g‘_u64
(
mp_skb
, 
mp_Çme
è
	`Ë64_to_ıu
(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çme)

	)

50 
	#çpi_£t_u16
(
mp_skb
, 
mp_Çme
, 
mp_v®ue
è(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çmğ
	`ıu_to_Ë16
(mp_v®ue))

	)

51 
	#çpi_£t_u32
(
mp_skb
, 
mp_Çme
, 
mp_v®ue
è(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çmğ
	`ıu_to_Ë32
(mp_v®ue))

	)

52 
	#çpi_g‘_s16
(
mp_skb
, 
mp_Çme
è((
s16
)
	`Ë16_to_ıu
(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çme))

	)

53 
	#çpi_g‘_s32
(
mp_skb
, 
mp_Çme
è((
s32
)
	`Ë32_to_ıu
(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çme))

	)

54 
	#çpi_£t_s16
(
mp_skb
, 
mp_Çme
, 
mp_v®ue
è(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çmğ
	`ıu_to_Ë16
((
u16
)mp_v®ue))

	)

55 
	#çpi_£t_s32
(
mp_skb
, 
mp_Çme
, 
mp_v®ue
è(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çmğ
	`ıu_to_Ë32
((
u32
)mp_v®ue))

	)

56 
	#çpi_£t_memıy
(
mp_skb
, 
mp_Çme
, 
mp_v®ue
è
	`memıy
(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çme, mp_v®ue, (((çpi_sigÇÈ*)(mp_skb)->d©a)->mp_Çme))

	)

57 
	#çpi_£t_mem£t
(
mp_skb
, 
mp_Çme
, 
mp_v®ue
è
	`mem£t
(((
çpi_sigÇl
 *)(mp_skb)->
d©a
)->mp_Çme, mp_v®ue, (((çpi_sigÇÈ*)(mp_skb)->d©a)->mp_Çme))

	)

60 
	#çpi_g‘_high16_u32
(
mp_skb
, 
mp_Çme
è((
	`çpi_g‘_u32
((mp_skb), mp_Çmeè& 0xffff0000è>> 16)

	)

61 
	#çpi_£t_high16_u32
(
mp_skb
, 
mp_Çme
, 
mp_v®ue
è
	`çpi_£t_u32
((mp_skb), mp_Çme, (
	`çpi_g‘_u32
((mp_skb), mp_Çmeè& 0xffffè| ((mp_v®ueè<< 16))

	)

62 
	#çpi_g‘_low16_u32
(
mp_skb
, 
mp_Çme
è(
	`çpi_g‘_u32
((mp_skb), mp_Çmeè& 0xffff)

	)

63 
	#çpi_£t_low16_u32
(
mp_skb
, 
mp_Çme
, 
mp_v®ue
è
	`çpi_£t_u32
((mp_skb), mp_Çme, (
	`çpi_g‘_u32
((mp_skb), mp_Çmeè& 0xffff0000è| (mp_v®ue))

	)

65 
	#çpi_g‘_sigËn
(
mp_skb
è(
	`¦si_skb_cb_g‘
(mp_skb)->
sig_Ëngth
)

	)

66 
	#çpi_g‘_d©®’
(
mp_skb
è(
	`¦si_skb_cb_g‘
(mp_skb)->
d©a_Ëngth
 - slsi_skb_cb_g‘(mp_skb)->
sig_Ëngth
)

	)

67 
	#çpi_g‘_d©a
(
mp_skb
è(mp_skb->
d©a
 + 
	`çpi_g‘_sigËn
(mp_skb))

	)

68 
	#çpi_g‘_vif
(
mp_skb
è
	`Ë16_to_ıu
(((
çpi_vif_sigÇl_h—d”
 *)(mp_skb)->
d©a
)->
vif
)

	)

71 
	#çpi_g‘_mgmt
(
mp_skb
è((
›“80211_mgmt
 *)
	`çpi_g‘_d©a
(mp_skb))

	)

72 
	#çpi_g‘_mgm’
(
mp_skb
è
	`çpi_g‘_d©®’
(mp_skb)

	)

74 
šlše
 
sk_buff
 *
	$çpi_®loc_f
(
size_t
 
sig_size
, size_ˆ
d©a_size
, 
u16
 
id
, u16 
vif
, cÚ¡ *
fe
, 
lše
)

76 
sk_buff
 *
skb
 = 
NULL
;

77 
çpi_vif_sigÇl_h—d”
 *
h—d”
;

79 ià(
	`WARN_ON
(
	`š_š‹¼u±
()))

80  
NULL
;

81 
skb
 = 
	`®loc_skb
(
sig_size
 + 
d©a_size
, 
GFP_KERNEL
);

82 
	`WARN_ON
(
sig_size
 < (
çpi_sigÇl_h—d”
));

83 ià(
	`WARN_ON
(!
skb
))

84  
NULL
;

86 
	`¦si_skb_cb_š™
(
skb
)->
sig_Ëngth
 = 
sig_size
;

87 
	`¦si_skb_cb_g‘
(
skb
)->
d©a_Ëngth
 = 
sig_size
;

89 
h—d”
 = (
çpi_vif_sigÇl_h—d”
 *)
	`skb_put
(
skb
, 
sig_size
);

90 
h—d”
->
id
 = 
	`ıu_to_Ë16
(id);

91 
h—d”
->
»ûiv”_pid
 = 0;

92 
h—d”
->
£nd”_pid
 = 0;

93 
h—d”
->
fw_»ã»nû
 = 0;

94 
h—d”
->
vif
 = vif;

95  
skb
;

96 
	}
}

98 
šlše
 
u8
 *
	$çpi_­³nd_d©a
(
sk_buff
 *
skb
, cÚ¡ 
u8
 *
d©a
, 
size_t
 
d©a_Ën
)

100 
u8
 *
p
;

102 ià(
	`WARN_ON
(
	`skb_room
(
skb
è< 
d©a_Ën
))

103  
NULL
;

105 
p
 = 
	`skb_put
(
skb
, 
d©a_Ën
);

106 
	`¦si_skb_cb_g‘
(
skb
)->
d©a_Ëngth
 +ğ
d©a_Ën
;

107 ià(
d©a
)

108 
	`memıy
(
p
, 
d©a
, 
d©a_Ën
);

109  
p
;

110 
	}
}

112 
šlše
 
u8
 *
	$çpi_­³nd_d©a_u32
(
sk_buff
 *
skb
, cÚ¡ 
u32
 
d©a
)

114 
__Ë32
 
v®
 = 
	`ıu_to_Ë32
(
d©a
);

116  
	`çpi_­³nd_d©a
(
skb
, (
u8
 *)&
v®
, (val));

117 
	}
}

119 
šlše
 
u8
 *
	$çpi_­³nd_d©a_u16
(
sk_buff
 *
skb
, cÚ¡ 
u16
 
d©a
)

121 
__Ë16
 
v®
 = 
	`ıu_to_Ë16
(
d©a
);

123  
	`çpi_­³nd_d©a
(
skb
, (
u8
 *)&
v®
, (val));

124 
	}
}

126 
šlše
 
u8
 *
	$çpi_­³nd_d©a_u8
(
sk_buff
 *
skb
, cÚ¡ 
u8
 
d©a
)

128 
u8
 
v®
 = 
d©a
;

130  
	`çpi_­³nd_d©a
(
skb
, (
u8
 *)&
v®
, (val));

131 
	}
}

133 
	#çpi_­³nd_d©a_boŞ
(
skb
, 
d©a
è
	`çpi_­³nd_d©a_u16
(skb, d©a)

	)

135 
šlše
 
u32
 
	$¦si_cÚv”t_v_d©a_to_v®ue
(
u8
 *
d©a
, 
u16
 
Ëngth
)

137 
u32
 
v®ue
 = 0;

138 
i
;

140 ià(
Ëngth
 > 4)

142 
i
 = 0; i < 
Ëngth
; i++)

143 
v®ue
 |ğ((
u32
)
d©a
[
i
]) << i * 8;

145  
v®ue
;

146 
	}
}

148 
šlše
 
	$¦si_cÚv”t_v_to_64b™_v®ue
(
u8
 *
d©a
, 
u16
 
Ëngth
, 
u32
 *
low”
, u32 *
high”
)

150 
i
;

152 *
low”
 = 0;

153 *
high”
 = 0;

154 ià(
Ëngth
 > 8)

156 
i
 = 0; i < 4 && i < 
Ëngth
; i++)

157 *
low”
 |ğ((
u32
)
d©a
[
i
]) << i * 8;

158 
i
 = 4; i < 8 && i < 
Ëngth
; i++)

159 *
high”
 |ğ((
u32
)
d©a
[
i
]) << (i - 4) * 8;

160 
	}
}

162 #ifdeà
__ılu¥lus


166 
	#SLSI_ETHER_COPY
(
d¡
, 
¤c
è
	`‘h”_addr_cİy
((d¡), (¤c))

	)

167 
	#SLSI_ETHER_EQUAL
(
mac1
, 
mac2
è
	`‘h”_addr_equ®
((mac1), (mac2))

	)

169 
ušt
 
¦si_sg_ho¡_®ign_mask
;

170 
	#SLSI_HIP_FH_SIG_PREAMBLE_LEN
 4

	)

171 
	#SLSI_SKB_GET_ALIGNMENT_OFFSET
(
skb
è(0)

	)

174 
	#SLSI_UNUSED_PARAMETER
(
x
è(()(x))

	)

177 
	#SLSI_ECR
(
func
) \

179 
_”r
 = (
func
); \

180 ià(
_”r
 != 0) { \

181 
	`SLSI_ERR_NODEV
("e=%d\n", 
_”r
); \

182  
_”r
; \

184 } 0)

	)

186 
	#SLSI_EC
(
func
) \

188 
_”r
 = (
func
); \

189 ià(
_”r
 != 0) { \

190 
	`SLSI_ERR_NODEV
("e=%d\n", 
_”r
); \

193 } 0)

	)

195 
	#SLSI_EC_GOTO
(
func
, 
”r
, 
Ïb–
) \

197 (
”r
èğ
func
; \

198 ià((
”r
) != 0) { \

199 
	`WARN_ON
(1); \

200 
	`SLSI_ERR
(
sdev
, "ç‡ˆlše:%d\n", 
__LINE__
); \

201 
Ïb–
; \

203 } 0)

	)

208 
	#SLSI_BUFF_LE_TO_U16
(
±r
è(((
u16
)((
u8
 *)ÕŒ))[0]è| ((u16)((u8 *)ÕŒ))[1]è<< 8)

	)

209 
	#SLSI_U16_TO_BUFF_LE
(
ušt
, 
±r
) \

211 
u32
 
loÿl_ušt_tmp
 = (
ušt
); \

212 ((
u8
 *)(
±r
))[0] = ((u8)((
loÿl_ušt_tmp
 & 0x00FF))); \

213 ((
u8
 *)(
±r
))[1] = ((u8)(
loÿl_ušt_tmp
 >> 8)); \

214 } 0)

	)

216 
	#SLSI_U32_TO_BUFF_LE
(
ušt
, 
±r
è((*(
u32
 *íŒèğ
	`ıu_to_Ë32
(ušt))

	)

218 
	#SLSI_BUFF_LE_TO_U16_P
(
ouut
, 
šput
) \

220 (
ouut
èğ(
u16
)((((u16)(
šput
)[1]) << 8) | ((u16)(input)[0])); \

221 (
šput
) += 2; \

222 } 0)

	)

224 
	#SLSI_BUFF_LE_TO_U32_P
(
ouut
, 
šput
) \

226 (
ouut
èğ
	`Ë32_to_ıu
(*(
u32
 *)
šput
); \

227 (
šput
) += 4; \

228 } 0)

	)

230 
	#SLSI_U16_TO_BUFF_LE_P
(
ouut
, 
šput
) \

232 (
ouut
)[0] = ((
u8
)((
šput
) & 0x00FF)); \

233 (
ouut
)[1] = ((
u8
)((
šput
) >> 8)); \

234 (
ouut
) += 2; \

235 } 0)

	)

237 
	#SLSI_U32_TO_BUFF_LE_P
(
ouut
, 
šput
) \

239 (*(
u32
 *)
ouut
èğ
	`ıu_to_Ë32
(
šput
); \

240 (
ouut
) += 4; \

241 } 0)

	)

244 #ifdeà
CONFIG_SCSC_WLAN_ANDROID


245 
	#¦si_wake_lock_š™
(
lock
, 
ty³
, 
Çme
è
	`wake_lock_š™
Öock,y³,‚ame)

	)

246 
	#¦si_wake_lock
(
lock
è
	`wake_lock
Öock)

	)

247 
	#¦si_wake_uÆock
(
lock
è
	`wake_uÆock
Öock)

	)

248 
	#¦si_wake_lock_timeout
(
lock
, 
timeout
è
	`wake_lock_timeout
Öock,imeout)

	)

249 
	#¦si_wake_lock_aùive
(
lock
è
	`wake_lock_aùive
Öock)

	)

250 
	#¦si_wake_lock_de¡roy
(
lock
è
	`wake_lock_de¡roy
Öock)

	)

252 
	#¦si_wake_lock_š™
(
lock
, 
ty³
, 
Çme
)

	)

253 
	#¦si_wake_lock
(
lock
)

	)

254 
	#¦si_wake_uÆock
(
lock
)

	)

255 
	#¦si_wake_lock_timeout
(
lock
, 
timeout
)

	)

256 
	#¦si_wake_lock_aùive
(
lock
è(
çl£
)

	)

257 
	#¦si_wake_lock_de¡roy
(
lock
)

	)

260 
	s¦si_¥šlock
 {

262 
¥šlock_t
 
	glock
;

263 
	gæags
;

267 
šlše
 
¦si_¥šlock_ü—‹
(
¦si_¥šlock
 *
lock
)

269 
¥š_lock_š™
(&
lock
->lock);

272 
šlše
 
¦si_¥šlock_lock
(
¦si_¥šlock
 *
lock
)

274 
¥š_lock_bh
(&
lock
->lock);

277 
šlše
 
¦si_¥šlock_uÆock
(
¦si_¥šlock
 *
lock
)

279 
¥š_uÆock_bh
(&
lock
->lock);

282 
	g¦si_dev
;

283 
	s¦si_skb_wÜk
 {

284 
¦si_dev
 *
	gsdev
;

285 
Ãt_deviû
 *
	gdev
;

286 
wÜkqueue_¡ruù
 *
	gwÜkqueue
;

287 
wÜk_¡ruù
 
	gwÜk
;

288 
sk_buff_h—d
 
	gqueue
;

289 
__rcu
 *
	gsync_±r
;

292 
šlše
 
¦si_skb_wÜk_š™
(
¦si_dev
 *
sdev
, 
Ãt_deviû
 *
dev
, 
¦si_skb_wÜk
 *
wÜk
,

293 cÚ¡ *
Çme
, (*
func
)(
wÜk_¡ruù
 *
wÜk
))

295 
rcu_assign_poš‹r
(
wÜk
->
sync_±r
, (*)
sdev
);

296 
	gwÜk
->
	gsdev
 = 
sdev
;

297 
	gwÜk
->
	gdev
 = 
dev
;

298 
skb_queue_h—d_š™
(&
wÜk
->
queue
);

299 
INIT_WORK
(&
wÜk
->wÜk, 
func
);

300 
	gwÜk
->
	gwÜkqueue
 = 
®loc_Üd”ed_wÜkqueue
(
Çme
, 0);

302 ià(!
	gwÜk
->
	gwÜkqueue
)

303  -
	gENOMEM
;

307 
šlše
 
¦si_skb_scheduË_wÜk
(
¦si_skb_wÜk
 *
wÜk
)

309 
queue_wÜk
(
wÜk
->
wÜkqueue
, &work->work);

312 
šlše
 
¦si_skb_wÜk_’queue_l
(
¦si_skb_wÜk
 *
wÜk
, 
sk_buff
 *
skb
)

314 *
	gsync_±r
;

316 
rcu_»ad_lock
();

318 
	gsync_±r
 = 
rcu_d”eã»nû
(
wÜk
->
sync_±r
);

320 ià(
WARN_ON
(!
sync_±r
)) {

321 
kä“_skb
(
skb
);

322 
rcu_»ad_uÆock
();

325 
skb_queue_
(&
wÜk
->
queue
, 
skb
);

326 
¦si_skb_scheduË_wÜk
(
wÜk
);

328 
rcu_»ad_uÆock
();

331 
šlše
 
sk_buff
 *
¦si_skb_wÜk_dequeue_l
(
¦si_skb_wÜk
 *
wÜk
)

333  
skb_dequeue
(&
wÜk
->
queue
);

336 
šlše
 
¦si_skb_wÜk_deš™
(
¦si_skb_wÜk
 *
wÜk
)

338 
rcu_»ad_lock
();

340 ià(
WARN_ON
(!
wÜk
->
sync_±r
)) {

341 
rcu_»ad_uÆock
();

345 
rcu_assign_poš‹r
(
wÜk
->
sync_±r
, 
NULL
);

346 
rcu_»ad_uÆock
();

348 
synchrÚize_rcu
();

349 
æush_wÜkqueue
(
wÜk
->
wÜkqueue
);

350 
de¡roy_wÜkqueue
(
wÜk
->
wÜkqueue
);

351 
	gwÜk
->
	gwÜkqueue
 = 
NULL
;

352 
skb_queue_purge
(&
wÜk
->
queue
);

355 
šlše
 
¦si_cfg80211_put_bss
(
why
 *why, 
cfg80211_bss
 *
bss
)

357 
cfg80211_put_bss
(
why
, 
bss
);

360 
	#¦si_skb_wÜk_’queue
(
wÜk_
, 
skb_
è
	`¦si_skb_wÜk_’queue_l
(wÜk_, skb_)

	)

361 
	#¦si_skb_wÜk_dequeue
(
wÜk_
è
	`¦si_skb_wÜk_dequeue_l
(wÜk_)

	)

363 
šlše
 
¦si_‘h_z”o_addr
(
u8
 *
addr
)

365 
mem£t
(
addr
, 0x00, 
ETH_ALEN
);

368 
šlše
 
¦si_‘h_brßdÿ¡_addr
(
u8
 *
addr
)

370 
mem£t
(
addr
, 0xff, 
ETH_ALEN
);

373 
šlše
 
¦si_¡r_to_št
(*
¡r
, *
»suÉ
)

375 
	gi
 = 0;

376 
	gsign
 = 1;

377 
	g”r
 = 0;

378 
	g»s
 = 0;

379 
	gdig™
 = 0;

381 ià(!
	g¡r
)

383 ià(*
	g¡r
 == '-') {

384 
sign
 = -1;

385 ++
	g¡r
;

386 } ià(*
	g¡r
 == '+') {

387 
sign
 = 1;

388 ++
	g¡r
;

391 *
	g»suÉ
 = 0;

392 ià((
	g¡r
[
i
] >ğ'0'è&& (
¡r
[i] <= '9')) {

393 
¡r
[
i
] >= '0' && str[i] <= '9') {

394 ià(
»s
 > 
INT_MAX
 / 10) {

395 
”r
 = 1;

398 
	g»s
 *= 10;

399 
	gdig™
 = 
¡r
[
i
] - '0';

401 ià(
	g»s
 > 
	gINT_MAX
 - 
	gdig™
) {

402 ià(
	gsign
 == -1) {

403 
»s
 +ğ
dig™
;

404 ià(-(
	g»s
è>ğ
INT_MIN
) {

407 
	g”r
 = 1;

411 
	g”r
 = 1;

415 
	g»s
 +ğ
dig™
;

416 
	gi
++;

419 ià(!
	g”r
)

420 *
	g»suÉ
 = ((
sign
 =ğ-1è? -(
»s
) :„es);

424  
	gi
;

427 
šlše
 
¦si_¡r_cmp
(cÚ¡ *
s1
, cÚ¡ *
s2
)

429 ià(!
	gs1
 && !
	gs2
)

431 ià(
	gs1
 && !
	gs2
)

433 ià(!
	gs1
 && 
	gs2
)

436  
¡rcmp
(
s1
, 
s2
);

439 
	#P80211_OUI_LEN
 3

	)

441 
	s›“80211_¢­_hdr
 {

442 
u8
 
	gd§p
;

443 
u8
 
	gs§p
;

444 
u8
 
	gù¾
;

445 
u8
 
	goui
[
P80211_OUI_LEN
];

446 } 
	g__·cked
;

448 
	smsdu_hdr
 {

449 
	gda
[
ETH_ALEN
];

450 
	g§
[
ETH_ALEN
];

451 
__be16
 
	gËngth
;

452 
›“80211_¢­_hdr
 
	g¢­
;

453 
__be16
 
	g‘h”_ty³
;

454 } 
	g__·cked
;

456 
	#ETHER_TYPE_SIZE
 2

	)

457 
	#MSDU_HLEN
 (
msdu_hdr
)

	)

458 
	#MSDU_LENGTH
 ((
›“80211_¢­_hdr
è+ (
__be16
))

	)

460 
šlše
 
¦si_skb_msdu_to_‘hhdr
(
sk_buff
 *
skb
)

462 
‘hhdr
 *
	g‘h
;

463 
msdu_hdr
 *
	gmsdu
;

465 
	gda
[
ETH_ALEN
];

466 
	g§
[
ETH_ALEN
];

467 
__be16
 
	g´Ùo
;

469 
	gmsdu
 = (
msdu_hdr
 *)
skb
->
d©a
;

470 
SLSI_ETHER_COPY
(
da
, 
msdu
->da);

471 
SLSI_ETHER_COPY
(
§
, 
msdu
->sa);

472 
	g´Ùo
 = 
msdu
->
‘h”_ty³
;

474 
skb_puÎ
(
skb
, 
MSDU_HLEN
);

476 
	g‘h
 = (
‘hhdr
 *)
skb_push
(
skb
, 
ETH_HLEN
);

478 
SLSI_ETHER_COPY
(
‘h
->
h_de¡
, 
da
);

479 
SLSI_ETHER_COPY
(
‘h
->
h_sourû
, 
§
);

480 
	g‘h
->
	gh_´Ùo
 = 
´Ùo
;

485 
šlše
 
¦si_skb_‘hhdr_to_msdu
(
sk_buff
 *
skb
)

487 
‘hhdr
 *
	g‘h
;

488 
msdu_hdr
 *
	gmsdu
;

489 
	gËn
;

490 
__be16
 
	g‘h”_ty³
;

492 ià(
skb_h—droom
(
skb
è< (
	gMSDU_HLEN
 - 
	gETH_HLEN
))

493  -
	gEINVAL
;

495 
	g‘h
 = 
‘h_hdr
(
skb
);

496 
	g‘h”_ty³
 = 
‘h
->
h_´Ùo
;

498 
	gËn
 = 
skb
->
Ën
;

500 
skb_puÎ
(
skb
, 
ETH_HLEN
);

502 
	gmsdu
 = (
msdu_hdr
 *)
skb_push
(
skb
, 
MSDU_HLEN
);

504 
SLSI_ETHER_COPY
(
msdu
->
da
, 
‘h
->
h_de¡
);

505 
SLSI_ETHER_COPY
(
msdu
->
§
, 
‘h
->
h_sourû
);

506 
	gmsdu
->
	gËngth
 = 
htÚs
(
Ën
 - 
ETH_HLEN
 + 
MSDU_LENGTH
);

507 
memıy
(&
msdu
->
¢­
, 
rfc1042_h—d”
, (
›“80211_¢­_hdr
));

508 
	gmsdu
->
	g‘h”_ty³
 = 
‘h”_ty³
;

513 
šlše
 
u32
 
¦si_g‘_ûÁ”_äeq1
(
¦si_dev
 *
sdev
, 
u16
 
chªn_šfo
, u16 
ûÁ”_äeq
)

515 
u32
 
	gûÁ”_äeq1
 = 0x0000;

517 
SLSI_UNUSED_PARAMETER
(
sdev
);

519 
	gchªn_šfo
 & 0xFF) {

521 
ûÁ”_äeq1
 = 
ûÁ”_äeq
 - 20 * ((
chªn_šfo
 & 0xFF00) >> 8) + 10;

524 
ûÁ”_äeq1
 = 
ûÁ”_äeq
 - 20 * ((
chªn_šfo
 & 0xFF00) >> 8) + 30;

529  
	gûÁ”_äeq1
;

538 
šlše
 
¡¹ošt
(cÚ¡ *
s
, *
»s
)

540 
	gba£
 = 10;

542 ià(
¡¾’
(
s
) > 2)

543 ià(
	gs
[0] =ğ'0' && (
s
[1] == 'x' || s[1] == 'X'))

544 
ba£
 = 16;

545  
k¡¹ošt
(
s
, 
ba£
, 
»s
);

548 
šlše
 
u8
 *
¦si_mem_dup
(u8 *
¤c
, 
size_t
 
Ën
)

550 
u8
 *
	gde¡
;

552 ià(!
	g¤c
 || !
	gËn
)

553  
	gNULL
;

555 
	gde¡
 = 
km®loc
(
Ën
, 
GFP_KERNEL
);

556 ià(!
	gde¡
)

557  
	gNULL
;

558 
memıy
(
de¡
, 
¤c
, 
Ën
);

559  
	gde¡
;

562 
šlše
 
¦si_g‘_¿ndom_by‹s
(
u8
 *
by‹_bufãr
, 
u32
 
bufãr_Ën
)

564  
g‘_¿ndom_by‹s
(
by‹_bufãr
, 
bufãr_Ën
);

567 
šlše
 
¦si_ut_Æa_g‘_u8
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
u8
 *
v®
)

569 ià(
Æa_Ën
(
©Œ
è>ğ(
u8
)) {

570 *
v®
 = 
Æa_g‘_u8
(
©Œ
);

573  -
	gEINVAL
;

576 
šlše
 
¦si_ut_Æa_g‘_u16
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
u16
 *
v®
)

578 ià(
Æa_Ën
(
©Œ
è>ğ(
u16
)) {

579 *
v®
 = 
Æa_g‘_u16
(
©Œ
);

582  -
	gEINVAL
;

586 
šlše
 
¦si_ut_Æa_g‘_u32
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
u32
 *
v®
)

588 ià(
Æa_Ën
(
©Œ
è>ğ(
u32
)) {

589 *
v®
 = 
Æa_g‘_u32
(
©Œ
);

592  -
	gEINVAL
;

595 
šlše
 
¦si_ut_Æa_g‘_u64
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
u64
 *
v®
)

597 ià(
Æa_Ën
(
©Œ
è>ğ(
u64
)) {

598 *
v®
 = 
Æa_g‘_u64
(
©Œ
);

601  -
	gEINVAL
;

605 
šlše
 
¦si_ut_Æa_g‘_s8
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
s8
 *
v®
)

607 ià(
Æa_Ën
(
©Œ
è>ğ(
s8
)) {

608 *
v®
 = 
Æa_g‘_s8
(
©Œ
);

611  -
	gEINVAL
;

614 
šlše
 
¦si_ut_Æa_g‘_s16
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
s16
 *
v®
)

616 ià(
Æa_Ën
(
©Œ
è>ğ(
s16
)) {

617 *
v®
 = 
Æa_g‘_s16
(
©Œ
);

620  -
	gEINVAL
;

623 
šlše
 
¦si_ut_Æa_g‘_s32
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
s32
 *
v®
)

625 ià(
Æa_Ën
(
©Œ
è>ğ(
s32
)) {

626 *
v®
 = 
Æa_g‘_s32
(
©Œ
);

629  -
	gEINVAL
;

632 
šlše
 
¦si_ut_Æa_g‘_s64
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
s64
 *
v®
)

634 ià(
Æa_Ën
(
©Œ
è>ğ(
s64
)) {

635 *
v®
 = 
Æa_g‘_s64
(
©Œ
);

638  -
	gEINVAL
;

641 
šlše
 
¦si_ut_Æa_g‘_be16
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
__be16
 *
v®
)

643 ià(
Æa_Ën
(
©Œ
è>ğ(
__be16
)) {

644 *
v®
 = 
Æa_g‘_be16
(
©Œ
);

647  -
	gEINVAL
;

650 
šlše
 
¦si_ut_Æa_g‘_be32
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
__be32
 *
v®
)

652 ià(
Æa_Ën
(
©Œ
è>ğ(
__be32
)) {

653 *
v®
 = 
Æa_g‘_be32
(
©Œ
);

656  -
	gEINVAL
;

659 
šlše
 
¦si_ut_Æa_g‘_be64
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
__be64
 *
v®
)

661 ià(
Æa_Ën
(
©Œ
è>ğ(
__be64
)) {

662 *
v®
 = 
Æa_g‘_be64
(
©Œ
);

665  -
	gEINVAL
;

668 
šlše
 
¦si_ut_Æa_g‘_Ë16
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
__Ë16
 *
v®
)

670 ià(
Æa_Ën
(
©Œ
è>ğ(
__Ë16
)) {

671 *
v®
 = 
Æa_g‘_Ë16
(
©Œ
);

674  -
	gEINVAL
;

677 
šlše
 
¦si_ut_Æa_g‘_Ë32
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
__Ë32
 *
v®
)

679 ià(
Æa_Ën
(
©Œ
è>ğ(
__Ë32
)) {

680 *
v®
 = 
Æa_g‘_Ë32
(
©Œ
);

683  -
	gEINVAL
;

686 
šlše
 
¦si_ut_Æa_g‘_Ë64
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
__Ë64
 *
v®
)

688 ià(
Æa_Ën
(
©Œ
è>ğ(
__Ë64
)) {

689 *
v®
 = 
Æa_g‘_Ë64
(
©Œ
);

692  -
	gEINVAL
;

695 
šlše
 
¦si_ut_Æa_g‘_d©a
(cÚ¡ 
Æ©Œ
 *
©Œ
, 
size_t
 
size
, *
v®
)

697 ià(
Æa_Ën
(
©Œ
è>ğ
size
) {

698 
memıy
(
v®
, 
Æa_d©a
(
©Œ
), 
size
);

701  -
	gEINVAL
;

704 
šlše
 
Ãt_deviû
 *
¦si_ndev_vif_2_Ãt_deviû
(
Ãtdev_vif
 *
ndev_vif
)

706 
	gadd»ss
 = ()
ndev_vif
;

707 
	goff£t
 = 
ALIGN
((
Ãt_deviû
), 
NETDEV_ALIGN
);

709 ià(
	gadd»ss
 < 
	goff£t
)

710  
	gNULL
;

711  (
	gÃt_deviû
 *)((*)
	gndev_vif
 - 
	goff£t
);

714 
šlše
 
g‘_k”Ãl_time¡amp
(*
time
)

716 
time¥ec64
 
	gtv
;

718 
ktime_g‘_ts64
(&
tv
);

719 
	gtime
[0] = 
tv
.
tv_£c
;

720 
	gtime
[1] = 
tv
.
tv_n£c
;

723 #ifdeà
__ılu¥lus


	@wl_result.h

9 #iâdeà
WL_RESULT_H__


10 
	#WL_RESULT_H__


	)

12 
	#C¤ResuÉ
 
u16


	)

14 
	#CSR_RESULT_SUCCESS
 ((
C¤ResuÉ
)0x0000)

	)

15 
	#CSR_RESULT_FAILURE
 ((
C¤ResuÉ
)0xffff)

	)

17 
	#CSR_WIFI_HIP_RESULT_INVALID_VALUE
 ((
C¤ResuÉ
)1è

	)

18 
	#CSR_WIFI_HIP_RESULT_NO_DEVICE
 ((
C¤ResuÉ
)2è

	)

19 
	#CSR_WIFI_HIP_RESULT_NO_SPACE
 ((
C¤ResuÉ
)3è

	)

20 
	#CSR_WIFI_HIP_RESULT_NO_MEMORY
 ((
C¤ResuÉ
)4è

	)

21 
	#CSR_WIFI_HIP_RESULT_RANGE
 ((
C¤ResuÉ
)5è

	)

22 
	#CSR_WIFI_HIP_RESULT_NOT_FOUND
 ((
C¤ResuÉ
)6è

	)

23 
	#CSR_WIFI_PS_RESULT_FULL
 ((
C¤ResuÉ
)7è

	)

24 
	#CSR_WIFI_PS_QSIG_NONE
 ((
C¤ResuÉ
)8è

	)

25 
	#CSR_WIFI_PS_QSIG_NO_SPACE
 ((
C¤ResuÉ
)9è

	)

26 
	#CSR_WIFI_PS_QS_PAUSED_UNTIL_BOT_UPDATE
 ((
C¤ResuÉ
)10è

	)

	@../../../misc/samsung/scsc/scsc_wlbtd.h

6 
	~<Ãt/g’‘lšk.h
>

7 
	~<scsc/scsc_logršg.h
>

8 
	~<scsc/scsc_mx.h
>

9 
	~<scsc/scsc_log_cŞËùÜ.h
>

12 
	#MEMDUMP_FILE_FOR_RECOVERY
 2

	)

14 
	#MEMDUMP_FILE_KERNEL_PANIC
 3

	)

21 
	e©Œibu‹s
 {

23 
	mATTR_UNSPEC
,

25 
	mATTR_STR
,

26 
	mATTR_INT
,

27 
	mATTR_PATH
,

28 
	mATTR_CONTENT
,

29 
	mATTR_INT8
,

32 
	m__ATTR_MAX
,

38 
	eev’ts
 {

40 
	mEVENT_UNSPEC
,

42 
	mEVENT_SCSC
,

43 
	mEVENT_SYSTEM_PROPERTY
,

44 
	mEVENT_WRITE_FILE
,

45 
	mEVENT_SABLE
,

46 #ià
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

47 
	mEVENT_CHIPSET_LOGGING
,

50 
	m__EVENT_MAX
,

53 
	escsc_wlbtd_»¥Ú£_codes
 {

56 
	mSCSC_WLBTD_ERR_PARSE_FAILED
,

59 
	mSCSC_WLBTD_FW_PANIC_TAR_GENERATED
,

60 
	mSCSC_WLBTD_FW_PANIC_ERR_SCRIPT_FILE_NOT_FOUND
,

61 
	mSCSC_WLBTD_FW_PANIC_ERR_NO_DEV
,

62 
	mSCSC_WLBTD_FW_PANIC_ERR_MMAP
,

63 
	mSCSC_WLBTD_FW_PANIC_ERR_SABLE_FILE
,

64 
	mSCSC_WLBTD_FW_PANIC_ERR_TAR
,

67 
	mSCSC_WLBTD_OTHER_SBL_GENERATED
,

68 
	mSCSC_WLBTD_OTHER_TAR_GENERATED
,

69 
	mSCSC_WLBTD_OTHER_ERR_SCRIPT_FILE_NOT_FOUND
,

70 
	mSCSC_WLBTD_OTHER_ERR_NO_DEV
,

71 
	mSCSC_WLBTD_OTHER_ERR_MMAP
,

72 
	mSCSC_WLBTD_OTHER_ERR_SABLE_FILE
,

73 
	mSCSC_WLBTD_OTHER_ERR_TAR
,

74 
	mSCSC_WLBTD_OTHER_IGNORE_TRIGGER
,

77 
	mSCSC_WLBTD_LAST_RESPONSE_CODE
,

80 cÚ¡ 
g’l_muÉiÿ¡_group
 
	gscsc_mcg½
[] = {

81 { .
Çme
 = "scsc_mdp_grp", },

84 
scsc_wlbtd_š™
();

85 
scsc_wlbtd_deš™
();

86 
ÿÎ_wlbtd
(cÚ¡ *
süt_·th
);

87 
wlbtd_wr™e_fe
(cÚ¡ *
·th
, cÚ¡ *
cÚ‹Á
);

88 #ià
defšed
(
SCSC_SEP_VERSION
) && SCSC_SEP_VERSION >= 12

89 
wlbtd_ch£t_loggšg
(cÚ¡ *
cÚ‹Á
, 
size_t
 
by‹s
, 
boŞ
 
ov”_mm­
);

91 
ÿÎ_wlbtd_§bË
(
u8
 
Œigg”_code
, 
u16
 
»asÚ_code
);

92 
scsc_wlbtd_wa™_fÜ_§bË_loggšg
();

93 
scsc_wlbtd_g‘_ªd_´št_bud_ty³
();

	@/usr/include/linux/errno.h

1 
	~<asm/”ºo.h
>

	@/usr/include/linux/fs.h

2 #iâdeà
_LINUX_FS_H


3 
	#_LINUX_FS_H


	)

13 
	~<lšux/lim™s.h
>

14 
	~<lšux/ioùl.h
>

15 
	~<lšux/ty³s.h
>

28 #undeà
NR_OPEN


29 
	#INR_OPEN_CUR
 1024

	)

30 
	#INR_OPEN_MAX
 4096

	)

32 
	#BLOCK_SIZE_BITS
 10

	)

33 
	#BLOCK_SIZE
 (1<<
BLOCK_SIZE_BITS
)

	)

35 
	#SEEK_SET
 0

	)

36 
	#SEEK_CUR
 1

	)

37 
	#SEEK_END
 2

	)

38 
	#SEEK_DATA
 3

	)

39 
	#SEEK_HOLE
 4

	)

40 
	#SEEK_MAX
 
SEEK_HOLE


	)

42 
	#RENAME_NOREPLACE
 (1 << 0è

	)

43 
	#RENAME_EXCHANGE
 (1 << 1è

	)

44 
	#RENAME_WHITEOUT
 (1 << 2è

	)

46 
	sfe_şÚe_¿nge
 {

47 
__s64
 
	m¤c_fd
;

48 
__u64
 
	m¤c_off£t
;

49 
__u64
 
	m¤c_Ëngth
;

50 
__u64
 
	mde¡_off£t
;

53 
	sf¡rim_¿nge
 {

54 
__u64
 
	m¡¬t
;

55 
__u64
 
	mËn
;

56 
__u64
 
	mmšËn
;

60 
	#FILE_DEDUPE_RANGE_SAME
 0

	)

61 
	#FILE_DEDUPE_RANGE_DIFFERS
 1

	)

64 
	sfe_dedu³_¿nge_šfo
 {

65 
__s64
 
	mde¡_fd
;

66 
__u64
 
	mde¡_off£t
;

67 
__u64
 
	mby‹s_dedu³d
;

74 
__s32
 
	m¡©us
;

75 
__u32
 
	m»£rved
;

79 
	sfe_dedu³_¿nge
 {

80 
__u64
 
	m¤c_off£t
;

81 
__u64
 
	m¤c_Ëngth
;

82 
__u16
 
	mde¡_couÁ
;

83 
__u16
 
	m»£rved1
;

84 
__u32
 
	m»£rved2
;

85 
fe_dedu³_¿nge_šfo
 
	mšfo
[0];

89 
	sfes_¡©_¡ruù
 {

90 
	mÄ_fes
;

91 
	mÄ_ä“_fes
;

92 
	mmax_fes
;

95 
	sšodes_¡©_t
 {

96 
	mÄ_šodes
;

97 
	mÄ_unu£d
;

98 
	mdummy
[5];

102 
	#NR_FILE
 8192

	)

108 
	#MS_RDONLY
 1

	)

109 
	#MS_NOSUID
 2

	)

110 
	#MS_NODEV
 4

	)

111 
	#MS_NOEXEC
 8

	)

112 
	#MS_SYNCHRONOUS
 16

	)

113 
	#MS_REMOUNT
 32

	)

114 
	#MS_MANDLOCK
 64

	)

115 
	#MS_DIRSYNC
 128

	)

116 
	#MS_NOATIME
 1024

	)

117 
	#MS_NODIRATIME
 2048

	)

118 
	#MS_BIND
 4096

	)

119 
	#MS_MOVE
 8192

	)

120 
	#MS_REC
 16384

	)

121 
	#MS_VERBOSE
 32768

	)

123 
	#MS_SILENT
 32768

	)

124 
	#MS_POSIXACL
 (1<<16è

	)

125 
	#MS_UNBINDABLE
 (1<<17è

	)

126 
	#MS_PRIVATE
 (1<<18è

	)

127 
	#MS_SLAVE
 (1<<19è

	)

128 
	#MS_SHARED
 (1<<20è

	)

129 
	#MS_RELATIME
 (1<<21è

	)

130 
	#MS_KERNMOUNT
 (1<<22è

	)

131 
	#MS_I_VERSION
 (1<<23è

	)

132 
	#MS_STRICTATIME
 (1<<24è

	)

133 
	#MS_LAZYTIME
 (1<<25è

	)

136 
	#MS_SUBMOUNT
 (1<<26)

	)

137 
	#MS_NOREMOTELOCK
 (1<<27)

	)

138 
	#MS_NOSEC
 (1<<28)

	)

139 
	#MS_BORN
 (1<<29)

	)

140 
	#MS_ACTIVE
 (1<<30)

	)

141 
	#MS_NOUSER
 (1<<31)

	)

146 
	#MS_RMT_MASK
 (
MS_RDONLY
|
MS_SYNCHRONOUS
|
MS_MANDLOCK
|
MS_I_VERSION
|\

147 
MS_LAZYTIME
)

	)

152 
	#MS_MGC_VAL
 0xC0ED0000

	)

153 
	#MS_MGC_MSK
 0xffff0000

	)

158 
	sfsx©Œ
 {

159 
__u32
 
	mfsx_xæags
;

160 
__u32
 
	mfsx_extsize
;

161 
__u32
 
	mfsx_Ãx‹Ás
;

162 
__u32
 
	mfsx_´ojid
;

163 
__u32
 
	mfsx_cowextsize
;

164 
	mfsx_·d
[8];

170 
	#FS_XFLAG_REALTIME
 0x00000001

	)

171 
	#FS_XFLAG_PREALLOC
 0x00000002

	)

172 
	#FS_XFLAG_IMMUTABLE
 0x00000008

	)

173 
	#FS_XFLAG_APPEND
 0x00000010

	)

174 
	#FS_XFLAG_SYNC
 0x00000020

	)

175 
	#FS_XFLAG_NOATIME
 0x00000040

	)

176 
	#FS_XFLAG_NODUMP
 0x00000080

	)

177 
	#FS_XFLAG_RTINHERIT
 0x00000100

	)

178 
	#FS_XFLAG_PROJINHERIT
 0x00000200

	)

179 
	#FS_XFLAG_NOSYMLINKS
 0x00000400

	)

180 
	#FS_XFLAG_EXTSIZE
 0x00000800

	)

181 
	#FS_XFLAG_EXTSZINHERIT
 0x00001000

	)

182 
	#FS_XFLAG_NODEFRAG
 0x00002000

	)

183 
	#FS_XFLAG_FILESTREAM
 0x00004000

	)

184 
	#FS_XFLAG_DAX
 0x00008000

	)

185 
	#FS_XFLAG_COWEXTSIZE
 0x00010000

	)

186 
	#FS_XFLAG_HASATTR
 0x80000000

	)

191 
	#BLKROSET
 
	`_IO
(0x12,93è

	)

192 
	#BLKROGET
 
	`_IO
(0x12,94è

	)

193 
	#BLKRRPART
 
	`_IO
(0x12,95è

	)

194 
	#BLKGETSIZE
 
	`_IO
(0x12,96è

	)

195 
	#BLKFLSBUF
 
	`_IO
(0x12,97è

	)

196 
	#BLKRASET
 
	`_IO
(0x12,98è

	)

197 
	#BLKRAGET
 
	`_IO
(0x12,99è

	)

198 
	#BLKFRASET
 
	`_IO
(0x12,100)

	)

199 
	#BLKFRAGET
 
	`_IO
(0x12,101)

	)

200 
	#BLKSECTSET
 
	`_IO
(0x12,102)

	)

201 
	#BLKSECTGET
 
	`_IO
(0x12,103)

	)

202 
	#BLKSSZGET
 
	`_IO
(0x12,104)

	)

204 
	#BLKPG
 
	`_IO
(0x12,105)

	)

208 
	#BLKELVGET
 
	`_IOR
(0x12,106,
size_t
)

	)

209 
	#BLKELVSET
 
	`_IOW
(0x12,107,
size_t
)

	)

214 
	#BLKBSZGET
 
	`_IOR
(0x12,112,
size_t
)

	)

215 
	#BLKBSZSET
 
	`_IOW
(0x12,113,
size_t
)

	)

216 
	#BLKGETSIZE64
 
	`_IOR
(0x12,114,
size_t
è

	)

217 
	#BLKTRACESETUP
 
	`_IOWR
(0x12,115,
blk_u£r_Œaû_£tup
)

	)

218 
	#BLKTRACESTART
 
	`_IO
(0x12,116)

	)

219 
	#BLKTRACESTOP
 
	`_IO
(0x12,117)

	)

220 
	#BLKTRACETEARDOWN
 
	`_IO
(0x12,118)

	)

221 
	#BLKDISCARD
 
	`_IO
(0x12,119)

	)

222 
	#BLKIOMIN
 
	`_IO
(0x12,120)

	)

223 
	#BLKIOOPT
 
	`_IO
(0x12,121)

	)

224 
	#BLKALIGNOFF
 
	`_IO
(0x12,122)

	)

225 
	#BLKPBSZGET
 
	`_IO
(0x12,123)

	)

226 
	#BLKDISCARDZEROES
 
	`_IO
(0x12,124)

	)

227 
	#BLKSECDISCARD
 
	`_IO
(0x12,125)

	)

228 
	#BLKROTATIONAL
 
	`_IO
(0x12,126)

	)

229 
	#BLKZEROOUT
 
	`_IO
(0x12,127)

	)

235 
	#BMAP_IOCTL
 1

	)

236 
	#FIBMAP
 
	`_IO
(0x00,1è

	)

237 
	#FIGETBSZ
 
	`_IO
(0x00,2è

	)

238 
	#FIFREEZE
 
	`_IOWR
('X', 119, è

	)

239 
	#FITHAW
 
	`_IOWR
('X', 120, è

	)

240 
	#FITRIM
 
	`_IOWR
('X', 121, 
f¡rim_¿nge
è

	)

241 
	#FICLONE
 
	`_IOW
(0x94, 9, )

	)

242 
	#FICLONERANGE
 
	`_IOW
(0x94, 13, 
fe_şÚe_¿nge
)

	)

243 
	#FIDEDUPERANGE
 
	`_IOWR
(0x94, 54, 
fe_dedu³_¿nge
)

	)

245 
	#FS_IOC_GETFLAGS
 
	`_IOR
('f', 1, )

	)

246 
	#FS_IOC_SETFLAGS
 
	`_IOW
('f', 2, )

	)

247 
	#FS_IOC_GETVERSION
 
	`_IOR
('v', 1, )

	)

248 
	#FS_IOC_SETVERSION
 
	`_IOW
('v', 2, )

	)

249 
	#FS_IOC_FIEMAP
 
	`_IOWR
('f', 11, 
f›m­
)

	)

250 
	#FS_IOC32_GETFLAGS
 
	`_IOR
('f', 1, )

	)

251 
	#FS_IOC32_SETFLAGS
 
	`_IOW
('f', 2, )

	)

252 
	#FS_IOC32_GETVERSION
 
	`_IOR
('v', 1, )

	)

253 
	#FS_IOC32_SETVERSION
 
	`_IOW
('v', 2, )

	)

254 
	#FS_IOC_FSGETXATTR
 
	`_IOR
 ('X', 31, 
fsx©Œ
)

	)

255 
	#FS_IOC_FSSETXATTR
 
	`_IOW
 ('X', 32, 
fsx©Œ
)

	)

261 
	#FS_KEY_DESCRIPTOR_SIZE
 8

	)

263 
	#FS_POLICY_FLAGS_PAD_4
 0x00

	)

264 
	#FS_POLICY_FLAGS_PAD_8
 0x01

	)

265 
	#FS_POLICY_FLAGS_PAD_16
 0x02

	)

266 
	#FS_POLICY_FLAGS_PAD_32
 0x03

	)

267 
	#FS_POLICY_FLAGS_PAD_MASK
 0x03

	)

268 
	#FS_POLICY_FLAGS_VALID
 0x03

	)

271 
	#FS_ENCRYPTION_MODE_INVALID
 0

	)

272 
	#FS_ENCRYPTION_MODE_AES_256_XTS
 1

	)

273 
	#FS_ENCRYPTION_MODE_AES_256_GCM
 2

	)

274 
	#FS_ENCRYPTION_MODE_AES_256_CBC
 3

	)

275 
	#FS_ENCRYPTION_MODE_AES_256_CTS
 4

	)

276 
	#FS_ENCRYPTION_MODE_AES_128_CBC
 5

	)

277 
	#FS_ENCRYPTION_MODE_AES_128_CTS
 6

	)

279 
	sfsüy±_pŞicy
 {

280 
__u8
 
	mv”siÚ
;

281 
__u8
 
	mcÚ‹Ás_’üy±iÚ_mode
;

282 
__u8
 
	mf’ames_’üy±iÚ_mode
;

283 
__u8
 
	mæags
;

284 
__u8
 
	mma¡”_key_desütÜ
[
FS_KEY_DESCRIPTOR_SIZE
];

287 
	#FS_IOC_SET_ENCRYPTION_POLICY
 
	`_IOR
('f', 19, 
fsüy±_pŞicy
)

	)

288 
	#FS_IOC_GET_ENCRYPTION_PWSALT
 
	`_IOW
('f', 20, 
__u8
[16])

	)

289 
	#FS_IOC_GET_ENCRYPTION_POLICY
 
	`_IOW
('f', 21, 
fsüy±_pŞicy
)

	)

292 
	#FS_KEY_DESC_PREFIX
 "fsüy±:"

	)

293 
	#FS_KEY_DESC_PREFIX_SIZE
 8

	)

296 
	#FS_MAX_KEY_SIZE
 64

	)

298 
	sfsüy±_key
 {

299 
__u32
 
	mmode
;

300 
__u8
 
	m¿w
[
FS_MAX_KEY_SIZE
];

301 
__u32
 
	msize
;

324 
	#FS_SECRM_FL
 0x00000001

	)

325 
	#FS_UNRM_FL
 0x00000002

	)

326 
	#FS_COMPR_FL
 0x00000004

	)

327 
	#FS_SYNC_FL
 0x00000008

	)

328 
	#FS_IMMUTABLE_FL
 0x00000010

	)

329 
	#FS_APPEND_FL
 0x00000020

	)

330 
	#FS_NODUMP_FL
 0x00000040

	)

331 
	#FS_NOATIME_FL
 0x00000080

	)

333 
	#FS_DIRTY_FL
 0x00000100

	)

334 
	#FS_COMPRBLK_FL
 0x00000200

	)

335 
	#FS_NOCOMP_FL
 0x00000400

	)

337 
	#FS_ENCRYPT_FL
 0x00000800

	)

338 
	#FS_BTREE_FL
 0x00001000

	)

339 
	#FS_INDEX_FL
 0x00001000

	)

340 
	#FS_IMAGIC_FL
 0x00002000

	)

341 
	#FS_JOURNAL_DATA_FL
 0x00004000

	)

342 
	#FS_NOTAIL_FL
 0x00008000

	)

343 
	#FS_DIRSYNC_FL
 0x00010000

	)

344 
	#FS_TOPDIR_FL
 0x00020000

	)

345 
	#FS_HUGE_FILE_FL
 0x00040000

	)

346 
	#FS_EXTENT_FL
 0x00080000

	)

347 
	#FS_EA_INODE_FL
 0x00200000

	)

348 
	#FS_EOFBLOCKS_FL
 0x00400000

	)

349 
	#FS_NOCOW_FL
 0x00800000

	)

350 
	#FS_INLINE_DATA_FL
 0x10000000

	)

351 
	#FS_PROJINHERIT_FL
 0x20000000

	)

352 
	#FS_RESERVED_FL
 0x80000000

	)

354 
	#FS_FL_USER_VISIBLE
 0x0003DFFF

	)

355 
	#FS_FL_USER_MODIFIABLE
 0x000380FF

	)

358 
	#SYNC_FILE_RANGE_WAIT_BEFORE
 1

	)

359 
	#SYNC_FILE_RANGE_WRITE
 2

	)

360 
	#SYNC_FILE_RANGE_WAIT_AFTER
 4

	)

366 
	t__b™wi£
 
	t__k”Ãl_rwf_t
;

369 
	#RWF_HIPRI
 ((
__k”Ãl_rwf_t
)0x00000001)

	)

372 
	#RWF_DSYNC
 ((
__k”Ãl_rwf_t
)0x00000002)

	)

375 
	#RWF_SYNC
 ((
__k”Ãl_rwf_t
)0x00000004)

	)

378 
	#RWF_NOWAIT
 ((
__k”Ãl_rwf_t
)0x00000008)

	)

381 
	#RWF_SUPPORTED
 (
RWF_HIPRI
 | 
RWF_DSYNC
 | 
RWF_SYNC
 | 
RWF_NOWAIT
)

	)

	@/usr/include/linux/if.h

20 #iâdeà
_LINUX_IF_H


21 
	#_LINUX_IF_H


	)

23 
	~<lšux/libc-com·t.h
>

24 
	~<lšux/ty³s.h
>

25 
	~<lšux/sock‘.h
>

28 
	~<sys/sock‘.h
>

30 #ià
__UAPI_DEF_IF_IFNAMSIZ


31 
	#IFNAMSIZ
 16

	)

33 
	#IFALIASZ
 256

	)

34 
	~<lšux/hdlc/ioùl.h
>

37 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 != 0 || \

38 
	g__UAPI_DEF_IF_NET_DEVICE_FLAGS
 != 0

79 
	eÃt_deviû_æags
 {

81 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS


82 
IFF_UP
 = 1<<0,

83 
	mIFF_BROADCAST
 = 1<<1,

84 
	mIFF_DEBUG
 = 1<<2,

85 
	mIFF_LOOPBACK
 = 1<<3,

86 
	mIFF_POINTOPOINT
 = 1<<4,

87 
	mIFF_NOTRAILERS
 = 1<<5,

88 
	mIFF_RUNNING
 = 1<<6,

89 
	mIFF_NOARP
 = 1<<7,

90 
	mIFF_PROMISC
 = 1<<8,

91 
	mIFF_ALLMULTI
 = 1<<9,

92 
	mIFF_MASTER
 = 1<<10,

93 
	mIFF_SLAVE
 = 1<<11,

94 
	mIFF_MULTICAST
 = 1<<12,

95 
	mIFF_PORTSEL
 = 1<<13,

96 
	mIFF_AUTOMEDIA
 = 1<<14,

97 
	mIFF_DYNAMIC
 = 1<<15,

99 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


100 
	mIFF_LOWER_UP
 = 1<<16,

101 
	mIFF_DORMANT
 = 1<<17,

102 
	mIFF_ECHO
 = 1<<18,

108 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS


109 
	#IFF_UP
 
IFF_UP


	)

110 
	#IFF_BROADCAST
 
IFF_BROADCAST


	)

111 
	#IFF_DEBUG
 
IFF_DEBUG


	)

112 
	#IFF_LOOPBACK
 
IFF_LOOPBACK


	)

113 
	#IFF_POINTOPOINT
 
IFF_POINTOPOINT


	)

114 
	#IFF_NOTRAILERS
 
IFF_NOTRAILERS


	)

115 
	#IFF_RUNNING
 
IFF_RUNNING


	)

116 
	#IFF_NOARP
 
IFF_NOARP


	)

117 
	#IFF_PROMISC
 
IFF_PROMISC


	)

118 
	#IFF_ALLMULTI
 
IFF_ALLMULTI


	)

119 
	#IFF_MASTER
 
IFF_MASTER


	)

120 
	#IFF_SLAVE
 
IFF_SLAVE


	)

121 
	#IFF_MULTICAST
 
IFF_MULTICAST


	)

122 
	#IFF_PORTSEL
 
IFF_PORTSEL


	)

123 
	#IFF_AUTOMEDIA
 
IFF_AUTOMEDIA


	)

124 
	#IFF_DYNAMIC
 
IFF_DYNAMIC


	)

127 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


128 
	#IFF_LOWER_UP
 
IFF_LOWER_UP


	)

129 
	#IFF_DORMANT
 
IFF_DORMANT


	)

130 
	#IFF_ECHO
 
IFF_ECHO


	)

133 
	#IFF_VOLATILE
 (
IFF_LOOPBACK
|
IFF_POINTOPOINT
|
IFF_BROADCAST
|
IFF_ECHO
|\

134 
IFF_MASTER
|
IFF_SLAVE
|
IFF_RUNNING
|
IFF_LOWER_UP
|
IFF_DORMANT
)

	)

136 
	#IF_GET_IFACE
 0x0001

	)

137 
	#IF_GET_PROTO
 0x0002

	)

140 
	#IF_IFACE_V35
 0x1000

	)

141 
	#IF_IFACE_V24
 0x1001

	)

142 
	#IF_IFACE_X21
 0x1002

	)

143 
	#IF_IFACE_T1
 0x1003

	)

144 
	#IF_IFACE_E1
 0x1004

	)

145 
	#IF_IFACE_SYNC_SERIAL
 0x1005

	)

146 
	#IF_IFACE_X21D
 0x1006

	)

149 
	#IF_PROTO_HDLC
 0x2000

	)

150 
	#IF_PROTO_PPP
 0x2001

	)

151 
	#IF_PROTO_CISCO
 0x2002

	)

152 
	#IF_PROTO_FR
 0x2003

	)

153 
	#IF_PROTO_FR_ADD_PVC
 0x2004

	)

154 
	#IF_PROTO_FR_DEL_PVC
 0x2005

	)

155 
	#IF_PROTO_X25
 0x2006

	)

156 
	#IF_PROTO_HDLC_ETH
 0x2007

	)

157 
	#IF_PROTO_FR_ADD_ETH_PVC
 0x2008

	)

158 
	#IF_PROTO_FR_DEL_ETH_PVC
 0x2009

	)

159 
	#IF_PROTO_FR_PVC
 0x200A

	)

160 
	#IF_PROTO_FR_ETH_PVC
 0x200B

	)

161 
	#IF_PROTO_RAW
 0x200C

	)

165 
	mIF_OPER_UNKNOWN
,

166 
	mIF_OPER_NOTPRESENT
,

167 
	mIF_OPER_DOWN
,

168 
	mIF_OPER_LOWERLAYERDOWN
,

169 
	mIF_OPER_TESTING
,

170 
	mIF_OPER_DORMANT
,

171 
	mIF_OPER_UP
,

176 
	mIF_LINK_MODE_DEFAULT
,

177 
	mIF_LINK_MODE_DORMANT
,

191 #ià
__UAPI_DEF_IF_IFMAP


192 
	sifm­
 {

193 
	mmem_¡¬t
;

194 
	mmem_’d
;

195 
	mba£_addr
;

196 
	mœq
;

197 
	mdma
;

198 
	mpÜt
;

203 
	sif_£‰šgs
 {

204 
	mty³
;

205 
	msize
;

208 
¿w_hdlc_´Ùo
 *
	m¿w_hdlc
;

209 
cisco_´Ùo
 *
	mcisco
;

210 
ä_´Ùo
 *
	mä
;

211 
ä_´Ùo_pvc
 *
	mä_pvc
;

212 
ä_´Ùo_pvc_šfo
 *
	mä_pvc_šfo
;

215 
sync_£rŸl_£‰šgs
 *
	msync
;

216 
‹1_£‰šgs
 *
	m‹1
;

217 } 
	mifs_ifsu
;

228 #ià
__UAPI_DEF_IF_IFREQ


229 
	siäeq
 {

230 
	#IFHWADDRLEN
 6

	)

233 
	miän_Çme
[
IFNAMSIZ
];

234 } 
	miä_iän
;

237 
sockaddr
 
	miäu_addr
;

238 
sockaddr
 
	miäu_d¡addr
;

239 
sockaddr
 
	miäu_brßdaddr
;

240 
sockaddr
 
	miäu_Ãtmask
;

241 
sockaddr
 
	miäu_hwaddr
;

242 
	miäu_æags
;

243 
	miäu_iv®ue
;

244 
	miäu_mtu
;

245 
ifm­
 
	miäu_m­
;

246 
	miäu_¦ave
[
IFNAMSIZ
];

247 
	miäu_ÃwÇme
[
IFNAMSIZ
];

248 * 
	miäu_d©a
;

249 
if_£‰šgs
 
	miäu_£‰šgs
;

250 } 
	miä_iäu
;

254 
	#iä_Çme
 
iä_iän
.
iän_Çme


	)

255 
	#iä_hwaddr
 
iä_iäu
.
iäu_hwaddr


	)

256 
	#iä_addr
 
iä_iäu
.
iäu_addr


	)

257 
	#iä_d¡addr
 
iä_iäu
.
iäu_d¡addr


	)

258 
	#iä_brßdaddr
 
iä_iäu
.
iäu_brßdaddr


	)

259 
	#iä_Ãtmask
 
iä_iäu
.
iäu_Ãtmask


	)

260 
	#iä_æags
 
iä_iäu
.
iäu_æags


	)

261 
	#iä_m‘ric
 
iä_iäu
.
iäu_iv®ue


	)

262 
	#iä_mtu
 
iä_iäu
.
iäu_mtu


	)

263 
	#iä_m­
 
iä_iäu
.
iäu_m­


	)

264 
	#iä_¦ave
 
iä_iäu
.
iäu_¦ave


	)

265 
	#iä_d©a
 
iä_iäu
.
iäu_d©a


	)

266 
	#iä_ifšdex
 
iä_iäu
.
iäu_iv®ue


	)

267 
	#iä_bªdwidth
 
iä_iäu
.
iäu_iv®ue


	)

268 
	#iä_qËn
 
iä_iäu
.
iäu_iv®ue


	)

269 
	#iä_ÃwÇme
 
iä_iäu
.
iäu_ÃwÇme


	)

270 
	#iä_£‰šgs
 
iä_iäu
.
iäu_£‰šgs


	)

280 #ià
__UAPI_DEF_IF_IFCONF


281 
	sifcÚf
 {

282 
	mifc_Ën
;

284 *
	mifcu_buf
;

285 
iäeq
 *
	mifcu_»q
;

286 } 
	mifc_ifcu
;

290 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

291 
	#ifc_»q
 
ifc_ifcu
.
ifcu_»q


	)

	@/usr/include/linux/if_ether.h

22 #iâdeà
_LINUX_IF_ETHER_H


23 
	#_LINUX_IF_ETHER_H


	)

25 
	~<lšux/ty³s.h
>

32 
	#ETH_ALEN
 6

	)

33 
	#ETH_TLEN
 2

	)

34 
	#ETH_HLEN
 14

	)

35 
	#ETH_ZLEN
 60

	)

36 
	#ETH_DATA_LEN
 1500

	)

37 
	#ETH_FRAME_LEN
 1514

	)

38 
	#ETH_FCS_LEN
 4

	)

40 
	#ETH_MIN_MTU
 68

	)

41 
	#ETH_MAX_MTU
 0xFFFFU

	)

47 
	#ETH_P_LOOP
 0x0060

	)

48 
	#ETH_P_PUP
 0x0200

	)

49 
	#ETH_P_PUPAT
 0x0201

	)

50 
	#ETH_P_TSN
 0x22F0

	)

51 
	#ETH_P_IP
 0x0800

	)

52 
	#ETH_P_X25
 0x0805

	)

53 
	#ETH_P_ARP
 0x0806

	)

54 
	#ETH_P_BPQ
 0x08FF

	)

55 
	#ETH_P_IEEEPUP
 0x0a00

	)

56 
	#ETH_P_IEEEPUPAT
 0x0a01

	)

57 
	#ETH_P_BATMAN
 0x4305

	)

58 
	#ETH_P_DEC
 0x6000

	)

59 
	#ETH_P_DNA_DL
 0x6001

	)

60 
	#ETH_P_DNA_RC
 0x6002

	)

61 
	#ETH_P_DNA_RT
 0x6003

	)

62 
	#ETH_P_LAT
 0x6004

	)

63 
	#ETH_P_DIAG
 0x6005

	)

64 
	#ETH_P_CUST
 0x6006

	)

65 
	#ETH_P_SCA
 0x6007

	)

66 
	#ETH_P_TEB
 0x6558

	)

67 
	#ETH_P_RARP
 0x8035

	)

68 
	#ETH_P_ATALK
 0x809B

	)

69 
	#ETH_P_AARP
 0x80F3

	)

70 
	#ETH_P_8021Q
 0x8100

	)

71 
	#ETH_P_ERSPAN
 0x88BE

	)

72 
	#ETH_P_IPX
 0x8137

	)

73 
	#ETH_P_IPV6
 0x86DD

	)

74 
	#ETH_P_PAUSE
 0x8808

	)

75 
	#ETH_P_SLOW
 0x8809

	)

76 
	#ETH_P_WCCP
 0x883E

	)

78 
	#ETH_P_MPLS_UC
 0x8847

	)

79 
	#ETH_P_MPLS_MC
 0x8848

	)

80 
	#ETH_P_ATMMPOA
 0x884ø

	)

81 
	#ETH_P_PPP_DISC
 0x8863

	)

82 
	#ETH_P_PPP_SES
 0x8864

	)

83 
	#ETH_P_LINK_CTL
 0x886ø

	)

84 
	#ETH_P_ATMFATE
 0x8884

	)

87 
	#ETH_P_PAE
 0x888E

	)

88 
	#ETH_P_AOE
 0x88A2

	)

89 
	#ETH_P_8021AD
 0x88A8

	)

90 
	#ETH_P_802_EX1
 0x88B5

	)

91 
	#ETH_P_TIPC
 0x88CA

	)

92 
	#ETH_P_MACSEC
 0x88E5

	)

93 
	#ETH_P_8021AH
 0x88E7

	)

94 
	#ETH_P_MVRP
 0x88F5

	)

95 
	#ETH_P_1588
 0x88F7

	)

96 
	#ETH_P_NCSI
 0x88F8

	)

97 
	#ETH_P_PRP
 0x88FB

	)

98 
	#ETH_P_FCOE
 0x8906

	)

99 
	#ETH_P_IBOE
 0x8915

	)

100 
	#ETH_P_TDLS
 0x890D

	)

101 
	#ETH_P_FIP
 0x8914

	)

102 
	#ETH_P_80221
 0x8917

	)

103 
	#ETH_P_HSR
 0x892F

	)

104 
	#ETH_P_NSH
 0x894F

	)

105 
	#ETH_P_LOOPBACK
 0x9000

	)

106 
	#ETH_P_QINQ1
 0x9100

	)

107 
	#ETH_P_QINQ2
 0x9200

	)

108 
	#ETH_P_QINQ3
 0x9300

	)

109 
	#ETH_P_EDSA
 0xDADA

	)

110 
	#ETH_P_IFE
 0xED3E

	)

111 
	#ETH_P_AF_IUCV
 0xFBFB

	)

113 
	#ETH_P_802_3_MIN
 0x0600

	)

120 
	#ETH_P_802_3
 0x0001

	)

121 
	#ETH_P_AX25
 0x0002

	)

122 
	#ETH_P_ALL
 0x0003

	)

123 
	#ETH_P_802_2
 0x0004

	)

124 
	#ETH_P_SNAP
 0x0005

	)

125 
	#ETH_P_DDCMP
 0x0006

	)

126 
	#ETH_P_WAN_PPP
 0x0007

	)

127 
	#ETH_P_PPP_MP
 0x0008

	)

128 
	#ETH_P_LOCALTALK
 0x0009

	)

129 
	#ETH_P_CAN
 0x000C

	)

130 
	#ETH_P_CANFD
 0x000D

	)

131 
	#ETH_P_PPPTALK
 0x0010

	)

132 
	#ETH_P_TR_802_2
 0x0011

	)

133 
	#ETH_P_MOBITEX
 0x0015

	)

134 
	#ETH_P_CONTROL
 0x0016

	)

135 
	#ETH_P_IRDA
 0x0017

	)

136 
	#ETH_P_ECONET
 0x0018

	)

137 
	#ETH_P_HDLC
 0x0019

	)

138 
	#ETH_P_ARCNET
 0x001A

	)

139 
	#ETH_P_DSA
 0x001B

	)

140 
	#ETH_P_TRAILER
 0x001C

	)

141 
	#ETH_P_PHONET
 0x00F5

	)

142 
	#ETH_P_IEEE802154
 0x00F6

	)

143 
	#ETH_P_CAIF
 0x00F7

	)

144 
	#ETH_P_XDSA
 0x00F8

	)

145 
	#ETH_P_MAP
 0x00F9

	)

154 #iâdeà
__UAPI_DEF_ETHHDR


155 
	#__UAPI_DEF_ETHHDR
 1

	)

158 #ià
__UAPI_DEF_ETHHDR


159 
	s‘hhdr
 {

160 
	mh_de¡
[
ETH_ALEN
];

161 
	mh_sourû
[
ETH_ALEN
];

162 
__be16
 
	mh_´Ùo
;

163 } 
__©Œibu‹__
((
·cked
));

	@/usr/include/linux/igmp.h

17 #iâdeà
_LINUX_IGMP_H


18 
	#_LINUX_IGMP_H


	)

20 
	~<lšux/ty³s.h
>

21 
	~<asm/by‹Üd”.h
>

31 
	sigmphdr
 {

32 
__u8
 
	mty³
;

33 
__u8
 
	mcode
;

34 
__sum16
 
	mcsum
;

35 
__be32
 
	mgroup
;

39 
	#IGMPV3_MODE_IS_INCLUDE
 1

	)

40 
	#IGMPV3_MODE_IS_EXCLUDE
 2

	)

41 
	#IGMPV3_CHANGE_TO_INCLUDE
 3

	)

42 
	#IGMPV3_CHANGE_TO_EXCLUDE
 4

	)

43 
	#IGMPV3_ALLOW_NEW_SOURCES
 5

	)

44 
	#IGMPV3_BLOCK_OLD_SOURCES
 6

	)

46 
	sigmpv3_g»c
 {

47 
__u8
 
	mg»c_ty³
;

48 
__u8
 
	mg»c_auxwÜds
;

49 
__be16
 
	mg»c_n¤cs
;

50 
__be32
 
	mg»c_mÿ
;

51 
__be32
 
	mg»c_¤c
[0];

54 
	sigmpv3_»pÜt
 {

55 
__u8
 
	mty³
;

56 
__u8
 
	m»sv1
;

57 
__sum16
 
	mcsum
;

58 
__be16
 
	m»sv2
;

59 
__be16
 
	mng»c
;

60 
igmpv3_g»c
 
	mg»c
[0];

63 
	sigmpv3_qu”y
 {

64 
__u8
 
	mty³
;

65 
__u8
 
	mcode
;

66 
__sum16
 
	mcsum
;

67 
__be32
 
	mgroup
;

68 #ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

69 
__u8
 
	mqrv
:3,

70 
	msuµ»ss
:1,

71 
	m»sv
:4;

72 #–ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

73 
__u8
 
	m»sv
:4,

74 
	msuµ»ss
:1,

75 
	mqrv
:3;

79 
__u8
 
	mqqic
;

80 
__be16
 
	mn¤cs
;

81 
__be32
 
	m¤cs
[0];

84 
	#IGMP_HOST_MEMBERSHIP_QUERY
 0x11

	)

85 
	#IGMP_HOST_MEMBERSHIP_REPORT
 0x12

	)

86 
	#IGMP_DVMRP
 0x13

	)

87 
	#IGMP_PIM
 0x14

	)

88 
	#IGMP_TRACE
 0x15

	)

89 
	#IGMPV2_HOST_MEMBERSHIP_REPORT
 0x16

	)

90 
	#IGMP_HOST_LEAVE_MESSAGE
 0x17

	)

91 
	#IGMPV3_HOST_MEMBERSHIP_REPORT
 0x22

	)

93 
	#IGMP_MTRACE_RESP
 0x1e

	)

94 
	#IGMP_MTRACE
 0x1f

	)

101 
	#IGMP_DELAYING_MEMBER
 0x01

	)

102 
	#IGMP_IDLE_MEMBER
 0x02

	)

103 
	#IGMP_LAZY_MEMBER
 0x03

	)

104 
	#IGMP_SLEEPING_MEMBER
 0x04

	)

105 
	#IGMP_AWAKENING_MEMBER
 0x05

	)

107 
	#IGMP_MINLEN
 8

	)

109 
	#IGMP_MAX_HOST_REPORT_DELAY
 10

	)

112 
	#IGMP_TIMER_SCALE
 10

	)

115 
	#IGMP_AGE_THRESHOLD
 400

	)

119 
	#IGMP_ALL_HOSTS
 
	`htÚl
(0xE0000001L)

	)

120 
	#IGMP_ALL_ROUTER
 
	`htÚl
(0xE0000002L)

	)

121 
	#IGMPV3_ALL_MCR
 
	`htÚl
(0xE0000016L)

	)

122 
	#IGMP_LOCAL_GROUP
 
	`htÚl
(0xE0000000L)

	)

123 
	#IGMP_LOCAL_GROUP_MASK
 
	`htÚl
(0xFFFFFF00L)

	)

	@/usr/include/linux/in.h

19 #iâdeà
_LINUX_IN_H


20 
	#_LINUX_IN_H


	)

22 
	~<lšux/ty³s.h
>

23 
	~<lšux/libc-com·t.h
>

24 
	~<lšux/sock‘.h
>

26 #ià
__UAPI_DEF_IN_IPPROTO


29 
	mIPPROTO_IP
 = 0,

30 
	#IPPROTO_IP
 
IPPROTO_IP


	)

31 
	mIPPROTO_ICMP
 = 1,

32 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

33 
	mIPPROTO_IGMP
 = 2,

34 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

35 
	mIPPROTO_IPIP
 = 4,

36 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

37 
	mIPPROTO_TCP
 = 6,

38 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

39 
	mIPPROTO_EGP
 = 8,

40 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

41 
	mIPPROTO_PUP
 = 12,

42 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

43 
	mIPPROTO_UDP
 = 17,

44 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

45 
	mIPPROTO_IDP
 = 22,

46 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

47 
	mIPPROTO_TP
 = 29,

48 
	#IPPROTO_TP
 
IPPROTO_TP


	)

49 
	mIPPROTO_DCCP
 = 33,

50 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

51 
	mIPPROTO_IPV6
 = 41,

52 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

53 
	mIPPROTO_RSVP
 = 46,

54 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

55 
	mIPPROTO_GRE
 = 47,

56 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

57 
	mIPPROTO_ESP
 = 50,

58 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

59 
	mIPPROTO_AH
 = 51,

60 
	#IPPROTO_AH
 
IPPROTO_AH


	)

61 
	mIPPROTO_MTP
 = 92,

62 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

63 
	mIPPROTO_BEETPH
 = 94,

64 
	#IPPROTO_BEETPH
 
IPPROTO_BEETPH


	)

65 
	mIPPROTO_ENCAP
 = 98,

66 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

67 
	mIPPROTO_PIM
 = 103,

68 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

69 
	mIPPROTO_COMP
 = 108,

70 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

71 
	mIPPROTO_SCTP
 = 132,

72 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

73 
	mIPPROTO_UDPLITE
 = 136,

74 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

75 
	mIPPROTO_MPLS
 = 137,

76 
	#IPPROTO_MPLS
 
IPPROTO_MPLS


	)

77 
	mIPPROTO_RAW
 = 255,

78 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

79 
	mIPPROTO_MAX


83 #ià
__UAPI_DEF_IN_ADDR


85 
	sš_addr
 {

86 
__be32
 
	ms_addr
;

90 
	#IP_TOS
 1

	)

91 
	#IP_TTL
 2

	)

92 
	#IP_HDRINCL
 3

	)

93 
	#IP_OPTIONS
 4

	)

94 
	#IP_ROUTER_ALERT
 5

	)

95 
	#IP_RECVOPTS
 6

	)

96 
	#IP_RETOPTS
 7

	)

97 
	#IP_PKTINFO
 8

	)

98 
	#IP_PKTOPTIONS
 9

	)

99 
	#IP_MTU_DISCOVER
 10

	)

100 
	#IP_RECVERR
 11

	)

101 
	#IP_RECVTTL
 12

	)

102 
	#IP_RECVTOS
 13

	)

103 
	#IP_MTU
 14

	)

104 
	#IP_FREEBIND
 15

	)

105 
	#IP_IPSEC_POLICY
 16

	)

106 
	#IP_XFRM_POLICY
 17

	)

107 
	#IP_PASSSEC
 18

	)

108 
	#IP_TRANSPARENT
 19

	)

111 
	#IP_RECVRETOPTS
 
IP_RETOPTS


	)

114 
	#IP_ORIGDSTADDR
 20

	)

115 
	#IP_RECVORIGDSTADDR
 
IP_ORIGDSTADDR


	)

117 
	#IP_MINTTL
 21

	)

118 
	#IP_NODEFRAG
 22

	)

119 
	#IP_CHECKSUM
 23

	)

120 
	#IP_BIND_ADDRESS_NO_PORT
 24

	)

121 
	#IP_RECVFRAGSIZE
 25

	)

124 
	#IP_PMTUDISC_DONT
 0

	)

125 
	#IP_PMTUDISC_WANT
 1

	)

126 
	#IP_PMTUDISC_DO
 2

	)

127 
	#IP_PMTUDISC_PROBE
 3

	)

132 
	#IP_PMTUDISC_INTERFACE
 4

	)

136 
	#IP_PMTUDISC_OMIT
 5

	)

138 
	#IP_MULTICAST_IF
 32

	)

139 
	#IP_MULTICAST_TTL
 33

	)

140 
	#IP_MULTICAST_LOOP
 34

	)

141 
	#IP_ADD_MEMBERSHIP
 35

	)

142 
	#IP_DROP_MEMBERSHIP
 36

	)

143 
	#IP_UNBLOCK_SOURCE
 37

	)

144 
	#IP_BLOCK_SOURCE
 38

	)

145 
	#IP_ADD_SOURCE_MEMBERSHIP
 39

	)

146 
	#IP_DROP_SOURCE_MEMBERSHIP
 40

	)

147 
	#IP_MSFILTER
 41

	)

148 
	#MCAST_JOIN_GROUP
 42

	)

149 
	#MCAST_BLOCK_SOURCE
 43

	)

150 
	#MCAST_UNBLOCK_SOURCE
 44

	)

151 
	#MCAST_LEAVE_GROUP
 45

	)

152 
	#MCAST_JOIN_SOURCE_GROUP
 46

	)

153 
	#MCAST_LEAVE_SOURCE_GROUP
 47

	)

154 
	#MCAST_MSFILTER
 48

	)

155 
	#IP_MULTICAST_ALL
 49

	)

156 
	#IP_UNICAST_IF
 50

	)

158 
	#MCAST_EXCLUDE
 0

	)

159 
	#MCAST_INCLUDE
 1

	)

162 
	#IP_DEFAULT_MULTICAST_TTL
 1

	)

163 
	#IP_DEFAULT_MULTICAST_LOOP
 1

	)

167 #ià
__UAPI_DEF_IP_MREQ


168 
	s_m»q
 {

169 
š_addr
 
	mimr_muÉŸddr
;

170 
š_addr
 
	mimr_š‹rçû
;

173 
	s_m»qn
 {

174 
š_addr
 
	mimr_muÉŸddr
;

175 
š_addr
 
	mimr_add»ss
;

176 
	mimr_ifšdex
;

179 
	s_m»q_sourû
 {

180 
__be32
 
	mimr_muÉŸddr
;

181 
__be32
 
	mimr_š‹rçû
;

182 
__be32
 
	mimr_sourûaddr
;

185 
	s_msf‹r
 {

186 
__be32
 
	mimsf_muÉŸddr
;

187 
__be32
 
	mimsf_š‹rçû
;

188 
__u32
 
	mimsf_fmode
;

189 
__u32
 
	mimsf_num¤c
;

190 
__be32
 
	mimsf_¦i¡
[1];

193 
	#IP_MSFILTER_SIZE
(
num¤c
) \

194 ((
_msf‹r
è- (
__u32
) \

195 + (
num¤c
è* (
__u32
))

	)

197 
	sgroup_»q
 {

198 
__u32
 
	mgr_š‹rçû
;

199 
__k”Ãl_sockaddr_¡Üage
 
	mgr_group
;

202 
	sgroup_sourû_»q
 {

203 
__u32
 
	mg¤_š‹rçû
;

204 
__k”Ãl_sockaddr_¡Üage
 
	mg¤_group
;

205 
__k”Ãl_sockaddr_¡Üage
 
	mg¤_sourû
;

208 
	sgroup_f‹r
 {

209 
__u32
 
	mgf_š‹rçû
;

210 
__k”Ãl_sockaddr_¡Üage
 
	mgf_group
;

211 
__u32
 
	mgf_fmode
;

212 
__u32
 
	mgf_num¤c
;

213 
__k”Ãl_sockaddr_¡Üage
 
	mgf_¦i¡
[1];

216 
	#GROUP_FILTER_SIZE
(
num¤c
) \

217 ((
group_f‹r
è- (
__k”Ãl_sockaddr_¡Üage
) \

218 + (
num¤c
è* (
__k”Ãl_sockaddr_¡Üage
))

	)

221 #ià
__UAPI_DEF_IN_PKTINFO


222 
	sš_pktšfo
 {

223 
	mi_ifšdex
;

224 
š_addr
 
	mi_¥ec_d¡
;

225 
š_addr
 
	mi_addr
;

230 #ià 
__UAPI_DEF_SOCKADDR_IN


231 
	#__SOCK_SIZE__
 16

	)

232 
	ssockaddr_š
 {

233 
__k”Ãl_§_çmy_t
 
	msš_çmy
;

234 
__be16
 
	msš_pÜt
;

235 
š_addr
 
	msš_addr
;

238 
	m__·d
[
__SOCK_SIZE__
 - () -

239 (è- (
š_addr
)];

241 
	#sš_z”o
 
__·d


	)

244 #ià
__UAPI_DEF_IN_CLASS


250 
	#IN_CLASSA
(
a
è((((è×)è& 0x80000000è=ğ0)

	)

251 
	#IN_CLASSA_NET
 0xff000000

	)

252 
	#IN_CLASSA_NSHIFT
 24

	)

253 
	#IN_CLASSA_HOST
 (0xfffffffà& ~
IN_CLASSA_NET
)

	)

254 
	#IN_CLASSA_MAX
 128

	)

256 
	#IN_CLASSB
(
a
è((((è×)è& 0xc0000000è=ğ0x80000000)

	)

257 
	#IN_CLASSB_NET
 0xffff0000

	)

258 
	#IN_CLASSB_NSHIFT
 16

	)

259 
	#IN_CLASSB_HOST
 (0xfffffffà& ~
IN_CLASSB_NET
)

	)

260 
	#IN_CLASSB_MAX
 65536

	)

262 
	#IN_CLASSC
(
a
è((((è×)è& 0xe0000000è=ğ0xc0000000)

	)

263 
	#IN_CLASSC_NET
 0xffffff00

	)

264 
	#IN_CLASSC_NSHIFT
 8

	)

265 
	#IN_CLASSC_HOST
 (0xfffffffà& ~
IN_CLASSC_NET
)

	)

267 
	#IN_CLASSD
(
a
è((((è×)è& 0xf0000000è=ğ0xe0000000)

	)

268 
	#IN_MULTICAST
(
a
è
	`IN_CLASSD
×)

	)

269 
	#IN_MULTICAST_NET
 0xF0000000

	)

271 
	#IN_EXPERIMENTAL
(
a
è((((è×)è& 0xf0000000è=ğ0xf0000000)

	)

272 
	#IN_BADCLASS
(
a
è
	`IN_EXPERIMENTAL
(×))

	)

275 
	#INADDR_ANY
 ((è0x00000000)

	)

278 
	#INADDR_BROADCAST
 ((è0xffffffff)

	)

281 
	#INADDR_NONE
 ((è0xffffffff)

	)

284 
	#IN_LOOPBACKNET
 127

	)

287 
	#INADDR_LOOPBACK
 0x7f000001

	)

288 
	#IN_LOOPBACK
(
a
è((((è×)è& 0xff000000è=ğ0x7f000000)

	)

291 
	#INADDR_UNSPEC_GROUP
 0xe0000000U

	)

292 
	#INADDR_ALLHOSTS_GROUP
 0xe0000001U

	)

293 
	#INADDR_ALLRTRS_GROUP
 0xe0000002U

	)

294 
	#INADDR_MAX_LOCAL_GROUP
 0xe00000ffU

	)

298 
	~<asm/by‹Üd”.h
>

	@/usr/include/linux/ip.h

18 #iâdeà
_LINUX_IP_H


19 
	#_LINUX_IP_H


	)

20 
	~<lšux/ty³s.h
>

21 
	~<asm/by‹Üd”.h
>

23 
	#IPTOS_TOS_MASK
 0x1E

	)

24 
	#IPTOS_TOS
(
tos
è(Ños)&
IPTOS_TOS_MASK
)

	)

25 
	#IPTOS_LOWDELAY
 0x10

	)

26 
	#IPTOS_THROUGHPUT
 0x08

	)

27 
	#IPTOS_RELIABILITY
 0x04

	)

28 
	#IPTOS_MINCOST
 0x02

	)

30 
	#IPTOS_PREC_MASK
 0xE0

	)

31 
	#IPTOS_PREC
(
tos
è(Ños)&
IPTOS_PREC_MASK
)

	)

32 
	#IPTOS_PREC_NETCONTROL
 0xe0

	)

33 
	#IPTOS_PREC_INTERNETCONTROL
 0xc0

	)

34 
	#IPTOS_PREC_CRITIC_ECP
 0xa0

	)

35 
	#IPTOS_PREC_FLASHOVERRIDE
 0x80

	)

36 
	#IPTOS_PREC_FLASH
 0x60

	)

37 
	#IPTOS_PREC_IMMEDIATE
 0x40

	)

38 
	#IPTOS_PREC_PRIORITY
 0x20

	)

39 
	#IPTOS_PREC_ROUTINE
 0x00

	)

43 
	#IPOPT_COPY
 0x80

	)

44 
	#IPOPT_CLASS_MASK
 0x60

	)

45 
	#IPOPT_NUMBER_MASK
 0x1f

	)

47 
	#IPOPT_COPIED
(
o
è((o)&
IPOPT_COPY
)

	)

48 
	#IPOPT_CLASS
(
o
è((o)&
IPOPT_CLASS_MASK
)

	)

49 
	#IPOPT_NUMBER
(
o
è((o)&
IPOPT_NUMBER_MASK
)

	)

51 
	#IPOPT_CONTROL
 0x00

	)

52 
	#IPOPT_RESERVED1
 0x20

	)

53 
	#IPOPT_MEASUREMENT
 0x40

	)

54 
	#IPOPT_RESERVED2
 0x60

	)

56 
	#IPOPT_END
 (0 |
IPOPT_CONTROL
)

	)

57 
	#IPOPT_NOOP
 (1 |
IPOPT_CONTROL
)

	)

58 
	#IPOPT_SEC
 (2 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

59 
	#IPOPT_LSRR
 (3 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

60 
	#IPOPT_TIMESTAMP
 (4 |
IPOPT_MEASUREMENT
)

	)

61 
	#IPOPT_CIPSO
 (6 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

62 
	#IPOPT_RR
 (7 |
IPOPT_CONTROL
)

	)

63 
	#IPOPT_SID
 (8 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

64 
	#IPOPT_SSRR
 (9 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

65 
	#IPOPT_RA
 (20|
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

67 
	#IPVERSION
 4

	)

68 
	#MAXTTL
 255

	)

69 
	#IPDEFTTL
 64

	)

71 
	#IPOPT_OPTVAL
 0

	)

72 
	#IPOPT_OLEN
 1

	)

73 
	#IPOPT_OFFSET
 2

	)

74 
	#IPOPT_MINOFF
 4

	)

75 
	#MAX_IPOPTLEN
 40

	)

76 
	#IPOPT_NOP
 
IPOPT_NOOP


	)

77 
	#IPOPT_EOL
 
IPOPT_END


	)

78 
	#IPOPT_TS
 
IPOPT_TIMESTAMP


	)

80 
	#IPOPT_TS_TSONLY
 0

	)

81 
	#IPOPT_TS_TSANDADDR
 1

	)

82 
	#IPOPT_TS_PRESPEC
 3

	)

84 
	#IPV4_BEET_PHMAXLEN
 8

	)

86 
	shdr
 {

87 #ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

88 
__u8
 
	mihl
:4,

89 
	mv”siÚ
:4;

90 #–ià
defšed
 (
__BIG_ENDIAN_BITFIELD
)

91 
__u8
 
	mv”siÚ
:4,

92 
	mihl
:4;

96 
__u8
 
	mtos
;

97 
__be16
 
	mtÙ_Ën
;

98 
__be16
 
	mid
;

99 
__be16
 
	mäag_off
;

100 
__u8
 
	m‰l
;

101 
__u8
 
	m´ÙocŞ
;

102 
__sum16
 
	mcheck
;

103 
__be32
 
	m§ddr
;

104 
__be32
 
	mdaddr
;

109 
	s_auth_hdr
 {

110 
__u8
 
	mÃxthdr
;

111 
__u8
 
	mhd¾’
;

112 
__be16
 
	m»£rved
;

113 
__be32
 
	m¥i
;

114 
__be32
 
	m£q_no
;

115 
__u8
 
	mauth_d©a
[0];

118 
	s_e¥_hdr
 {

119 
__be32
 
	m¥i
;

120 
__be32
 
	m£q_no
;

121 
__u8
 
	m’c_d©a
[0];

124 
	s_comp_hdr
 {

125 
__u8
 
	mÃxthdr
;

126 
__u8
 
	mæags
;

127 
__be16
 
	mıi
;

130 
	s_b“t_phdr
 {

131 
__u8
 
	mÃxthdr
;

132 
__u8
 
	mhd¾’
;

133 
__u8
 
	m·dËn
;

134 
__u8
 
	m»£rved
;

140 
	mIPV4_DEVCONF_FORWARDING
=1,

141 
	mIPV4_DEVCONF_MC_FORWARDING
,

142 
	mIPV4_DEVCONF_PROXY_ARP
,

143 
	mIPV4_DEVCONF_ACCEPT_REDIRECTS
,

144 
	mIPV4_DEVCONF_SECURE_REDIRECTS
,

145 
	mIPV4_DEVCONF_SEND_REDIRECTS
,

146 
	mIPV4_DEVCONF_SHARED_MEDIA
,

147 
	mIPV4_DEVCONF_RP_FILTER
,

148 
	mIPV4_DEVCONF_ACCEPT_SOURCE_ROUTE
,

149 
	mIPV4_DEVCONF_BOOTP_RELAY
,

150 
	mIPV4_DEVCONF_LOG_MARTIANS
,

151 
	mIPV4_DEVCONF_TAG
,

152 
	mIPV4_DEVCONF_ARPFILTER
,

153 
	mIPV4_DEVCONF_MEDIUM_ID
,

154 
	mIPV4_DEVCONF_NOXFRM
,

155 
	mIPV4_DEVCONF_NOPOLICY
,

156 
	mIPV4_DEVCONF_FORCE_IGMP_VERSION
,

157 
	mIPV4_DEVCONF_ARP_ANNOUNCE
,

158 
	mIPV4_DEVCONF_ARP_IGNORE
,

159 
	mIPV4_DEVCONF_PROMOTE_SECONDARIES
,

160 
	mIPV4_DEVCONF_ARP_ACCEPT
,

161 
	mIPV4_DEVCONF_ARP_NOTIFY
,

162 
	mIPV4_DEVCONF_ACCEPT_LOCAL
,

163 
	mIPV4_DEVCONF_SRC_VMARK
,

164 
	mIPV4_DEVCONF_PROXY_ARP_PVLAN
,

165 
	mIPV4_DEVCONF_ROUTE_LOCALNET
,

166 
	mIPV4_DEVCONF_IGMPV2_UNSOLICITED_REPORT_INTERVAL
,

167 
	mIPV4_DEVCONF_IGMPV3_UNSOLICITED_REPORT_INTERVAL
,

168 
	mIPV4_DEVCONF_IGNORE_ROUTES_WITH_LINKDOWN
,

169 
	mIPV4_DEVCONF_DROP_UNICAST_IN_L2_MULTICAST
,

170 
	mIPV4_DEVCONF_DROP_GRATUITOUS_ARP
,

171 
	m__IPV4_DEVCONF_MAX


174 
	#IPV4_DEVCONF_MAX
 (
__IPV4_DEVCONF_MAX
 - 1)

	)

	@/usr/include/linux/kernel.h

2 #iâdeà
_LINUX_KERNEL_H


3 
	#_LINUX_KERNEL_H


	)

5 
	~<lšux/sysšfo.h
>

10 
	#__ALIGN_KERNEL
(
x
, 
a
è
	`__ALIGN_KERNEL_MASK
(x, (
	`ty³of
(x))×è- 1)

	)

11 
	#__ALIGN_KERNEL_MASK
(
x
, 
mask
è(((xè+ (mask)è& ~(mask))

	)

13 
	#__KERNEL_DIV_ROUND_UP
(
n
, 
d
è((Òè+ (dè- 1è/ (d))

	)

	@/usr/include/linux/module.h

2 #iâdeà
_LINUX_MODULE_H


3 
	#_LINUX_MODULE_H


	)

6 
	#MODULE_INIT_IGNORE_MODVERSIONS
 1

	)

7 
	#MODULE_INIT_IGNORE_VERMAGIC
 2

	)

	@/usr/include/linux/netdevice.h

26 #iâdeà
_LINUX_NETDEVICE_H


27 
	#_LINUX_NETDEVICE_H


	)

29 
	~<lšux/if.h
>

30 
	~<lšux/if_‘h”.h
>

31 
	~<lšux/if_·ck‘.h
>

32 
	~<lšux/if_lšk.h
>

35 
	#MAX_ADDR_LEN
 32

	)

38 
	#INIT_NETDEV_GROUP
 0

	)

42 
	#NET_NAME_UNKNOWN
 0

	)

43 
	#NET_NAME_ENUM
 1

	)

44 
	#NET_NAME_PREDICTABLE
 2

	)

45 
	#NET_NAME_USER
 3

	)

46 
	#NET_NAME_RENAMED
 4

	)

50 
	mIF_PORT_UNKNOWN
 = 0,

51 
	mIF_PORT_10BASE2
,

52 
	mIF_PORT_10BASET
,

53 
	mIF_PORT_AUI
,

54 
	mIF_PORT_100BASET
,

55 
	mIF_PORT_100BASETX
,

56 
	mIF_PORT_100BASEFX


60 
	#NET_ADDR_PERM
 0

	)

61 
	#NET_ADDR_RANDOM
 1

	)

62 
	#NET_ADDR_STOLEN
 2

	)

63 
	#NET_ADDR_SET
 3

	)

	@/usr/include/linux/nl80211.h

1 #iâdeà
__LINUX_NL80211_H


2 
	#__LINUX_NL80211_H


	)

42 
	~<lšux/ty³s.h
>

44 
	#NL80211_GENL_NAME
 "Æ80211"

	)

46 
	#NL80211_MULTICAST_GROUP_CONFIG
 "cÚfig"

	)

47 
	#NL80211_MULTICAST_GROUP_SCAN
 "sÿn"

	)

48 
	#NL80211_MULTICAST_GROUP_REG
 "»guÏtÜy"

	)

49 
	#NL80211_MULTICAST_GROUP_MLME
 "mlme"

	)

50 
	#NL80211_MULTICAST_GROUP_VENDOR
 "v’dÜ"

	)

51 
	#NL80211_MULTICAST_GROUP_NAN
 "Çn"

	)

52 
	#NL80211_MULTICAST_GROUP_TESTMODE
 "‹¡mode"

	)

998 
	eÆ80211_commªds
 {

1000 
	mNL80211_CMD_UNSPEC
,

1002 
	mNL80211_CMD_GET_WIPHY
,

1003 
	mNL80211_CMD_SET_WIPHY
,

1004 
	mNL80211_CMD_NEW_WIPHY
,

1005 
	mNL80211_CMD_DEL_WIPHY
,

1007 
	mNL80211_CMD_GET_INTERFACE
,

1008 
	mNL80211_CMD_SET_INTERFACE
,

1009 
	mNL80211_CMD_NEW_INTERFACE
,

1010 
	mNL80211_CMD_DEL_INTERFACE
,

1012 
	mNL80211_CMD_GET_KEY
,

1013 
	mNL80211_CMD_SET_KEY
,

1014 
	mNL80211_CMD_NEW_KEY
,

1015 
	mNL80211_CMD_DEL_KEY
,

1017 
	mNL80211_CMD_GET_BEACON
,

1018 
	mNL80211_CMD_SET_BEACON
,

1019 
	mNL80211_CMD_START_AP
,

1020 
	mNL80211_CMD_NEW_BEACON
 = 
NL80211_CMD_START_AP
,

1021 
	mNL80211_CMD_STOP_AP
,

1022 
	mNL80211_CMD_DEL_BEACON
 = 
NL80211_CMD_STOP_AP
,

1024 
	mNL80211_CMD_GET_STATION
,

1025 
	mNL80211_CMD_SET_STATION
,

1026 
	mNL80211_CMD_NEW_STATION
,

1027 
	mNL80211_CMD_DEL_STATION
,

1029 
	mNL80211_CMD_GET_MPATH
,

1030 
	mNL80211_CMD_SET_MPATH
,

1031 
	mNL80211_CMD_NEW_MPATH
,

1032 
	mNL80211_CMD_DEL_MPATH
,

1034 
	mNL80211_CMD_SET_BSS
,

1036 
	mNL80211_CMD_SET_REG
,

1037 
	mNL80211_CMD_REQ_SET_REG
,

1039 
	mNL80211_CMD_GET_MESH_CONFIG
,

1040 
	mNL80211_CMD_SET_MESH_CONFIG
,

1042 
	mNL80211_CMD_SET_MGMT_EXTRA_IE
 ,

1044 
	mNL80211_CMD_GET_REG
,

1046 
	mNL80211_CMD_GET_SCAN
,

1047 
	mNL80211_CMD_TRIGGER_SCAN
,

1048 
	mNL80211_CMD_NEW_SCAN_RESULTS
,

1049 
	mNL80211_CMD_SCAN_ABORTED
,

1051 
	mNL80211_CMD_REG_CHANGE
,

1053 
	mNL80211_CMD_AUTHENTICATE
,

1054 
	mNL80211_CMD_ASSOCIATE
,

1055 
	mNL80211_CMD_DEAUTHENTICATE
,

1056 
	mNL80211_CMD_DISASSOCIATE
,

1058 
	mNL80211_CMD_MICHAEL_MIC_FAILURE
,

1060 
	mNL80211_CMD_REG_BEACON_HINT
,

1062 
	mNL80211_CMD_JOIN_IBSS
,

1063 
	mNL80211_CMD_LEAVE_IBSS
,

1065 
	mNL80211_CMD_TESTMODE
,

1067 
	mNL80211_CMD_CONNECT
,

1068 
	mNL80211_CMD_ROAM
,

1069 
	mNL80211_CMD_DISCONNECT
,

1071 
	mNL80211_CMD_SET_WIPHY_NETNS
,

1073 
	mNL80211_CMD_GET_SURVEY
,

1074 
	mNL80211_CMD_NEW_SURVEY_RESULTS
,

1076 
	mNL80211_CMD_SET_PMKSA
,

1077 
	mNL80211_CMD_DEL_PMKSA
,

1078 
	mNL80211_CMD_FLUSH_PMKSA
,

1080 
	mNL80211_CMD_REMAIN_ON_CHANNEL
,

1081 
	mNL80211_CMD_CANCEL_REMAIN_ON_CHANNEL
,

1083 
	mNL80211_CMD_SET_TX_BITRATE_MASK
,

1085 
	mNL80211_CMD_REGISTER_FRAME
,

1086 
	mNL80211_CMD_REGISTER_ACTION
 = 
NL80211_CMD_REGISTER_FRAME
,

1087 
	mNL80211_CMD_FRAME
,

1088 
	mNL80211_CMD_ACTION
 = 
NL80211_CMD_FRAME
,

1089 
	mNL80211_CMD_FRAME_TX_STATUS
,

1090 
	mNL80211_CMD_ACTION_TX_STATUS
 = 
NL80211_CMD_FRAME_TX_STATUS
,

1092 
	mNL80211_CMD_SET_POWER_SAVE
,

1093 
	mNL80211_CMD_GET_POWER_SAVE
,

1095 
	mNL80211_CMD_SET_CQM
,

1096 
	mNL80211_CMD_NOTIFY_CQM
,

1098 
	mNL80211_CMD_SET_CHANNEL
,

1099 
	mNL80211_CMD_SET_WDS_PEER
,

1101 
	mNL80211_CMD_FRAME_WAIT_CANCEL
,

1103 
	mNL80211_CMD_JOIN_MESH
,

1104 
	mNL80211_CMD_LEAVE_MESH
,

1106 
	mNL80211_CMD_UNPROT_DEAUTHENTICATE
,

1107 
	mNL80211_CMD_UNPROT_DISASSOCIATE
,

1109 
	mNL80211_CMD_NEW_PEER_CANDIDATE
,

1111 
	mNL80211_CMD_GET_WOWLAN
,

1112 
	mNL80211_CMD_SET_WOWLAN
,

1114 
	mNL80211_CMD_START_SCHED_SCAN
,

1115 
	mNL80211_CMD_STOP_SCHED_SCAN
,

1116 
	mNL80211_CMD_SCHED_SCAN_RESULTS
,

1117 
	mNL80211_CMD_SCHED_SCAN_STOPPED
,

1119 
	mNL80211_CMD_SET_REKEY_OFFLOAD
,

1121 
	mNL80211_CMD_PMKSA_CANDIDATE
,

1123 
	mNL80211_CMD_TDLS_OPER
,

1124 
	mNL80211_CMD_TDLS_MGMT
,

1126 
	mNL80211_CMD_UNEXPECTED_FRAME
,

1128 
	mNL80211_CMD_PROBE_CLIENT
,

1130 
	mNL80211_CMD_REGISTER_BEACONS
,

1132 
	mNL80211_CMD_UNEXPECTED_4ADDR_FRAME
,

1134 
	mNL80211_CMD_SET_NOACK_MAP
,

1136 
	mNL80211_CMD_CH_SWITCH_NOTIFY
,

1138 
	mNL80211_CMD_START_P2P_DEVICE
,

1139 
	mNL80211_CMD_STOP_P2P_DEVICE
,

1141 
	mNL80211_CMD_CONN_FAILED
,

1143 
	mNL80211_CMD_SET_MCAST_RATE
,

1145 
	mNL80211_CMD_SET_MAC_ACL
,

1147 
	mNL80211_CMD_RADAR_DETECT
,

1149 
	mNL80211_CMD_GET_PROTOCOL_FEATURES
,

1151 
	mNL80211_CMD_UPDATE_FT_IES
,

1152 
	mNL80211_CMD_FT_EVENT
,

1154 
	mNL80211_CMD_CRIT_PROTOCOL_START
,

1155 
	mNL80211_CMD_CRIT_PROTOCOL_STOP
,

1157 
	mNL80211_CMD_GET_COALESCE
,

1158 
	mNL80211_CMD_SET_COALESCE
,

1160 
	mNL80211_CMD_CHANNEL_SWITCH
,

1162 
	mNL80211_CMD_VENDOR
,

1164 
	mNL80211_CMD_SET_QOS_MAP
,

1166 
	mNL80211_CMD_ADD_TX_TS
,

1167 
	mNL80211_CMD_DEL_TX_TS
,

1169 
	mNL80211_CMD_GET_MPP
,

1171 
	mNL80211_CMD_JOIN_OCB
,

1172 
	mNL80211_CMD_LEAVE_OCB
,

1174 
	mNL80211_CMD_CH_SWITCH_STARTED_NOTIFY
,

1176 
	mNL80211_CMD_TDLS_CHANNEL_SWITCH
,

1177 
	mNL80211_CMD_TDLS_CANCEL_CHANNEL_SWITCH
,

1179 
	mNL80211_CMD_WIPHY_REG_CHANGE
,

1181 
	mNL80211_CMD_ABORT_SCAN
,

1183 
	mNL80211_CMD_START_NAN
,

1184 
	mNL80211_CMD_STOP_NAN
,

1185 
	mNL80211_CMD_ADD_NAN_FUNCTION
,

1186 
	mNL80211_CMD_DEL_NAN_FUNCTION
,

1187 
	mNL80211_CMD_CHANGE_NAN_CONFIG
,

1188 
	mNL80211_CMD_NAN_MATCH
,

1190 
	mNL80211_CMD_SET_MULTICAST_TO_UNICAST
,

1192 
	mNL80211_CMD_UPDATE_CONNECT_PARAMS
,

1194 
	mNL80211_CMD_SET_PMK
,

1195 
	mNL80211_CMD_DEL_PMK
,

1197 
	mNL80211_CMD_PORT_AUTHORIZED
,

1199 
	mNL80211_CMD_RELOAD_REGDB
,

1204 
	m__NL80211_CMD_AFTER_LAST
,

1205 
	mNL80211_CMD_MAX
 = 
__NL80211_CMD_AFTER_LAST
 - 1

1212 
	#NL80211_CMD_SET_BSS
 
NL80211_CMD_SET_BSS


	)

1213 
	#NL80211_CMD_SET_MGMT_EXTRA_IE
 
NL80211_CMD_SET_MGMT_EXTRA_IE


	)

1214 
	#NL80211_CMD_REG_CHANGE
 
NL80211_CMD_REG_CHANGE


	)

1215 
	#NL80211_CMD_AUTHENTICATE
 
NL80211_CMD_AUTHENTICATE


	)

1216 
	#NL80211_CMD_ASSOCIATE
 
NL80211_CMD_ASSOCIATE


	)

1217 
	#NL80211_CMD_DEAUTHENTICATE
 
NL80211_CMD_DEAUTHENTICATE


	)

1218 
	#NL80211_CMD_DISASSOCIATE
 
NL80211_CMD_DISASSOCIATE


	)

1219 
	#NL80211_CMD_REG_BEACON_HINT
 
NL80211_CMD_REG_BEACON_HINT


	)

1221 
	#NL80211_ATTR_FEATURE_FLAGS
 
NL80211_ATTR_FEATURE_FLAGS


	)

1224 
	#NL80211_CMD_GET_MESH_PARAMS
 
NL80211_CMD_GET_MESH_CONFIG


	)

1225 
	#NL80211_CMD_SET_MESH_PARAMS
 
NL80211_CMD_SET_MESH_CONFIG


	)

1226 
	#NL80211_MESH_SETUP_VENDOR_PATH_SEL_IE
 
NL80211_MESH_SETUP_IE


	)

2160 
	eÆ80211_©Œs
 {

2162 
	mNL80211_ATTR_UNSPEC
,

2164 
	mNL80211_ATTR_WIPHY
,

2165 
	mNL80211_ATTR_WIPHY_NAME
,

2167 
	mNL80211_ATTR_IFINDEX
,

2168 
	mNL80211_ATTR_IFNAME
,

2169 
	mNL80211_ATTR_IFTYPE
,

2171 
	mNL80211_ATTR_MAC
,

2173 
	mNL80211_ATTR_KEY_DATA
,

2174 
	mNL80211_ATTR_KEY_IDX
,

2175 
	mNL80211_ATTR_KEY_CIPHER
,

2176 
	mNL80211_ATTR_KEY_SEQ
,

2177 
	mNL80211_ATTR_KEY_DEFAULT
,

2179 
	mNL80211_ATTR_BEACON_INTERVAL
,

2180 
	mNL80211_ATTR_DTIM_PERIOD
,

2181 
	mNL80211_ATTR_BEACON_HEAD
,

2182 
	mNL80211_ATTR_BEACON_TAIL
,

2184 
	mNL80211_ATTR_STA_AID
,

2185 
	mNL80211_ATTR_STA_FLAGS
,

2186 
	mNL80211_ATTR_STA_LISTEN_INTERVAL
,

2187 
	mNL80211_ATTR_STA_SUPPORTED_RATES
,

2188 
	mNL80211_ATTR_STA_VLAN
,

2189 
	mNL80211_ATTR_STA_INFO
,

2191 
	mNL80211_ATTR_WIPHY_BANDS
,

2193 
	mNL80211_ATTR_MNTR_FLAGS
,

2195 
	mNL80211_ATTR_MESH_ID
,

2196 
	mNL80211_ATTR_STA_PLINK_ACTION
,

2197 
	mNL80211_ATTR_MPATH_NEXT_HOP
,

2198 
	mNL80211_ATTR_MPATH_INFO
,

2200 
	mNL80211_ATTR_BSS_CTS_PROT
,

2201 
	mNL80211_ATTR_BSS_SHORT_PREAMBLE
,

2202 
	mNL80211_ATTR_BSS_SHORT_SLOT_TIME
,

2204 
	mNL80211_ATTR_HT_CAPABILITY
,

2206 
	mNL80211_ATTR_SUPPORTED_IFTYPES
,

2208 
	mNL80211_ATTR_REG_ALPHA2
,

2209 
	mNL80211_ATTR_REG_RULES
,

2211 
	mNL80211_ATTR_MESH_CONFIG
,

2213 
	mNL80211_ATTR_BSS_BASIC_RATES
,

2215 
	mNL80211_ATTR_WIPHY_TXQ_PARAMS
,

2216 
	mNL80211_ATTR_WIPHY_FREQ
,

2217 
	mNL80211_ATTR_WIPHY_CHANNEL_TYPE
,

2219 
	mNL80211_ATTR_KEY_DEFAULT_MGMT
,

2221 
	mNL80211_ATTR_MGMT_SUBTYPE
,

2222 
	mNL80211_ATTR_IE
,

2224 
	mNL80211_ATTR_MAX_NUM_SCAN_SSIDS
,

2226 
	mNL80211_ATTR_SCAN_FREQUENCIES
,

2227 
	mNL80211_ATTR_SCAN_SSIDS
,

2228 
	mNL80211_ATTR_GENERATION
,

2229 
	mNL80211_ATTR_BSS
,

2231 
	mNL80211_ATTR_REG_INITIATOR
,

2232 
	mNL80211_ATTR_REG_TYPE
,

2234 
	mNL80211_ATTR_SUPPORTED_COMMANDS
,

2236 
	mNL80211_ATTR_FRAME
,

2237 
	mNL80211_ATTR_SSID
,

2238 
	mNL80211_ATTR_AUTH_TYPE
,

2239 
	mNL80211_ATTR_REASON_CODE
,

2241 
	mNL80211_ATTR_KEY_TYPE
,

2243 
	mNL80211_ATTR_MAX_SCAN_IE_LEN
,

2244 
	mNL80211_ATTR_CIPHER_SUITES
,

2246 
	mNL80211_ATTR_FREQ_BEFORE
,

2247 
	mNL80211_ATTR_FREQ_AFTER
,

2249 
	mNL80211_ATTR_FREQ_FIXED
,

2252 
	mNL80211_ATTR_WIPHY_RETRY_SHORT
,

2253 
	mNL80211_ATTR_WIPHY_RETRY_LONG
,

2254 
	mNL80211_ATTR_WIPHY_FRAG_THRESHOLD
,

2255 
	mNL80211_ATTR_WIPHY_RTS_THRESHOLD
,

2257 
	mNL80211_ATTR_TIMED_OUT
,

2259 
	mNL80211_ATTR_USE_MFP
,

2261 
	mNL80211_ATTR_STA_FLAGS2
,

2263 
	mNL80211_ATTR_CONTROL_PORT
,

2265 
	mNL80211_ATTR_TESTDATA
,

2267 
	mNL80211_ATTR_PRIVACY
,

2269 
	mNL80211_ATTR_DISCONNECTED_BY_AP
,

2270 
	mNL80211_ATTR_STATUS_CODE
,

2272 
	mNL80211_ATTR_CIPHER_SUITES_PAIRWISE
,

2273 
	mNL80211_ATTR_CIPHER_SUITE_GROUP
,

2274 
	mNL80211_ATTR_WPA_VERSIONS
,

2275 
	mNL80211_ATTR_AKM_SUITES
,

2277 
	mNL80211_ATTR_REQ_IE
,

2278 
	mNL80211_ATTR_RESP_IE
,

2280 
	mNL80211_ATTR_PREV_BSSID
,

2282 
	mNL80211_ATTR_KEY
,

2283 
	mNL80211_ATTR_KEYS
,

2285 
	mNL80211_ATTR_PID
,

2287 
	mNL80211_ATTR_4ADDR
,

2289 
	mNL80211_ATTR_SURVEY_INFO
,

2291 
	mNL80211_ATTR_PMKID
,

2292 
	mNL80211_ATTR_MAX_NUM_PMKIDS
,

2294 
	mNL80211_ATTR_DURATION
,

2296 
	mNL80211_ATTR_COOKIE
,

2298 
	mNL80211_ATTR_WIPHY_COVERAGE_CLASS
,

2300 
	mNL80211_ATTR_TX_RATES
,

2302 
	mNL80211_ATTR_FRAME_MATCH
,

2304 
	mNL80211_ATTR_ACK
,

2306 
	mNL80211_ATTR_PS_STATE
,

2308 
	mNL80211_ATTR_CQM
,

2310 
	mNL80211_ATTR_LOCAL_STATE_CHANGE
,

2312 
	mNL80211_ATTR_AP_ISOLATE
,

2314 
	mNL80211_ATTR_WIPHY_TX_POWER_SETTING
,

2315 
	mNL80211_ATTR_WIPHY_TX_POWER_LEVEL
,

2317 
	mNL80211_ATTR_TX_FRAME_TYPES
,

2318 
	mNL80211_ATTR_RX_FRAME_TYPES
,

2319 
	mNL80211_ATTR_FRAME_TYPE
,

2321 
	mNL80211_ATTR_CONTROL_PORT_ETHERTYPE
,

2322 
	mNL80211_ATTR_CONTROL_PORT_NO_ENCRYPT
,

2324 
	mNL80211_ATTR_SUPPORT_IBSS_RSN
,

2326 
	mNL80211_ATTR_WIPHY_ANTENNA_TX
,

2327 
	mNL80211_ATTR_WIPHY_ANTENNA_RX
,

2329 
	mNL80211_ATTR_MCAST_RATE
,

2331 
	mNL80211_ATTR_OFFCHANNEL_TX_OK
,

2333 
	mNL80211_ATTR_BSS_HT_OPMODE
,

2335 
	mNL80211_ATTR_KEY_DEFAULT_TYPES
,

2337 
	mNL80211_ATTR_MAX_REMAIN_ON_CHANNEL_DURATION
,

2339 
	mNL80211_ATTR_MESH_SETUP
,

2341 
	mNL80211_ATTR_WIPHY_ANTENNA_AVAIL_TX
,

2342 
	mNL80211_ATTR_WIPHY_ANTENNA_AVAIL_RX
,

2344 
	mNL80211_ATTR_SUPPORT_MESH_AUTH
,

2345 
	mNL80211_ATTR_STA_PLINK_STATE
,

2347 
	mNL80211_ATTR_WOWLAN_TRIGGERS
,

2348 
	mNL80211_ATTR_WOWLAN_TRIGGERS_SUPPORTED
,

2350 
	mNL80211_ATTR_SCHED_SCAN_INTERVAL
,

2352 
	mNL80211_ATTR_INTERFACE_COMBINATIONS
,

2353 
	mNL80211_ATTR_SOFTWARE_IFTYPES
,

2355 
	mNL80211_ATTR_REKEY_DATA
,

2357 
	mNL80211_ATTR_MAX_NUM_SCHED_SCAN_SSIDS
,

2358 
	mNL80211_ATTR_MAX_SCHED_SCAN_IE_LEN
,

2360 
	mNL80211_ATTR_SCAN_SUPP_RATES
,

2362 
	mNL80211_ATTR_HIDDEN_SSID
,

2364 
	mNL80211_ATTR_IE_PROBE_RESP
,

2365 
	mNL80211_ATTR_IE_ASSOC_RESP
,

2367 
	mNL80211_ATTR_STA_WME
,

2368 
	mNL80211_ATTR_SUPPORT_AP_UAPSD
,

2370 
	mNL80211_ATTR_ROAM_SUPPORT
,

2372 
	mNL80211_ATTR_SCHED_SCAN_MATCH
,

2373 
	mNL80211_ATTR_MAX_MATCH_SETS
,

2375 
	mNL80211_ATTR_PMKSA_CANDIDATE
,

2377 
	mNL80211_ATTR_TX_NO_CCK_RATE
,

2379 
	mNL80211_ATTR_TDLS_ACTION
,

2380 
	mNL80211_ATTR_TDLS_DIALOG_TOKEN
,

2381 
	mNL80211_ATTR_TDLS_OPERATION
,

2382 
	mNL80211_ATTR_TDLS_SUPPORT
,

2383 
	mNL80211_ATTR_TDLS_EXTERNAL_SETUP
,

2385 
	mNL80211_ATTR_DEVICE_AP_SME
,

2387 
	mNL80211_ATTR_DONT_WAIT_FOR_ACK
,

2389 
	mNL80211_ATTR_FEATURE_FLAGS
,

2391 
	mNL80211_ATTR_PROBE_RESP_OFFLOAD
,

2393 
	mNL80211_ATTR_PROBE_RESP
,

2395 
	mNL80211_ATTR_DFS_REGION
,

2397 
	mNL80211_ATTR_DISABLE_HT
,

2398 
	mNL80211_ATTR_HT_CAPABILITY_MASK
,

2400 
	mNL80211_ATTR_NOACK_MAP
,

2402 
	mNL80211_ATTR_INACTIVITY_TIMEOUT
,

2404 
	mNL80211_ATTR_RX_SIGNAL_DBM
,

2406 
	mNL80211_ATTR_BG_SCAN_PERIOD
,

2408 
	mNL80211_ATTR_WDEV
,

2410 
	mNL80211_ATTR_USER_REG_HINT_TYPE
,

2412 
	mNL80211_ATTR_CONN_FAILED_REASON
,

2414 
	mNL80211_ATTR_AUTH_DATA
,

2416 
	mNL80211_ATTR_VHT_CAPABILITY
,

2418 
	mNL80211_ATTR_SCAN_FLAGS
,

2420 
	mNL80211_ATTR_CHANNEL_WIDTH
,

2421 
	mNL80211_ATTR_CENTER_FREQ1
,

2422 
	mNL80211_ATTR_CENTER_FREQ2
,

2424 
	mNL80211_ATTR_P2P_CTWINDOW
,

2425 
	mNL80211_ATTR_P2P_OPPPS
,

2427 
	mNL80211_ATTR_LOCAL_MESH_POWER_MODE
,

2429 
	mNL80211_ATTR_ACL_POLICY
,

2431 
	mNL80211_ATTR_MAC_ADDRS
,

2433 
	mNL80211_ATTR_MAC_ACL_MAX
,

2435 
	mNL80211_ATTR_RADAR_EVENT
,

2437 
	mNL80211_ATTR_EXT_CAPA
,

2438 
	mNL80211_ATTR_EXT_CAPA_MASK
,

2440 
	mNL80211_ATTR_STA_CAPABILITY
,

2441 
	mNL80211_ATTR_STA_EXT_CAPABILITY
,

2443 
	mNL80211_ATTR_PROTOCOL_FEATURES
,

2444 
	mNL80211_ATTR_SPLIT_WIPHY_DUMP
,

2446 
	mNL80211_ATTR_DISABLE_VHT
,

2447 
	mNL80211_ATTR_VHT_CAPABILITY_MASK
,

2449 
	mNL80211_ATTR_MDID
,

2450 
	mNL80211_ATTR_IE_RIC
,

2452 
	mNL80211_ATTR_CRIT_PROT_ID
,

2453 
	mNL80211_ATTR_MAX_CRIT_PROT_DURATION
,

2455 
	mNL80211_ATTR_PEER_AID
,

2457 
	mNL80211_ATTR_COALESCE_RULE
,

2459 
	mNL80211_ATTR_CH_SWITCH_COUNT
,

2460 
	mNL80211_ATTR_CH_SWITCH_BLOCK_TX
,

2461 
	mNL80211_ATTR_CSA_IES
,

2462 
	mNL80211_ATTR_CSA_C_OFF_BEACON
,

2463 
	mNL80211_ATTR_CSA_C_OFF_PRESP
,

2465 
	mNL80211_ATTR_RXMGMT_FLAGS
,

2467 
	mNL80211_ATTR_STA_SUPPORTED_CHANNELS
,

2469 
	mNL80211_ATTR_STA_SUPPORTED_OPER_CLASSES
,

2471 
	mNL80211_ATTR_HANDLE_DFS
,

2473 
	mNL80211_ATTR_SUPPORT_5_MHZ
,

2474 
	mNL80211_ATTR_SUPPORT_10_MHZ
,

2476 
	mNL80211_ATTR_OPMODE_NOTIF
,

2478 
	mNL80211_ATTR_VENDOR_ID
,

2479 
	mNL80211_ATTR_VENDOR_SUBCMD
,

2480 
	mNL80211_ATTR_VENDOR_DATA
,

2481 
	mNL80211_ATTR_VENDOR_EVENTS
,

2483 
	mNL80211_ATTR_QOS_MAP
,

2485 
	mNL80211_ATTR_MAC_HINT
,

2486 
	mNL80211_ATTR_WIPHY_FREQ_HINT
,

2488 
	mNL80211_ATTR_MAX_AP_ASSOC_STA
,

2490 
	mNL80211_ATTR_TDLS_PEER_CAPABILITY
,

2492 
	mNL80211_ATTR_SOCKET_OWNER
,

2494 
	mNL80211_ATTR_CSA_C_OFFSETS_TX
,

2495 
	mNL80211_ATTR_MAX_CSA_COUNTERS
,

2497 
	mNL80211_ATTR_TDLS_INITIATOR
,

2499 
	mNL80211_ATTR_USE_RRM
,

2501 
	mNL80211_ATTR_WIPHY_DYN_ACK
,

2503 
	mNL80211_ATTR_TSID
,

2504 
	mNL80211_ATTR_USER_PRIO
,

2505 
	mNL80211_ATTR_ADMITTED_TIME
,

2507 
	mNL80211_ATTR_SMPS_MODE
,

2509 
	mNL80211_ATTR_OPER_CLASS
,

2511 
	mNL80211_ATTR_MAC_MASK
,

2513 
	mNL80211_ATTR_WIPHY_SELF_MANAGED_REG
,

2515 
	mNL80211_ATTR_EXT_FEATURES
,

2517 
	mNL80211_ATTR_SURVEY_RADIO_STATS
,

2519 
	mNL80211_ATTR_NETNS_FD
,

2521 
	mNL80211_ATTR_SCHED_SCAN_DELAY
,

2523 
	mNL80211_ATTR_REG_INDOOR
,

2525 
	mNL80211_ATTR_MAX_NUM_SCHED_SCAN_PLANS
,

2526 
	mNL80211_ATTR_MAX_SCAN_PLAN_INTERVAL
,

2527 
	mNL80211_ATTR_MAX_SCAN_PLAN_ITERATIONS
,

2528 
	mNL80211_ATTR_SCHED_SCAN_PLANS
,

2530 
	mNL80211_ATTR_PBSS
,

2532 
	mNL80211_ATTR_BSS_SELECT
,

2534 
	mNL80211_ATTR_STA_SUPPORT_P2P_PS
,

2536 
	mNL80211_ATTR_PAD
,

2538 
	mNL80211_ATTR_IFTYPE_EXT_CAPA
,

2540 
	mNL80211_ATTR_MU_MIMO_GROUP_DATA
,

2541 
	mNL80211_ATTR_MU_MIMO_FOLLOW_MAC_ADDR
,

2543 
	mNL80211_ATTR_SCAN_START_TIME_TSF
,

2544 
	mNL80211_ATTR_SCAN_START_TIME_TSF_BSSID
,

2545 
	mNL80211_ATTR_MEASUREMENT_DURATION
,

2546 
	mNL80211_ATTR_MEASUREMENT_DURATION_MANDATORY
,

2548 
	mNL80211_ATTR_MESH_PEER_AID
,

2550 
	mNL80211_ATTR_NAN_MASTER_PREF
,

2551 
	mNL80211_ATTR_BANDS
,

2552 
	mNL80211_ATTR_NAN_FUNC
,

2553 
	mNL80211_ATTR_NAN_MATCH
,

2555 
	mNL80211_ATTR_FILS_KEK
,

2556 
	mNL80211_ATTR_FILS_NONCES
,

2558 
	mNL80211_ATTR_MULTICAST_TO_UNICAST_ENABLED
,

2560 
	mNL80211_ATTR_BSSID
,

2562 
	mNL80211_ATTR_SCHED_SCAN_RELATIVE_RSSI
,

2563 
	mNL80211_ATTR_SCHED_SCAN_RSSI_ADJUST
,

2565 
	mNL80211_ATTR_TIMEOUT_REASON
,

2567 
	mNL80211_ATTR_FILS_ERP_USERNAME
,

2568 
	mNL80211_ATTR_FILS_ERP_REALM
,

2569 
	mNL80211_ATTR_FILS_ERP_NEXT_SEQ_NUM
,

2570 
	mNL80211_ATTR_FILS_ERP_RRK
,

2571 
	mNL80211_ATTR_FILS_CACHE_ID
,

2573 
	mNL80211_ATTR_PMK
,

2575 
	mNL80211_ATTR_SCHED_SCAN_MULTI
,

2576 
	mNL80211_ATTR_SCHED_SCAN_MAX_REQS
,

2578 
	mNL80211_ATTR_WANT_1X_4WAY_HS
,

2579 
	mNL80211_ATTR_PMKR0_NAME
,

2580 
	mNL80211_ATTR_PORT_AUTHORIZED
,

2584 
	m__NL80211_ATTR_AFTER_LAST
,

2585 
	mNUM_NL80211_ATTR
 = 
__NL80211_ATTR_AFTER_LAST
,

2586 
	mNL80211_ATTR_MAX
 = 
__NL80211_ATTR_AFTER_LAST
 - 1

2590 
	#NL80211_ATTR_SCAN_GENERATION
 
NL80211_ATTR_GENERATION


	)

2591 
	#NL80211_ATTR_MESH_PARAMS
 
NL80211_ATTR_MESH_CONFIG


	)

2592 
	#NL80211_ATTR_IFACE_SOCKET_OWNER
 
NL80211_ATTR_SOCKET_OWNER


	)

2593 
	#NL80211_ATTR_SAE_DATA
 
NL80211_ATTR_AUTH_DATA


	)

2599 
	#NL80211_CMD_CONNECT
 
NL80211_CMD_CONNECT


	)

2600 
	#NL80211_ATTR_HT_CAPABILITY
 
NL80211_ATTR_HT_CAPABILITY


	)

2601 
	#NL80211_ATTR_BSS_BASIC_RATES
 
NL80211_ATTR_BSS_BASIC_RATES


	)

2602 
	#NL80211_ATTR_WIPHY_TXQ_PARAMS
 
NL80211_ATTR_WIPHY_TXQ_PARAMS


	)

2603 
	#NL80211_ATTR_WIPHY_FREQ
 
NL80211_ATTR_WIPHY_FREQ


	)

2604 
	#NL80211_ATTR_WIPHY_CHANNEL_TYPE
 
NL80211_ATTR_WIPHY_CHANNEL_TYPE


	)

2605 
	#NL80211_ATTR_MGMT_SUBTYPE
 
NL80211_ATTR_MGMT_SUBTYPE


	)

2606 
	#NL80211_ATTR_IE
 
NL80211_ATTR_IE


	)

2607 
	#NL80211_ATTR_REG_INITIATOR
 
NL80211_ATTR_REG_INITIATOR


	)

2608 
	#NL80211_ATTR_REG_TYPE
 
NL80211_ATTR_REG_TYPE


	)

2609 
	#NL80211_ATTR_FRAME
 
NL80211_ATTR_FRAME


	)

2610 
	#NL80211_ATTR_SSID
 
NL80211_ATTR_SSID


	)

2611 
	#NL80211_ATTR_AUTH_TYPE
 
NL80211_ATTR_AUTH_TYPE


	)

2612 
	#NL80211_ATTR_REASON_CODE
 
NL80211_ATTR_REASON_CODE


	)

2613 
	#NL80211_ATTR_CIPHER_SUITES_PAIRWISE
 
NL80211_ATTR_CIPHER_SUITES_PAIRWISE


	)

2614 
	#NL80211_ATTR_CIPHER_SUITE_GROUP
 
NL80211_ATTR_CIPHER_SUITE_GROUP


	)

2615 
	#NL80211_ATTR_WPA_VERSIONS
 
NL80211_ATTR_WPA_VERSIONS


	)

2616 
	#NL80211_ATTR_AKM_SUITES
 
NL80211_ATTR_AKM_SUITES


	)

2617 
	#NL80211_ATTR_KEY
 
NL80211_ATTR_KEY


	)

2618 
	#NL80211_ATTR_KEYS
 
NL80211_ATTR_KEYS


	)

2619 
	#NL80211_ATTR_FEATURE_FLAGS
 
NL80211_ATTR_FEATURE_FLAGS


	)

2621 
	#NL80211_WIPHY_NAME_MAXLEN
 64

	)

2623 
	#NL80211_MAX_SUPP_RATES
 32

	)

2624 
	#NL80211_MAX_SUPP_HT_RATES
 77

	)

2625 
	#NL80211_MAX_SUPP_REG_RULES
 64

	)

2626 
	#NL80211_TKIP_DATA_OFFSET_ENCR_KEY
 0

	)

2627 
	#NL80211_TKIP_DATA_OFFSET_TX_MIC_KEY
 16

	)

2628 
	#NL80211_TKIP_DATA_OFFSET_RX_MIC_KEY
 24

	)

2629 
	#NL80211_HT_CAPABILITY_LEN
 26

	)

2630 
	#NL80211_VHT_CAPABILITY_LEN
 12

	)

2632 
	#NL80211_MAX_NR_CIPHER_SUITES
 5

	)

2633 
	#NL80211_MAX_NR_AKM_SUITES
 2

	)

2635 
	#NL80211_MIN_REMAIN_ON_CHANNEL_TIME
 10

	)

2638 
	#NL80211_SCAN_RSSI_THOLD_OFF
 -300

	)

2640 
	#NL80211_CQM_TXE_MAX_INTVL
 1800

	)

2671 
	eÆ80211_iáy³
 {

2672 
	mNL80211_IFTYPE_UNSPECIFIED
,

2673 
	mNL80211_IFTYPE_ADHOC
,

2674 
	mNL80211_IFTYPE_STATION
,

2675 
	mNL80211_IFTYPE_AP
,

2676 
	mNL80211_IFTYPE_AP_VLAN
,

2677 
	mNL80211_IFTYPE_WDS
,

2678 
	mNL80211_IFTYPE_MONITOR
,

2679 
	mNL80211_IFTYPE_MESH_POINT
,

2680 
	mNL80211_IFTYPE_P2P_CLIENT
,

2681 
	mNL80211_IFTYPE_P2P_GO
,

2682 
	mNL80211_IFTYPE_P2P_DEVICE
,

2683 
	mNL80211_IFTYPE_OCB
,

2684 
	mNL80211_IFTYPE_NAN
,

2687 
	mNUM_NL80211_IFTYPES
,

2688 
	mNL80211_IFTYPE_MAX
 = 
NUM_NL80211_IFTYPES
 - 1

2715 
	eÆ80211_¡a_æags
 {

2716 
	m__NL80211_STA_FLAG_INVALID
,

2717 
	mNL80211_STA_FLAG_AUTHORIZED
,

2718 
	mNL80211_STA_FLAG_SHORT_PREAMBLE
,

2719 
	mNL80211_STA_FLAG_WME
,

2720 
	mNL80211_STA_FLAG_MFP
,

2721 
	mNL80211_STA_FLAG_AUTHENTICATED
,

2722 
	mNL80211_STA_FLAG_TDLS_PEER
,

2723 
	mNL80211_STA_FLAG_ASSOCIATED
,

2726 
	m__NL80211_STA_FLAG_AFTER_LAST
,

2727 
	mNL80211_STA_FLAG_MAX
 = 
__NL80211_STA_FLAG_AFTER_LAST
 - 1

2737 
	eÆ80211_¡a_p2p_ps_¡©us
 {

2738 
	mNL80211_P2P_PS_UNSUPPORTED
 = 0,

2739 
	mNL80211_P2P_PS_SUPPORTED
,

2741 
	mNUM_NL80211_P2P_PS_STATUS
,

2744 
	#NL80211_STA_FLAG_MAX_OLD_API
 
NL80211_STA_FLAG_TDLS_PEER


	)

2753 
	sÆ80211_¡a_æag_upd©e
 {

2754 
__u32
 
	mmask
;

2755 
__u32
 
	m£t
;

2756 } 
__©Œibu‹__
((
·cked
));

2792 
	eÆ80211_¿‹_šfo
 {

2793 
	m__NL80211_RATE_INFO_INVALID
,

2794 
	mNL80211_RATE_INFO_BITRATE
,

2795 
	mNL80211_RATE_INFO_MCS
,

2796 
	mNL80211_RATE_INFO_40_MHZ_WIDTH
,

2797 
	mNL80211_RATE_INFO_SHORT_GI
,

2798 
	mNL80211_RATE_INFO_BITRATE32
,

2799 
	mNL80211_RATE_INFO_VHT_MCS
,

2800 
	mNL80211_RATE_INFO_VHT_NSS
,

2801 
	mNL80211_RATE_INFO_80_MHZ_WIDTH
,

2802 
	mNL80211_RATE_INFO_80P80_MHZ_WIDTH
,

2803 
	mNL80211_RATE_INFO_160_MHZ_WIDTH
,

2804 
	mNL80211_RATE_INFO_10_MHZ_WIDTH
,

2805 
	mNL80211_RATE_INFO_5_MHZ_WIDTH
,

2808 
	m__NL80211_RATE_INFO_AFTER_LAST
,

2809 
	mNL80211_RATE_INFO_MAX
 = 
__NL80211_RATE_INFO_AFTER_LAST
 - 1

2829 
	eÆ80211_¡a_bss_·¿m
 {

2830 
	m__NL80211_STA_BSS_PARAM_INVALID
,

2831 
	mNL80211_STA_BSS_PARAM_CTS_PROT
,

2832 
	mNL80211_STA_BSS_PARAM_SHORT_PREAMBLE
,

2833 
	mNL80211_STA_BSS_PARAM_SHORT_SLOT_TIME
,

2834 
	mNL80211_STA_BSS_PARAM_DTIM_PERIOD
,

2835 
	mNL80211_STA_BSS_PARAM_BEACON_INTERVAL
,

2838 
	m__NL80211_STA_BSS_PARAM_AFTER_LAST
,

2839 
	mNL80211_STA_BSS_PARAM_MAX
 = 
__NL80211_STA_BSS_PARAM_AFTER_LAST
 - 1

2907 
	eÆ80211_¡a_šfo
 {

2908 
	m__NL80211_STA_INFO_INVALID
,

2909 
	mNL80211_STA_INFO_INACTIVE_TIME
,

2910 
	mNL80211_STA_INFO_RX_BYTES
,

2911 
	mNL80211_STA_INFO_TX_BYTES
,

2912 
	mNL80211_STA_INFO_LLID
,

2913 
	mNL80211_STA_INFO_PLID
,

2914 
	mNL80211_STA_INFO_PLINK_STATE
,

2915 
	mNL80211_STA_INFO_SIGNAL
,

2916 
	mNL80211_STA_INFO_TX_BITRATE
,

2917 
	mNL80211_STA_INFO_RX_PACKETS
,

2918 
	mNL80211_STA_INFO_TX_PACKETS
,

2919 
	mNL80211_STA_INFO_TX_RETRIES
,

2920 
	mNL80211_STA_INFO_TX_FAILED
,

2921 
	mNL80211_STA_INFO_SIGNAL_AVG
,

2922 
	mNL80211_STA_INFO_RX_BITRATE
,

2923 
	mNL80211_STA_INFO_BSS_PARAM
,

2924 
	mNL80211_STA_INFO_CONNECTED_TIME
,

2925 
	mNL80211_STA_INFO_STA_FLAGS
,

2926 
	mNL80211_STA_INFO_BEACON_LOSS
,

2927 
	mNL80211_STA_INFO_T_OFFSET
,

2928 
	mNL80211_STA_INFO_LOCAL_PM
,

2929 
	mNL80211_STA_INFO_PEER_PM
,

2930 
	mNL80211_STA_INFO_NONPEER_PM
,

2931 
	mNL80211_STA_INFO_RX_BYTES64
,

2932 
	mNL80211_STA_INFO_TX_BYTES64
,

2933 
	mNL80211_STA_INFO_CHAIN_SIGNAL
,

2934 
	mNL80211_STA_INFO_CHAIN_SIGNAL_AVG
,

2935 
	mNL80211_STA_INFO_EXPECTED_THROUGHPUT
,

2936 
	mNL80211_STA_INFO_RX_DROP_MISC
,

2937 
	mNL80211_STA_INFO_BEACON_RX
,

2938 
	mNL80211_STA_INFO_BEACON_SIGNAL_AVG
,

2939 
	mNL80211_STA_INFO_TID_STATS
,

2940 
	mNL80211_STA_INFO_RX_DURATION
,

2941 
	mNL80211_STA_INFO_PAD
,

2944 
	m__NL80211_STA_INFO_AFTER_LAST
,

2945 
	mNL80211_STA_INFO_MAX
 = 
__NL80211_STA_INFO_AFTER_LAST
 - 1

2962 
	eÆ80211_tid_¡©s
 {

2963 
	m__NL80211_TID_STATS_INVALID
,

2964 
	mNL80211_TID_STATS_RX_MSDU
,

2965 
	mNL80211_TID_STATS_TX_MSDU
,

2966 
	mNL80211_TID_STATS_TX_MSDU_RETRIES
,

2967 
	mNL80211_TID_STATS_TX_MSDU_FAILED
,

2968 
	mNL80211_TID_STATS_PAD
,

2971 
	mNUM_NL80211_TID_STATS
,

2972 
	mNL80211_TID_STATS_MAX
 = 
NUM_NL80211_TID_STATS
 - 1

2984 
	eÆ80211_m·th_æags
 {

2985 
	mNL80211_MPATH_FLAG_ACTIVE
 = 1<<0,

2986 
	mNL80211_MPATH_FLAG_RESOLVING
 = 1<<1,

2987 
	mNL80211_MPATH_FLAG_SN_VALID
 = 1<<2,

2988 
	mNL80211_MPATH_FLAG_FIXED
 = 1<<3,

2989 
	mNL80211_MPATH_FLAG_RESOLVED
 = 1<<4,

3011 
	eÆ80211_m·th_šfo
 {

3012 
	m__NL80211_MPATH_INFO_INVALID
,

3013 
	mNL80211_MPATH_INFO_FRAME_QLEN
,

3014 
	mNL80211_MPATH_INFO_SN
,

3015 
	mNL80211_MPATH_INFO_METRIC
,

3016 
	mNL80211_MPATH_INFO_EXPTIME
,

3017 
	mNL80211_MPATH_INFO_FLAGS
,

3018 
	mNL80211_MPATH_INFO_DISCOVERY_TIMEOUT
,

3019 
	mNL80211_MPATH_INFO_DISCOVERY_RETRIES
,

3022 
	m__NL80211_MPATH_INFO_AFTER_LAST
,

3023 
	mNL80211_MPATH_INFO_MAX
 = 
__NL80211_MPATH_INFO_AFTER_LAST
 - 1

3044 
	eÆ80211_bªd_©Œ
 {

3045 
	m__NL80211_BAND_ATTR_INVALID
,

3046 
	mNL80211_BAND_ATTR_FREQS
,

3047 
	mNL80211_BAND_ATTR_RATES
,

3049 
	mNL80211_BAND_ATTR_HT_MCS_SET
,

3050 
	mNL80211_BAND_ATTR_HT_CAPA
,

3051 
	mNL80211_BAND_ATTR_HT_AMPDU_FACTOR
,

3052 
	mNL80211_BAND_ATTR_HT_AMPDU_DENSITY
,

3054 
	mNL80211_BAND_ATTR_VHT_MCS_SET
,

3055 
	mNL80211_BAND_ATTR_VHT_CAPA
,

3058 
	m__NL80211_BAND_ATTR_AFTER_LAST
,

3059 
	mNL80211_BAND_ATTR_MAX
 = 
__NL80211_BAND_ATTR_AFTER_LAST
 - 1

3062 
	#NL80211_BAND_ATTR_HT_CAPA
 
NL80211_BAND_ATTR_HT_CAPA


	)

3122 
	eÆ80211_äequ’cy_©Œ
 {

3123 
	m__NL80211_FREQUENCY_ATTR_INVALID
,

3124 
	mNL80211_FREQUENCY_ATTR_FREQ
,

3125 
	mNL80211_FREQUENCY_ATTR_DISABLED
,

3126 
	mNL80211_FREQUENCY_ATTR_NO_IR
,

3127 
	m__NL80211_FREQUENCY_ATTR_NO_IBSS
,

3128 
	mNL80211_FREQUENCY_ATTR_RADAR
,

3129 
	mNL80211_FREQUENCY_ATTR_MAX_TX_POWER
,

3130 
	mNL80211_FREQUENCY_ATTR_DFS_STATE
,

3131 
	mNL80211_FREQUENCY_ATTR_DFS_TIME
,

3132 
	mNL80211_FREQUENCY_ATTR_NO_HT40_MINUS
,

3133 
	mNL80211_FREQUENCY_ATTR_NO_HT40_PLUS
,

3134 
	mNL80211_FREQUENCY_ATTR_NO_80MHZ
,

3135 
	mNL80211_FREQUENCY_ATTR_NO_160MHZ
,

3136 
	mNL80211_FREQUENCY_ATTR_DFS_CAC_TIME
,

3137 
	mNL80211_FREQUENCY_ATTR_INDOOR_ONLY
,

3138 
	mNL80211_FREQUENCY_ATTR_IR_CONCURRENT
,

3139 
	mNL80211_FREQUENCY_ATTR_NO_20MHZ
,

3140 
	mNL80211_FREQUENCY_ATTR_NO_10MHZ
,

3143 
	m__NL80211_FREQUENCY_ATTR_AFTER_LAST
,

3144 
	mNL80211_FREQUENCY_ATTR_MAX
 = 
__NL80211_FREQUENCY_ATTR_AFTER_LAST
 - 1

3147 
	#NL80211_FREQUENCY_ATTR_MAX_TX_POWER
 
NL80211_FREQUENCY_ATTR_MAX_TX_POWER


	)

3148 
	#NL80211_FREQUENCY_ATTR_PASSIVE_SCAN
 
NL80211_FREQUENCY_ATTR_NO_IR


	)

3149 
	#NL80211_FREQUENCY_ATTR_NO_IBSS
 
NL80211_FREQUENCY_ATTR_NO_IR


	)

3150 
	#NL80211_FREQUENCY_ATTR_NO_IR
 
NL80211_FREQUENCY_ATTR_NO_IR


	)

3151 
	#NL80211_FREQUENCY_ATTR_GO_CONCURRENT
 \

3152 
NL80211_FREQUENCY_ATTR_IR_CONCURRENT


	)

3164 
	eÆ80211_b™¿‹_©Œ
 {

3165 
	m__NL80211_BITRATE_ATTR_INVALID
,

3166 
	mNL80211_BITRATE_ATTR_RATE
,

3167 
	mNL80211_BITRATE_ATTR_2GHZ_SHORTPREAMBLE
,

3170 
	m__NL80211_BITRATE_ATTR_AFTER_LAST
,

3171 
	mNL80211_BITRATE_ATTR_MAX
 = 
__NL80211_BITRATE_ATTR_AFTER_LAST
 - 1

3190 
	eÆ80211_»g_š™ŸtÜ
 {

3191 
	mNL80211_REGDOM_SET_BY_CORE
,

3192 
	mNL80211_REGDOM_SET_BY_USER
,

3193 
	mNL80211_REGDOM_SET_BY_DRIVER
,

3194 
	mNL80211_REGDOM_SET_BY_COUNTRY_IE
,

3213 
	eÆ80211_»g_ty³
 {

3214 
	mNL80211_REGDOM_TYPE_COUNTRY
,

3215 
	mNL80211_REGDOM_TYPE_WORLD
,

3216 
	mNL80211_REGDOM_TYPE_CUSTOM_WORLD
,

3217 
	mNL80211_REGDOM_TYPE_INTERSECTION
,

3245 
	eÆ80211_»g_ruË_©Œ
 {

3246 
	m__NL80211_REG_RULE_ATTR_INVALID
,

3247 
	mNL80211_ATTR_REG_RULE_FLAGS
,

3249 
	mNL80211_ATTR_FREQ_RANGE_START
,

3250 
	mNL80211_ATTR_FREQ_RANGE_END
,

3251 
	mNL80211_ATTR_FREQ_RANGE_MAX_BW
,

3253 
	mNL80211_ATTR_POWER_RULE_MAX_ANT_GAIN
,

3254 
	mNL80211_ATTR_POWER_RULE_MAX_EIRP
,

3256 
	mNL80211_ATTR_DFS_CAC_TIME
,

3259 
	m__NL80211_REG_RULE_ATTR_AFTER_LAST
,

3260 
	mNL80211_REG_RULE_ATTR_MAX
 = 
__NL80211_REG_RULE_ATTR_AFTER_LAST
 - 1

3290 
	eÆ80211_sched_sÿn_m©ch_©Œ
 {

3291 
	m__NL80211_SCHED_SCAN_MATCH_ATTR_INVALID
,

3293 
	mNL80211_SCHED_SCAN_MATCH_ATTR_SSID
,

3294 
	mNL80211_SCHED_SCAN_MATCH_ATTR_RSSI
,

3295 
	mNL80211_SCHED_SCAN_MATCH_ATTR_RELATIVE_RSSI
,

3296 
	mNL80211_SCHED_SCAN_MATCH_ATTR_RSSI_ADJUST
,

3297 
	mNL80211_SCHED_SCAN_MATCH_ATTR_BSSID
,

3300 
	m__NL80211_SCHED_SCAN_MATCH_ATTR_AFTER_LAST
,

3301 
	mNL80211_SCHED_SCAN_MATCH_ATTR_MAX
 =

3302 
__NL80211_SCHED_SCAN_MATCH_ATTR_AFTER_LAST
 - 1

3306 
	#NL80211_ATTR_SCHED_SCAN_MATCH_SSID
 
NL80211_SCHED_SCAN_MATCH_ATTR_SSID


	)

3330 
	eÆ80211_»g_ruË_æags
 {

3331 
	mNL80211_RRF_NO_OFDM
 = 1<<0,

3332 
	mNL80211_RRF_NO_CCK
 = 1<<1,

3333 
	mNL80211_RRF_NO_INDOOR
 = 1<<2,

3334 
	mNL80211_RRF_NO_OUTDOOR
 = 1<<3,

3335 
	mNL80211_RRF_DFS
 = 1<<4,

3336 
	mNL80211_RRF_PTP_ONLY
 = 1<<5,

3337 
	mNL80211_RRF_PTMP_ONLY
 = 1<<6,

3338 
	mNL80211_RRF_NO_IR
 = 1<<7,

3339 
	m__NL80211_RRF_NO_IBSS
 = 1<<8,

3340 
	mNL80211_RRF_AUTO_BW
 = 1<<11,

3341 
	mNL80211_RRF_IR_CONCURRENT
 = 1<<12,

3342 
	mNL80211_RRF_NO_HT40MINUS
 = 1<<13,

3343 
	mNL80211_RRF_NO_HT40PLUS
 = 1<<14,

3344 
	mNL80211_RRF_NO_80MHZ
 = 1<<15,

3345 
	mNL80211_RRF_NO_160MHZ
 = 1<<16,

3348 
	#NL80211_RRF_PASSIVE_SCAN
 
NL80211_RRF_NO_IR


	)

3349 
	#NL80211_RRF_NO_IBSS
 
NL80211_RRF_NO_IR


	)

3350 
	#NL80211_RRF_NO_IR
 
NL80211_RRF_NO_IR


	)

3351 
	#NL80211_RRF_NO_HT40
 (
NL80211_RRF_NO_HT40MINUS
 |\

3352 
NL80211_RRF_NO_HT40PLUS
)

	)

3353 
	#NL80211_RRF_GO_CONCURRENT
 
NL80211_RRF_IR_CONCURRENT


	)

3356 
	#NL80211_RRF_NO_IR_ALL
 (
NL80211_RRF_NO_IR
 | 
__NL80211_RRF_NO_IBSS
)

	)

3366 
	eÆ80211_dfs_»giÚs
 {

3367 
	mNL80211_DFS_UNSET
 = 0,

3368 
	mNL80211_DFS_FCC
 = 1,

3369 
	mNL80211_DFS_ETSI
 = 2,

3370 
	mNL80211_DFS_JP
 = 3,

3390 
	eÆ80211_u£r_»g_hšt_ty³
 {

3391 
	mNL80211_USER_REG_HINT_USER
 = 0,

3392 
	mNL80211_USER_REG_HINT_CELL_BASE
 = 1,

3393 
	mNL80211_USER_REG_HINT_INDOOR
 = 2,

3423 
	eÆ80211_survey_šfo
 {

3424 
	m__NL80211_SURVEY_INFO_INVALID
,

3425 
	mNL80211_SURVEY_INFO_FREQUENCY
,

3426 
	mNL80211_SURVEY_INFO_NOISE
,

3427 
	mNL80211_SURVEY_INFO_IN_USE
,

3428 
	mNL80211_SURVEY_INFO_TIME
,

3429 
	mNL80211_SURVEY_INFO_TIME_BUSY
,

3430 
	mNL80211_SURVEY_INFO_TIME_EXT_BUSY
,

3431 
	mNL80211_SURVEY_INFO_TIME_RX
,

3432 
	mNL80211_SURVEY_INFO_TIME_TX
,

3433 
	mNL80211_SURVEY_INFO_TIME_SCAN
,

3434 
	mNL80211_SURVEY_INFO_PAD
,

3437 
	m__NL80211_SURVEY_INFO_AFTER_LAST
,

3438 
	mNL80211_SURVEY_INFO_MAX
 = 
__NL80211_SURVEY_INFO_AFTER_LAST
 - 1

3442 
	#NL80211_SURVEY_INFO_CHANNEL_TIME
 
NL80211_SURVEY_INFO_TIME


	)

3443 
	#NL80211_SURVEY_INFO_CHANNEL_TIME_BUSY
 
NL80211_SURVEY_INFO_TIME_BUSY


	)

3444 
	#NL80211_SURVEY_INFO_CHANNEL_TIME_EXT_BUSY
 
NL80211_SURVEY_INFO_TIME_EXT_BUSY


	)

3445 
	#NL80211_SURVEY_INFO_CHANNEL_TIME_RX
 
NL80211_SURVEY_INFO_TIME_RX


	)

3446 
	#NL80211_SURVEY_INFO_CHANNEL_TIME_TX
 
NL80211_SURVEY_INFO_TIME_TX


	)

3467 
	eÆ80211_mÁr_æags
 {

3468 
	m__NL80211_MNTR_FLAG_INVALID
,

3469 
	mNL80211_MNTR_FLAG_FCSFAIL
,

3470 
	mNL80211_MNTR_FLAG_PLCPFAIL
,

3471 
	mNL80211_MNTR_FLAG_CONTROL
,

3472 
	mNL80211_MNTR_FLAG_OTHER_BSS
,

3473 
	mNL80211_MNTR_FLAG_COOK_FRAMES
,

3474 
	mNL80211_MNTR_FLAG_ACTIVE
,

3477 
	m__NL80211_MNTR_FLAG_AFTER_LAST
,

3478 
	mNL80211_MNTR_FLAG_MAX
 = 
__NL80211_MNTR_FLAG_AFTER_LAST
 - 1

3499 
	eÆ80211_mesh_pow”_mode
 {

3500 
	mNL80211_MESH_POWER_UNKNOWN
,

3501 
	mNL80211_MESH_POWER_ACTIVE
,

3502 
	mNL80211_MESH_POWER_LIGHT_SLEEP
,

3503 
	mNL80211_MESH_POWER_DEEP_SLEEP
,

3505 
	m__NL80211_MESH_POWER_AFTER_LAST
,

3506 
	mNL80211_MESH_POWER_MAX
 = 
__NL80211_MESH_POWER_AFTER_LAST
 - 1

3617 
	eÆ80211_meshcÚf_·¿ms
 {

3618 
	m__NL80211_MESHCONF_INVALID
,

3619 
	mNL80211_MESHCONF_RETRY_TIMEOUT
,

3620 
	mNL80211_MESHCONF_CONFIRM_TIMEOUT
,

3621 
	mNL80211_MESHCONF_HOLDING_TIMEOUT
,

3622 
	mNL80211_MESHCONF_MAX_PEER_LINKS
,

3623 
	mNL80211_MESHCONF_MAX_RETRIES
,

3624 
	mNL80211_MESHCONF_TTL
,

3625 
	mNL80211_MESHCONF_AUTO_OPEN_PLINKS
,

3626 
	mNL80211_MESHCONF_HWMP_MAX_PREQ_RETRIES
,

3627 
	mNL80211_MESHCONF_PATH_REFRESH_TIME
,

3628 
	mNL80211_MESHCONF_MIN_DISCOVERY_TIMEOUT
,

3629 
	mNL80211_MESHCONF_HWMP_ACTIVE_PATH_TIMEOUT
,

3630 
	mNL80211_MESHCONF_HWMP_PREQ_MIN_INTERVAL
,

3631 
	mNL80211_MESHCONF_HWMP_NET_DIAM_TRVS_TIME
,

3632 
	mNL80211_MESHCONF_HWMP_ROOTMODE
,

3633 
	mNL80211_MESHCONF_ELEMENT_TTL
,

3634 
	mNL80211_MESHCONF_HWMP_RANN_INTERVAL
,

3635 
	mNL80211_MESHCONF_GATE_ANNOUNCEMENTS
,

3636 
	mNL80211_MESHCONF_HWMP_PERR_MIN_INTERVAL
,

3637 
	mNL80211_MESHCONF_FORWARDING
,

3638 
	mNL80211_MESHCONF_RSSI_THRESHOLD
,

3639 
	mNL80211_MESHCONF_SYNC_OFFSET_MAX_NEIGHBOR
,

3640 
	mNL80211_MESHCONF_HT_OPMODE
,

3641 
	mNL80211_MESHCONF_HWMP_PATH_TO_ROOT_TIMEOUT
,

3642 
	mNL80211_MESHCONF_HWMP_ROOT_INTERVAL
,

3643 
	mNL80211_MESHCONF_HWMP_CONFIRMATION_INTERVAL
,

3644 
	mNL80211_MESHCONF_POWER_MODE
,

3645 
	mNL80211_MESHCONF_AWAKE_WINDOW
,

3646 
	mNL80211_MESHCONF_PLINK_TIMEOUT
,

3649 
	m__NL80211_MESHCONF_ATTR_AFTER_LAST
,

3650 
	mNL80211_MESHCONF_ATTR_MAX
 = 
__NL80211_MESHCONF_ATTR_AFTER_LAST
 - 1

3702 
	eÆ80211_mesh_£tup_·¿ms
 {

3703 
	m__NL80211_MESH_SETUP_INVALID
,

3704 
	mNL80211_MESH_SETUP_ENABLE_VENDOR_PATH_SEL
,

3705 
	mNL80211_MESH_SETUP_ENABLE_VENDOR_METRIC
,

3706 
	mNL80211_MESH_SETUP_IE
,

3707 
	mNL80211_MESH_SETUP_USERSPACE_AUTH
,

3708 
	mNL80211_MESH_SETUP_USERSPACE_AMPE
,

3709 
	mNL80211_MESH_SETUP_ENABLE_VENDOR_SYNC
,

3710 
	mNL80211_MESH_SETUP_USERSPACE_MPM
,

3711 
	mNL80211_MESH_SETUP_AUTH_PROTOCOL
,

3714 
	m__NL80211_MESH_SETUP_ATTR_AFTER_LAST
,

3715 
	mNL80211_MESH_SETUP_ATTR_MAX
 = 
__NL80211_MESH_SETUP_ATTR_AFTER_LAST
 - 1

3732 
	eÆ80211_txq_©Œ
 {

3733 
	m__NL80211_TXQ_ATTR_INVALID
,

3734 
	mNL80211_TXQ_ATTR_AC
,

3735 
	mNL80211_TXQ_ATTR_TXOP
,

3736 
	mNL80211_TXQ_ATTR_CWMIN
,

3737 
	mNL80211_TXQ_ATTR_CWMAX
,

3738 
	mNL80211_TXQ_ATTR_AIFS
,

3741 
	m__NL80211_TXQ_ATTR_AFTER_LAST
,

3742 
	mNL80211_TXQ_ATTR_MAX
 = 
__NL80211_TXQ_ATTR_AFTER_LAST
 - 1

3745 
	eÆ80211_ac
 {

3746 
	mNL80211_AC_VO
,

3747 
	mNL80211_AC_VI
,

3748 
	mNL80211_AC_BE
,

3749 
	mNL80211_AC_BK
,

3750 
	mNL80211_NUM_ACS


3754 
	#NL80211_TXQ_ATTR_QUEUE
 
NL80211_TXQ_ATTR_AC


	)

3755 
	#NL80211_TXQ_Q_VO
 
NL80211_AC_VO


	)

3756 
	#NL80211_TXQ_Q_VI
 
NL80211_AC_VI


	)

3757 
	#NL80211_TXQ_Q_BE
 
NL80211_AC_BE


	)

3758 
	#NL80211_TXQ_Q_BK
 
NL80211_AC_BK


	)

3769 
	eÆ80211_chªÃl_ty³
 {

3770 
	mNL80211_CHAN_NO_HT
,

3771 
	mNL80211_CHAN_HT20
,

3772 
	mNL80211_CHAN_HT40MINUS
,

3773 
	mNL80211_CHAN_HT40PLUS


3795 
	eÆ80211_chª_width
 {

3796 
	mNL80211_CHAN_WIDTH_20_NOHT
,

3797 
	mNL80211_CHAN_WIDTH_20
,

3798 
	mNL80211_CHAN_WIDTH_40
,

3799 
	mNL80211_CHAN_WIDTH_80
,

3800 
	mNL80211_CHAN_WIDTH_80P80
,

3801 
	mNL80211_CHAN_WIDTH_160
,

3802 
	mNL80211_CHAN_WIDTH_5
,

3803 
	mNL80211_CHAN_WIDTH_10
,

3815 
	eÆ80211_bss_sÿn_width
 {

3816 
	mNL80211_BSS_CHAN_WIDTH_20
,

3817 
	mNL80211_BSS_CHAN_WIDTH_10
,

3818 
	mNL80211_BSS_CHAN_WIDTH_5
,

3870 
	eÆ80211_bss
 {

3871 
	m__NL80211_BSS_INVALID
,

3872 
	mNL80211_BSS_BSSID
,

3873 
	mNL80211_BSS_FREQUENCY
,

3874 
	mNL80211_BSS_TSF
,

3875 
	mNL80211_BSS_BEACON_INTERVAL
,

3876 
	mNL80211_BSS_CAPABILITY
,

3877 
	mNL80211_BSS_INFORMATION_ELEMENTS
,

3878 
	mNL80211_BSS_SIGNAL_MBM
,

3879 
	mNL80211_BSS_SIGNAL_UNSPEC
,

3880 
	mNL80211_BSS_STATUS
,

3881 
	mNL80211_BSS_SEEN_MS_AGO
,

3882 
	mNL80211_BSS_BEACON_IES
,

3883 
	mNL80211_BSS_CHAN_WIDTH
,

3884 
	mNL80211_BSS_BEACON_TSF
,

3885 
	mNL80211_BSS_PRESP_DATA
,

3886 
	mNL80211_BSS_LAST_SEEN_BOOTTIME
,

3887 
	mNL80211_BSS_PAD
,

3888 
	mNL80211_BSS_PARENT_TSF
,

3889 
	mNL80211_BSS_PARENT_BSSID
,

3892 
	m__NL80211_BSS_AFTER_LAST
,

3893 
	mNL80211_BSS_MAX
 = 
__NL80211_BSS_AFTER_LAST
 - 1

3908 
	eÆ80211_bss_¡©us
 {

3909 
	mNL80211_BSS_STATUS_AUTHENTICATED
,

3910 
	mNL80211_BSS_STATUS_ASSOCIATED
,

3911 
	mNL80211_BSS_STATUS_IBSS_JOINED
,

3931 
	eÆ80211_auth_ty³
 {

3932 
	mNL80211_AUTHTYPE_OPEN_SYSTEM
,

3933 
	mNL80211_AUTHTYPE_SHARED_KEY
,

3934 
	mNL80211_AUTHTYPE_FT
,

3935 
	mNL80211_AUTHTYPE_NETWORK_EAP
,

3936 
	mNL80211_AUTHTYPE_SAE
,

3937 
	mNL80211_AUTHTYPE_FILS_SK
,

3938 
	mNL80211_AUTHTYPE_FILS_SK_PFS
,

3939 
	mNL80211_AUTHTYPE_FILS_PK
,

3942 
	m__NL80211_AUTHTYPE_NUM
,

3943 
	mNL80211_AUTHTYPE_MAX
 = 
__NL80211_AUTHTYPE_NUM
 - 1,

3944 
	mNL80211_AUTHTYPE_AUTOMATIC


3954 
	eÆ80211_key_ty³
 {

3955 
	mNL80211_KEYTYPE_GROUP
,

3956 
	mNL80211_KEYTYPE_PAIRWISE
,

3957 
	mNL80211_KEYTYPE_PEERKEY
,

3959 
	mNUM_NL80211_KEYTYPES


3968 
	eÆ80211_må
 {

3969 
	mNL80211_MFP_NO
,

3970 
	mNL80211_MFP_REQUIRED
,

3971 
	mNL80211_MFP_OPTIONAL
,

3974 
	eÆ80211_w·_v”siÚs
 {

3975 
	mNL80211_WPA_VERSION_1
 = 1 << 0,

3976 
	mNL80211_WPA_VERSION_2
 = 1 << 1,

3988 
	eÆ80211_key_deçuÉ_ty³s
 {

3989 
	m__NL80211_KEY_DEFAULT_TYPE_INVALID
,

3990 
	mNL80211_KEY_DEFAULT_TYPE_UNICAST
,

3991 
	mNL80211_KEY_DEFAULT_TYPE_MULTICAST
,

3993 
	mNUM_NL80211_KEY_DEFAULT_TYPES


4018 
	eÆ80211_key_©Œibu‹s
 {

4019 
	m__NL80211_KEY_INVALID
,

4020 
	mNL80211_KEY_DATA
,

4021 
	mNL80211_KEY_IDX
,

4022 
	mNL80211_KEY_CIPHER
,

4023 
	mNL80211_KEY_SEQ
,

4024 
	mNL80211_KEY_DEFAULT
,

4025 
	mNL80211_KEY_DEFAULT_MGMT
,

4026 
	mNL80211_KEY_TYPE
,

4027 
	mNL80211_KEY_DEFAULT_TYPES
,

4030 
	m__NL80211_KEY_AFTER_LAST
,

4031 
	mNL80211_KEY_MAX
 = 
__NL80211_KEY_AFTER_LAST
 - 1

4049 
	eÆ80211_tx_¿‹_©Œibu‹s
 {

4050 
	m__NL80211_TXRATE_INVALID
,

4051 
	mNL80211_TXRATE_LEGACY
,

4052 
	mNL80211_TXRATE_HT
,

4053 
	mNL80211_TXRATE_VHT
,

4054 
	mNL80211_TXRATE_GI
,

4057 
	m__NL80211_TXRATE_AFTER_LAST
,

4058 
	mNL80211_TXRATE_MAX
 = 
__NL80211_TXRATE_AFTER_LAST
 - 1

4061 
	#NL80211_TXRATE_MCS
 
NL80211_TXRATE_HT


	)

4062 
	#NL80211_VHT_NSS_MAX
 8

	)

4068 
	sÆ80211_tx¿‹_vht
 {

4069 
__u16
 
	mmcs
[
NL80211_VHT_NSS_MAX
];

4072 
	eÆ80211_tx¿‹_gi
 {

4073 
	mNL80211_TXRATE_DEFAULT_GI
,

4074 
	mNL80211_TXRATE_FORCE_SGI
,

4075 
	mNL80211_TXRATE_FORCE_LGI
,

4086 
	eÆ80211_bªd
 {

4087 
	mNL80211_BAND_2GHZ
,

4088 
	mNL80211_BAND_5GHZ
,

4089 
	mNL80211_BAND_60GHZ
,

4091 
	mNUM_NL80211_BANDS
,

4099 
	eÆ80211_ps_¡©e
 {

4100 
	mNL80211_PS_DISABLED
,

4101 
	mNL80211_PS_ENABLED
,

4137 
	eÆ80211_©Œ_cqm
 {

4138 
	m__NL80211_ATTR_CQM_INVALID
,

4139 
	mNL80211_ATTR_CQM_RSSI_THOLD
,

4140 
	mNL80211_ATTR_CQM_RSSI_HYST
,

4141 
	mNL80211_ATTR_CQM_RSSI_THRESHOLD_EVENT
,

4142 
	mNL80211_ATTR_CQM_PKT_LOSS_EVENT
,

4143 
	mNL80211_ATTR_CQM_TXE_RATE
,

4144 
	mNL80211_ATTR_CQM_TXE_PKTS
,

4145 
	mNL80211_ATTR_CQM_TXE_INTVL
,

4146 
	mNL80211_ATTR_CQM_BEACON_LOSS_EVENT
,

4147 
	mNL80211_ATTR_CQM_RSSI_LEVEL
,

4150 
	m__NL80211_ATTR_CQM_AFTER_LAST
,

4151 
	mNL80211_ATTR_CQM_MAX
 = 
__NL80211_ATTR_CQM_AFTER_LAST
 - 1

4162 
	eÆ80211_cqm_rssi_th»shŞd_ev’t
 {

4163 
	mNL80211_CQM_RSSI_THRESHOLD_EVENT_LOW
,

4164 
	mNL80211_CQM_RSSI_THRESHOLD_EVENT_HIGH
,

4165 
	mNL80211_CQM_RSSI_BEACON_LOSS_EVENT
,

4175 
	eÆ80211_tx_pow”_£‰šg
 {

4176 
	mNL80211_TX_POWER_AUTOMATIC
,

4177 
	mNL80211_TX_POWER_LIMITED
,

4178 
	mNL80211_TX_POWER_FIXED
,

4202 
	eÆ80211_·ck‘_·‰”n_©Œ
 {

4203 
	m__NL80211_PKTPAT_INVALID
,

4204 
	mNL80211_PKTPAT_MASK
,

4205 
	mNL80211_PKTPAT_PATTERN
,

4206 
	mNL80211_PKTPAT_OFFSET
,

4208 
	mNUM_NL80211_PKTPAT
,

4209 
	mMAX_NL80211_PKTPAT
 = 
NUM_NL80211_PKTPAT
 - 1,

4225 
	sÆ80211_·‰”n_suµÜt
 {

4226 
__u32
 
	mmax_·‰”ns
;

4227 
__u32
 
	mmš_·‰”n_Ën
;

4228 
__u32
 
	mmax_·‰”n_Ën
;

4229 
__u32
 
	mmax_pkt_off£t
;

4230 } 
__©Œibu‹__
((
·cked
));

4233 
	#__NL80211_WOWLAN_PKTPAT_INVALID
 
__NL80211_PKTPAT_INVALID


	)

4234 
	#NL80211_WOWLAN_PKTPAT_MASK
 
NL80211_PKTPAT_MASK


	)

4235 
	#NL80211_WOWLAN_PKTPAT_PATTERN
 
NL80211_PKTPAT_PATTERN


	)

4236 
	#NL80211_WOWLAN_PKTPAT_OFFSET
 
NL80211_PKTPAT_OFFSET


	)

4237 
	#NUM_NL80211_WOWLAN_PKTPAT
 
NUM_NL80211_PKTPAT


	)

4238 
	#MAX_NL80211_WOWLAN_PKTPAT
 
MAX_NL80211_PKTPAT


	)

4239 
	#Æ80211_wowÏn_·‰”n_suµÜt
 
Æ80211_·‰”n_suµÜt


	)

4330 
	eÆ80211_wowÏn_Œigg”s
 {

4331 
	m__NL80211_WOWLAN_TRIG_INVALID
,

4332 
	mNL80211_WOWLAN_TRIG_ANY
,

4333 
	mNL80211_WOWLAN_TRIG_DISCONNECT
,

4334 
	mNL80211_WOWLAN_TRIG_MAGIC_PKT
,

4335 
	mNL80211_WOWLAN_TRIG_PKT_PATTERN
,

4336 
	mNL80211_WOWLAN_TRIG_GTK_REKEY_SUPPORTED
,

4337 
	mNL80211_WOWLAN_TRIG_GTK_REKEY_FAILURE
,

4338 
	mNL80211_WOWLAN_TRIG_EAP_IDENT_REQUEST
,

4339 
	mNL80211_WOWLAN_TRIG_4WAY_HANDSHAKE
,

4340 
	mNL80211_WOWLAN_TRIG_RFKILL_RELEASE
,

4341 
	mNL80211_WOWLAN_TRIG_WAKEUP_PKT_80211
,

4342 
	mNL80211_WOWLAN_TRIG_WAKEUP_PKT_80211_LEN
,

4343 
	mNL80211_WOWLAN_TRIG_WAKEUP_PKT_8023
,

4344 
	mNL80211_WOWLAN_TRIG_WAKEUP_PKT_8023_LEN
,

4345 
	mNL80211_WOWLAN_TRIG_TCP_CONNECTION
,

4346 
	mNL80211_WOWLAN_TRIG_WAKEUP_TCP_MATCH
,

4347 
	mNL80211_WOWLAN_TRIG_WAKEUP_TCP_CONNLOST
,

4348 
	mNL80211_WOWLAN_TRIG_WAKEUP_TCP_NOMORETOKENS
,

4349 
	mNL80211_WOWLAN_TRIG_NET_DETECT
,

4350 
	mNL80211_WOWLAN_TRIG_NET_DETECT_RESULTS
,

4353 
	mNUM_NL80211_WOWLAN_TRIG
,

4354 
	mMAX_NL80211_WOWLAN_TRIG
 = 
NUM_NL80211_WOWLAN_TRIG
 - 1

4390 
	sÆ80211_wowÏn_tı_d©a_£q
 {

4391 
__u32
 
	m¡¬t
, 
	moff£t
, 
	mËn
;

4401 
	sÆ80211_wowÏn_tı_d©a_tok’
 {

4402 
__u32
 
	moff£t
, 
	mËn
;

4403 
__u8
 
	mtok’_¡»am
[];

4412 
	sÆ80211_wowÏn_tı_d©a_tok’_ã©u»
 {

4413 
__u32
 
	mmš_Ën
, 
	mmax_Ën
, 
	mbufsize
;

4448 
	eÆ80211_wowÏn_tı_©Œs
 {

4449 
	m__NL80211_WOWLAN_TCP_INVALID
,

4450 
	mNL80211_WOWLAN_TCP_SRC_IPV4
,

4451 
	mNL80211_WOWLAN_TCP_DST_IPV4
,

4452 
	mNL80211_WOWLAN_TCP_DST_MAC
,

4453 
	mNL80211_WOWLAN_TCP_SRC_PORT
,

4454 
	mNL80211_WOWLAN_TCP_DST_PORT
,

4455 
	mNL80211_WOWLAN_TCP_DATA_PAYLOAD
,

4456 
	mNL80211_WOWLAN_TCP_DATA_PAYLOAD_SEQ
,

4457 
	mNL80211_WOWLAN_TCP_DATA_PAYLOAD_TOKEN
,

4458 
	mNL80211_WOWLAN_TCP_DATA_INTERVAL
,

4459 
	mNL80211_WOWLAN_TCP_WAKE_PAYLOAD
,

4460 
	mNL80211_WOWLAN_TCP_WAKE_MASK
,

4463 
	mNUM_NL80211_WOWLAN_TCP
,

4464 
	mMAX_NL80211_WOWLAN_TCP
 = 
NUM_NL80211_WOWLAN_TCP
 - 1

4476 
	sÆ80211_cßËsû_ruË_suµÜt
 {

4477 
__u32
 
	mmax_ruËs
;

4478 
Æ80211_·‰”n_suµÜt
 
	m·t
;

4479 
__u32
 
	mmax_d–ay
;

4480 } 
__©Œibu‹__
((
·cked
));

4493 
	eÆ80211_©Œ_cßËsû_ruË
 {

4494 
	m__NL80211_COALESCE_RULE_INVALID
,

4495 
	mNL80211_ATTR_COALESCE_RULE_DELAY
,

4496 
	mNL80211_ATTR_COALESCE_RULE_CONDITION
,

4497 
	mNL80211_ATTR_COALESCE_RULE_PKT_PATTERN
,

4500 
	mNUM_NL80211_ATTR_COALESCE_RULE
,

4501 
	mNL80211_ATTR_COALESCE_RULE_MAX
 = 
NUM_NL80211_ATTR_COALESCE_RULE
 - 1

4511 
	eÆ80211_cßËsû_cÚd™iÚ
 {

4512 
	mNL80211_COALESCE_CONDITION_MATCH
,

4513 
	mNL80211_COALESCE_CONDITION_NO_MATCH


4526 
	eÆ80211_içû_lim™_©Œs
 {

4527 
	mNL80211_IFACE_LIMIT_UNSPEC
,

4528 
	mNL80211_IFACE_LIMIT_MAX
,

4529 
	mNL80211_IFACE_LIMIT_TYPES
,

4532 
	mNUM_NL80211_IFACE_LIMIT
,

4533 
	mMAX_NL80211_IFACE_LIMIT
 = 
NUM_NL80211_IFACE_LIMIT
 - 1

4585 
	eÆ80211_if_combš©iÚ_©Œs
 {

4586 
	mNL80211_IFACE_COMB_UNSPEC
,

4587 
	mNL80211_IFACE_COMB_LIMITS
,

4588 
	mNL80211_IFACE_COMB_MAXNUM
,

4589 
	mNL80211_IFACE_COMB_STA_AP_BI_MATCH
,

4590 
	mNL80211_IFACE_COMB_NUM_CHANNELS
,

4591 
	mNL80211_IFACE_COMB_RADAR_DETECT_WIDTHS
,

4592 
	mNL80211_IFACE_COMB_RADAR_DETECT_REGIONS
,

4593 
	mNL80211_IFACE_COMB_BI_MIN_GCD
,

4596 
	mNUM_NL80211_IFACE_COMB
,

4597 
	mMAX_NL80211_IFACE_COMB
 = 
NUM_NL80211_IFACE_COMB
 - 1

4619 
	eÆ80211_¶šk_¡©e
 {

4620 
	mNL80211_PLINK_LISTEN
,

4621 
	mNL80211_PLINK_OPN_SNT
,

4622 
	mNL80211_PLINK_OPN_RCVD
,

4623 
	mNL80211_PLINK_CNF_RCVD
,

4624 
	mNL80211_PLINK_ESTAB
,

4625 
	mNL80211_PLINK_HOLDING
,

4626 
	mNL80211_PLINK_BLOCKED
,

4629 
	mNUM_NL80211_PLINK_STATES
,

4630 
	mMAX_NL80211_PLINK_STATES
 = 
NUM_NL80211_PLINK_STATES
 - 1

4641 
	e¶šk_aùiÚs
 {

4642 
	mNL80211_PLINK_ACTION_NO_ACTION
,

4643 
	mNL80211_PLINK_ACTION_OPEN
,

4644 
	mNL80211_PLINK_ACTION_BLOCK
,

4646 
	mNUM_NL80211_PLINK_ACTIONS
,

4650 
	#NL80211_KCK_LEN
 16

	)

4651 
	#NL80211_KEK_LEN
 16

	)

4652 
	#NL80211_REPLAY_CTR_LEN
 8

	)

4663 
	eÆ80211_»key_d©a
 {

4664 
	m__NL80211_REKEY_DATA_INVALID
,

4665 
	mNL80211_REKEY_DATA_KEK
,

4666 
	mNL80211_REKEY_DATA_KCK
,

4667 
	mNL80211_REKEY_DATA_REPLAY_CTR
,

4670 
	mNUM_NL80211_REKEY_DATA
,

4671 
	mMAX_NL80211_REKEY_DATA
 = 
NUM_NL80211_REKEY_DATA
 - 1

4683 
	eÆ80211_hidd’_ssid
 {

4684 
	mNL80211_HIDDEN_SSID_NOT_IN_USE
,

4685 
	mNL80211_HIDDEN_SSID_ZERO_LEN
,

4686 
	mNL80211_HIDDEN_SSID_ZERO_CONTENTS


4699 
	eÆ80211_¡a_wme_©Œ
 {

4700 
	m__NL80211_STA_WME_INVALID
,

4701 
	mNL80211_STA_WME_UAPSD_QUEUES
,

4702 
	mNL80211_STA_WME_MAX_SP
,

4705 
	m__NL80211_STA_WME_AFTER_LAST
,

4706 
	mNL80211_STA_WME_MAX
 = 
__NL80211_STA_WME_AFTER_LAST
 - 1

4721 
	eÆ80211_pmk§_ÿndid©e_©Œ
 {

4722 
	m__NL80211_PMKSA_CANDIDATE_INVALID
,

4723 
	mNL80211_PMKSA_CANDIDATE_INDEX
,

4724 
	mNL80211_PMKSA_CANDIDATE_BSSID
,

4725 
	mNL80211_PMKSA_CANDIDATE_PREAUTH
,

4728 
	mNUM_NL80211_PMKSA_CANDIDATE
,

4729 
	mMAX_NL80211_PMKSA_CANDIDATE
 = 
NUM_NL80211_PMKSA_CANDIDATE
 - 1

4740 
	eÆ80211_tdls_İ”©iÚ
 {

4741 
	mNL80211_TDLS_DISCOVERY_REQ
,

4742 
	mNL80211_TDLS_SETUP
,

4743 
	mNL80211_TDLS_TEARDOWN
,

4744 
	mNL80211_TDLS_ENABLE_LINK
,

4745 
	mNL80211_TDLS_DISABLE_LINK
,

4849 
	eÆ80211_ã©u»_æags
 {

4850 
	mNL80211_FEATURE_SK_TX_STATUS
 = 1 << 0,

4851 
	mNL80211_FEATURE_HT_IBSS
 = 1 << 1,

4852 
	mNL80211_FEATURE_INACTIVITY_TIMER
 = 1 << 2,

4853 
	mNL80211_FEATURE_CELL_BASE_REG_HINTS
 = 1 << 3,

4854 
	mNL80211_FEATURE_P2P_DEVICE_NEEDS_CHANNEL
 = 1 << 4,

4855 
	mNL80211_FEATURE_SAE
 = 1 << 5,

4856 
	mNL80211_FEATURE_LOW_PRIORITY_SCAN
 = 1 << 6,

4857 
	mNL80211_FEATURE_SCAN_FLUSH
 = 1 << 7,

4858 
	mNL80211_FEATURE_AP_SCAN
 = 1 << 8,

4859 
	mNL80211_FEATURE_VIF_TXPOWER
 = 1 << 9,

4860 
	mNL80211_FEATURE_NEED_OBSS_SCAN
 = 1 << 10,

4861 
	mNL80211_FEATURE_P2P_GO_CTWIN
 = 1 << 11,

4862 
	mNL80211_FEATURE_P2P_GO_OPPPS
 = 1 << 12,

4864 
	mNL80211_FEATURE_ADVERTISE_CHAN_LIMITS
 = 1 << 14,

4865 
	mNL80211_FEATURE_FULL_AP_CLIENT_STATE
 = 1 << 15,

4866 
	mNL80211_FEATURE_USERSPACE_MPM
 = 1 << 16,

4867 
	mNL80211_FEATURE_ACTIVE_MONITOR
 = 1 << 17,

4868 
	mNL80211_FEATURE_AP_MODE_CHAN_WIDTH_CHANGE
 = 1 << 18,

4869 
	mNL80211_FEATURE_DS_PARAM_SET_IE_IN_PROBES
 = 1 << 19,

4870 
	mNL80211_FEATURE_WFA_TPC_IE_IN_PROBES
 = 1 << 20,

4871 
	mNL80211_FEATURE_QUIET
 = 1 << 21,

4872 
	mNL80211_FEATURE_TX_POWER_INSERTION
 = 1 << 22,

4873 
	mNL80211_FEATURE_ACKTO_ESTIMATION
 = 1 << 23,

4874 
	mNL80211_FEATURE_STATIC_SMPS
 = 1 << 24,

4875 
	mNL80211_FEATURE_DYNAMIC_SMPS
 = 1 << 25,

4876 
	mNL80211_FEATURE_SUPPORTS_WMM_ADMISSION
 = 1 << 26,

4877 
	mNL80211_FEATURE_MAC_ON_CREATE
 = 1 << 27,

4878 
	mNL80211_FEATURE_TDLS_CHANNEL_SWITCH
 = 1 << 28,

4879 
	mNL80211_FEATURE_SCAN_RANDOM_MAC_ADDR
 = 1 << 29,

4880 
	mNL80211_FEATURE_SCHED_SCAN_RANDOM_MAC_ADDR
 = 1 << 30,

4881 
	mNL80211_FEATURE_ND_RANDOM_MAC_ADDR
 = 1 << 31,

4950 
	eÆ80211_ext_ã©u»_šdex
 {

4951 
	mNL80211_EXT_FEATURE_VHT_IBSS
,

4952 
	mNL80211_EXT_FEATURE_RRM
,

4953 
	mNL80211_EXT_FEATURE_MU_MIMO_AIR_SNIFFER
,

4954 
	mNL80211_EXT_FEATURE_SCAN_START_TIME
,

4955 
	mNL80211_EXT_FEATURE_BSS_PARENT_TSF
,

4956 
	mNL80211_EXT_FEATURE_SET_SCAN_DWELL
,

4957 
	mNL80211_EXT_FEATURE_BEACON_RATE_LEGACY
,

4958 
	mNL80211_EXT_FEATURE_BEACON_RATE_HT
,

4959 
	mNL80211_EXT_FEATURE_BEACON_RATE_VHT
,

4960 
	mNL80211_EXT_FEATURE_FILS_STA
,

4961 
	mNL80211_EXT_FEATURE_MGMT_TX_RANDOM_TA
,

4962 
	mNL80211_EXT_FEATURE_MGMT_TX_RANDOM_TA_CONNECTED
,

4963 
	mNL80211_EXT_FEATURE_SCHED_SCAN_RELATIVE_RSSI
,

4964 
	mNL80211_EXT_FEATURE_CQM_RSSI_LIST
,

4965 
	mNL80211_EXT_FEATURE_FILS_SK_OFFLOAD
,

4966 
	mNL80211_EXT_FEATURE_4WAY_HANDSHAKE_STA_PSK
,

4967 
	mNL80211_EXT_FEATURE_4WAY_HANDSHAKE_STA_1X
,

4968 
	mNL80211_EXT_FEATURE_FILS_MAX_CHANNEL_TIME
,

4969 
	mNL80211_EXT_FEATURE_ACCEPT_BCAST_PROBE_RESP
,

4970 
	mNL80211_EXT_FEATURE_OCE_PROBE_REQ_HIGH_TX_RATE
,

4971 
	mNL80211_EXT_FEATURE_OCE_PROBE_REQ_DEFERRAL_SUPPRESSION
,

4972 
	mNL80211_EXT_FEATURE_MFP_OPTIONAL
,

4975 
	mNUM_NL80211_EXT_FEATURES
,

4976 
	mMAX_NL80211_EXT_FEATURES
 = 
NUM_NL80211_EXT_FEATURES
 - 1

4993 
	eÆ80211_´obe_»¥_ofæßd_suµÜt_©Œ
 {

4994 
	mNL80211_PROBE_RESP_OFFLOAD_SUPPORT_WPS
 = 1<<0,

4995 
	mNL80211_PROBE_RESP_OFFLOAD_SUPPORT_WPS2
 = 1<<1,

4996 
	mNL80211_PROBE_RESP_OFFLOAD_SUPPORT_P2P
 = 1<<2,

4997 
	mNL80211_PROBE_RESP_OFFLOAD_SUPPORT_80211U
 = 1<<3,

5006 
	eÆ80211_cÚÃù_çed_»asÚ
 {

5007 
	mNL80211_CONN_FAIL_MAX_CLIENTS
,

5008 
	mNL80211_CONN_FAIL_BLOCKED_CLIENT
,

5019 
	eÆ80211_timeout_»asÚ
 {

5020 
	mNL80211_TIMEOUT_UNSPECIFIED
,

5021 
	mNL80211_TIMEOUT_SCAN
,

5022 
	mNL80211_TIMEOUT_AUTH
,

5023 
	mNL80211_TIMEOUT_ASSOC
,

5062 
	eÆ80211_sÿn_æags
 {

5063 
	mNL80211_SCAN_FLAG_LOW_PRIORITY
 = 1<<0,

5064 
	mNL80211_SCAN_FLAG_FLUSH
 = 1<<1,

5065 
	mNL80211_SCAN_FLAG_AP
 = 1<<2,

5066 
	mNL80211_SCAN_FLAG_RANDOM_ADDR
 = 1<<3,

5067 
	mNL80211_SCAN_FLAG_FILS_MAX_CHANNEL_TIME
 = 1<<4,

5068 
	mNL80211_SCAN_FLAG_ACCEPT_BCAST_PROBE_RESP
 = 1<<5,

5069 
	mNL80211_SCAN_FLAG_OCE_PROBE_REQ_HIGH_TX_RATE
 = 1<<6,

5070 
	mNL80211_SCAN_FLAG_OCE_PROBE_REQ_DEFERRAL_SUPPRESSION
 = 1<<7,

5086 
	eÆ80211_aş_pŞicy
 {

5087 
	mNL80211_ACL_POLICY_ACCEPT_UNLESS_LISTED
,

5088 
	mNL80211_ACL_POLICY_DENY_UNLESS_LISTED
,

5101 
	eÆ80211_smps_mode
 {

5102 
	mNL80211_SMPS_OFF
,

5103 
	mNL80211_SMPS_STATIC
,

5104 
	mNL80211_SMPS_DYNAMIC
,

5106 
	m__NL80211_SMPS_AFTER_LAST
,

5107 
	mNL80211_SMPS_MAX
 = 
__NL80211_SMPS_AFTER_LAST
 - 1

5129 
	eÆ80211_¿d¬_ev’t
 {

5130 
	mNL80211_RADAR_DETECTED
,

5131 
	mNL80211_RADAR_CAC_FINISHED
,

5132 
	mNL80211_RADAR_CAC_ABORTED
,

5133 
	mNL80211_RADAR_NOP_FINISHED
,

5134 
	mNL80211_RADAR_PRE_CAC_EXPIRED
,

5148 
	eÆ80211_dfs_¡©e
 {

5149 
	mNL80211_DFS_USABLE
,

5150 
	mNL80211_DFS_UNAVAILABLE
,

5151 
	mNL80211_DFS_AVAILABLE
,

5162 
	eÆ80211_´ÙocŞ_ã©u»s
 {

5163 
	mNL80211_PROTOCOL_FEATURE_SPLIT_WIPHY_DUMP
 = 1 << 0,

5175 
	eÆ80211_ü™_´Ùo_id
 {

5176 
	mNL80211_CRIT_PROTO_UNSPEC
,

5177 
	mNL80211_CRIT_PROTO_DHCP
,

5178 
	mNL80211_CRIT_PROTO_EAPOL
,

5179 
	mNL80211_CRIT_PROTO_APIPA
,

5181 
	mNUM_NL80211_CRIT_PROTO


5185 
	#NL80211_CRIT_PROTO_MAX_DURATION
 5000

	)

5194 
	eÆ80211_rxmgmt_æags
 {

5195 
	mNL80211_RXMGMT_FLAG_ANSWERED
 = 1 << 0,

5203 
	#NL80211_VENDOR_ID_IS_LINUX
 0x80000000

	)

5213 
	sÆ80211_v’dÜ_cmd_šfo
 {

5214 
__u32
 
	mv’dÜ_id
;

5215 
__u32
 
	msubcmd
;

5228 
	eÆ80211_tdls_³”_ÿ·b™y
 {

5229 
	mNL80211_TDLS_PEER_HT
 = 1<<0,

5230 
	mNL80211_TDLS_PEER_VHT
 = 1<<1,

5231 
	mNL80211_TDLS_PEER_WMM
 = 1<<2,

5247 
	eÆ80211_sched_sÿn_¶ª
 {

5248 
	m__NL80211_SCHED_SCAN_PLAN_INVALID
,

5249 
	mNL80211_SCHED_SCAN_PLAN_INTERVAL
,

5250 
	mNL80211_SCHED_SCAN_PLAN_ITERATIONS
,

5253 
	m__NL80211_SCHED_SCAN_PLAN_AFTER_LAST
,

5254 
	mNL80211_SCHED_SCAN_PLAN_MAX
 =

5255 
__NL80211_SCHED_SCAN_PLAN_AFTER_LAST
 - 1

5265 
	sÆ80211_bss_£Ëù_rssi_adju¡
 {

5266 
__u8
 
	mbªd
;

5267 
__s8
 
	md–
;

5268 } 
__©Œibu‹__
((
·cked
));

5292 
	eÆ80211_bss_£Ëù_©Œ
 {

5293 
	m__NL80211_BSS_SELECT_ATTR_INVALID
,

5294 
	mNL80211_BSS_SELECT_ATTR_RSSI
,

5295 
	mNL80211_BSS_SELECT_ATTR_BAND_PREF
,

5296 
	mNL80211_BSS_SELECT_ATTR_RSSI_ADJUST
,

5299 
	m__NL80211_BSS_SELECT_ATTR_AFTER_LAST
,

5300 
	mNL80211_BSS_SELECT_ATTR_MAX
 = 
__NL80211_BSS_SELECT_ATTR_AFTER_LAST
 - 1

5312 
	eÆ80211_Çn_funùiÚ_ty³
 {

5313 
	mNL80211_NAN_FUNC_PUBLISH
,

5314 
	mNL80211_NAN_FUNC_SUBSCRIBE
,

5315 
	mNL80211_NAN_FUNC_FOLLOW_UP
,

5318 
	m__NL80211_NAN_FUNC_TYPE_AFTER_LAST
,

5319 
	mNL80211_NAN_FUNC_MAX_TYPE
 = 
__NL80211_NAN_FUNC_TYPE_AFTER_LAST
 - 1,

5330 
	eÆ80211_Çn_publish_ty³
 {

5331 
	mNL80211_NAN_SOLICITED_PUBLISH
 = 1 << 0,

5332 
	mNL80211_NAN_UNSOLICITED_PUBLISH
 = 1 << 1,

5344 
	eÆ80211_Çn_func_‹rm_»asÚ
 {

5345 
	mNL80211_NAN_FUNC_TERM_REASON_USER_REQUEST
,

5346 
	mNL80211_NAN_FUNC_TERM_REASON_TTL_EXPIRED
,

5347 
	mNL80211_NAN_FUNC_TERM_REASON_ERROR
,

5350 
	#NL80211_NAN_FUNC_SERVICE_ID_LEN
 6

	)

5351 
	#NL80211_NAN_FUNC_SERVICE_SPEC_INFO_MAX_LEN
 0xff

	)

5352 
	#NL80211_NAN_FUNC_SRF_MAX_LEN
 0xff

	)

5396 
	eÆ80211_Çn_func_©Œibu‹s
 {

5397 
	m__NL80211_NAN_FUNC_INVALID
,

5398 
	mNL80211_NAN_FUNC_TYPE
,

5399 
	mNL80211_NAN_FUNC_SERVICE_ID
,

5400 
	mNL80211_NAN_FUNC_PUBLISH_TYPE
,

5401 
	mNL80211_NAN_FUNC_PUBLISH_BCAST
,

5402 
	mNL80211_NAN_FUNC_SUBSCRIBE_ACTIVE
,

5403 
	mNL80211_NAN_FUNC_FOLLOW_UP_ID
,

5404 
	mNL80211_NAN_FUNC_FOLLOW_UP_REQ_ID
,

5405 
	mNL80211_NAN_FUNC_FOLLOW_UP_DEST
,

5406 
	mNL80211_NAN_FUNC_CLOSE_RANGE
,

5407 
	mNL80211_NAN_FUNC_TTL
,

5408 
	mNL80211_NAN_FUNC_SERVICE_INFO
,

5409 
	mNL80211_NAN_FUNC_SRF
,

5410 
	mNL80211_NAN_FUNC_RX_MATCH_FILTER
,

5411 
	mNL80211_NAN_FUNC_TX_MATCH_FILTER
,

5412 
	mNL80211_NAN_FUNC_INSTANCE_ID
,

5413 
	mNL80211_NAN_FUNC_TERM_REASON
,

5416 
	mNUM_NL80211_NAN_FUNC_ATTR
,

5417 
	mNL80211_NAN_FUNC_ATTR_MAX
 = 
NUM_NL80211_NAN_FUNC_ATTR
 - 1

5435 
	eÆ80211_Çn_¤f_©Œibu‹s
 {

5436 
	m__NL80211_NAN_SRF_INVALID
,

5437 
	mNL80211_NAN_SRF_INCLUDE
,

5438 
	mNL80211_NAN_SRF_BF
,

5439 
	mNL80211_NAN_SRF_BF_IDX
,

5440 
	mNL80211_NAN_SRF_MAC_ADDRS
,

5443 
	mNUM_NL80211_NAN_SRF_ATTR
,

5444 
	mNL80211_NAN_SRF_ATTR_MAX
 = 
NUM_NL80211_NAN_SRF_ATTR
 - 1,

5460 
	eÆ80211_Çn_m©ch_©Œibu‹s
 {

5461 
	m__NL80211_NAN_MATCH_INVALID
,

5462 
	mNL80211_NAN_MATCH_FUNC_LOCAL
,

5463 
	mNL80211_NAN_MATCH_FUNC_PEER
,

5466 
	mNUM_NL80211_NAN_MATCH_ATTR
,

5467 
	mNL80211_NAN_MATCH_ATTR_MAX
 = 
NUM_NL80211_NAN_MATCH_ATTR
 - 1

	@/usr/include/linux/poll.h

1 
	~<asm/pŞl.h
>

	@/usr/include/linux/rtnetlink.h

2 #iâdeà
__LINUX_RTNETLINK_H


3 
	#__LINUX_RTNETLINK_H


	)

5 
	~<lšux/ty³s.h
>

6 
	~<lšux/Ãšk.h
>

7 
	~<lšux/if_lšk.h
>

8 
	~<lšux/if_addr.h
>

9 
	~<lšux/Ãighbour.h
>

14 
	#RTNL_FAMILY_IPMR
 128

	)

15 
	#RTNL_FAMILY_IP6MR
 129

	)

16 
	#RTNL_FAMILY_MAX
 129

	)

25 
	mRTM_BASE
 = 16,

26 
	#RTM_BASE
 
RTM_BASE


	)

28 
	mRTM_NEWLINK
 = 16,

29 
	#RTM_NEWLINK
 
RTM_NEWLINK


	)

30 
	mRTM_DELLINK
,

31 
	#RTM_DELLINK
 
RTM_DELLINK


	)

32 
	mRTM_GETLINK
,

33 
	#RTM_GETLINK
 
RTM_GETLINK


	)

34 
	mRTM_SETLINK
,

35 
	#RTM_SETLINK
 
RTM_SETLINK


	)

37 
	mRTM_NEWADDR
 = 20,

38 
	#RTM_NEWADDR
 
RTM_NEWADDR


	)

39 
	mRTM_DELADDR
,

40 
	#RTM_DELADDR
 
RTM_DELADDR


	)

41 
	mRTM_GETADDR
,

42 
	#RTM_GETADDR
 
RTM_GETADDR


	)

44 
	mRTM_NEWROUTE
 = 24,

45 
	#RTM_NEWROUTE
 
RTM_NEWROUTE


	)

46 
	mRTM_DELROUTE
,

47 
	#RTM_DELROUTE
 
RTM_DELROUTE


	)

48 
	mRTM_GETROUTE
,

49 
	#RTM_GETROUTE
 
RTM_GETROUTE


	)

51 
	mRTM_NEWNEIGH
 = 28,

52 
	#RTM_NEWNEIGH
 
RTM_NEWNEIGH


	)

53 
	mRTM_DELNEIGH
,

54 
	#RTM_DELNEIGH
 
RTM_DELNEIGH


	)

55 
	mRTM_GETNEIGH
,

56 
	#RTM_GETNEIGH
 
RTM_GETNEIGH


	)

58 
	mRTM_NEWRULE
 = 32,

59 
	#RTM_NEWRULE
 
RTM_NEWRULE


	)

60 
	mRTM_DELRULE
,

61 
	#RTM_DELRULE
 
RTM_DELRULE


	)

62 
	mRTM_GETRULE
,

63 
	#RTM_GETRULE
 
RTM_GETRULE


	)

65 
	mRTM_NEWQDISC
 = 36,

66 
	#RTM_NEWQDISC
 
RTM_NEWQDISC


	)

67 
	mRTM_DELQDISC
,

68 
	#RTM_DELQDISC
 
RTM_DELQDISC


	)

69 
	mRTM_GETQDISC
,

70 
	#RTM_GETQDISC
 
RTM_GETQDISC


	)

72 
	mRTM_NEWTCLASS
 = 40,

73 
	#RTM_NEWTCLASS
 
RTM_NEWTCLASS


	)

74 
	mRTM_DELTCLASS
,

75 
	#RTM_DELTCLASS
 
RTM_DELTCLASS


	)

76 
	mRTM_GETTCLASS
,

77 
	#RTM_GETTCLASS
 
RTM_GETTCLASS


	)

79 
	mRTM_NEWTFILTER
 = 44,

80 
	#RTM_NEWTFILTER
 
RTM_NEWTFILTER


	)

81 
	mRTM_DELTFILTER
,

82 
	#RTM_DELTFILTER
 
RTM_DELTFILTER


	)

83 
	mRTM_GETTFILTER
,

84 
	#RTM_GETTFILTER
 
RTM_GETTFILTER


	)

86 
	mRTM_NEWACTION
 = 48,

87 
	#RTM_NEWACTION
 
RTM_NEWACTION


	)

88 
	mRTM_DELACTION
,

89 
	#RTM_DELACTION
 
RTM_DELACTION


	)

90 
	mRTM_GETACTION
,

91 
	#RTM_GETACTION
 
RTM_GETACTION


	)

93 
	mRTM_NEWPREFIX
 = 52,

94 
	#RTM_NEWPREFIX
 
RTM_NEWPREFIX


	)

96 
	mRTM_GETMULTICAST
 = 58,

97 
	#RTM_GETMULTICAST
 
RTM_GETMULTICAST


	)

99 
	mRTM_GETANYCAST
 = 62,

100 
	#RTM_GETANYCAST
 
RTM_GETANYCAST


	)

102 
	mRTM_NEWNEIGHTBL
 = 64,

103 
	#RTM_NEWNEIGHTBL
 
RTM_NEWNEIGHTBL


	)

104 
	mRTM_GETNEIGHTBL
 = 66,

105 
	#RTM_GETNEIGHTBL
 
RTM_GETNEIGHTBL


	)

106 
	mRTM_SETNEIGHTBL
,

107 
	#RTM_SETNEIGHTBL
 
RTM_SETNEIGHTBL


	)

109 
	mRTM_NEWNDUSEROPT
 = 68,

110 
	#RTM_NEWNDUSEROPT
 
RTM_NEWNDUSEROPT


	)

112 
	mRTM_NEWADDRLABEL
 = 72,

113 
	#RTM_NEWADDRLABEL
 
RTM_NEWADDRLABEL


	)

114 
	mRTM_DELADDRLABEL
,

115 
	#RTM_DELADDRLABEL
 
RTM_DELADDRLABEL


	)

116 
	mRTM_GETADDRLABEL
,

117 
	#RTM_GETADDRLABEL
 
RTM_GETADDRLABEL


	)

119 
	mRTM_GETDCB
 = 78,

120 
	#RTM_GETDCB
 
RTM_GETDCB


	)

121 
	mRTM_SETDCB
,

122 
	#RTM_SETDCB
 
RTM_SETDCB


	)

124 
	mRTM_NEWNETCONF
 = 80,

125 
	#RTM_NEWNETCONF
 
RTM_NEWNETCONF


	)

126 
	mRTM_DELNETCONF
,

127 
	#RTM_DELNETCONF
 
RTM_DELNETCONF


	)

128 
	mRTM_GETNETCONF
 = 82,

129 
	#RTM_GETNETCONF
 
RTM_GETNETCONF


	)

131 
	mRTM_NEWMDB
 = 84,

132 
	#RTM_NEWMDB
 
RTM_NEWMDB


	)

133 
	mRTM_DELMDB
 = 85,

134 
	#RTM_DELMDB
 
RTM_DELMDB


	)

135 
	mRTM_GETMDB
 = 86,

136 
	#RTM_GETMDB
 
RTM_GETMDB


	)

138 
	mRTM_NEWNSID
 = 88,

139 
	#RTM_NEWNSID
 
RTM_NEWNSID


	)

140 
	mRTM_DELNSID
 = 89,

141 
	#RTM_DELNSID
 
RTM_DELNSID


	)

142 
	mRTM_GETNSID
 = 90,

143 
	#RTM_GETNSID
 
RTM_GETNSID


	)

145 
	mRTM_NEWSTATS
 = 92,

146 
	#RTM_NEWSTATS
 
RTM_NEWSTATS


	)

147 
	mRTM_GETSTATS
 = 94,

148 
	#RTM_GETSTATS
 
RTM_GETSTATS


	)

150 
	mRTM_NEWCACHEREPORT
 = 96,

151 
	#RTM_NEWCACHEREPORT
 
RTM_NEWCACHEREPORT


	)

153 
	m__RTM_MAX
,

154 
	#RTM_MAX
 (((
__RTM_MAX
 + 3è& ~3è- 1)

	)

157 
	#RTM_NR_MSGTYPES
 (
RTM_MAX
 + 1 - 
RTM_BASE
)

	)

158 
	#RTM_NR_FAMILIES
 (
RTM_NR_MSGTYPES
 >> 2)

	)

159 
	#RTM_FAM
(
cmd
è(((cmdè- 
RTM_BASE
è>> 2)

	)

167 
	s¹©Œ
 {

168 
	m¹a_Ën
;

169 
	m¹a_ty³
;

174 
	#RTA_ALIGNTO
 4U

	)

175 
	#RTA_ALIGN
(
Ën
èĞ(Ö’)+
RTA_ALIGNTO
-1è& ~(RTA_ALIGNTO-1è)

	)

176 
	#RTA_OK
(
¹a
,
Ën
è(Ö’è>ğ()(
¹©Œ
) && \

177 (
¹a
)->
¹a_Ën
 >ğ(
¹©Œ
) && \

178 (
¹a
)->
¹a_Ën
 <ğ(
Ën
))

	)

179 
	#RTA_NEXT
(
¹a
,
©ŒËn
è(×‰¾’è-ğ
	`RTA_ALIGN
(Ô)->
¹a_Ën
), \

180 (
¹©Œ
*)(((*)(
¹a
)è+ 
	`RTA_ALIGN
(Ô)->
¹a_Ën
)))

	)

181 
	#RTA_LENGTH
(
Ën
è(
	`RTA_ALIGN
((
¹©Œ
)è+ (Ën))

	)

182 
	#RTA_SPACE
(
Ën
è
	`RTA_ALIGN
(
	`RTA_LENGTH
Ö’))

	)

183 
	#RTA_DATA
(
¹a
è((*)(((*)Ô)è+ 
	`RTA_LENGTH
(0)))

	)

184 
	#RTA_PAYLOAD
(
¹a
è(()(Ô)->
¹a_Ën
è- 
	`RTA_LENGTH
(0))

	)

193 
	s¹msg
 {

194 
	m¹m_çmy
;

195 
	m¹m_d¡_Ën
;

196 
	m¹m_¤c_Ën
;

197 
	m¹m_tos
;

199 
	m¹m_bË
;

200 
	m¹m_´ÙocŞ
;

201 
	m¹m_scİe
;

202 
	m¹m_ty³
;

204 
	m¹m_æags
;

210 
	mRTN_UNSPEC
,

211 
	mRTN_UNICAST
,

212 
	mRTN_LOCAL
,

213 
	mRTN_BROADCAST
,

215 
	mRTN_ANYCAST
,

217 
	mRTN_MULTICAST
,

218 
	mRTN_BLACKHOLE
,

219 
	mRTN_UNREACHABLE
,

220 
	mRTN_PROHIBIT
,

221 
	mRTN_THROW
,

222 
	mRTN_NAT
,

223 
	mRTN_XRESOLVE
,

224 
	m__RTN_MAX


227 
	#RTN_MAX
 (
__RTN_MAX
 - 1)

	)

232 
	#RTPROT_UNSPEC
 0

	)

233 
	#RTPROT_REDIRECT
 1

	)

235 
	#RTPROT_KERNEL
 2

	)

236 
	#RTPROT_BOOT
 3

	)

237 
	#RTPROT_STATIC
 4

	)

246 
	#RTPROT_GATED
 8

	)

247 
	#RTPROT_RA
 9

	)

248 
	#RTPROT_MRT
 10

	)

249 
	#RTPROT_ZEBRA
 11

	)

250 
	#RTPROT_BIRD
 12

	)

251 
	#RTPROT_DNROUTED
 13

	)

252 
	#RTPROT_XORP
 14

	)

253 
	#RTPROT_NTK
 15

	)

254 
	#RTPROT_DHCP
 16

	)

255 
	#RTPROT_MROUTED
 17

	)

256 
	#RTPROT_BABEL
 42

	)

269 
	e¹_scİe_t
 {

270 
	mRT_SCOPE_UNIVERSE
=0,

272 
	mRT_SCOPE_SITE
=200,

273 
	mRT_SCOPE_LINK
=253,

274 
	mRT_SCOPE_HOST
=254,

275 
	mRT_SCOPE_NOWHERE
=255

280 
	#RTM_F_NOTIFY
 0x100

	)

281 
	#RTM_F_CLONED
 0x200

	)

282 
	#RTM_F_EQUALIZE
 0x400

	)

283 
	#RTM_F_PREFIX
 0x800

	)

284 
	#RTM_F_LOOKUP_TABLE
 0x1000

	)

285 
	#RTM_F_FIB_MATCH
 0x2000

	)

289 
	e¹_şass_t
 {

290 
	mRT_TABLE_UNSPEC
=0,

292 
	mRT_TABLE_COMPAT
=252,

293 
	mRT_TABLE_DEFAULT
=253,

294 
	mRT_TABLE_MAIN
=254,

295 
	mRT_TABLE_LOCAL
=255,

296 
	mRT_TABLE_MAX
=0xFFFFFFFF

302 
	e¹©Œ_ty³_t
 {

303 
	mRTA_UNSPEC
,

304 
	mRTA_DST
,

305 
	mRTA_SRC
,

306 
	mRTA_IIF
,

307 
	mRTA_OIF
,

308 
	mRTA_GATEWAY
,

309 
	mRTA_PRIORITY
,

310 
	mRTA_PREFSRC
,

311 
	mRTA_METRICS
,

312 
	mRTA_MULTIPATH
,

313 
	mRTA_PROTOINFO
,

314 
	mRTA_FLOW
,

315 
	mRTA_CACHEINFO
,

316 
	mRTA_SESSION
,

317 
	mRTA_MP_ALGO
,

318 
	mRTA_TABLE
,

319 
	mRTA_MARK
,

320 
	mRTA_MFC_STATS
,

321 
	mRTA_VIA
,

322 
	mRTA_NEWDST
,

323 
	mRTA_PREF
,

324 
	mRTA_ENCAP_TYPE
,

325 
	mRTA_ENCAP
,

326 
	mRTA_EXPIRES
,

327 
	mRTA_PAD
,

328 
	mRTA_UID
,

329 
	mRTA_TTL_PROPAGATE
,

330 
	m__RTA_MAX


333 
	#RTA_MAX
 (
__RTA_MAX
 - 1)

	)

335 
	#RTM_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
¹msg
))))

	)

336 
	#RTM_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
¹msg
))

	)

347 
	s¹Ãxthİ
 {

348 
	m¹nh_Ën
;

349 
	m¹nh_æags
;

350 
	m¹nh_hİs
;

351 
	m¹nh_ifšdex
;

356 
	#RTNH_F_DEAD
 1

	)

357 
	#RTNH_F_PERVASIVE
 2

	)

358 
	#RTNH_F_ONLINK
 4

	)

359 
	#RTNH_F_OFFLOAD
 8

	)

360 
	#RTNH_F_LINKDOWN
 16

	)

361 
	#RTNH_F_UNRESOLVED
 32

	)

363 
	#RTNH_COMPARE_MASK
 (
RTNH_F_DEAD
 | 
RTNH_F_LINKDOWN
 | 
RTNH_F_OFFLOAD
)

	)

367 
	#RTNH_ALIGNTO
 4

	)

368 
	#RTNH_ALIGN
(
Ën
èĞ(Ö’)+
RTNH_ALIGNTO
-1è& ~(RTNH_ALIGNTO-1è)

	)

369 
	#RTNH_OK
(
¹nh
,
Ën
è(ÔŠh)->
¹nh_Ën
 >ğ(
¹Ãxthİ
) && \

370 (()(
¹nh
)->
¹nh_Ën
è<ğ(
Ën
))

	)

371 
	#RTNH_NEXT
(
¹nh
è((
¹Ãxthİ
*)(((*)ÔŠh)è+ 
	`RTNH_ALIGN
(ÔŠh)->
¹nh_Ën
)))

	)

372 
	#RTNH_LENGTH
(
Ën
è(
	`RTNH_ALIGN
((
¹Ãxthİ
)è+ (Ën))

	)

373 
	#RTNH_SPACE
(
Ën
è
	`RTNH_ALIGN
(
	`RTNH_LENGTH
Ö’))

	)

374 
	#RTNH_DATA
(
¹nh
è((
¹©Œ
*)(((*)ÔŠh)è+ 
	`RTNH_LENGTH
(0)))

	)

377 
	s¹vŸ
 {

378 
__k”Ãl_§_çmy_t
 
	m¹vŸ_çmy
;

379 
__u8
 
	m¹vŸ_addr
[0];

384 
	s¹a_ÿchešfo
 {

385 
__u32
 
	m¹a_şÁ»f
;

386 
__u32
 
	m¹a_Ï¡u£
;

387 
__s32
 
	m¹a_expœes
;

388 
__u32
 
	m¹a_”rÜ
;

389 
__u32
 
	m¹a_u£d
;

391 
	#RTNETLINK_HAVE_PEERINFO
 1

	)

392 
__u32
 
	m¹a_id
;

393 
__u32
 
	m¹a_ts
;

394 
__u32
 
	m¹a_t§ge
;

400 
	mRTAX_UNSPEC
,

401 
	#RTAX_UNSPEC
 
RTAX_UNSPEC


	)

402 
	mRTAX_LOCK
,

403 
	#RTAX_LOCK
 
RTAX_LOCK


	)

404 
	mRTAX_MTU
,

405 
	#RTAX_MTU
 
RTAX_MTU


	)

406 
	mRTAX_WINDOW
,

407 
	#RTAX_WINDOW
 
RTAX_WINDOW


	)

408 
	mRTAX_RTT
,

409 
	#RTAX_RTT
 
RTAX_RTT


	)

410 
	mRTAX_RTTVAR
,

411 
	#RTAX_RTTVAR
 
RTAX_RTTVAR


	)

412 
	mRTAX_SSTHRESH
,

413 
	#RTAX_SSTHRESH
 
RTAX_SSTHRESH


	)

414 
	mRTAX_CWND
,

415 
	#RTAX_CWND
 
RTAX_CWND


	)

416 
	mRTAX_ADVMSS
,

417 
	#RTAX_ADVMSS
 
RTAX_ADVMSS


	)

418 
	mRTAX_REORDERING
,

419 
	#RTAX_REORDERING
 
RTAX_REORDERING


	)

420 
	mRTAX_HOPLIMIT
,

421 
	#RTAX_HOPLIMIT
 
RTAX_HOPLIMIT


	)

422 
	mRTAX_INITCWND
,

423 
	#RTAX_INITCWND
 
RTAX_INITCWND


	)

424 
	mRTAX_FEATURES
,

425 
	#RTAX_FEATURES
 
RTAX_FEATURES


	)

426 
	mRTAX_RTO_MIN
,

427 
	#RTAX_RTO_MIN
 
RTAX_RTO_MIN


	)

428 
	mRTAX_INITRWND
,

429 
	#RTAX_INITRWND
 
RTAX_INITRWND


	)

430 
	mRTAX_QUICKACK
,

431 
	#RTAX_QUICKACK
 
RTAX_QUICKACK


	)

432 
	mRTAX_CC_ALGO
,

433 
	#RTAX_CC_ALGO
 
RTAX_CC_ALGO


	)

434 
	mRTAX_FASTOPEN_NO_COOKIE
,

435 
	#RTAX_FASTOPEN_NO_COOKIE
 
RTAX_FASTOPEN_NO_COOKIE


	)

436 
	m__RTAX_MAX


439 
	#RTAX_MAX
 (
__RTAX_MAX
 - 1)

	)

441 
	#RTAX_FEATURE_ECN
 (1 << 0)

	)

442 
	#RTAX_FEATURE_SACK
 (1 << 1)

	)

443 
	#RTAX_FEATURE_TIMESTAMP
 (1 << 2)

	)

444 
	#RTAX_FEATURE_ALLFRAG
 (1 << 3)

	)

446 
	#RTAX_FEATURE_MASK
 (
RTAX_FEATURE_ECN
 | 
RTAX_FEATURE_SACK
 | \

447 
RTAX_FEATURE_TIMESTAMP
 | 
RTAX_FEATURE_ALLFRAG
)

	)

449 
	s¹a_£ssiÚ
 {

450 
__u8
 
	m´Ùo
;

451 
__u8
 
	m·d1
;

452 
__u16
 
	m·d2
;

456 
__u16
 
	m¥Üt
;

457 
__u16
 
	mdpÜt
;

458 } 
	mpÜts
;

461 
__u8
 
	mty³
;

462 
__u8
 
	mcode
;

463 
__u16
 
	mid’t
;

464 } 
	micm±
;

466 
__u32
 
	m¥i
;

467 } 
	mu
;

470 
	s¹a_mfc_¡©s
 {

471 
__u64
 
	mmfcs_·ck‘s
;

472 
__u64
 
	mmfcs_by‹s
;

473 
__u64
 
	mmfcs_wrÚg_if
;

480 
	s¹g’msg
 {

481 
	m¹g’_çmy
;

493 
	sifšfomsg
 {

494 
	mifi_çmy
;

495 
	m__ifi_·d
;

496 
	mifi_ty³
;

497 
	mifi_šdex
;

498 
	mifi_æags
;

499 
	mifi_chªge
;

506 
	s´efixmsg
 {

507 
	m´efix_çmy
;

508 
	m´efix_·d1
;

509 
	m´efix_·d2
;

510 
	m´efix_ifšdex
;

511 
	m´efix_ty³
;

512 
	m´efix_Ën
;

513 
	m´efix_æags
;

514 
	m´efix_·d3
;

519 
	mPREFIX_UNSPEC
,

520 
	mPREFIX_ADDRESS
,

521 
	mPREFIX_CACHEINFO
,

522 
	m__PREFIX_MAX


525 
	#PREFIX_MAX
 (
__PREFIX_MAX
 - 1)

	)

527 
	s´efix_ÿchešfo
 {

528 
__u32
 
	m´eã¼ed_time
;

529 
__u32
 
	mv®id_time
;

537 
	stcmsg
 {

538 
	mtcm_çmy
;

539 
	mtcm__·d1
;

540 
	mtcm__·d2
;

541 
	mtcm_ifšdex
;

542 
__u32
 
	mtcm_hªdË
;

543 
__u32
 
	mtcm_·»Á
;

544 
__u32
 
	mtcm_šfo
;

548 
	mTCA_UNSPEC
,

549 
	mTCA_KIND
,

550 
	mTCA_OPTIONS
,

551 
	mTCA_STATS
,

552 
	mTCA_XSTATS
,

553 
	mTCA_RATE
,

554 
	mTCA_FCNT
,

555 
	mTCA_STATS2
,

556 
	mTCA_STAB
,

557 
	mTCA_PAD
,

558 
	mTCA_DUMP_INVISIBLE
,

559 
	mTCA_CHAIN
,

560 
	mTCA_HW_OFFLOAD
,

561 
	m__TCA_MAX


564 
	#TCA_MAX
 (
__TCA_MAX
 - 1)

	)

566 
	#TCA_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
tcmsg
))))

	)

567 
	#TCA_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
tcmsg
))

	)

573 
	sndu£rİtmsg
 {

574 
	mndu£rİt_çmy
;

575 
	mndu£rİt_·d1
;

576 
	mndu£rİt_İts_Ën
;

577 
	mndu£rİt_ifšdex
;

578 
__u8
 
	mndu£rİt_icmp_ty³
;

579 
__u8
 
	mndu£rİt_icmp_code
;

580 
	mndu£rİt_·d2
;

581 
	mndu£rİt_·d3
;

586 
	mNDUSEROPT_UNSPEC
,

587 
	mNDUSEROPT_SRCADDR
,

588 
	m__NDUSEROPT_MAX


591 
	#NDUSEROPT_MAX
 (
__NDUSEROPT_MAX
 - 1)

	)

594 
	#RTMGRP_LINK
 1

	)

595 
	#RTMGRP_NOTIFY
 2

	)

596 
	#RTMGRP_NEIGH
 4

	)

597 
	#RTMGRP_TC
 8

	)

599 
	#RTMGRP_IPV4_IFADDR
 0x10

	)

600 
	#RTMGRP_IPV4_MROUTE
 0x20

	)

601 
	#RTMGRP_IPV4_ROUTE
 0x40

	)

602 
	#RTMGRP_IPV4_RULE
 0x80

	)

604 
	#RTMGRP_IPV6_IFADDR
 0x100

	)

605 
	#RTMGRP_IPV6_MROUTE
 0x200

	)

606 
	#RTMGRP_IPV6_ROUTE
 0x400

	)

607 
	#RTMGRP_IPV6_IFINFO
 0x800

	)

609 
	#RTMGRP_DECÃt_IFADDR
 0x1000

	)

610 
	#RTMGRP_DECÃt_ROUTE
 0x4000

	)

612 
	#RTMGRP_IPV6_PREFIX
 0x20000

	)

615 
	e¹Ãšk_groups
 {

616 
	mRTNLGRP_NONE
,

617 
	#RTNLGRP_NONE
 
RTNLGRP_NONE


	)

618 
	mRTNLGRP_LINK
,

619 
	#RTNLGRP_LINK
 
RTNLGRP_LINK


	)

620 
	mRTNLGRP_NOTIFY
,

621 
	#RTNLGRP_NOTIFY
 
RTNLGRP_NOTIFY


	)

622 
	mRTNLGRP_NEIGH
,

623 
	#RTNLGRP_NEIGH
 
RTNLGRP_NEIGH


	)

624 
	mRTNLGRP_TC
,

625 
	#RTNLGRP_TC
 
RTNLGRP_TC


	)

626 
	mRTNLGRP_IPV4_IFADDR
,

627 
	#RTNLGRP_IPV4_IFADDR
 
RTNLGRP_IPV4_IFADDR


	)

628 
	mRTNLGRP_IPV4_MROUTE
,

629 
	#RTNLGRP_IPV4_MROUTE
 
RTNLGRP_IPV4_MROUTE


	)

630 
	mRTNLGRP_IPV4_ROUTE
,

631 
	#RTNLGRP_IPV4_ROUTE
 
RTNLGRP_IPV4_ROUTE


	)

632 
	mRTNLGRP_IPV4_RULE
,

633 
	#RTNLGRP_IPV4_RULE
 
RTNLGRP_IPV4_RULE


	)

634 
	mRTNLGRP_IPV6_IFADDR
,

635 
	#RTNLGRP_IPV6_IFADDR
 
RTNLGRP_IPV6_IFADDR


	)

636 
	mRTNLGRP_IPV6_MROUTE
,

637 
	#RTNLGRP_IPV6_MROUTE
 
RTNLGRP_IPV6_MROUTE


	)

638 
	mRTNLGRP_IPV6_ROUTE
,

639 
	#RTNLGRP_IPV6_ROUTE
 
RTNLGRP_IPV6_ROUTE


	)

640 
	mRTNLGRP_IPV6_IFINFO
,

641 
	#RTNLGRP_IPV6_IFINFO
 
RTNLGRP_IPV6_IFINFO


	)

642 
	mRTNLGRP_DECÃt_IFADDR
,

643 
	#RTNLGRP_DECÃt_IFADDR
 
RTNLGRP_DECÃt_IFADDR


	)

644 
	mRTNLGRP_NOP2
,

645 
	mRTNLGRP_DECÃt_ROUTE
,

646 
	#RTNLGRP_DECÃt_ROUTE
 
RTNLGRP_DECÃt_ROUTE


	)

647 
	mRTNLGRP_DECÃt_RULE
,

648 
	#RTNLGRP_DECÃt_RULE
 
RTNLGRP_DECÃt_RULE


	)

649 
	mRTNLGRP_NOP4
,

650 
	mRTNLGRP_IPV6_PREFIX
,

651 
	#RTNLGRP_IPV6_PREFIX
 
RTNLGRP_IPV6_PREFIX


	)

652 
	mRTNLGRP_IPV6_RULE
,

653 
	#RTNLGRP_IPV6_RULE
 
RTNLGRP_IPV6_RULE


	)

654 
	mRTNLGRP_ND_USEROPT
,

655 
	#RTNLGRP_ND_USEROPT
 
RTNLGRP_ND_USEROPT


	)

656 
	mRTNLGRP_PHONET_IFADDR
,

657 
	#RTNLGRP_PHONET_IFADDR
 
RTNLGRP_PHONET_IFADDR


	)

658 
	mRTNLGRP_PHONET_ROUTE
,

659 
	#RTNLGRP_PHONET_ROUTE
 
RTNLGRP_PHONET_ROUTE


	)

660 
	mRTNLGRP_DCB
,

661 
	#RTNLGRP_DCB
 
RTNLGRP_DCB


	)

662 
	mRTNLGRP_IPV4_NETCONF
,

663 
	#RTNLGRP_IPV4_NETCONF
 
RTNLGRP_IPV4_NETCONF


	)

664 
	mRTNLGRP_IPV6_NETCONF
,

665 
	#RTNLGRP_IPV6_NETCONF
 
RTNLGRP_IPV6_NETCONF


	)

666 
	mRTNLGRP_MDB
,

667 
	#RTNLGRP_MDB
 
RTNLGRP_MDB


	)

668 
	mRTNLGRP_MPLS_ROUTE
,

669 
	#RTNLGRP_MPLS_ROUTE
 
RTNLGRP_MPLS_ROUTE


	)

670 
	mRTNLGRP_NSID
,

671 
	#RTNLGRP_NSID
 
RTNLGRP_NSID


	)

672 
	mRTNLGRP_MPLS_NETCONF
,

673 
	#RTNLGRP_MPLS_NETCONF
 
RTNLGRP_MPLS_NETCONF


	)

674 
	mRTNLGRP_IPV4_MROUTE_R
,

675 
	#RTNLGRP_IPV4_MROUTE_R
 
RTNLGRP_IPV4_MROUTE_R


	)

676 
	mRTNLGRP_IPV6_MROUTE_R
,

677 
	#RTNLGRP_IPV6_MROUTE_R
 
RTNLGRP_IPV6_MROUTE_R


	)

678 
	m__RTNLGRP_MAX


680 
	#RTNLGRP_MAX
 (
__RTNLGRP_MAX
 - 1)

	)

683 
	stÿmsg
 {

684 
	mtÿ_çmy
;

685 
	mtÿ__·d1
;

686 
	mtÿ__·d2
;

690 
	mTCA_ROOT_UNSPEC
,

691 
	mTCA_ROOT_TAB
,

692 
	#TCA_ACT_TAB
 
TCA_ROOT_TAB


	)

693 
	#TCAA_MAX
 
TCA_ROOT_TAB


	)

694 
	mTCA_ROOT_FLAGS
,

695 
	mTCA_ROOT_COUNT
,

696 
	mTCA_ROOT_TIME_DELTA
,

697 
	m__TCA_ROOT_MAX
,

698 
	#TCA_ROOT_MAX
 (
__TCA_ROOT_MAX
 - 1)

	)

701 
	#TA_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
tÿmsg
))))

	)

702 
	#TA_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
tÿmsg
))

	)

710 
	#TCA_FLAG_LARGE_DUMP_ON
 (1 << 0)

	)

713 
	#RTEXT_FILTER_VF
 (1 << 0)

	)

714 
	#RTEXT_FILTER_BRVLAN
 (1 << 1)

	)

715 
	#RTEXT_FILTER_BRVLAN_COMPRESSED
 (1 << 2)

	)

716 
	#RTEXT_FILTER_SKIP_STATS
 (1 << 3)

	)

	@/usr/include/linux/sched.h

2 #iâdeà
_LINUX_SCHED_H


3 
	#_LINUX_SCHED_H


	)

8 
	#CSIGNAL
 0x000000fà

	)

9 
	#CLONE_VM
 0x00000100

	)

10 
	#CLONE_FS
 0x00000200

	)

11 
	#CLONE_FILES
 0x00000400

	)

12 
	#CLONE_SIGHAND
 0x00000800

	)

13 
	#CLONE_PTRACE
 0x00002000

	)

14 
	#CLONE_VFORK
 0x00004000

	)

15 
	#CLONE_PARENT
 0x00008000

	)

16 
	#CLONE_THREAD
 0x00010000

	)

17 
	#CLONE_NEWNS
 0x00020000

	)

18 
	#CLONE_SYSVSEM
 0x00040000

	)

19 
	#CLONE_SETTLS
 0x00080000

	)

20 
	#CLONE_PARENT_SETTID
 0x00100000

	)

21 
	#CLONE_CHILD_CLEARTID
 0x00200000

	)

22 
	#CLONE_DETACHED
 0x00400000

	)

23 
	#CLONE_UNTRACED
 0x00800000

	)

24 
	#CLONE_CHILD_SETTID
 0x01000000

	)

25 
	#CLONE_NEWCGROUP
 0x02000000

	)

26 
	#CLONE_NEWUTS
 0x04000000

	)

27 
	#CLONE_NEWIPC
 0x08000000

	)

28 
	#CLONE_NEWUSER
 0x10000000

	)

29 
	#CLONE_NEWPID
 0x20000000

	)

30 
	#CLONE_NEWNET
 0x40000000

	)

31 
	#CLONE_IO
 0x80000000

	)

36 
	#SCHED_NORMAL
 0

	)

37 
	#SCHED_FIFO
 1

	)

38 
	#SCHED_RR
 2

	)

39 
	#SCHED_BATCH
 3

	)

41 
	#SCHED_IDLE
 5

	)

42 
	#SCHED_DEADLINE
 6

	)

45 
	#SCHED_RESET_ON_FORK
 0x40000000

	)

50 
	#SCHED_FLAG_RESET_ON_FORK
 0x01

	)

51 
	#SCHED_FLAG_RECLAIM
 0x02

	)

	@/usr/include/linux/socket.h

2 #iâdeà
_LINUX_SOCKET_H


3 
	#_LINUX_SOCKET_H


	)

8 
	#_K_SS_MAXSIZE
 128

	)

9 
	#_K_SS_ALIGNSIZE
 (
	`__®ignof__
 (
sockaddr
 *))

	)

12 
	t__k”Ãl_§_çmy_t
;

14 
	s__k”Ãl_sockaddr_¡Üage
 {

15 
__k”Ãl_§_çmy_t
 
	mss_çmy
;

17 
	m__d©a
[
_K_SS_MAXSIZE
 - ()];

20 } 
__©Œibu‹__
 ((
®igÃd
(
_K_SS_ALIGNSIZE
)));

	@/usr/include/linux/string.h

2 #iâdeà
_LINUX_STRING_H_


3 
	#_LINUX_STRING_H_


	)

7 
	~<¡ršg.h
>

	@/usr/include/linux/time.h

2 #iâdeà
_LINUX_TIME_H


3 
	#_LINUX_TIME_H


	)

5 
	~<lšux/ty³s.h
>

8 #iâdeà
_STRUCT_TIMESPEC


9 
	#_STRUCT_TIMESPEC


	)

10 
	stime¥ec
 {

11 
__k”Ãl_time_t
 
	mtv_£c
;

12 
	mtv_n£c
;

16 
	stimev®
 {

17 
__k”Ãl_time_t
 
	mtv_£c
;

18 
__k”Ãl_su£cÚds_t
 
	mtv_u£c
;

21 
	stimezÚe
 {

22 
	mtz_mšu‹swe¡
;

23 
	mtz_d¡time
;

31 
	#ITIMER_REAL
 0

	)

32 
	#ITIMER_VIRTUAL
 1

	)

33 
	#ITIMER_PROF
 2

	)

35 
	s™im”¥ec
 {

36 
time¥ec
 
	m™_š‹rv®
;

37 
time¥ec
 
	m™_v®ue
;

40 
	s™im”v®
 {

41 
timev®
 
	m™_š‹rv®
;

42 
timev®
 
	m™_v®ue
;

48 
	#CLOCK_REALTIME
 0

	)

49 
	#CLOCK_MONOTONIC
 1

	)

50 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

51 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

52 
	#CLOCK_MONOTONIC_RAW
 4

	)

53 
	#CLOCK_REALTIME_COARSE
 5

	)

54 
	#CLOCK_MONOTONIC_COARSE
 6

	)

55 
	#CLOCK_BOOTTIME
 7

	)

56 
	#CLOCK_REALTIME_ALARM
 8

	)

57 
	#CLOCK_BOOTTIME_ALARM
 9

	)

62 
	#CLOCK_SGI_CYCLE
 10

	)

63 
	#CLOCK_TAI
 11

	)

65 
	#MAX_CLOCKS
 16

	)

66 
	#CLOCKS_MASK
 (
CLOCK_REALTIME
 | 
CLOCK_MONOTONIC
)

	)

67 
	#CLOCKS_MONO
 
CLOCK_MONOTONIC


	)

72 
	#TIMER_ABSTIME
 0x01

	)

	@/usr/include/linux/types.h

2 #iâdeà
_LINUX_TYPES_H


3 
	#_LINUX_TYPES_H


	)

5 
	~<asm/ty³s.h
>

7 #iâdeà
__ASSEMBLY__


9 
	~<lšux/posix_ty³s.h
>

17 #ifdeà
__CHECKER__


18 
	#__b™wi£__
 
	`__©Œibu‹__
((
b™wi£
))

	)

20 
	#__b™wi£__


	)

22 
	#__b™wi£
 
__b™wi£__


	)

24 
__u16
 
	t__b™wi£
 
	t__Ë16
;

25 
__u16
 
	t__b™wi£
 
	t__be16
;

26 
__u32
 
	t__b™wi£
 
	t__Ë32
;

27 
__u32
 
	t__b™wi£
 
	t__be32
;

28 
__u64
 
	t__b™wi£
 
	t__Ë64
;

29 
__u64
 
	t__b™wi£
 
	t__be64
;

31 
__u16
 
	t__b™wi£
 
	t__sum16
;

32 
__u32
 
	t__b™wi£
 
	t__wsum
;

43 
	#__®igÃd_u64
 
__u64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

44 
	#__®igÃd_be64
 
__be64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

45 
	#__®igÃd_Ë64
 
__Ë64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

	@/usr/include/linux/version.h

1 
	#LINUX_VERSION_CODE
 266002

	)

2 
	#KERNEL_VERSION
(
a
,
b
,
c
è((×è<< 16è+ ((bè<< 8è+ (c))

	)

	@/usr/include/linux/wait.h

2 #iâdeà
_LINUX_WAIT_H


3 
	#_LINUX_WAIT_H


	)

5 
	#WNOHANG
 0x00000001

	)

6 
	#WUNTRACED
 0x00000002

	)

7 
	#WSTOPPED
 
WUNTRACED


	)

8 
	#WEXITED
 0x00000004

	)

9 
	#WCONTINUED
 0x00000008

	)

10 
	#WNOWAIT
 0x01000000

	)

12 
	#__WNOTHREAD
 0x20000000

	)

13 
	#__WALL
 0x40000000

	)

14 
	#__WCLONE
 0x80000000

	)

17 
	#P_ALL
 0

	)

18 
	#P_PID
 1

	)

19 
	#P_PGID
 2

	)

	@/usr/include/linux/wireless.h

11 #iâdeà
_LINUX_WIRELESS_H


12 
	#_LINUX_WIRELESS_H


	)

73 
	~<lšux/ty³s.h
>

74 
	~<lšux/sock‘.h
>

75 
	~<lšux/if.h
>

84 
	#WIRELESS_EXT
 22

	)

231 
	#SIOCSIWCOMMIT
 0x8B00

	)

232 
	#SIOCGIWNAME
 0x8B01

	)

238 
	#SIOCSIWNWID
 0x8B02

	)

239 
	#SIOCGIWNWID
 0x8B03

	)

240 
	#SIOCSIWFREQ
 0x8B04

	)

241 
	#SIOCGIWFREQ
 0x8B05

	)

242 
	#SIOCSIWMODE
 0x8B06

	)

243 
	#SIOCGIWMODE
 0x8B07

	)

244 
	#SIOCSIWSENS
 0x8B08

	)

245 
	#SIOCGIWSENS
 0x8B09

	)

248 
	#SIOCSIWRANGE
 0x8B0A

	)

249 
	#SIOCGIWRANGE
 0x8B0B

	)

250 
	#SIOCSIWPRIV
 0x8B0C

	)

251 
	#SIOCGIWPRIV
 0x8B0D

	)

252 
	#SIOCSIWSTATS
 0x8B0E

	)

253 
	#SIOCGIWSTATS
 0x8B0F

	)

258 
	#SIOCSIWSPY
 0x8B10

	)

259 
	#SIOCGIWSPY
 0x8B11

	)

260 
	#SIOCSIWTHRSPY
 0x8B12

	)

261 
	#SIOCGIWTHRSPY
 0x8B13

	)

264 
	#SIOCSIWAP
 0x8B14

	)

265 
	#SIOCGIWAP
 0x8B15

	)

266 
	#SIOCGIWAPLIST
 0x8B17

	)

267 
	#SIOCSIWSCAN
 0x8B18

	)

268 
	#SIOCGIWSCAN
 0x8B19

	)

271 
	#SIOCSIWESSID
 0x8B1A

	)

272 
	#SIOCGIWESSID
 0x8B1B

	)

273 
	#SIOCSIWNICKN
 0x8B1C

	)

274 
	#SIOCGIWNICKN
 0x8B1D

	)

280 
	#SIOCSIWRATE
 0x8B20

	)

281 
	#SIOCGIWRATE
 0x8B21

	)

282 
	#SIOCSIWRTS
 0x8B22

	)

283 
	#SIOCGIWRTS
 0x8B23

	)

284 
	#SIOCSIWFRAG
 0x8B24

	)

285 
	#SIOCGIWFRAG
 0x8B25

	)

286 
	#SIOCSIWTXPOW
 0x8B26

	)

287 
	#SIOCGIWTXPOW
 0x8B27

	)

288 
	#SIOCSIWRETRY
 0x8B28

	)

289 
	#SIOCGIWRETRY
 0x8B29

	)

292 
	#SIOCSIWENCODE
 0x8B2A

	)

293 
	#SIOCGIWENCODE
 0x8B2B

	)

295 
	#SIOCSIWPOWER
 0x8B2C

	)

296 
	#SIOCGIWPOWER
 0x8B2D

	)

305 
	#SIOCSIWGENIE
 0x8B30

	)

306 
	#SIOCGIWGENIE
 0x8B31

	)

309 
	#SIOCSIWMLME
 0x8B16

	)

312 
	#SIOCSIWAUTH
 0x8B32

	)

313 
	#SIOCGIWAUTH
 0x8B33

	)

316 
	#SIOCSIWENCODEEXT
 0x8B34

	)

317 
	#SIOCGIWENCODEEXT
 0x8B35

	)

320 
	#SIOCSIWPMKSA
 0x8B36

	)

331 
	#SIOCIWFIRSTPRIV
 0x8BE0

	)

332 
	#SIOCIWLASTPRIV
 0x8BFF

	)

347 
	#SIOCIWFIRST
 0x8B00

	)

348 
	#SIOCIWLAST
 
SIOCIWLASTPRIV


	)

349 
	#IW_IOCTL_IDX
(
cmd
è((cmdè- 
SIOCIWFIRST
)

	)

350 
	#IW_HANDLER
(
id
, 
func
) \

351 [
	`IW_IOCTL_IDX
(
id
)] = 
func


	)

354 
	#IW_IS_SET
(
cmd
è(!((cmdè& 0x1))

	)

355 
	#IW_IS_GET
(
cmd
è((cmdè& 0x1)

	)

361 
	#IWEVTXDROP
 0x8C00

	)

362 
	#IWEVQUAL
 0x8C01

	)

363 
	#IWEVCUSTOM
 0x8C02

	)

364 
	#IWEVREGISTERED
 0x8C03

	)

365 
	#IWEVEXPIRED
 0x8C04

	)

366 
	#IWEVGENIE
 0x8C05

	)

372 
	#IWEVMICHAELMICFAILURE
 0x8C06

	)

375 
	#IWEVASSOCREQIE
 0x8C07

	)

384 
	#IWEVASSOCRESPIE
 0x8C08

	)

391 
	#IWEVPMKIDCAND
 0x8C09

	)

395 
	#IWEVFIRST
 0x8C00

	)

396 
	#IW_EVENT_IDX
(
cmd
è((cmdè- 
IWEVFIRST
)

	)

405 
	#IW_PRIV_TYPE_MASK
 0x7000

	)

406 
	#IW_PRIV_TYPE_NONE
 0x0000

	)

407 
	#IW_PRIV_TYPE_BYTE
 0x1000

	)

408 
	#IW_PRIV_TYPE_CHAR
 0x2000

	)

409 
	#IW_PRIV_TYPE_INT
 0x4000

	)

410 
	#IW_PRIV_TYPE_FLOAT
 0x5000

	)

411 
	#IW_PRIV_TYPE_ADDR
 0x6000

	)

413 
	#IW_PRIV_SIZE_FIXED
 0x0800

	)

415 
	#IW_PRIV_SIZE_MASK
 0x07FF

	)

425 
	#IW_MAX_FREQUENCIES
 32

	)

431 
	#IW_MAX_BITRATES
 32

	)

434 
	#IW_MAX_TXPOWER
 8

	)

439 
	#IW_MAX_SPY
 8

	)

443 
	#IW_MAX_AP
 64

	)

446 
	#IW_ESSID_MAX_SIZE
 32

	)

449 
	#IW_MODE_AUTO
 0

	)

450 
	#IW_MODE_ADHOC
 1

	)

451 
	#IW_MODE_INFRA
 2

	)

452 
	#IW_MODE_MASTER
 3

	)

453 
	#IW_MODE_REPEAT
 4

	)

454 
	#IW_MODE_SECOND
 5

	)

455 
	#IW_MODE_MONITOR
 6

	)

456 
	#IW_MODE_MESH
 7

	)

459 
	#IW_QUAL_QUAL_UPDATED
 0x01

	)

460 
	#IW_QUAL_LEVEL_UPDATED
 0x02

	)

461 
	#IW_QUAL_NOISE_UPDATED
 0x04

	)

462 
	#IW_QUAL_ALL_UPDATED
 0x07

	)

463 
	#IW_QUAL_DBM
 0x08

	)

464 
	#IW_QUAL_QUAL_INVALID
 0x10

	)

465 
	#IW_QUAL_LEVEL_INVALID
 0x20

	)

466 
	#IW_QUAL_NOISE_INVALID
 0x40

	)

467 
	#IW_QUAL_RCPI
 0x80

	)

468 
	#IW_QUAL_ALL_INVALID
 0x70

	)

471 
	#IW_FREQ_AUTO
 0x00

	)

472 
	#IW_FREQ_FIXED
 0x01

	)

476 
	#IW_MAX_ENCODING_SIZES
 8

	)

479 
	#IW_ENCODING_TOKEN_MAX
 64

	)

482 
	#IW_ENCODE_INDEX
 0x00FF

	)

483 
	#IW_ENCODE_FLAGS
 0xFF00

	)

484 
	#IW_ENCODE_MODE
 0xF000

	)

485 
	#IW_ENCODE_DISABLED
 0x8000

	)

486 
	#IW_ENCODE_ENABLED
 0x0000

	)

487 
	#IW_ENCODE_RESTRICTED
 0x4000

	)

488 
	#IW_ENCODE_OPEN
 0x2000

	)

489 
	#IW_ENCODE_NOKEY
 0x0800

	)

490 
	#IW_ENCODE_TEMP
 0x0400

	)

493 
	#IW_POWER_ON
 0x0000

	)

494 
	#IW_POWER_TYPE
 0xF000

	)

495 
	#IW_POWER_PERIOD
 0x1000

	)

496 
	#IW_POWER_TIMEOUT
 0x2000

	)

497 
	#IW_POWER_MODE
 0x0F00

	)

498 
	#IW_POWER_UNICAST_R
 0x0100

	)

499 
	#IW_POWER_MULTICAST_R
 0x0200

	)

500 
	#IW_POWER_ALL_R
 0x0300

	)

501 
	#IW_POWER_FORCE_S
 0x0400

	)

502 
	#IW_POWER_REPEATER
 0x0800

	)

503 
	#IW_POWER_MODIFIER
 0x000F

	)

504 
	#IW_POWER_MIN
 0x0001

	)

505 
	#IW_POWER_MAX
 0x0002

	)

506 
	#IW_POWER_RELATIVE
 0x0004

	)

509 
	#IW_TXPOW_TYPE
 0x00FF

	)

510 
	#IW_TXPOW_DBM
 0x0000

	)

511 
	#IW_TXPOW_MWATT
 0x0001

	)

512 
	#IW_TXPOW_RELATIVE
 0x0002

	)

513 
	#IW_TXPOW_RANGE
 0x1000

	)

516 
	#IW_RETRY_ON
 0x0000

	)

517 
	#IW_RETRY_TYPE
 0xF000

	)

518 
	#IW_RETRY_LIMIT
 0x1000

	)

519 
	#IW_RETRY_LIFETIME
 0x2000

	)

520 
	#IW_RETRY_MODIFIER
 0x00FF

	)

521 
	#IW_RETRY_MIN
 0x0001

	)

522 
	#IW_RETRY_MAX
 0x0002

	)

523 
	#IW_RETRY_RELATIVE
 0x0004

	)

524 
	#IW_RETRY_SHORT
 0x0010

	)

525 
	#IW_RETRY_LONG
 0x0020

	)

528 
	#IW_SCAN_DEFAULT
 0x0000

	)

529 
	#IW_SCAN_ALL_ESSID
 0x0001

	)

530 
	#IW_SCAN_THIS_ESSID
 0x0002

	)

531 
	#IW_SCAN_ALL_FREQ
 0x0004

	)

532 
	#IW_SCAN_THIS_FREQ
 0x0008

	)

533 
	#IW_SCAN_ALL_MODE
 0x0010

	)

534 
	#IW_SCAN_THIS_MODE
 0x0020

	)

535 
	#IW_SCAN_ALL_RATE
 0x0040

	)

536 
	#IW_SCAN_THIS_RATE
 0x0080

	)

538 
	#IW_SCAN_TYPE_ACTIVE
 0

	)

539 
	#IW_SCAN_TYPE_PASSIVE
 1

	)

541 
	#IW_SCAN_MAX_DATA
 4096

	)

544 
	#IW_SCAN_CAPA_NONE
 0x00

	)

545 
	#IW_SCAN_CAPA_ESSID
 0x01

	)

546 
	#IW_SCAN_CAPA_BSSID
 0x02

	)

547 
	#IW_SCAN_CAPA_CHANNEL
 0x04

	)

548 
	#IW_SCAN_CAPA_MODE
 0x08

	)

549 
	#IW_SCAN_CAPA_RATE
 0x10

	)

550 
	#IW_SCAN_CAPA_TYPE
 0x20

	)

551 
	#IW_SCAN_CAPA_TIME
 0x40

	)

554 
	#IW_CUSTOM_MAX
 256

	)

557 
	#IW_GENERIC_IE_MAX
 1024

	)

560 
	#IW_MLME_DEAUTH
 0

	)

561 
	#IW_MLME_DISASSOC
 1

	)

562 
	#IW_MLME_AUTH
 2

	)

563 
	#IW_MLME_ASSOC
 3

	)

566 
	#IW_AUTH_INDEX
 0x0FFF

	)

567 
	#IW_AUTH_FLAGS
 0xF000

	)

572 
	#IW_AUTH_WPA_VERSION
 0

	)

573 
	#IW_AUTH_CIPHER_PAIRWISE
 1

	)

574 
	#IW_AUTH_CIPHER_GROUP
 2

	)

575 
	#IW_AUTH_KEY_MGMT
 3

	)

576 
	#IW_AUTH_TKIP_COUNTERMEASURES
 4

	)

577 
	#IW_AUTH_DROP_UNENCRYPTED
 5

	)

578 
	#IW_AUTH_80211_AUTH_ALG
 6

	)

579 
	#IW_AUTH_WPA_ENABLED
 7

	)

580 
	#IW_AUTH_RX_UNENCRYPTED_EAPOL
 8

	)

581 
	#IW_AUTH_ROAMING_CONTROL
 9

	)

582 
	#IW_AUTH_PRIVACY_INVOKED
 10

	)

583 
	#IW_AUTH_CIPHER_GROUP_MGMT
 11

	)

584 
	#IW_AUTH_MFP
 12

	)

587 
	#IW_AUTH_WPA_VERSION_DISABLED
 0x00000001

	)

588 
	#IW_AUTH_WPA_VERSION_WPA
 0x00000002

	)

589 
	#IW_AUTH_WPA_VERSION_WPA2
 0x00000004

	)

593 
	#IW_AUTH_CIPHER_NONE
 0x00000001

	)

594 
	#IW_AUTH_CIPHER_WEP40
 0x00000002

	)

595 
	#IW_AUTH_CIPHER_TKIP
 0x00000004

	)

596 
	#IW_AUTH_CIPHER_CCMP
 0x00000008

	)

597 
	#IW_AUTH_CIPHER_WEP104
 0x00000010

	)

598 
	#IW_AUTH_CIPHER_AES_CMAC
 0x00000020

	)

601 
	#IW_AUTH_KEY_MGMT_802_1X
 1

	)

602 
	#IW_AUTH_KEY_MGMT_PSK
 2

	)

605 
	#IW_AUTH_ALG_OPEN_SYSTEM
 0x00000001

	)

606 
	#IW_AUTH_ALG_SHARED_KEY
 0x00000002

	)

607 
	#IW_AUTH_ALG_LEAP
 0x00000004

	)

610 
	#IW_AUTH_ROAMING_ENABLE
 0

	)

611 
	#IW_AUTH_ROAMING_DISABLE
 1

	)

615 
	#IW_AUTH_MFP_DISABLED
 0

	)

616 
	#IW_AUTH_MFP_OPTIONAL
 1

	)

617 
	#IW_AUTH_MFP_REQUIRED
 2

	)

620 
	#IW_ENCODE_SEQ_MAX_SIZE
 8

	)

622 
	#IW_ENCODE_ALG_NONE
 0

	)

623 
	#IW_ENCODE_ALG_WEP
 1

	)

624 
	#IW_ENCODE_ALG_TKIP
 2

	)

625 
	#IW_ENCODE_ALG_CCMP
 3

	)

626 
	#IW_ENCODE_ALG_PMK
 4

	)

627 
	#IW_ENCODE_ALG_AES_CMAC
 5

	)

629 
	#IW_ENCODE_EXT_TX_SEQ_VALID
 0x00000001

	)

630 
	#IW_ENCODE_EXT_RX_SEQ_VALID
 0x00000002

	)

631 
	#IW_ENCODE_EXT_GROUP_KEY
 0x00000004

	)

632 
	#IW_ENCODE_EXT_SET_TX_KEY
 0x00000008

	)

635 
	#IW_MICFAILURE_KEY_ID
 0x00000003

	)

636 
	#IW_MICFAILURE_GROUP
 0x00000004

	)

637 
	#IW_MICFAILURE_PAIRWISE
 0x00000008

	)

638 
	#IW_MICFAILURE_STAKEY
 0x00000010

	)

639 
	#IW_MICFAILURE_COUNT
 0x00000060

	)

643 
	#IW_ENC_CAPA_WPA
 0x00000001

	)

644 
	#IW_ENC_CAPA_WPA2
 0x00000002

	)

645 
	#IW_ENC_CAPA_CIPHER_TKIP
 0x00000004

	)

646 
	#IW_ENC_CAPA_CIPHER_CCMP
 0x00000008

	)

647 
	#IW_ENC_CAPA_4WAY_HANDSHAKE
 0x00000010

	)

652 
	#IW_EVENT_CAPA_BASE
(
cmd
è((cmd >ğ
SIOCIWFIRSTPRIV
) ? \

653 (
cmd
 - 
SIOCIWFIRSTPRIV
 + 0x60) : \

654 (
cmd
 - 
SIOCIWFIRST
))

	)

655 
	#IW_EVENT_CAPA_INDEX
(
cmd
è(
	`IW_EVENT_CAPA_BASE
(cmdè>> 5)

	)

656 
	#IW_EVENT_CAPA_MASK
(
cmd
è(1 << (
	`IW_EVENT_CAPA_BASE
(cmdè& 0x1F))

	)

659 
	#IW_EVENT_CAPA_K_0
 (
	`IW_EVENT_CAPA_MASK
(0x8B04) | \

660 
	`IW_EVENT_CAPA_MASK
(0x8B06) | \

661 
	`IW_EVENT_CAPA_MASK
(0x8B1A))

	)

662 
	#IW_EVENT_CAPA_K_1
 (
	`IW_EVENT_CAPA_MASK
(0x8B2A))

	)

664 
	#IW_EVENT_CAPA_SET
(
ev’t_ÿ·
, 
cmd
èÓv’t_ÿ·[
	`IW_EVENT_CAPA_INDEX
(cmd)] |ğ
	`IW_EVENT_CAPA_MASK
(cmd))

	)

665 
	#IW_EVENT_CAPA_SET_KERNEL
(
ev’t_ÿ·
è{ev’t_ÿ·[0] |ğ
IW_EVENT_CAPA_K_0
;ƒv’t_ÿ·[1] |ğ
IW_EVENT_CAPA_K_1
; }

	)

674 
	siw_·¿m
 {

675 
__s32
 
	mv®ue
;

676 
__u8
 
	mfixed
;

677 
__u8
 
	mdi§bËd
;

678 
__u16
 
	mæags
;

685 
	siw_pošt
 {

686 *
	mpoš‹r
;

687 
__u16
 
	mËngth
;

688 
__u16
 
	mæags
;

700 
	siw_äeq
 {

701 
__s32
 
	mm
;

702 
__s16
 
	me
;

703 
__u8
 
	mi
;

704 
__u8
 
	mæags
;

710 
	siw_qu®™y
 {

711 
__u8
 
	mqu®
;

713 
__u8
 
	mËv–
;

714 
__u8
 
	mnoi£
;

715 
__u8
 
	mupd©ed
;

725 
	siw_disÿrded
 {

726 
__u32
 
	mnwid
;

727 
__u32
 
	mcode
;

728 
__u32
 
	mäagm’t
;

729 
__u32
 
	m»Œ›s
;

730 
__u32
 
	mmisc
;

737 
	siw_mis£d
 {

738 
__u32
 
	mb—cÚ
;

744 
	siw_thr¥y
 {

745 
sockaddr
 
	maddr
;

746 
iw_qu®™y
 
	mqu®
;

747 
iw_qu®™y
 
	mlow
;

748 
iw_qu®™y
 
	mhigh
;

762 
	siw_sÿn_»q
 {

763 
__u8
 
	msÿn_ty³
;

764 
__u8
 
	messid_Ën
;

765 
__u8
 
	mnum_chªÃls
;

767 
__u8
 
	mæags
;

770 
sockaddr
 
	mbssid
;

779 
__u8
 
	messid
[
IW_ESSID_MAX_SIZE
];

791 
__u32
 
	mmš_chªÃl_time
;

792 
__u32
 
	mmax_chªÃl_time
;

794 
iw_äeq
 
	mchªÃl_li¡
[
IW_MAX_FREQUENCIES
];

823 
	siw_’code_ext
 {

824 
__u32
 
	mext_æags
;

825 
__u8
 
	mtx_£q
[
IW_ENCODE_SEQ_MAX_SIZE
];

826 
__u8
 
	mrx_£q
[
IW_ENCODE_SEQ_MAX_SIZE
];

827 
sockaddr
 
	maddr
;

830 
__u16
 
	m®g
;

831 
__u16
 
	mkey_Ën
;

832 
__u8
 
	mkey
[0];

836 
	siw_mlme
 {

837 
__u16
 
	mcmd
;

838 
__u16
 
	m»asÚ_code
;

839 
sockaddr
 
	maddr
;

843 
	#IW_PMKSA_ADD
 1

	)

844 
	#IW_PMKSA_REMOVE
 2

	)

845 
	#IW_PMKSA_FLUSH
 3

	)

847 
	#IW_PMKID_LEN
 16

	)

849 
	siw_pmk§
 {

850 
__u32
 
	mcmd
;

851 
sockaddr
 
	mbssid
;

852 
__u8
 
	mpmkid
[
IW_PMKID_LEN
];

856 
	siw_mich«lmicçu»
 {

857 
__u32
 
	mæags
;

858 
sockaddr
 
	m¤c_addr
;

859 
__u8
 
	mtsc
[
IW_ENCODE_SEQ_MAX_SIZE
];

863 
	#IW_PMKID_CAND_PREAUTH
 0x00000001

	)

864 
	siw_pmkid_ÿnd
 {

865 
__u32
 
	mæags
;

866 
__u32
 
	mšdex
;

868 
sockaddr
 
	mbssid
;

875 
	siw_¡©i¡ics
 {

876 
__u16
 
	m¡©us
;

879 
iw_qu®™y
 
	mqu®
;

881 
iw_disÿrded
 
	mdisÿrd
;

882 
iw_mis£d
 
	mmiss
;

896 
	uiw»q_d©a
 {

898 
	mÇme
[
IFNAMSIZ
];

902 
iw_pošt
 
	messid
;

903 
iw_·¿m
 
	mnwid
;

904 
iw_äeq
 
	mäeq
;

908 
iw_·¿m
 
	m£ns
;

909 
iw_·¿m
 
	mb™¿‹
;

910 
iw_·¿m
 
	mtxpow”
;

911 
iw_·¿m
 
	m¹s
;

912 
iw_·¿m
 
	mäag
;

913 
__u32
 
	mmode
;

914 
iw_·¿m
 
	m»Œy
;

916 
iw_pošt
 
	m’codšg
;

917 
iw_·¿m
 
	mpow”
;

918 
iw_qu®™y
 
	mqu®
;

920 
sockaddr
 
	m­_addr
;

921 
sockaddr
 
	maddr
;

923 
iw_·¿m
 
	m·¿m
;

924 
iw_pošt
 
	md©a
;

933 
	siw»q
 {

936 
	miän_Çme
[
IFNAMSIZ
];

937 } 
	miä_iän
;

940 
iw»q_d©a
 
	mu
;

953 
	siw_¿nge
 {

955 
__u32
 
	mthroughput
;

964 
__u32
 
	mmš_nwid
;

965 
__u32
 
	mmax_nwid
;

968 
__u16
 
	mŞd_num_chªÃls
;

969 
__u8
 
	mŞd_num_äequ’cy
;

972 
__u8
 
	msÿn_ÿ·
;

975 
__u32
 
	mev’t_ÿ·
[6];

978 
__s32
 
	m£ns™iv™y
;

985 
iw_qu®™y
 
	mmax_qu®
;

995 
iw_qu®™y
 
	mavg_qu®
;

998 
__u8
 
	mnum_b™¿‹s
;

999 
__s32
 
	mb™¿‹
[
IW_MAX_BITRATES
];

1002 
__s32
 
	mmš_¹s
;

1003 
__s32
 
	mmax_¹s
;

1006 
__s32
 
	mmš_äag
;

1007 
__s32
 
	mmax_äag
;

1010 
__s32
 
	mmš_pmp
;

1011 
__s32
 
	mmax_pmp
;

1012 
__s32
 
	mmš_pmt
;

1013 
__s32
 
	mmax_pmt
;

1014 
__u16
 
	mpmp_æags
;

1015 
__u16
 
	mpmt_æags
;

1016 
__u16
 
	mpm_ÿ·
;

1019 
__u16
 
	m’codšg_size
[
IW_MAX_ENCODING_SIZES
];

1020 
__u8
 
	mnum_’codšg_sizes
;

1021 
__u8
 
	mmax_’codšg_tok’s
;

1023 
__u8
 
	m’codšg_logš_šdex
;

1026 
__u16
 
	mtxpow”_ÿ·
;

1027 
__u8
 
	mnum_txpow”
;

1028 
__s32
 
	mtxpow”
[
IW_MAX_TXPOWER
];

1031 
__u8
 
	mwe_v”siÚ_comped
;

1032 
__u8
 
	mwe_v”siÚ_sourû
;

1035 
__u16
 
	m»Œy_ÿ·
;

1036 
__u16
 
	m»Œy_æags
;

1037 
__u16
 
	mr_time_æags
;

1038 
__s32
 
	mmš_»Œy
;

1039 
__s32
 
	mmax_»Œy
;

1040 
__s32
 
	mmš_r_time
;

1041 
__s32
 
	mmax_r_time
;

1044 
__u16
 
	mnum_chªÃls
;

1045 
__u8
 
	mnum_äequ’cy
;

1046 
iw_äeq
 
	mäeq
[
IW_MAX_FREQUENCIES
];

1050 
__u32
 
	m’c_ÿ·
;

1057 
	siw_´iv_¬gs
 {

1058 
__u32
 
	mcmd
;

1059 
__u16
 
	m£t_¬gs
;

1060 
__u16
 
	mg‘_¬gs
;

1061 
	mÇme
[
IFNAMSIZ
];

1074 
	siw_ev’t
 {

1075 
__u16
 
	mËn
;

1076 
__u16
 
	mcmd
;

1077 
iw»q_d©a
 
	mu
;

1081 
	#IW_EV_LCP_LEN
 ((
iw_ev’t
è- (
iw»q_d©a
))

	)

1083 
	#IW_EV_CHAR_LEN
 (
IW_EV_LCP_LEN
 + 
IFNAMSIZ
)

	)

1084 
	#IW_EV_UINT_LEN
 (
IW_EV_LCP_LEN
 + (
__u32
))

	)

1085 
	#IW_EV_FREQ_LEN
 (
IW_EV_LCP_LEN
 + (
iw_äeq
))

	)

1086 
	#IW_EV_PARAM_LEN
 (
IW_EV_LCP_LEN
 + (
iw_·¿m
))

	)

1087 
	#IW_EV_ADDR_LEN
 (
IW_EV_LCP_LEN
 + (
sockaddr
))

	)

1088 
	#IW_EV_QUAL_LEN
 (
IW_EV_LCP_LEN
 + (
iw_qu®™y
))

	)

1093 
	#IW_EV_POINT_OFF
 (((*è&(((
iw_pošt
 *è
NULL
)->
Ëngth
)) - \

1094 (*è
NULL
)

	)

1095 
	#IW_EV_POINT_LEN
 (
IW_EV_LCP_LEN
 + (
iw_pošt
) - \

1096 
IW_EV_POINT_OFF
)

	)

1100 
	#IW_EV_LCP_PK_LEN
 (4)

	)

1102 
	#IW_EV_CHAR_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + 
IFNAMSIZ
)

	)

1103 
	#IW_EV_UINT_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
__u32
))

	)

1104 
	#IW_EV_FREQ_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
iw_äeq
))

	)

1105 
	#IW_EV_PARAM_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
iw_·¿m
))

	)

1106 
	#IW_EV_ADDR_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
sockaddr
))

	)

1107 
	#IW_EV_QUAL_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + (
iw_qu®™y
))

	)

1108 
	#IW_EV_POINT_PK_LEN
 (
IW_EV_LCP_PK_LEN
 + 4)

	)

	@/usr/include/sys/socket.h

19 #iâdef 
_SYS_SOCKET_H


20 
	#_SYS_SOCKET_H
 1

	)

22 
	~<ã©u»s.h
>

24 
	g__BEGIN_DECLS


26 
	~<b™s/ty³s/¡ruù_iovec.h
>

27 
	#__Ãed_size_t


	)

28 
	~<¡ddef.h
>

33 
	~<b™s/sock‘.h
>

35 #ifdeà
__USE_MISC


36 
	~<b™s/ty³s/¡ruù_osockaddr.h
>

43 
	mSHUT_RD
 = 0,

44 
	#SHUT_RD
 
SHUT_RD


	)

45 
	mSHUT_WR
,

46 
	#SHUT_WR
 
SHUT_WR


	)

47 
	mSHUT_RDWR


48 
	#SHUT_RDWR
 
SHUT_RDWR


	)

57 #ià
defšed
 
__ılu¥lus
 || !
__GNUC_PREREQ
 (2, 7è|| !defšed 
__USE_GNU


58 
	#__SOCKADDR_ARG
 
sockaddr
 *
__»¡riù


	)

59 
	#__CONST_SOCKADDR_ARG
 cÚ¡ 
sockaddr
 *

	)

63 
	#__SOCKADDR_ALLTYPES
 \

64 
	`__SOCKADDR_ONETYPE
 (
sockaddr
) \

65 
	`__SOCKADDR_ONETYPE
 (
sockaddr_©
) \

66 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ax25
) \

67 
	`__SOCKADDR_ONETYPE
 (
sockaddr_dl
) \

68 
	`__SOCKADDR_ONETYPE
 (
sockaddr_eÚ
) \

69 
	`__SOCKADDR_ONETYPE
 (
sockaddr_š
) \

70 
	`__SOCKADDR_ONETYPE
 (
sockaddr_š6
) \

71 
	`__SOCKADDR_ONETYPE
 (
sockaddr_š¬p
) \

72 
	`__SOCKADDR_ONETYPE
 (
sockaddr_x
) \

73 
	`__SOCKADDR_ONETYPE
 (
sockaddr_iso
) \

74 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ns
) \

75 
	`__SOCKADDR_ONETYPE
 (
sockaddr_un
) \

76 
	`__SOCKADDR_ONETYPE
 (
sockaddr_x25
)

	)

78 
	#__SOCKADDR_ONETYPE
(
ty³
èty³ *
__»¡riù
 
__
##ty³##__;

	)

79 uniÚ { 
	m__SOCKADDR_ALLTYPES


80 } 
	t__SOCKADDR_ARG
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

81 #undeà
__SOCKADDR_ONETYPE


82 
	#__SOCKADDR_ONETYPE
(
ty³
ècÚ¡ ty³ *
__»¡riù
 
__
##ty³##__;

	)

83 uniÚ { 
	m__SOCKADDR_ALLTYPES


84 } 
	t__CONST_SOCKADDR_ARG
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

85 #undeà
__SOCKADDR_ONETYPE


88 #ifdeà
__USE_GNU


90 
	smmsghdr


92 
msghdr
 
	mmsg_hdr
;

93 
	mmsg_Ën
;

102 
	$sock‘
 (
__domaš
, 
__ty³
, 
__´ÙocŞ
è
__THROW
;

108 
	$sock‘·œ
 (
__domaš
, 
__ty³
, 
__´ÙocŞ
,

109 
__fds
[2]è
__THROW
;

112 
	$bšd
 (
__fd
, 
__CONST_SOCKADDR_ARG
 
__addr
, 
sockËn_t
 
__Ën
)

113 
__THROW
;

116 
	$g‘sockÇme
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

117 
sockËn_t
 *
__»¡riù
 
__Ën
è
__THROW
;

126 
	`cÚÃù
 (
__fd
, 
__CONST_SOCKADDR_ARG
 
__addr
, 
sockËn_t
 
__Ën
);

130 
	$g‘³”Çme
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

131 
sockËn_t
 *
__»¡riù
 
__Ën
è
__THROW
;

138 
ssize_t
 
	`£nd
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
, 
__æags
);

145 
ssize_t
 
	`»cv
 (
__fd
, *
__buf
, 
size_t
 
__n
, 
__æags
);

152 
ssize_t
 
	`£ndto
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

153 
__æags
, 
__CONST_SOCKADDR_ARG
 
__addr
,

154 
sockËn_t
 
__addr_Ën
);

163 
ssize_t
 
	`»cväom
 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

164 
__æags
, 
__SOCKADDR_ARG
 
__addr
,

165 
sockËn_t
 *
__»¡riù
 
__addr_Ën
);

173 
ssize_t
 
	`£ndmsg
 (
__fd
, cÚ¡ 
msghdr
 *
__mes§ge
,

174 
__æags
);

176 #ifdeà
__USE_GNU


182 
	`£ndmmsg
 (
__fd
, 
mmsghdr
 *
__vmes§ges
,

183 
__vËn
, 
__æags
);

191 
ssize_t
 
	`»cvmsg
 (
__fd
, 
msghdr
 *
__mes§ge
, 
__æags
);

193 #ifdeà
__USE_GNU


199 
	`»cvmmsg
 (
__fd
, 
mmsghdr
 *
__vmes§ges
,

200 
__vËn
, 
__æags
,

201 
time¥ec
 *
__tmo
);

208 
	$g‘sockİt
 (
__fd
, 
__Ëv–
, 
__İŠame
,

209 *
__»¡riù
 
__İtv®
,

210 
sockËn_t
 *
__»¡riù
 
__İ’
è
__THROW
;

215 
	$£tsockİt
 (
__fd
, 
__Ëv–
, 
__İŠame
,

216 cÚ¡ *
__İtv®
, 
sockËn_t
 
__İ’
è
__THROW
;

222 
	$li¡’
 (
__fd
, 
__n
è
__THROW
;

232 
	`acû±
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

233 
sockËn_t
 *
__»¡riù
 
__addr_Ën
);

235 #ifdeà
__USE_GNU


240 
	`acû±4
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

241 
sockËn_t
 *
__»¡riù
 
__addr_Ën
, 
__æags
);

250 
	$shutdown
 (
__fd
, 
__how
è
__THROW
;

253 #ifdeà
__USE_XOPEN2K


255 
	$sock©m¬k
 (
__fd
è
__THROW
;

259 #ifdeà
__USE_MISC


263 
	$isfdty³
 (
__fd
, 
__fdty³
è
__THROW
;

268 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


269 
	~<b™s/sock‘2.h
>

272 
__END_DECLS


	@/usr/include/asm/byteorder.h

2 #iâdeà
_ASM_X86_BYTEORDER_H


3 
	#_ASM_X86_BYTEORDER_H


	)

5 
	~<lšux/by‹Üd”/l™e_’dŸn.h
>

	@/usr/include/asm/errno.h

1 
	~<asm-g’”ic/”ºo.h
>

	@/usr/include/asm/poll.h

1 
	~<asm-g’”ic/pŞl.h
>

	@/usr/include/asm/types.h

2 #iâdeà
_ASM_X86_TYPES_H


3 
	#_ASM_X86_TYPES_H


	)

5 
	~<asm-g’”ic/ty³s.h
>

	@/usr/include/bits/socket.h

19 #iâdeà
__BITS_SOCKET_H


20 
	#__BITS_SOCKET_H


	)

22 #iâdeà
_SYS_SOCKET_H


26 
	#__Ãed_size_t


	)

27 
	~<¡ddef.h
>

29 
	~<sys/ty³s.h
>

32 #iâdeà
__sockËn_t_defšed


33 
__sockËn_t
 
	tsockËn_t
;

34 
	#__sockËn_t_defšed


	)

38 
	~<b™s/sock‘_ty³.h
>

41 
	#PF_UNSPEC
 0

	)

42 
	#PF_LOCAL
 1

	)

43 
	#PF_UNIX
 
PF_LOCAL


	)

44 
	#PF_FILE
 
PF_LOCAL


	)

45 
	#PF_INET
 2

	)

46 
	#PF_AX25
 3

	)

47 
	#PF_IPX
 4

	)

48 
	#PF_APPLETALK
 5

	)

49 
	#PF_NETROM
 6

	)

50 
	#PF_BRIDGE
 7

	)

51 
	#PF_ATMPVC
 8

	)

52 
	#PF_X25
 9

	)

53 
	#PF_INET6
 10

	)

54 
	#PF_ROSE
 11

	)

55 
	#PF_DECÃt
 12

	)

56 
	#PF_NETBEUI
 13

	)

57 
	#PF_SECURITY
 14

	)

58 
	#PF_KEY
 15

	)

59 
	#PF_NETLINK
 16

	)

60 
	#PF_ROUTE
 
PF_NETLINK


	)

61 
	#PF_PACKET
 17

	)

62 
	#PF_ASH
 18

	)

63 
	#PF_ECONET
 19

	)

64 
	#PF_ATMSVC
 20

	)

65 
	#PF_RDS
 21

	)

66 
	#PF_SNA
 22

	)

67 
	#PF_IRDA
 23

	)

68 
	#PF_PPPOX
 24

	)

69 
	#PF_WANPIPE
 25

	)

70 
	#PF_LLC
 26

	)

71 
	#PF_IB
 27

	)

72 
	#PF_MPLS
 28

	)

73 
	#PF_CAN
 29

	)

74 
	#PF_TIPC
 30

	)

75 
	#PF_BLUETOOTH
 31

	)

76 
	#PF_IUCV
 32

	)

77 
	#PF_RXRPC
 33

	)

78 
	#PF_ISDN
 34

	)

79 
	#PF_PHONET
 35

	)

80 
	#PF_IEEE802154
 36

	)

81 
	#PF_CAIF
 37

	)

82 
	#PF_ALG
 38

	)

83 
	#PF_NFC
 39

	)

84 
	#PF_VSOCK
 40

	)

85 
	#PF_KCM
 41

	)

86 
	#PF_QIPCRTR
 42

	)

87 
	#PF_SMC
 43

	)

88 
	#PF_MAX
 44

	)

91 
	#AF_UNSPEC
 
PF_UNSPEC


	)

92 
	#AF_LOCAL
 
PF_LOCAL


	)

93 
	#AF_UNIX
 
PF_UNIX


	)

94 
	#AF_FILE
 
PF_FILE


	)

95 
	#AF_INET
 
PF_INET


	)

96 
	#AF_AX25
 
PF_AX25


	)

97 
	#AF_IPX
 
PF_IPX


	)

98 
	#AF_APPLETALK
 
PF_APPLETALK


	)

99 
	#AF_NETROM
 
PF_NETROM


	)

100 
	#AF_BRIDGE
 
PF_BRIDGE


	)

101 
	#AF_ATMPVC
 
PF_ATMPVC


	)

102 
	#AF_X25
 
PF_X25


	)

103 
	#AF_INET6
 
PF_INET6


	)

104 
	#AF_ROSE
 
PF_ROSE


	)

105 
	#AF_DECÃt
 
PF_DECÃt


	)

106 
	#AF_NETBEUI
 
PF_NETBEUI


	)

107 
	#AF_SECURITY
 
PF_SECURITY


	)

108 
	#AF_KEY
 
PF_KEY


	)

109 
	#AF_NETLINK
 
PF_NETLINK


	)

110 
	#AF_ROUTE
 
PF_ROUTE


	)

111 
	#AF_PACKET
 
PF_PACKET


	)

112 
	#AF_ASH
 
PF_ASH


	)

113 
	#AF_ECONET
 
PF_ECONET


	)

114 
	#AF_ATMSVC
 
PF_ATMSVC


	)

115 
	#AF_RDS
 
PF_RDS


	)

116 
	#AF_SNA
 
PF_SNA


	)

117 
	#AF_IRDA
 
PF_IRDA


	)

118 
	#AF_PPPOX
 
PF_PPPOX


	)

119 
	#AF_WANPIPE
 
PF_WANPIPE


	)

120 
	#AF_LLC
 
PF_LLC


	)

121 
	#AF_IB
 
PF_IB


	)

122 
	#AF_MPLS
 
PF_MPLS


	)

123 
	#AF_CAN
 
PF_CAN


	)

124 
	#AF_TIPC
 
PF_TIPC


	)

125 
	#AF_BLUETOOTH
 
PF_BLUETOOTH


	)

126 
	#AF_IUCV
 
PF_IUCV


	)

127 
	#AF_RXRPC
 
PF_RXRPC


	)

128 
	#AF_ISDN
 
PF_ISDN


	)

129 
	#AF_PHONET
 
PF_PHONET


	)

130 
	#AF_IEEE802154
 
PF_IEEE802154


	)

131 
	#AF_CAIF
 
PF_CAIF


	)

132 
	#AF_ALG
 
PF_ALG


	)

133 
	#AF_NFC
 
PF_NFC


	)

134 
	#AF_VSOCK
 
PF_VSOCK


	)

135 
	#AF_KCM
 
PF_KCM


	)

136 
	#AF_QIPCRTR
 
PF_QIPCRTR


	)

137 
	#AF_SMC
 
PF_SMC


	)

138 
	#AF_MAX
 
PF_MAX


	)

144 
	#SOL_RAW
 255

	)

145 
	#SOL_DECNET
 261

	)

146 
	#SOL_X25
 262

	)

147 
	#SOL_PACKET
 263

	)

148 
	#SOL_ATM
 264

	)

149 
	#SOL_AAL
 265

	)

150 
	#SOL_IRDA
 266

	)

151 
	#SOL_NETBEUI
 267

	)

152 
	#SOL_LLC
 268

	)

153 
	#SOL_DCCP
 269

	)

154 
	#SOL_NETLINK
 270

	)

155 
	#SOL_TIPC
 271

	)

156 
	#SOL_RXRPC
 272

	)

157 
	#SOL_PPPOL2TP
 273

	)

158 
	#SOL_BLUETOOTH
 274

	)

159 
	#SOL_PNPIPE
 275

	)

160 
	#SOL_RDS
 276

	)

161 
	#SOL_IUCV
 277

	)

162 
	#SOL_CAIF
 278

	)

163 
	#SOL_ALG
 279

	)

164 
	#SOL_NFC
 280

	)

165 
	#SOL_KCM
 281

	)

166 
	#SOL_TLS
 282

	)

169 
	#SOMAXCONN
 128

	)

172 
	~<b™s/sockaddr.h
>

175 
	ssockaddr


177 
__SOCKADDR_COMMON
 (
§_
);

178 
	m§_d©a
[14];

184 
	#__ss_®igÁy³
 

	)

185 
	#_SS_PADSIZE
 \

186 (
_SS_SIZE
 - 
__SOCKADDR_COMMON_SIZE
 -  (
__ss_®igÁy³
))

	)

188 
	ssockaddr_¡Üage


190 
__SOCKADDR_COMMON
 (
ss_
);

191 
	m__ss_·ddšg
[
_SS_PADSIZE
];

192 
__ss_®igÁy³
 
	m__ss_®ign
;

199 
	mMSG_OOB
 = 0x01,

200 
	#MSG_OOB
 
MSG_OOB


	)

201 
	mMSG_PEEK
 = 0x02,

202 
	#MSG_PEEK
 
MSG_PEEK


	)

203 
	mMSG_DONTROUTE
 = 0x04,

204 
	#MSG_DONTROUTE
 
MSG_DONTROUTE


	)

205 #ifdeà
__USE_GNU


207 
	mMSG_TRYHARD
 = 
MSG_DONTROUTE
,

208 
	#MSG_TRYHARD
 
MSG_DONTROUTE


	)

210 
	mMSG_CTRUNC
 = 0x08,

211 
	#MSG_CTRUNC
 
MSG_CTRUNC


	)

212 
	mMSG_PROXY
 = 0x10,

213 
	#MSG_PROXY
 
MSG_PROXY


	)

214 
	mMSG_TRUNC
 = 0x20,

215 
	#MSG_TRUNC
 
MSG_TRUNC


	)

216 
	mMSG_DONTWAIT
 = 0x40,

217 
	#MSG_DONTWAIT
 
MSG_DONTWAIT


	)

218 
	mMSG_EOR
 = 0x80,

219 
	#MSG_EOR
 
MSG_EOR


	)

220 
	mMSG_WAITALL
 = 0x100,

221 
	#MSG_WAITALL
 
MSG_WAITALL


	)

222 
	mMSG_FIN
 = 0x200,

223 
	#MSG_FIN
 
MSG_FIN


	)

224 
	mMSG_SYN
 = 0x400,

225 
	#MSG_SYN
 
MSG_SYN


	)

226 
	mMSG_CONFIRM
 = 0x800,

227 
	#MSG_CONFIRM
 
MSG_CONFIRM


	)

228 
	mMSG_RST
 = 0x1000,

229 
	#MSG_RST
 
MSG_RST


	)

230 
	mMSG_ERRQUEUE
 = 0x2000,

231 
	#MSG_ERRQUEUE
 
MSG_ERRQUEUE


	)

232 
	mMSG_NOSIGNAL
 = 0x4000,

233 
	#MSG_NOSIGNAL
 
MSG_NOSIGNAL


	)

234 
	mMSG_MORE
 = 0x8000,

235 
	#MSG_MORE
 
MSG_MORE


	)

236 
	mMSG_WAITFORONE
 = 0x10000,

237 
	#MSG_WAITFORONE
 
MSG_WAITFORONE


	)

238 
	mMSG_BATCH
 = 0x40000,

239 
	#MSG_BATCH
 
MSG_BATCH


	)

240 
	mMSG_ZEROCOPY
 = 0x4000000,

241 
	#MSG_ZEROCOPY
 
MSG_ZEROCOPY


	)

242 
	mMSG_FASTOPEN
 = 0x20000000,

243 
	#MSG_FASTOPEN
 
MSG_FASTOPEN


	)

245 
	mMSG_CMSG_CLOEXEC
 = 0x40000000

248 
	#MSG_CMSG_CLOEXEC
 
MSG_CMSG_CLOEXEC


	)

254 
	smsghdr


256 *
	mmsg_Çme
;

257 
sockËn_t
 
	mmsg_Çm–’
;

259 
iovec
 *
	mmsg_iov
;

260 
size_t
 
	mmsg_iovËn
;

262 *
	mmsg_cÚŒŞ
;

263 
size_t
 
	mmsg_cÚŒŞËn
;

268 
	mmsg_æags
;

272 
	scmsghdr


274 
size_t
 
	mcmsg_Ën
;

279 
	mcmsg_Ëv–
;

280 
	mcmsg_ty³
;

281 #ià
__glibc_c99_æex¬r_avaabË


282 
__ex‹nsiÚ__
 
__cmsg_d©a
 
	m__æex¬r
;

287 #ià
__glibc_c99_æex¬r_avaabË


288 
	#CMSG_DATA
(
cmsg
è((cmsg)->
__cmsg_d©a
)

	)

290 
	#CMSG_DATA
(
cmsg
è((*è((
cmsghdr
 *è(cmsgè+ 1))

	)

292 
	#CMSG_NXTHDR
(
mhdr
, 
cmsg
è
	`__cmsg_nxthdr
 (mhdr, cmsg)

	)

293 
	#CMSG_FIRSTHDR
(
mhdr
) \

294 ((
size_t
è(
mhdr
)->
msg_cÚŒŞËn
 >ğ (
cmsghdr
) \

295 ? (
cmsghdr
 *è(
mhdr
)->
msg_cÚŒŞ
 : (cmsghd¸*è0)

	)

296 
	#CMSG_ALIGN
(
Ën
è((Ö’è+  (
size_t
) - 1) \

297 & (
size_t
è~( (size_tè- 1))

	)

298 
	#CMSG_SPACE
(
Ën
è(
	`CMSG_ALIGN
 (len) \

299 + 
	`CMSG_ALIGN
 ( (
cmsghdr
)))

	)

300 
	#CMSG_LEN
(
Ën
è(
	`CMSG_ALIGN
 ( (
cmsghdr
)è+ (Ën))

	)

302 
cmsghdr
 *
	$__cmsg_nxthdr
 (
msghdr
 *
__mhdr
,

303 
cmsghdr
 *
__cmsg
è
__THROW
;

304 #ifdeà
__USE_EXTERN_INLINES


305 #iâdeà
_EXTERN_INLINE


306 
	#_EXTERN_INLINE
 
__ex‹º_šlše


	)

308 
_EXTERN_INLINE
 
cmsghdr
 *

309 
	`__NTH
 (
	$__cmsg_nxthdr
 (
msghdr
 *
__mhdr
, 
cmsghdr
 *
__cmsg
))

311 ià((
size_t
è
__cmsg
->
cmsg_Ën
 <  (
cmsghdr
))

313  (
cmsghdr
 *) 0;

315 
__cmsg
 = (
cmsghdr
 *) ((*) __cmsg

316 + 
	`CMSG_ALIGN
 (
__cmsg
->
cmsg_Ën
));

317 ià((*è(
__cmsg
 + 1è> ((*è
__mhdr
->
msg_cÚŒŞ


318 + 
__mhdr
->
msg_cÚŒŞËn
)

319 || ((*è
__cmsg
 + 
	`CMSG_ALIGN
 (__cmsg->
cmsg_Ën
)

320 > ((*è
__mhdr
->
msg_cÚŒŞ
 + __mhdr->
msg_cÚŒŞËn
)))

322  (
cmsghdr
 *) 0;

323  
__cmsg
;

324 
	}
}

331 
	mSCM_RIGHTS
 = 0x01

332 
	#SCM_RIGHTS
 
SCM_RIGHTS


	)

333 #ifdeà
__USE_GNU


334 , 
	mSCM_CREDENTIALS
 = 0x02

335 
	#SCM_CREDENTIALS
 
SCM_CREDENTIALS


	)

339 #ifdeà
__USE_GNU


341 
	suüed


343 
pid_t
 
	mpid
;

344 
uid_t
 
	muid
;

345 
gid_t
 
	mgid
;

350 #iâdeà
__USE_MISC


351 #iâdeà
FIOGETOWN


352 
	#__SYS_SOCKET_H_undef_FIOGETOWN


	)

354 #iâdeà
FIOSETOWN


355 
	#__SYS_SOCKET_H_undef_FIOSETOWN


	)

357 #iâdeà
SIOCATMARK


358 
	#__SYS_SOCKET_H_undef_SIOCATMARK


	)

360 #iâdeà
SIOCGPGRP


361 
	#__SYS_SOCKET_H_undef_SIOCGPGRP


	)

363 #iâdeà
SIOCGSTAMP


364 
	#__SYS_SOCKET_H_undef_SIOCGSTAMP


	)

366 #iâdeà
SIOCGSTAMPNS


367 
	#__SYS_SOCKET_H_undef_SIOCGSTAMPNS


	)

369 #iâdeà
SIOCSPGRP


370 
	#__SYS_SOCKET_H_undef_SIOCSPGRP


	)

373 #iâdeà
IOCSIZE_MASK


374 
	#__SYS_SOCKET_H_undef_IOCSIZE_MASK


	)

376 #iâdeà
IOCSIZE_SHIFT


377 
	#__SYS_SOCKET_H_undef_IOCSIZE_SHIFT


	)

379 #iâdeà
IOC_IN


380 
	#__SYS_SOCKET_H_undef_IOC_IN


	)

382 #iâdeà
IOC_INOUT


383 
	#__SYS_SOCKET_H_undef_IOC_INOUT


	)

385 #iâdeà
IOC_OUT


386 
	#__SYS_SOCKET_H_undef_IOC_OUT


	)

390 
	~<asm/sock‘.h
>

392 #iâdeà
__USE_MISC


393 #ifdeà
__SYS_SOCKET_H_undef_FIOGETOWN


394 #undeà
__SYS_SOCKET_H_undef_FIOGETOWN


395 #undeà
FIOGETOWN


397 #ifdeà
__SYS_SOCKET_H_undef_FIOSETOWN


398 #undeà
__SYS_SOCKET_H_undef_FIOSETOWN


399 #undeà
FIOSETOWN


401 #ifdeà
__SYS_SOCKET_H_undef_SIOCATMARK


402 #undeà
__SYS_SOCKET_H_undef_SIOCATMARK


403 #undeà
SIOCATMARK


405 #ifdeà
__SYS_SOCKET_H_undef_SIOCGPGRP


406 #undeà
__SYS_SOCKET_H_undef_SIOCGPGRP


407 #undeà
SIOCGPGRP


409 #ifdeà
__SYS_SOCKET_H_undef_SIOCGSTAMP


410 #undeà
__SYS_SOCKET_H_undef_SIOCGSTAMP


411 #undeà
SIOCGSTAMP


413 #ifdeà
__SYS_SOCKET_H_undef_SIOCGSTAMPNS


414 #undeà
__SYS_SOCKET_H_undef_SIOCGSTAMPNS


415 #undeà
SIOCGSTAMPNS


417 #ifdeà
__SYS_SOCKET_H_undef_SIOCSPGRP


418 #undeà
__SYS_SOCKET_H_undef_SIOCSPGRP


419 #undeà
SIOCSPGRP


422 #ifdeà
__SYS_SOCKET_H_undef_IOCSIZE_MASK


423 #undeà
__SYS_SOCKET_H_undef_IOCSIZE_MASK


424 #undeà
IOCSIZE_MASK


426 #ifdeà
__SYS_SOCKET_H_undef_IOCSIZE_SHIFT


427 #undeà
__SYS_SOCKET_H_undef_IOCSIZE_SHIFT


428 #undeà
IOCSIZE_SHIFT


430 #ifdeà
__SYS_SOCKET_H_undef_IOC_IN


431 #undeà
__SYS_SOCKET_H_undef_IOC_IN


432 #undeà
IOC_IN


434 #ifdeà
__SYS_SOCKET_H_undef_IOC_INOUT


435 #undeà
__SYS_SOCKET_H_undef_IOC_INOUT


436 #undeà
IOC_INOUT


438 #ifdeà
__SYS_SOCKET_H_undef_IOC_OUT


439 #undeà
__SYS_SOCKET_H_undef_IOC_OUT


440 #undeà
IOC_OUT


444 
	slšg”


446 
	ml_Úoff
;

447 
	ml_lšg”
;

	@/usr/include/bits/socket2.h

19 #iâdeà
_SYS_SOCKET_H


23 
ssize_t
 
__»cv_chk
 (
__fd
, *
__buf
, 
size_t
 
__n
, size_ˆ
__buæ’
,

24 
__æags
);

25 
ssize_t
 
__REDIRECT
 (
__»cv_®Ÿs
, (
__fd
, *
__buf
, 
size_t
 
__n
,

26 
__æags
), 
»cv
);

27 
ssize_t
 
__REDIRECT
 (
__»cv_chk_w¬n
,

28 (
__fd
, *
__buf
, 
size_t
 
__n
, size_ˆ
__buæ’
,

29 
__æags
), 
__»cv_chk
)

30 
__w¬Ç‰r
 ("recv called with bigger†engthhan size of destination "

33 
__fÜtify_funùiÚ
 
ssize_t


34 
	$»cv
 (
__fd
, *
__buf
, 
size_t
 
__n
, 
__æags
)

36 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

38 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

39  
	`__»cv_chk
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
);

41 ià(
__n
 > 
	`__bos0
 (
__buf
))

42  
	`__»cv_chk_w¬n
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
);

44  
	`__»cv_®Ÿs
 (
__fd
, 
__buf
, 
__n
, 
__æags
);

45 
	}
}

47 
ssize_t
 
__»cväom_chk
 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

48 
size_t
 
__buæ’
, 
__æags
,

49 
__SOCKADDR_ARG
 
__addr
,

50 
sockËn_t
 *
__»¡riù
 
__addr_Ën
);

51 
ssize_t
 
__REDIRECT
 (
__»cväom_®Ÿs
,

52 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

53 
__æags
, 
__SOCKADDR_ARG
 
__addr
,

54 
sockËn_t
 *
__»¡riù
 
__addr_Ën
), 
»cväom
);

55 
ssize_t
 
__REDIRECT
 (
__»cväom_chk_w¬n
,

56 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

57 
size_t
 
__buæ’
, 
__æags
,

58 
__SOCKADDR_ARG
 
__addr
,

59 
sockËn_t
 *
__»¡riù
 
__addr_Ën
), 
__»cväom_chk
)

60 
__w¬Ç‰r
 ("recvfrom called with bigger†engthhan size of "

63 
__fÜtify_funùiÚ
 
ssize_t


64 
	$»cväom
 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
, 
__æags
,

65 
__SOCKADDR_ARG
 
__addr
, 
sockËn_t
 *
__»¡riù
 
__addr_Ën
)

67 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

69 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

70  
	`__»cväom_chk
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
,

71 
__addr
, 
__addr_Ën
);

72 ià(
__n
 > 
	`__bos0
 (
__buf
))

73  
	`__»cväom_chk_w¬n
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
,

74 
__addr
, 
__addr_Ën
);

76  
	`__»cväom_®Ÿs
 (
__fd
, 
__buf
, 
__n
, 
__æags
, 
__addr
, 
__addr_Ën
);

77 
	}
}

	@/usr/include/bits/types/struct_iovec.h

19 #iâdeà
__iovec_defšed


20 
	#__iovec_defšed
 1

	)

22 
	#__Ãed_size_t


	)

23 
	~<¡ddef.h
>

26 
	siovec


28 *
	miov_ba£
;

29 
size_t
 
	miov_Ën
;

	@/usr/include/bits/types/struct_osockaddr.h

1 #iâdeà
__osockaddr_defšed


2 
	#__osockaddr_defšed
 1

	)

6 
	sosockaddr


8 
	m§_çmy
;

9 
	m§_d©a
[14];

	@/usr/include/features.h

18 #iâdef 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

119 #undeà
__USE_ISOC11


120 #undeà
__USE_ISOC99


121 #undeà
__USE_ISOC95


122 #undeà
__USE_ISOCXX11


123 #undeà
__USE_POSIX


124 #undeà
__USE_POSIX2


125 #undeà
__USE_POSIX199309


126 #undeà
__USE_POSIX199506


127 #undeà
__USE_XOPEN


128 #undeà
__USE_XOPEN_EXTENDED


129 #undeà
__USE_UNIX98


130 #undeà
__USE_XOPEN2K


131 #undeà
__USE_XOPEN2KXSI


132 #undeà
__USE_XOPEN2K8


133 #undeà
__USE_XOPEN2K8XSI


134 #undeà
__USE_LARGEFILE


135 #undeà
__USE_LARGEFILE64


136 #undeà
__USE_FILE_OFFSET64


137 #undeà
__USE_MISC


138 #undeà
__USE_ATFILE


139 #undeà
__USE_GNU


140 #undeà
__USE_FORTIFY_LEVEL


141 #undeà
__KERNEL_STRICT_NAMES


142 #undeà
__GLIBC_USE_DEPRECATED_GETS


146 #iâdeà
_LOOSE_KERNEL_NAMES


147 
	#__KERNEL_STRICT_NAMES


	)

157 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


158 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

159 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

161 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

168 #ià
defšed
 
__şªg_majÜ__
 && defšed 
__şªg_mšÜ__


169 
	#__glibc_şªg_´”eq
(
maj
, 
mš
) \

170 ((
__şªg_majÜ__
 << 16è+ 
__şªg_mšÜ__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

172 
	#__glibc_şªg_´”eq
(
maj
, 
mš
è0

	)

176 
	#__GLIBC_USE
(
F
è
__GLIBC_USE_
 ## 
	)
F

182 #ià(
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE
) \

183 && !
defšed
 
	g_DEFAULT_SOURCE


185 #undeà
_DEFAULT_SOURCE


186 
	#_DEFAULT_SOURCE
 1

	)

190 #ifdeà
_GNU_SOURCE


191 #undeà
_ISOC95_SOURCE


192 
	#_ISOC95_SOURCE
 1

	)

193 #undeà
_ISOC99_SOURCE


194 
	#_ISOC99_SOURCE
 1

	)

195 #undeà
_ISOC11_SOURCE


196 
	#_ISOC11_SOURCE
 1

	)

197 #undeà
_POSIX_SOURCE


198 
	#_POSIX_SOURCE
 1

	)

199 #undeà
_POSIX_C_SOURCE


200 
	#_POSIX_C_SOURCE
 200809L

	)

201 #undeà
_XOPEN_SOURCE


202 
	#_XOPEN_SOURCE
 700

	)

203 #undeà
_XOPEN_SOURCE_EXTENDED


204 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

205 #undeà
_LARGEFILE64_SOURCE


206 
	#_LARGEFILE64_SOURCE
 1

	)

207 #undeà
_DEFAULT_SOURCE


208 
	#_DEFAULT_SOURCE
 1

	)

209 #undeà
_ATFILE_SOURCE


210 
	#_ATFILE_SOURCE
 1

	)

215 #ià(
defšed
 
_DEFAULT_SOURCE
 \

216 || (!
defšed
 
	g__STRICT_ANSI__
 \

217 && !
defšed
 
	g_ISOC99_SOURCE
 \

218 && !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 \

219 && !
defšed
 
	g_XOPEN_SOURCE
))

220 #undeà
_DEFAULT_SOURCE


221 
	#_DEFAULT_SOURCE
 1

	)

225 #ià(
defšed
 
_ISOC11_SOURCE
 \

226 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

227 
	#__USE_ISOC11
 1

	)

231 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

232 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

233 
	#__USE_ISOC99
 1

	)

237 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

238 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

239 
	#__USE_ISOC95
 1

	)

242 #ifdeà
__ılu¥lus


244 #ià
__ılu¥lus
 >= 201703L

245 
	#__USE_ISOC11
 1

	)

249 #ià
__ılu¥lus
 >ğ201103L || 
defšed
 
__GXX_EXPERIMENTAL_CXX0X__


250 
	#__USE_ISOCXX11
 1

	)

251 
	#__USE_ISOC99
 1

	)

258 #ifdeà
_DEFAULT_SOURCE


259 #ià!
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE


260 
	#__USE_POSIX_IMPLICITLY
 1

	)

262 #undeà
_POSIX_SOURCE


263 
	#_POSIX_SOURCE
 1

	)

264 #undeà
_POSIX_C_SOURCE


265 
	#_POSIX_C_SOURCE
 200809L

	)

268 #ià((!
defšed
 
__STRICT_ANSI__
 \

269 || (
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

270 && !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

271 
	#_POSIX_SOURCE
 1

	)

272 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

273 
	#_POSIX_C_SOURCE
 2

	)

274 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

275 
	#_POSIX_C_SOURCE
 199506L

	)

276 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

277 
	#_POSIX_C_SOURCE
 200112L

	)

279 
	#_POSIX_C_SOURCE
 200809L

	)

281 
	#__USE_POSIX_IMPLICITLY
 1

	)

290 #ià((!
defšed
 
_POSIX_C_SOURCE
 || (_POSIX_C_SOURCE - 0) < 199506L) \

291 && (
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE
))

292 
	#_POSIX_SOURCE
 1

	)

293 #undeà
_POSIX_C_SOURCE


294 
	#_POSIX_C_SOURCE
 199506L

	)

297 #ià(
defšed
 
_POSIX_SOURCE
 \

298 || (
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

299 || 
defšed
 
_XOPEN_SOURCE
)

300 
	#__USE_POSIX
 1

	)

303 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


304 
	#__USE_POSIX2
 1

	)

307 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

308 
	#__USE_POSIX199309
 1

	)

311 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

312 
	#__USE_POSIX199506
 1

	)

315 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

316 
	#__USE_XOPEN2K
 1

	)

317 #undeà
__USE_ISOC95


318 
	#__USE_ISOC95
 1

	)

319 #undeà
__USE_ISOC99


320 
	#__USE_ISOC99
 1

	)

323 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

324 
	#__USE_XOPEN2K8
 1

	)

325 #undeà
_ATFILE_SOURCE


326 
	#_ATFILE_SOURCE
 1

	)

329 #ifdef 
_XOPEN_SOURCE


330 
	#__USE_XOPEN
 1

	)

331 #ià(
_XOPEN_SOURCE
 - 0) >= 500

332 
	#__USE_XOPEN_EXTENDED
 1

	)

333 
	#__USE_UNIX98
 1

	)

334 #undeà
_LARGEFILE_SOURCE


335 
	#_LARGEFILE_SOURCE
 1

	)

336 #ià(
_XOPEN_SOURCE
 - 0) >= 600

337 #ià(
_XOPEN_SOURCE
 - 0) >= 700

338 
	#__USE_XOPEN2K8
 1

	)

339 
	#__USE_XOPEN2K8XSI
 1

	)

341 
	#__USE_XOPEN2K
 1

	)

342 
	#__USE_XOPEN2KXSI
 1

	)

343 #undeà
__USE_ISOC95


344 
	#__USE_ISOC95
 1

	)

345 #undeà
__USE_ISOC99


346 
	#__USE_ISOC99
 1

	)

349 #ifdeà
_XOPEN_SOURCE_EXTENDED


350 
	#__USE_XOPEN_EXTENDED
 1

	)

355 #ifdeà
_LARGEFILE_SOURCE


356 
	#__USE_LARGEFILE
 1

	)

359 #ifdeà
_LARGEFILE64_SOURCE


360 
	#__USE_LARGEFILE64
 1

	)

363 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

364 
	#__USE_FILE_OFFSET64
 1

	)

367 #ià
defšed
 
_DEFAULT_SOURCE


368 
	#__USE_MISC
 1

	)

371 #ifdef 
_ATFILE_SOURCE


372 
	#__USE_ATFILE
 1

	)

375 #ifdef 
_GNU_SOURCE


376 
	#__USE_GNU
 1

	)

379 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

380 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

381 #ià
_FORTIFY_SOURCE
 > 1

382 
	#__USE_FORTIFY_LEVEL
 2

	)

384 
	#__USE_FORTIFY_LEVEL
 1

	)

387 
	#__USE_FORTIFY_LEVEL
 0

	)

394 #ià
defšed
 
__ılu¥lus
 ? __ılu¥lu >ğ201402L : defšed 
__USE_ISOC11


395 
	#__GLIBC_USE_DEPRECATED_GETS
 0

	)

397 
	#__GLIBC_USE_DEPRECATED_GETS
 1

	)

402 
	~<¡dc-´edef.h
>

410 #undeà
__GNU_LIBRARY__


411 
	#__GNU_LIBRARY__
 6

	)

415 
	#__GLIBC__
 2

	)

416 
	#__GLIBC_MINOR__
 27

	)

418 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

419 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

422 #iâdeà
__ASSEMBLER__


423 #iâdeà
_SYS_CDEFS_H


424 
	~<sys/cdefs.h
>

429 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


430 
	#__USE_LARGEFILE
 1

	)

431 
	#__USE_LARGEFILE64
 1

	)

437 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

438 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

439 && 
defšed
 
	g__ex‹º_šlše


440 
	#__USE_EXTERN_INLINES
 1

	)

448 
	~<gnu/¡ubs.h
>

	@/usr/include/linux/hdlc/ioctl.h

2 #iâdeà
__HDLC_IOCTL_H__


3 
	#__HDLC_IOCTL_H__


	)

6 
	#GENERIC_HDLC_VERSION
 4

	)

8 
	#CLOCK_DEFAULT
 0

	)

9 
	#CLOCK_EXT
 1

	)

10 
	#CLOCK_INT
 2

	)

11 
	#CLOCK_TXINT
 3

	)

12 
	#CLOCK_TXFROMRX
 4

	)

15 
	#ENCODING_DEFAULT
 0

	)

16 
	#ENCODING_NRZ
 1

	)

17 
	#ENCODING_NRZI
 2

	)

18 
	#ENCODING_FM_MARK
 3

	)

19 
	#ENCODING_FM_SPACE
 4

	)

20 
	#ENCODING_MANCHESTER
 5

	)

23 
	#PARITY_DEFAULT
 0

	)

24 
	#PARITY_NONE
 1

	)

25 
	#PARITY_CRC16_PR0
 2

	)

26 
	#PARITY_CRC16_PR1
 3

	)

27 
	#PARITY_CRC16_PR0_CCITT
 4

	)

28 
	#PARITY_CRC16_PR1_CCITT
 5

	)

29 
	#PARITY_CRC32_PR0_CCITT
 6

	)

30 
	#PARITY_CRC32_PR1_CCITT
 7

	)

32 
	#LMI_DEFAULT
 0

	)

33 
	#LMI_NONE
 1

	)

34 
	#LMI_ANSI
 2

	)

35 
	#LMI_CCITT
 3

	)

36 
	#LMI_CISCO
 4

	)

38 #iâdeà
__ASSEMBLY__


41 
	mşock_¿‹
;

42 
	mşock_ty³
;

43 
	mloİback
;

44 } 
	tsync_£rŸl_£‰šgs
;

47 
	mşock_¿‹
;

48 
	mşock_ty³
;

49 
	mloİback
;

50 
	m¦Ù_m­
;

51 } 
	t‹1_£‰šgs
;

54 
	m’codšg
;

55 
	m·r™y
;

56 } 
	t¿w_hdlc_´Ùo
;

59 
	mt391
;

60 
	mt392
;

61 
	mn391
;

62 
	mn392
;

63 
	mn393
;

64 
	mlmi
;

65 
	mdû
;

66 } 
	tä_´Ùo
;

69 
	mdlci
;

70 } 
	tä_´Ùo_pvc
;

73 
	mdlci
;

74 
	mma¡”
[
IFNAMSIZ
];

75 }
	tä_´Ùo_pvc_šfo
;

78 
	mš‹rv®
;

79 
	mtimeout
;

80 } 
	tcisco_´Ùo
;

	@/usr/include/linux/if_addr.h

2 #iâdeà
__LINUX_IF_ADDR_H


3 
	#__LINUX_IF_ADDR_H


	)

5 
	~<lšux/ty³s.h
>

6 
	~<lšux/Ãšk.h
>

8 
	siçddrmsg
 {

9 
__u8
 
	miç_çmy
;

10 
__u8
 
	miç_´efixËn
;

11 
__u8
 
	miç_æags
;

12 
__u8
 
	miç_scİe
;

13 
__u32
 
	miç_šdex
;

27 
	mIFA_UNSPEC
,

28 
	mIFA_ADDRESS
,

29 
	mIFA_LOCAL
,

30 
	mIFA_LABEL
,

31 
	mIFA_BROADCAST
,

32 
	mIFA_ANYCAST
,

33 
	mIFA_CACHEINFO
,

34 
	mIFA_MULTICAST
,

35 
	mIFA_FLAGS
,

36 
	m__IFA_MAX
,

39 
	#IFA_MAX
 (
__IFA_MAX
 - 1)

	)

42 
	#IFA_F_SECONDARY
 0x01

	)

43 
	#IFA_F_TEMPORARY
 
IFA_F_SECONDARY


	)

45 
	#IFA_F_NODAD
 0x02

	)

46 
	#IFA_F_OPTIMISTIC
 0x04

	)

47 
	#IFA_F_DADFAILED
 0x08

	)

48 
	#IFA_F_HOMEADDRESS
 0x10

	)

49 
	#IFA_F_DEPRECATED
 0x20

	)

50 
	#IFA_F_TENTATIVE
 0x40

	)

51 
	#IFA_F_PERMANENT
 0x80

	)

52 
	#IFA_F_MANAGETEMPADDR
 0x100

	)

53 
	#IFA_F_NOPREFIXROUTE
 0x200

	)

54 
	#IFA_F_MCAUTOJOIN
 0x400

	)

55 
	#IFA_F_STABLE_PRIVACY
 0x800

	)

57 
	siç_ÿchešfo
 {

58 
__u32
 
	miç_´eã»d
;

59 
__u32
 
	miç_v®id
;

60 
__u32
 
	mc¡amp
;

61 
__u32
 
	mt¡amp
;

65 
	#IFA_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
içddrmsg
))))

	)

66 
	#IFA_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
içddrmsg
))

	)

	@/usr/include/linux/if_link.h

2 #iâdeà
_LINUX_IF_LINK_H


3 
	#_LINUX_IF_LINK_H


	)

5 
	~<lšux/ty³s.h
>

6 
	~<lšux/Ãšk.h
>

9 
	s¹Æ_lšk_¡©s
 {

10 
__u32
 
	mrx_·ck‘s
;

11 
__u32
 
	mtx_·ck‘s
;

12 
__u32
 
	mrx_by‹s
;

13 
__u32
 
	mtx_by‹s
;

14 
__u32
 
	mrx_”rÜs
;

15 
__u32
 
	mtx_”rÜs
;

16 
__u32
 
	mrx_drİ³d
;

17 
__u32
 
	mtx_drİ³d
;

18 
__u32
 
	mmuÉiÿ¡
;

19 
__u32
 
	mcŞlisiÚs
;

22 
__u32
 
	mrx_Ëngth_”rÜs
;

23 
__u32
 
	mrx_ov”_”rÜs
;

24 
__u32
 
	mrx_üc_”rÜs
;

25 
__u32
 
	mrx_äame_”rÜs
;

26 
__u32
 
	mrx_fifo_”rÜs
;

27 
__u32
 
	mrx_mis£d_”rÜs
;

30 
__u32
 
	mtx_abÜ‹d_”rÜs
;

31 
__u32
 
	mtx_ÿ¼›r_”rÜs
;

32 
__u32
 
	mtx_fifo_”rÜs
;

33 
__u32
 
	mtx_h—¹b—t_”rÜs
;

34 
__u32
 
	mtx_wšdow_”rÜs
;

37 
__u32
 
	mrx_com´es£d
;

38 
__u32
 
	mtx_com´es£d
;

40 
__u32
 
	mrx_nohªdËr
;

44 
	s¹Æ_lšk_¡©s64
 {

45 
__u64
 
	mrx_·ck‘s
;

46 
__u64
 
	mtx_·ck‘s
;

47 
__u64
 
	mrx_by‹s
;

48 
__u64
 
	mtx_by‹s
;

49 
__u64
 
	mrx_”rÜs
;

50 
__u64
 
	mtx_”rÜs
;

51 
__u64
 
	mrx_drİ³d
;

52 
__u64
 
	mtx_drİ³d
;

53 
__u64
 
	mmuÉiÿ¡
;

54 
__u64
 
	mcŞlisiÚs
;

57 
__u64
 
	mrx_Ëngth_”rÜs
;

58 
__u64
 
	mrx_ov”_”rÜs
;

59 
__u64
 
	mrx_üc_”rÜs
;

60 
__u64
 
	mrx_äame_”rÜs
;

61 
__u64
 
	mrx_fifo_”rÜs
;

62 
__u64
 
	mrx_mis£d_”rÜs
;

65 
__u64
 
	mtx_abÜ‹d_”rÜs
;

66 
__u64
 
	mtx_ÿ¼›r_”rÜs
;

67 
__u64
 
	mtx_fifo_”rÜs
;

68 
__u64
 
	mtx_h—¹b—t_”rÜs
;

69 
__u64
 
	mtx_wšdow_”rÜs
;

72 
__u64
 
	mrx_com´es£d
;

73 
__u64
 
	mtx_com´es£d
;

75 
__u64
 
	mrx_nohªdËr
;

79 
	s¹Æ_lšk_ifm­
 {

80 
__u64
 
	mmem_¡¬t
;

81 
__u64
 
	mmem_’d
;

82 
__u64
 
	mba£_addr
;

83 
__u16
 
	mœq
;

84 
__u8
 
	mdma
;

85 
__u8
 
	mpÜt
;

107 
	mIFLA_UNSPEC
,

108 
	mIFLA_ADDRESS
,

109 
	mIFLA_BROADCAST
,

110 
	mIFLA_IFNAME
,

111 
	mIFLA_MTU
,

112 
	mIFLA_LINK
,

113 
	mIFLA_QDISC
,

114 
	mIFLA_STATS
,

115 
	mIFLA_COST
,

116 
	#IFLA_COST
 
IFLA_COST


	)

117 
	mIFLA_PRIORITY
,

118 
	#IFLA_PRIORITY
 
IFLA_PRIORITY


	)

119 
	mIFLA_MASTER
,

120 
	#IFLA_MASTER
 
IFLA_MASTER


	)

121 
	mIFLA_WIRELESS
,

122 
	#IFLA_WIRELESS
 
IFLA_WIRELESS


	)

123 
	mIFLA_PROTINFO
,

124 
	#IFLA_PROTINFO
 
IFLA_PROTINFO


	)

125 
	mIFLA_TXQLEN
,

126 
	#IFLA_TXQLEN
 
IFLA_TXQLEN


	)

127 
	mIFLA_MAP
,

128 
	#IFLA_MAP
 
IFLA_MAP


	)

129 
	mIFLA_WEIGHT
,

130 
	#IFLA_WEIGHT
 
IFLA_WEIGHT


	)

131 
	mIFLA_OPERSTATE
,

132 
	mIFLA_LINKMODE
,

133 
	mIFLA_LINKINFO
,

134 
	#IFLA_LINKINFO
 
IFLA_LINKINFO


	)

135 
	mIFLA_NET_NS_PID
,

136 
	mIFLA_IFALIAS
,

137 
	mIFLA_NUM_VF
,

138 
	mIFLA_VFINFO_LIST
,

139 
	mIFLA_STATS64
,

140 
	mIFLA_VF_PORTS
,

141 
	mIFLA_PORT_SELF
,

142 
	mIFLA_AF_SPEC
,

143 
	mIFLA_GROUP
,

144 
	mIFLA_NET_NS_FD
,

145 
	mIFLA_EXT_MASK
,

146 
	mIFLA_PROMISCUITY
,

147 
	#IFLA_PROMISCUITY
 
IFLA_PROMISCUITY


	)

148 
	mIFLA_NUM_TX_QUEUES
,

149 
	mIFLA_NUM_RX_QUEUES
,

150 
	mIFLA_CARRIER
,

151 
	mIFLA_PHYS_PORT_ID
,

152 
	mIFLA_CARRIER_CHANGES
,

153 
	mIFLA_PHYS_SWITCH_ID
,

154 
	mIFLA_LINK_NETNSID
,

155 
	mIFLA_PHYS_PORT_NAME
,

156 
	mIFLA_PROTO_DOWN
,

157 
	mIFLA_GSO_MAX_SEGS
,

158 
	mIFLA_GSO_MAX_SIZE
,

159 
	mIFLA_PAD
,

160 
	mIFLA_XDP
,

161 
	mIFLA_EVENT
,

162 
	mIFLA_NEW_NETNSID
,

163 
	mIFLA_IF_NETNSID
,

164 
	mIFLA_CARRIER_UP_COUNT
,

165 
	mIFLA_CARRIER_DOWN_COUNT
,

166 
	mIFLA_NEW_IFINDEX
,

167 
	m__IFLA_MAX


171 
	#IFLA_MAX
 (
__IFLA_MAX
 - 1)

	)

174 
	#IFLA_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
ifšfomsg
))))

	)

175 
	#IFLA_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
ifšfomsg
))

	)

178 
	mIFLA_INET_UNSPEC
,

179 
	mIFLA_INET_CONF
,

180 
	m__IFLA_INET_MAX
,

183 
	#IFLA_INET_MAX
 (
__IFLA_INET_MAX
 - 1)

	)

216 
	mIFLA_INET6_UNSPEC
,

217 
	mIFLA_INET6_FLAGS
,

218 
	mIFLA_INET6_CONF
,

219 
	mIFLA_INET6_STATS
,

220 
	mIFLA_INET6_MCAST
,

221 
	mIFLA_INET6_CACHEINFO
,

222 
	mIFLA_INET6_ICMP6STATS
,

223 
	mIFLA_INET6_TOKEN
,

224 
	mIFLA_INET6_ADDR_GEN_MODE
,

225 
	m__IFLA_INET6_MAX


228 
	#IFLA_INET6_MAX
 (
__IFLA_INET6_MAX
 - 1)

	)

230 
	eš6_addr_g’_mode
 {

231 
	mIN6_ADDR_GEN_MODE_EUI64
,

232 
	mIN6_ADDR_GEN_MODE_NONE
,

233 
	mIN6_ADDR_GEN_MODE_STABLE_PRIVACY
,

234 
	mIN6_ADDR_GEN_MODE_RANDOM
,

240 
	mIFLA_BR_UNSPEC
,

241 
	mIFLA_BR_FORWARD_DELAY
,

242 
	mIFLA_BR_HELLO_TIME
,

243 
	mIFLA_BR_MAX_AGE
,

244 
	mIFLA_BR_AGEING_TIME
,

245 
	mIFLA_BR_STP_STATE
,

246 
	mIFLA_BR_PRIORITY
,

247 
	mIFLA_BR_VLAN_FILTERING
,

248 
	mIFLA_BR_VLAN_PROTOCOL
,

249 
	mIFLA_BR_GROUP_FWD_MASK
,

250 
	mIFLA_BR_ROOT_ID
,

251 
	mIFLA_BR_BRIDGE_ID
,

252 
	mIFLA_BR_ROOT_PORT
,

253 
	mIFLA_BR_ROOT_PATH_COST
,

254 
	mIFLA_BR_TOPOLOGY_CHANGE
,

255 
	mIFLA_BR_TOPOLOGY_CHANGE_DETECTED
,

256 
	mIFLA_BR_HELLO_TIMER
,

257 
	mIFLA_BR_TCN_TIMER
,

258 
	mIFLA_BR_TOPOLOGY_CHANGE_TIMER
,

259 
	mIFLA_BR_GC_TIMER
,

260 
	mIFLA_BR_GROUP_ADDR
,

261 
	mIFLA_BR_FDB_FLUSH
,

262 
	mIFLA_BR_MCAST_ROUTER
,

263 
	mIFLA_BR_MCAST_SNOOPING
,

264 
	mIFLA_BR_MCAST_QUERY_USE_IFADDR
,

265 
	mIFLA_BR_MCAST_QUERIER
,

266 
	mIFLA_BR_MCAST_HASH_ELASTICITY
,

267 
	mIFLA_BR_MCAST_HASH_MAX
,

268 
	mIFLA_BR_MCAST_LAST_MEMBER_CNT
,

269 
	mIFLA_BR_MCAST_STARTUP_QUERY_CNT
,

270 
	mIFLA_BR_MCAST_LAST_MEMBER_INTVL
,

271 
	mIFLA_BR_MCAST_MEMBERSHIP_INTVL
,

272 
	mIFLA_BR_MCAST_QUERIER_INTVL
,

273 
	mIFLA_BR_MCAST_QUERY_INTVL
,

274 
	mIFLA_BR_MCAST_QUERY_RESPONSE_INTVL
,

275 
	mIFLA_BR_MCAST_STARTUP_QUERY_INTVL
,

276 
	mIFLA_BR_NF_CALL_IPTABLES
,

277 
	mIFLA_BR_NF_CALL_IP6TABLES
,

278 
	mIFLA_BR_NF_CALL_ARPTABLES
,

279 
	mIFLA_BR_VLAN_DEFAULT_PVID
,

280 
	mIFLA_BR_PAD
,

281 
	mIFLA_BR_VLAN_STATS_ENABLED
,

282 
	mIFLA_BR_MCAST_STATS_ENABLED
,

283 
	mIFLA_BR_MCAST_IGMP_VERSION
,

284 
	mIFLA_BR_MCAST_MLD_VERSION
,

285 
	m__IFLA_BR_MAX
,

288 
	#IFLA_BR_MAX
 (
__IFLA_BR_MAX
 - 1)

	)

290 
	siæa_bridge_id
 {

291 
__u8
 
	m´io
[2];

292 
__u8
 
	maddr
[6];

296 
	mBRIDGE_MODE_UNSPEC
,

297 
	mBRIDGE_MODE_HAIRPIN
,

301 
	mIFLA_BRPORT_UNSPEC
,

302 
	mIFLA_BRPORT_STATE
,

303 
	mIFLA_BRPORT_PRIORITY
,

304 
	mIFLA_BRPORT_COST
,

305 
	mIFLA_BRPORT_MODE
,

306 
	mIFLA_BRPORT_GUARD
,

307 
	mIFLA_BRPORT_PROTECT
,

308 
	mIFLA_BRPORT_FAST_LEAVE
,

309 
	mIFLA_BRPORT_LEARNING
,

310 
	mIFLA_BRPORT_UNICAST_FLOOD
,

311 
	mIFLA_BRPORT_PROXYARP
,

312 
	mIFLA_BRPORT_LEARNING_SYNC
,

313 
	mIFLA_BRPORT_PROXYARP_WIFI
,

314 
	mIFLA_BRPORT_ROOT_ID
,

315 
	mIFLA_BRPORT_BRIDGE_ID
,

316 
	mIFLA_BRPORT_DESIGNATED_PORT
,

317 
	mIFLA_BRPORT_DESIGNATED_COST
,

318 
	mIFLA_BRPORT_ID
,

319 
	mIFLA_BRPORT_NO
,

320 
	mIFLA_BRPORT_TOPOLOGY_CHANGE_ACK
,

321 
	mIFLA_BRPORT_CONFIG_PENDING
,

322 
	mIFLA_BRPORT_MESSAGE_AGE_TIMER
,

323 
	mIFLA_BRPORT_FORWARD_DELAY_TIMER
,

324 
	mIFLA_BRPORT_HOLD_TIMER
,

325 
	mIFLA_BRPORT_FLUSH
,

326 
	mIFLA_BRPORT_MULTICAST_ROUTER
,

327 
	mIFLA_BRPORT_PAD
,

328 
	mIFLA_BRPORT_MCAST_FLOOD
,

329 
	mIFLA_BRPORT_MCAST_TO_UCAST
,

330 
	mIFLA_BRPORT_VLAN_TUNNEL
,

331 
	mIFLA_BRPORT_BCAST_FLOOD
,

332 
	mIFLA_BRPORT_GROUP_FWD_MASK
,

333 
	mIFLA_BRPORT_NEIGH_SUPPRESS
,

334 
	m__IFLA_BRPORT_MAX


336 
	#IFLA_BRPORT_MAX
 (
__IFLA_BRPORT_MAX
 - 1)

	)

338 
	siæa_ÿchešfo
 {

339 
__u32
 
	mmax_»asm_Ën
;

340 
__u32
 
	mt¡amp
;

341 
__u32
 
	m»achabË_time
;

342 
__u32
 
	m»Œªs_time
;

346 
	mIFLA_INFO_UNSPEC
,

347 
	mIFLA_INFO_KIND
,

348 
	mIFLA_INFO_DATA
,

349 
	mIFLA_INFO_XSTATS
,

350 
	mIFLA_INFO_SLAVE_KIND
,

351 
	mIFLA_INFO_SLAVE_DATA
,

352 
	m__IFLA_INFO_MAX
,

355 
	#IFLA_INFO_MAX
 (
__IFLA_INFO_MAX
 - 1)

	)

360 
	mIFLA_VLAN_UNSPEC
,

361 
	mIFLA_VLAN_ID
,

362 
	mIFLA_VLAN_FLAGS
,

363 
	mIFLA_VLAN_EGRESS_QOS
,

364 
	mIFLA_VLAN_INGRESS_QOS
,

365 
	mIFLA_VLAN_PROTOCOL
,

366 
	m__IFLA_VLAN_MAX
,

369 
	#IFLA_VLAN_MAX
 (
__IFLA_VLAN_MAX
 - 1)

	)

371 
	siæa_vÏn_æags
 {

372 
__u32
 
	mæags
;

373 
__u32
 
	mmask
;

377 
	mIFLA_VLAN_QOS_UNSPEC
,

378 
	mIFLA_VLAN_QOS_MAPPING
,

379 
	m__IFLA_VLAN_QOS_MAX


382 
	#IFLA_VLAN_QOS_MAX
 (
__IFLA_VLAN_QOS_MAX
 - 1)

	)

384 
	siæa_vÏn_qos_m­pšg
 {

385 
__u32
 
	mäom
;

386 
__u32
 
	mto
;

391 
	mIFLA_MACVLAN_UNSPEC
,

392 
	mIFLA_MACVLAN_MODE
,

393 
	mIFLA_MACVLAN_FLAGS
,

394 
	mIFLA_MACVLAN_MACADDR_MODE
,

395 
	mIFLA_MACVLAN_MACADDR
,

396 
	mIFLA_MACVLAN_MACADDR_DATA
,

397 
	mIFLA_MACVLAN_MACADDR_COUNT
,

398 
	m__IFLA_MACVLAN_MAX
,

401 
	#IFLA_MACVLAN_MAX
 (
__IFLA_MACVLAN_MAX
 - 1)

	)

403 
	emacvÏn_mode
 {

404 
	mMACVLAN_MODE_PRIVATE
 = 1,

405 
	mMACVLAN_MODE_VEPA
 = 2,

406 
	mMACVLAN_MODE_BRIDGE
 = 4,

407 
	mMACVLAN_MODE_PASSTHRU
 = 8,

408 
	mMACVLAN_MODE_SOURCE
 = 16,

411 
	emacvÏn_maÿddr_mode
 {

412 
	mMACVLAN_MACADDR_ADD
,

413 
	mMACVLAN_MACADDR_DEL
,

414 
	mMACVLAN_MACADDR_FLUSH
,

415 
	mMACVLAN_MACADDR_SET
,

418 
	#MACVLAN_FLAG_NOPROMISC
 1

	)

422 
	mIFLA_VRF_UNSPEC
,

423 
	mIFLA_VRF_TABLE
,

424 
	m__IFLA_VRF_MAX


427 
	#IFLA_VRF_MAX
 (
__IFLA_VRF_MAX
 - 1)

	)

430 
	mIFLA_VRF_PORT_UNSPEC
,

431 
	mIFLA_VRF_PORT_TABLE
,

432 
	m__IFLA_VRF_PORT_MAX


435 
	#IFLA_VRF_PORT_MAX
 (
__IFLA_VRF_PORT_MAX
 - 1)

	)

439 
	mIFLA_MACSEC_UNSPEC
,

440 
	mIFLA_MACSEC_SCI
,

441 
	mIFLA_MACSEC_PORT
,

442 
	mIFLA_MACSEC_ICV_LEN
,

443 
	mIFLA_MACSEC_CIPHER_SUITE
,

444 
	mIFLA_MACSEC_WINDOW
,

445 
	mIFLA_MACSEC_ENCODING_SA
,

446 
	mIFLA_MACSEC_ENCRYPT
,

447 
	mIFLA_MACSEC_PROTECT
,

448 
	mIFLA_MACSEC_INC_SCI
,

449 
	mIFLA_MACSEC_ES
,

450 
	mIFLA_MACSEC_SCB
,

451 
	mIFLA_MACSEC_REPLAY_PROTECT
,

452 
	mIFLA_MACSEC_VALIDATION
,

453 
	mIFLA_MACSEC_PAD
,

454 
	m__IFLA_MACSEC_MAX
,

457 
	#IFLA_MACSEC_MAX
 (
__IFLA_MACSEC_MAX
 - 1)

	)

459 
	emac£c_v®id©iÚ_ty³
 {

460 
	mMACSEC_VALIDATE_DISABLED
 = 0,

461 
	mMACSEC_VALIDATE_CHECK
 = 1,

462 
	mMACSEC_VALIDATE_STRICT
 = 2,

463 
	m__MACSEC_VALIDATE_END
,

464 
	mMACSEC_VALIDATE_MAX
 = 
__MACSEC_VALIDATE_END
 - 1,

469 
	mIFLA_IPVLAN_UNSPEC
,

470 
	mIFLA_IPVLAN_MODE
,

471 
	mIFLA_IPVLAN_FLAGS
,

472 
	m__IFLA_IPVLAN_MAX


475 
	#IFLA_IPVLAN_MAX
 (
__IFLA_IPVLAN_MAX
 - 1)

	)

477 
	evÏn_mode
 {

478 
	mIPVLAN_MODE_L2
 = 0,

479 
	mIPVLAN_MODE_L3
,

480 
	mIPVLAN_MODE_L3S
,

481 
	mIPVLAN_MODE_MAX


484 
	#IPVLAN_F_PRIVATE
 0x01

	)

485 
	#IPVLAN_F_VEPA
 0x02

	)

489 
	mIFLA_VXLAN_UNSPEC
,

490 
	mIFLA_VXLAN_ID
,

491 
	mIFLA_VXLAN_GROUP
,

492 
	mIFLA_VXLAN_LINK
,

493 
	mIFLA_VXLAN_LOCAL
,

494 
	mIFLA_VXLAN_TTL
,

495 
	mIFLA_VXLAN_TOS
,

496 
	mIFLA_VXLAN_LEARNING
,

497 
	mIFLA_VXLAN_AGEING
,

498 
	mIFLA_VXLAN_LIMIT
,

499 
	mIFLA_VXLAN_PORT_RANGE
,

500 
	mIFLA_VXLAN_PROXY
,

501 
	mIFLA_VXLAN_RSC
,

502 
	mIFLA_VXLAN_L2MISS
,

503 
	mIFLA_VXLAN_L3MISS
,

504 
	mIFLA_VXLAN_PORT
,

505 
	mIFLA_VXLAN_GROUP6
,

506 
	mIFLA_VXLAN_LOCAL6
,

507 
	mIFLA_VXLAN_UDP_CSUM
,

508 
	mIFLA_VXLAN_UDP_ZERO_CSUM6_TX
,

509 
	mIFLA_VXLAN_UDP_ZERO_CSUM6_RX
,

510 
	mIFLA_VXLAN_REMCSUM_TX
,

511 
	mIFLA_VXLAN_REMCSUM_RX
,

512 
	mIFLA_VXLAN_GBP
,

513 
	mIFLA_VXLAN_REMCSUM_NOPARTIAL
,

514 
	mIFLA_VXLAN_COLLECT_METADATA
,

515 
	mIFLA_VXLAN_LABEL
,

516 
	mIFLA_VXLAN_GPE
,

517 
	mIFLA_VXLAN_FAN_MAP
 = 33,

518 
	m__IFLA_VXLAN_MAX


520 
	#IFLA_VXLAN_MAX
 (
__IFLA_VXLAN_MAX
 - 1)

	)

522 
	siæa_vxÏn_pÜt_¿nge
 {

523 
__be16
 
	mlow
;

524 
__be16
 
	mhigh
;

529 
	mIFLA_GENEVE_UNSPEC
,

530 
	mIFLA_GENEVE_ID
,

531 
	mIFLA_GENEVE_REMOTE
,

532 
	mIFLA_GENEVE_TTL
,

533 
	mIFLA_GENEVE_TOS
,

534 
	mIFLA_GENEVE_PORT
,

535 
	mIFLA_GENEVE_COLLECT_METADATA
,

536 
	mIFLA_GENEVE_REMOTE6
,

537 
	mIFLA_GENEVE_UDP_CSUM
,

538 
	mIFLA_GENEVE_UDP_ZERO_CSUM6_TX
,

539 
	mIFLA_GENEVE_UDP_ZERO_CSUM6_RX
,

540 
	mIFLA_GENEVE_LABEL
,

541 
	m__IFLA_GENEVE_MAX


543 
	#IFLA_GENEVE_MAX
 (
__IFLA_GENEVE_MAX
 - 1)

	)

547 
	mIFLA_PPP_UNSPEC
,

548 
	mIFLA_PPP_DEV_FD
,

549 
	m__IFLA_PPP_MAX


551 
	#IFLA_PPP_MAX
 (
__IFLA_PPP_MAX
 - 1)

	)

555 
	eiæa_g_rŞe
 {

556 
	mGTP_ROLE_GGSN
 = 0,

557 
	mGTP_ROLE_SGSN
,

561 
	mIFLA_GTP_UNSPEC
,

562 
	mIFLA_GTP_FD0
,

563 
	mIFLA_GTP_FD1
,

564 
	mIFLA_GTP_PDP_HASHSIZE
,

565 
	mIFLA_GTP_ROLE
,

566 
	m__IFLA_GTP_MAX
,

568 
	#IFLA_GTP_MAX
 (
__IFLA_GTP_MAX
 - 1)

	)

573 
	mIFLA_BOND_UNSPEC
,

574 
	mIFLA_BOND_MODE
,

575 
	mIFLA_BOND_ACTIVE_SLAVE
,

576 
	mIFLA_BOND_MIIMON
,

577 
	mIFLA_BOND_UPDELAY
,

578 
	mIFLA_BOND_DOWNDELAY
,

579 
	mIFLA_BOND_USE_CARRIER
,

580 
	mIFLA_BOND_ARP_INTERVAL
,

581 
	mIFLA_BOND_ARP_IP_TARGET
,

582 
	mIFLA_BOND_ARP_VALIDATE
,

583 
	mIFLA_BOND_ARP_ALL_TARGETS
,

584 
	mIFLA_BOND_PRIMARY
,

585 
	mIFLA_BOND_PRIMARY_RESELECT
,

586 
	mIFLA_BOND_FAIL_OVER_MAC
,

587 
	mIFLA_BOND_XMIT_HASH_POLICY
,

588 
	mIFLA_BOND_RESEND_IGMP
,

589 
	mIFLA_BOND_NUM_PEER_NOTIF
,

590 
	mIFLA_BOND_ALL_SLAVES_ACTIVE
,

591 
	mIFLA_BOND_MIN_LINKS
,

592 
	mIFLA_BOND_LP_INTERVAL
,

593 
	mIFLA_BOND_PACKETS_PER_SLAVE
,

594 
	mIFLA_BOND_AD_LACP_RATE
,

595 
	mIFLA_BOND_AD_SELECT
,

596 
	mIFLA_BOND_AD_INFO
,

597 
	mIFLA_BOND_AD_ACTOR_SYS_PRIO
,

598 
	mIFLA_BOND_AD_USER_PORT_KEY
,

599 
	mIFLA_BOND_AD_ACTOR_SYSTEM
,

600 
	mIFLA_BOND_TLB_DYNAMIC_LB
,

601 
	m__IFLA_BOND_MAX
,

604 
	#IFLA_BOND_MAX
 (
__IFLA_BOND_MAX
 - 1)

	)

607 
	mIFLA_BOND_AD_INFO_UNSPEC
,

608 
	mIFLA_BOND_AD_INFO_AGGREGATOR
,

609 
	mIFLA_BOND_AD_INFO_NUM_PORTS
,

610 
	mIFLA_BOND_AD_INFO_ACTOR_KEY
,

611 
	mIFLA_BOND_AD_INFO_PARTNER_KEY
,

612 
	mIFLA_BOND_AD_INFO_PARTNER_MAC
,

613 
	m__IFLA_BOND_AD_INFO_MAX
,

616 
	#IFLA_BOND_AD_INFO_MAX
 (
__IFLA_BOND_AD_INFO_MAX
 - 1)

	)

619 
	mIFLA_BOND_SLAVE_UNSPEC
,

620 
	mIFLA_BOND_SLAVE_STATE
,

621 
	mIFLA_BOND_SLAVE_MII_STATUS
,

622 
	mIFLA_BOND_SLAVE_LINK_FAILURE_COUNT
,

623 
	mIFLA_BOND_SLAVE_PERM_HWADDR
,

624 
	mIFLA_BOND_SLAVE_QUEUE_ID
,

625 
	mIFLA_BOND_SLAVE_AD_AGGREGATOR_ID
,

626 
	mIFLA_BOND_SLAVE_AD_ACTOR_OPER_PORT_STATE
,

627 
	mIFLA_BOND_SLAVE_AD_PARTNER_OPER_PORT_STATE
,

628 
	m__IFLA_BOND_SLAVE_MAX
,

631 
	#IFLA_BOND_SLAVE_MAX
 (
__IFLA_BOND_SLAVE_MAX
 - 1)

	)

636 
	mIFLA_VF_INFO_UNSPEC
,

637 
	mIFLA_VF_INFO
,

638 
	m__IFLA_VF_INFO_MAX
,

641 
	#IFLA_VF_INFO_MAX
 (
__IFLA_VF_INFO_MAX
 - 1)

	)

644 
	mIFLA_VF_UNSPEC
,

645 
	mIFLA_VF_MAC
,

646 
	mIFLA_VF_VLAN
,

647 
	mIFLA_VF_TX_RATE
,

648 
	mIFLA_VF_SPOOFCHK
,

649 
	mIFLA_VF_LINK_STATE
,

650 
	mIFLA_VF_RATE
,

651 
	mIFLA_VF_RSS_QUERY_EN
,

654 
	mIFLA_VF_STATS
,

655 
	mIFLA_VF_TRUST
,

656 
	mIFLA_VF_IB_NODE_GUID
,

657 
	mIFLA_VF_IB_PORT_GUID
,

658 
	mIFLA_VF_VLAN_LIST
,

659 
	m__IFLA_VF_MAX
,

662 
	#IFLA_VF_MAX
 (
__IFLA_VF_MAX
 - 1)

	)

664 
	siæa_vf_mac
 {

665 
__u32
 
	mvf
;

666 
__u8
 
	mmac
[32];

669 
	siæa_vf_vÏn
 {

670 
__u32
 
	mvf
;

671 
__u32
 
	mvÏn
;

672 
__u32
 
	mqos
;

676 
	mIFLA_VF_VLAN_INFO_UNSPEC
,

677 
	mIFLA_VF_VLAN_INFO
,

678 
	m__IFLA_VF_VLAN_INFO_MAX
,

681 
	#IFLA_VF_VLAN_INFO_MAX
 (
__IFLA_VF_VLAN_INFO_MAX
 - 1)

	)

682 
	#MAX_VLAN_LIST_LEN
 1

	)

684 
	siæa_vf_vÏn_šfo
 {

685 
__u32
 
	mvf
;

686 
__u32
 
	mvÏn
;

687 
__u32
 
	mqos
;

688 
__be16
 
	mvÏn_´Ùo
;

691 
	siæa_vf_tx_¿‹
 {

692 
__u32
 
	mvf
;

693 
__u32
 
	m¿‹
;

696 
	siæa_vf_¿‹
 {

697 
__u32
 
	mvf
;

698 
__u32
 
	mmš_tx_¿‹
;

699 
__u32
 
	mmax_tx_¿‹
;

702 
	siæa_vf_¥oofchk
 {

703 
__u32
 
	mvf
;

704 
__u32
 
	m£‰šg
;

707 
	siæa_vf_guid
 {

708 
__u32
 
	mvf
;

709 
__u64
 
	mguid
;

713 
	mIFLA_VF_LINK_STATE_AUTO
,

714 
	mIFLA_VF_LINK_STATE_ENABLE
,

715 
	mIFLA_VF_LINK_STATE_DISABLE
,

716 
	m__IFLA_VF_LINK_STATE_MAX
,

719 
	siæa_vf_lšk_¡©e
 {

720 
__u32
 
	mvf
;

721 
__u32
 
	mlšk_¡©e
;

724 
	siæa_vf_rss_qu”y_’
 {

725 
__u32
 
	mvf
;

726 
__u32
 
	m£‰šg
;

730 
	mIFLA_VF_STATS_RX_PACKETS
,

731 
	mIFLA_VF_STATS_TX_PACKETS
,

732 
	mIFLA_VF_STATS_RX_BYTES
,

733 
	mIFLA_VF_STATS_TX_BYTES
,

734 
	mIFLA_VF_STATS_BROADCAST
,

735 
	mIFLA_VF_STATS_MULTICAST
,

736 
	mIFLA_VF_STATS_PAD
,

737 
	m__IFLA_VF_STATS_MAX
,

740 
	#IFLA_VF_STATS_MAX
 (
__IFLA_VF_STATS_MAX
 - 1)

	)

742 
	siæa_vf_Œu¡
 {

743 
__u32
 
	mvf
;

744 
__u32
 
	m£‰šg
;

763 
	mIFLA_VF_PORT_UNSPEC
,

764 
	mIFLA_VF_PORT
,

765 
	m__IFLA_VF_PORT_MAX
,

768 
	#IFLA_VF_PORT_MAX
 (
__IFLA_VF_PORT_MAX
 - 1)

	)

771 
	mIFLA_PORT_UNSPEC
,

772 
	mIFLA_PORT_VF
,

773 
	mIFLA_PORT_PROFILE
,

774 
	mIFLA_PORT_VSI_TYPE
,

775 
	mIFLA_PORT_INSTANCE_UUID
,

776 
	mIFLA_PORT_HOST_UUID
,

777 
	mIFLA_PORT_REQUEST
,

778 
	mIFLA_PORT_RESPONSE
,

779 
	m__IFLA_PORT_MAX
,

782 
	#IFLA_PORT_MAX
 (
__IFLA_PORT_MAX
 - 1)

	)

784 
	#PORT_PROFILE_MAX
 40

	)

785 
	#PORT_UUID_MAX
 16

	)

786 
	#PORT_SELF_VF
 -1

	)

789 
	mPORT_REQUEST_PREASSOCIATE
 = 0,

790 
	mPORT_REQUEST_PREASSOCIATE_RR
,

791 
	mPORT_REQUEST_ASSOCIATE
,

792 
	mPORT_REQUEST_DISASSOCIATE
,

796 
	mPORT_VDP_RESPONSE_SUCCESS
 = 0,

797 
	mPORT_VDP_RESPONSE_INVALID_FORMAT
,

798 
	mPORT_VDP_RESPONSE_INSUFFICIENT_RESOURCES
,

799 
	mPORT_VDP_RESPONSE_UNUSED_VTID
,

800 
	mPORT_VDP_RESPONSE_VTID_VIOLATION
,

801 
	mPORT_VDP_RESPONSE_VTID_VERSION_VIOALTION
,

802 
	mPORT_VDP_RESPONSE_OUT_OF_SYNC
,

804 
	mPORT_PROFILE_RESPONSE_SUCCESS
 = 0x100,

805 
	mPORT_PROFILE_RESPONSE_INPROGRESS
,

806 
	mPORT_PROFILE_RESPONSE_INVALID
,

807 
	mPORT_PROFILE_RESPONSE_BADSTATE
,

808 
	mPORT_PROFILE_RESPONSE_INSUFFICIENT_RESOURCES
,

809 
	mPORT_PROFILE_RESPONSE_ERROR
,

812 
	siæa_pÜt_vsi
 {

813 
__u8
 
	mvsi_mgr_id
;

814 
__u8
 
	mvsi_ty³_id
[3];

815 
__u8
 
	mvsi_ty³_v”siÚ
;

816 
__u8
 
	m·d
[3];

823 
	mIFLA_IPOIB_UNSPEC
,

824 
	mIFLA_IPOIB_PKEY
,

825 
	mIFLA_IPOIB_MODE
,

826 
	mIFLA_IPOIB_UMCAST
,

827 
	m__IFLA_IPOIB_MAX


831 
	mIPOIB_MODE_DATAGRAM
 = 0,

832 
	mIPOIB_MODE_CONNECTED
 = 1,

835 
	#IFLA_IPOIB_MAX
 (
__IFLA_IPOIB_MAX
 - 1)

	)

841 
	mIFLA_HSR_UNSPEC
,

842 
	mIFLA_HSR_SLAVE1
,

843 
	mIFLA_HSR_SLAVE2
,

844 
	mIFLA_HSR_MULTICAST_SPEC
,

845 
	mIFLA_HSR_SUPERVISION_ADDR
,

846 
	mIFLA_HSR_SEQ_NR
,

847 
	mIFLA_HSR_VERSION
,

848 
	m__IFLA_HSR_MAX
,

851 
	#IFLA_HSR_MAX
 (
__IFLA_HSR_MAX
 - 1)

	)

855 
	sif_¡©s_msg
 {

856 
__u8
 
	mçmy
;

857 
__u8
 
	m·d1
;

858 
__u16
 
	m·d2
;

859 
__u32
 
	mifšdex
;

860 
__u32
 
	mf‹r_mask
;

867 
	mIFLA_STATS_UNSPEC
,

868 
	mIFLA_STATS_LINK_64
,

869 
	mIFLA_STATS_LINK_XSTATS
,

870 
	mIFLA_STATS_LINK_XSTATS_SLAVE
,

871 
	mIFLA_STATS_LINK_OFFLOAD_XSTATS
,

872 
	mIFLA_STATS_AF_SPEC
,

873 
	m__IFLA_STATS_MAX
,

876 
	#IFLA_STATS_MAX
 (
__IFLA_STATS_MAX
 - 1)

	)

878 
	#IFLA_STATS_FILTER_BIT
(
ATTR
è(1 << (ATTR - 1))

	)

886 
	mLINK_XSTATS_TYPE_UNSPEC
,

887 
	mLINK_XSTATS_TYPE_BRIDGE
,

888 
	m__LINK_XSTATS_TYPE_MAX


890 
	#LINK_XSTATS_TYPE_MAX
 (
__LINK_XSTATS_TYPE_MAX
 - 1)

	)

894 
	mIFLA_OFFLOAD_XSTATS_UNSPEC
,

895 
	mIFLA_OFFLOAD_XSTATS_CPU_HIT
,

896 
	m__IFLA_OFFLOAD_XSTATS_MAX


898 
	#IFLA_OFFLOAD_XSTATS_MAX
 (
__IFLA_OFFLOAD_XSTATS_MAX
 - 1)

	)

902 
	#XDP_FLAGS_UPDATE_IF_NOEXIST
 (1U << 0)

	)

903 
	#XDP_FLAGS_SKB_MODE
 (1U << 1)

	)

904 
	#XDP_FLAGS_DRV_MODE
 (1U << 2)

	)

905 
	#XDP_FLAGS_HW_MODE
 (1U << 3)

	)

906 
	#XDP_FLAGS_MODES
 (
XDP_FLAGS_SKB_MODE
 | \

907 
XDP_FLAGS_DRV_MODE
 | \

908 
XDP_FLAGS_HW_MODE
)

	)

909 
	#XDP_FLAGS_MASK
 (
XDP_FLAGS_UPDATE_IF_NOEXIST
 | \

910 
XDP_FLAGS_MODES
)

	)

914 
	mXDP_ATTACHED_NONE
 = 0,

915 
	mXDP_ATTACHED_DRV
,

916 
	mXDP_ATTACHED_SKB
,

917 
	mXDP_ATTACHED_HW
,

921 
	mIFLA_XDP_UNSPEC
,

922 
	mIFLA_XDP_FD
,

923 
	mIFLA_XDP_ATTACHED
,

924 
	mIFLA_XDP_FLAGS
,

925 
	mIFLA_XDP_PROG_ID
,

926 
	m__IFLA_XDP_MAX
,

929 
	#IFLA_XDP_MAX
 (
__IFLA_XDP_MAX
 - 1)

	)

932 
	mIFLA_EVENT_NONE
,

933 
	mIFLA_EVENT_REBOOT
,

934 
	mIFLA_EVENT_FEATURES
,

935 
	mIFLA_EVENT_BONDING_FAILOVER
,

936 
	mIFLA_EVENT_NOTIFY_PEERS
,

937 
	mIFLA_EVENT_IGMP_RESEND
,

938 
	mIFLA_EVENT_BONDING_OPTIONS
,

	@/usr/include/linux/if_packet.h

2 #iâdeà
__LINUX_IF_PACKET_H


3 
	#__LINUX_IF_PACKET_H


	)

5 
	~<lšux/ty³s.h
>

7 
	ssockaddr_pkt
 {

8 
	m¥kt_çmy
;

9 
	m¥kt_deviû
[14];

10 
__be16
 
	m¥kt_´ÙocŞ
;

13 
	ssockaddr_Î
 {

14 
	m¦l_çmy
;

15 
__be16
 
	m¦l_´ÙocŞ
;

16 
	m¦l_ifšdex
;

17 
	m¦l_h©y³
;

18 
	m¦l_pk‰y³
;

19 
	m¦l_h®’
;

20 
	m¦l_addr
[8];

25 
	#PACKET_HOST
 0

	)

26 
	#PACKET_BROADCAST
 1

	)

27 
	#PACKET_MULTICAST
 2

	)

28 
	#PACKET_OTHERHOST
 3

	)

29 
	#PACKET_OUTGOING
 4

	)

30 
	#PACKET_LOOPBACK
 5

	)

31 
	#PACKET_USER
 6

	)

32 
	#PACKET_KERNEL
 7

	)

34 
	#PACKET_FASTROUTE
 6

	)

38 
	#PACKET_ADD_MEMBERSHIP
 1

	)

39 
	#PACKET_DROP_MEMBERSHIP
 2

	)

40 
	#PACKET_RECV_OUTPUT
 3

	)

42 
	#PACKET_RX_RING
 5

	)

43 
	#PACKET_STATISTICS
 6

	)

44 
	#PACKET_COPY_THRESH
 7

	)

45 
	#PACKET_AUXDATA
 8

	)

46 
	#PACKET_ORIGDEV
 9

	)

47 
	#PACKET_VERSION
 10

	)

48 
	#PACKET_HDRLEN
 11

	)

49 
	#PACKET_RESERVE
 12

	)

50 
	#PACKET_TX_RING
 13

	)

51 
	#PACKET_LOSS
 14

	)

52 
	#PACKET_VNET_HDR
 15

	)

53 
	#PACKET_TX_TIMESTAMP
 16

	)

54 
	#PACKET_TIMESTAMP
 17

	)

55 
	#PACKET_FANOUT
 18

	)

56 
	#PACKET_TX_HAS_OFF
 19

	)

57 
	#PACKET_QDISC_BYPASS
 20

	)

58 
	#PACKET_ROLLOVER_STATS
 21

	)

59 
	#PACKET_FANOUT_DATA
 22

	)

61 
	#PACKET_FANOUT_HASH
 0

	)

62 
	#PACKET_FANOUT_LB
 1

	)

63 
	#PACKET_FANOUT_CPU
 2

	)

64 
	#PACKET_FANOUT_ROLLOVER
 3

	)

65 
	#PACKET_FANOUT_RND
 4

	)

66 
	#PACKET_FANOUT_QM
 5

	)

67 
	#PACKET_FANOUT_CBPF
 6

	)

68 
	#PACKET_FANOUT_EBPF
 7

	)

69 
	#PACKET_FANOUT_FLAG_ROLLOVER
 0x1000

	)

70 
	#PACKET_FANOUT_FLAG_UNIQUEID
 0x2000

	)

71 
	#PACKET_FANOUT_FLAG_DEFRAG
 0x8000

	)

73 
	sack‘_¡©s
 {

74 
	m_·ck‘s
;

75 
	m_drİs
;

78 
	sack‘_¡©s_v3
 {

79 
	m_·ck‘s
;

80 
	m_drİs
;

81 
	m_ä“ze_q_út
;

84 
	sack‘_rŞlov”_¡©s
 {

85 
__®igÃd_u64
 
	m_®l
;

86 
__®igÃd_u64
 
	m_huge
;

87 
__®igÃd_u64
 
	m_çed
;

90 
	uack‘_¡©s_u
 {

91 
ack‘_¡©s
 
	m¡©s1
;

92 
ack‘_¡©s_v3
 
	m¡©s3
;

95 
	sack‘_auxd©a
 {

96 
__u32
 
	m_¡©us
;

97 
__u32
 
	m_Ën
;

98 
__u32
 
	m_¢­Ën
;

99 
__u16
 
	m_mac
;

100 
__u16
 
	m_Ãt
;

101 
__u16
 
	m_vÏn_tci
;

102 
__u16
 
	m_vÏn_id
;

106 
	#TP_STATUS_KERNEL
 0

	)

107 
	#TP_STATUS_USER
 (1 << 0)

	)

108 
	#TP_STATUS_COPY
 (1 << 1)

	)

109 
	#TP_STATUS_LOSING
 (1 << 2)

	)

110 
	#TP_STATUS_CSUMNOTREADY
 (1 << 3)

	)

111 
	#TP_STATUS_VLAN_VALID
 (1 << 4è

	)

112 
	#TP_STATUS_BLK_TMO
 (1 << 5)

	)

113 
	#TP_STATUS_VLAN_TPID_VALID
 (1 << 6è

	)

114 
	#TP_STATUS_CSUM_VALID
 (1 << 7)

	)

117 
	#TP_STATUS_AVAILABLE
 0

	)

118 
	#TP_STATUS_SEND_REQUEST
 (1 << 0)

	)

119 
	#TP_STATUS_SENDING
 (1 << 1)

	)

120 
	#TP_STATUS_WRONG_FORMAT
 (1 << 2)

	)

123 
	#TP_STATUS_TS_SOFTWARE
 (1 << 29)

	)

124 
	#TP_STATUS_TS_SYS_HARDWARE
 (1 << 30è

	)

125 
	#TP_STATUS_TS_RAW_HARDWARE
 (1 << 31)

	)

128 
	#TP_FT_REQ_FILL_RXHASH
 0x1

	)

130 
	sack‘_hdr
 {

131 
	m_¡©us
;

132 
	m_Ën
;

133 
	m_¢­Ën
;

134 
	m_mac
;

135 
	m_Ãt
;

136 
	m_£c
;

137 
	m_u£c
;

140 
	#TPACKET_ALIGNMENT
 16

	)

141 
	#TPACKET_ALIGN
(
x
è(((x)+
TPACKET_ALIGNMENT
-1)&~(TPACKET_ALIGNMENT-1))

	)

142 
	#TPACKET_HDRLEN
 (
	`TPACKET_ALIGN
((
ack‘_hdr
)è+ (
sockaddr_Î
))

	)

144 
	sack‘2_hdr
 {

145 
__u32
 
	m_¡©us
;

146 
__u32
 
	m_Ën
;

147 
__u32
 
	m_¢­Ën
;

148 
__u16
 
	m_mac
;

149 
__u16
 
	m_Ãt
;

150 
__u32
 
	m_£c
;

151 
__u32
 
	m_n£c
;

152 
__u16
 
	m_vÏn_tci
;

153 
__u16
 
	m_vÏn_id
;

154 
__u8
 
	m_·ddšg
[4];

157 
	sack‘_hdr_v¬ŸÁ1
 {

158 
__u32
 
	m_rxhash
;

159 
__u32
 
	m_vÏn_tci
;

160 
__u16
 
	m_vÏn_id
;

161 
__u16
 
	m_·ddšg
;

164 
	sack‘3_hdr
 {

165 
__u32
 
	m_Ãxt_off£t
;

166 
__u32
 
	m_£c
;

167 
__u32
 
	m_n£c
;

168 
__u32
 
	m_¢­Ën
;

169 
__u32
 
	m_Ën
;

170 
__u32
 
	m_¡©us
;

171 
__u16
 
	m_mac
;

172 
__u16
 
	m_Ãt
;

175 
ack‘_hdr_v¬ŸÁ1
 
	mhv1
;

177 
__u8
 
	m_·ddšg
[8];

180 
	sack‘_bd_ts
 {

181 
	mts_£c
;

183 
	mts_u£c
;

184 
	mts_n£c
;

188 
	sack‘_hdr_v1
 {

189 
__u32
 
	mblock_¡©us
;

190 
__u32
 
	mnum_pkts
;

191 
__u32
 
	moff£t_to_fœ¡_pkt
;

196 
__u32
 
	mblk_Ën
;

207 
__®igÃd_u64
 
	m£q_num
;

234 
ack‘_bd_ts
 
	mts_fœ¡_pkt
, 
	mts_Ï¡_pkt
;

237 
	uack‘_bd_h—d”_u
 {

238 
ack‘_hdr_v1
 
	mbh1
;

241 
	sack‘_block_desc
 {

242 
__u32
 
	mv”siÚ
;

243 
__u32
 
	moff£t_to_´iv
;

244 
ack‘_bd_h—d”_u
 
	mhdr
;

247 
	#TPACKET2_HDRLEN
 (
	`TPACKET_ALIGN
((
ack‘2_hdr
)è+ (
sockaddr_Î
))

	)

248 
	#TPACKET3_HDRLEN
 (
	`TPACKET_ALIGN
((
ack‘3_hdr
)è+ (
sockaddr_Î
))

	)

250 
	eack‘_v”siÚs
 {

251 
	mTPACKET_V1
,

252 
	mTPACKET_V2
,

253 
	mTPACKET_V3


269 
	sack‘_»q
 {

270 
	m_block_size
;

271 
	m_block_Ä
;

272 
	m_äame_size
;

273 
	m_äame_Ä
;

276 
	sack‘_»q3
 {

277 
	m_block_size
;

278 
	m_block_Ä
;

279 
	m_äame_size
;

280 
	m_äame_Ä
;

281 
	m_»tœe_blk_tov
;

282 
	m_sizeof_´iv
;

283 
	m_ã©u»_»q_wÜd
;

286 
	uack‘_»q_u
 {

287 
ack‘_»q
 
	m»q
;

288 
ack‘_»q3
 
	m»q3
;

291 
	s·ck‘_m»q
 {

292 
	mmr_ifšdex
;

293 
	mmr_ty³
;

294 
	mmr_®’
;

295 
	mmr_add»ss
[8];

298 
	#PACKET_MR_MULTICAST
 0

	)

299 
	#PACKET_MR_PROMISC
 1

	)

300 
	#PACKET_MR_ALLMULTI
 2

	)

301 
	#PACKET_MR_UNICAST
 3

	)

	@/usr/include/linux/ioctl.h

2 #iâdeà
_LINUX_IOCTL_H


3 
	#_LINUX_IOCTL_H


	)

5 
	~<asm/ioùl.h
>

	@/usr/include/linux/libc-compat.h

49 #iâdeà
_LIBC_COMPAT_H


50 
	#_LIBC_COMPAT_H


	)

53 #ià
defšed
(
__GLIBC__
)

56 #ià
defšed
(
_NET_IF_H
è&& defšed(
__USE_MISC
)

61 
	#__UAPI_DEF_IF_IFCONF
 0

	)

62 
	#__UAPI_DEF_IF_IFMAP
 0

	)

63 
	#__UAPI_DEF_IF_IFNAMSIZ
 0

	)

64 
	#__UAPI_DEF_IF_IFREQ
 0

	)

66 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS
 0

	)

68 #iâdeà
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


69 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 1

	)

78 
	#__UAPI_DEF_IF_IFCONF
 1

	)

79 
	#__UAPI_DEF_IF_IFMAP
 1

	)

80 
	#__UAPI_DEF_IF_IFNAMSIZ
 1

	)

81 
	#__UAPI_DEF_IF_IFREQ
 1

	)

83 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS
 1

	)

85 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 1

	)

90 #ià
defšed
(
_NETINET_IN_H
)

94 
	#__UAPI_DEF_IN_ADDR
 0

	)

95 
	#__UAPI_DEF_IN_IPPROTO
 0

	)

96 
	#__UAPI_DEF_IN_PKTINFO
 0

	)

97 
	#__UAPI_DEF_IP_MREQ
 0

	)

98 
	#__UAPI_DEF_SOCKADDR_IN
 0

	)

99 
	#__UAPI_DEF_IN_CLASS
 0

	)

101 
	#__UAPI_DEF_IN6_ADDR
 0

	)

106 #ià
defšed
(
__USE_MISC
è|| defšed (
__USE_GNU
)

107 
	#__UAPI_DEF_IN6_ADDR_ALT
 0

	)

109 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

111 
	#__UAPI_DEF_SOCKADDR_IN6
 0

	)

112 
	#__UAPI_DEF_IPV6_MREQ
 0

	)

113 
	#__UAPI_DEF_IPPROTO_V6
 0

	)

114 
	#__UAPI_DEF_IPV6_OPTIONS
 0

	)

115 
	#__UAPI_DEF_IN6_PKTINFO
 0

	)

116 
	#__UAPI_DEF_IP6_MTUINFO
 0

	)

123 
	#__UAPI_DEF_IN_ADDR
 1

	)

124 
	#__UAPI_DEF_IN_IPPROTO
 1

	)

125 
	#__UAPI_DEF_IN_PKTINFO
 1

	)

126 
	#__UAPI_DEF_IP_MREQ
 1

	)

127 
	#__UAPI_DEF_SOCKADDR_IN
 1

	)

128 
	#__UAPI_DEF_IN_CLASS
 1

	)

130 
	#__UAPI_DEF_IN6_ADDR
 1

	)

133 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

134 
	#__UAPI_DEF_SOCKADDR_IN6
 1

	)

135 
	#__UAPI_DEF_IPV6_MREQ
 1

	)

136 
	#__UAPI_DEF_IPPROTO_V6
 1

	)

137 
	#__UAPI_DEF_IPV6_OPTIONS
 1

	)

138 
	#__UAPI_DEF_IN6_PKTINFO
 1

	)

139 
	#__UAPI_DEF_IP6_MTUINFO
 1

	)

144 #ià
defšed
(
__NETIPX_IPX_H
)

146 
	#__UAPI_DEF_SOCKADDR_IPX
 0

	)

147 
	#__UAPI_DEF_IPX_ROUTE_DEFINITION
 0

	)

148 
	#__UAPI_DEF_IPX_INTERFACE_DEFINITION
 0

	)

149 
	#__UAPI_DEF_IPX_CONFIG_DATA
 0

	)

150 
	#__UAPI_DEF_IPX_ROUTE_DEF
 0

	)

154 
	#__UAPI_DEF_SOCKADDR_IPX
 1

	)

155 
	#__UAPI_DEF_IPX_ROUTE_DEFINITION
 1

	)

156 
	#__UAPI_DEF_IPX_INTERFACE_DEFINITION
 1

	)

157 
	#__UAPI_DEF_IPX_CONFIG_DATA
 1

	)

158 
	#__UAPI_DEF_IPX_ROUTE_DEF
 1

	)

163 #ià
defšed
(
_SYS_XATTR_H
)

164 
	#__UAPI_DEF_XATTR
 0

	)

166 
	#__UAPI_DEF_XATTR
 1

	)

176 #iâdeà
__UAPI_DEF_IF_IFCONF


177 
	#__UAPI_DEF_IF_IFCONF
 1

	)

179 #iâdeà
__UAPI_DEF_IF_IFMAP


180 
	#__UAPI_DEF_IF_IFMAP
 1

	)

182 #iâdeà
__UAPI_DEF_IF_IFNAMSIZ


183 
	#__UAPI_DEF_IF_IFNAMSIZ
 1

	)

185 #iâdeà
__UAPI_DEF_IF_IFREQ


186 
	#__UAPI_DEF_IF_IFREQ
 1

	)

189 #iâdeà
__UAPI_DEF_IF_NET_DEVICE_FLAGS


190 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS
 1

	)

193 #iâdeà
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


194 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 1

	)

198 #iâdeà
__UAPI_DEF_IN_ADDR


199 
	#__UAPI_DEF_IN_ADDR
 1

	)

201 #iâdeà
__UAPI_DEF_IN_IPPROTO


202 
	#__UAPI_DEF_IN_IPPROTO
 1

	)

204 #iâdeà
__UAPI_DEF_IN_PKTINFO


205 
	#__UAPI_DEF_IN_PKTINFO
 1

	)

207 #iâdeà
__UAPI_DEF_IP_MREQ


208 
	#__UAPI_DEF_IP_MREQ
 1

	)

210 #iâdeà
__UAPI_DEF_SOCKADDR_IN


211 
	#__UAPI_DEF_SOCKADDR_IN
 1

	)

213 #iâdeà
__UAPI_DEF_IN_CLASS


214 
	#__UAPI_DEF_IN_CLASS
 1

	)

218 #iâdeà
__UAPI_DEF_IN6_ADDR


219 
	#__UAPI_DEF_IN6_ADDR
 1

	)

221 #iâdeà
__UAPI_DEF_IN6_ADDR_ALT


222 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

224 #iâdeà
__UAPI_DEF_SOCKADDR_IN6


225 
	#__UAPI_DEF_SOCKADDR_IN6
 1

	)

227 #iâdeà
__UAPI_DEF_IPV6_MREQ


228 
	#__UAPI_DEF_IPV6_MREQ
 1

	)

230 #iâdeà
__UAPI_DEF_IPPROTO_V6


231 
	#__UAPI_DEF_IPPROTO_V6
 1

	)

233 #iâdeà
__UAPI_DEF_IPV6_OPTIONS


234 
	#__UAPI_DEF_IPV6_OPTIONS
 1

	)

236 #iâdeà
__UAPI_DEF_IN6_PKTINFO


237 
	#__UAPI_DEF_IN6_PKTINFO
 1

	)

239 #iâdeà
__UAPI_DEF_IP6_MTUINFO


240 
	#__UAPI_DEF_IP6_MTUINFO
 1

	)

244 #iâdeà
__UAPI_DEF_SOCKADDR_IPX


245 
	#__UAPI_DEF_SOCKADDR_IPX
 1

	)

247 #iâdeà
__UAPI_DEF_IPX_ROUTE_DEFINITION


248 
	#__UAPI_DEF_IPX_ROUTE_DEFINITION
 1

	)

250 #iâdeà
__UAPI_DEF_IPX_INTERFACE_DEFINITION


251 
	#__UAPI_DEF_IPX_INTERFACE_DEFINITION
 1

	)

253 #iâdeà
__UAPI_DEF_IPX_CONFIG_DATA


254 
	#__UAPI_DEF_IPX_CONFIG_DATA
 1

	)

256 #iâdeà
__UAPI_DEF_IPX_ROUTE_DEF


257 
	#__UAPI_DEF_IPX_ROUTE_DEF
 1

	)

261 #iâdeà
__UAPI_DEF_XATTR


262 
	#__UAPI_DEF_XATTR
 1

	)

	@/usr/include/linux/limits.h

2 #iâdeà
_LINUX_LIMITS_H


3 
	#_LINUX_LIMITS_H


	)

5 
	#NR_OPEN
 1024

	)

7 
	#NGROUPS_MAX
 65536

	)

8 
	#ARG_MAX
 131072

	)

9 
	#LINK_MAX
 127

	)

10 
	#MAX_CANON
 255

	)

11 
	#MAX_INPUT
 255

	)

12 
	#NAME_MAX
 255

	)

13 
	#PATH_MAX
 4096

	)

14 
	#PIPE_BUF
 4096

	)

15 
	#XATTR_NAME_MAX
 255

	)

16 
	#XATTR_SIZE_MAX
 65536

	)

17 
	#XATTR_LIST_MAX
 65536

	)

19 
	#RTSIG_MAX
 32

	)

	@/usr/include/linux/neighbour.h

2 #iâdeà
__LINUX_NEIGHBOUR_H


3 
	#__LINUX_NEIGHBOUR_H


	)

5 
	~<lšux/ty³s.h
>

6 
	~<lšux/Ãšk.h
>

8 
	sndmsg
 {

9 
__u8
 
	mndm_çmy
;

10 
__u8
 
	mndm_·d1
;

11 
__u16
 
	mndm_·d2
;

12 
__s32
 
	mndm_ifšdex
;

13 
__u16
 
	mndm_¡©e
;

14 
__u8
 
	mndm_æags
;

15 
__u8
 
	mndm_ty³
;

19 
	mNDA_UNSPEC
,

20 
	mNDA_DST
,

21 
	mNDA_LLADDR
,

22 
	mNDA_CACHEINFO
,

23 
	mNDA_PROBES
,

24 
	mNDA_VLAN
,

25 
	mNDA_PORT
,

26 
	mNDA_VNI
,

27 
	mNDA_IFINDEX
,

28 
	mNDA_MASTER
,

29 
	mNDA_LINK_NETNSID
,

30 
	mNDA_SRC_VNI
,

31 
	m__NDA_MAX


34 
	#NDA_MAX
 (
__NDA_MAX
 - 1)

	)

40 
	#NTF_USE
 0x01

	)

41 
	#NTF_SELF
 0x02

	)

42 
	#NTF_MASTER
 0x04

	)

43 
	#NTF_PROXY
 0x08

	)

44 
	#NTF_EXT_LEARNED
 0x10

	)

45 
	#NTF_OFFLOADED
 0x20

	)

46 
	#NTF_ROUTER
 0x80

	)

52 
	#NUD_INCOMPLETE
 0x01

	)

53 
	#NUD_REACHABLE
 0x02

	)

54 
	#NUD_STALE
 0x04

	)

55 
	#NUD_DELAY
 0x08

	)

56 
	#NUD_PROBE
 0x10

	)

57 
	#NUD_FAILED
 0x20

	)

60 
	#NUD_NOARP
 0x40

	)

61 
	#NUD_PERMANENT
 0x80

	)

62 
	#NUD_NONE
 0x00

	)

69 
	snda_ÿchešfo
 {

70 
__u32
 
	mndm_cÚfœmed
;

71 
__u32
 
	mndm_u£d
;

72 
__u32
 
	mndm_upd©ed
;

73 
__u32
 
	mndm_»fút
;

101 
	sndt_¡©s
 {

102 
__u64
 
	mndts_®locs
;

103 
__u64
 
	mndts_de¡roys
;

104 
__u64
 
	mndts_hash_grows
;

105 
__u64
 
	mndts_»s_çed
;

106 
__u64
 
	mndts_lookups
;

107 
__u64
 
	mndts_h™s
;

108 
__u64
 
	mndts_rcv_´obes_mÿ¡
;

109 
__u64
 
	mndts_rcv_´obes_uÿ¡
;

110 
__u64
 
	mndts_³riodic_gc_runs
;

111 
__u64
 
	mndts_fÜûd_gc_runs
;

112 
__u64
 
	mndts_bË_fuÎs
;

116 
	mNDTPA_UNSPEC
,

117 
	mNDTPA_IFINDEX
,

118 
	mNDTPA_REFCNT
,

119 
	mNDTPA_REACHABLE_TIME
,

120 
	mNDTPA_BASE_REACHABLE_TIME
,

121 
	mNDTPA_RETRANS_TIME
,

122 
	mNDTPA_GC_STALETIME
,

123 
	mNDTPA_DELAY_PROBE_TIME
,

124 
	mNDTPA_QUEUE_LEN
,

125 
	mNDTPA_APP_PROBES
,

126 
	mNDTPA_UCAST_PROBES
,

127 
	mNDTPA_MCAST_PROBES
,

128 
	mNDTPA_ANYCAST_DELAY
,

129 
	mNDTPA_PROXY_DELAY
,

130 
	mNDTPA_PROXY_QLEN
,

131 
	mNDTPA_LOCKTIME
,

132 
	mNDTPA_QUEUE_LENBYTES
,

133 
	mNDTPA_MCAST_REPROBES
,

134 
	mNDTPA_PAD
,

135 
	m__NDTPA_MAX


137 
	#NDTPA_MAX
 (
__NDTPA_MAX
 - 1)

	)

139 
	sndtmsg
 {

140 
__u8
 
	mndtm_çmy
;

141 
__u8
 
	mndtm_·d1
;

142 
__u16
 
	mndtm_·d2
;

145 
	sndt_cÚfig
 {

146 
__u16
 
	mndtc_key_Ën
;

147 
__u16
 
	mndtc_’Œy_size
;

148 
__u32
 
	mndtc_’Œ›s
;

149 
__u32
 
	mndtc_Ï¡_æush
;

150 
__u32
 
	mndtc_Ï¡_¿nd
;

151 
__u32
 
	mndtc_hash_ºd
;

152 
__u32
 
	mndtc_hash_mask
;

153 
__u32
 
	mndtc_hash_chaš_gc
;

154 
__u32
 
	mndtc_´oxy_qËn
;

158 
	mNDTA_UNSPEC
,

159 
	mNDTA_NAME
,

160 
	mNDTA_THRESH1
,

161 
	mNDTA_THRESH2
,

162 
	mNDTA_THRESH3
,

163 
	mNDTA_CONFIG
,

164 
	mNDTA_PARMS
,

165 
	mNDTA_STATS
,

166 
	mNDTA_GC_INTERVAL
,

167 
	mNDTA_PAD
,

168 
	m__NDTA_MAX


170 
	#NDTA_MAX
 (
__NDTA_MAX
 - 1)

	)

	@/usr/include/linux/netlink.h

2 #iâdeà
__LINUX_NETLINK_H


3 
	#__LINUX_NETLINK_H


	)

5 
	~<lšux/k”Ãl.h
>

6 
	~<lšux/sock‘.h
>

7 
	~<lšux/ty³s.h
>

9 
	#NETLINK_ROUTE
 0

	)

10 
	#NETLINK_UNUSED
 1

	)

11 
	#NETLINK_USERSOCK
 2

	)

12 
	#NETLINK_FIREWALL
 3

	)

13 
	#NETLINK_SOCK_DIAG
 4

	)

14 
	#NETLINK_NFLOG
 5

	)

15 
	#NETLINK_XFRM
 6

	)

16 
	#NETLINK_SELINUX
 7

	)

17 
	#NETLINK_ISCSI
 8

	)

18 
	#NETLINK_AUDIT
 9

	)

19 
	#NETLINK_FIB_LOOKUP
 10

	)

20 
	#NETLINK_CONNECTOR
 11

	)

21 
	#NETLINK_NETFILTER
 12

	)

22 
	#NETLINK_IP6_FW
 13

	)

23 
	#NETLINK_DNRTMSG
 14

	)

24 
	#NETLINK_KOBJECT_UEVENT
 15

	)

25 
	#NETLINK_GENERIC
 16

	)

27 
	#NETLINK_SCSITRANSPORT
 18

	)

28 
	#NETLINK_ECRYPTFS
 19

	)

29 
	#NETLINK_RDMA
 20

	)

30 
	#NETLINK_CRYPTO
 21

	)

31 
	#NETLINK_SMC
 22

	)

33 
	#NETLINK_INET_DIAG
 
NETLINK_SOCK_DIAG


	)

35 
	#MAX_LINKS
 32

	)

37 
	ssockaddr_Æ
 {

38 
__k”Ãl_§_çmy_t
 
	mÆ_çmy
;

39 
	mÆ_·d
;

40 
__u32
 
	mÆ_pid
;

41 
__u32
 
	mÆ_groups
;

44 
	sÆmsghdr
 {

45 
__u32
 
	mÆmsg_Ën
;

46 
__u16
 
	mÆmsg_ty³
;

47 
__u16
 
	mÆmsg_æags
;

48 
__u32
 
	mÆmsg_£q
;

49 
__u32
 
	mÆmsg_pid
;

54 
	#NLM_F_REQUEST
 0x01

	)

55 
	#NLM_F_MULTI
 0x02

	)

56 
	#NLM_F_ACK
 0x04

	)

57 
	#NLM_F_ECHO
 0x08

	)

58 
	#NLM_F_DUMP_INTR
 0x10

	)

59 
	#NLM_F_DUMP_FILTERED
 0x20

	)

62 
	#NLM_F_ROOT
 0x100

	)

63 
	#NLM_F_MATCH
 0x200

	)

64 
	#NLM_F_ATOMIC
 0x400

	)

65 
	#NLM_F_DUMP
 (
NLM_F_ROOT
|
NLM_F_MATCH
)

	)

68 
	#NLM_F_REPLACE
 0x100

	)

69 
	#NLM_F_EXCL
 0x200

	)

70 
	#NLM_F_CREATE
 0x400

	)

71 
	#NLM_F_APPEND
 0x800

	)

74 
	#NLM_F_NONREC
 0x100

	)

77 
	#NLM_F_CAPPED
 0x100

	)

78 
	#NLM_F_ACK_TLVS
 0x200

	)

89 
	#NLMSG_ALIGNTO
 4U

	)

90 
	#NLMSG_ALIGN
(
Ën
èĞ(Ö’)+
NLMSG_ALIGNTO
-1è& ~(NLMSG_ALIGNTO-1è)

	)

91 
	#NLMSG_HDRLEN
 ((è
	`NLMSG_ALIGN
((
Æmsghdr
)))

	)

92 
	#NLMSG_LENGTH
(
Ën
è(Ö’è+ 
NLMSG_HDRLEN
)

	)

93 
	#NLMSG_SPACE
(
Ën
è
	`NLMSG_ALIGN
(
	`NLMSG_LENGTH
Ö’))

	)

94 
	#NLMSG_DATA
(
Æh
è((*)(((*êlhè+ 
	`NLMSG_LENGTH
(0)))

	)

95 
	#NLMSG_NEXT
(
Æh
,
Ën
è(Ö’è-ğ
	`NLMSG_ALIGN
(Òlh)->
Æmsg_Ën
), \

96 (
Æmsghdr
*)(((*)(
Æh
)è+ 
	`NLMSG_ALIGN
(Òlh)->
Æmsg_Ën
)))

	)

97 
	#NLMSG_OK
(
Æh
,
Ën
è(Ö’è>ğ()(
Æmsghdr
) && \

98 (
Æh
)->
Æmsg_Ën
 >ğ(
Æmsghdr
) && \

99 (
Æh
)->
Æmsg_Ën
 <ğ(
Ën
))

	)

100 
	#NLMSG_PAYLOAD
(
Æh
,
Ën
è(Òlh)->
Æmsg_Ën
 - 
	`NLMSG_SPACE
(Ö’)))

	)

102 
	#NLMSG_NOOP
 0x1

	)

103 
	#NLMSG_ERROR
 0x2

	)

104 
	#NLMSG_DONE
 0x3

	)

105 
	#NLMSG_OVERRUN
 0x4

	)

107 
	#NLMSG_MIN_TYPE
 0x10

	)

109 
	sÆmsg”r
 {

110 
	m”rÜ
;

111 
Æmsghdr
 
	mmsg
;

135 
	eÆmsg”r_©Œs
 {

136 
	mNLMSGERR_ATTR_UNUSED
,

137 
	mNLMSGERR_ATTR_MSG
,

138 
	mNLMSGERR_ATTR_OFFS
,

139 
	mNLMSGERR_ATTR_COOKIE
,

141 
	m__NLMSGERR_ATTR_MAX
,

142 
	mNLMSGERR_ATTR_MAX
 = 
__NLMSGERR_ATTR_MAX
 - 1

145 
	#NETLINK_ADD_MEMBERSHIP
 1

	)

146 
	#NETLINK_DROP_MEMBERSHIP
 2

	)

147 
	#NETLINK_PKTINFO
 3

	)

148 
	#NETLINK_BROADCAST_ERROR
 4

	)

149 
	#NETLINK_NO_ENOBUFS
 5

	)

150 
	#NETLINK_RX_RING
 6

	)

151 
	#NETLINK_TX_RING
 7

	)

152 
	#NETLINK_LISTEN_ALL_NSID
 8

	)

153 
	#NETLINK_LIST_MEMBERSHIPS
 9

	)

154 
	#NETLINK_CAP_ACK
 10

	)

155 
	#NETLINK_EXT_ACK
 11

	)

157 
	sÆ_pktšfo
 {

158 
__u32
 
	mgroup
;

161 
	sÆ_mm­_»q
 {

162 
	mnm_block_size
;

163 
	mnm_block_Ä
;

164 
	mnm_äame_size
;

165 
	mnm_äame_Ä
;

168 
	sÆ_mm­_hdr
 {

169 
	mnm_¡©us
;

170 
	mnm_Ën
;

171 
__u32
 
	mnm_group
;

173 
__u32
 
	mnm_pid
;

174 
__u32
 
	mnm_uid
;

175 
__u32
 
	mnm_gid
;

178 
	eÆ_mm­_¡©us
 {

179 
	mNL_MMAP_STATUS_UNUSED
,

180 
	mNL_MMAP_STATUS_RESERVED
,

181 
	mNL_MMAP_STATUS_VALID
,

182 
	mNL_MMAP_STATUS_COPY
,

183 
	mNL_MMAP_STATUS_SKIP
,

186 
	#NL_MMAP_MSG_ALIGNMENT
 
NLMSG_ALIGNTO


	)

187 
	#NL_MMAP_MSG_ALIGN
(
sz
è
	`__ALIGN_KERNEL
(sz, 
NL_MMAP_MSG_ALIGNMENT
)

	)

188 
	#NL_MMAP_HDRLEN
 
	`NL_MMAP_MSG_ALIGN
((
Æ_mm­_hdr
))

	)

190 
	#NET_MAJOR
 36

	)

193 
	mNETLINK_UNCONNECTED
 = 0,

194 
	mNETLINK_CONNECTED
,

206 
	sÆ©Œ
 {

207 
__u16
 
	mÆa_Ën
;

208 
__u16
 
	mÆa_ty³
;

221 
	#NLA_F_NESTED
 (1 << 15)

	)

222 
	#NLA_F_NET_BYTEORDER
 (1 << 14)

	)

223 
	#NLA_TYPE_MASK
 ~(
NLA_F_NESTED
 | 
NLA_F_NET_BYTEORDER
)

	)

225 
	#NLA_ALIGNTO
 4

	)

226 
	#NLA_ALIGN
(
Ën
è((Ö’è+ 
NLA_ALIGNTO
 - 1è& ~(NLA_ALIGNTO - 1))

	)

227 
	#NLA_HDRLEN
 ((è
	`NLA_ALIGN
((
Æ©Œ
)))

	)

242 
	sÆa_b™f›ld32
 {

243 
__u32
 
	mv®ue
;

244 
__u32
 
	m£ËùÜ
;

	@/usr/include/linux/posix_types.h

2 #iâdeà
_LINUX_POSIX_TYPES_H


3 
	#_LINUX_POSIX_TYPES_H


	)

5 
	~<lšux/¡ddef.h
>

22 #undeà
__FD_SETSIZE


23 
	#__FD_SETSIZE
 1024

	)

26 
	mfds_b™s
[
__FD_SETSIZE
 / (8 * ())];

27 } 
	t__k”Ãl_fd_£t
;

30 (*
	t__k”Ãl_sighªdËr_t
)();

33 
	t__k”Ãl_key_t
;

34 
	t__k”Ãl_mqd_t
;

36 
	~<asm/posix_ty³s.h
>

	@/usr/include/linux/sysinfo.h

2 #iâdeà
_LINUX_SYSINFO_H


3 
	#_LINUX_SYSINFO_H


	)

5 
	~<lšux/ty³s.h
>

7 
	#SI_LOAD_SHIFT
 16

	)

8 
	ssysšfo
 {

9 
__k”Ãl_lÚg_t
 
	mu±ime
;

10 
__k”Ãl_ulÚg_t
 
	mlßds
[3];

11 
__k”Ãl_ulÚg_t
 
	mtÙ®¿m
;

12 
__k”Ãl_ulÚg_t
 
	mä“¿m
;

13 
__k”Ãl_ulÚg_t
 
	msh¬ed¿m
;

14 
__k”Ãl_ulÚg_t
 
	mbufã¼am
;

15 
__k”Ãl_ulÚg_t
 
	mtÙ®sw­
;

16 
__k”Ãl_ulÚg_t
 
	mä“sw­
;

17 
__u16
 
	m´ocs
;

18 
__u16
 
	m·d
;

19 
__k”Ãl_ulÚg_t
 
	mtÙ®high
;

20 
__k”Ãl_ulÚg_t
 
	mä“high
;

21 
__u32
 
	mmem_un™
;

22 
	m_f
[20-2*(
__k”Ãl_ulÚg_t
)-(
__u32
)];

	@/usr/include/string.h

22 #iâdef 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

26 
	~<b™s/libc-h—d”-¡¬t.h
>

28 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

36 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

37 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

42 *
	$memıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

43 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

46 *
	$memmove
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
)

47 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

52 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


53 *
	$memcıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

54 
__c
, 
size_t
 
__n
)

55 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

60 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

63 
	$memcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

64 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

67 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


70 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

71 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

72 cÚ¡ *
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

73 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

75 #ifdeà
__OPTIMIZE__


76 
__ex‹º_®ways_šlše
 *

77 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW


79  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

82 
__ex‹º_®ways_šlše
 const *

83 
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
è
__THROW


85  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

88 
	}
}

90 *
	$memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

91 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

94 #ifdeà
__USE_GNU


97 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


98 "C++" *
	$¿wmemchr
 (*
__s
, 
__c
)

99 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

100 "C++" cÚ¡ *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

101 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

103 *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

104 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

108 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


109 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

110 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

111 "C++" cÚ¡ *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

112 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

114 *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

115 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

121 *
	$¡rıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

122 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

124 *
	$¡ºıy
 (*
__»¡riù
 
__de¡
,

125 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

126 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

129 *
	$¡rÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

130 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

132 *
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

133 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

136 
	$¡rcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

137 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

139 
	$¡ºcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

140 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

143 
	$¡rcŞl
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

144 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

146 
size_t
 
	$¡rxäm
 (*
__»¡riù
 
__de¡
,

147 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

148 
__THROW
 
	`__nÚnuÎ
 ((2));

150 #ifdeà
__USE_XOPEN2K8


152 
	~<b™s/ty³s/loÿË_t.h
>

155 
	$¡rcŞl_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
loÿË_t
 
__l
)

156 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

159 
size_t
 
	$¡rxäm_l
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
,

160 
loÿË_t
 
__l
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

163 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8
 \

164 || 
	$__GLIBC_USE
 (
LIB_EXT2
))

166 *
	$¡rdup
 (cÚ¡ *
__s
)

167 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

173 #ià
defšed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

174 *
	$¡ºdup
 (cÚ¡ *
__¡ršg
, 
size_t
 
__n
)

175 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

178 #ià
defšed
 
__USE_GNU
 && defšed 
__GNUC__


180 
	#¡rdu·
(
s
) \

181 (
__ex‹nsiÚ__
 \

183 cÚ¡ *
__Şd
 = (
s
); \

184 
size_t
 
__Ën
 = 
	`¡¾’
 (
__Şd
) + 1; \

185 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
); \

186 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

187 
	}
}))

	)

190 
	#¡ºdu·
(
s
, 
n
) \

191 (
__ex‹nsiÚ__
 \

193 cÚ¡ *
__Şd
 = (
s
); \

194 
size_t
 
__Ën
 = 
	`¡ºËn
 (
__Şd
, (
n
)); \

195 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
 + 1); \

196 
__Ãw
[
__Ën
] = '\0'; \

197 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

198 }))

	)

202 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


205 *
¡rchr
 (*
__s
, 
__c
)

206 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

207 cÚ¡ *
¡rchr
 (cÚ¡ *
__s
, 
__c
)

208 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

210 #ifdeà
__OPTIMIZE__


211 
__ex‹º_®ways_šlše
 *

212 
¡rchr
 (*
__s
, 
__c
è
	g__THROW


214  
__butš_¡rchr
 (
__s
, 
__c
);

217 
__ex‹º_®ways_šlše
 const *

218 
¡rchr
 (cÚ¡ *
__s
, 
__c
è
	g__THROW


220  
__butš_¡rchr
 (
__s
, 
__c
);

225 *
	$¡rchr
 (cÚ¡ *
__s
, 
__c
)

226 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

229 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


232 *
	`¡¼chr
 (*
__s
, 
__c
)

233 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

234 cÚ¡ *
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
)

235 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

237 #ifdeà
__OPTIMIZE__


238 
__ex‹º_®ways_šlše
 *

239 
	`¡¼chr
 (*
__s
, 
__c
è
__THROW


241  
	`__butš_¡¼chr
 (
__s
, 
__c
);

244 
__ex‹º_®ways_šlše
 const *

245 
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
è
__THROW


247  
	`__butš_¡¼chr
 (
__s
, 
__c
);

250 
	}
}

252 *
	$¡¼chr
 (cÚ¡ *
__s
, 
__c
)

253 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

256 #ifdeà
__USE_GNU


259 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


260 "C++" *
	$¡rchºul
 (*
__s
, 
__c
)

261 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

262 "C++" cÚ¡ *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

263 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

265 *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

266 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

272 
size_t
 
	$¡rc¥n
 (cÚ¡ *
__s
, cÚ¡ *
__»jeù
)

273 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

276 
size_t
 
	$¡r¥n
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

277 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

279 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


282 *
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
)

283 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

284 cÚ¡ *
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

285 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

287 #ifdeà
__OPTIMIZE__


288 
__ex‹º_®ways_šlše
 *

289 
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
è
__THROW


291  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

294 
__ex‹º_®ways_šlše
 const *

295 
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
è
__THROW


297  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

300 
	}
}

302 *
	$¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

303 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

306 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


309 *
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

310 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

311 cÚ¡ *
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

312 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

314 #ifdeà
__OPTIMIZE__


315 
__ex‹º_®ways_šlše
 *

316 
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


318  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

321 
__ex‹º_®ways_šlše
 const *

322 
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


324  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

327 
	}
}

329 *
	$¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

330 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

335 *
	$¡¹ok
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
)

336 
__THROW
 
	`__nÚnuÎ
 ((2));

340 *
	$__¡¹ok_r
 (*
__»¡riù
 
__s
,

341 cÚ¡ *
__»¡riù
 
__d–im
,

342 **
__»¡riù
 
__§ve_±r
)

343 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

344 #ifdeà
__USE_POSIX


345 *
	$¡¹ok_r
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
,

346 **
__»¡riù
 
__§ve_±r
)

347 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

350 #ifdeà
__USE_GNU


352 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


353 "C++" *
	$¡rÿ£¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

354 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

355 "C++" cÚ¡ *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
,

356 cÚ¡ *
__ÃedË
)

357 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

359 *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

360 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

364 #ifdeà
__USE_GNU


368 *
	$memmem
 (cÚ¡ *
__hay¡ack
, 
size_t
 
__hay¡ackËn
,

369 cÚ¡ *
__ÃedË
, 
size_t
 
__ÃedËËn
)

370 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 3));

374 *
	$__mempıy
 (*
__»¡riù
 
__de¡
,

375 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

376 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

377 *
	$mempıy
 (*
__»¡riù
 
__de¡
,

378 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

379 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

384 
size_t
 
	$¡¾’
 (cÚ¡ *
__s
)

385 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

387 #ifdef 
__USE_XOPEN2K8


390 
size_t
 
	$¡ºËn
 (cÚ¡ *
__¡ršg
, 
size_t
 
__maxËn
)

391 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

396 *
	$¡»¼Ü
 (
__”ºum
è
__THROW
;

397 #ifdeà
__USE_XOPEN2K


405 #ià
defšed
 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


408 #ifdeà
__REDIRECT_NTH


409 
	`__REDIRECT_NTH
 (
¡»¼Ü_r
,

410 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
),

411 
__xpg_¡»¼Ü_r
è
	`__nÚnuÎ
 ((2));

413 
	$__xpg_¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

414 
__THROW
 
	`__nÚnuÎ
 ((2));

415 
	#¡»¼Ü_r
 
__xpg_¡»¼Ü_r


	)

420 *
	$¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

421 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

425 #ifdeà
__USE_XOPEN2K8


427 *
	$¡»¼Ü_l
 (
__”ºum
, 
loÿË_t
 
__l
è
__THROW
;

430 #ifdeà
__USE_MISC


431 
	~<¡ršgs.h
>

435 
	$ex¶ic™_bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

439 *
	$¡r£p
 (**
__»¡riù
 
__¡ršgp
,

440 cÚ¡ *
__»¡riù
 
__d–im
)

441 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

444 #ifdef 
__USE_XOPEN2K8


446 *
	$¡rsigÇl
 (
__sig
è
__THROW
;

449 *
	$__¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

450 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

451 *
	$¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

452 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

456 *
	$__¡²ıy
 (*
__»¡riù
 
__de¡
,

457 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

458 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

459 *
	$¡²ıy
 (*
__»¡riù
 
__de¡
,

460 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

461 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

464 #ifdef 
__USE_GNU


466 
	$¡rv”scmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

467 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

470 *
	$¡räy
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

473 *
	$memäob
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

475 #iâdeà
ba£Çme


480 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


481 "C++" *
	$ba£Çme
 (*
__f’ame
)

482 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

483 "C++" cÚ¡ *
	$ba£Çme
 (cÚ¡ *
__f’ame
)

484 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

486 *
	$ba£Çme
 (cÚ¡ *
__f’ame
è
__THROW
 
	`__nÚnuÎ
 ((1));

491 #ià
	`__GNUC_PREREQ
 (3,4)

492 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


494 
	~<b™s/¡ršg_fÜtif›d.h
>

498 
__END_DECLS


	@/usr/include/asm-generic/errno.h

2 #iâdeà
_ASM_GENERIC_ERRNO_H


3 
	#_ASM_GENERIC_ERRNO_H


	)

5 
	~<asm-g’”ic/”ºo-ba£.h
>

7 
	#EDEADLK
 35

	)

8 
	#ENAMETOOLONG
 36

	)

9 
	#ENOLCK
 37

	)

18 
	#ENOSYS
 38

	)

20 
	#ENOTEMPTY
 39

	)

21 
	#ELOOP
 40

	)

22 
	#EWOULDBLOCK
 
EAGAIN


	)

23 
	#ENOMSG
 42

	)

24 
	#EIDRM
 43

	)

25 
	#ECHRNG
 44

	)

26 
	#EL2NSYNC
 45

	)

27 
	#EL3HLT
 46

	)

28 
	#EL3RST
 47

	)

29 
	#ELNRNG
 48

	)

30 
	#EUNATCH
 49

	)

31 
	#ENOCSI
 50

	)

32 
	#EL2HLT
 51

	)

33 
	#EBADE
 52

	)

34 
	#EBADR
 53

	)

35 
	#EXFULL
 54

	)

36 
	#ENOANO
 55

	)

37 
	#EBADRQC
 56

	)

38 
	#EBADSLT
 57

	)

40 
	#EDEADLOCK
 
EDEADLK


	)

42 
	#EBFONT
 59

	)

43 
	#ENOSTR
 60

	)

44 
	#ENODATA
 61

	)

45 
	#ETIME
 62

	)

46 
	#ENOSR
 63

	)

47 
	#ENONET
 64

	)

48 
	#ENOPKG
 65

	)

49 
	#EREMOTE
 66

	)

50 
	#ENOLINK
 67

	)

51 
	#EADV
 68

	)

52 
	#ESRMNT
 69

	)

53 
	#ECOMM
 70

	)

54 
	#EPROTO
 71

	)

55 
	#EMULTIHOP
 72

	)

56 
	#EDOTDOT
 73

	)

57 
	#EBADMSG
 74

	)

58 
	#EOVERFLOW
 75

	)

59 
	#ENOTUNIQ
 76

	)

60 
	#EBADFD
 77

	)

61 
	#EREMCHG
 78

	)

62 
	#ELIBACC
 79

	)

63 
	#ELIBBAD
 80

	)

64 
	#ELIBSCN
 81

	)

65 
	#ELIBMAX
 82

	)

66 
	#ELIBEXEC
 83

	)

67 
	#EILSEQ
 84

	)

68 
	#ERESTART
 85

	)

69 
	#ESTRPIPE
 86

	)

70 
	#EUSERS
 87

	)

71 
	#ENOTSOCK
 88

	)

72 
	#EDESTADDRREQ
 89

	)

73 
	#EMSGSIZE
 90

	)

74 
	#EPROTOTYPE
 91

	)

75 
	#ENOPROTOOPT
 92

	)

76 
	#EPROTONOSUPPORT
 93

	)

77 
	#ESOCKTNOSUPPORT
 94

	)

78 
	#EOPNOTSUPP
 95

	)

79 
	#EPFNOSUPPORT
 96

	)

80 
	#EAFNOSUPPORT
 97

	)

81 
	#EADDRINUSE
 98

	)

82 
	#EADDRNOTAVAIL
 99

	)

83 
	#ENETDOWN
 100

	)

84 
	#ENETUNREACH
 101

	)

85 
	#ENETRESET
 102

	)

86 
	#ECONNABORTED
 103

	)

87 
	#ECONNRESET
 104

	)

88 
	#ENOBUFS
 105

	)

89 
	#EISCONN
 106

	)

90 
	#ENOTCONN
 107

	)

91 
	#ESHUTDOWN
 108

	)

92 
	#ETOOMANYREFS
 109

	)

93 
	#ETIMEDOUT
 110

	)

94 
	#ECONNREFUSED
 111

	)

95 
	#EHOSTDOWN
 112

	)

96 
	#EHOSTUNREACH
 113

	)

97 
	#EALREADY
 114

	)

98 
	#EINPROGRESS
 115

	)

99 
	#ESTALE
 116

	)

100 
	#EUCLEAN
 117

	)

101 
	#ENOTNAM
 118

	)

102 
	#ENAVAIL
 119

	)

103 
	#EISNAM
 120

	)

104 
	#EREMOTEIO
 121

	)

105 
	#EDQUOT
 122

	)

107 
	#ENOMEDIUM
 123

	)

108 
	#EMEDIUMTYPE
 124

	)

109 
	#ECANCELED
 125

	)

110 
	#ENOKEY
 126

	)

111 
	#EKEYEXPIRED
 127

	)

112 
	#EKEYREVOKED
 128

	)

113 
	#EKEYREJECTED
 129

	)

116 
	#EOWNERDEAD
 130

	)

117 
	#ENOTRECOVERABLE
 131

	)

119 
	#ERFKILL
 132

	)

121 
	#EHWPOISON
 133

	)

	@/usr/include/asm-generic/poll.h

2 #iâdeà
__ASM_GENERIC_POLL_H


3 
	#__ASM_GENERIC_POLL_H


	)

6 
	#POLLIN
 0x0001

	)

7 
	#POLLPRI
 0x0002

	)

8 
	#POLLOUT
 0x0004

	)

9 
	#POLLERR
 0x0008

	)

10 
	#POLLHUP
 0x0010

	)

11 
	#POLLNVAL
 0x0020

	)

14 
	#POLLRDNORM
 0x0040

	)

15 
	#POLLRDBAND
 0x0080

	)

16 #iâdeà
POLLWRNORM


17 
	#POLLWRNORM
 0x0100

	)

19 #iâdeà
POLLWRBAND


20 
	#POLLWRBAND
 0x0200

	)

22 #iâdeà
POLLMSG


23 
	#POLLMSG
 0x0400

	)

25 #iâdeà
POLLREMOVE


26 
	#POLLREMOVE
 0x1000

	)

28 #iâdeà
POLLRDHUP


29 
	#POLLRDHUP
 0x2000

	)

32 
	#POLLFREE
 0x4000

	)

34 
	#POLL_BUSY_LOOP
 0x8000

	)

36 
	spŞlfd
 {

37 
	mfd
;

38 
	mev’ts
;

39 
	m»v’ts
;

	@/usr/include/asm-generic/types.h

2 #iâdeà
_ASM_GENERIC_TYPES_H


3 
	#_ASM_GENERIC_TYPES_H


	)

7 
	~<asm-g’”ic/št-Î64.h
>

	@/usr/include/asm/ioctl.h

1 
	~<asm-g’”ic/ioùl.h
>

	@/usr/include/asm/posix_types.h

2 #ifdeà
__i386__


3 
	~<asm/posix_ty³s_32.h
>

4 #–ià
defšed
(
__ILP32__
)

5 
	~<asm/posix_ty³s_x32.h
>

7 
	~<asm/posix_ty³s_64.h
>

	@/usr/include/asm/socket.h

1 
	~<asm-g’”ic/sock‘.h
>

	@/usr/include/bits/libc-header-start.h

27 #iâdeà
__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


31 #undeà
__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


33 
	~<ã©u»s.h
>

37 #undeà
__GLIBC_USE_LIB_EXT2


38 #ià(
defšed
 
__USE_GNU
 \

39 || (
defšed
 
	g__STDC_WANT_LIB_EXT2__
 && __STDC_WANT_LIB_EXT2__ > 0))

40 
	#__GLIBC_USE_LIB_EXT2
 1

	)

42 
	#__GLIBC_USE_LIB_EXT2
 0

	)

47 #undeà
__GLIBC_USE_IEC_60559_BFP_EXT


48 #ià
defšed
 
__USE_GNU
 || defšed 
__STDC_WANT_IEC_60559_BFP_EXT__


49 
	#__GLIBC_USE_IEC_60559_BFP_EXT
 1

	)

51 
	#__GLIBC_USE_IEC_60559_BFP_EXT
 0

	)

56 #undeà
__GLIBC_USE_IEC_60559_FUNCS_EXT


57 #ià
defšed
 
__USE_GNU
 || defšed 
__STDC_WANT_IEC_60559_FUNCS_EXT__


58 
	#__GLIBC_USE_IEC_60559_FUNCS_EXT
 1

	)

60 
	#__GLIBC_USE_IEC_60559_FUNCS_EXT
 0

	)

65 #undeà
__GLIBC_USE_IEC_60559_TYPES_EXT


66 #ià
defšed
 
__USE_GNU
 || defšed 
__STDC_WANT_IEC_60559_TYPES_EXT__


67 
	#__GLIBC_USE_IEC_60559_TYPES_EXT
 1

	)

69 
	#__GLIBC_USE_IEC_60559_TYPES_EXT
 0

	)

	@/usr/include/bits/sockaddr.h

23 #iâdeà
_BITS_SOCKADDR_H


24 
	#_BITS_SOCKADDR_H
 1

	)

28 
	t§_çmy_t
;

34 
	#__SOCKADDR_COMMON
(
§_´efix
) \

35 
§_çmy_t
 
§_´efix
##
çmy


	)

37 
	#__SOCKADDR_COMMON_SIZE
 ( ())

	)

40 
	#_SS_SIZE
 128

	)

	@/usr/include/bits/socket_type.h

19 #iâdeà
_SYS_SOCKET_H


24 
	e__sock‘_ty³


26 
	mSOCK_STREAM
 = 1,

28 
	#SOCK_STREAM
 
SOCK_STREAM


	)

29 
	mSOCK_DGRAM
 = 2,

31 
	#SOCK_DGRAM
 
SOCK_DGRAM


	)

32 
	mSOCK_RAW
 = 3,

33 
	#SOCK_RAW
 
SOCK_RAW


	)

34 
	mSOCK_RDM
 = 4,

35 
	#SOCK_RDM
 
SOCK_RDM


	)

36 
	mSOCK_SEQPACKET
 = 5,

38 
	#SOCK_SEQPACKET
 
SOCK_SEQPACKET


	)

39 
	mSOCK_DCCP
 = 6,

40 
	#SOCK_DCCP
 
SOCK_DCCP


	)

41 
	mSOCK_PACKET
 = 10,

44 
	#SOCK_PACKET
 
SOCK_PACKET


	)

49 
	mSOCK_CLOEXEC
 = 02000000,

51 
	#SOCK_CLOEXEC
 
SOCK_CLOEXEC


	)

52 
	mSOCK_NONBLOCK
 = 00004000

54 
	#SOCK_NONBLOCK
 
SOCK_NONBLOCK


	)

	@/usr/include/bits/string_fortified.h

18 #iâdeà
_BITS_STRING_FORTIFIED_H


19 
	#_BITS_STRING_FORTIFIED_H
 1

	)

21 #iâdeà
_STRING_H


25 #ià!
__GNUC_PREREQ
 (5,0)

26 
__w¬ndeş
 (
__w¬n_mem£t_z”o_Ën
,

30 
__fÜtify_funùiÚ
 *

31 
__NTH
 (
	$memıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

32 
size_t
 
__Ën
))

34  
	`__butš___memıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

35 
	}
}

37 
__fÜtify_funùiÚ
 *

38 
__NTH
 (
	$memmove
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__Ën
))

40  
	`__butš___memmove_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

41 
	}
}

43 #ifdeà
__USE_GNU


44 
__fÜtify_funùiÚ
 *

45 
__NTH
 (
	$mempıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

46 
size_t
 
__Ën
))

48  
	`__butš___mempıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

49 
	}
}

58 
__fÜtify_funùiÚ
 *

59 
__NTH
 (
	$mem£t
 (*
__de¡
, 
__ch
, 
size_t
 
__Ën
))

63 #ià!
	`__GNUC_PREREQ
 (5,0)

64 ià(
	`__butš_cÚ¡ªt_p
 (
__Ën
) && __len == 0

65 && (!
	`__butš_cÚ¡ªt_p
 (
__ch
) || __ch != 0))

67 
	`__w¬n_mem£t_z”o_Ën
 ();

68  
__de¡
;

71  
	`__butš___mem£t_chk
 (
__de¡
, 
__ch
, 
__Ën
, 
	`__bos0
 (__dest));

72 
	}
}

74 #ifdeà
__USE_MISC


75 
	~<b™s/¡ršgs_fÜtif›d.h
>

77 
	$__ex¶ic™_bz”o_chk
 (*
__de¡
, 
size_t
 
__Ën
, size_ˆ
__de¡Ën
)

78 
__THROW
 
	`__nÚnuÎ
 ((1));

80 
__fÜtify_funùiÚ
 

81 
	`__NTH
 (
	$ex¶ic™_bz”o
 (*
__de¡
, 
size_t
 
__Ën
))

83 
	`__ex¶ic™_bz”o_chk
 (
__de¡
, 
__Ën
, 
	`__bos0
 (__dest));

84 
	}
}

87 
__fÜtify_funùiÚ
 *

88 
__NTH
 (
	$¡rıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
))

90  
	`__butš___¡rıy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

91 
	}
}

93 #ifdeà
__USE_GNU


94 
__fÜtify_funùiÚ
 *

95 
__NTH
 (
	$¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
))

97  
	`__butš___¡pıy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

98 
	}
}

102 
__fÜtify_funùiÚ
 *

103 
__NTH
 (
	$¡ºıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

104 
size_t
 
__Ën
))

106  
	`__butš___¡ºıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dest));

107 
	}
}

110 *
	$__¡²ıy_chk
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
,

111 
size_t
 
__de¡Ën
è
__THROW
;

112 *
	`__REDIRECT_NTH
 (
__¡²ıy_®Ÿs
, (*
__de¡
, cÚ¡ *
__¤c
,

113 
size_t
 
__n
), 
¡²ıy
);

115 
__fÜtify_funùiÚ
 *

116 
	`__NTH
 (
	$¡²ıy
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
))

118 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1

119 && (!
	`__butš_cÚ¡ªt_p
 (
__n
è|| __À> 
	`__bos
 (
__de¡
)))

120  
	`__¡²ıy_chk
 (
__de¡
, 
__¤c
, 
__n
, 
	`__bos
 (__dest));

121  
	`__¡²ıy_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

122 
	}
}

125 
__fÜtify_funùiÚ
 *

126 
__NTH
 (
	$¡rÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
))

128  
	`__butš___¡rÿt_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

129 
	}
}

132 
__fÜtify_funùiÚ
 *

133 
__NTH
 (
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

134 
size_t
 
__Ën
))

136  
	`__butš___¡ºÿt_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dest));

137 
	}
}

	@/usr/include/bits/types/locale_t.h

19 #iâdeà
_BITS_TYPES_LOCALE_T_H


20 
	#_BITS_TYPES_LOCALE_T_H
 1

	)

22 
	~<b™s/ty³s/__loÿË_t.h
>

24 
__loÿË_t
 
	tloÿË_t
;

	@/usr/include/gnu/stubs.h

6 #ià!
defšed
 
__x86_64__


7 
	~<gnu/¡ubs-32.h
>

9 #ià
defšed
 
__x86_64__
 && defšed 
__LP64__


10 
	~<gnu/¡ubs-64.h
>

12 #ià
defšed
 
__x86_64__
 && defšed 
__ILP32__


13 
	~<gnu/¡ubs-x32.h
>

	@/usr/include/linux/byteorder/little_endian.h

2 #iâdeà
_LINUX_BYTEORDER_LITTLE_ENDIAN_H


3 
	#_LINUX_BYTEORDER_LITTLE_ENDIAN_H


	)

5 #iâdeà
__LITTLE_ENDIAN


6 
	#__LITTLE_ENDIAN
 1234

	)

8 #iâdeà
__LITTLE_ENDIAN_BITFIELD


9 
	#__LITTLE_ENDIAN_BITFIELD


	)

12 
	~<lšux/ty³s.h
>

13 
	~<lšux/swab.h
>

15 
	#__cÚ¡ªt_htÚl
(
x
è((
__be32
)
	`___cÚ¡ªt_swab32
((x)))

	)

16 
	#__cÚ¡ªt_Áohl
(
x
è
	`___cÚ¡ªt_swab32
((
__be32
)(x))

	)

17 
	#__cÚ¡ªt_htÚs
(
x
è((
__be16
)
	`___cÚ¡ªt_swab16
((x)))

	)

18 
	#__cÚ¡ªt_Áohs
(
x
è
	`___cÚ¡ªt_swab16
((
__be16
)(x))

	)

19 
	#__cÚ¡ªt_ıu_to_Ë64
(
x
è((
__Ë64
)(
__u64
)(x))

	)

20 
	#__cÚ¡ªt_Ë64_to_ıu
(
x
è((
__u64
)(
__Ë64
)(x))

	)

21 
	#__cÚ¡ªt_ıu_to_Ë32
(
x
è((
__Ë32
)(
__u32
)(x))

	)

22 
	#__cÚ¡ªt_Ë32_to_ıu
(
x
è((
__u32
)(
__Ë32
)(x))

	)

23 
	#__cÚ¡ªt_ıu_to_Ë16
(
x
è((
__Ë16
)(
__u16
)(x))

	)

24 
	#__cÚ¡ªt_Ë16_to_ıu
(
x
è((
__u16
)(
__Ë16
)(x))

	)

25 
	#__cÚ¡ªt_ıu_to_be64
(
x
è((
__be64
)
	`___cÚ¡ªt_swab64
((x)))

	)

26 
	#__cÚ¡ªt_be64_to_ıu
(
x
è
	`___cÚ¡ªt_swab64
((
__u64
)(
__be64
)(x))

	)

27 
	#__cÚ¡ªt_ıu_to_be32
(
x
è((
__be32
)
	`___cÚ¡ªt_swab32
((x)))

	)

28 
	#__cÚ¡ªt_be32_to_ıu
(
x
è
	`___cÚ¡ªt_swab32
((
__u32
)(
__be32
)(x))

	)

29 
	#__cÚ¡ªt_ıu_to_be16
(
x
è((
__be16
)
	`___cÚ¡ªt_swab16
((x)))

	)

30 
	#__cÚ¡ªt_be16_to_ıu
(
x
è
	`___cÚ¡ªt_swab16
((
__u16
)(
__be16
)(x))

	)

31 
	#__ıu_to_Ë64
(
x
è((
__Ë64
)(
__u64
)(x))

	)

32 
	#__Ë64_to_ıu
(
x
è((
__u64
)(
__Ë64
)(x))

	)

33 
	#__ıu_to_Ë32
(
x
è((
__Ë32
)(
__u32
)(x))

	)

34 
	#__Ë32_to_ıu
(
x
è((
__u32
)(
__Ë32
)(x))

	)

35 
	#__ıu_to_Ë16
(
x
è((
__Ë16
)(
__u16
)(x))

	)

36 
	#__Ë16_to_ıu
(
x
è((
__u16
)(
__Ë16
)(x))

	)

37 
	#__ıu_to_be64
(
x
è((
__be64
)
	`__swab64
((x)))

	)

38 
	#__be64_to_ıu
(
x
è
	`__swab64
((
__u64
)(
__be64
)(x))

	)

39 
	#__ıu_to_be32
(
x
è((
__be32
)
	`__swab32
((x)))

	)

40 
	#__be32_to_ıu
(
x
è
	`__swab32
((
__u32
)(
__be32
)(x))

	)

41 
	#__ıu_to_be16
(
x
è((
__be16
)
	`__swab16
((x)))

	)

42 
	#__be16_to_ıu
(
x
è
	`__swab16
((
__u16
)(
__be16
)(x))

	)

44 
__®ways_šlše
 
__Ë64
 
	$__ıu_to_Ë64p
(cÚ¡ 
__u64
 *
p
)

46  (
__Ë64
)*
p
;

47 
	}
}

48 
__®ways_šlše
 
__u64
 
	$__Ë64_to_ıup
(cÚ¡ 
__Ë64
 *
p
)

50  (
__u64
)*
p
;

51 
	}
}

52 
__®ways_šlše
 
__Ë32
 
	$__ıu_to_Ë32p
(cÚ¡ 
__u32
 *
p
)

54  (
__Ë32
)*
p
;

55 
	}
}

56 
__®ways_šlše
 
__u32
 
	$__Ë32_to_ıup
(cÚ¡ 
__Ë32
 *
p
)

58  (
__u32
)*
p
;

59 
	}
}

60 
__®ways_šlše
 
__Ë16
 
	$__ıu_to_Ë16p
(cÚ¡ 
__u16
 *
p
)

62  (
__Ë16
)*
p
;

63 
	}
}

64 
__®ways_šlše
 
__u16
 
	$__Ë16_to_ıup
(cÚ¡ 
__Ë16
 *
p
)

66  (
__u16
)*
p
;

67 
	}
}

68 
__®ways_šlše
 
__be64
 
	$__ıu_to_be64p
(cÚ¡ 
__u64
 *
p
)

70  (
__be64
)
	`__swab64p
(
p
);

71 
	}
}

72 
__®ways_šlše
 
__u64
 
	$__be64_to_ıup
(cÚ¡ 
__be64
 *
p
)

74  
	`__swab64p
((
__u64
 *)
p
);

75 
	}
}

76 
__®ways_šlše
 
__be32
 
	$__ıu_to_be32p
(cÚ¡ 
__u32
 *
p
)

78  (
__be32
)
	`__swab32p
(
p
);

79 
	}
}

80 
__®ways_šlše
 
__u32
 
	$__be32_to_ıup
(cÚ¡ 
__be32
 *
p
)

82  
	`__swab32p
((
__u32
 *)
p
);

83 
	}
}

84 
__®ways_šlše
 
__be16
 
	$__ıu_to_be16p
(cÚ¡ 
__u16
 *
p
)

86  (
__be16
)
	`__swab16p
(
p
);

87 
	}
}

88 
__®ways_šlše
 
__u16
 
	$__be16_to_ıup
(cÚ¡ 
__be16
 *
p
)

90  
	`__swab16p
((
__u16
 *)
p
);

91 
	}
}

92 
	#__ıu_to_Ë64s
(
x
èdØ{ ()(x); } 0)

	)

93 
	#__Ë64_to_ıus
(
x
èdØ{ ()(x); } 0)

	)

94 
	#__ıu_to_Ë32s
(
x
èdØ{ ()(x); } 0)

	)

95 
	#__Ë32_to_ıus
(
x
èdØ{ ()(x); } 0)

	)

96 
	#__ıu_to_Ë16s
(
x
èdØ{ ()(x); } 0)

	)

97 
	#__Ë16_to_ıus
(
x
èdØ{ ()(x); } 0)

	)

98 
	#__ıu_to_be64s
(
x
è
	`__swab64s
((x))

	)

99 
	#__be64_to_ıus
(
x
è
	`__swab64s
((x))

	)

100 
	#__ıu_to_be32s
(
x
è
	`__swab32s
((x))

	)

101 
	#__be32_to_ıus
(
x
è
	`__swab32s
((x))

	)

102 
	#__ıu_to_be16s
(
x
è
	`__swab16s
((x))

	)

103 
	#__be16_to_ıus
(
x
è
	`__swab16s
((x))

	)

	@/usr/include/linux/stddef.h

4 #iâdeà
__®ways_šlše


5 
	#__®ways_šlše
 
__šlše__


	)

	@/usr/include/stdc-predef.h

18 #iâdef 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifdeà
__GCC_IEC_559


37 #ià
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifdeà
__GCC_IEC_559_COMPLEX


45 #ià
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

58 
	#__STDC_ISO_10646__
 201706L

	)

61 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/strings.h

18 #iâdef 
_STRINGS_H


19 
	#_STRINGS_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	#__Ãed_size_t


	)

23 
	~<¡ddef.h
>

26 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

27 
	#__CORRECT_ISO_CPP_STRINGS_H_PROTO


	)

30 
	g__BEGIN_DECLS


32 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8


34 
	$bcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

35 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

38 
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__n
)

39 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

42 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

45 #ifdeà
__CORRECT_ISO_CPP_STRINGS_H_PROTO


48 *
	`šdex
 (*
__s
, 
__c
)

49 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

50 cÚ¡ *
	`šdex
 (cÚ¡ *
__s
, 
__c
)

51 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

53 #ià
defšed
 
__OPTIMIZE__


54 
__ex‹º_®ways_šlše
 *

55 
	`šdex
 (*
__s
, 
__c
è
__THROW


57  
	`__butš_šdex
 (
__s
, 
__c
);

60 
__ex‹º_®ways_šlše
 const *

61 
	`šdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


63  
	`__butš_šdex
 (
__s
, 
__c
);

66 
	}
}

68 *
	$šdex
 (cÚ¡ *
__s
, 
__c
)

69 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

73 #ifdeà
__CORRECT_ISO_CPP_STRINGS_H_PROTO


76 *
	`ršdex
 (*
__s
, 
__c
)

77 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

78 cÚ¡ *
	`ršdex
 (cÚ¡ *
__s
, 
__c
)

79 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

81 #ià
defšed
 
__OPTIMIZE__


82 
__ex‹º_®ways_šlše
 *

83 
	`ršdex
 (*
__s
, 
__c
è
__THROW


85  
	`__butš_ršdex
 (
__s
, 
__c
);

88 
__ex‹º_®ways_šlše
 const *

89 
	`ršdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


91  
	`__butš_ršdex
 (
__s
, 
__c
);

94 
	}
}

96 *
	$ršdex
 (cÚ¡ *
__s
, 
__c
)

97 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

101 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8
 || defšed 
__USE_XOPEN2K8XSI


104 
	$ffs
 (
__i
è
__THROW
 
__©Œibu‹_cÚ¡__
;

109 #ifdef 
__USE_MISC


110 
	$ff¦
 (
__l
è
__THROW
 
__©Œibu‹_cÚ¡__
;

111 
__ex‹nsiÚ__
 
	$ff¦l
 (
__Î
)

112 
__THROW
 
__©Œibu‹_cÚ¡__
;

116 
	$¡rÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

117 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

120 
	$¡ºÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

121 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

123 #ifdef 
__USE_XOPEN2K8


125 
	~<b™s/ty³s/loÿË_t.h
>

128 
	$¡rÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
loÿË_t
 
__loc
)

129 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

133 
	$¡ºÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

134 
size_t
 
__n
, 
loÿË_t
 
__loc
)

135 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

138 
__END_DECLS


140 #ià
	`__GNUC_PREREQ
 (3,4è&& 
__USE_FORTIFY_LEVEL
 > 0 \

141 && 
defšed
 
__fÜtify_funùiÚ


143 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8


144 
	~<b™s/¡ršgs_fÜtif›d.h
>

	@/usr/include/sys/cdefs.h

18 #iâdef 
_SYS_CDEFS_H


19 
	#_SYS_CDEFS_H
 1

	)

22 #iâdeà
_FEATURES_H


23 
	~<ã©u»s.h
>

29 #ià
defšed
 
__GNUC__
 && !defšed 
__STDC__


34 #undeà
__P


35 #undeà
__PMT


37 #ifdeà
__GNUC__


41 #ià
__GNUC_PREREQ
 (4, 6è&& !
defšed
 
_LIBC


42 
	#__LEAF
 , 
__Ëaf__


	)

43 
	#__LEAF_ATTR
 
	`__©Œibu‹__
 ((
__Ëaf__
))

	)

45 
	#__LEAF


	)

46 
	#__LEAF_ATTR


	)

54 #ià!
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (3, 3)

55 
	#__THROW
 
	`__©Œibu‹__
 ((
__nÙhrow__
 
__LEAF
))

	)

56 
	#__THROWNL
 
	`__©Œibu‹__
 ((
__nÙhrow__
))

	)

57 
	#__NTH
(
fù
è
	`__©Œibu‹__
 ((
__nÙhrow__
 
__LEAF
)è
	)
fct

58 
	#__NTHNL
(
fù
è
	`__©Œibu‹__
 ((
__nÙhrow__
)è
	)
fct

60 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

61 
	#__THROW
 
	`throw
 ()

	)

62 
	#__THROWNL
 
	`throw
 ()

	)

63 
	#__NTH
(
fù
è
__LEAF_ATTR
 fù 
	`throw
 ()

	)

64 
	#__NTHNL
(
fù
èfù 
	`throw
 ()

	)

66 
	#__THROW


	)

67 
	#__THROWNL


	)

68 
	#__NTH
(
fù
è
	)
fct

69 
	#__NTHNL
(
fù
è
	)
fct

75 
	#__šlše


	)

77 
	#__THROW


	)

78 
	#__THROWNL


	)

79 
	#__NTH
(
fù
è
	)
fct

86 #ià
defšed
 
__şªg__
 && defšed 
__has_ex‹nsiÚ


87 
	#__glibc_şªg_has_ex‹nsiÚ
(
ext
è
	`__has_ex‹nsiÚ
 (ext)

	)

89 
	#__glibc_şªg_has_ex‹nsiÚ
(
ext
è0

	)

94 
	#__P
(
¬gs
è
	)
args

95 
	#__PMT
(
¬gs
è
	)
args

100 
	#__CONCAT
(
x
,
y
èx ## 
	)
y

101 
	#__STRING
(
x
è#x

	)

104 
	#__±r_t
 *

	)

108 #ifdef 
__ılu¥lus


109 
	#__BEGIN_DECLS
 "C" {

	)

110 
	#__END_DECLS
 }

	)

112 
	#__BEGIN_DECLS


	)

113 
	#__END_DECLS


	)

118 
	#__bos
(
±r
è
	`__butš_objeù_size
 (±r, 
__USE_FORTIFY_LEVEL
 > 1)

	)

119 
	#__bos0
(
±r
è
	`__butš_objeù_size
 (±r, 0)

	)

121 #ià
__GNUC_PREREQ
 (4,3)

122 
	#__w¬ndeş
(
Çme
, 
msg
) \

123 
	`Çme
 (è
	`__©Œibu‹__
((
	`__w¬nšg__
 (
msg
)))

	)

124 
	#__w¬Ç‰r
(
msg
è
	`__©Œibu‹__
((
	`__w¬nšg__
 (msg)))

	)

125 
	#__”rÜdeş
(
Çme
, 
msg
) \

126 
	`Çme
 (è
	`__©Œibu‹__
((
	`__”rÜ__
 (
msg
)))

	)

128 
	#__w¬ndeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

129 
	#__w¬Ç‰r
(
msg
)

	)

130 
	#__”rÜdeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

137 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

138 
	#__æex¬r
 []

	)

139 
	#__glibc_c99_æex¬r_avaabË
 1

	)

140 #–ià
__GNUC_PREREQ
 (2,97)

143 
	#__æex¬r
 []

	)

144 
	#__glibc_c99_æex¬r_avaabË
 1

	)

145 #–ià
defšed
 
__GNUC__


148 
	#__æex¬r
 [0]

	)

149 
	#__glibc_c99_æex¬r_avaabË
 1

	)

152 
	#__æex¬r
 [1]

	)

153 
	#__glibc_c99_æex¬r_avaabË
 0

	)

167 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

169 
	#__REDIRECT
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

170 #ifdeà
__ılu¥lus


171 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

172 
Çme
 
´Ùo
 
__THROW
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

173 
	#__REDIRECT_NTHNL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

174 
Çme
 
´Ùo
 
__THROWNL
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

176 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

177 
Çme
 
´Ùo
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs)è
__THROW


	)

178 
	#__REDIRECT_NTHNL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

179 
Çme
 
´Ùo
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs)è
__THROWNL


	)

181 
	#__ASMNAME
(
úame
è
	`__ASMNAME2
 (
__USER_LABEL_PREFIX__
, cÇme)

	)

182 
	#__ASMNAME2
(
´efix
, 
úame
è
	`__STRING
 (´efixè
	)
cname

195 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

196 
	#__©Œibu‹__
(
xyz
è

	)

202 #ià
__GNUC_PREREQ
 (2,96)

203 
	#__©Œibu‹_m®loc__
 
	`__©Œibu‹__
 ((
__m®loc__
))

	)

205 
	#__©Œibu‹_m®loc__


	)

210 #ià
__GNUC_PREREQ
 (4, 3)

211 
	#__©Œibu‹_®loc_size__
(
·¿ms
) \

212 
	`__©Œibu‹__
 ((
__®loc_size__
 
·¿ms
))

	)

214 
	#__©Œibu‹_®loc_size__
(
·¿ms
è

	)

220 #ià
__GNUC_PREREQ
 (2,96)

221 
	#__©Œibu‹_pu»__
 
	`__©Œibu‹__
 ((
__pu»__
))

	)

223 
	#__©Œibu‹_pu»__


	)

227 #ià
__GNUC_PREREQ
 (2,5)

228 
	#__©Œibu‹_cÚ¡__
 
	`__©Œibu‹__
 ((
__cÚ¡__
))

	)

230 
	#__©Œibu‹_cÚ¡__


	)

236 #ià
__GNUC_PREREQ
 (3,1)

237 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__u£d__
))

	)

238 
	#__©Œibu‹_nošlše__
 
	`__©Œibu‹__
 ((
__nošlše__
))

	)

240 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__unu£d__
))

	)

241 
	#__©Œibu‹_nošlše__


	)

245 #ià
__GNUC_PREREQ
 (3,2)

246 
	#__©Œibu‹_d•»ÿ‹d__
 
	`__©Œibu‹__
 ((
__d•»ÿ‹d__
))

	)

248 
	#__©Œibu‹_d•»ÿ‹d__


	)

254 #ià
__GNUC_PREREQ
 (4,5) || \

255 
	$__glibc_şªg_has_ex‹nsiÚ
 (
__©Œibu‹_d•»ÿ‹d_w™h_mes§ge__
)

256 
	#__©Œibu‹_d•»ÿ‹d_msg__
(
msg
) \

257 
	`__©Œibu‹__
 ((
	`__d•»ÿ‹d__
 (
msg
)))

	)

259 
	#__©Œibu‹_d•»ÿ‹d_msg__
(
msg
è
__©Œibu‹_d•»ÿ‹d__


	)

268 #ià
	`__GNUC_PREREQ
 (2,8)

269 
	#__©Œibu‹_fÜm©_¬g__
(
x
è
	`__©Œibu‹__
 ((
	`__fÜm©_¬g__
 (x)))

	)

271 
	#__©Œibu‹_fÜm©_¬g__
(
x
è

	)

278 #ià
	`__GNUC_PREREQ
 (2,97)

279 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
) \

280 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__¡rfmÚ__
, 
a
, 
b
)))

	)

282 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
è

	)

287 #ià
	`__GNUC_PREREQ
 (3,3)

288 
	#__nÚnuÎ
(
·¿ms
è
	`__©Œibu‹__
 ((
__nÚnuÎ__
…¬ams))

	)

290 
	#__nÚnuÎ
(
·¿ms
)

	)

295 #ià
	`__GNUC_PREREQ
 (3,4)

296 
	#__©Œibu‹_w¬n_unu£d_»suÉ__
 \

297 
	`__©Œibu‹__
 ((
__w¬n_unu£d_»suÉ__
))

	)

298 #ià
__USE_FORTIFY_LEVEL
 > 0

299 
	#__wur
 
__©Œibu‹_w¬n_unu£d_»suÉ__


	)

302 
	#__©Œibu‹_w¬n_unu£d_»suÉ__


	)

304 #iâdeà
__wur


305 
	#__wur


	)

309 #ià
	`__GNUC_PREREQ
 (3,2)

313 #undeà
__®ways_šlše


314 
	#__®ways_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__®ways_šlše__
))

	)

316 #undeà
__®ways_šlše


317 
	#__®ways_šlše
 
__šlše


	)

322 #ià
	`__GNUC_PREREQ
 (4,3)

323 
	#__©Œibu‹_¬tificŸl__
 
	`__©Œibu‹__
 ((
__¬tificŸl__
))

	)

325 
	#__©Œibu‹_¬tificŸl__


	)

337 #ià(!
defšed
 
__ılu¥lus
 || 
	`__GNUC_PREREQ
 (4,3) \

338 || (
defšed
 
__şªg__
 && (defšed 
__GNUC_STDC_INLINE__
 \

339 || 
defšed
 
__GNUC_GNU_INLINE__
)))

340 #ià
defšed
 
__GNUC_STDC_INLINE__
 || defšed 
__ılu¥lus


341 
	#__ex‹º_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

342 
	#__ex‹º_®ways_šlše
 \

343 
__®ways_šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

345 
	#__ex‹º_šlše
 
__šlše


	)

346 
	#__ex‹º_®ways_šlše
 
__®ways_šlše


	)

350 #ifdeà
__ex‹º_®ways_šlše


351 
	#__fÜtify_funùiÚ
 
__ex‹º_®ways_šlše
 
__©Œibu‹_¬tificŸl__


	)

356 #ià
	`__GNUC_PREREQ
 (4,3)

357 
	#__va_¬g_·ck
(è
	`__butš_va_¬g_·ck
 ()

	)

358 
	#__va_¬g_·ck_Ën
(è
	`__butš_va_¬g_·ck_Ën
 ()

	)

365 #ià!
	`__GNUC_PREREQ
 (2,8)

366 
	#__ex‹nsiÚ__


	)

370 #ià!
	`__GNUC_PREREQ
 (2,92)

371 
	#__»¡riù


	)

377 #ià
	`__GNUC_PREREQ
 (3,1è&& !
defšed
 
__GNUG__


378 
	#__»¡riù_¬r
 
__»¡riù


	)

380 #ifdeà
__GNUC__


381 
	#__»¡riù_¬r


	)

383 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

384 
	#__»¡riù_¬r
 
»¡riù


	)

387 
	#__»¡riù_¬r


	)

392 #ià
__GNUC__
 >= 3

393 
	#__glibc_uÆik–y
(
cÚd
è
	`__butš_ex³ù
 ((cÚd), 0)

	)

394 
	#__glibc_lik–y
(
cÚd
è
	`__butš_ex³ù
 ((cÚd), 1)

	)

396 
	#__glibc_uÆik–y
(
cÚd
è(cÚd)

	)

397 
	#__glibc_lik–y
(
cÚd
è(cÚd)

	)

400 #ià(!
defšed
 
_NÜ‘uº
 \

401 && (
defšed
 
__STDC_VERSION__
 ? __STDC_VERSION__ : 0) < 201112 \

402 && !
	$__GNUC_PREREQ
 (4,7))

403 #ià
	`__GNUC_PREREQ
 (2,8)

404 
	#_NÜ‘uº
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
))

	)

406 
	#_NÜ‘uº


	)

410 #ià
	`__GNUC_PREREQ
 (8, 0)

414 
	#__©Œibu‹_nÚ¡ršg__
 
	`__©Œibu‹__
 ((
__nÚ¡ršg__
))

	)

416 
	#__©Œibu‹_nÚ¡ršg__


	)

419 #ià(!
defšed
 
_Stic_as£¹
 && !defšed 
__ılu¥lus
 \

420 && (
defšed
 
__STDC_VERSION__
 ? __STDC_VERSION__ : 0) < 201112 \

421 && (!
	`__GNUC_PREREQ
 (4, 6è|| 
defšed
 
__STRICT_ANSI__
))

422 
	#_Stic_as£¹
(
ex´
, 
dŸgno¡ic
) \

423 (*
	`__Stic_as£¹_funùiÚ
 ()) \

424 [!! (¡ruù { 
__”rÜ_if_Ãg©ive
: (
ex´
è? 2 : -1; })]

	)

427 
	~<b™s/wÜdsize.h
>

428 
	~<b™s/lÚg-doubË.h
>

430 #ià
defšed
 
__LONG_DOUBLE_MATH_OPTIONAL
 && defšed 
__NO_LONG_DOUBLE_MATH


431 
	#__LDBL_COMPAT
 1

	)

432 #ifdeà
__REDIRECT


433 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

434 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
) \

435 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

436 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT_NTH
 (Çme,…rÙo,‡lŸs)

	)

437 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
) \

438 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

439 
	#__LDBL_REDIR1_DECL
(
Çme
, 
®Ÿs
) \

440 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 (#®Ÿs));

	)

441 
	#__LDBL_REDIR_DECL
(
Çme
) \

442 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 ("__Ædbl_" #Çme));

	)

443 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

444 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

445 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

446 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

449 #ià!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT


450 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm
	)
proto

451 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
èÇm
	)
proto

452 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
__THROW


	)

453 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
èÇm´ÙØ
__THROW


	)

454 
	#__LDBL_REDIR_DECL
(
Çme
)

	)

455 #ifdeà
__REDIRECT


456 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

457 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

458 
	`__REDIRECT_NTH
 (
Çme
, 
´Ùo
, 
®Ÿs
)

	)

467 #ià
	`__GNUC_PREREQ
 (4,8è|| 
	`__glibc_şªg_´”eq
 (3,5)

468 
	#__glibc_maüo_w¬nšg1
(
mes§ge
è
	`_P¿gma
 (#mes§ge)

	)

469 
	#__glibc_maüo_w¬nšg
(
mes§ge
) \

470 
	`__glibc_maüo_w¬nšg1
 (
GCC
 
w¬nšg
 
mes§ge
)

	)

472 
	#__glibc_maüo_w¬nšg
(
msg
)

	)

482 #ià!
defšed
 
__ılu¥lus
 \

483 && (
	`__GNUC_PREREQ
 (4, 9) \

484 || 
	`__glibc_şªg_has_ex‹nsiÚ
 (
c_g’”ic_£ËùiÚs
) \

485 || (!
defšed
 
__GNUC__
 && defšed 
__STDC_VERSION__
 \

486 && 
__STDC_VERSION__
 >= 201112L))

487 
	#__HAVE_GENERIC_SELECTION
 1

	)

489 
	#__HAVE_GENERIC_SELECTION
 0

	)

	@/usr/include/sys/types.h

22 #iâdef 
_SYS_TYPES_H


23 
	#_SYS_TYPES_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/ty³s.h
>

31 #ifdef 
__USE_MISC


32 #iâdeà
__u_ch¬_defšed


33 
__u_ch¬
 
	tu_ch¬
;

34 
__u_shÜt
 
	tu_shÜt
;

35 
__u_št
 
	tu_št
;

36 
__u_lÚg
 
	tu_lÚg
;

37 
__quad_t
 
	tquad_t
;

38 
__u_quad_t
 
	tu_quad_t
;

39 
__fsid_t
 
	tfsid_t
;

40 
	#__u_ch¬_defšed


	)

44 
__loff_t
 
	tloff_t
;

46 #iâdeà
__šo_t_defšed


47 #iâdeà
__USE_FILE_OFFSET64


48 
__šo_t
 
	tšo_t
;

50 
__šo64_t
 
	tšo_t
;

52 
	#__šo_t_defšed


	)

54 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__šo64_t_defšed


55 
__šo64_t
 
	tšo64_t
;

56 
	#__šo64_t_defšed


	)

59 #iâdeà
__dev_t_defšed


60 
__dev_t
 
	tdev_t
;

61 
	#__dev_t_defšed


	)

64 #iâdeà
__gid_t_defšed


65 
__gid_t
 
	tgid_t
;

66 
	#__gid_t_defšed


	)

69 #iâdeà
__mode_t_defšed


70 
__mode_t
 
	tmode_t
;

71 
	#__mode_t_defšed


	)

74 #iâdeà
__Æšk_t_defšed


75 
__Æšk_t
 
	tÆšk_t
;

76 
	#__Æšk_t_defšed


	)

79 #iâdeà
__uid_t_defšed


80 
__uid_t
 
	tuid_t
;

81 
	#__uid_t_defšed


	)

84 #iâdeà
__off_t_defšed


85 #iâdeà
__USE_FILE_OFFSET64


86 
__off_t
 
	toff_t
;

88 
__off64_t
 
	toff_t
;

90 
	#__off_t_defšed


	)

92 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


93 
__off64_t
 
	toff64_t
;

94 
	#__off64_t_defšed


	)

97 #iâdeà
__pid_t_defšed


98 
__pid_t
 
	tpid_t
;

99 
	#__pid_t_defšed


	)

102 #ià(
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8
) \

103 && !
defšed
 
__id_t_defšed


104 
__id_t
 
	tid_t
;

105 
	#__id_t_defšed


	)

108 #iâdeà
__ssize_t_defšed


109 
__ssize_t
 
	tssize_t
;

110 
	#__ssize_t_defšed


	)

113 #ifdef 
__USE_MISC


114 #iâdeà
__daddr_t_defšed


115 
__daddr_t
 
	tdaddr_t
;

116 
__ÿddr_t
 
	tÿddr_t
;

117 
	#__daddr_t_defšed


	)

121 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN
è&& !defšed 
__key_t_defšed


122 
__key_t
 
	tkey_t
;

123 
	#__key_t_defšed


	)

126 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


127 
	~<b™s/ty³s/şock_t.h
>

129 
	~<b™s/ty³s/şockid_t.h
>

130 
	~<b™s/ty³s/time_t.h
>

131 
	~<b™s/ty³s/tim”_t.h
>

133 #ifdeà
__USE_XOPEN


134 #iâdeà
__u£cÚds_t_defšed


135 
__u£cÚds_t
 
	tu£cÚds_t
;

136 
	#__u£cÚds_t_defšed


	)

138 #iâdeà
__su£cÚds_t_defšed


139 
__su£cÚds_t
 
	tsu£cÚds_t
;

140 
	#__su£cÚds_t_defšed


	)

144 
	#__Ãed_size_t


	)

145 
	~<¡ddef.h
>

147 #ifdeà
__USE_MISC


149 
	tulÚg
;

150 
	tushÜt
;

151 
	tušt
;

156 
	~<b™s/¡dšt-šŠ.h
>

158 #ià!
__GNUC_PREREQ
 (2, 7)

161 
	tu_št8_t
;

162 
	tu_št16_t
;

163 
	tu_št32_t
;

164 #ià
__WORDSIZE
 == 64

165 
	tu_št64_t
;

167 
__ex‹nsiÚ__
 
	tu_št64_t
;

170 
	t»gi¡”_t
;

175 
	#__u_štN_t
(
N
, 
MODE
) \

176 
	tu_št
##
	tN
##
	t_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	tMODE
)))

	)

178 
	t__u_štN_t
 (8, 
	t__QI__
);

179 
__u_štN_t
 (16, 
__HI__
);

180 
__u_štN_t
 (32, 
__SI__
);

181 
__u_štN_t
 (64, 
__DI__
);

183 
	t»gi¡”_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__wÜd__
)));

189 
	#__BIT_TYPES_DEFINED__
 1

	)

192 #ifdef 
__USE_MISC


194 
	~<’dŸn.h
>

197 
	~<sys/£Ëù.h
>

204 
	#__SYSMACROS_DEPRECATED_INCLUSION


	)

205 
	~<sys/sysmaüos.h
>

206 #undeà
__SYSMACROS_DEPRECATED_INCLUSION


210 #ià(
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8
) \

211 && !
defšed
 
__blksize_t_defšed


212 
__blksize_t
 
	tblksize_t
;

213 
	#__blksize_t_defšed


	)

217 #iâdeà
__USE_FILE_OFFSET64


218 #iâdeà
__blkút_t_defšed


219 
__blkút_t
 
	tblkút_t
;

220 
	#__blkút_t_defšed


	)

222 #iâdeà
__fsblkút_t_defšed


223 
__fsblkút_t
 
	tfsblkút_t
;

224 
	#__fsblkút_t_defšed


	)

226 #iâdeà
__fsfút_t_defšed


227 
__fsfút_t
 
	tfsfút_t
;

228 
	#__fsfút_t_defšed


	)

231 #iâdeà
__blkút_t_defšed


232 
__blkút64_t
 
	tblkút_t
;

233 
	#__blkút_t_defšed


	)

235 #iâdeà
__fsblkút_t_defšed


236 
__fsblkút64_t
 
	tfsblkút_t
;

237 
	#__fsblkút_t_defšed


	)

239 #iâdeà
__fsfút_t_defšed


240 
__fsfút64_t
 
	tfsfút_t
;

241 
	#__fsfút_t_defšed


	)

245 #ifdeà
__USE_LARGEFILE64


246 
__blkút64_t
 
	tblkút64_t
;

247 
__fsblkút64_t
 
	tfsblkút64_t
;

248 
__fsfút64_t
 
	tfsfút64_t
;

253 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


254 
	~<b™s/±h»adty³s.h
>

257 
	g__END_DECLS


	@/usr/include/asm-generic/errno-base.h

2 #iâdeà
_ASM_GENERIC_ERRNO_BASE_H


3 
	#_ASM_GENERIC_ERRNO_BASE_H


	)

5 
	#EPERM
 1

	)

6 
	#ENOENT
 2

	)

7 
	#ESRCH
 3

	)

8 
	#EINTR
 4

	)

9 
	#EIO
 5

	)

10 
	#ENXIO
 6

	)

11 
	#E2BIG
 7

	)

12 
	#ENOEXEC
 8

	)

13 
	#EBADF
 9

	)

14 
	#ECHILD
 10

	)

15 
	#EAGAIN
 11

	)

16 
	#ENOMEM
 12

	)

17 
	#EACCES
 13

	)

18 
	#EFAULT
 14

	)

19 
	#ENOTBLK
 15

	)

20 
	#EBUSY
 16

	)

21 
	#EEXIST
 17

	)

22 
	#EXDEV
 18

	)

23 
	#ENODEV
 19

	)

24 
	#ENOTDIR
 20

	)

25 
	#EISDIR
 21

	)

26 
	#EINVAL
 22

	)

27 
	#ENFILE
 23

	)

28 
	#EMFILE
 24

	)

29 
	#ENOTTY
 25

	)

30 
	#ETXTBSY
 26

	)

31 
	#EFBIG
 27

	)

32 
	#ENOSPC
 28

	)

33 
	#ESPIPE
 29

	)

34 
	#EROFS
 30

	)

35 
	#EMLINK
 31

	)

36 
	#EPIPE
 32

	)

37 
	#EDOM
 33

	)

38 
	#ERANGE
 34

	)

	@/usr/include/asm-generic/int-ll64.h

9 #iâdeà
_ASM_GENERIC_INT_LL64_H


10 
	#_ASM_GENERIC_INT_LL64_H


	)

12 
	~<asm/b™¥”lÚg.h
>

14 #iâdeà
__ASSEMBLY__


20 
__sigÃd__
 
	t__s8
;

21 
	t__u8
;

23 
__sigÃd__
 
	t__s16
;

24 
	t__u16
;

26 
__sigÃd__
 
	t__s32
;

27 
	t__u32
;

29 #ifdeà
__GNUC__


30 
__ex‹nsiÚ__
 
__sigÃd__
 
	t__s64
;

31 
__ex‹nsiÚ__
 
	t__u64
;

33 
__sigÃd__
 
	t__s64
;

34 
	t__u64
;

	@/usr/include/asm-generic/ioctl.h

2 #iâdeà
_ASM_GENERIC_IOCTL_H


3 
	#_ASM_GENERIC_IOCTL_H


	)

23 
	#_IOC_NRBITS
 8

	)

24 
	#_IOC_TYPEBITS
 8

	)

31 #iâdeà
_IOC_SIZEBITS


32 
	#_IOC_SIZEBITS
 14

	)

35 #iâdeà
_IOC_DIRBITS


36 
	#_IOC_DIRBITS
 2

	)

39 
	#_IOC_NRMASK
 ((1 << 
_IOC_NRBITS
)-1)

	)

40 
	#_IOC_TYPEMASK
 ((1 << 
_IOC_TYPEBITS
)-1)

	)

41 
	#_IOC_SIZEMASK
 ((1 << 
_IOC_SIZEBITS
)-1)

	)

42 
	#_IOC_DIRMASK
 ((1 << 
_IOC_DIRBITS
)-1)

	)

44 
	#_IOC_NRSHIFT
 0

	)

45 
	#_IOC_TYPESHIFT
 (
_IOC_NRSHIFT
+
_IOC_NRBITS
)

	)

46 
	#_IOC_SIZESHIFT
 (
_IOC_TYPESHIFT
+
_IOC_TYPEBITS
)

	)

47 
	#_IOC_DIRSHIFT
 (
_IOC_SIZESHIFT
+
_IOC_SIZEBITS
)

	)

57 #iâdeà
_IOC_NONE


58 
	#_IOC_NONE
 0U

	)

61 #iâdeà
_IOC_WRITE


62 
	#_IOC_WRITE
 1U

	)

65 #iâdeà
_IOC_READ


66 
	#_IOC_READ
 2U

	)

69 
	#_IOC
(
dœ
,
ty³
,
Ä
,
size
) \

70 (((
dœ
è<< 
_IOC_DIRSHIFT
) | \

71 ((
ty³
è<< 
_IOC_TYPESHIFT
) | \

72 ((
Ä
è<< 
_IOC_NRSHIFT
) | \

73 ((
size
è<< 
_IOC_SIZESHIFT
))

	)

75 
	#_IOC_TYPECHECK
(
t
è(Ñ))

	)

83 
	#_IO
(
ty³
,
Ä
è
	`_IOC
(
_IOC_NONE
,Ñy³),Òr),0)

	)

84 
	#_IOR
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

85 
	#_IOW
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_WRITE
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

86 
	#_IOWR
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

87 
	#_IOR_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
,Ñy³),Òr),(size))

	)

88 
	#_IOW_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_WRITE
,Ñy³),Òr),(size))

	)

89 
	#_IOWR_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,Ñy³),Òr),(size))

	)

92 
	#_IOC_DIR
(
Ä
è((Òrè>> 
_IOC_DIRSHIFT
è& 
_IOC_DIRMASK
)

	)

93 
	#_IOC_TYPE
(
Ä
è((Òrè>> 
_IOC_TYPESHIFT
è& 
_IOC_TYPEMASK
)

	)

94 
	#_IOC_NR
(
Ä
è((Òrè>> 
_IOC_NRSHIFT
è& 
_IOC_NRMASK
)

	)

95 
	#_IOC_SIZE
(
Ä
è((Òrè>> 
_IOC_SIZESHIFT
è& 
_IOC_SIZEMASK
)

	)

99 
	#IOC_IN
 (
_IOC_WRITE
 << 
_IOC_DIRSHIFT
)

	)

100 
	#IOC_OUT
 (
_IOC_READ
 << 
_IOC_DIRSHIFT
)

	)

101 
	#IOC_INOUT
 ((
_IOC_WRITE
|
_IOC_READ
è<< 
_IOC_DIRSHIFT
)

	)

102 
	#IOCSIZE_MASK
 (
_IOC_SIZEMASK
 << 
_IOC_SIZESHIFT
)

	)

103 
	#IOCSIZE_SHIFT
 (
_IOC_SIZESHIFT
)

	)

	@/usr/include/asm-generic/socket.h

2 #iâdeà
__ASM_GENERIC_SOCKET_H


3 
	#__ASM_GENERIC_SOCKET_H


	)

5 
	~<asm/sockios.h
>

8 
	#SOL_SOCKET
 1

	)

10 
	#SO_DEBUG
 1

	)

11 
	#SO_REUSEADDR
 2

	)

12 
	#SO_TYPE
 3

	)

13 
	#SO_ERROR
 4

	)

14 
	#SO_DONTROUTE
 5

	)

15 
	#SO_BROADCAST
 6

	)

16 
	#SO_SNDBUF
 7

	)

17 
	#SO_RCVBUF
 8

	)

18 
	#SO_SNDBUFFORCE
 32

	)

19 
	#SO_RCVBUFFORCE
 33

	)

20 
	#SO_KEEPALIVE
 9

	)

21 
	#SO_OOBINLINE
 10

	)

22 
	#SO_NO_CHECK
 11

	)

23 
	#SO_PRIORITY
 12

	)

24 
	#SO_LINGER
 13

	)

25 
	#SO_BSDCOMPAT
 14

	)

26 
	#SO_REUSEPORT
 15

	)

27 #iâdeà
SO_PASSCRED


28 
	#SO_PASSCRED
 16

	)

29 
	#SO_PEERCRED
 17

	)

30 
	#SO_RCVLOWAT
 18

	)

31 
	#SO_SNDLOWAT
 19

	)

32 
	#SO_RCVTIMEO
 20

	)

33 
	#SO_SNDTIMEO
 21

	)

37 
	#SO_SECURITY_AUTHENTICATION
 22

	)

38 
	#SO_SECURITY_ENCRYPTION_TRANSPORT
 23

	)

39 
	#SO_SECURITY_ENCRYPTION_NETWORK
 24

	)

41 
	#SO_BINDTODEVICE
 25

	)

44 
	#SO_ATTACH_FILTER
 26

	)

45 
	#SO_DETACH_FILTER
 27

	)

46 
	#SO_GET_FILTER
 
SO_ATTACH_FILTER


	)

48 
	#SO_PEERNAME
 28

	)

49 
	#SO_TIMESTAMP
 29

	)

50 
	#SCM_TIMESTAMP
 
SO_TIMESTAMP


	)

52 
	#SO_ACCEPTCONN
 30

	)

54 
	#SO_PEERSEC
 31

	)

55 
	#SO_PASSSEC
 34

	)

56 
	#SO_TIMESTAMPNS
 35

	)

57 
	#SCM_TIMESTAMPNS
 
SO_TIMESTAMPNS


	)

59 
	#SO_MARK
 36

	)

61 
	#SO_TIMESTAMPING
 37

	)

62 
	#SCM_TIMESTAMPING
 
SO_TIMESTAMPING


	)

64 
	#SO_PROTOCOL
 38

	)

65 
	#SO_DOMAIN
 39

	)

67 
	#SO_RXQ_OVFL
 40

	)

69 
	#SO_WIFI_STATUS
 41

	)

70 
	#SCM_WIFI_STATUS
 
SO_WIFI_STATUS


	)

71 
	#SO_PEEK_OFF
 42

	)

74 
	#SO_NOFCS
 43

	)

76 
	#SO_LOCK_FILTER
 44

	)

78 
	#SO_SELECT_ERR_QUEUE
 45

	)

80 
	#SO_BUSY_POLL
 46

	)

82 
	#SO_MAX_PACING_RATE
 47

	)

84 
	#SO_BPF_EXTENSIONS
 48

	)

86 
	#SO_INCOMING_CPU
 49

	)

88 
	#SO_ATTACH_BPF
 50

	)

89 
	#SO_DETACH_BPF
 
SO_DETACH_FILTER


	)

91 
	#SO_ATTACH_REUSEPORT_CBPF
 51

	)

92 
	#SO_ATTACH_REUSEPORT_EBPF
 52

	)

94 
	#SO_CNX_ADVICE
 53

	)

96 
	#SCM_TIMESTAMPING_OPT_STATS
 54

	)

98 
	#SO_MEMINFO
 55

	)

100 
	#SO_INCOMING_NAPI_ID
 56

	)

102 
	#SO_COOKIE
 57

	)

104 
	#SCM_TIMESTAMPING_PKTINFO
 58

	)

106 
	#SO_PEERGROUPS
 59

	)

108 
	#SO_ZEROCOPY
 60

	)

	@/usr/include/asm/posix_types_32.h

2 #iâdeà
_ASM_X86_POSIX_TYPES_32_H


3 
	#_ASM_X86_POSIX_TYPES_32_H


	)

11 
	t__k”Ãl_mode_t
;

12 
	#__k”Ãl_mode_t
 
__k”Ãl_mode_t


	)

14 
	t__k”Ãl_c_pid_t
;

15 
	#__k”Ãl_c_pid_t
 
__k”Ãl_c_pid_t


	)

17 
	t__k”Ãl_uid_t
;

18 
	t__k”Ãl_gid_t
;

19 
	#__k”Ãl_uid_t
 
__k”Ãl_uid_t


	)

21 
	t__k”Ãl_Şd_dev_t
;

22 
	#__k”Ãl_Şd_dev_t
 
__k”Ãl_Şd_dev_t


	)

24 
	~<asm-g’”ic/posix_ty³s.h
>

	@/usr/include/asm/posix_types_64.h

2 #iâdeà
_ASM_X86_POSIX_TYPES_64_H


3 
	#_ASM_X86_POSIX_TYPES_64_H


	)

11 
	t__k”Ãl_Şd_uid_t
;

12 
	t__k”Ãl_Şd_gid_t
;

13 
	#__k”Ãl_Şd_uid_t
 
__k”Ãl_Şd_uid_t


	)

15 
	t__k”Ãl_Şd_dev_t
;

16 
	#__k”Ãl_Şd_dev_t
 
__k”Ãl_Şd_dev_t


	)

18 
	~<asm-g’”ic/posix_ty³s.h
>

	@/usr/include/asm/posix_types_x32.h

2 #iâdeà
_ASM_X86_POSIX_TYPES_X32_H


3 
	#_ASM_X86_POSIX_TYPES_X32_H


	)

14 
	t__k”Ãl_lÚg_t
;

15 
	t__k”Ãl_ulÚg_t
;

16 
	#__k”Ãl_lÚg_t
 
__k”Ãl_lÚg_t


	)

18 
	~<asm/posix_ty³s_64.h
>

	@/usr/include/bits/long-double.h

	@/usr/include/bits/pthreadtypes.h

19 #iâdeà
_BITS_PTHREADTYPES_COMMON_H


20 
	#_BITS_PTHREADTYPES_COMMON_H
 1

	)

23 
	~<b™s/th»ad-sh¬ed-ty³s.h
>

27 
	t±h»ad_t
;

34 
	m__size
[
__SIZEOF_PTHREAD_MUTEXATTR_T
];

35 
	m__®ign
;

36 } 
	t±h»ad_mu‹x©Œ_t
;

43 
	m__size
[
__SIZEOF_PTHREAD_CONDATTR_T
];

44 
	m__®ign
;

45 } 
	t±h»ad_cÚd©Œ_t
;

49 
	t±h»ad_key_t
;

53 
	t__ONCE_ALIGNMENT
 
	t±h»ad_Úû_t
;

56 
	u±h»ad_©Œ_t


58 
	m__size
[
__SIZEOF_PTHREAD_ATTR_T
];

59 
	m__®ign
;

61 #iâdeà
__have_±h»ad_©Œ_t


62 
±h»ad_©Œ_t
 
	t±h»ad_©Œ_t
;

63 
	#__have_±h»ad_©Œ_t
 1

	)

69 
__±h»ad_mu‹x_s
 
	m__d©a
;

70 
	m__size
[
__SIZEOF_PTHREAD_MUTEX_T
];

71 
	m__®ign
;

72 } 
	t±h»ad_mu‹x_t
;

77 
__±h»ad_cÚd_s
 
	m__d©a
;

78 
	m__size
[
__SIZEOF_PTHREAD_COND_T
];

79 
__ex‹nsiÚ__
 
	m__®ign
;

80 } 
	t±h»ad_cÚd_t
;

83 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


88 
__±h»ad_rwlock_¬ch_t
 
	m__d©a
;

89 
	m__size
[
__SIZEOF_PTHREAD_RWLOCK_T
];

90 
	m__®ign
;

91 } 
	t±h»ad_rwlock_t
;

95 
	m__size
[
__SIZEOF_PTHREAD_RWLOCKATTR_T
];

96 
	m__®ign
;

97 } 
	t±h»ad_rwlock©Œ_t
;

101 #ifdeà
__USE_XOPEN2K


103 vŞ©
	t±h»ad_¥šlock_t
;

110 
	m__size
[
__SIZEOF_PTHREAD_BARRIER_T
];

111 
	m__®ign
;

112 } 
	t±h»ad_b¬r›r_t
;

116 
	m__size
[
__SIZEOF_PTHREAD_BARRIERATTR_T
];

117 
	m__®ign
;

118 } 
	t±h»ad_b¬r›¿‰r_t
;

	@/usr/include/bits/stdint-intn.h

19 #iâdeà
_BITS_STDINT_INTN_H


20 
	#_BITS_STDINT_INTN_H
 1

	)

22 
	~<b™s/ty³s.h
>

24 
__št8_t
 
	tšt8_t
;

25 
__št16_t
 
	tšt16_t
;

26 
__št32_t
 
	tšt32_t
;

27 
__št64_t
 
	tšt64_t
;

	@/usr/include/bits/strings_fortified.h

19 #iâdeà
__STRINGS_FORTIFIED


20 
	#__STRINGS_FORTIFIED
 1

	)

22 
__fÜtify_funùiÚ
 

23 
__NTH
 (
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__Ën
))

25 (è
	`__butš___memmove_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

26 
	}
}

28 
__fÜtify_funùiÚ
 

29 
__NTH
 (
	$bz”o
 (*
__de¡
, 
size_t
 
__Ën
))

31 (è
	`__butš___mem£t_chk
 (
__de¡
, '\0', 
__Ën
, 
	`__bos0
 (__dest));

32 
	}
}

	@/usr/include/bits/types.h

23 #iâdef 
_BITS_TYPES_H


24 
	#_BITS_TYPES_H
 1

	)

26 
	~<ã©u»s.h
>

27 
	~<b™s/wÜdsize.h
>

30 
	t__u_ch¬
;

31 
	t__u_shÜt
;

32 
	t__u_št
;

33 
	t__u_lÚg
;

36 sigÃd 
	t__št8_t
;

37 
	t__ušt8_t
;

38 sigÃd 
	t__št16_t
;

39 
	t__ušt16_t
;

40 sigÃd 
	t__št32_t
;

41 
	t__ušt32_t
;

42 #ià
__WORDSIZE
 == 64

43 sigÃd 
	t__št64_t
;

44 
	t__ušt64_t
;

46 
__ex‹nsiÚ__
 sigÃd 
	t__št64_t
;

47 
__ex‹nsiÚ__
 
	t__ušt64_t
;

51 #ià
__WORDSIZE
 == 64

52 
	t__quad_t
;

53 
	t__u_quad_t
;

55 
__ex‹nsiÚ__
 
	t__quad_t
;

56 
__ex‹nsiÚ__
 
	t__u_quad_t
;

60 #ià
__WORDSIZE
 == 64

61 
	t__štmax_t
;

62 
	t__uštmax_t
;

64 
__ex‹nsiÚ__
 
	t__štmax_t
;

65 
__ex‹nsiÚ__
 
	t__uštmax_t
;

98 
	#__S16_TYPE
 

	)

99 
	#__U16_TYPE
 

	)

100 
	#__S32_TYPE
 

	)

101 
	#__U32_TYPE
 

	)

102 
	#__SLONGWORD_TYPE
 

	)

103 
	#__ULONGWORD_TYPE
 

	)

104 #ià
__WORDSIZE
 == 32

105 
	#__SQUAD_TYPE
 
__quad_t


	)

106 
	#__UQUAD_TYPE
 
__u_quad_t


	)

107 
	#__SWORD_TYPE
 

	)

108 
	#__UWORD_TYPE
 

	)

109 
	#__SLONG32_TYPE
 

	)

110 
	#__ULONG32_TYPE
 

	)

111 
	#__S64_TYPE
 
__quad_t


	)

112 
	#__U64_TYPE
 
__u_quad_t


	)

115 
	#__STD_TYPE
 
__ex‹nsiÚ__
 

	)

116 #–ià
__WORDSIZE
 == 64

117 
	t__SQUAD_TYPE
 

	)

118 
	t__UQUAD_TYPE
 

	)

119 
	t__SWORD_TYPE
 

	)

120 
	t__UWORD_TYPE
 

	)

121 
	t__SLONG32_TYPE
 

	)

122 
	t__ULONG32_TYPE
 

	)

123 
	t__S64_TYPE
 

	)

124 
	t__U64_TYPE
 

	)

126 
	t__STD_TYPE
 

	)

130 
	~<b™s/ty³sizes.h
>

133 
__STD_TYPE
 
	t__DEV_T_TYPE
 
	t__dev_t
;

134 
__STD_TYPE
 
__UID_T_TYPE
 
	g__uid_t
;

135 
__STD_TYPE
 
__GID_T_TYPE
 
	g__gid_t
;

136 
__STD_TYPE
 
__INO_T_TYPE
 
	g__šo_t
;

137 
__STD_TYPE
 
__INO64_T_TYPE
 
	g__šo64_t
;

138 
__STD_TYPE
 
__MODE_T_TYPE
 
	g__mode_t
;

139 
__STD_TYPE
 
__NLINK_T_TYPE
 
	g__Æšk_t
;

140 
__STD_TYPE
 
__OFF_T_TYPE
 
	g__off_t
;

141 
__STD_TYPE
 
__OFF64_T_TYPE
 
	g__off64_t
;

142 
__STD_TYPE
 
__PID_T_TYPE
 
	g__pid_t
;

143 
__STD_TYPE
 
__FSID_T_TYPE
 
	g__fsid_t
;

144 
__STD_TYPE
 
__CLOCK_T_TYPE
 
	g__şock_t
;

145 
__STD_TYPE
 
__RLIM_T_TYPE
 
	g__¾im_t
;

146 
__STD_TYPE
 
__RLIM64_T_TYPE
 
	g__¾im64_t
;

147 
__STD_TYPE
 
__ID_T_TYPE
 
	g__id_t
;

148 
__STD_TYPE
 
__TIME_T_TYPE
 
	g__time_t
;

149 
__STD_TYPE
 
__USECONDS_T_TYPE
 
	g__u£cÚds_t
;

150 
__STD_TYPE
 
__SUSECONDS_T_TYPE
 
	g__su£cÚds_t
;

152 
__STD_TYPE
 
__DADDR_T_TYPE
 
	g__daddr_t
;

153 
__STD_TYPE
 
__KEY_T_TYPE
 
	g__key_t
;

156 
__STD_TYPE
 
__CLOCKID_T_TYPE
 
	g__şockid_t
;

159 
__STD_TYPE
 
__TIMER_T_TYPE
 
	g__tim”_t
;

162 
__STD_TYPE
 
__BLKSIZE_T_TYPE
 
	g__blksize_t
;

167 
__STD_TYPE
 
__BLKCNT_T_TYPE
 
	g__blkút_t
;

168 
__STD_TYPE
 
__BLKCNT64_T_TYPE
 
	g__blkút64_t
;

171 
__STD_TYPE
 
__FSBLKCNT_T_TYPE
 
	g__fsblkút_t
;

172 
__STD_TYPE
 
__FSBLKCNT64_T_TYPE
 
	g__fsblkút64_t
;

175 
__STD_TYPE
 
__FSFILCNT_T_TYPE
 
	g__fsfút_t
;

176 
__STD_TYPE
 
__FSFILCNT64_T_TYPE
 
	g__fsfút64_t
;

179 
__STD_TYPE
 
__FSWORD_T_TYPE
 
	g__fswÜd_t
;

181 
__STD_TYPE
 
__SSIZE_T_TYPE
 
	g__ssize_t
;

184 
__STD_TYPE
 
__SYSCALL_SLONG_TYPE
 
	g__sysÿÎ_¦Úg_t
;

186 
__STD_TYPE
 
__SYSCALL_ULONG_TYPE
 
	g__sysÿÎ_ulÚg_t
;

190 
__off64_t
 
	t__loff_t
;

191 *
	t__ÿddr_t
;

194 
__STD_TYPE
 
__SWORD_TYPE
 
	g__šŒ_t
;

197 
__STD_TYPE
 
__U32_TYPE
 
	g__sockËn_t
;

202 
	t__sig_©omic_t
;

204 #undeà
__STD_TYPE


	@/usr/include/bits/types/__locale_t.h

20 #iâdeà
_BITS_TYPES___LOCALE_T_H


21 
	#_BITS_TYPES___LOCALE_T_H
 1

	)

28 
	s__loÿË_¡ruù


31 
__loÿË_d©a
 *
	m__loÿËs
[13];

34 cÚ¡ *
	m__ùy³_b
;

35 cÚ¡ *
	m__ùy³_tŞow”
;

36 cÚ¡ *
	m__ùy³_touµ”
;

39 cÚ¡ *
	m__Çmes
[13];

42 
__loÿË_¡ruù
 *
	t__loÿË_t
;

	@/usr/include/bits/types/clock_t.h

1 #iâdeà
__şock_t_defšed


2 
	#__şock_t_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

7 
__şock_t
 
	tşock_t
;

	@/usr/include/bits/types/clockid_t.h

1 #iâdeà
__şockid_t_defšed


2 
	#__şockid_t_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

7 
__şockid_t
 
	tşockid_t
;

	@/usr/include/bits/types/time_t.h

1 #iâdeà
__time_t_defšed


2 
	#__time_t_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

7 
__time_t
 
	ttime_t
;

	@/usr/include/bits/types/timer_t.h

1 #iâdeà
__tim”_t_defšed


2 
	#__tim”_t_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

7 
__tim”_t
 
	ttim”_t
;

	@/usr/include/bits/wordsize.h

3 #ià
defšed
 
__x86_64__
 && !defšed 
__ILP32__


4 
	#__WORDSIZE
 64

	)

6 
	#__WORDSIZE
 32

	)

7 
	#__WORDSIZE32_SIZE_ULONG
 0

	)

8 
	#__WORDSIZE32_PTRDIFF_LONG
 0

	)

11 #ifdeà
__x86_64__


12 
	#__WORDSIZE_TIME64_COMPAT32
 1

	)

14 
	#__SYSCALL_WORDSIZE
 64

	)

16 
	#__WORDSIZE_TIME64_COMPAT32
 0

	)

	@/usr/include/endian.h

18 #iâdef 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<ã©u»s.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<b™s/’dŸn.h
>

40 #iâdeà
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_MISC


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èLO, 
	)
HI

53 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èHI, 
	)
LO

58 #ià
defšed
 
__USE_MISC
 && !defšed 
__ASSEMBLER__


60 
	~<b™s/by‹sw­.h
>

61 
	~<b™s/ušŠ-id’t™y.h
>

63 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


64 
	#htobe16
(
x
è
	`__bsw­_16
 (x)

	)

65 
	#htŞe16
(
x
è
	`__ušt16_id’t™y
 (x)

	)

66 
	#be16toh
(
x
è
	`__bsw­_16
 (x)

	)

67 
	#Ë16toh
(
x
è
	`__ušt16_id’t™y
 (x)

	)

69 
	#htobe32
(
x
è
	`__bsw­_32
 (x)

	)

70 
	#htŞe32
(
x
è
	`__ušt32_id’t™y
 (x)

	)

71 
	#be32toh
(
x
è
	`__bsw­_32
 (x)

	)

72 
	#Ë32toh
(
x
è
	`__ušt32_id’t™y
 (x)

	)

74 
	#htobe64
(
x
è
	`__bsw­_64
 (x)

	)

75 
	#htŞe64
(
x
è
	`__ušt64_id’t™y
 (x)

	)

76 
	#be64toh
(
x
è
	`__bsw­_64
 (x)

	)

77 
	#Ë64toh
(
x
è
	`__ušt64_id’t™y
 (x)

	)

80 
	#htobe16
(
x
è
	`__ušt16_id’t™y
 (x)

	)

81 
	#htŞe16
(
x
è
	`__bsw­_16
 (x)

	)

82 
	#be16toh
(
x
è
	`__ušt16_id’t™y
 (x)

	)

83 
	#Ë16toh
(
x
è
	`__bsw­_16
 (x)

	)

85 
	#htobe32
(
x
è
	`__ušt32_id’t™y
 (x)

	)

86 
	#htŞe32
(
x
è
	`__bsw­_32
 (x)

	)

87 
	#be32toh
(
x
è
	`__ušt32_id’t™y
 (x)

	)

88 
	#Ë32toh
(
x
è
	`__bsw­_32
 (x)

	)

90 
	#htobe64
(
x
è
	`__ušt64_id’t™y
 (x)

	)

91 
	#htŞe64
(
x
è
	`__bsw­_64
 (x)

	)

92 
	#be64toh
(
x
è
	`__ušt64_id’t™y
 (x)

	)

93 
	#Ë64toh
(
x
è
	`__bsw­_64
 (x)

	)

	@/usr/include/gnu/stubs-32.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub_chæags


	)

11 
	#__¡ub_ç‰ach


	)

12 
	#__¡ub_fchæags


	)

13 
	#__¡ub_fd‘ach


	)

14 
	#__¡ub_g‰y


	)

15 
	#__¡ub_lchmod


	)

16 
	#__¡ub_»voke


	)

17 
	#__¡ub_£ogš


	)

18 
	#__¡ub_sig»tuº


	)

19 
	#__¡ub_s¡k


	)

20 
	#__¡ub_¡ty


	)

	@/usr/include/gnu/stubs-64.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub___com·t_bdæush


	)

11 
	#__¡ub_chæags


	)

12 
	#__¡ub_ç‰ach


	)

13 
	#__¡ub_fchæags


	)

14 
	#__¡ub_fd‘ach


	)

15 
	#__¡ub_g‘msg


	)

16 
	#__¡ub_g‰y


	)

17 
	#__¡ub_lchmod


	)

18 
	#__¡ub_putmsg


	)

19 
	#__¡ub_»voke


	)

20 
	#__¡ub_£ogš


	)

21 
	#__¡ub_sig»tuº


	)

22 
	#__¡ub_s¡k


	)

23 
	#__¡ub_¡ty


	)

	@/usr/include/gnu/stubs-x32.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub___com·t_bdæush


	)

11 
	#__¡ub___com·t_ü—‹_moduË


	)

12 
	#__¡ub___com·t_g‘_k”Ãl_syms


	)

13 
	#__¡ub___com·t_qu”y_moduË


	)

14 
	#__¡ub___com·t_u£lib


	)

15 
	#__¡ub_chæags


	)

16 
	#__¡ub_ç‰ach


	)

17 
	#__¡ub_fchæags


	)

18 
	#__¡ub_fd‘ach


	)

19 
	#__¡ub_g‘msg


	)

20 
	#__¡ub_g‰y


	)

21 
	#__¡ub_lchmod


	)

22 
	#__¡ub_nfs£rvùl


	)

23 
	#__¡ub_putmsg


	)

24 
	#__¡ub_»voke


	)

25 
	#__¡ub_£ogš


	)

26 
	#__¡ub_sig»tuº


	)

27 
	#__¡ub_s¡k


	)

28 
	#__¡ub_¡ty


	)

	@/usr/include/linux/swab.h

2 #iâdeà
_LINUX_SWAB_H


3 
	#_LINUX_SWAB_H


	)

5 
	~<lšux/ty³s.h
>

7 
	~<asm/swab.h
>

13 
	#___cÚ¡ªt_swab16
(
x
è((
__u16
)( \

14 (((
__u16
)(
x
) & (__u16)0x00ffU) << 8) | \

15 (((
__u16
)(
x
è& (__u16)0xff00Uè>> 8)))

	)

17 
	#___cÚ¡ªt_swab32
(
x
è((
__u32
)( \

18 (((
__u32
)(
x
) & (__u32)0x000000ffUL) << 24) | \

19 (((
__u32
)(
x
) & (__u32)0x0000ff00UL) << 8) | \

20 (((
__u32
)(
x
) & (__u32)0x00ff0000UL) >> 8) | \

21 (((
__u32
)(
x
è& (__u32)0xff000000ULè>> 24)))

	)

23 
	#___cÚ¡ªt_swab64
(
x
è((
__u64
)( \

24 (((
__u64
)(
x
) & (__u64)0x00000000000000ffULL) << 56) | \

25 (((
__u64
)(
x
) & (__u64)0x000000000000ff00ULL) << 40) | \

26 (((
__u64
)(
x
) & (__u64)0x0000000000ff0000ULL) << 24) | \

27 (((
__u64
)(
x
) & (__u64)0x00000000ff000000ULL) << 8) | \

28 (((
__u64
)(
x
) & (__u64)0x000000ff00000000ULL) >> 8) | \

29 (((
__u64
)(
x
) & (__u64)0x0000ff0000000000ULL) >> 24) | \

30 (((
__u64
)(
x
) & (__u64)0x00ff000000000000ULL) >> 40) | \

31 (((
__u64
)(
x
è& (__u64)0xff00000000000000ULLè>> 56)))

	)

33 
	#___cÚ¡ªt_swahw32
(
x
è((
__u32
)( \

34 (((
__u32
)(
x
) & (__u32)0x0000ffffUL) << 16) | \

35 (((
__u32
)(
x
è& (__u32)0xffff0000ULè>> 16)))

	)

37 
	#___cÚ¡ªt_swahb32
(
x
è((
__u32
)( \

38 (((
__u32
)(
x
) & (__u32)0x00ff00ffUL) << 8) | \

39 (((
__u32
)(
x
è& (__u32)0xff00ff00ULè>> 8)))

	)

47 
__šlše__
 
__u16
 
	$__fswab16
(
__u16
 
v®
)

49 #ià
	`defšed
 (
__¬ch_swab16
)

50  
	`__¬ch_swab16
(
v®
);

52  
	`___cÚ¡ªt_swab16
(
v®
);

54 
	}
}

56 
__šlše__
 
__u32
 
	$__fswab32
(
__u32
 
v®
)

58 #ià
	`defšed
(
__¬ch_swab32
)

59  
	`__¬ch_swab32
(
v®
);

61  
	`___cÚ¡ªt_swab32
(
v®
);

63 
	}
}

65 
__šlše__
 
__u64
 
	$__fswab64
(
__u64
 
v®
)

67 #ià
	`defšed
 (
__¬ch_swab64
)

68  
	`__¬ch_swab64
(
v®
);

69 #–ià
	`defšed
(
__SWAB_64_THRU_32__
)

70 
__u32
 
h
 = 
v®
 >> 32;

71 
__u32
 
l
 = 
v®
 & ((1ULL << 32) - 1);

72  (((
__u64
)
	`__fswab32
(
l
)è<< 32è| ((__u64)(__fswab32(
h
)));

74  
	`___cÚ¡ªt_swab64
(
v®
);

76 
	}
}

78 
__šlše__
 
__u32
 
	$__fswahw32
(
__u32
 
v®
)

80 #ifdeà
__¬ch_swahw32


81  
	`__¬ch_swahw32
(
v®
);

83  
	`___cÚ¡ªt_swahw32
(
v®
);

85 
	}
}

87 
__šlše__
 
__u32
 
	$__fswahb32
(
__u32
 
v®
)

89 #ifdeà
__¬ch_swahb32


90  
	`__¬ch_swahb32
(
v®
);

92  
	`___cÚ¡ªt_swahb32
(
v®
);

94 
	}
}

100 #ifdeà
__HAVE_BUILTIN_BSWAP16__


101 
	#__swab16
(
x
è(
__u16
)
	`__butš_bsw­16
((__u16)(x))

	)

103 
	#__swab16
(
x
) \

104 (
	`__butš_cÚ¡ªt_p
((
__u16
)(
x
)) ? \

105 
	`___cÚ¡ªt_swab16
(
x
) : \

106 
	`__fswab16
(
x
))

	)

113 #ifdeà
__HAVE_BUILTIN_BSWAP32__


114 
	#__swab32
(
x
è(
__u32
)
	`__butš_bsw­32
((__u32)(x))

	)

116 
	#__swab32
(
x
) \

117 (
	`__butš_cÚ¡ªt_p
((
__u32
)(
x
)) ? \

118 
	`___cÚ¡ªt_swab32
(
x
) : \

119 
	`__fswab32
(
x
))

	)

126 #ifdeà
__HAVE_BUILTIN_BSWAP64__


127 
	#__swab64
(
x
è(
__u64
)
	`__butš_bsw­64
((__u64)(x))

	)

129 
	#__swab64
(
x
) \

130 (
	`__butš_cÚ¡ªt_p
((
__u64
)(
x
)) ? \

131 
	`___cÚ¡ªt_swab64
(
x
) : \

132 
	`__fswab64
(
x
))

	)

141 
	#__swahw32
(
x
) \

142 (
	`__butš_cÚ¡ªt_p
((
__u32
)(
x
)) ? \

143 
	`___cÚ¡ªt_swahw32
(
x
) : \

144 
	`__fswahw32
(
x
))

	)

152 
	#__swahb32
(
x
) \

153 (
	`__butš_cÚ¡ªt_p
((
__u32
)(
x
)) ? \

154 
	`___cÚ¡ªt_swahb32
(
x
) : \

155 
	`__fswahb32
(
x
))

	)

161 
__®ways_šlše
 
__u16
 
	$__swab16p
(cÚ¡ 
__u16
 *
p
)

163 #ifdeà
__¬ch_swab16p


164  
	`__¬ch_swab16p
(
p
);

166  
	`__swab16
(*
p
);

168 
	}
}

174 
__®ways_šlše
 
__u32
 
	$__swab32p
(cÚ¡ 
__u32
 *
p
)

176 #ifdeà
__¬ch_swab32p


177  
	`__¬ch_swab32p
(
p
);

179  
	`__swab32
(*
p
);

181 
	}
}

187 
__®ways_šlše
 
__u64
 
	$__swab64p
(cÚ¡ 
__u64
 *
p
)

189 #ifdeà
__¬ch_swab64p


190  
	`__¬ch_swab64p
(
p
);

192  
	`__swab64
(*
p
);

194 
	}
}

202 
__šlše__
 
__u32
 
	$__swahw32p
(cÚ¡ 
__u32
 *
p
)

204 #ifdeà
__¬ch_swahw32p


205  
	`__¬ch_swahw32p
(
p
);

207  
	`__swahw32
(*
p
);

209 
	}
}

217 
__šlše__
 
__u32
 
	$__swahb32p
(cÚ¡ 
__u32
 *
p
)

219 #ifdeà
__¬ch_swahb32p


220  
	`__¬ch_swahb32p
(
p
);

222  
	`__swahb32
(*
p
);

224 
	}
}

230 
__šlše__
 
	$__swab16s
(
__u16
 *
p
)

232 #ifdeà
__¬ch_swab16s


233 
	`__¬ch_swab16s
(
p
);

235 *
p
 = 
	`__swab16p
(p);

237 
	}
}

242 
__®ways_šlše
 
	$__swab32s
(
__u32
 *
p
)

244 #ifdeà
__¬ch_swab32s


245 
	`__¬ch_swab32s
(
p
);

247 *
p
 = 
	`__swab32p
(p);

249 
	}
}

255 
__®ways_šlše
 
	$__swab64s
(
__u64
 *
p
)

257 #ifdeà
__¬ch_swab64s


258 
	`__¬ch_swab64s
(
p
);

260 *
p
 = 
	`__swab64p
(p);

262 
	}
}

270 
__šlše__
 
	$__swahw32s
(
__u32
 *
p
)

272 #ifdeà
__¬ch_swahw32s


273 
	`__¬ch_swahw32s
(
p
);

275 *
p
 = 
	`__swahw32p
(p);

277 
	}
}

285 
__šlše__
 
	$__swahb32s
(
__u32
 *
p
)

287 #ifdeà
__¬ch_swahb32s


288 
	`__¬ch_swahb32s
(
p
);

290 *
p
 = 
	`__swahb32p
(p);

292 
	}
}

	@/usr/include/sys/select.h

21 #iâdeà
_SYS_SELECT_H


22 
	#_SYS_SELECT_H
 1

	)

24 
	~<ã©u»s.h
>

27 
	~<b™s/ty³s.h
>

30 
	~<b™s/£Ëù.h
>

33 
	~<b™s/ty³s/sig£t_t.h
>

36 
	~<b™s/ty³s/time_t.h
>

37 
	~<b™s/ty³s/¡ruù_timev®.h
>

38 #ifdeà
__USE_XOPEN2K


39 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

42 #iâdeà
__su£cÚds_t_defšed


43 
__su£cÚds_t
 
	tsu£cÚds_t
;

44 
	#__su£cÚds_t_defšed


	)

49 
	t__fd_mask
;

52 #undeà
__NFDBITS


54 
	#__NFDBITS
 (8 * (è (
__fd_mask
))

	)

55 
	#__FD_ELT
(
d
è((dè/ 
__NFDBITS
)

	)

56 
	#__FD_MASK
(
d
è((
__fd_mask
è(1UL << ((dè% 
__NFDBITS
)))

	)

63 #ifdeà
__USE_XOPEN


64 
__fd_mask
 
	mfds_b™s
[
__FD_SETSIZE
 / 
__NFDBITS
];

65 
	#__FDS_BITS
(
£t
è((£t)->
fds_b™s
)

	)

67 
__fd_mask
 
	m__fds_b™s
[
__FD_SETSIZE
 / 
__NFDBITS
];

68 
	#__FDS_BITS
(
£t
è((£t)->
__fds_b™s
)

	)

70 } 
	tfd_£t
;

73 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

75 #ifdeà
__USE_MISC


77 
__fd_mask
 
	tfd_mask
;

80 
	#NFDBITS
 
__NFDBITS


	)

85 
	#FD_SET
(
fd
, 
fd£
è
	`__FD_SET
 (fd, fd£)

	)

86 
	#FD_CLR
(
fd
, 
fd£
è
	`__FD_CLR
 (fd, fd£)

	)

87 
	#FD_ISSET
(
fd
, 
fd£
è
	`__FD_ISSET
 (fd, fd£)

	)

88 
	#FD_ZERO
(
fd£
è
	`__FD_ZERO
 (fd£)

	)

91 
__BEGIN_DECLS


101 
£Ëù
 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

102 
fd_£t
 *
__»¡riù
 
__wr™efds
,

103 
fd_£t
 *
__»¡riù
 
__exû±fds
,

104 
timev®
 *
__»¡riù
 
__timeout
);

106 #ifdeà
__USE_XOPEN2K


113 
p£Ëù
 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

114 
fd_£t
 *
__»¡riù
 
__wr™efds
,

115 
fd_£t
 *
__»¡riù
 
__exû±fds
,

116 cÚ¡ 
time¥ec
 *
__»¡riù
 
__timeout
,

117 cÚ¡ 
__sig£t_t
 *
__»¡riù
 
__sigmask
);

122 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__GNUC__


123 
	~<b™s/£Ëù2.h
>

126 
	g__END_DECLS


	@/usr/include/sys/sysmacros.h

19 #iâdeà
_SYS_SYSMACROS_H_OUTER


21 #iâdeà
__SYSMACROS_DEPRECATED_INCLUSION


22 
	#_SYS_SYSMACROS_H_OUTER
 1

	)

30 #undeà
majÜ


31 #undeà
mšÜ


32 #undeà
makedev


36 #iâdeà
_SYS_SYSMACROS_H


37 
	#_SYS_SYSMACROS_H
 1

	)

39 
	~<ã©u»s.h
>

40 
	~<b™s/ty³s.h
>

41 
	~<b™s/sysmaüos.h
>

52 
	#__SYSMACROS_DM
(
symbŞ
è
__SYSMACROS_DM1
 \

53 (
In
 
the
 
GNU
 
C
 
Lib¿ry
, #symbŞ 
is
 
defšed
\
n
\

54 
by
 <
sys
/
sysmaüos
.
h
>. 
FÜ
 
hi¡Üiÿl
 
com·tib™y
, 
™
 
is
\
n
\

55 
cu¼’y
 
defšed
 
by
 <
sys
/
ty³s
.
h
> 
as
 
w–l
, 
but
 
we
 
¶ª
 
to
\
n
\

56 
»move
 
this
 
soÚ
. 
To
 
u£
 #symbŞ, 
šşude
 <
sys
/
sysmaüos
.
h
>\
n
\

57 
dœeùly
. 
If
 
you
 
did
 
nÙ
 
š‹nd
 
to
 
u£
 
a
 
sy¡em
-
defšed
 
maüo
\
n
\

58 #symbŞ, 
you
 
should
 
undefše
 
™
 
aá”
 
šşudšg
 <
sys
/
ty³s
.
h
>.)

	)

62 
	#__SYSMACROS_DM1
(...è
	`__glibc_maüo_w¬nšg
 (#__VA_ARGS__)

	)

64 
	#__SYSMACROS_DECL_TEMPL
(
¹y³
, 
Çme
, 
´Ùo
) \

65 
¹y³
 
gnu_dev_
##
Çme
 
´Ùo
 
__THROW
 
__©Œibu‹_cÚ¡__
;

	)

67 
	#__SYSMACROS_IMPL_TEMPL
(
¹y³
, 
Çme
, 
´Ùo
) \

68 
__ex‹nsiÚ__
 
__ex‹º_šlše
 
__©Œibu‹_cÚ¡__
 
¹y³
 \

69 
	`__NTH
 (
gnu_dev_
##
Çme
 
´Ùo
)

	)

71 
__BEGIN_DECLS


73 
	$__SYSMACROS_DECLARE_MAJOR
 (
__SYSMACROS_DECL_TEMPL
)

74 
	$__SYSMACROS_DECLARE_MINOR
 (
__SYSMACROS_DECL_TEMPL
)

75 
	$__SYSMACROS_DECLARE_MAKEDEV
 (
__SYSMACROS_DECL_TEMPL
)

77 #ifdeà
__USE_EXTERN_INLINES


79 
	$__SYSMACROS_DEFINE_MAJOR
 (
__SYSMACROS_IMPL_TEMPL
)

80 
	$__SYSMACROS_DEFINE_MINOR
 (
__SYSMACROS_IMPL_TEMPL
)

81 
	$__SYSMACROS_DEFINE_MAKEDEV
 (
__SYSMACROS_IMPL_TEMPL
)

85 
__END_DECLS


89 #iâdeà
__SYSMACROS_NEED_IMPLEMENTATION


90 #undeà
__SYSMACROS_DECL_TEMPL


91 #undeà
__SYSMACROS_IMPL_TEMPL


92 #undeà
__SYSMACROS_DECLARE_MAJOR


93 #undeà
__SYSMACROS_DECLARE_MINOR


94 #undeà
__SYSMACROS_DECLARE_MAKEDEV


95 #undeà
__SYSMACROS_DEFINE_MAJOR


96 #undeà
__SYSMACROS_DEFINE_MINOR


97 #undeà
__SYSMACROS_DEFINE_MAKEDEV


100 #ifdeà
__SYSMACROS_DEPRECATED_INCLUSION


101 
	#majÜ
(
dev
è
	`__SYSMACROS_DM
 (
majÜ
è
	`gnu_dev_majÜ
 (dev)

	)

102 
	#mšÜ
(
dev
è
	`__SYSMACROS_DM
 (
mšÜ
è
	`gnu_dev_mšÜ
 (dev)

	)

103 
	#makedev
(
maj
, 
mš
è
	`__SYSMACROS_DM
 (
makedev
è
	`gnu_dev_makedev
 (maj, mš)

	)

105 
	#majÜ
(
dev
è
	`gnu_dev_majÜ
 (dev)

	)

106 
	#mšÜ
(
dev
è
	`gnu_dev_mšÜ
 (dev)

	)

107 
	#makedev
(
maj
, 
mš
è
	`gnu_dev_makedev
 (maj, mš)

	)

	@/usr/include/asm-generic/posix_types.h

2 #iâdeà
__ASM_GENERIC_POSIX_TYPES_H


3 
	#__ASM_GENERIC_POSIX_TYPES_H


	)

5 
	~<asm/b™¥”lÚg.h
>

14 #iâdeà
__k”Ãl_lÚg_t


15 
	t__k”Ãl_lÚg_t
;

16 
	t__k”Ãl_ulÚg_t
;

19 #iâdeà
__k”Ãl_šo_t


20 
__k”Ãl_ulÚg_t
 
	t__k”Ãl_šo_t
;

23 #iâdeà
__k”Ãl_mode_t


24 
	t__k”Ãl_mode_t
;

27 #iâdeà
__k”Ãl_pid_t


28 
	t__k”Ãl_pid_t
;

31 #iâdeà
__k”Ãl_c_pid_t


32 
	t__k”Ãl_c_pid_t
;

35 #iâdeà
__k”Ãl_uid_t


36 
	t__k”Ãl_uid_t
;

37 
	t__k”Ãl_gid_t
;

40 #iâdeà
__k”Ãl_su£cÚds_t


41 
__k”Ãl_lÚg_t
 
	t__k”Ãl_su£cÚds_t
;

44 #iâdeà
__k”Ãl_daddr_t


45 
	t__k”Ãl_daddr_t
;

48 #iâdeà
__k”Ãl_uid32_t


49 
	t__k”Ãl_uid32_t
;

50 
	t__k”Ãl_gid32_t
;

53 #iâdeà
__k”Ãl_Şd_uid_t


54 
__k”Ãl_uid_t
 
	t__k”Ãl_Şd_uid_t
;

55 
__k”Ãl_gid_t
 
	t__k”Ãl_Şd_gid_t
;

58 #iâdeà
__k”Ãl_Şd_dev_t


59 
	t__k”Ãl_Şd_dev_t
;

66 #iâdeà
__k”Ãl_size_t


67 #ià
__BITS_PER_LONG
 != 64

68 
	t__k”Ãl_size_t
;

69 
	t__k”Ãl_ssize_t
;

70 
	t__k”Ãl_±rdiff_t
;

72 
__k”Ãl_ulÚg_t
 
	t__k”Ãl_size_t
;

73 
__k”Ãl_lÚg_t
 
	t__k”Ãl_ssize_t
;

74 
__k”Ãl_lÚg_t
 
	t__k”Ãl_±rdiff_t
;

78 #iâdeà
__k”Ãl_fsid_t


80 
	mv®
[2];

81 } 
	t__k”Ãl_fsid_t
;

87 
__k”Ãl_lÚg_t
 
	t__k”Ãl_off_t
;

88 
	t__k”Ãl_loff_t
;

89 
__k”Ãl_lÚg_t
 
	t__k”Ãl_time_t
;

90 
__k”Ãl_lÚg_t
 
	t__k”Ãl_şock_t
;

91 
	t__k”Ãl_tim”_t
;

92 
	t__k”Ãl_şockid_t
;

93 * 
	t__k”Ãl_ÿddr_t
;

94 
	t__k”Ãl_uid16_t
;

95 
	t__k”Ãl_gid16_t
;

	@/usr/include/asm/bitsperlong.h

2 #iâdeà
__ASM_X86_BITSPERLONG_H


3 
	#__ASM_X86_BITSPERLONG_H


	)

5 #ià
defšed
(
__x86_64__
è&& !defšed(
__ILP32__
)

6 
	#__BITS_PER_LONG
 64

	)

8 
	#__BITS_PER_LONG
 32

	)

11 
	~<asm-g’”ic/b™¥”lÚg.h
>

	@/usr/include/asm/sockios.h

1 
	~<asm-g’”ic/sockios.h
>

	@/usr/include/asm/swab.h

2 #iâdeà
_ASM_X86_SWAB_H


3 
	#_ASM_X86_SWAB_H


	)

5 
	~<lšux/ty³s.h
>

8 
__šlše__
 
__u32
 
	$__¬ch_swab32
(
__u32
 
v®
)

10 
	`__asm__
("bsw­È%0" : "ô" (
v®
) : "0" (val));

11  
v®
;

12 
	}
}

13 
	#__¬ch_swab32
 
__¬ch_swab32


	)

15 
__šlše__
 
__u64
 
	$__¬ch_swab64
(
__u64
 
v®
)

17 #ifdeà
__i386__


20 
__u32
 
a
;

21 
__u32
 
b
;

22 } 
s
;

23 
__u64
 
u
;

24 } 
v
;

25 
v
.
u
 = 
v®
;

26 
	`__asm__
("bswapl %0 ; bswapl %1 ; xchgl %0,%1"

27 : "ô" (
v
.
s
.
a
), "ô" (v.s.
b
)

28 : "0" (
v
.
s
.
a
), "1" (v.s.
b
));

29  
v
.
u
;

31 
	`__asm__
("bsw­q %0" : "ô" (
v®
) : "0" (val));

32  
v®
;

34 
	}
}

35 
	#__¬ch_swab64
 
__¬ch_swab64


	)

	@/usr/include/bits/byteswap.h

19 #ià!
defšed
 
_BYTESWAP_H
 && !defšed 
_NETINET_IN_H
 && !defšed 
_ENDIAN_H


23 #iâdeà
_BITS_BYTESWAP_H


24 
	#_BITS_BYTESWAP_H
 1

	)

26 
	~<ã©u»s.h
>

27 
	~<b™s/ty³s.h
>

28 
	~<b™s/wÜdsize.h
>

31 
	#__bsw­_cÚ¡ªt_16
(
x
) \

32 ((è((((
x
è>> 8è& 0xffè| (((xè& 0xffè<< 8)))

	)

35 
	~<b™s/by‹sw­-16.h
>

38 
	#__bsw­_cÚ¡ªt_32
(
x
) \

39 ((((
x
) & 0xff000000) >> 24) | (((x) & 0x00ff0000) >> 8) | \

40 (((
x
è& 0x0000ff00è<< 8è| (((xè& 0x000000ffè<< 24))

	)

42 #ifdeà
__GNUC__


43 #ià
__GNUC_PREREQ
 (4, 3)

44 
__šlše
 

45 
	$__bsw­_32
 (
__bsx
)

47  
	`__butš_bsw­32
 (
__bsx
);

48 
	}
}

49 #–ià
__GNUC__
 >= 2

50 #ià
__WORDSIZE
 =ğ64 || (
defšed
 
__i486__
 || defšed 
__³Áium__
 \

51 || 
defšed
 
	g__³Áium´o__
 || defšed 
	g__³Áium4__
 \

52 || 
defšed
 
	g__k8__
 || defšed 
	g__©hlÚ__
 \

53 || 
defšed
 
	g__k6__
 || defšed 
	g__nocÚa__
 \

54 || 
defšed
 
	g__cÜe2__
 || defšed 
	g__geode__
 \

55 || 
defšed
 
	g__amdçm10__
)

58 
	#__bsw­_32
(
x
) \

59 (
__ex‹nsiÚ__
 \

60 ({ 
__v
, 
__x
 = (
x
); \

61 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

62 
__v
 = 
	`__bsw­_cÚ¡ªt_32
 (
__x
); \

64 
	`__asm__
 ("bsw­ %0" : "ô" (
__v
è: "0" (
__x
)); \

65 
__v
; }))

	)

67 
	#__bsw­_32
(
x
) \

68 (
__ex‹nsiÚ__
 \

69 ({ 
__v
, 
__x
 = (
x
); \

70 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

71 
__v
 = 
	`__bsw­_cÚ¡ªt_32
 (
__x
); \

73 
	`__asm__
 ("rorw $8, %w0;" \

76 : "ô" (
__v
) \

77 : "0" (
__x
) \

79 
__v
; }))

	)

82 
	#__bsw­_32
(
x
) \

83 (
__ex‹nsiÚ__
 \

84 ({ 
__x
 = (
x
); 
	`__bsw­_cÚ¡ªt_32
 (__x); }))

	)

87 
__šlše
 

88 
	$__bsw­_32
 (
__bsx
)

90  
	`__bsw­_cÚ¡ªt_32
 (
__bsx
);

91 
	}
}

95 #ià
__GNUC_PREREQ
 (2, 0)

97 
	#__bsw­_cÚ¡ªt_64
(
x
) \

98 (
	`__ex‹nsiÚ__
 ((((
x
) & 0xff00000000000000ull) >> 56) \

99 | (((
x
) & 0x00ff000000000000ull) >> 40) \

100 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

101 | (((
x
) & 0x000000ff00000000ull) >> 8) \

102 | (((
x
) & 0x00000000ff000000ull) << 8) \

103 | (((
x
) & 0x0000000000ff0000ull) << 24) \

104 | (((
x
) & 0x000000000000ff00ull) << 40) \

105 | (((
x
è& 0x00000000000000ffuÎè<< 56)))

	)

107 #ià
__GNUC_PREREQ
 (4, 3)

108 
__šlše
 
__ušt64_t


109 
	$__bsw­_64
 (
__ušt64_t
 
__bsx
)

111  
	`__butš_bsw­64
 (
__bsx
);

112 
	}
}

113 #–ià
__WORDSIZE
 == 64

114 
	#__bsw­_64
(
x
) \

115 (
__ex‹nsiÚ__
 \

116 ({ 
__ušt64_t
 
__v
, 
__x
 = (
x
); \

117 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

118 
__v
 = 
	`__bsw­_cÚ¡ªt_64
 (
__x
); \

120 
	`__asm__
 ("bsw­ %q0" : "ô" (
__v
è: "0" (
__x
)); \

121 
__v
; }))

	)

123 
	#__bsw­_64
(
x
) \

124 (
__ex‹nsiÚ__
 \

125 ({ uniÚ { 
__ex‹nsiÚ__
 
__ušt64_t
 
__Î
; \

126 
__l
[2]; } 
__w
, 
__r
; \

127 ià(
	`__butš_cÚ¡ªt_p
 (
x
)) \

128 
__r
.
__Î
 = 
	`__bsw­_cÚ¡ªt_64
 (
x
); \

131 
__w
.
__Î
 = (
x
); \

132 
__r
.
__l
[0] = 
	`__bsw­_32
 (
__w
.__l[1]); \

133 
__r
.
__l
[1] = 
	`__bsw­_32
 (
__w
.__l[0]); \

135 
__r
.
__Î
; }))

	)

138 
	#__bsw­_cÚ¡ªt_64
(
x
) \

139 ((((
x
) & 0xff00000000000000ull) >> 56) \

140 | (((
x
) & 0x00ff000000000000ull) >> 40) \

141 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

142 | (((
x
) & 0x000000ff00000000ull) >> 8) \

143 | (((
x
) & 0x00000000ff000000ull) << 8) \

144 | (((
x
) & 0x0000000000ff0000ull) << 24) \

145 | (((
x
) & 0x000000000000ff00ull) << 40) \

146 | (((
x
è& 0x00000000000000ffuÎè<< 56))

	)

148 
__šlše
 
__ušt64_t


149 
	$__bsw­_64
 (
__ušt64_t
 
__bsx
)

151  
	`__bsw­_cÚ¡ªt_64
 (
__bsx
);

152 
	}
}

	@/usr/include/bits/endian.h

3 #iâdeà
_ENDIAN_H


7 
	#__BYTE_ORDER
 
__LITTLE_ENDIAN


	)

	@/usr/include/bits/select.h

18 #iâdeà
_SYS_SELECT_H


22 
	~<b™s/wÜdsize.h
>

25 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

27 #ià
__WORDSIZE
 == 64

28 
	#__FD_ZERO_STOS
 "¡osq"

	)

30 
	#__FD_ZERO_STOS
 "¡o¦"

	)

33 
	#__FD_ZERO
(
fd¥
) \

35 
__d0
, 
__d1
; \

36 
__asm__
 
	`__vŞ©e__
 ("şd;„•; " 
__FD_ZERO_STOS
 \

37 : "=c" (
__d0
), "=D" (
__d1
) \

38 : "a" (0), "0" ( (
fd_£t
) \

39 /  (
__fd_mask
)), \

40 "1" (&
	`__FDS_BITS
 (
fd¥
)[0]) \

42 } 0)

	)

48 
	#__FD_ZERO
(
£t
) \

50 
__i
; \

51 
fd_£t
 *
__¬r
 = (
£t
); \

52 
__i
 = 0; __˜<  (
fd_£t
è/  (
__fd_mask
); ++__i) \

53 
	`__FDS_BITS
 (
__¬r
)[
__i
] = 0; \

54 } 0)

	)

58 
	#__FD_SET
(
d
, 
£t
) \

59 ((è(
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] |ğ
	`__FD_MASK
 (d)))

	)

60 
	#__FD_CLR
(
d
, 
£t
) \

61 ((è(
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] &ğ~
	`__FD_MASK
 (d)))

	)

62 
	#__FD_ISSET
(
d
, 
£t
) \

63 ((
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] & 
	`__FD_MASK
 (d)è!ğ0)

	)

	@/usr/include/bits/select2.h

19 #iâdeà
_SYS_SELECT_H


24 
__fd–t_chk
 (
__d
);

25 
	$__fd–t_w¬n
 (
__d
)

26 
	`__w¬Ç‰r
 ("bit outside of fd_set selected");

27 #undeà
__FD_ELT


28 
	#__FD_ELT
(
d
) \

29 
__ex‹nsiÚ__
 \

30 ({ 
__d
 = (
d
); \

31 (
	`__butš_cÚ¡ªt_p
 (
__d
) \

32 ? (0 <ğ
__d
 && __d < 
__FD_SETSIZE
 \

33 ? (
__d
 / 
__NFDBITS
) \

34 : 
	`__fd–t_w¬n
 (
__d
)) \

35 : 
	`__fd–t_chk
 (
__d
)); 
	}
})

	)

	@/usr/include/bits/sysmacros.h

19 #iâdeà
_BITS_SYSMACROS_H


20 
	#_BITS_SYSMACROS_H
 1

	)

22 #iâdeà
_SYS_SYSMACROS_H


36 
	#__SYSMACROS_DECLARE_MAJOR
(
DECL_TEMPL
) \

37 
	`DECL_TEMPL
(, 
majÜ
, (
__dev_t
 
__dev
))

	)

39 
	#__SYSMACROS_DEFINE_MAJOR
(
DECL_TEMPL
) \

40 
	`__SYSMACROS_DECLARE_MAJOR
 (
DECL_TEMPL
) \

42 
__majÜ
; \

43 
__majÜ
 = ((
__dev
 & (
__dev_t
) 0x00000000000fff00u) >> 8); \

44 
__majÜ
 |ğ((
__dev
 & (
__dev_t
) 0xfffff00000000000u) >> 32); \

45  
__majÜ
; \

46 }

	)

48 
	#__SYSMACROS_DECLARE_MINOR
(
DECL_TEMPL
) \

49 
	`DECL_TEMPL
(, 
mšÜ
, (
__dev_t
 
__dev
))

	)

51 
	#__SYSMACROS_DEFINE_MINOR
(
DECL_TEMPL
) \

52 
	`__SYSMACROS_DECLARE_MINOR
 (
DECL_TEMPL
) \

54 
__mšÜ
; \

55 
__mšÜ
 = ((
__dev
 & (
__dev_t
) 0x00000000000000ffu) >> 0); \

56 
__mšÜ
 |ğ((
__dev
 & (
__dev_t
) 0x00000ffffff00000u) >> 12); \

57  
__mšÜ
; \

58 }

	)

60 
	#__SYSMACROS_DECLARE_MAKEDEV
(
DECL_TEMPL
) \

61 
	`DECL_TEMPL
(
__dev_t
, 
makedev
, (
__majÜ
, 
__mšÜ
))

	)

63 
	#__SYSMACROS_DEFINE_MAKEDEV
(
DECL_TEMPL
) \

64 
	`__SYSMACROS_DECLARE_MAKEDEV
 (
DECL_TEMPL
) \

66 
__dev_t
 
__dev
; \

67 
__dev
 = (((
__dev_t
è(
__majÜ
 & 0x00000fffu)) << 8); \

68 
__dev
 |ğ(((
__dev_t
è(
__majÜ
 & 0xfffff000u)) << 32); \

69 
__dev
 |ğ(((
__dev_t
è(
__mšÜ
 & 0x000000ffu)) << 0); \

70 
__dev
 |ğ(((
__dev_t
è(
__mšÜ
 & 0xffffff00u)) << 12); \

71  
__dev
; \

72 }

	)

	@/usr/include/bits/thread-shared-types.h

19 #iâdeà
_THREAD_SHARED_TYPES_H


20 
	#_THREAD_SHARED_TYPES_H
 1

	)

77 
	~<b™s/±h»adty³s-¬ch.h
>

81 #ià!
__PTHREAD_MUTEX_USE_UNION


82 
	s__±h»ad_š‹º®_li¡


84 
__±h»ad_š‹º®_li¡
 *
	m__´ev
;

85 
__±h»ad_š‹º®_li¡
 *
	m__Ãxt
;

86 } 
	t__±h»ad_li¡_t
;

88 
	s__±h»ad_š‹º®_¦i¡


90 
__±h»ad_š‹º®_¦i¡
 *
	m__Ãxt
;

91 } 
	t__±h»ad_¦i¡_t
;

95 #ià
__PTHREAD_MUTEX_LOCK_ELISION


96 #ià!
__PTHREAD_MUTEX_USE_UNION


97 
	#__PTHREAD_SPINS_DATA
 \

98 
__¥šs
; \

99 
__–isiÚ


	)

100 
	#__PTHREAD_SPINS
 0, 0

	)

102 
	#__PTHREAD_SPINS_DATA
 \

105 
__e¥šs
; \

106 
__“lisiÚ
; \

107 } 
__–isiÚ_d©a


	)

108 
	#__PTHREAD_SPINS
 { 0, 0 }

	)

109 
	#__¥šs
 
__–isiÚ_d©a
.
__e¥šs


	)

110 
	#__–isiÚ
 
__–isiÚ_d©a
.
__“lisiÚ


	)

113 
	#__PTHREAD_SPINS_DATA
 
__¥šs


	)

115 
	#__PTHREAD_SPINS
 0

	)

118 
	s__±h»ad_mu‹x_s


120 
__lock
 
	m__LOCK_ALIGNMENT
;

121 
	m__couÁ
;

122 
	m__owÃr
;

123 #ià!
__PTHREAD_MUTEX_NUSERS_AFTER_KIND


124 
	m__nu£rs
;

128 
	m__kšd
;

129 
	m__PTHREAD_COMPAT_PADDING_MID


130 #ià
__PTHREAD_MUTEX_NUSERS_AFTER_KIND


131 
	m__nu£rs
;

133 #ià!
__PTHREAD_MUTEX_USE_UNION


134 
	m__PTHREAD_SPINS_DATA
;

135 
__±h»ad_li¡_t
 
	m__li¡
;

136 
	#__PTHREAD_MUTEX_HAVE_PREV
 1

	)

138 
__ex‹nsiÚ__
 union

140 
	m__PTHREAD_SPINS_DATA
;

141 
__±h»ad_¦i¡_t
 
	m__li¡
;

143 
	#__PTHREAD_MUTEX_HAVE_PREV
 0

	)

145 
	m__PTHREAD_COMPAT_PADDING_END


151 
	s__±h»ad_cÚd_s


153 
__ex‹nsiÚ__
 union

155 
__ex‹nsiÚ__
 
	m__w£q
;

158 
	m__low
;

159 
	m__high
;

160 } 
	m__w£q32
;

162 
__ex‹nsiÚ__
 union

164 
__ex‹nsiÚ__
 
	m__g1_¡¬t
;

167 
	m__low
;

168 
	m__high
;

169 } 
	m__g1_¡¬t32
;

171 
	m__g_»fs
[2] 
	m__LOCK_ALIGNMENT
;

172 
	m__g_size
[2];

173 
	m__g1_Üig_size
;

174 
	m__w»fs
;

175 
	m__g_sigÇls
[2];

	@/usr/include/bits/types/sigset_t.h

1 #iâdeà
__sig£t_t_defšed


2 
	#__sig£t_t_defšed
 1

	)

4 
	~<b™s/ty³s/__sig£t_t.h
>

7 
__sig£t_t
 
	tsig£t_t
;

	@/usr/include/bits/types/struct_timespec.h

1 #iâdeà
__time¥ec_defšed


2 
	#__time¥ec_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

8 
	stime¥ec


10 
__time_t
 
	mtv_£c
;

11 
__sysÿÎ_¦Úg_t
 
	mtv_n£c
;

	@/usr/include/bits/types/struct_timeval.h

1 #iâdeà
__timev®_defšed


2 
	#__timev®_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

8 
	stimev®


10 
__time_t
 
	mtv_£c
;

11 
__su£cÚds_t
 
	mtv_u£c
;

	@/usr/include/bits/typesizes.h

19 #iâdeà
_BITS_TYPES_H


23 #iâdef 
_BITS_TYPESIZES_H


24 
	#_BITS_TYPESIZES_H
 1

	)

30 #ià
defšed
 
__x86_64__
 && defšed 
__ILP32__


31 
	#__SYSCALL_SLONG_TYPE
 
__SQUAD_TYPE


	)

32 
	#__SYSCALL_ULONG_TYPE
 
__UQUAD_TYPE


	)

34 
	#__SYSCALL_SLONG_TYPE
 
__SLONGWORD_TYPE


	)

35 
	#__SYSCALL_ULONG_TYPE
 
__ULONGWORD_TYPE


	)

38 
	#__DEV_T_TYPE
 
__UQUAD_TYPE


	)

39 
	#__UID_T_TYPE
 
__U32_TYPE


	)

40 
	#__GID_T_TYPE
 
__U32_TYPE


	)

41 
	#__INO_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

42 
	#__INO64_T_TYPE
 
__UQUAD_TYPE


	)

43 
	#__MODE_T_TYPE
 
__U32_TYPE


	)

44 #ifdeà
__x86_64__


45 
	#__NLINK_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

46 
	#__FSWORD_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

48 
	#__NLINK_T_TYPE
 
__UWORD_TYPE


	)

49 
	#__FSWORD_T_TYPE
 
__SWORD_TYPE


	)

51 
	#__OFF_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

52 
	#__OFF64_T_TYPE
 
__SQUAD_TYPE


	)

53 
	#__PID_T_TYPE
 
__S32_TYPE


	)

54 
	#__RLIM_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

55 
	#__RLIM64_T_TYPE
 
__UQUAD_TYPE


	)

56 
	#__BLKCNT_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

57 
	#__BLKCNT64_T_TYPE
 
__SQUAD_TYPE


	)

58 
	#__FSBLKCNT_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

59 
	#__FSBLKCNT64_T_TYPE
 
__UQUAD_TYPE


	)

60 
	#__FSFILCNT_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

61 
	#__FSFILCNT64_T_TYPE
 
__UQUAD_TYPE


	)

62 
	#__ID_T_TYPE
 
__U32_TYPE


	)

63 
	#__CLOCK_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

64 
	#__TIME_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

65 
	#__USECONDS_T_TYPE
 
__U32_TYPE


	)

66 
	#__SUSECONDS_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

67 
	#__DADDR_T_TYPE
 
__S32_TYPE


	)

68 
	#__KEY_T_TYPE
 
__S32_TYPE


	)

69 
	#__CLOCKID_T_TYPE
 
__S32_TYPE


	)

70 
	#__TIMER_T_TYPE
 *

	)

71 
	#__BLKSIZE_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

72 
	#__FSID_T_TYPE
 sŒuù { 
__v®
[2]; }

	)

73 
	#__SSIZE_T_TYPE
 
__SWORD_TYPE


	)

74 
	#__CPU_MASK_TYPE
 
__SYSCALL_ULONG_TYPE


	)

76 #ifdeà
__x86_64__


80 
	#__OFF_T_MATCHES_OFF64_T
 1

	)

83 
	#__INO_T_MATCHES_INO64_T
 1

	)

86 
	#__RLIM_T_MATCHES_RLIM64_T
 1

	)

88 
	#__RLIM_T_MATCHES_RLIM64_T
 0

	)

92 
	#__FD_SETSIZE
 1024

	)

	@/usr/include/bits/uintn-identity.h

19 #ià!
defšed
 
_NETINET_IN_H
 && !defšed 
_ENDIAN_H


23 #iâdeà
_BITS_UINTN_IDENTITY_H


24 
	#_BITS_UINTN_IDENTITY_H
 1

	)

26 
	~<b™s/ty³s.h
>

32 
__šlše
 
__ušt16_t


33 
	$__ušt16_id’t™y
 (
__ušt16_t
 
__x
)

35  
__x
;

36 
	}
}

38 
__šlše
 
__ušt32_t


39 
	$__ušt32_id’t™y
 (
__ušt32_t
 
__x
)

41  
__x
;

42 
	}
}

44 
__šlše
 
__ušt64_t


45 
	$__ušt64_id’t™y
 (
__ušt64_t
 
__x
)

47  
__x
;

48 
	}
}

	@/usr/include/asm-generic/bitsperlong.h

2 #iâdeà
__ASM_GENERIC_BITS_PER_LONG


3 
	#__ASM_GENERIC_BITS_PER_LONG


	)

12 #iâdeà
__BITS_PER_LONG


13 
	#__BITS_PER_LONG
 32

	)

	@/usr/include/asm-generic/sockios.h

2 #iâdeà
__ASM_GENERIC_SOCKIOS_H


3 
	#__ASM_GENERIC_SOCKIOS_H


	)

6 
	#FIOSETOWN
 0x8901

	)

7 
	#SIOCSPGRP
 0x8902

	)

8 
	#FIOGETOWN
 0x8903

	)

9 
	#SIOCGPGRP
 0x8904

	)

10 
	#SIOCATMARK
 0x8905

	)

11 
	#SIOCGSTAMP
 0x8906

	)

12 
	#SIOCGSTAMPNS
 0x8907

	)

	@/usr/include/bits/byteswap-16.h

19 #iâdeà
_BITS_BYTESWAP_H


23 #ifdeà
__GNUC__


24 #ià
__GNUC__
 >= 2

25 
	#__bsw­_16
(
x
) \

26 (
__ex‹nsiÚ__
 \

27 ({ 
__v
, 
__x
 = (è(
x
); \

28 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

29 
__v
 = 
	`__bsw­_cÚ¡ªt_16
 (
__x
); \

31 
	`__asm__
 ("rorw $8, %w0" \

32 : "ô" (
__v
) \

33 : "0" (
__x
) \

35 
__v
; }))

	)

38 
	#__bsw­_16
(
x
) \

39 (
__ex‹nsiÚ__
 \

40 ({ 
__x
 = (è(
x
); \

41 
	`__bsw­_cÚ¡ªt_16
 (
__x
); }))

	)

44 
__šlše
 

45 
	$__bsw­_16
 (
__bsx
)

47  
	`__bsw­_cÚ¡ªt_16
 (
__bsx
);

48 
	}
}

	@/usr/include/bits/pthreadtypes-arch.h

18 #iâdeà
_BITS_PTHREADTYPES_ARCH_H


19 
	#_BITS_PTHREADTYPES_ARCH_H
 1

	)

21 
	~<b™s/wÜdsize.h
>

23 #ifdeà
__x86_64__


24 #ià
__WORDSIZE
 == 64

25 
	#__SIZEOF_PTHREAD_MUTEX_T
 40

	)

26 
	#__SIZEOF_PTHREAD_ATTR_T
 56

	)

27 
	#__SIZEOF_PTHREAD_MUTEX_T
 40

	)

28 
	#__SIZEOF_PTHREAD_RWLOCK_T
 56

	)

29 
	#__SIZEOF_PTHREAD_BARRIER_T
 32

	)

31 
	#__SIZEOF_PTHREAD_MUTEX_T
 32

	)

32 
	#__SIZEOF_PTHREAD_ATTR_T
 32

	)

33 
	#__SIZEOF_PTHREAD_MUTEX_T
 32

	)

34 
	#__SIZEOF_PTHREAD_RWLOCK_T
 44

	)

35 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

38 
	#__SIZEOF_PTHREAD_MUTEX_T
 24

	)

39 
	#__SIZEOF_PTHREAD_ATTR_T
 36

	)

40 
	#__SIZEOF_PTHREAD_MUTEX_T
 24

	)

41 
	#__SIZEOF_PTHREAD_RWLOCK_T
 32

	)

42 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

44 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

45 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

46 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

47 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

48 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

51 
	#__PTHREAD_COMPAT_PADDING_MID


	)

52 
	#__PTHREAD_COMPAT_PADDING_END


	)

53 
	#__PTHREAD_MUTEX_LOCK_ELISION
 1

	)

54 #ifdeà
__x86_64__


55 
	#__PTHREAD_MUTEX_NUSERS_AFTER_KIND
 0

	)

56 
	#__PTHREAD_MUTEX_USE_UNION
 0

	)

58 
	#__PTHREAD_MUTEX_NUSERS_AFTER_KIND
 1

	)

59 
	#__PTHREAD_MUTEX_USE_UNION
 1

	)

62 
	#__LOCK_ALIGNMENT


	)

63 
	#__ONCE_ALIGNMENT


	)

65 
	s__±h»ad_rwlock_¬ch_t


67 
	m__»ad”s
;

68 
	m__wr™”s
;

69 
	m__w½ha£_fu‹x
;

70 
	m__wr™”s_fu‹x
;

71 
	m__·d3
;

72 
	m__·d4
;

73 #ifdeà
__x86_64__


74 
	m__cur_wr™”
;

75 
	m__sh¬ed
;

76 sigÃd 
	m__rw–isiÚ
;

77 #ifdeà 
__ILP32__


78 
	m__·d1
[3];

79 
	#__PTHREAD_RWLOCK_ELISION_EXTRA
 0, { 0, 0, 0 }

	)

81 
	m__·d1
[7];

82 
	#__PTHREAD_RWLOCK_ELISION_EXTRA
 0, { 0, 0, 0, 0, 0, 0, 0 }

	)

84 
	m__·d2
;

87 
	m__æags
;

88 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

92 
	m__æags
;

93 
	m__sh¬ed
;

94 sigÃd 
	m__rw–isiÚ
;

95 
	#__PTHREAD_RWLOCK_ELISION_EXTRA
 0

	)

96 
	m__·d2
;

97 
	m__cur_wr™”
;

101 #iâdeà
__x86_64__


103 
	#__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
	`__»g·rm__
 (1)))

	)

	@/usr/include/bits/types/__sigset_t.h

1 #iâdeà
____sig£t_t_defšed


2 
	#____sig£t_t_defšed


	)

4 
	#_SIGSET_NWORDS
 (1024 / (8 *  ()))

	)

7 
	m__v®
[
_SIGSET_NWORDS
];

8 } 
	t__sig£t_t
;

	@
1
.
1
/usr/include
216
4861
acm_api.c
ba.c
ba.h
cac.c
cac.h
cfg80211_ops.c
cfg80211_ops.h
cm_if.c
const.h
debug.c
debug.h
debug_frame.c
dev.c
dev.h
fapi.h
fw_test.c
fw_test.h
hanged_record.h
hip.c
hip.h
hip4.c
hip4.h
hip4_sampler.c
hip4_sampler.h
hip4_smapper.c
hip4_smapper.h
hip_bh.h
ioctl.c
ioctl.h
kic.c
kic.h
log_clients.c
log_clients.h
mbulk.c
mbulk.h
mbulk_def.h
mgt.c
mgt.h
mib.c
mib.h
mib_text_convert.c
mib_text_convert.h
mlme.c
mlme.h
mlme_nan.c
netif.c
netif.h
nl80211_vendor.c
nl80211_vendor.h
nl80211_vendor_nan.c
nl80211_vendor_nan.h
porting_imx.h
procfs.c
procfs.h
reg_info.c
reg_info.h
rx.c
sap.h
sap_dbg.c
sap_dbg.h
sap_ma.c
sap_ma.h
sap_mlme.c
sap_mlme.h
sap_test.c
sap_test.h
scsc_wifi_cm_if.h
scsc_wifi_fcq.c
scsc_wifi_fcq.h
scsc_wifilogger.h
scsc_wifilogger_api.c
scsc_wifilogger_core.c
scsc_wifilogger_core.h
scsc_wifilogger_debugfs.c
scsc_wifilogger_debugfs.h
scsc_wifilogger_internal.c
scsc_wifilogger_internal.h
scsc_wifilogger_module.c
scsc_wifilogger_module.h
scsc_wifilogger_ring_connectivity.c
scsc_wifilogger_ring_connectivity.h
scsc_wifilogger_ring_connectivity_api.h
scsc_wifilogger_ring_pktfate.c
scsc_wifilogger_ring_pktfate.h
scsc_wifilogger_ring_pktfate_api.h
scsc_wifilogger_ring_test.c
scsc_wifilogger_ring_test.h
scsc_wifilogger_ring_wakelock.c
scsc_wifilogger_ring_wakelock.h
scsc_wifilogger_ring_wakelock_api.h
scsc_wifilogger_rings.h
scsc_wifilogger_types.h
scsc_wlan_mmap.c
scsc_wlan_mmap.h
src_sink.c
src_sink.h
test/dev_test.c
test/hip_test.c
test/hydra_test.c
test/udi_test.c
test/unittest.h
traffic_monitor.c
traffic_monitor.h
tx.c
udi.c
udi.h
unifiio.h
utils.h
wl_result.h
../../../misc/samsung/scsc/scsc_wlbtd.h
/usr/include/linux/errno.h
/usr/include/linux/fs.h
/usr/include/linux/if.h
/usr/include/linux/if_ether.h
/usr/include/linux/igmp.h
/usr/include/linux/in.h
/usr/include/linux/ip.h
/usr/include/linux/kernel.h
/usr/include/linux/module.h
/usr/include/linux/netdevice.h
/usr/include/linux/nl80211.h
/usr/include/linux/poll.h
/usr/include/linux/rtnetlink.h
/usr/include/linux/sched.h
/usr/include/linux/socket.h
/usr/include/linux/string.h
/usr/include/linux/time.h
/usr/include/linux/types.h
/usr/include/linux/version.h
/usr/include/linux/wait.h
/usr/include/linux/wireless.h
/usr/include/sys/socket.h
/usr/include/asm/byteorder.h
/usr/include/asm/errno.h
/usr/include/asm/poll.h
/usr/include/asm/types.h
/usr/include/bits/socket.h
/usr/include/bits/socket2.h
/usr/include/bits/types/struct_iovec.h
/usr/include/bits/types/struct_osockaddr.h
/usr/include/features.h
/usr/include/linux/hdlc/ioctl.h
/usr/include/linux/if_addr.h
/usr/include/linux/if_link.h
/usr/include/linux/if_packet.h
/usr/include/linux/ioctl.h
/usr/include/linux/libc-compat.h
/usr/include/linux/limits.h
/usr/include/linux/neighbour.h
/usr/include/linux/netlink.h
/usr/include/linux/posix_types.h
/usr/include/linux/sysinfo.h
/usr/include/string.h
/usr/include/asm-generic/errno.h
/usr/include/asm-generic/poll.h
/usr/include/asm-generic/types.h
/usr/include/asm/ioctl.h
/usr/include/asm/posix_types.h
/usr/include/asm/socket.h
/usr/include/bits/libc-header-start.h
/usr/include/bits/sockaddr.h
/usr/include/bits/socket_type.h
/usr/include/bits/string_fortified.h
/usr/include/bits/types/locale_t.h
/usr/include/gnu/stubs.h
/usr/include/linux/byteorder/little_endian.h
/usr/include/linux/stddef.h
/usr/include/stdc-predef.h
/usr/include/strings.h
/usr/include/sys/cdefs.h
/usr/include/sys/types.h
/usr/include/asm-generic/errno-base.h
/usr/include/asm-generic/int-ll64.h
/usr/include/asm-generic/ioctl.h
/usr/include/asm-generic/socket.h
/usr/include/asm/posix_types_32.h
/usr/include/asm/posix_types_64.h
/usr/include/asm/posix_types_x32.h
/usr/include/bits/long-double.h
/usr/include/bits/pthreadtypes.h
/usr/include/bits/stdint-intn.h
/usr/include/bits/strings_fortified.h
/usr/include/bits/types.h
/usr/include/bits/types/__locale_t.h
/usr/include/bits/types/clock_t.h
/usr/include/bits/types/clockid_t.h
/usr/include/bits/types/time_t.h
/usr/include/bits/types/timer_t.h
/usr/include/bits/wordsize.h
/usr/include/endian.h
/usr/include/gnu/stubs-32.h
/usr/include/gnu/stubs-64.h
/usr/include/gnu/stubs-x32.h
/usr/include/linux/swab.h
/usr/include/sys/select.h
/usr/include/sys/sysmacros.h
/usr/include/asm-generic/posix_types.h
/usr/include/asm/bitsperlong.h
/usr/include/asm/sockios.h
/usr/include/asm/swab.h
/usr/include/bits/byteswap.h
/usr/include/bits/endian.h
/usr/include/bits/select.h
/usr/include/bits/select2.h
/usr/include/bits/sysmacros.h
/usr/include/bits/thread-shared-types.h
/usr/include/bits/types/sigset_t.h
/usr/include/bits/types/struct_timespec.h
/usr/include/bits/types/struct_timeval.h
/usr/include/bits/typesizes.h
/usr/include/bits/uintn-identity.h
/usr/include/asm-generic/bitsperlong.h
/usr/include/asm-generic/sockios.h
/usr/include/bits/byteswap-16.h
/usr/include/bits/pthreadtypes-arch.h
/usr/include/bits/types/__sigset_t.h
